---
title: Planning van uw back-upinfrastructuur VM in Azure | Microsoft Docs
description: Belangrijke overwegingen bij het plannen van de back-up van virtuele machines in Azure
services: backup
documentationcenter: 
author: markgalioto
manager: carmonm
editor: 
keywords: back-up van virtuele machines, back-up van virtuele machines
ms.assetid: 19d2cf82-1f60-43e1-b089-9238042887a9
ms.service: backup
ms.workload: storage-backup-recovery
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 7/18/2017
ms.author: markgal;trinadhk
ms.openlocfilehash: 0c930c7413b24a811707c3a1ff3d7d70585bc528
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 08/29/2017
---
# <a name="plan-your-vm-backup-infrastructure-in-azure"></a><span data-ttu-id="9b361-104">De infrastructuur voor back-ups van virtuele Azure-machines plannen</span><span class="sxs-lookup"><span data-stu-id="9b361-104">Plan your VM backup infrastructure in Azure</span></span>
<span data-ttu-id="9b361-105">In dit artikel biedt de prestaties en suggesties voor het plannen van uw back-upinfrastructuur VM resource.</span><span class="sxs-lookup"><span data-stu-id="9b361-105">This article provides performance and resource suggestions to help you plan your VM backup infrastructure.</span></span> <span data-ttu-id="9b361-106">Definieert ook belangrijke aspecten van de Backup-service; deze aspecten kunnen essentieel bij het bepalen van uw architectuur zijn capaciteitsplanning en planning.</span><span class="sxs-lookup"><span data-stu-id="9b361-106">It also defines key aspects of the Backup service; these aspects can be critical in determining your architecture, capacity planning, and scheduling.</span></span> <span data-ttu-id="9b361-107">Als u hebt [uw omgeving voorbereid](backup-azure-vms-prepare.md), is de volgende stap plannen voordat u begint met [back-up van virtuele machines](backup-azure-vms.md).</span><span class="sxs-lookup"><span data-stu-id="9b361-107">If you've [prepared your environment](backup-azure-vms-prepare.md), planning is the next step before you begin [to back up VMs](backup-azure-vms.md).</span></span> <span data-ttu-id="9b361-108">Als u meer informatie over virtuele machines in Azure nodig hebt, raadpleegt u de [documentatie Virtual Machines](https://azure.microsoft.com/documentation/services/virtual-machines/).</span><span class="sxs-lookup"><span data-stu-id="9b361-108">If you need more information about Azure virtual machines, see the [Virtual Machines documentation](https://azure.microsoft.com/documentation/services/virtual-machines/).</span></span>

## <a name="how-does-azure-back-up-virtual-machines"></a><span data-ttu-id="9b361-109">Hoe biedt Azure back-up van virtuele machines?</span><span class="sxs-lookup"><span data-stu-id="9b361-109">How does Azure back up virtual machines?</span></span>
<span data-ttu-id="9b361-110">Wanneer een back-uptaak de Azure Backup-service op het geplande tijdstip begint, wordt de Backup-extensie om een momentopname punt in tijd geactiveerd.</span><span class="sxs-lookup"><span data-stu-id="9b361-110">When the Azure Backup service initiates a backup job at the scheduled time, it triggers the backup extension to take a point-in-time snapshot.</span></span> <span data-ttu-id="9b361-111">De Azure Backup-service wordt gebruikt de _VMSnapshot_ de extensie in Windows, en de _VMSnapshotLinux_ extensie in Linux.</span><span class="sxs-lookup"><span data-stu-id="9b361-111">The Azure Backup service uses the _VMSnapshot_ extension in Windows, and the _VMSnapshotLinux_ extension in Linux.</span></span> <span data-ttu-id="9b361-112">De uitbreiding wordt geïnstalleerd tijdens de eerste VM back-up.</span><span class="sxs-lookup"><span data-stu-id="9b361-112">The extension is installed during the first VM backup.</span></span> <span data-ttu-id="9b361-113">Voor het installeren van de uitbreiding voor moet de virtuele machine worden uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="9b361-113">To install the extension, the VM must be running.</span></span> <span data-ttu-id="9b361-114">Als de virtuele machine niet wordt uitgevoerd, maakt de Backup-service een momentopname van de onderliggende opslag (omdat er geen schrijfbewerkingen toepassing optreden terwijl de virtuele machine is gestopt).</span><span class="sxs-lookup"><span data-stu-id="9b361-114">If the VM is not running, the Backup service takes a snapshot of the underlying storage (since no application writes occur while the VM is stopped).</span></span>

<span data-ttu-id="9b361-115">Wanneer een momentopname maken van VM's van Windows, coördineert de Backup-service met de Volume Shadow Copy Service (VSS) om op te halen van een consistente momentopname van de schijven van de virtuele machine.</span><span class="sxs-lookup"><span data-stu-id="9b361-115">When taking a snapshot of Windows VMs, the Backup service coordinates with the Volume Shadow Copy Service (VSS) to get a consistent snapshot of the virtual machine's disks.</span></span> <span data-ttu-id="9b361-116">Als u een back-up van Linux VM's, kunt u uw eigen aangepaste scripts consistentie bij het maken van een VM-momentopname schrijven.</span><span class="sxs-lookup"><span data-stu-id="9b361-116">If you're backing up Linux VMs, you can write your own custom scripts to ensure consistency when taking a VM snapshot.</span></span> <span data-ttu-id="9b361-117">Verderop in dit artikel vindt u meer informatie over het aanroepen van deze scripts.</span><span class="sxs-lookup"><span data-stu-id="9b361-117">Details on invoking these scripts are provided later in this article.</span></span>

<span data-ttu-id="9b361-118">Zodra de Azure Backup-service de momentopname maakt, worden de gegevens worden overgedragen naar de kluis.</span><span class="sxs-lookup"><span data-stu-id="9b361-118">Once the Azure Backup service takes the snapshot, the data is transferred to the vault.</span></span> <span data-ttu-id="9b361-119">Als u wilt optimaliseren, wordt de service identificeert en draagt alleen de blokken met gegevens die zijn gewijzigd sinds de vorige back-up.</span><span class="sxs-lookup"><span data-stu-id="9b361-119">To maximize efficiency, the service identifies and transfers only the blocks of data that have changed since the previous backup.</span></span>

![Virtuele machine van Azure Backup-architectuur](./media/backup-azure-vms-introduction/vmbackup-architecture.png)

<span data-ttu-id="9b361-121">Wanneer de overdracht van gegevens voltooid is, wordt de momentopname is verwijderd en een herstelpunt wordt gemaakt.</span><span class="sxs-lookup"><span data-stu-id="9b361-121">When the data transfer is complete, the snapshot is removed and a recovery point is created.</span></span>

> [!NOTE]
> 1. <span data-ttu-id="9b361-122">Tijdens de back-upproces bevat Azure Backup geen de tijdelijke schijf die is gekoppeld aan de virtuele machine.</span><span class="sxs-lookup"><span data-stu-id="9b361-122">During the backup process, Azure Backup doesn't include the temporary disk attached to the virtual machine.</span></span> <span data-ttu-id="9b361-123">Zie voor meer informatie de blog op [tijdelijke opslag](https://blogs.msdn.microsoft.com/mast/2013/12/06/understanding-the-temporary-drive-on-windows-azure-virtual-machines/).</span><span class="sxs-lookup"><span data-stu-id="9b361-123">For more information, see the blog on [temporary storage](https://blogs.msdn.microsoft.com/mast/2013/12/06/understanding-the-temporary-drive-on-windows-azure-virtual-machines/).</span></span>
> 2. <span data-ttu-id="9b361-124">Aangezien Azure Backup een momentopname van het niveau van de opslag en brengt het die momentopname naar de kluis, wijzig de opslagaccountsleutels totdat de back-uptaak is voltooid.</span><span class="sxs-lookup"><span data-stu-id="9b361-124">Since Azure Backup takes a storage-level snapshot and transfers that snapshot to vault, do not change the storage account keys until the backup job finishes.</span></span>
> 3. <span data-ttu-id="9b361-125">Premium VM's kopiëren we de momentopname naar storage-account.</span><span class="sxs-lookup"><span data-stu-id="9b361-125">For premium VMs, we copy the snapshot to storage account.</span></span> <span data-ttu-id="9b361-126">Dit is om ervoor te zorgen dat Azure Backup-service voldoende IOPS opgehaald voor de overdracht van gegevens naar de kluis.</span><span class="sxs-lookup"><span data-stu-id="9b361-126">This is to make sure that Azure Backup service gets sufficient IOPS for transferring data to vault.</span></span> <span data-ttu-id="9b361-127">Deze extra exemplaar van de opslag is in rekening gebracht volgens de virtuele machine toegewezen grootte.</span><span class="sxs-lookup"><span data-stu-id="9b361-127">This additional copy of storage is charged as per the VM allocated size.</span></span> 
>

### <a name="data-consistency"></a><span data-ttu-id="9b361-128">Gegevensconsistentie</span><span class="sxs-lookup"><span data-stu-id="9b361-128">Data consistency</span></span>
<span data-ttu-id="9b361-129">Een back-up en herstellen van zakelijke essentiële gegevens wordt bemoeilijkt door het feit dat bedrijfskritieke gegevens moet een back-up tijdens de toepassingen die de gegevens produceren die worden uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="9b361-129">Backing up and restoring business critical data is complicated by the fact that business critical data must be backed up while the applications that produce the data are running.</span></span> <span data-ttu-id="9b361-130">Om dit op te lossen, Azure Backup biedt ondersteuning voor toepassingsconsistente back-ups voor zowel Windows als een virtuele Linux-machines</span><span class="sxs-lookup"><span data-stu-id="9b361-130">To address this, Azure Backup supports application-consistent backups for both Windows and Linux VMs</span></span>
#### <a name="windows-vm"></a><span data-ttu-id="9b361-131">Windows VM</span><span class="sxs-lookup"><span data-stu-id="9b361-131">Windows VM</span></span>
<span data-ttu-id="9b361-132">Azure Backup VSS volledige back-ups neemt op VM's van Windows (meer informatie over [VSS volledige back-up](http://blogs.technet.com/b/filecab/archive/2008/05/21/what-is-the-difference-between-vss-full-backup-and-vss-copy-backup-in-windows-server-2008.aspx)).</span><span class="sxs-lookup"><span data-stu-id="9b361-132">Azure Backup takes VSS full backups on Windows VMs (read more about [VSS full backup](http://blogs.technet.com/b/filecab/archive/2008/05/21/what-is-the-difference-between-vss-full-backup-and-vss-copy-backup-in-windows-server-2008.aspx)).</span></span> <span data-ttu-id="9b361-133">De volgende registersleutel moet worden ingesteld op de virtuele machine zodat VSS kopieback-ups.</span><span class="sxs-lookup"><span data-stu-id="9b361-133">To enable VSS copy backups, the following registry key needs to be set on the VM.</span></span>

```
[HKEY_LOCAL_MACHINE\SOFTWARE\MICROSOFT\BCDRAGENT]
"USEVSSCOPYBACKUP"="TRUE"
```

#### <a name="linux-vms"></a><span data-ttu-id="9b361-134">Virtuele Linux-machines</span><span class="sxs-lookup"><span data-stu-id="9b361-134">Linux VMs</span></span>
<span data-ttu-id="9b361-135">Azure Backup biedt een scripting-framework.</span><span class="sxs-lookup"><span data-stu-id="9b361-135">Azure Backup provides a scripting framework.</span></span> <span data-ttu-id="9b361-136">Toepassing een consistent back-ups van virtuele Linux-machines, aangepaste scripts voor vóór en na scripts waarmee de back-werkstroom en de omgeving te maken.</span><span class="sxs-lookup"><span data-stu-id="9b361-136">To ensure application consistency when backing up Linux VMs, create custom pre-scripts and post-scripts that control the backup workflow and environment.</span></span> <span data-ttu-id="9b361-137">Azure Backup roept het Pre-script voordat u de VM-momentopname en roept het script voor na zodra de taak VM-momentopname is voltooid.</span><span class="sxs-lookup"><span data-stu-id="9b361-137">Azure Backup invokes the pre-script before taking the VM snapshot and invokes the post-script once the VM snapshot job completes.</span></span> <span data-ttu-id="9b361-138">Zie voor meer informatie [toepassing consistente VM-back-ups met behulp van script voor vóór en na](https://docs.microsoft.com/azure/backup/backup-azure-linux-app-consistent).</span><span class="sxs-lookup"><span data-stu-id="9b361-138">For more details, see [application consistent VM backups using pre-script and post-script](https://docs.microsoft.com/azure/backup/backup-azure-linux-app-consistent).</span></span>
> [!NOTE]
> <span data-ttu-id="9b361-139">Azure Backup alleen roept de klant geschreven vóór en na-scripts.</span><span class="sxs-lookup"><span data-stu-id="9b361-139">Azure Backup only invokes the customer-written pre- and post-scripts.</span></span> <span data-ttu-id="9b361-140">Als de script voor vóór en na scripts uitgevoerd is, markeert Azure Backup het herstelpunt dat als toepassing consistente.</span><span class="sxs-lookup"><span data-stu-id="9b361-140">If the pre-script and post-scripts execute successfully, Azure Backup marks the recovery point as application consistent.</span></span> <span data-ttu-id="9b361-141">De klant is die verantwoordelijk is voor de consistentie van toepassing wanneer u aangepaste scripts.</span><span class="sxs-lookup"><span data-stu-id="9b361-141">However, the customer is ultimately responsible for the application consistency when using custom scripts.</span></span>
>


<span data-ttu-id="9b361-142">De volgende tabel beschrijft de soorten consistentie en de voorwaarden die ze onder tijdens de virtuele machine van Azure optreden back-up- en herstelprocedures.</span><span class="sxs-lookup"><span data-stu-id="9b361-142">This table explains the types of consistency and the conditions that they occur under during Azure VM backup and restore procedures.</span></span>

| <span data-ttu-id="9b361-143">Consistentie</span><span class="sxs-lookup"><span data-stu-id="9b361-143">Consistency</span></span> | <span data-ttu-id="9b361-144">Op basis van VSS</span><span class="sxs-lookup"><span data-stu-id="9b361-144">VSS-based</span></span> | <span data-ttu-id="9b361-145">Uitleg en details</span><span class="sxs-lookup"><span data-stu-id="9b361-145">Explanation and details</span></span> |
| --- | --- | --- |
| <span data-ttu-id="9b361-146">Consistentie van toepassingen</span><span class="sxs-lookup"><span data-stu-id="9b361-146">Application consistency</span></span> |<span data-ttu-id="9b361-147">Ja voor Windows</span><span class="sxs-lookup"><span data-stu-id="9b361-147">Yes for Windows</span></span>|<span data-ttu-id="9b361-148">Consistentie van de toepassing is ideaal voor workloads zoals zorgt ervoor dat:</span><span class="sxs-lookup"><span data-stu-id="9b361-148">Application consistency is ideal for workloads as it ensures that:</span></span><ol><li> <span data-ttu-id="9b361-149">De virtuele machine *opgestart*.</span><span class="sxs-lookup"><span data-stu-id="9b361-149">The VM *boots up*.</span></span> <li><span data-ttu-id="9b361-150">Er is *geen beschadiging*.</span><span class="sxs-lookup"><span data-stu-id="9b361-150">There is *no corruption*.</span></span> <li><span data-ttu-id="9b361-151">Er is *zonder verlies van gegevens*.</span><span class="sxs-lookup"><span data-stu-id="9b361-151">There is *no data loss*.</span></span><li> <span data-ttu-id="9b361-152">De gegevens zijn consistent zijn om de toepassing die gebruikmaakt van de gegevens met betrekking tot de toepassing op het moment van back-up--met VSS of vooraf/post script.</span><span class="sxs-lookup"><span data-stu-id="9b361-152">The data is consistent to the application that uses the data, by involving the application at the time of backup--using VSS or pre/post script.</span></span></ol> <li><span data-ttu-id="9b361-153">*VM's van Windows*-meest Microsoft-werkbelastingen VSS-schrijvers die specifiek acties uitvoeren die betrekking hebben op consistentie van de gegevens hebben.</span><span class="sxs-lookup"><span data-stu-id="9b361-153">*Windows VMs*- Most Microsoft workloads have VSS writers that do workload-specific actions related to data consistency.</span></span> <span data-ttu-id="9b361-154">Microsoft SQL Server heeft bijvoorbeeld een VSS-schrijver dat ervoor zorgt dat de geschreven naar het transactielogbestand en de database correct worden uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="9b361-154">For example, Microsoft SQL Server has a VSS writer that ensures that the writes to the transaction log file and the database are done correctly.</span></span> <span data-ttu-id="9b361-155">Voor back-ups van virtuele machine van Windows Azure, voor het maken van een toepassingsconsistente herstelpunt, moet de Backup-extensie de VSS-workflow aanroepen en deze zijn voltooid voordat de VM-momentopname.</span><span class="sxs-lookup"><span data-stu-id="9b361-155">For Azure Windows VM backups, to create an application-consistent recovery point, the backup extension must invoke the VSS workflow and complete it before taking the VM snapshot.</span></span> <span data-ttu-id="9b361-156">Voor de Azure VM-momentopname worden nauwkeurige, moeten ook de VSS-schrijvers van alle virtuele machine van Azure-toepassingen uitvoeren.</span><span class="sxs-lookup"><span data-stu-id="9b361-156">For the Azure VM snapshot to be accurate, the VSS writers of all Azure VM applications must complete as well.</span></span> <span data-ttu-id="9b361-157">(Meer informatie over de [basisprincipes van VSS](http://blogs.technet.com/b/josebda/archive/2007/10/10/the-basics-of-the-volume-shadow-copy-service-vss.aspx) en duik diep in de details van [hoe het werkt](https://technet.microsoft.com/library/cc785914%28v=ws.10%29.aspx)).</span><span class="sxs-lookup"><span data-stu-id="9b361-157">(Learn the [basics of VSS](http://blogs.technet.com/b/josebda/archive/2007/10/10/the-basics-of-the-volume-shadow-copy-service-vss.aspx) and dive deep into the details of [how it works](https://technet.microsoft.com/library/cc785914%28v=ws.10%29.aspx)).</span></span> </li> <li> <span data-ttu-id="9b361-158">*Virtuele Linux-machines*-klanten kunnen uitvoeren [aangepaste script voor vóór en na toepassing consistentie te garanderen](https://docs.microsoft.com/azure/backup/backup-azure-linux-app-consistent).</span><span class="sxs-lookup"><span data-stu-id="9b361-158">*Linux VMs*- Customers can execute [custom pre-script and post-script to ensure application consistency](https://docs.microsoft.com/azure/backup/backup-azure-linux-app-consistent).</span></span> </li> |
| <span data-ttu-id="9b361-159">Consistentie van bestandssysteem</span><span class="sxs-lookup"><span data-stu-id="9b361-159">File-system consistency</span></span> |<span data-ttu-id="9b361-160">Ja - voor Windows-computers</span><span class="sxs-lookup"><span data-stu-id="9b361-160">Yes - for Windows-based computers</span></span> |<span data-ttu-id="9b361-161">Er zijn twee scenario's waar het herstelpunt kan zijn *bestandssysteem consistente*:</span><span class="sxs-lookup"><span data-stu-id="9b361-161">There are two scenarios where the recovery point can be *file-system consistent*:</span></span><ul><li><span data-ttu-id="9b361-162">Back-ups van virtuele Linux-machines in Azure, zonder pre-script/na-script of als pre-script/na-script is mislukt.</span><span class="sxs-lookup"><span data-stu-id="9b361-162">Backups of Linux VMs in Azure, without pre-script/post-script or if pre-script/post-script failed.</span></span> <li><span data-ttu-id="9b361-163">VSS-fout tijdens back-up voor Windows-machines in Azure.</span><span class="sxs-lookup"><span data-stu-id="9b361-163">VSS failure during backup for Windows VMs in Azure.</span></span></li></ul> <span data-ttu-id="9b361-164">In beide gevallen is het beste die kan worden uitgevoerd om ervoor te zorgen dat:</span><span class="sxs-lookup"><span data-stu-id="9b361-164">In both these cases, the best that can be done is to ensure that:</span></span> <ol><li> <span data-ttu-id="9b361-165">De virtuele machine *opgestart*.</span><span class="sxs-lookup"><span data-stu-id="9b361-165">The VM *boots up*.</span></span> <li><span data-ttu-id="9b361-166">Er is *geen beschadiging*.</span><span class="sxs-lookup"><span data-stu-id="9b361-166">There is *no corruption*.</span></span><li><span data-ttu-id="9b361-167">Er is *zonder verlies van gegevens*.</span><span class="sxs-lookup"><span data-stu-id="9b361-167">There is *no data loss*.</span></span></ol> <span data-ttu-id="9b361-168">Toepassingen moeten hun eigen mechanisme 'bijwerken' implementeren op de herstelde gegevens.</span><span class="sxs-lookup"><span data-stu-id="9b361-168">Applications need to implement their own "fix-up" mechanism on the restored data.</span></span> |
| <span data-ttu-id="9b361-169">Consistentie van de crash</span><span class="sxs-lookup"><span data-stu-id="9b361-169">Crash consistency</span></span> |<span data-ttu-id="9b361-170">Nee</span><span class="sxs-lookup"><span data-stu-id="9b361-170">No</span></span> |<span data-ttu-id="9b361-171">Deze situatie komt overeen met een virtuele machine met een 'crash' (via ofwel een zacht of hard reset).</span><span class="sxs-lookup"><span data-stu-id="9b361-171">This situation is equivalent to a virtual machine experiencing a "crash" (through either a soft or hard reset).</span></span> <span data-ttu-id="9b361-172">Crash consistentie gebeurt meestal wanneer de virtuele machine van Azure op het moment van back-up wordt afgesloten.</span><span class="sxs-lookup"><span data-stu-id="9b361-172">Crash consistency typically happens when the Azure virtual machine is shut down at the time of backup.</span></span> <span data-ttu-id="9b361-173">Een crashconsistent herstelpunt biedt geen garanties rond de consistentie van de gegevens op het opslagmedium--vanuit het perspectief van het besturingssysteem of de toepassing.</span><span class="sxs-lookup"><span data-stu-id="9b361-173">A crash-consistent recovery point provides no guarantees around the consistency of the data on the storage medium--either from the perspective of the operating system or the application.</span></span> <span data-ttu-id="9b361-174">Alleen de gegevens die al op de schijf op het moment van back-up bestaat worden vastgelegd en back-up gemaakt.</span><span class="sxs-lookup"><span data-stu-id="9b361-174">Only the data that already exists on the disk at the time of backup is captured and backed up.</span></span> <br/> <br/> <span data-ttu-id="9b361-175">Hoewel er geen garanties, meestal, het besturingssysteem opnieuw is opgestart, gevolgd door het controleren van de schijf procedure, zoals chkdsk eventuele Beschadigingsfouten te herstellen.</span><span class="sxs-lookup"><span data-stu-id="9b361-175">While there are no guarantees, usually, the operating system boots, followed by disk-checking procedure, like chkdsk, to fix any corruption errors.</span></span> <span data-ttu-id="9b361-176">Alle gegevens in het geheugen of schrijfbewerkingen die niet zijn overgebracht naar de schijf gaan verloren.</span><span class="sxs-lookup"><span data-stu-id="9b361-176">Any in-memory data or writes that have not been transferred to the disk are lost.</span></span> <span data-ttu-id="9b361-177">De toepassing wordt doorgaans met een eigen mechanisme voor verificatie volgt geval terugdraaien van de gegevens moet worden uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="9b361-177">The application typically follows with its own verification mechanism in case data rollback needs to be done.</span></span> <br><br><span data-ttu-id="9b361-178">Een voorbeeld: als het transactielogboek is vermeldingen die niet aanwezig in de database vervolgens de databasesoftware geen terugdraaien tot de gegevens consistent is.</span><span class="sxs-lookup"><span data-stu-id="9b361-178">As an example, if the transaction log has entries that are not present in the database, then the database software does a rollback until the data is consistent.</span></span> <span data-ttu-id="9b361-179">Wanneer gegevens worden verspreid over meerdere virtuele schijven (zoals spanned volumes), biedt een crashconsistent herstelpunt geen garanties voor de juistheid van de gegevens.</span><span class="sxs-lookup"><span data-stu-id="9b361-179">When data is spread across multiple virtual disks (like spanned volumes), a crash-consistent recovery point provides no guarantees for the correctness of the data.</span></span> |

## <a name="performance-and-resource-utilization"></a><span data-ttu-id="9b361-180">Prestatie- en -gebruik</span><span class="sxs-lookup"><span data-stu-id="9b361-180">Performance and resource utilization</span></span>
<span data-ttu-id="9b361-181">Zoals back-upsoftware die geïmplementeerde on-premises, moet u plannen voor de capaciteit en brongebruik behoeften back-ups van virtuele machines in Azure.</span><span class="sxs-lookup"><span data-stu-id="9b361-181">Like backup software that is deployed on-premises, you should plan for capacity and resource utilization needs when backing up VMs in Azure.</span></span> <span data-ttu-id="9b361-182">De [Azure Storage beperkt](../azure-subscription-service-limits.md#storage-limits) structuur van de VM-implementaties voor optimale prestaties met minimale gevolgen voor het uitvoeren van werkbelastingen definiëren.</span><span class="sxs-lookup"><span data-stu-id="9b361-182">The [Azure Storage limits](../azure-subscription-service-limits.md#storage-limits) define how to structure VM deployments to get maximum performance with minimum impact to running workloads.</span></span>

<span data-ttu-id="9b361-183">Let op de volgende Azure Storage-limieten bij het plannen van back-upprestaties:</span><span class="sxs-lookup"><span data-stu-id="9b361-183">Pay attention to the following Azure Storage limits when planning backup performance:</span></span>

* <span data-ttu-id="9b361-184">Maximum aantal uitgaande per storage-account</span><span class="sxs-lookup"><span data-stu-id="9b361-184">Max egress per storage account</span></span>
* <span data-ttu-id="9b361-185">Percentage van totaal aantal aanvragen per storage-account</span><span class="sxs-lookup"><span data-stu-id="9b361-185">Total request rate per storage account</span></span>

### <a name="storage-account-limits"></a><span data-ttu-id="9b361-186">Limieten voor opslagaccounts</span><span class="sxs-lookup"><span data-stu-id="9b361-186">Storage account limits</span></span>
<span data-ttu-id="9b361-187">Back-upgegevens gekopieerd van een opslagaccount, zijn toegevoegd aan de i/o-bewerkingen per seconde (IOPS) en uitgaande (of doorvoer) metrische gegevens van het opslagaccount.</span><span class="sxs-lookup"><span data-stu-id="9b361-187">Backup data copied from a storage account, adds to the input/output operations per second (IOPS) and egress (or throughput) metrics of the storage account.</span></span> <span data-ttu-id="9b361-188">Virtuele machines worden op hetzelfde moment ook verbruikt IOPS en doorvoerlimieten.</span><span class="sxs-lookup"><span data-stu-id="9b361-188">At the same time, virtual machines are also consuming IOPS and throughput.</span></span> <span data-ttu-id="9b361-189">Het doel is om te controleren of de back-up en het verkeer van virtuele machines niet groter is dan de limieten voor opslagaccounts.</span><span class="sxs-lookup"><span data-stu-id="9b361-189">The goal is to ensure Backup and virtual machine traffic don't exceed your storage account limits.</span></span>

### <a name="number-of-disks"></a><span data-ttu-id="9b361-190">Aantal schijven</span><span class="sxs-lookup"><span data-stu-id="9b361-190">Number of disks</span></span>
<span data-ttu-id="9b361-191">Het back-upproces probeert een back-uptaak zo snel mogelijk te voltooien.</span><span class="sxs-lookup"><span data-stu-id="9b361-191">The backup process tries to complete a backup job as quickly as possible.</span></span> <span data-ttu-id="9b361-192">In dat geval, verbruikt deze zo veel resources geplaatst.</span><span class="sxs-lookup"><span data-stu-id="9b361-192">In doing so, it consumes as many resources as it can.</span></span> <span data-ttu-id="9b361-193">Echter alle i/o-bewerkingen worden beperkt door de *doel doorvoer voor één Blob*, die heeft een limiet van 60 MB per seconde.</span><span class="sxs-lookup"><span data-stu-id="9b361-193">However, all I/O operations are limited by the *Target Throughput for Single Blob*, which has a limit of 60 MB per second.</span></span> <span data-ttu-id="9b361-194">In een poging de snelheid maximaliseren, wordt het back-upproces probeert back-up van de VM-schijven *parallel*.</span><span class="sxs-lookup"><span data-stu-id="9b361-194">In an attempt to maximize its speed, the backup process tries to back up each of the VM's disks *in parallel*.</span></span> <span data-ttu-id="9b361-195">Als een virtuele machine vier schijven heeft, probeert de service naar de back-up van alle vier schijven parallel.</span><span class="sxs-lookup"><span data-stu-id="9b361-195">If a VM has four disks, the service attempts to back up all four disks in parallel.</span></span> <span data-ttu-id="9b361-196">De **aantal schijven** back-up wordt gemaakt, is de belangrijkste factor bij het bepalen van de back-opslagverkeer-account.</span><span class="sxs-lookup"><span data-stu-id="9b361-196">The **number of disks** being backed up, is the most important factor in determining storage account backup traffic.</span></span>

### <a name="backup-schedule"></a><span data-ttu-id="9b361-197">Back-upschema</span><span class="sxs-lookup"><span data-stu-id="9b361-197">Backup schedule</span></span>
<span data-ttu-id="9b361-198">Een extra factor die invloed op prestaties wordt de **back-upschema**.</span><span class="sxs-lookup"><span data-stu-id="9b361-198">An additional factor that impacts performance is the **backup schedule**.</span></span> <span data-ttu-id="9b361-199">Als u het beleid configureert zodat alle VM's op hetzelfde moment worden ondersteund, kunt u een verkeer is vastgelopen hebt gepland.</span><span class="sxs-lookup"><span data-stu-id="9b361-199">If you configure the policies so all VMs are backed up at the same time, you have scheduled a traffic jam.</span></span> <span data-ttu-id="9b361-200">Het back-upproces probeert te back-up van alle schijven parallel.</span><span class="sxs-lookup"><span data-stu-id="9b361-200">The backup process attempts to back up all disks in parallel.</span></span> <span data-ttu-id="9b361-201">Als u het back-verkeer van een opslagaccount, back-up van andere VM's op andere tijd van de dag, zonder overlap.</span><span class="sxs-lookup"><span data-stu-id="9b361-201">To reduce the backup traffic from a storage account, back up different VMs at different time of the day, with no overlap.</span></span>

## <a name="capacity-planning"></a><span data-ttu-id="9b361-202">Capaciteitsplanning</span><span class="sxs-lookup"><span data-stu-id="9b361-202">Capacity planning</span></span>
<span data-ttu-id="9b361-203">Het samenstellen van de vorige factoren, moet u voor het plannen van de moeten storage-account gebruiken.</span><span class="sxs-lookup"><span data-stu-id="9b361-203">Putting the previous factors together, you need to plan for the storage account usage needs.</span></span> <span data-ttu-id="9b361-204">Download de [VM back-capaciteitsplanning Excel-spreadsheet](https://gallery.technet.microsoft.com/Azure-Backup-Storage-a46d7e33) om te zien van de impact van de schijf en de back-upschema keuzes.</span><span class="sxs-lookup"><span data-stu-id="9b361-204">Download the [VM backup capacity planning Excel spreadsheet](https://gallery.technet.microsoft.com/Azure-Backup-Storage-a46d7e33) to see the impact of your disk and backup schedule choices.</span></span>

### <a name="backup-throughput"></a><span data-ttu-id="9b361-205">Back-doorvoer</span><span class="sxs-lookup"><span data-stu-id="9b361-205">Backup throughput</span></span>
<span data-ttu-id="9b361-206">Voor elke schijf back-up wordt gemaakt, Azure Backup leest de blokken op de schijf en slaat alleen de gewijzigde gegevens (incrementele back-up).</span><span class="sxs-lookup"><span data-stu-id="9b361-206">For each disk being backed up, Azure Backup reads the blocks on the disk and stores only the changed data (incremental backup).</span></span> <span data-ttu-id="9b361-207">De volgende tabel toont de gemiddelde doorvoer waarden van de back-up-service.</span><span class="sxs-lookup"><span data-stu-id="9b361-207">The following table shows the average Backup service throughput values.</span></span> <span data-ttu-id="9b361-208">De volgende gegevens kunt u de hoeveelheid tijd die nodig zijn voor de back-up van de schijf van een bepaalde grootte schatten.</span><span class="sxs-lookup"><span data-stu-id="9b361-208">Using the following data, you can estimate the amount of time needed to back up a disk of a given size.</span></span>

| <span data-ttu-id="9b361-209">Back-upbewerking</span><span class="sxs-lookup"><span data-stu-id="9b361-209">Backup operation</span></span> | <span data-ttu-id="9b361-210">Gunstigste doorvoer</span><span class="sxs-lookup"><span data-stu-id="9b361-210">Best-case throughput</span></span> |
| --- | --- |
| <span data-ttu-id="9b361-211">Eerste back-up</span><span class="sxs-lookup"><span data-stu-id="9b361-211">Initial backup</span></span> |<span data-ttu-id="9b361-212">160 Mbps</span><span class="sxs-lookup"><span data-stu-id="9b361-212">160 Mbps</span></span> |
| <span data-ttu-id="9b361-213">Incrementele back-up (DR)</span><span class="sxs-lookup"><span data-stu-id="9b361-213">Incremental backup (DR)</span></span> |<span data-ttu-id="9b361-214">640 Mbps</span><span class="sxs-lookup"><span data-stu-id="9b361-214">640 Mbps</span></span> <br><br> <span data-ttu-id="9b361-215">Doorvoer aanzienlijk wordt neergezet als de gewijzigde gegevens (die een back-up moet) verspreid staat in de schijf.</span><span class="sxs-lookup"><span data-stu-id="9b361-215">Throughput drops significantly if the changed data (that needs to be backed up) is dispersed across the disk.</span></span>|

## <a name="total-vm-backup-time"></a><span data-ttu-id="9b361-216">Totale tijd voor VM-back-up</span><span class="sxs-lookup"><span data-stu-id="9b361-216">Total VM backup time</span></span>
<span data-ttu-id="9b361-217">Hoewel de meeste van de back-tijd is besteed aan het lezen van en kopiëren van gegevens, worden andere bewerkingen bijdragen aan de totale tijd die nodig zijn voor de back-up van een virtuele machine:</span><span class="sxs-lookup"><span data-stu-id="9b361-217">While most of the backup time is spent reading and copying data, other operations contribute to the total time needed to back up a VM:</span></span>

* <span data-ttu-id="9b361-218">Tijd die nodig zijn voor [installeren of bijwerken van de Backup-extensie](backup-azure-vms.md).</span><span class="sxs-lookup"><span data-stu-id="9b361-218">Time needed to [install or update the backup extension](backup-azure-vms.md).</span></span>
* <span data-ttu-id="9b361-219">Momentopname-tijd is de tijd die nodig is voor het activeren van een momentopname.</span><span class="sxs-lookup"><span data-stu-id="9b361-219">Snapshot time, which is the time taken to trigger a snapshot.</span></span> <span data-ttu-id="9b361-220">Momentopnamen worden dicht bij de geplande back-uptijd geactiveerd.</span><span class="sxs-lookup"><span data-stu-id="9b361-220">Snapshots are triggered close to the scheduled backup time.</span></span>
* <span data-ttu-id="9b361-221">Wachttijd in.</span><span class="sxs-lookup"><span data-stu-id="9b361-221">Queue wait time.</span></span> <span data-ttu-id="9b361-222">Omdat de Backup-service met het verwerken van de back-ups van meerdere klanten, back-upgegevens kopiëren vanuit een momentopname naar de back-up of een Recovery Services-kluis mogelijk niet onmiddellijk starten.</span><span class="sxs-lookup"><span data-stu-id="9b361-222">Since the Backup service is processing backups from multiple customers, copying backup data from snapshot to the backup or Recovery Services vault might not start immediately.</span></span> <span data-ttu-id="9b361-223">In tijden van piek geladen, de wachttijd kunt uitrekken tot acht uur vanwege het aantal back-ups wordt verwerkt.</span><span class="sxs-lookup"><span data-stu-id="9b361-223">In times of peak load, the wait can stretch up to eight hours due to the number of backups being processed.</span></span> <span data-ttu-id="9b361-224">De totale tijd van de VM-back-up is echter minder dan 24 uur voor dagelijkse back-upbeleid.</span><span class="sxs-lookup"><span data-stu-id="9b361-224">However, the total VM backup time is less than 24 hours for daily backup policies.</span></span>
* <span data-ttu-id="9b361-225">Overdrachtstijd gegevens, de tijd die nodig is voor Backup-service voor het berekenen van de incrementele wijzigingen van eerdere back-up en dragen deze wijzigingen naar de opslag-kluis.</span><span class="sxs-lookup"><span data-stu-id="9b361-225">Data transfer time, time needed for backup service to compute the incremental changes from previous backup and transfer those changes to vault storage.</span></span>

### <a name="why-am-i-observing-longer12-hours-backup-time"></a><span data-ttu-id="9b361-226">Waarom heb ik observeren longer(>12 hours) back-up van tijd?</span><span class="sxs-lookup"><span data-stu-id="9b361-226">Why am I observing longer(>12 hours) backup time?</span></span>
<span data-ttu-id="9b361-227">Back-up bestaat uit twee fasen: maken van momentopnamen en het overdragen van de momentopnamen die naar de kluis.</span><span class="sxs-lookup"><span data-stu-id="9b361-227">Backup consists of two phases: taking snapshots and transferring the snapshots to the vault.</span></span> <span data-ttu-id="9b361-228">De Backup-service wordt geoptimaliseerd voor opslag.</span><span class="sxs-lookup"><span data-stu-id="9b361-228">The Backup service optimizes for storage.</span></span> <span data-ttu-id="9b361-229">Als u de momentopname gegevensoverdracht naar een kluis, draagt de service alleen incrementele wijzigingen van de vorige momentopname.</span><span class="sxs-lookup"><span data-stu-id="9b361-229">When transferring the snapshot data to a vault, the service only transfers incremental changes from the previous snapshot.</span></span>  <span data-ttu-id="9b361-230">Om te bepalen de incrementele wijzigingen, wordt de controlesom van de blokken berekend door de service.</span><span class="sxs-lookup"><span data-stu-id="9b361-230">To determine the incremental changes, the service computes the checksum of the blocks.</span></span> <span data-ttu-id="9b361-231">Als een blok is gewijzigd, wordt het blok geïdentificeerd als een blok worden verzonden naar de kluis.</span><span class="sxs-lookup"><span data-stu-id="9b361-231">If a block is changed, the block is identified as a block to be sent to the vault.</span></span> <span data-ttu-id="9b361-232">De service zoomt meer vervolgens naar elk van de geïdentificeerde blokken, zoeken naar mogelijkheden om de gegevens om over te dragen minimaliseren.</span><span class="sxs-lookup"><span data-stu-id="9b361-232">Then the service drills further into each of the identified blocks, looking for opportunities to minimize the data to transfer.</span></span> <span data-ttu-id="9b361-233">Na het evalueren van alle gewijzigde blokken worden de service voegt u de wijzigingen samen en zendt deze naar de kluis.</span><span class="sxs-lookup"><span data-stu-id="9b361-233">After evaluating all changed blocks, the service coalesces the changes and sends them to the vault.</span></span> <span data-ttu-id="9b361-234">Kleine, gefragmenteerde schrijfbewerkingen zijn in sommige oudere toepassingen niet optimaal is voor de opslag.</span><span class="sxs-lookup"><span data-stu-id="9b361-234">In some legacy applications, small, fragmented writes are not optimal for storage.</span></span> <span data-ttu-id="9b361-235">Als de momentopname veel kleine, gefragmenteerde schrijfbewerkingen bevat, de service nodig heeft voor extra tijd verwerken van de gegevens die door de toepassingen worden geschreven.</span><span class="sxs-lookup"><span data-stu-id="9b361-235">If the snapshot contains many small, fragmented writes, the service spends additional time processing the data written by the applications.</span></span> <span data-ttu-id="9b361-236">De aanbevolen toepassing schrijven blok van Azure, is voor toepassingen in de virtuele machine worden uitgevoerd, een minimum van 8 KB.</span><span class="sxs-lookup"><span data-stu-id="9b361-236">The recommended application write block from Azure, for applications running inside the VM, is a minimum of 8 KB.</span></span> <span data-ttu-id="9b361-237">Als uw toepassing gebruikmaakt van een blok van minder dan 8 KB, worden back-upprestaties gedaan.</span><span class="sxs-lookup"><span data-stu-id="9b361-237">If your application uses a block of less than 8 KB, backup performance is effected.</span></span> <span data-ttu-id="9b361-238">Zie voor hulp bij het afstemmen van uw toepassing om back-prestaties te verbeteren, [afstemming van toepassingen voor optimale prestaties met Azure storage](../storage/common/storage-premium-storage-performance.md).</span><span class="sxs-lookup"><span data-stu-id="9b361-238">For help with tuning your application to improve backup performance, see [Tuning applications for optimal performance with Azure storage](../storage/common/storage-premium-storage-performance.md).</span></span> <span data-ttu-id="9b361-239">Hoewel het artikel over back-upprestaties voorbeelden voor Premium-opslag gebruikt, geldt de richtlijnen voor Standard-opslag-schijven.</span><span class="sxs-lookup"><span data-stu-id="9b361-239">Though the article on backup performance uses Premium storage examples, the guidance is applicable for Standard storage disks.</span></span>

## <a name="total-restore-time"></a><span data-ttu-id="9b361-240">Totaal aantal terugzetten</span><span class="sxs-lookup"><span data-stu-id="9b361-240">Total restore time</span></span>
<span data-ttu-id="9b361-241">Een herstelbewerking bestaat uit twee belangrijkste sub taken: gegevens terug uit de kluis te kopiëren naar het gekozen klant storage-account en het maken van de virtuele machine.</span><span class="sxs-lookup"><span data-stu-id="9b361-241">A restore operation consists of two main sub tasks: Copying data back from the vault to the chosen customer storage account, and creating the virtual machine.</span></span> <span data-ttu-id="9b361-242">Kopiëren van gegevens van de kluis, is afhankelijk van waar de back-ups op een intern in Azure worden opgeslagen en waar de klant storage-account is opgeslagen.</span><span class="sxs-lookup"><span data-stu-id="9b361-242">Copying data back from the vault depends on where the backups are stored internally in Azure, and where the customer storage account is stored.</span></span> <span data-ttu-id="9b361-243">Afhankelijk van de tijd om gegevens te kopiëren:</span><span class="sxs-lookup"><span data-stu-id="9b361-243">Time taken to copy data depends upon:</span></span>
* <span data-ttu-id="9b361-244">Wachttijd - omdat de service wordt verwerkt van meerdere klanten op hetzelfde moment hersteltaken restore-aanvragen zijn in een wachtrij plaatsen.</span><span class="sxs-lookup"><span data-stu-id="9b361-244">Queue wait time - Since the service processes restore jobs from multiple customers at the same time, restore requests are put in a queue.</span></span>
* <span data-ttu-id="9b361-245">Het kopiëren van gegevens keer - gegevens uit de kluis wordt gekopieerd naar het opslagaccount van de klant.</span><span class="sxs-lookup"><span data-stu-id="9b361-245">Data copy time - Data is copied from the vault to the customer storage account.</span></span> <span data-ttu-id="9b361-246">Terugzetten tijd is afhankelijk van IOPS en doorvoer Azure Backup-service opgehaald op de geselecteerde klant storage-account.</span><span class="sxs-lookup"><span data-stu-id="9b361-246">Restore time depends on IOPS and throughput Azure Backup service gets on the selected customer storage account.</span></span> <span data-ttu-id="9b361-247">Om het kopiëren tijdens het herstelproces versnellen, selecteer een opslagaccount is niet geladen met een andere toepassing geschreven en gelezen.</span><span class="sxs-lookup"><span data-stu-id="9b361-247">To reduce the copying time during the restore process, select a storage account not loaded with other application writes and reads.</span></span>

## <a name="best-practices"></a><span data-ttu-id="9b361-248">Aanbevolen procedures</span><span class="sxs-lookup"><span data-stu-id="9b361-248">Best practices</span></span>
<span data-ttu-id="9b361-249">We raden na deze procedures bij het configureren van de back-ups voor virtuele machines:</span><span class="sxs-lookup"><span data-stu-id="9b361-249">We suggest following these practices while configuring backups for virtual machines:</span></span>

* <span data-ttu-id="9b361-250">Niet meer dan 10 klassieke virtuele machines van de cloudservice dezelfde back-up op hetzelfde moment niet plannen.</span><span class="sxs-lookup"><span data-stu-id="9b361-250">Don't schedule more than 10 classic VMs from the same cloud service to back up at the same time.</span></span> <span data-ttu-id="9b361-251">Als u spreiden back-up van meerdere virtuele machines in dezelfde cloudservice, de begintijden van back-up van een uur wilt.</span><span class="sxs-lookup"><span data-stu-id="9b361-251">If you want to back up multiple VMs from same cloud service, stagger the backup start times by an hour.</span></span>
* <span data-ttu-id="9b361-252">Kan niet meer dan 40 VM's op hetzelfde moment back-up plannen.</span><span class="sxs-lookup"><span data-stu-id="9b361-252">Do not schedule more than 40 VMs to back up at the same time.</span></span>
* <span data-ttu-id="9b361-253">VM-back-ups plannen tijdens daluren.</span><span class="sxs-lookup"><span data-stu-id="9b361-253">Schedule VM backups during non-peak hours.</span></span> <span data-ttu-id="9b361-254">IOPS op deze manier de Backup-service gebruikt voor het overdragen van gegevens van het opslagaccount van de klant naar de kluis.</span><span class="sxs-lookup"><span data-stu-id="9b361-254">This way the Backup service uses IOPS for transferring data from the customer storage account to the vault.</span></span>
* <span data-ttu-id="9b361-255">Zorg ervoor dat er een beleid wordt toegepast op virtuele machines die zijn verdeeld over verschillende opslagaccounts.</span><span class="sxs-lookup"><span data-stu-id="9b361-255">Make sure that a policy is applied on VMs spread across different storage accounts.</span></span> <span data-ttu-id="9b361-256">We raden niet meer dan 20 totaal aantal schijven van een enkele storage-account worden beveiligd door dezelfde back-upschema.</span><span class="sxs-lookup"><span data-stu-id="9b361-256">We suggest no more than 20 total disks from a single storage account be protected by the same backup schedule.</span></span> <span data-ttu-id="9b361-257">Als u meer dan 20 schijven in een opslagaccount hebt, moet u deze VMs verdeeld over meerdere beleidsregels voor het ophalen van het vereiste aantal IOPS dat tijdens de fase van de overdracht van het back-upproces.</span><span class="sxs-lookup"><span data-stu-id="9b361-257">If you have greater than 20 disks in a storage account, spread those VMs across multiple policies to get the required IOPS during the transfer phase of the backup process.</span></span>
* <span data-ttu-id="9b361-258">Een virtuele machine uitgevoerd op de Premium-opslag hetzelfde opslagaccount niet terugzetten.</span><span class="sxs-lookup"><span data-stu-id="9b361-258">Do not restore a VM running on Premium storage to same storage account.</span></span> <span data-ttu-id="9b361-259">Als u het herstelproces bewerking samenvalt met de back-upbewerking, vermindert het aantal IOPS dat beschikbaar is voor back-up.</span><span class="sxs-lookup"><span data-stu-id="9b361-259">If the restore operation process coincides with the backup operation, it reduces the available IOPS for backup.</span></span>
* <span data-ttu-id="9b361-260">Premium VM back-up, zorg ervoor dat dit opslagaccount of premium-schijven voor hosts is ten minste 50% vrije ruimte voor het Faseren van momentopname voor een goede back-up.</span><span class="sxs-lookup"><span data-stu-id="9b361-260">For Premium VM backup, ensure that storage account that hosts premium disks has atleast 50% free space for staging snapshot for a successful backup.</span></span> 
* <span data-ttu-id="9b361-261">Zorg ervoor dat python-versie op de virtuele Linux-machines ingeschakeld voor back-up 2.7 is</span><span class="sxs-lookup"><span data-stu-id="9b361-261">Make sure that python version on Linux VMs enabled for backup is 2.7</span></span>

## <a name="data-encryption"></a><span data-ttu-id="9b361-262">Gegevensversleuteling</span><span class="sxs-lookup"><span data-stu-id="9b361-262">Data encryption</span></span>
<span data-ttu-id="9b361-263">Azure Backup biedt gegevens als onderdeel van het back-upproces niet coderen.</span><span class="sxs-lookup"><span data-stu-id="9b361-263">Azure Backup does not encrypt data as a part of the backup process.</span></span> <span data-ttu-id="9b361-264">Echter versleutelde gegevens vanuit de virtuele machine en back-up van de beveiligde gegevens naadloos (meer informatie over [back-up van de versleutelde gegevens](backup-azure-vms-encryption.md)).</span><span class="sxs-lookup"><span data-stu-id="9b361-264">However, you can encrypt data within the VM and back up the protected data seamlessly (read more about [backup of encrypted data](backup-azure-vms-encryption.md)).</span></span>

## <a name="calculating-the-cost-of-protected-instances"></a><span data-ttu-id="9b361-265">Berekenen van de kosten van beveiligde instanties</span><span class="sxs-lookup"><span data-stu-id="9b361-265">Calculating the cost of protected instances</span></span>
<span data-ttu-id="9b361-266">Azure virtuele machines die worden ondersteund door Azure Backup zijn onderworpen aan [prijzen van Azure Backup](https://azure.microsoft.com/pricing/details/backup/).</span><span class="sxs-lookup"><span data-stu-id="9b361-266">Azure virtual machines that are backed up through Azure Backup are subject to [Azure Backup pricing](https://azure.microsoft.com/pricing/details/backup/).</span></span> <span data-ttu-id="9b361-267">De exemplaren beveiligd berekening is gebaseerd op de *werkelijke* grootte van de virtuele machine, is de som van alle gegevens in de virtuele machine met uitzondering van de resource-schijf.</span><span class="sxs-lookup"><span data-stu-id="9b361-267">The Protected Instances calculation is based on the *actual* size of the virtual machine, which is the sum of all the data in the virtual machine--excluding the “resource disk.”</span></span>

<span data-ttu-id="9b361-268">Prijzen voor back-ups van virtuele machines is *niet* op basis van de maximale ondersteunde grootte voor elke gegevensschijf gekoppeld aan de virtuele machine.</span><span class="sxs-lookup"><span data-stu-id="9b361-268">Pricing for backing up VMs is *not* based on the maximum supported size for each data disk attached to the virtual machine.</span></span> <span data-ttu-id="9b361-269">Prijzen is gebaseerd op de feitelijke gegevens die zijn opgeslagen in de gegevensschijf.</span><span class="sxs-lookup"><span data-stu-id="9b361-269">Pricing is based on the actual data stored in the data disk.</span></span> <span data-ttu-id="9b361-270">Op deze manier worden de back-upopslag factuur is gebaseerd op de hoeveelheid gegevens die zijn opgeslagen in Azure back-up, dit is de som van de werkelijke gegevens in elk herstelpunt.</span><span class="sxs-lookup"><span data-stu-id="9b361-270">Similarly, the backup storage bill is based on the amount of data that is stored in Azure Backup, which is the sum of the actual data in each recovery point.</span></span>

<span data-ttu-id="9b361-271">Een standaard A2 grote virtuele machine die twee extra gegevensschijven met een maximale grootte van 1 TB heeft bijvoorbeeld op te halen.</span><span class="sxs-lookup"><span data-stu-id="9b361-271">For example, take an A2 Standard-sized virtual machine that has two additional data disks with a maximum size of 1 TB each.</span></span> <span data-ttu-id="9b361-272">De volgende tabel bevat de werkelijke hoeveelheid gegevens die zijn opgeslagen op elk van deze schijven:</span><span class="sxs-lookup"><span data-stu-id="9b361-272">The following table gives the actual data stored on each of these disks:</span></span>

| <span data-ttu-id="9b361-273">Schijftype</span><span class="sxs-lookup"><span data-stu-id="9b361-273">Disk type</span></span> | <span data-ttu-id="9b361-274">Maximale grootte</span><span class="sxs-lookup"><span data-stu-id="9b361-274">Max size</span></span> | <span data-ttu-id="9b361-275">Werkelijke gegevens aanwezig</span><span class="sxs-lookup"><span data-stu-id="9b361-275">Actual data present</span></span> |
| --- | --- | --- |
| <span data-ttu-id="9b361-276">Besturingssysteemschijf</span><span class="sxs-lookup"><span data-stu-id="9b361-276">Operating system disk</span></span> |<span data-ttu-id="9b361-277">1023 GB</span><span class="sxs-lookup"><span data-stu-id="9b361-277">1023 GB</span></span> |<span data-ttu-id="9b361-278">17 GB</span><span class="sxs-lookup"><span data-stu-id="9b361-278">17 GB</span></span> |
| <span data-ttu-id="9b361-279">Lokale schijf / Resource-schijf</span><span class="sxs-lookup"><span data-stu-id="9b361-279">Local disk / Resource disk</span></span> |<span data-ttu-id="9b361-280">135 GB</span><span class="sxs-lookup"><span data-stu-id="9b361-280">135 GB</span></span> |<span data-ttu-id="9b361-281">5 GB (niet voor back-up opgenomen)</span><span class="sxs-lookup"><span data-stu-id="9b361-281">5 GB (not included for backup)</span></span> |
| <span data-ttu-id="9b361-282">Gegevensschijf 1</span><span class="sxs-lookup"><span data-stu-id="9b361-282">Data disk 1</span></span> |<span data-ttu-id="9b361-283">1023 GB</span><span class="sxs-lookup"><span data-stu-id="9b361-283">1023 GB</span></span> |<span data-ttu-id="9b361-284">30 GB</span><span class="sxs-lookup"><span data-stu-id="9b361-284">30 GB</span></span> |
| <span data-ttu-id="9b361-285">Gegevensschijf 2</span><span class="sxs-lookup"><span data-stu-id="9b361-285">Data disk 2</span></span> |<span data-ttu-id="9b361-286">1023 GB</span><span class="sxs-lookup"><span data-stu-id="9b361-286">1023 GB</span></span> |<span data-ttu-id="9b361-287">0 GB</span><span class="sxs-lookup"><span data-stu-id="9b361-287">0 GB</span></span> |

<span data-ttu-id="9b361-288">De *werkelijke* grootte van de virtuele machine is in dit geval 17 GB + 30 GB + 0 GB = 47 GB.</span><span class="sxs-lookup"><span data-stu-id="9b361-288">The *actual* size of the virtual machine in this case is 17 GB + 30 GB + 0 GB = 47 GB.</span></span> <span data-ttu-id="9b361-289">De grootte van deze beveiligde exemplaar (47 GB), wordt de basis voor de maandelijkse factuur.</span><span class="sxs-lookup"><span data-stu-id="9b361-289">This Protected Instance size (47 GB) becomes the basis for the monthly bill.</span></span> <span data-ttu-id="9b361-290">Wanneer de hoeveelheid gegevens in de virtuele machine groeit, gebruikt de beveiligd exemplaargrootte dienovereenkomstig voor facturering wijzigingen.</span><span class="sxs-lookup"><span data-stu-id="9b361-290">As the amount of data in the virtual machine grows, the Protected Instance size used for billing changes accordingly.</span></span>

<span data-ttu-id="9b361-291">Facturering start niet totdat de eerste geslaagde back-up is voltooid.</span><span class="sxs-lookup"><span data-stu-id="9b361-291">Billing does not start until the first successful backup completes.</span></span> <span data-ttu-id="9b361-292">Op dit moment begint de facturering voor zowel opslag als beveiligd exemplaren.</span><span class="sxs-lookup"><span data-stu-id="9b361-292">At this point, the billing for both Storage and Protected Instances begins.</span></span> <span data-ttu-id="9b361-293">Facturering geldt zolang er *een back-up van gegevens die zijn opgeslagen in een kluis* voor de virtuele machine.</span><span class="sxs-lookup"><span data-stu-id="9b361-293">Billing continues as long as there is *any backup data stored in a vault* for the virtual machine.</span></span> <span data-ttu-id="9b361-294">Als u de beveiliging op de virtuele machine stoppen, maar de back-upgegevens virtuele machine in een kluis bestaat, blijft de facturering.</span><span class="sxs-lookup"><span data-stu-id="9b361-294">If you stop protection on the virtual machine, but virtual machine backup data exists in a vault, billing continues.</span></span>

<span data-ttu-id="9b361-295">Financieel voor een opgegeven virtuele machine stopt alleen als de beveiliging is gestopt *en* alle back-gegevens worden verwijderd.</span><span class="sxs-lookup"><span data-stu-id="9b361-295">Billing for a specified virtual machine stops only if the protection is stopped *and* all backup data is deleted.</span></span> <span data-ttu-id="9b361-296">Wanneer de beveiliging stopt en er zijn geen actieve back-taken, de grootte van de laatste geslaagde VM back-up wordt de grootte van de beveiligde exemplaar gebruikt voor de maandelijkse factuur.</span><span class="sxs-lookup"><span data-stu-id="9b361-296">When protection stops and there are no active backup jobs, the size of the last successful VM backup becomes the Protected Instance size used for the monthly bill.</span></span>

## <a name="questions"></a><span data-ttu-id="9b361-297">Vragen?</span><span class="sxs-lookup"><span data-stu-id="9b361-297">Questions?</span></span>
<span data-ttu-id="9b361-298">Als u vragen hebt of als er een functie is die u graag opgenomen ziet worden, [stuur ons dan uw feedback](http://aka.ms/azurebackup_feedback).</span><span class="sxs-lookup"><span data-stu-id="9b361-298">If you have questions, or if there is any feature that you would like to see included, [send us feedback](http://aka.ms/azurebackup_feedback).</span></span>

## <a name="next-steps"></a><span data-ttu-id="9b361-299">Volgende stappen</span><span class="sxs-lookup"><span data-stu-id="9b361-299">Next steps</span></span>
* [<span data-ttu-id="9b361-300">Back-up van virtuele machines</span><span class="sxs-lookup"><span data-stu-id="9b361-300">Back up virtual machines</span></span>](backup-azure-vms.md)
* [<span data-ttu-id="9b361-301">Back-up van virtuele machine beheren</span><span class="sxs-lookup"><span data-stu-id="9b361-301">Manage virtual machine backup</span></span>](backup-azure-manage-vms.md)
* [<span data-ttu-id="9b361-302">Virtuele machines herstellen</span><span class="sxs-lookup"><span data-stu-id="9b361-302">Restore virtual machines</span></span>](backup-azure-restore-vms.md)
* [<span data-ttu-id="9b361-303">VM-back-problemen</span><span class="sxs-lookup"><span data-stu-id="9b361-303">Troubleshoot VM backup issues</span></span>](backup-azure-vms-troubleshoot.md)
