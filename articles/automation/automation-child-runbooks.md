---
title: Onderliggende runbooks in Azure Automation | Microsoft Docs
description: Beschrijft de verschillende methoden voor het starten van een runbook in Azure Automation vanuit een ander runbook en delen van gegevens tussen deze.
services: automation
documentationcenter: 
author: mgoedtel
manager: jwhit
editor: tysonn
ms.assetid: 919887b9-43e2-4c16-883c-f81807fe37db
ms.service: automation
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 02/02/2017
ms.author: magoedte;bwren
ms.openlocfilehash: a605d278dbbda9613b91007ea6a7042403a7a6ff
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 07/11/2017
---
# <a name="child-runbooks-in-azure-automation"></a><span data-ttu-id="ad498-103">Onderliggende runbooks in Azure Automation</span><span class="sxs-lookup"><span data-stu-id="ad498-103">Child runbooks in Azure Automation</span></span>
<span data-ttu-id="ad498-104">Het is een best practice in Azure Automation schrijven herbruikbare, modulaire runbooks met een aparte functie die kan worden gebruikt door andere runbooks.</span><span class="sxs-lookup"><span data-stu-id="ad498-104">It is a best practice in Azure Automation to write reusable, modular runbooks with a discrete function that can be used by other runbooks.</span></span> <span data-ttu-id="ad498-105">Een bovenliggend runbook roept vaak een of meer onderliggende runbooks om uit te voeren van de vereiste functionaliteit.</span><span class="sxs-lookup"><span data-stu-id="ad498-105">A parent runbook will often call one or more child runbooks to perform required functionality.</span></span> <span data-ttu-id="ad498-106">Er zijn twee manieren om aan te roepen, een onderliggend runbook en elke manier kent duidelijke verschillen die u moet begrijpen zodat u kunt bepalen wat de beste optie voor uw verschillende scenario's.</span><span class="sxs-lookup"><span data-stu-id="ad498-106">There are two ways to call a child runbook, and each has distinct differences that you should understand so that you can determine which will be best for your different scenarios.</span></span>

## <a name="invoking-a-child-runbook-using-inline-execution"></a><span data-ttu-id="ad498-107">Aanroepen van een onderliggend runbook met inline-uitvoering</span><span class="sxs-lookup"><span data-stu-id="ad498-107">Invoking a child runbook using inline execution</span></span>
<span data-ttu-id="ad498-108">Als u wilt een runbook inline vanuit een ander runbook aanroepen, gebruikt u de naam van het runbook en geef waarden op voor de parameters precies zoals wanneer u een activiteit of cmdlet.</span><span class="sxs-lookup"><span data-stu-id="ad498-108">To invoke a runbook inline from another runbook, you use the name of the runbook and provide values for its parameters exactly like you would use an activity or cmdlet.</span></span>  <span data-ttu-id="ad498-109">Alle runbooks in dezelfde Automation-account zijn beschikbaar voor alle andere moet op deze manier worden gebruikt.</span><span class="sxs-lookup"><span data-stu-id="ad498-109">All runbooks in the same Automation account are available to all others to be used in this manner.</span></span> <span data-ttu-id="ad498-110">Het bovenliggende runbook wacht tot het onderliggende runbook om te voltooien voordat u doorgaat naar de volgende regel, en eventuele uitvoer rechtstreeks aan het bovenliggende object wordt geretourneerd.</span><span class="sxs-lookup"><span data-stu-id="ad498-110">The parent runbook will wait for the child runbook to complete before moving to the next line, and any output is returned directly to the parent.</span></span>

<span data-ttu-id="ad498-111">Als u een runbook inline aanroept, deze wordt uitgevoerd in dezelfde taak als het bovenliggende runbook.</span><span class="sxs-lookup"><span data-stu-id="ad498-111">When you invoke a runbook inline, it runs in the same job as the parent runbook.</span></span> <span data-ttu-id="ad498-112">Er zijn geen vermelding in de taakgeschiedenis van het onderliggende runbook die is uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="ad498-112">There will be no indication in the job history of the child runbook that it ran.</span></span> <span data-ttu-id="ad498-113">Eventuele uitzonderingen en eventuele Stroomuitvoer van het onderliggende runbook worden gekoppeld aan het bovenliggende item zijn.</span><span class="sxs-lookup"><span data-stu-id="ad498-113">Any exceptions and any stream output from the child runbook will be associated with the parent.</span></span> <span data-ttu-id="ad498-114">Dit resulteert in minder taken en zorgt ervoor dat ze gemakkelijker om bij te houden en op te lossen omdat eventuele uitzonderingen worden veroorzaakt door het onderliggende runbook en de Stroomuitvoer gekoppeld aan de bovenliggende taak zijn.</span><span class="sxs-lookup"><span data-stu-id="ad498-114">This results in fewer jobs and makes them easier to track and to troubleshoot since any exceptions thrown by the child runbook and any of its stream output are associated with the parent job.</span></span>

<span data-ttu-id="ad498-115">Wanneer een runbook wordt gepubliceerd, moet alle onderliggende runbooks die daardoor worden aangeroepen al zijn gepubliceerd.</span><span class="sxs-lookup"><span data-stu-id="ad498-115">When a runbook is published, any child runbooks that it calls must already be published.</span></span> <span data-ttu-id="ad498-116">Dit is omdat Azure Automation een koppeling met onderliggende runbooks maakt wanneer een runbook wordt gecompileerd.</span><span class="sxs-lookup"><span data-stu-id="ad498-116">This is because Azure Automation builds an association with any child runbooks when a runbook is compiled.</span></span> <span data-ttu-id="ad498-117">Als ze niet, is het bovenliggende runbook correct wordt gepubliceerd wordt weergegeven, maar wordt een uitzondering gegenereerd wanneer deze wordt gestart.</span><span class="sxs-lookup"><span data-stu-id="ad498-117">If they aren’t, the parent runbook will appear to publish properly, but will generate an exception when it’s started.</span></span> <span data-ttu-id="ad498-118">Als dit gebeurt, kunt u het bovenliggende runbook opnieuw publiceren om correct wordt verwezen naar de onderliggende runbooks.</span><span class="sxs-lookup"><span data-stu-id="ad498-118">If this happens, you can republish the parent runbook in order to properly reference the child runbooks.</span></span> <span data-ttu-id="ad498-119">U hoeft niet naar het bovenliggende runbook opnieuw publiceren als een van de onderliggende runbooks worden gewijzigd omdat de koppeling wordt al zijn gemaakt.</span><span class="sxs-lookup"><span data-stu-id="ad498-119">You do not need to republish the parent runbook if any of the child runbooks are changed because the association will have already been created.</span></span>

<span data-ttu-id="ad498-120">Elk gegevenstype met inbegrip van complexe objecten kunnen worden door de parameters van een onderliggend runbook dat inline wordt aangeroepen en er is geen [JSON-serialisatie](automation-starting-a-runbook.md#runbook-parameters) omdat er bij het starten van het runbook met behulp van de Azure-beheerportal of met de cmdlet Start-AzureRmAutomationRunbook.</span><span class="sxs-lookup"><span data-stu-id="ad498-120">The parameters of a child runbook called inline can be any data type including complex objects, and there is no [JSON serialization](automation-starting-a-runbook.md#runbook-parameters) as there is when you start the runbook using the Azure Management Portal or with the Start-AzureRmAutomationRunbook cmdlet.</span></span>

### <a name="runbook-types"></a><span data-ttu-id="ad498-121">Runbooktypen</span><span class="sxs-lookup"><span data-stu-id="ad498-121">Runbook types</span></span>
<span data-ttu-id="ad498-122">Welke typen kunnen bellen elkaar:</span><span class="sxs-lookup"><span data-stu-id="ad498-122">Which types can call each other:</span></span>

* <span data-ttu-id="ad498-123">Een [PowerShell-runbook](automation-runbook-types.md#powershell-runbooks) en [grafische runbooks](automation-runbook-types.md#graphical-runbooks) elke andere inline (beide zijn op basis van PowerShell) kunt aanroepen.</span><span class="sxs-lookup"><span data-stu-id="ad498-123">A [PowerShell runbook](automation-runbook-types.md#powershell-runbooks) and [Graphical runbooks](automation-runbook-types.md#graphical-runbooks) can call each other inline (both are PowerShell based).</span></span>
* <span data-ttu-id="ad498-124">Een [PowerShell Workflow-runbook](automation-runbook-types.md#powershell-workflow-runbooks) en grafische PowerShell Workflow-runbooks, kunnen elke andere inline (beide zijn op basis van PowerShell-werkstroom) aangeroepen.</span><span class="sxs-lookup"><span data-stu-id="ad498-124">A [PowerShell Workflow runbook](automation-runbook-types.md#powershell-workflow-runbooks) and Graphical PowerShell Workflow runbooks can call each other inline (both are PowerShell Workflow based)</span></span>
* <span data-ttu-id="ad498-125">De PowerShell-typen en de typen PowerShell Workflow elkaar inline kunnen niet worden aangeroepen en Start AzureRmAutomationRunbook moeten gebruiken.</span><span class="sxs-lookup"><span data-stu-id="ad498-125">The PowerShell types and the PowerShell Workflow types can’t call each other inline, and must use Start-AzureRmAutomationRunbook.</span></span>

<span data-ttu-id="ad498-126">Wanneer volgorde zaak wordt gepubliceerd:</span><span class="sxs-lookup"><span data-stu-id="ad498-126">When does publish order matter:</span></span>

* <span data-ttu-id="ad498-127">De volgorde van het publiceren van runbooks is alleen van belang voor PowerShell-werkstromen en grafische PowerShell Workflow-runbooks.</span><span class="sxs-lookup"><span data-stu-id="ad498-127">The publish order of runbooks only matters for PowerShell Workflow and Graphical PowerShell Workflow runbooks.</span></span>

<span data-ttu-id="ad498-128">Wanneer u een grafisch of PowerShell-werkstroom onderliggend runbook met inline-uitvoering aanroepen, gebruikt u alleen de naam van het runbook.</span><span class="sxs-lookup"><span data-stu-id="ad498-128">When you call a Graphical or PowerShell Workflow child runbook using inline execution, you just use the name of the runbook.</span></span>  <span data-ttu-id="ad498-129">Wanneer u een PowerShell-onderliggend runbook aanroepen, moet u dezelfde naam hebben als voorafgegaan *.\\*  om op te geven dat het script in de lokale map bevinden zich.</span><span class="sxs-lookup"><span data-stu-id="ad498-129">When you call a PowerShell child runbook, you must preceded its name with *.\\* to specify that the script is located in the local directory.</span></span> 

### <a name="example"></a><span data-ttu-id="ad498-130">Voorbeeld</span><span class="sxs-lookup"><span data-stu-id="ad498-130">Example</span></span>
<span data-ttu-id="ad498-131">Het volgende voorbeeld wordt een onderliggend testrunbook dat drie parameters, een complex object, een geheel getal en een Boolean-waarde accepteert.</span><span class="sxs-lookup"><span data-stu-id="ad498-131">The following example invokes a test child runbook that accepts three parameters, a complex object, an integer, and a boolean.</span></span> <span data-ttu-id="ad498-132">De uitvoer van het onderliggende runbook is toegewezen aan een variabele.</span><span class="sxs-lookup"><span data-stu-id="ad498-132">The output of the child runbook is assigned to a variable.</span></span>  <span data-ttu-id="ad498-133">In dit geval wordt is het onderliggende runbook een PowerShell Workflow-runbook</span><span class="sxs-lookup"><span data-stu-id="ad498-133">In this case, the child runbook is a PowerShell Workflow runbook</span></span>

    $vm = Get-AzureRmVM –ResourceGroupName "LabRG" –Name "MyVM"
    $output = PSWF-ChildRunbook –VM $vm –RepeatCount 2 –Restart $true

<span data-ttu-id="ad498-134">Hier volgt het hetzelfde voorbeeld met een PowerShell-runbook als het onderliggende object.</span><span class="sxs-lookup"><span data-stu-id="ad498-134">Following is the same example using a PowerShell runbook as the child.</span></span>

    $vm = Get-AzureRmVM –ResourceGroupName "LabRG" –Name "MyVM"
    $output = .\PS-ChildRunbook.ps1 –VM $vm –RepeatCount 2 –Restart $true


## <a name="starting-a-child-runbook-using-cmdlet"></a><span data-ttu-id="ad498-135">Een onderliggend runbook met behulp van de cmdlet starten</span><span class="sxs-lookup"><span data-stu-id="ad498-135">Starting a child runbook using cmdlet</span></span>
<span data-ttu-id="ad498-136">U kunt de [Start AzureRmAutomationRunbook](https://msdn.microsoft.com/library/mt603661.aspx) cmdlet een runbook starten, zoals beschreven in [een runbook starten met Windows PowerShell](automation-starting-a-runbook.md#starting-a-runbook-with-windows-powershell).</span><span class="sxs-lookup"><span data-stu-id="ad498-136">You can use the [Start-AzureRmAutomationRunbook](https://msdn.microsoft.com/library/mt603661.aspx) cmdlet to start a runbook as described in [To start a runbook with Windows PowerShell](automation-starting-a-runbook.md#starting-a-runbook-with-windows-powershell).</span></span> <span data-ttu-id="ad498-137">Er zijn twee modi voor deze cmdlet.</span><span class="sxs-lookup"><span data-stu-id="ad498-137">There are two modes of use for this cmdlet.</span></span>  <span data-ttu-id="ad498-138">De cmdlet retourneert de taak-id in één modus zodra de onderliggende taak is gemaakt voor het onderliggende runbook.</span><span class="sxs-lookup"><span data-stu-id="ad498-138">In one mode, the cmdlet returns the job id as soon as the child job is created for the child runbook.</span></span>  <span data-ttu-id="ad498-139">In de andere modus, waarbij u door het opgeven van inschakelen de **-wacht** parameter, de cmdlet gewacht tot de onderliggende taak is voltooid en de uitvoer van het onderliggende runbook wordt geretourneerd.</span><span class="sxs-lookup"><span data-stu-id="ad498-139">In the other mode, which you enable by specifying the **-wait** parameter, the cmdlet will wait until the child job finishes and will return the output from the child runbook.</span></span>

<span data-ttu-id="ad498-140">De taak van een onderliggend runbook dat is gestart met een cmdlet wordt uitgevoerd in een afzonderlijke taak van het bovenliggende runbook.</span><span class="sxs-lookup"><span data-stu-id="ad498-140">The job from a child runbook started with a cmdlet will run in a separate job from the parent runbook.</span></span> <span data-ttu-id="ad498-141">Dit resulteert in meer taken dan het runbook inline wordt aangeroepen en maakt ze moeilijker te volgen.</span><span class="sxs-lookup"><span data-stu-id="ad498-141">This results in more jobs than invoking the runbook inline and makes them more difficult to track.</span></span> <span data-ttu-id="ad498-142">De bovenliggende kan meerdere onderliggende runbooks asynchroon starten zonder te wachten op elk daarvan is voltooid.</span><span class="sxs-lookup"><span data-stu-id="ad498-142">The parent can start multiple child runbooks asynchronously without waiting for each to complete.</span></span> <span data-ttu-id="ad498-143">Voor dezelfde soort parallelle uitvoering de onderliggende runbooks inline aanroepen, moet het bovenliggende runbook gebruiken de [parallelle sleutelwoord](automation-powershell-workflow.md#parallel-processing).</span><span class="sxs-lookup"><span data-stu-id="ad498-143">For that same kind of parallel execution calling the child runbooks inline, the parent runbook would need to use the [parallel keyword](automation-powershell-workflow.md#parallel-processing).</span></span>

<span data-ttu-id="ad498-144">Parameters voor een onderliggend runbook dat is gestart met een cmdlet worden opgegeven als hashtabel, zoals beschreven in [Runbookparameters](automation-starting-a-runbook.md#runbook-parameters).</span><span class="sxs-lookup"><span data-stu-id="ad498-144">Parameters for a child runbook started with a cmdlet are provided as a hashtable as described in [Runbook Parameters](automation-starting-a-runbook.md#runbook-parameters).</span></span> <span data-ttu-id="ad498-145">Alleen eenvoudige gegevenstypen kunnen worden gebruikt.</span><span class="sxs-lookup"><span data-stu-id="ad498-145">Only simple data types can be used.</span></span> <span data-ttu-id="ad498-146">Als het runbook een parameter met een complex gegevenstype heeft, moet klikt u vervolgens het worden aangeroepen inline.</span><span class="sxs-lookup"><span data-stu-id="ad498-146">If the runbook has a parameter with a complex data type, then it must be called inline.</span></span>

### <a name="example"></a><span data-ttu-id="ad498-147">Voorbeeld</span><span class="sxs-lookup"><span data-stu-id="ad498-147">Example</span></span>
<span data-ttu-id="ad498-148">Het volgende voorbeeld wordt een onderliggend runbook met parameters gestart en wordt er gewacht totdat deze is voltooid met behulp van de Start-AzureRmAutomationRunbook-parameter wacht.</span><span class="sxs-lookup"><span data-stu-id="ad498-148">The following example starts a child runbook with parameters and then waits for it to complete using the Start-AzureRmAutomationRunbook -wait parameter.</span></span> <span data-ttu-id="ad498-149">Zodra voltooid, wordt de uitvoer van het onderliggende runbook verzameld.</span><span class="sxs-lookup"><span data-stu-id="ad498-149">Once completed, its output is collected from the child runbook.</span></span>

    $params = @{"VMName"="MyVM";"RepeatCount"=2;"Restart"=$true} 
    $joboutput = Start-AzureRmAutomationRunbook –AutomationAccountName "MyAutomationAccount" –Name "Test-ChildRunbook" -ResourceGroupName "LabRG" –Parameters $params –wait


## <a name="comparison-of-methods-for-calling-a-child-runbook"></a><span data-ttu-id="ad498-150">Vergelijking van methoden voor het aanroepen van een onderliggend runbook</span><span class="sxs-lookup"><span data-stu-id="ad498-150">Comparison of methods for calling a child runbook</span></span>
<span data-ttu-id="ad498-151">De volgende tabel geeft een overzicht van de verschillen tussen de twee methoden voor het aanroepen van een runbook vanuit een ander runbook.</span><span class="sxs-lookup"><span data-stu-id="ad498-151">The following table summarizes the differences between the two methods for calling a runbook from another runbook.</span></span>

|  | <span data-ttu-id="ad498-152">Inline</span><span class="sxs-lookup"><span data-stu-id="ad498-152">Inline</span></span> | <span data-ttu-id="ad498-153">Cmdlet</span><span class="sxs-lookup"><span data-stu-id="ad498-153">Cmdlet</span></span> |
|:--- |:--- |:--- |
| <span data-ttu-id="ad498-154">Job</span><span class="sxs-lookup"><span data-stu-id="ad498-154">Job</span></span> |<span data-ttu-id="ad498-155">Onderliggende runbooks worden uitgevoerd in dezelfde taak als het bovenliggende item.</span><span class="sxs-lookup"><span data-stu-id="ad498-155">Child runbooks run in the same job as the parent.</span></span> |<span data-ttu-id="ad498-156">Een afzonderlijke taak is voor het onderliggende runbook gemaakt.</span><span class="sxs-lookup"><span data-stu-id="ad498-156">A separate job is created for the child runbook.</span></span> |
| <span data-ttu-id="ad498-157">Uitvoering</span><span class="sxs-lookup"><span data-stu-id="ad498-157">Execution</span></span> |<span data-ttu-id="ad498-158">Bovenliggend runbook wacht tot het onderliggende runbook om te voltooien voordat u doorgaat.</span><span class="sxs-lookup"><span data-stu-id="ad498-158">Parent runbook waits for the child runbook to complete before continuing.</span></span> |<span data-ttu-id="ad498-159">Bovenliggend runbook gaat direct verder nadat onderliggend runbook is gestart *of* bovenliggend runbook wacht tot de onderliggende taak is voltooid.</span><span class="sxs-lookup"><span data-stu-id="ad498-159">Parent runbook continues immediately after child runbook is started *or* parent runbook waits for the child job to finish.</span></span> |
| <span data-ttu-id="ad498-160">Uitvoer</span><span class="sxs-lookup"><span data-stu-id="ad498-160">Output</span></span> |<span data-ttu-id="ad498-161">Bovenliggend runbook kan uitvoer rechtstreeks ophalen van onderliggend runbook.</span><span class="sxs-lookup"><span data-stu-id="ad498-161">Parent runbook can directly get output from child runbook.</span></span> |<span data-ttu-id="ad498-162">Bovenliggend runbook moet uitvoer ophalen uit taak van onderliggend runbook *of* bovenliggend runbook kan uitvoer rechtstreeks ophalen van onderliggend runbook.</span><span class="sxs-lookup"><span data-stu-id="ad498-162">Parent runbook must retrieve output from child runbook job *or* parent runbook can directly get output from child runbook.</span></span> |
| <span data-ttu-id="ad498-163">Parameters</span><span class="sxs-lookup"><span data-stu-id="ad498-163">Parameters</span></span> |<span data-ttu-id="ad498-164">Waarden voor de parameters van onderliggend runbook worden afzonderlijk opgegeven en elk gegevenstype kunnen gebruiken.</span><span class="sxs-lookup"><span data-stu-id="ad498-164">Values for the child runbook parameters are specified separately and can use any data type.</span></span> |<span data-ttu-id="ad498-165">Waarden voor de parameters van onderliggend runbook moeten worden gecombineerd in één hashtabel en kunnen alleen bestaan uit eenvoudig, matrix en object-gegevenstypen die gebruiken voor de JSON-serialisatie.</span><span class="sxs-lookup"><span data-stu-id="ad498-165">Values for the child runbook parameters must be combined into a single hashtable and can only include simple, array, and object data types that leverage JSON serialization.</span></span> |
| <span data-ttu-id="ad498-166">Automation-account</span><span class="sxs-lookup"><span data-stu-id="ad498-166">Automation Account</span></span> |<span data-ttu-id="ad498-167">Bovenliggend runbook kan alleen onderliggend runbook in de dezelfde automation-account gebruiken.</span><span class="sxs-lookup"><span data-stu-id="ad498-167">Parent runbook can only use child runbook in the same automation account.</span></span> |<span data-ttu-id="ad498-168">Bovenliggend runbook kunt onderliggend runbook vanuit een automation-account van de dezelfde Azure-abonnement en zelfs een ander abonnement gebruiken als u een verbinding mee hebt.</span><span class="sxs-lookup"><span data-stu-id="ad498-168">Parent runbook can use child runbook from any automation account from the same Azure subscription and even a different subscription if you have a connection to it.</span></span> |
| <span data-ttu-id="ad498-169">Publiceren</span><span class="sxs-lookup"><span data-stu-id="ad498-169">Publishing</span></span> |<span data-ttu-id="ad498-170">Onderliggend runbook moet worden gepubliceerd voordat bovenliggend runbook wordt gepubliceerd.</span><span class="sxs-lookup"><span data-stu-id="ad498-170">Child runbook must be published before parent runbook is published.</span></span> |<span data-ttu-id="ad498-171">Onderliggend runbook moet worden gepubliceerd voordat bovenliggend runbook wordt gestart.</span><span class="sxs-lookup"><span data-stu-id="ad498-171">Child runbook must be published any time before parent runbook is started.</span></span> |

## <a name="next-steps"></a><span data-ttu-id="ad498-172">Volgende stappen</span><span class="sxs-lookup"><span data-stu-id="ad498-172">Next steps</span></span>
* [<span data-ttu-id="ad498-173">Een runbook starten in Azure Automation</span><span class="sxs-lookup"><span data-stu-id="ad498-173">Starting a runbook in Azure Automation</span></span>](automation-starting-a-runbook.md)
* [<span data-ttu-id="ad498-174">Runbookuitvoer en -berichten in Azure Automation</span><span class="sxs-lookup"><span data-stu-id="ad498-174">Runbook output and messages in Azure Automation</span></span>](automation-runbook-output-and-messages.md)

