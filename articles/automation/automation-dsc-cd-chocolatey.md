---
title: Automation DSC continue implementatie met Chocolatey aaaAzure | Microsoft Docs
description: DevOps continue implementatie met Azure Automation DSC en Chocolatey Pakketbeheer.  Voorbeeld met volledige JSON ARM-sjabloon en de PowerShell-bron.
services: automation
documentationcenter: 
author: eslesar
manager: carmonm
editor: tysonn
ms.assetid: c0baa411-eb76-4f91-8d14-68f68b4805b6
ms.service: automation
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: vm-windows
ms.workload: na
ms.date: 10/29/2016
ms.author: golive
ms.openlocfilehash: 60af52af5f834fd48e3a0dc4677919397b53f0f4
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 10/06/2017
---
# <a name="usage-example-continuous-deployment-toovirtual-machines-using-automation-dsc-and-chocolatey"></a><span data-ttu-id="7e59f-104">Voorbeeld van gebruik: Continue implementatie tooVirtual Machines met behulp van Automation DSC en Chocolatey</span><span class="sxs-lookup"><span data-stu-id="7e59f-104">Usage Example: Continuous deployment tooVirtual Machines using Automation DSC and Chocolatey</span></span>
<span data-ttu-id="7e59f-105">In een wereld DevOps zijn er veel extra tooassist met verschillende punten in Hallo continue integratie pijplijn.</span><span class="sxs-lookup"><span data-stu-id="7e59f-105">In a DevOps world there are many tools tooassist with various points in hello Continuous Integration pipeline.</span></span>  <span data-ttu-id="7e59f-106">Azure Automation gewenst State Configuration (DSC) is een nieuwe toevoeging toohello opties Welkom die DevOps teams kunnen gebruiken.</span><span class="sxs-lookup"><span data-stu-id="7e59f-106">Azure Automation Desired State Configuration (DSC) is a welcome new addition toohello options that DevOps teams can employ.</span></span>  <span data-ttu-id="7e59f-107">In dit artikel wordt gedemonstreerd instelling van continue implementatie (CD) voor een Windows-computer.</span><span class="sxs-lookup"><span data-stu-id="7e59f-107">This article demonstrates setting up Continuous Deployment (CD) for a Windows computer.</span></span>  <span data-ttu-id="7e59f-108">Kunt u gemakkelijk uitbreiden Hallo techniek tooinclude zoveel Windows-computers, indien nodig in Hallo-rol (bijvoorbeeld een website) en er tooadditional ook rollen.</span><span class="sxs-lookup"><span data-stu-id="7e59f-108">You can easily extend hello technique tooinclude as many Windows computers as necessary in hello role (a web site, for example), and from there tooadditional roles as well.</span></span>

![Continue implementatie voor IaaS VM 's](./media/automation-dsc-cd-chocolatey/cdforiaasvm.png)

## <a name="at-a-high-level"></a><span data-ttu-id="7e59f-110">Op hoog niveau</span><span class="sxs-lookup"><span data-stu-id="7e59f-110">At a high level</span></span>
<span data-ttu-id="7e59f-111">Er is heel wat hier, maar gelukkig kunnen worden onderverdeeld in twee belangrijkste processen:</span><span class="sxs-lookup"><span data-stu-id="7e59f-111">There is quite a bit going on here, but fortunately it can be broken into two main processes:</span></span> 

* <span data-ttu-id="7e59f-112">Schrijven van code testen, maken en publiceren installatiepakketten voor de primaire en secundaire versies van Hallo-systeem.</span><span class="sxs-lookup"><span data-stu-id="7e59f-112">Writing code and testing it, then creating and publishing installation packages for major and minor versions of hello system.</span></span> 
* <span data-ttu-id="7e59f-113">Maken en beheren van virtuele machines die u installeert en Hallo code uitvoeren in hello-pakketten.</span><span class="sxs-lookup"><span data-stu-id="7e59f-113">Creating and managing VMs that will install and execute hello code in hello packages.</span></span>  

<span data-ttu-id="7e59f-114">Als beide core processen uitgevoerd worden, is een korte stap tooautomatically Hallo updatepakket naar nieuwe versies worden gemaakt en geïmplementeerd op een bepaalde virtuele machine wordt uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="7e59f-114">Once both of these core processes are in place, it’s a short step tooautomatically update hello package running on any particular VM as new versions are created and deployed.</span></span>

## <a name="component-overview"></a><span data-ttu-id="7e59f-115">Onderdelenoverzicht van het</span><span class="sxs-lookup"><span data-stu-id="7e59f-115">Component overview</span></span>
<span data-ttu-id="7e59f-116">Pakket managers zoals [apt get-](https://en.wikipedia.org/wiki/Advanced_Packaging_Tool) in Hallo Linux wereld, maar niet zoveel in Windows-wereld Hallo vrij bekend zijn.</span><span class="sxs-lookup"><span data-stu-id="7e59f-116">Package managers such as [apt-get](https://en.wikipedia.org/wiki/Advanced_Packaging_Tool) are pretty well known in hello Linux world, but not so much in hello Windows world.</span></span>  <span data-ttu-id="7e59f-117">[Chocolatey](https://chocolatey.org/) is zo'n ding en van Scott Hanselman [blog](http://www.hanselman.com/blog/IsTheWindowsUserReadyForAptget.aspx) op Hallo onderwerp is een uitstekende inleiding.</span><span class="sxs-lookup"><span data-stu-id="7e59f-117">[Chocolatey](https://chocolatey.org/) is such a thing, and Scott Hanselman’s [blog](http://www.hanselman.com/blog/IsTheWindowsUserReadyForAptget.aspx) on hello topic is a great intro.</span></span>  <span data-ttu-id="7e59f-118">Kortom, kunt Chocolatey u tooinstall pakketten vanuit een centrale opslagplaats van pakketten in een Windows-systeem met Hallo-opdrachtregel.</span><span class="sxs-lookup"><span data-stu-id="7e59f-118">In a nutshell, Chocolatey allows you tooinstall packages from a central repository of packages into a Windows system using hello command line.</span></span>  <span data-ttu-id="7e59f-119">U kunt maken en beheren van uw eigen opslagplaats en Chocolatey kunt pakketten installeren van een willekeurig aantal opslagplaatsen die u opgeeft.</span><span class="sxs-lookup"><span data-stu-id="7e59f-119">You can create and manage your own repository, and Chocolatey can install packages from any number of repositories that you designate.</span></span>

<span data-ttu-id="7e59f-120">Desired State Configuration (DSC) ([overzicht](https://technet.microsoft.com/library/dn249912.aspx)) is een PowerShell-hulpprogramma waarmee u toodeclare Hallo configuratie die u voor een machine wilt.</span><span class="sxs-lookup"><span data-stu-id="7e59f-120">Desired State Configuration (DSC) ([overview](https://technet.microsoft.com/library/dn249912.aspx)) is a PowerShell tool that allows you toodeclare hello configuration that you want for a machine.</span></span>  <span data-ttu-id="7e59f-121">U kunt bijvoorbeeld, "Ik wil Chocolatey geïnstalleerd, ik wil dat IIS is geïnstalleerd, ik wil dat de poort 80 is geopend, ik wil versie 1.0.0 van mijn website geïnstalleerd."</span><span class="sxs-lookup"><span data-stu-id="7e59f-121">For example, you can say, “I want Chocolatey installed, I want IIS installed, I want port 80 opened, I want version 1.0.0 of my website installed.”</span></span>  <span data-ttu-id="7e59f-122">Hallo DSC Local Configuration Manager implementeert (LCM) dat de configuratie.</span><span class="sxs-lookup"><span data-stu-id="7e59f-122">hello DSC Local Configuration Manager (LCM) implements that configuration.</span></span> <span data-ttu-id="7e59f-123">Een DSC-Pull-Server bevat een opslagplaats van configuraties voor uw machines.</span><span class="sxs-lookup"><span data-stu-id="7e59f-123">A DSC Pull Server holds a repository of configurations for your machines.</span></span> <span data-ttu-id="7e59f-124">Hallo LCM op elke machine controleert in periodiek toosee als de configuratie ervan overeenkomt met de opgeslagen configuratie Hallo.</span><span class="sxs-lookup"><span data-stu-id="7e59f-124">hello LCM on each machine checks in periodically toosee if its configuration matches hello stored configuration.</span></span> <span data-ttu-id="7e59f-125">Het kan status rapporteren of toobring Hallo machine weer in uitlijning met de opgeslagen configuratie Hallo proberen.</span><span class="sxs-lookup"><span data-stu-id="7e59f-125">It can either report status or attempt toobring hello machine back into alignment with hello stored configuration.</span></span> <span data-ttu-id="7e59f-126">Hallo opgeslagen configuratie op Hallo pull-server toocause een machine of een reeks machines toocome uitgelijnd met de configuratie Hallo gewijzigd, kunt u bewerken.</span><span class="sxs-lookup"><span data-stu-id="7e59f-126">You can edit hello stored configuration on hello pull server toocause a machine or set of machines toocome into alignment with hello changed configuration.</span></span>

<span data-ttu-id="7e59f-127">Azure Automation is een beheerde service in Microsoft Azure waarmee u tooautomate diverse taken met behulp van runbooks, knooppunten, referenties, bronnen en activa zoals schema's en globale variabelen.</span><span class="sxs-lookup"><span data-stu-id="7e59f-127">Azure Automation is a managed service in Microsoft Azure that allows you tooautomate various tasks using runbooks, nodes, credentials, resources and assets such as schedules and global variables.</span></span> <span data-ttu-id="7e59f-128">Azure Automation DSC breidt deze automatisering mogelijkheid tooinclude PowerShell DSC-hulpprogramma's.</span><span class="sxs-lookup"><span data-stu-id="7e59f-128">Azure Automation DSC extends this automation capability tooinclude PowerShell DSC tools.</span></span>  <span data-ttu-id="7e59f-129">Hier volgt een geweldige [overzicht](automation-dsc-overview.md).</span><span class="sxs-lookup"><span data-stu-id="7e59f-129">Here’s a great [overview](automation-dsc-overview.md).</span></span>

<span data-ttu-id="7e59f-130">Een DSC-Resource is een module van code die de specifieke mogelijkheden, zoals het beheren van netwerken, Active Directory of SQL Server is.</span><span class="sxs-lookup"><span data-stu-id="7e59f-130">A DSC Resource is a module of code that has specific capabilities, such as managing networking, Active Directory, or SQL Server.</span></span>  <span data-ttu-id="7e59f-131">Hallo Chocolatey DSC-Resource weet hoe tooaccess een NuGet-Server (onder andere) pakketten downloaden, installeren van pakketten, enzovoort.</span><span class="sxs-lookup"><span data-stu-id="7e59f-131">hello Chocolatey DSC Resource knows how tooaccess a NuGet Server (among others), download packages, install packages, and so on.</span></span>  <span data-ttu-id="7e59f-132">Er zijn veel andere DSC-Resources in Hallo [PowerShell Gallery](http://www.powershellgallery.com/packages?q=dsc+resources&prerelease=&sortOrder=package-title).</span><span class="sxs-lookup"><span data-stu-id="7e59f-132">There are many other DSC Resources in hello [PowerShell Gallery](http://www.powershellgallery.com/packages?q=dsc+resources&prerelease=&sortOrder=package-title).</span></span>  <span data-ttu-id="7e59f-133">Deze modules zijn geïnstalleerd in uw Azure Automation DSC-Pull-Server (door u) zodat ze kunnen worden gebruikt door uw configuraties.</span><span class="sxs-lookup"><span data-stu-id="7e59f-133">These modules are installed into your Azure Automation DSC Pull Server (by you) so they can be used by your configurations.</span></span>

<span data-ttu-id="7e59f-134">Resource Manager-sjablonen bieden een declaratieve manier voor het genereren van uw infrastructuur - items zoals netwerken, subnetten, netwerkbeveiliging en routering, load balancers, NIC's en virtuele machines.</span><span class="sxs-lookup"><span data-stu-id="7e59f-134">Resource Manager templates provide a declarative way of generating your infrastructure - things like networks, subnets, network security and routing, load balancers, NICs, VMs, and so on.</span></span>  <span data-ttu-id="7e59f-135">Hier volgt een [artikel](../azure-resource-manager/resource-manager-deployment-model.md) dat vergelijkt Resource Manager-implementatiemodel (declaratieve) Hallo Hello Azure Service Management (ASM of klassiek) implementatie model (imperatieve) en wordt besproken Hallo core resource providers, compute, opslag en netwerk.</span><span class="sxs-lookup"><span data-stu-id="7e59f-135">Here’s an [article](../azure-resource-manager/resource-manager-deployment-model.md) that compares hello Resource Manager deployment model (declarative) with hello Azure Service Management (ASM, or classic) deployment model (imperative), and discusses hello core resource providers, compute, storage and network.</span></span>

<span data-ttu-id="7e59f-136">Een belangrijke functie van een Resource Manager-sjabloon is de mogelijkheid tooinstall een VM-extensie in Hallo VM als deze ingericht.</span><span class="sxs-lookup"><span data-stu-id="7e59f-136">One key feature of an Resource Manager template is its ability tooinstall a VM extension into hello VM as it’s provisioned.</span></span>  <span data-ttu-id="7e59f-137">Een VM-extensie heeft specifieke mogelijkheden, zoals een aangepast script uitvoeren, antivirussoftware installeren of uitvoeren van een script DSC-configuratie.</span><span class="sxs-lookup"><span data-stu-id="7e59f-137">A VM extension has specific capabilities such as running a custom script, installing anti-virus software, or running a DSC configuration script.</span></span>  <span data-ttu-id="7e59f-138">Er zijn vele andere typen van VM-extensies.</span><span class="sxs-lookup"><span data-stu-id="7e59f-138">There are many other types of VM extensions.</span></span>

## <a name="quick-trip-around-hello-diagram"></a><span data-ttu-id="7e59f-139">Snelle reis rond Hallo-diagram</span><span class="sxs-lookup"><span data-stu-id="7e59f-139">Quick trip around hello diagram</span></span>
<span data-ttu-id="7e59f-140">Vanaf de bovenkant hello, schrijft u uw code bouwen en testen en vervolgens een installatiepakket maken.</span><span class="sxs-lookup"><span data-stu-id="7e59f-140">Starting at hello top, you write your code, build and test, then create an installation package.</span></span>  <span data-ttu-id="7e59f-141">Chocolatey kan verschillende soorten installatiepakketten, zoals ZIP MSI, MSU, verwerken.</span><span class="sxs-lookup"><span data-stu-id="7e59f-141">Chocolatey can handle various types of installation packages, such as MSI, MSU, ZIP.</span></span>  <span data-ttu-id="7e59f-142">En u hebt volledige kracht van de werkelijke installatie van PowerShell toodo Hallo Hallo als systeemeigen mogelijkheden van Chocolatey niet erg up tooit.</span><span class="sxs-lookup"><span data-stu-id="7e59f-142">And you have hello full power of PowerShell toodo hello actual installation if Chocolatey’s native capabilities aren’t quite up tooit.</span></span>  <span data-ttu-id="7e59f-143">Hallo-pakket in ergens bereikbaar – een opslagplaats pakket geplaatst.</span><span class="sxs-lookup"><span data-stu-id="7e59f-143">Put hello package into someplace reachable – a package repository.</span></span>  <span data-ttu-id="7e59f-144">In dit voorbeeld gebruik van een openbare map in een Azure blob storage-account gebruikt, maar deze kan overal worden.</span><span class="sxs-lookup"><span data-stu-id="7e59f-144">This usage example uses a public folder in an Azure blob storage account, but it can be anywhere.</span></span>  <span data-ttu-id="7e59f-145">Chocolatey werkt systeemeigen met NuGet-servers en enkele andere voor het beheer van de pakketmetagegevens van het.</span><span class="sxs-lookup"><span data-stu-id="7e59f-145">Chocolatey works natively with NuGet servers and a few others for management of package metadata.</span></span>  <span data-ttu-id="7e59f-146">[In dit artikel](https://github.com/chocolatey/choco/wiki/How-To-Host-Feed) Hallo opties beschreven.</span><span class="sxs-lookup"><span data-stu-id="7e59f-146">[This article](https://github.com/chocolatey/choco/wiki/How-To-Host-Feed) describes hello options.</span></span>  <span data-ttu-id="7e59f-147">In dit voorbeeld gebruik NuGet gebruikt.</span><span class="sxs-lookup"><span data-stu-id="7e59f-147">This usage example uses NuGet.</span></span>  <span data-ttu-id="7e59f-148">Een Nuspec zijn metagegevens over uw pakketten.</span><span class="sxs-lookup"><span data-stu-id="7e59f-148">A Nuspec is metadata about your packages.</span></span>  <span data-ttu-id="7e59f-149">Hallo Nuspec van zijn 'gecompileerd' in de NuPkg en opgeslagen in een NuGet-server.</span><span class="sxs-lookup"><span data-stu-id="7e59f-149">hello Nuspec’s are “compiled” into NuPkg’s and stored in a NuGet server.</span></span>  <span data-ttu-id="7e59f-150">Wanneer de configuratie van aanvragen van een pakket met de naam en verwijst naar een NuGet-server, Hallo Chocolatey DSC-Resource (nu op Hallo VM) Hallo pakket pakt het voor u en installeert.</span><span class="sxs-lookup"><span data-stu-id="7e59f-150">When your configuration requests a package by name, and references a NuGet server, hello Chocolatey DSC Resource (now on hello VM) grabs hello package and installs it for you.</span></span>  <span data-ttu-id="7e59f-151">U kunt ook een specifieke versie van een pakket aanvragen.</span><span class="sxs-lookup"><span data-stu-id="7e59f-151">You can also request a specific version of a package.</span></span>

<span data-ttu-id="7e59f-152">Er is een Azure Resource Manager (ARM)-sjabloon in Hallo onder linkergedeelte van Hallo afbeelding.</span><span class="sxs-lookup"><span data-stu-id="7e59f-152">In hello bottom left portion of hello picture, there is an Azure Resource Manager (ARM) template.</span></span>  <span data-ttu-id="7e59f-153">In dit voorbeeld gebruik registreert Hallo VM-extensie Hallo VM Hello Azure Automation DSC Pull-Server (dat wil zeggen, een pull-server) als een knooppunt.</span><span class="sxs-lookup"><span data-stu-id="7e59f-153">In this usage example, hello VM extension registers hello VM with hello Azure Automation DSC Pull Server (that is, a pull server) as a Node.</span></span>  <span data-ttu-id="7e59f-154">Hallo-configuratie wordt opgeslagen in Hallo pull-server.</span><span class="sxs-lookup"><span data-stu-id="7e59f-154">hello configuration is stored in hello pull server.</span></span>  <span data-ttu-id="7e59f-155">Dat deze twee keer wordt opgeslagen: eenmaal als tekst zonder opmaak en wanneer gecompileerd als een MOF-bestand (voor die over zaken weten.)  In de portal Hallo is Hallo MOF 'knooppuntconfiguratie' (als tegengestelde toosimply "configuratie").</span><span class="sxs-lookup"><span data-stu-id="7e59f-155">Actually, it’s stored twice: once as plain text and once compiled as an MOF file (for those that know about such things.)  In hello portal, hello MOF is a “node configuration” (as opposed toosimply “configuration”).</span></span>  <span data-ttu-id="7e59f-156">De Hallo artefacten die is gekoppeld aan een knooppunt zodat Hallo knooppunt de configuratie ervan weet.</span><span class="sxs-lookup"><span data-stu-id="7e59f-156">It’s hello artifact that’s associated with a Node so hello node will know its configuration.</span></span>  <span data-ttu-id="7e59f-157">Details hieronder laten zien hoe tooassign Hallo knooppunt toohello configuratieknooppunt.</span><span class="sxs-lookup"><span data-stu-id="7e59f-157">Details below show how tooassign hello node configuration toohello node.</span></span>

<span data-ttu-id="7e59f-158">U bent waarschijnlijk al bezig Hallo bits Hallo boven of de meeste van deze.</span><span class="sxs-lookup"><span data-stu-id="7e59f-158">Presumably you’re already doing hello bit at hello top, or most of it.</span></span>  <span data-ttu-id="7e59f-159">Maken van Hallo nuspec, compileren en opgeslagen in een NuGet-server is een kleine ding.</span><span class="sxs-lookup"><span data-stu-id="7e59f-159">Creating hello nuspec, compiling and storing it in a NuGet server is a small thing.</span></span>  <span data-ttu-id="7e59f-160">En u bent al het beheer van virtuele machines.</span><span class="sxs-lookup"><span data-stu-id="7e59f-160">And you’re already managing VMs.</span></span>  <span data-ttu-id="7e59f-161">Hallo volgende stap toocontinuous implementatie duurt vereist Hallo pull-server (eenmaal) instellen, registreert uw knooppunten (één keer), en maken en opslaan van er Hallo-configuratie (in eerste instantie).</span><span class="sxs-lookup"><span data-stu-id="7e59f-161">Taking hello next step toocontinuous deployment requires setting up hello pull server (once), registering your nodes with it (once), and creating and storing hello configuration there (initially).</span></span>  <span data-ttu-id="7e59f-162">Vernieuw vervolgens pakketten zijn bijgewerkt en geïmplementeerd toohello-opslagplaats, hello configuratie- en knooppuntconfiguratie in Hallo pull-server (Herhaal indien nodig).</span><span class="sxs-lookup"><span data-stu-id="7e59f-162">Then as packages are upgraded and deployed toohello repository, refresh hello Configuration and Node Configuration in hello pull server (repeat as needed).</span></span>

<span data-ttu-id="7e59f-163">Als u begint niet met een ARM-sjabloon, maar dat is ook OK.</span><span class="sxs-lookup"><span data-stu-id="7e59f-163">If you’re not starting with an ARM template, that’s also OK.</span></span>  <span data-ttu-id="7e59f-164">Er zijn een PowerShell-cmdlets die zijn ontworpen toohelp registreert u uw virtuele machines met Hallo pull-server en alle Hallo rest.</span><span class="sxs-lookup"><span data-stu-id="7e59f-164">There are PowerShell cmdlets designed toohelp you register your VMs with hello pull server and all of hello rest.</span></span> <span data-ttu-id="7e59f-165">Zie voor meer informatie in dit artikel: [machines voorbereiden voor beheer door Azure Automation DSC](automation-dsc-onboarding.md)</span><span class="sxs-lookup"><span data-stu-id="7e59f-165">For more details, see this article: [Onboarding machines for management by Azure Automation DSC](automation-dsc-onboarding.md)</span></span>

## <a name="step-1-setting-up-hello-pull-server-and-automation-account"></a><span data-ttu-id="7e59f-166">Stap 1: Hallo pull-server en de automation-account instellen</span><span class="sxs-lookup"><span data-stu-id="7e59f-166">Step 1: Setting up hello pull server and automation account</span></span>
<span data-ttu-id="7e59f-167">Op een geverifieerde (Add-AzureRmAccount) PowerShell-opdrachtregel: (kan enkele minuten duren terwijl Hallo pull-server is ingesteld)</span><span class="sxs-lookup"><span data-stu-id="7e59f-167">At an authenticated (Add-AzureRmAccount) PowerShell command line:  (can take a few minutes while hello pull server is set up)</span></span>

    New-AzureRmResourceGroup –Name MY-AUTOMATION-RG –Location MY-RG-LOCATION-IN-QUOTES
    New-AzureRmAutomationAccount –ResourceGroupName MY-AUTOMATION-RG –Location MY-RG-LOCATION-IN-QUOTES –Name MY-AUTOMATION-ACCOUNT 

<span data-ttu-id="7e59f-168">U kunt uw automation-account in een van de volgende regio's (aka locatie) Hallo plaatsen: VS-Oost 2, Zuid-centraal VS, Gov ons Virginia, West-Europa, Zuidoost-Azië, Japan-Oost, India centraal en Australië-Zuidoost, Canada centraal, Noord-Europa.</span><span class="sxs-lookup"><span data-stu-id="7e59f-168">You can put your automation account into any of hello following regions (aka location):  East US 2, South Central US, US Gov Virginia, West Europe, Southeast Asia, Japan East, Central India and Australia Southeast, Canada Central, North Europe.</span></span>

## <a name="step-2-vm-extension-tweaks-toohello-arm-template"></a><span data-ttu-id="7e59f-169">Stap 2: VM-extensie trucs toohello ARM-sjabloon</span><span class="sxs-lookup"><span data-stu-id="7e59f-169">Step 2: VM extension tweaks toohello ARM template</span></span>
<span data-ttu-id="7e59f-170">Details voor registratie bij de virtuele machine (via Hallo PowerShell DSC-VM-extensie) opgegeven in deze [Snelstartsjabloon met de Azure](https://github.com/Azure/azure-quickstart-templates/tree/master/dsc-extension-azure-automation-pullserver).</span><span class="sxs-lookup"><span data-stu-id="7e59f-170">Details for VM registration (using hello PowerShell DSC VM extension) provided in this [Azure Quickstart Template](https://github.com/Azure/azure-quickstart-templates/tree/master/dsc-extension-azure-automation-pullserver).</span></span>  <span data-ttu-id="7e59f-171">Deze stap registreert uw nieuwe virtuele machine met Hallo pull-server in de lijst Hallo van DSC-knooppunten.</span><span class="sxs-lookup"><span data-stu-id="7e59f-171">This step registers your new VM with hello pull server in hello list of DSC Nodes.</span></span>  <span data-ttu-id="7e59f-172">Onderdeel van deze registratie is Hallo configuratie toobe toegepast toohello knooppunt op te geven.</span><span class="sxs-lookup"><span data-stu-id="7e59f-172">Part of this registration is specifying hello node configuration toobe applied toohello node.</span></span>  <span data-ttu-id="7e59f-173">Deze knooppuntconfiguratie nog niet is voorzien tooexist Hallo pull-server zodat deze OK die stap 4 wanneer dit wordt gedaan voor Hallo eerst is.</span><span class="sxs-lookup"><span data-stu-id="7e59f-173">This node configuration doesn't have tooexist yet in hello pull server, so it's OK that Step 4 is where this is done for hello first time.</span></span>  <span data-ttu-id="7e59f-174">Maar hier in stap 2 hoeft u toohave beslist Hallo-naam van Hallo knooppunt en de naam van de Hallo van Hallo-configuratie.</span><span class="sxs-lookup"><span data-stu-id="7e59f-174">But here in Step 2 you do need toohave decided hello name of hello node and hello name of hello configuration.</span></span>  <span data-ttu-id="7e59f-175">In dit voorbeeld gebruik Hallo-knooppunt is 'isvbox' en Hallo-configuratie is 'ISVBoxConfig'.</span><span class="sxs-lookup"><span data-stu-id="7e59f-175">In this usage example, hello node is 'isvbox' and hello configuration is 'ISVBoxConfig'.</span></span>  <span data-ttu-id="7e59f-176">Hallo configuratie knooppuntnaam (toobe opgegeven in DeploymentTemplate.json) is daarom 'ISVBoxConfig.isvbox'.</span><span class="sxs-lookup"><span data-stu-id="7e59f-176">So hello node configuration name (toobe specified in DeploymentTemplate.json) is 'ISVBoxConfig.isvbox'.</span></span>  

## <a name="step-3-adding-required-dsc-resources-toohello-pull-server"></a><span data-ttu-id="7e59f-177">Stap 3: Vereist DSC-resources toohello pull-server toevoegen</span><span class="sxs-lookup"><span data-stu-id="7e59f-177">Step 3: Adding required DSC resources toohello pull server</span></span>
<span data-ttu-id="7e59f-178">Hallo PowerShell Gallery is providers tooinstall DSC-resources in uw Azure Automation-account.</span><span class="sxs-lookup"><span data-stu-id="7e59f-178">hello PowerShell Gallery is instrumented tooinstall DSC resources into your Azure Automation account.</span></span>  <span data-ttu-id="7e59f-179">Navigeer toohello resource u wilt en klikt u op Hallo 'Implementeren tooAzure Automation'.</span><span class="sxs-lookup"><span data-stu-id="7e59f-179">Navigate toohello resource you want and click hello “Deploy tooAzure Automation” button.</span></span>

![Voorbeeld van PowerShell Gallery](./media/automation-dsc-cd-chocolatey/xNetworking.PNG)

<span data-ttu-id="7e59f-181">Een andere methode onlangs toegevoegd toohello Azure Portal kunt u toopull in nieuwe modules of update bestaande modules.</span><span class="sxs-lookup"><span data-stu-id="7e59f-181">Another technique recently added toohello Azure Portal allows you toopull in new modules or update existing modules.</span></span> <span data-ttu-id="7e59f-182">Klik in het Hallo Automation-Account resource Hallo activa tegel en ten slotte Hallo Modules tegel.</span><span class="sxs-lookup"><span data-stu-id="7e59f-182">Click through hello Automation Account resource, hello Assets tile, and finally hello Modules tile.</span></span>  <span data-ttu-id="7e59f-183">Hallo bladeren galerie pictogram kunt u toosee Hallo lijst met modules in de galerie hello, Inzoomen op gegevens en uiteindelijk importeren in uw Automation-Account.</span><span class="sxs-lookup"><span data-stu-id="7e59f-183">hello Browse Gallery icon allows you toosee hello list of modules in hello gallery, drill down into details and ultimately import into your Automation Account.</span></span> <span data-ttu-id="7e59f-184">Dit is een uitstekende manier tookeep uw modules up toodate van tijd tootime.</span><span class="sxs-lookup"><span data-stu-id="7e59f-184">This is a great way tookeep your modules up toodate from time tootime.</span></span> <span data-ttu-id="7e59f-185">En importfunctie Hallo controleert afhankelijkheden met andere modules tooensure die niets niet synchroon.</span><span class="sxs-lookup"><span data-stu-id="7e59f-185">And, hello import feature checks dependencies with other modules tooensure nothing gets out of sync.</span></span>

<span data-ttu-id="7e59f-186">Of er is Hallo handmatige benadering.</span><span class="sxs-lookup"><span data-stu-id="7e59f-186">Or, there’s hello manual approach.</span></span>  <span data-ttu-id="7e59f-187">Hallo-mapstructuur van een Module van de PowerShell-integratie voor een Windows-computer verschilt enigszins van Hallo mapstructuur werd verwacht door hello Azure Automation.</span><span class="sxs-lookup"><span data-stu-id="7e59f-187">hello folder structure of a PowerShell Integration Module for a Windows computer is a little different from hello folder structure expected by hello Azure Automation.</span></span>  <span data-ttu-id="7e59f-188">Hiervoor moet een kleine aanpassingen van uw kant.</span><span class="sxs-lookup"><span data-stu-id="7e59f-188">This requires a little tweaking on your part.</span></span>  <span data-ttu-id="7e59f-189">Maar het is niet moeilijk en het slechts één keer per resource voltooid (tenzij u wilt dat tooupgrade in toekomstige.)  Zie voor meer informatie over het ontwerpen van PowerShell integratiemodules in dit artikel: [Azure Automation-integratiemodules ontwerpen](https://azure.microsoft.com/blog/authoring-integration-modules-for-azure-automation/)</span><span class="sxs-lookup"><span data-stu-id="7e59f-189">But it’s not hard, and it’s done only once per resource (unless you want tooupgrade it in future.)  For more information on authoring PowerShell Integration Modules, see this article: [Authoring Integration Modules for Azure Automation](https://azure.microsoft.com/blog/authoring-integration-modules-for-azure-automation/)</span></span>

* <span data-ttu-id="7e59f-190">Hallo-module die u nodig hebt op uw werkstation als volgt installeren:</span><span class="sxs-lookup"><span data-stu-id="7e59f-190">Install hello module that you need on your workstation, as follows:</span></span>
  * <span data-ttu-id="7e59f-191">Installeer [Windows Management Framework, v5](http://aka.ms/wmf5latest) (niet nodig voor Windows 10)</span><span class="sxs-lookup"><span data-stu-id="7e59f-191">Install [Windows Management Framework, v5](http://aka.ms/wmf5latest) (not needed for Windows 10)</span></span>
  * <span data-ttu-id="7e59f-192">`Install-Module –Name MODULE-NAME`<: grijpers Hallo module op basis van Hallo PowerShell Gallery</span><span class="sxs-lookup"><span data-stu-id="7e59f-192">`Install-Module –Name MODULE-NAME`    <—grabs hello module from hello PowerShell Gallery</span></span> 
* <span data-ttu-id="7e59f-193">Kopiëren Hallo modulemap van `c:\Program Files\WindowsPowerShell\Modules\MODULE-NAME` tooa tijdelijke map</span><span class="sxs-lookup"><span data-stu-id="7e59f-193">Copy hello module folder from `c:\Program Files\WindowsPowerShell\Modules\MODULE-NAME` tooa temp folder</span></span> 
* <span data-ttu-id="7e59f-194">Voorbeelden en documentatie verwijderen uit de hoofdmap Hallo</span><span class="sxs-lookup"><span data-stu-id="7e59f-194">Delete samples and documentation from hello main folder</span></span> 
* <span data-ttu-id="7e59f-195">ZIP Hallo hoofdmap, naming Hallo ZIP-bestand exact dezelfde Hallo als Hallo-map</span><span class="sxs-lookup"><span data-stu-id="7e59f-195">Zip hello main folder, naming hello ZIP file exactly hello same as hello folder</span></span> 
* <span data-ttu-id="7e59f-196">Hallo ZIP-bestand in een bereikbaar HTTP-locatie, zoals de blob-opslag in een Azure Storage-Account worden geplaatst.</span><span class="sxs-lookup"><span data-stu-id="7e59f-196">Put hello ZIP file into a reachable HTTP location, such as blob storage in an Azure Storage Account.</span></span>
* <span data-ttu-id="7e59f-197">Voer deze PowerShell:</span><span class="sxs-lookup"><span data-stu-id="7e59f-197">Run this PowerShell:</span></span>
  
      New-AzureRmAutomationModule `
          -ResourceGroupName MY-AUTOMATION-RG -AutomationAccountName MY-AUTOMATION-ACCOUNT `
          -Name MODULE-NAME –ContentLink "https://STORAGE-URI/CONTAINERNAME/MODULE-NAME.zip"

<span data-ttu-id="7e59f-198">Hallo opgenomen voorbeeld voert deze stappen voor cChoco en xNetworking.</span><span class="sxs-lookup"><span data-stu-id="7e59f-198">hello included example performs these steps for cChoco and xNetworking.</span></span> <span data-ttu-id="7e59f-199">Zie Hallo [notities](#notes) voor speciale verwerking voor cChoco.</span><span class="sxs-lookup"><span data-stu-id="7e59f-199">See hello [Notes](#notes) for special handling for cChoco.</span></span>

## <a name="step-4-adding-hello-node-configuration-toohello-pull-server"></a><span data-ttu-id="7e59f-200">Stap 4: Hallo knooppunt configuratie toohello pull-server toevoegen</span><span class="sxs-lookup"><span data-stu-id="7e59f-200">Step 4: Adding hello node configuration toohello pull server</span></span>
<span data-ttu-id="7e59f-201">Er zijn geen speciale over Hallo eerste keer dat u uw configuratie in Hallo pull-server en compileren importeren.</span><span class="sxs-lookup"><span data-stu-id="7e59f-201">There’s nothing special about hello first time you import your configuration into hello pull server and compile.</span></span>  <span data-ttu-id="7e59f-202">Alle volgende importeren compileert Hallo dezelfde configuratie uiterlijk exact Hallo dezelfde.</span><span class="sxs-lookup"><span data-stu-id="7e59f-202">All subsequent import/compiles of hello same configuration look exactly hello same.</span></span>  <span data-ttu-id="7e59f-203">Telkens wanneer u uw pakket bijwerken en het uit tooproduction u doen in deze stap nadat u hebt gecontroleerd Hallo-configuratiebestand toopush moet is juist – inclusief Hallo nieuwe versie van het pakket.</span><span class="sxs-lookup"><span data-stu-id="7e59f-203">Each time you update your package and need toopush it out tooproduction you do this step after ensuring hello configuration file is correct – including hello new version of your package.</span></span>  <span data-ttu-id="7e59f-204">Ga als volgt Hallo-configuratiebestand en PowerShell:</span><span class="sxs-lookup"><span data-stu-id="7e59f-204">Here’s hello configuration file and PowerShell:</span></span>

<span data-ttu-id="7e59f-205">ISVBoxConfig.ps1:</span><span class="sxs-lookup"><span data-stu-id="7e59f-205">ISVBoxConfig.ps1:</span></span>

    Configuration ISVBoxConfig 
    { 
        Import-DscResource -ModuleName cChoco 
        Import-DscResource -ModuleName xNetworking

        Node "isvbox" {   

            cChocoInstaller installChoco 
            { 
                InstallDir = "C:\choco" 
            }

            WindowsFeature installIIS 
            { 
                Ensure="Present" 
                Name="Web-Server" 
            }

            xFirewall WebFirewallRule 
            { 
                Direction = "Inbound" 
                Name = "Web-Server-TCP-In" 
                DisplayName = "Web Server (TCP-In)" 
                Description = "IIS allow incoming web site traffic." 
                DisplayGroup = "IIS Incoming Traffic" 
                State = "Enabled" 
                Access = "Allow" 
                Protocol = "TCP" 
                LocalPort = "80" 
                Ensure = "Present" 
            }

            cChocoPackageInstaller trivialWeb 
            {            
                Name = "trivialweb" 
                Version = "1.0.0" 
                Source = “MY-NUGET-V2-SERVER-ADDRESS” 
                DependsOn = "[cChocoInstaller]installChoco", 
                "[WindowsFeature]installIIS" 
            } 
        }    
    }

<span data-ttu-id="7e59f-206">Nieuw-ConfigurationScript.ps1:</span><span class="sxs-lookup"><span data-stu-id="7e59f-206">New-ConfigurationScript.ps1:</span></span>

    Import-AzureRmAutomationDscConfiguration ` 
        -ResourceGroupName MY-AUTOMATION-RG –AutomationAccountName MY-AUTOMATION-ACCOUNT ` 
        -SourcePath C:\temp\AzureAutomationDsc\ISVBoxConfig.ps1 ` 
        -Published –Force

    $jobData = Start-AzureRmAutomationDscCompilationJob ` 
        -ResourceGroupName MY-AUTOMATION-RG –AutomationAccountName MY-AUTOMATION-ACCOUNT ` 
        -ConfigurationName ISVBoxConfig 

    $compilationJobId = $jobData.Id

    Get-AzureRmAutomationDscCompilationJob ` 
        -ResourceGroupName MY-AUTOMATION-RG –AutomationAccountName MY-AUTOMATION-ACCOUNT ` 
        -Id $compilationJobId

<span data-ttu-id="7e59f-207">Het resultaat van deze stappen in een nieuwe configuratie van de knooppunten met de naam 'ISVBoxConfig.isvbox' hello pull-server wordt geplaatst.</span><span class="sxs-lookup"><span data-stu-id="7e59f-207">These steps result in a new node configuration named “ISVBoxConfig.isvbox” being placed on hello pull server.</span></span>  <span data-ttu-id="7e59f-208">Hallo knooppunt configuratienaam is gebouwd als 'configurationName.nodeName'.</span><span class="sxs-lookup"><span data-stu-id="7e59f-208">hello node configuration name is built as “configurationName.nodeName”.</span></span>

## <a name="step-5-creating-and-maintaining-package-metadata"></a><span data-ttu-id="7e59f-209">Stap 5: Het maken en onderhouden van pakketmetagegevens</span><span class="sxs-lookup"><span data-stu-id="7e59f-209">Step 5: Creating and maintaining package metadata</span></span>
<span data-ttu-id="7e59f-210">Voor elk pakket dat u in de opslagplaats voor Hallo pakket zetten, moet u een nuspec die wordt beschreven.</span><span class="sxs-lookup"><span data-stu-id="7e59f-210">For each package that you put into hello package repository, you need a nuspec that describes it.</span></span>  <span data-ttu-id="7e59f-211">Die nuspec moet worden gecompileerd en opgeslagen in de NuGet-server.</span><span class="sxs-lookup"><span data-stu-id="7e59f-211">That nuspec must be compiled and stored in your NuGet server.</span></span> <span data-ttu-id="7e59f-212">Dit proces wordt beschreven [hier](http://docs.nuget.org/create/creating-and-publishing-a-package).</span><span class="sxs-lookup"><span data-stu-id="7e59f-212">This process is described [here](http://docs.nuget.org/create/creating-and-publishing-a-package).</span></span>  <span data-ttu-id="7e59f-213">U kunt MyGet.org gebruiken als een NuGet-server.</span><span class="sxs-lookup"><span data-stu-id="7e59f-213">You can use MyGet.org as a NuGet server.</span></span>  <span data-ttu-id="7e59f-214">Ze deze service verkocht, maar hebben een starter SKU is gratis.</span><span class="sxs-lookup"><span data-stu-id="7e59f-214">They sell this service, but have a starter SKU that’s free.</span></span>  <span data-ttu-id="7e59f-215">NuGet.org vindt u instructies voor het installeren van uw eigen NuGet-server van uw persoonlijke pakketten is.</span><span class="sxs-lookup"><span data-stu-id="7e59f-215">At NuGet.org you’ll find instructions on installing your own NuGet server for your private packages.</span></span>

## <a name="step-6-tying-it-all-together"></a><span data-ttu-id="7e59f-216">Stap 6: Alles samenvoegen koppelende</span><span class="sxs-lookup"><span data-stu-id="7e59f-216">Step 6: Tying it all together</span></span>
<span data-ttu-id="7e59f-217">Telkens wanneer een versie QA is geslaagd en is goedgekeurd voor implementatie, Hallo-pakket is gemaakt, nuspec en nupkg bijgewerkt en toohello NuGet-server geïmplementeerd.</span><span class="sxs-lookup"><span data-stu-id="7e59f-217">Each time a version passes QA and is approved for deployment, hello package is created, nuspec and nupkg updated and deployed toohello NuGet server.</span></span>  <span data-ttu-id="7e59f-218">Hallo-configuratie (stap 4 hierboven) moet bovendien bijgewerkte tooagree met Hallo nieuwe versienummer.</span><span class="sxs-lookup"><span data-stu-id="7e59f-218">In addition, hello configuration (Step 4 above) must be updated tooagree with hello new version number.</span></span>  <span data-ttu-id="7e59f-219">Het moet worden verzonden toohello pull-server en gecompileerde.</span><span class="sxs-lookup"><span data-stu-id="7e59f-219">It must be sent toohello pull server and compiled.</span></span>  <span data-ttu-id="7e59f-220">Vanaf dat moment is toohello VM's afhankelijk zijn van deze configuratie toopull Hallo update en deze installeren.</span><span class="sxs-lookup"><span data-stu-id="7e59f-220">From that point on, it's up toohello VMs that depend on that configuration toopull hello update and install it.</span></span>  <span data-ttu-id="7e59f-221">Elk van deze updates zijn eenvoudige - slechts een of twee regels van PowerShell.</span><span class="sxs-lookup"><span data-stu-id="7e59f-221">Each of these updates are simple - just a line or two of PowerShell.</span></span>  <span data-ttu-id="7e59f-222">In geval van de Hallo van Visual Studio Team Services, zijn sommige van deze ingekapseld in de build-taken die u een worden samengesteld in een build keten kunnen.</span><span class="sxs-lookup"><span data-stu-id="7e59f-222">In hello case of Visual Studio Team Services, some of them are encapsulated in build tasks that can be chained together in a build.</span></span>  <span data-ttu-id="7e59f-223">Dit [artikel](https://www.visualstudio.com/en-us/docs/alm-devops-feature-index#continuous-delivery) biedt meer details.</span><span class="sxs-lookup"><span data-stu-id="7e59f-223">This [article](https://www.visualstudio.com/en-us/docs/alm-devops-feature-index#continuous-delivery) provides more details.</span></span>  <span data-ttu-id="7e59f-224">Dit [GitHub-repo-](https://github.com/Microsoft/vso-agent-tasks) details Hallo diverse beschikbare build-taken.</span><span class="sxs-lookup"><span data-stu-id="7e59f-224">This [GitHub repo](https://github.com/Microsoft/vso-agent-tasks) details hello various available build tasks.</span></span>

## <a name="notes"></a><span data-ttu-id="7e59f-225">Opmerkingen</span><span class="sxs-lookup"><span data-stu-id="7e59f-225">Notes</span></span>
<span data-ttu-id="7e59f-226">In dit voorbeeld gebruik begint met een virtuele machine van een algemene Windows Server 2012 R2-afbeelding van hello Azure-galerie.</span><span class="sxs-lookup"><span data-stu-id="7e59f-226">This usage example starts with a VM from a generic Windows Server 2012 R2 image from hello Azure gallery.</span></span>  <span data-ttu-id="7e59f-227">U kunt starten vanuit een opgeslagen installatiekopie en vervolgens vanaf daar met Hallo DSC-configuratie aanpassen.</span><span class="sxs-lookup"><span data-stu-id="7e59f-227">You can start from any stored image and then tweak from there with hello DSC configuration.</span></span>  <span data-ttu-id="7e59f-228">Configuratie die is standaard uitbreidbaar wijzigen in een installatiekopie is echter veel moeilijker dan het Hallo-configuratie met behulp van DSC dynamisch bij te werken.</span><span class="sxs-lookup"><span data-stu-id="7e59f-228">However, changing configuration that is baked into an image is much harder than dynamically updating hello configuration using DSC.</span></span>

<span data-ttu-id="7e59f-229">U hebt geen toouse een ARM-sjabloon en Hallo VM-extensie toouse deze techniek met uw virtuele machines.</span><span class="sxs-lookup"><span data-stu-id="7e59f-229">You don’t have toouse an ARM template and hello VM extension toouse this technique with your VMs.</span></span>  <span data-ttu-id="7e59f-230">En uw VM's geen toobe op Azure toobe onder beheer van de CD.</span><span class="sxs-lookup"><span data-stu-id="7e59f-230">And your VMs don’t have toobe on Azure toobe under CD management.</span></span>  <span data-ttu-id="7e59f-231">Alle die is vereist is dat Chocolatey geïnstalleerd en hello LCM geconfigureerd op Hallo VM zodat deze waarbij Hallo pull-server is.</span><span class="sxs-lookup"><span data-stu-id="7e59f-231">All that’s necessary is that Chocolatey be installed and hello LCM configured on hello VM so it knows where hello pull server is.</span></span>  

<span data-ttu-id="7e59f-232">Natuurlijk wanneer u een pakket op een virtuele machine die in gebruik is genomen bijwerkt, moet u tootake die VM buiten rotatie Hallo-update is geïnstalleerd.</span><span class="sxs-lookup"><span data-stu-id="7e59f-232">Of course, when you update a package on a VM that’s in production, you need tootake that VM out of rotation while hello update is installed.</span></span>  <span data-ttu-id="7e59f-233">Hoe u dit doen varieert.</span><span class="sxs-lookup"><span data-stu-id="7e59f-233">How you do this varies widely.</span></span>  <span data-ttu-id="7e59f-234">Bijvoorbeeld, met een VM achter een Load Balancer van Azure, kunt u toevoegen een aangepaste test.</span><span class="sxs-lookup"><span data-stu-id="7e59f-234">For example, with a VM behind an Azure Load Balancer, you can add a Custom Probe.</span></span>  <span data-ttu-id="7e59f-235">Tijdens het bijwerken van Hallo VM hebben Hallo test eindpunt een 400 retourneren.</span><span class="sxs-lookup"><span data-stu-id="7e59f-235">While updating hello VM, have hello probe endpoint return a 400.</span></span>  <span data-ttu-id="7e59f-236">Hallo tweak nodig toocause deze wijziging zijn binnen uw configuratie kan Hallo tweak tooswitch weer tooreturning een 200 zodra het Hallo-update is voltooid.</span><span class="sxs-lookup"><span data-stu-id="7e59f-236">hello tweak necessary toocause this change can be inside your configuration, as can hello tweak tooswitch it back tooreturning a 200 once hello update is complete.</span></span>

<span data-ttu-id="7e59f-237">Volledige bron voor dit voorbeeld gebruik is in [deze Visual Studio-project](https://github.com/sebastus/ARM/tree/master/CDIaaSVM) op GitHub.</span><span class="sxs-lookup"><span data-stu-id="7e59f-237">Full source for this usage example is in [this Visual Studio project](https://github.com/sebastus/ARM/tree/master/CDIaaSVM) on GitHub.</span></span>

## <a name="related-articles"></a><span data-ttu-id="7e59f-238">Verwante artikelen</span><span class="sxs-lookup"><span data-stu-id="7e59f-238">Related Articles</span></span>
* [<span data-ttu-id="7e59f-239">Overzicht van Azure Automation DSC</span><span class="sxs-lookup"><span data-stu-id="7e59f-239">Azure Automation DSC Overview</span></span>](automation-dsc-overview.md)
* [<span data-ttu-id="7e59f-240">Azure Automation DSC-cmdlets</span><span class="sxs-lookup"><span data-stu-id="7e59f-240">Azure Automation DSC cmdlets</span></span>](https://msdn.microsoft.com/library/mt244122.aspx)
* [<span data-ttu-id="7e59f-241">Computers voorbereiden voor beheer door Azure Automation DSC</span><span class="sxs-lookup"><span data-stu-id="7e59f-241">Onboarding machines for management by Azure Automation DSC</span></span>](automation-dsc-onboarding.md)

