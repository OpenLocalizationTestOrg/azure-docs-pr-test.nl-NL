---
title: Problemen met Cloud Services met Application Insights | Microsoft Docs
description: Informatie over het oplossen van problemen met cloud-service met behulp van Application Insights om gegevens te verwerken van Azure Diagnostics.
services: cloud-services
documentationcenter: .net
author: sbtron
manager: timlt
editor: tysonn
ms.assetid: e93f387b-ef29-4731-ae41-0676722accb6
ms.service: cloud-services
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 05/23/2017
ms.author: saurabh
ms.openlocfilehash: 4001ca908ff00b1a40829d687589080e9b07b18a
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 07/11/2017
---
# <a name="troubleshoot-cloud-services-using-application-insights"></a><span data-ttu-id="9d5df-103">Problemen met Cloud Services met Application Insights</span><span class="sxs-lookup"><span data-stu-id="9d5df-103">Troubleshoot Cloud Services using Application Insights</span></span>
<span data-ttu-id="9d5df-104">Met [Azure SDK 2.8](https://azure.microsoft.com/downloads/) en Azure diagnostics extensie 1.5, kunt u Azure Diagnostics gegevens verzenden voor uw Cloudservice rechtstreeks naar Application Insights.</span><span class="sxs-lookup"><span data-stu-id="9d5df-104">With [Azure SDK 2.8](https://azure.microsoft.com/downloads/) and Azure diagnostics extension 1.5, you can send Azure Diagnostics data for your Cloud Service directly to Application Insights.</span></span> <span data-ttu-id="9d5df-105">De logboeken die is verzameld door Azure Diagnostics&mdash;inclusief toepassingslogboeken, Windows-gebeurtenislogboeken ETW-logboeken en prestatiemeteritems&mdash;kunnen worden verzonden naar Application Insights.</span><span class="sxs-lookup"><span data-stu-id="9d5df-105">The logs collected by Azure Diagnostics&mdash;including application logs, Windows Event Logs, ETW Logs, and performance counters&mdash;can be sent to Application Insights.</span></span> <span data-ttu-id="9d5df-106">U kunt vervolgens visualiseren van deze informatie in de gebruikersinterface van de Application Insights-portal.</span><span class="sxs-lookup"><span data-stu-id="9d5df-106">You can then visualize this information in the Application Insights portal UI.</span></span> <span data-ttu-id="9d5df-107">U kunt vervolgens Application Insights-SDK gebruiken om op te halen van inzicht in de metrische gegevens en de logboeken die afkomstig zijn van uw toepassing, evenals de systeem- en niveau van de infrastructuur die afkomstig zijn van Azure Diagnostics.</span><span class="sxs-lookup"><span data-stu-id="9d5df-107">You can then use the Application Insights SDK to get insights into metrics and logs that come from your application, as well as the system and infrastructure-level data that comes from Azure Diagnostics.</span></span>

## <a name="configure-azure-diagnostics-to-send-data-to-application-insights"></a><span data-ttu-id="9d5df-108">Azure Diagnostics om gegevens te verzenden naar Application Insights configureren</span><span class="sxs-lookup"><span data-stu-id="9d5df-108">Configure Azure Diagnostics to send data to Application Insights</span></span>
<span data-ttu-id="9d5df-109">Volg deze stappen voor het instellen van uw cloudserviceproject Azure Diagnostics-gegevens verzenden naar Application Insights.</span><span class="sxs-lookup"><span data-stu-id="9d5df-109">Follow these steps to set up your cloud service project to send Azure Diagnostics data to Application Insights.</span></span>

1. <span data-ttu-id="9d5df-110">In Visual Studio Solution Explorer met de rechtermuisknop op een rol en selecteer **eigenschappen** openen van de rol designer.</span><span class="sxs-lookup"><span data-stu-id="9d5df-110">In Visual Studio Solution Explorer, right-click a role and select **Properties** to open the Role designer.</span></span>

    ![Solution Explorer Role-eigenschappen][1]

2. <span data-ttu-id="9d5df-112">In de **Diagnostics** sectie van de rol designer, selecteer de **diagnostische gegevens verzenden naar Application Insights** optie.</span><span class="sxs-lookup"><span data-stu-id="9d5df-112">In the **Diagnostics** section of the Role designer, select the **Send diagnostics data to Application Insights** option.</span></span>

    ![Rol designer diagnostische gegevens verzenden naar application insights][2]

3. <span data-ttu-id="9d5df-114">Selecteer in het dialoogvenster dat verschijnt, de Application Insights-resource die u wilt de Azure diagnostics-gegevens te verzenden.</span><span class="sxs-lookup"><span data-stu-id="9d5df-114">In the dialog box that pops up, select the Application Insights resource that you want to send the Azure diagnostics data to.</span></span> <span data-ttu-id="9d5df-115">Het dialoogvenster kunt u een bestaande Application Insights-resource uit uw abonnement selecteren of geef handmatig een instrumentatiesleutel voor Application Insights-resource.</span><span class="sxs-lookup"><span data-stu-id="9d5df-115">The dialog box allows you to select an existing Application Insights resource from your subscription or to manually specify an instrumentation key for an Application Insights resource.</span></span> <span data-ttu-id="9d5df-116">Zie voor meer informatie over het maken van een Application Insights-resource [Maak een nieuwe Application Insights-resource](../application-insights/app-insights-create-new-resource.md).</span><span class="sxs-lookup"><span data-stu-id="9d5df-116">For more information on creating an Application Insights resource, see [Create a new Application Insights resource](../application-insights/app-insights-create-new-resource.md).</span></span>

    ![Selecteer application insights-resource][3]

    <span data-ttu-id="9d5df-118">Nadat u de Application Insights-resource hebt toegevoegd, de instrumentatiesleutel voor die bron wordt opgeslagen als een service-configuratie-instelling met de naam **APPINSIGHTS_INSTRUMENTATIONKEY**.</span><span class="sxs-lookup"><span data-stu-id="9d5df-118">Once you have added the Application Insights resource, the instrumentation key for that resource is stored as a service configuration setting with the name **APPINSIGHTS_INSTRUMENTATIONKEY**.</span></span> <span data-ttu-id="9d5df-119">U kunt deze configuratie-instelling voor elke configuratie van de service of de omgeving kunt wijzigen.</span><span class="sxs-lookup"><span data-stu-id="9d5df-119">You can change this configuration setting for each service configuration or environment.</span></span> <span data-ttu-id="9d5df-120">Om dit te doen, selecteert u een andere configuratie van de **serviceconfiguratie** lijst en geeft u een nieuwe instrumentatiesleutel voor dat de configuratie.</span><span class="sxs-lookup"><span data-stu-id="9d5df-120">To do so, select a different configuration from the **Service Configuration** list and specify a new instrumentation key for that configuration.</span></span>

    ![Selecteer de configuratie van de service][4]

    <span data-ttu-id="9d5df-122">De **APPINSIGHTS_INSTRUMENTATIONKEY** configuratie-instelling wordt gebruikt door Visual Studio om de extensie voor diagnostische gegevens configureren met de juiste Application Insights-resource informatie tijdens de publicatie.</span><span class="sxs-lookup"><span data-stu-id="9d5df-122">The **APPINSIGHTS_INSTRUMENTATIONKEY** configuration setting is used by Visual Studio to configure the diagnostics extension with the appropriate Application Insights resource information during publishing.</span></span> <span data-ttu-id="9d5df-123">De configuratie-instelling is een handige manier om verschillende instrumentatiesleutels voor verschillende configuraties te definiÃ«ren.</span><span class="sxs-lookup"><span data-stu-id="9d5df-123">The configuration setting is a convenient way of defining different instrumentation keys for different service configurations.</span></span> <span data-ttu-id="9d5df-124">Visual Studio wordt die instelling vertalen en plaats deze in de diagnostics extensie openbare configuratie tijdens het publicatieproces.</span><span class="sxs-lookup"><span data-stu-id="9d5df-124">Visual Studio will translate that setting and insert it into the diagnostics extension public configuration during the publish process.</span></span> <span data-ttu-id="9d5df-125">De uitvoer van het pakket van Visual Studio bevat ook de openbare configuratie-XML met de juiste Application Insights-instrumentatiesleutel voor het vereenvoudigen van de extensie voor diagnostische gegevens configureren met PowerShell.</span><span class="sxs-lookup"><span data-stu-id="9d5df-125">To simplify the process of configuring the diagnostics extension with PowerShell, the package output from Visual Studio also contains the public configuration XML with the appropriate Application Insights instrumentation key.</span></span> <span data-ttu-id="9d5df-126">De openbare configuratiebestanden in de map extensies zijn gemaakt en het patroon volgen *PaaSDiagnostics.&lt; RoleName&gt;. PubConfig.xml*.</span><span class="sxs-lookup"><span data-stu-id="9d5df-126">The public config files are created in the Extensions folder and follow the pattern *PaaSDiagnostics.&lt;RoleName&gt;.PubConfig.xml*.</span></span> <span data-ttu-id="9d5df-127">PowerShell-implementaties kunnen dit patroon gebruiken voor elke configuratie worden toegewezen aan een rol.</span><span class="sxs-lookup"><span data-stu-id="9d5df-127">Any PowerShell-based deployments can use this pattern to map each configuration to a role.</span></span>

4) <span data-ttu-id="9d5df-128">Voor het configureren van Azure diagnostics voor het verzenden van alle prestatiemeteritems en foutniveau logboeken die worden verzameld door de agent Azure diagnostische gegevens naar Application Insights inschakelen de **diagnostische gegevens verzenden naar Application Insights** optie.</span><span class="sxs-lookup"><span data-stu-id="9d5df-128">To configure Azure diagnostics to send all performance counters and error-level logs collected by the Azure diagnostics agent to Application Insights, enable the **Send diagnostics data to Application Insights** option.</span></span> 

    <span data-ttu-id="9d5df-129">Als u wilt meer configureren welke gegevens verzonden naar Application Insights, moet u handmatig bewerken de *diagnostics.wadcfgx* -bestand voor elke rol.</span><span class="sxs-lookup"><span data-stu-id="9d5df-129">If you want to further configure what data is sent to Application Insights, you must manually edit the *diagnostics.wadcfgx* file for each role.</span></span> <span data-ttu-id="9d5df-130">Zie [Azure Diagnostics configureren om gegevens te verzenden naar Application Insights](#configure-azure-diagnostics-to-send-data-to-application-insights) voor meer informatie over het handmatig bijwerken van de configuratie.</span><span class="sxs-lookup"><span data-stu-id="9d5df-130">See [Configure Azure Diagnostics to send data to Application Insights](#configure-azure-diagnostics-to-send-data-to-application-insights) to learn more about manually updating the configuration.</span></span>

<span data-ttu-id="9d5df-131">Wanneer de cloudservice is geconfigureerd voor het verzenden van Azure diagnostics-gegevens naar application insights, kunt u deze in Azure implementeert normaal gesproken alleen voor zorgen dat de extensie Azure diagnostics is ingeschakeld.</span><span class="sxs-lookup"><span data-stu-id="9d5df-131">When the cloud service is configured to send Azure diagnostics data to application insights, you can deploy it to Azure normally, making sure the Azure diagnostics extension is enabled.</span></span> <span data-ttu-id="9d5df-132">Zie voor meer informatie [publiceren van een Cloudservice met Visual Studio](../vs-azure-tools-publishing-a-cloud-service.md).</span><span class="sxs-lookup"><span data-stu-id="9d5df-132">For more information, see  [Publishing a Cloud Service using Visual Studio](../vs-azure-tools-publishing-a-cloud-service.md).</span></span>  

## <a name="viewing-azure-diagnostics-data-in-application-insights"></a><span data-ttu-id="9d5df-133">Azure diagnostics-gegevens weergeven in Application Insights</span><span class="sxs-lookup"><span data-stu-id="9d5df-133">Viewing Azure diagnostics data in Application Insights</span></span>
<span data-ttu-id="9d5df-134">De Azure diagnostische telemetrie weergegeven in de Application Insights-resource die is geconfigureerd voor uw cloudservice.</span><span class="sxs-lookup"><span data-stu-id="9d5df-134">The Azure diagnostic telemetry shows up in the Application Insights resource configured for your cloud service.</span></span>

<span data-ttu-id="9d5df-135">Azure diagnostics typen logboekmap naar Application Insights-concepten op de volgende manieren:</span><span class="sxs-lookup"><span data-stu-id="9d5df-135">Azure diagnostics log types map to Application Insights concepts in these ways:</span></span>

* <span data-ttu-id="9d5df-136">Prestatie-items worden weergegeven als aangepaste metrische gegevens in Application Insights.</span><span class="sxs-lookup"><span data-stu-id="9d5df-136">Performance counters are displayed as Custom Metrics in Application Insights.</span></span>
* <span data-ttu-id="9d5df-137">Windows-gebeurtenislogboeken weergegeven als traceringen en aangepaste gebeurtenissen in Application Insights.</span><span class="sxs-lookup"><span data-stu-id="9d5df-137">Windows Event Logs are shown as Traces and Custom Events in Application Insights.</span></span>
* <span data-ttu-id="9d5df-138">Toepassing Logboeken, ETW-logboeken en de logboekbestanden van de infrastructuur van diagnostische gegevens worden weergegeven als de traceringen in Application Insights.</span><span class="sxs-lookup"><span data-stu-id="9d5df-138">Application logs, ETW logs, and any Diagnostics Infrastructure logs are shown as Traces in Application Insights.</span></span>

<span data-ttu-id="9d5df-139">Als u wilt gegevens van Azure diagnostics weergeven in Application Insights, een van de volgende te doen:</span><span class="sxs-lookup"><span data-stu-id="9d5df-139">To view Azure diagnostics data in Application Insights, do one of the following:</span></span>

* <span data-ttu-id="9d5df-140">Gebruik [Metrics explorer](../application-insights/app-insights-metrics-explorer.md) voor het visualiseren van eventuele aangepaste prestatiemeteritems of de aantallen voor verschillende soorten gebeurtenissen van de Windows-gebeurtenislogboek.</span><span class="sxs-lookup"><span data-stu-id="9d5df-140">Use [Metrics explorer](../application-insights/app-insights-metrics-explorer.md) to visualize any custom performance counters or counts of different types of Windows Event Log events.</span></span>

    ![Aangepaste metrische gegevens in Metrics Explorer][5]

* <span data-ttu-id="9d5df-142">Gebruik [Search](../application-insights/app-insights-diagnostic-search.md) kunt u zoeken in de traceerlogboeken verzonden door Azure Diagnostics.</span><span class="sxs-lookup"><span data-stu-id="9d5df-142">Use [Search](../application-insights/app-insights-diagnostic-search.md) to search across the  trace logs sent by Azure Diagnostics.</span></span> <span data-ttu-id="9d5df-143">Bijvoorbeeld, als een onverwerkte uitzondering heeft veroorzaakt crashes en gebruik de rol, informatie over de uitzondering wordt weergegeven in de *toepassing* kanaal van *Windows-gebeurtenislogboek*.</span><span class="sxs-lookup"><span data-stu-id="9d5df-143">For example, if an unhandled exception has caused the role to crash and recycle, information about the exception shows up in the *Application* channel of *Windows Event Log*.</span></span> <span data-ttu-id="9d5df-144">U kunt zoeken gebruiken om te kijken naar de Windows-gebeurtenislogboek-fout en voert u de volledige stack-trace voor de uitzondering om te helpen de oorzaak van het probleem te vinden.</span><span class="sxs-lookup"><span data-stu-id="9d5df-144">You can use search to look at the Windows Event Log error and get the full stack trace for the exception to help find the cause of the issue.</span></span>

    ![Traceringen zoeken][6]

## <a name="next-steps"></a><span data-ttu-id="9d5df-146">Volgende stappen</span><span class="sxs-lookup"><span data-stu-id="9d5df-146">Next Steps</span></span>
* <span data-ttu-id="9d5df-147">[De Application Insights-SDK toevoegen aan uw cloudservice](../application-insights/app-insights-cloudservices.md) voor het verzenden van gegevens over aanvragen, uitzonderingen, afhankelijkheden en eventuele aangepaste telemetrie van uw toepassing.</span><span class="sxs-lookup"><span data-stu-id="9d5df-147">[Add the Application Insights SDK to your cloud service](../application-insights/app-insights-cloudservices.md) to send data about requests, exceptions, dependencies, and any custom telemetry from your application.</span></span> <span data-ttu-id="9d5df-148">In combinatie met de Azure Diagnostics-gegevens, deze informatie kunt u een compleet beeld van uw toepassing en het systeem, allemaal in dezelfde toepassing inzicht resource.</span><span class="sxs-lookup"><span data-stu-id="9d5df-148">When combined with the Azure Diagnostics data, this information you can get a complete view of your application and system, all in the same Application Insight resource.</span></span>  

<!--Image references-->
[1]: ./media/cloud-services-dotnet-diagnostics-applicationinsights/solution-explorer-properties.png
[2]: ./media/cloud-services-dotnet-diagnostics-applicationinsights/role-designer-sendtoappinsights.png
[3]: ./media/cloud-services-dotnet-diagnostics-applicationinsights/select-appinsights-resource.png
[4]: ./media/cloud-services-dotnet-diagnostics-applicationinsights/role-designer-appinsights-serviceconfig.png
[5]: ./media/cloud-services-dotnet-diagnostics-applicationinsights/metrics-explorer-custom-metrics.png
[6]: ./media/cloud-services-dotnet-diagnostics-applicationinsights/search-windowseventlog-error.png
