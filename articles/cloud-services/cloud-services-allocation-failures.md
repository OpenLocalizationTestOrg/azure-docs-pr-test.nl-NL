---
title: Cloud toewijzingsfout bij het oplossen van problemen | Microsoft Docs
description: Toewijzingsfouten oplossen die zijn opgetreden bij het implementeren van Cloud Services in Azure
services: azure-service-management, cloud-services
documentationcenter: 
author: simonxjx
manager: felixwu
editor: 
tags: top-support-issue
ms.assetid: 529157eb-e4a1-4388-aa2b-09e8b923af74
ms.service: cloud-services
ms.workload: na
ms.tgt_pltfrm: ibiza
ms.devlang: na
ms.topic: article
ms.date: 7/26/2017
ms.author: v-six
ms.openlocfilehash: 3379b6d9bea874abecae7e56d30cfb15e6b0c2fc
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 08/03/2017
---
# <a name="troubleshooting-allocation-failure-when-you-deploy-cloud-services-in-azure"></a><span data-ttu-id="2a640-103">Toewijzingsfouten oplossen die zijn opgetreden bij het implementeren van Cloud Services in Azure</span><span class="sxs-lookup"><span data-stu-id="2a640-103">Troubleshooting allocation failure when you deploy Cloud Services in Azure</span></span>
## <a name="summary"></a><span data-ttu-id="2a640-104">Samenvatting</span><span class="sxs-lookup"><span data-stu-id="2a640-104">Summary</span></span>
<span data-ttu-id="2a640-105">Als u exemplaren naar een Cloudservice distribueren of nieuwe web- of worker-rolexemplaren toevoegen, wijst Microsoft Azure compute-bronnen.</span><span class="sxs-lookup"><span data-stu-id="2a640-105">When you deploy instances to a Cloud Service or add new web or worker role instances, Microsoft Azure allocates compute resources.</span></span> <span data-ttu-id="2a640-106">Tijd tot tijd krijgt u fouten bij het uitvoeren van deze bewerkingen zelfs voordat u de Azure-abonnement limieten bereiken.</span><span class="sxs-lookup"><span data-stu-id="2a640-106">You may occasionally receive errors when performing these operations even before you reach the Azure subscription limits.</span></span> <span data-ttu-id="2a640-107">Dit artikel wordt uitgelegd van de oorzaken van een deel van de algemene toewijzingsfouten en mogelijk doorvoeren wordt voorgesteld.</span><span class="sxs-lookup"><span data-stu-id="2a640-107">This article explains the causes of some of the common allocation failures and suggests possible remediation.</span></span> <span data-ttu-id="2a640-108">De gegevens zijn mogelijk ook nuttig bij het plannen van de implementatie van uw services.</span><span class="sxs-lookup"><span data-stu-id="2a640-108">The information may also be useful when you plan the deployment of your services.</span></span>

[!INCLUDE [support-disclaimer](../../includes/support-disclaimer.md)]

### <a name="background--how-allocation-works"></a><span data-ttu-id="2a640-109">Achtergrond – de werking van toewijzing</span><span class="sxs-lookup"><span data-stu-id="2a640-109">Background – How allocation works</span></span>
<span data-ttu-id="2a640-110">De servers in Azure-datacenters worden in clusters gepartitioneerd.</span><span class="sxs-lookup"><span data-stu-id="2a640-110">The servers in Azure datacenters are partitioned into clusters.</span></span> <span data-ttu-id="2a640-111">Een nieuwe toewijzingsaanvraag voor cloud-service wordt uitgevoerd in meerdere clusters.</span><span class="sxs-lookup"><span data-stu-id="2a640-111">A new cloud service allocation request is attempted in multiple clusters.</span></span> <span data-ttu-id="2a640-112">Wanneer de eerste instantie wordt geïmplementeerd op een cloudservice (in fasering of productie), die cloudservice opgehaald vastgemaakt aan een cluster.</span><span class="sxs-lookup"><span data-stu-id="2a640-112">When the first instance is deployed to a cloud service(in either staging or production), that cloud service gets pinned to a cluster.</span></span> <span data-ttu-id="2a640-113">Eventuele verdere implementaties voor de cloudservice gebeurt in hetzelfde cluster.</span><span class="sxs-lookup"><span data-stu-id="2a640-113">Any further deployments for the cloud service will happen in the same cluster.</span></span> <span data-ttu-id="2a640-114">In dit artikel verwijzen we naar dit zoals 'vastgemaakt aan een cluster'.</span><span class="sxs-lookup"><span data-stu-id="2a640-114">In this article, we'll refer to this as "pinned to a cluster".</span></span> <span data-ttu-id="2a640-115">Afbeelding 1 hieronder ziet u dat het geval van een normale toewijzing die wordt uitgevoerd in meerdere clusters; Diagram 2 ziet u dat het geval van een toewijzing die is vastgemaakt aan Cluster 2 omdat waar de bestaande CS_1 voor Cloud-Service wordt gehost.</span><span class="sxs-lookup"><span data-stu-id="2a640-115">Diagram 1 below illustrates the case of a normal allocation which is attempted in multiple clusters; Diagram 2 illustrates the case of an allocation that's pinned to Cluster 2 because that's where the existing Cloud Service CS_1 is hosted.</span></span>

![Diagram van toewijzing](./media/cloud-services-allocation-failure/Allocation1.png)

### <a name="why-allocation-failure-happens"></a><span data-ttu-id="2a640-117">Waarom toewijzingsfout gebeurt</span><span class="sxs-lookup"><span data-stu-id="2a640-117">Why allocation failure happens</span></span>
<span data-ttu-id="2a640-118">Wanneer een aanvraag voor geheugentoewijzing is vastgemaakt aan een cluster, is er een hogere kans niet te vinden van resources vrij, omdat de resourcegroep beschikbaar beperkt tot een cluster is.</span><span class="sxs-lookup"><span data-stu-id="2a640-118">When an allocation request is pinned to a cluster, there's a higher chance of failing to find free resources since the available resource pool is limited to a cluster.</span></span> <span data-ttu-id="2a640-119">Bovendien als uw aanvraag voor geheugentoewijzing is vastgemaakt aan een cluster, maar het type resource dat u hebt aangevraagd wordt niet ondersteund door dit cluster, zal uw aanvraag mislukken zelfs als het cluster gratis resource heeft.</span><span class="sxs-lookup"><span data-stu-id="2a640-119">Furthermore, if your allocation request is pinned to a cluster but the type of resource you requested is not supported by that cluster, your request will fail even if the cluster has free resource.</span></span> <span data-ttu-id="2a640-120">Diagram 3 hieronder ziet u het geval waarbij een vastgezette toewijzing is mislukt omdat het cluster alleen candidate geen gratis resources.</span><span class="sxs-lookup"><span data-stu-id="2a640-120">Diagram 3 below illustrates the case where a pinned allocation fails because the only candidate cluster does not have free resources.</span></span> <span data-ttu-id="2a640-121">Diagram 4 ziet u het geval waarbij een vastgezette toewijzing is mislukt omdat het cluster alleen candidate biedt geen ondersteuning voor de aangevraagde VM-grootte, zelfs als het cluster resources vrij heeft.</span><span class="sxs-lookup"><span data-stu-id="2a640-121">Diagram 4 illustrates the case where a pinned allocation fails because the only candidate cluster does not support the requested VM size, even though the cluster has free resources.</span></span>

![Vastgemaakte geheugentoewijzing is mislukt](./media/cloud-services-allocation-failure/Allocation2.png)

## <a name="troubleshooting-allocation-failure-for-cloud-services"></a><span data-ttu-id="2a640-123">Toewijzingsfouten voor cloudservices oplossen</span><span class="sxs-lookup"><span data-stu-id="2a640-123">Troubleshooting allocation failure for cloud services</span></span>
### <a name="error-message"></a><span data-ttu-id="2a640-124">Foutbericht</span><span class="sxs-lookup"><span data-stu-id="2a640-124">Error Message</span></span>
<span data-ttu-id="2a640-125">U weergegeven het volgende foutbericht:</span><span class="sxs-lookup"><span data-stu-id="2a640-125">You may see the following error message:</span></span>

    "Azure operation '{operation id}' failed with code Compute.ConstrainedAllocationFailed. Details: Allocation failed; unable to satisfy constraints in request. The requested new service deployment is bound to an Affinity Group, or it targets a Virtual Network, or there is an existing deployment under this hosted service. Any of these conditions constrains the new deployment to specific Azure resources. Please retry later or try reducing the VM size or number of role instances. Alternatively, if possible, remove the aforementioned constraints or try deploying to a different region."

### <a name="common-issues"></a><span data-ttu-id="2a640-126">Algemene problemen</span><span class="sxs-lookup"><span data-stu-id="2a640-126">Common Issues</span></span>
<span data-ttu-id="2a640-127">Hier volgen de algemene toewijzing scenario's die ertoe leiden dat een aanvraag voor geheugentoewijzing om te worden vastgemaakt aan één cluster.</span><span class="sxs-lookup"><span data-stu-id="2a640-127">Here are the common allocation scenarios that cause an allocation request to be pinned to a single cluster.</span></span>

* <span data-ttu-id="2a640-128">Implementeren naar sleuf Staging - als een cloudservice een implementatie in een sleuf heeft, is klikt u vervolgens de volledige in de cloud-service vastgemaakt aan een specifiek cluster.</span><span class="sxs-lookup"><span data-stu-id="2a640-128">Deploying to Staging Slot - If a cloud service has a deployment in either slot, then the entire cloud service is pinned to a specific cluster.</span></span>  <span data-ttu-id="2a640-129">Dit betekent dat als een implementatie al in de productiesite bestaat, klikt u vervolgens een nieuwe implementatie van de test kan alleen worden toegewezen in hetzelfde cluster als de productiesite.</span><span class="sxs-lookup"><span data-stu-id="2a640-129">This means that if a deployment already exists in the production slot, then a new staging deployment can only be allocated in the same cluster as the production slot.</span></span> <span data-ttu-id="2a640-130">Als het cluster heeft capaciteit bijna bereikt, kan het verzoek mislukken.</span><span class="sxs-lookup"><span data-stu-id="2a640-130">If the cluster is nearing capacity, the request may fail.</span></span>
* <span data-ttu-id="2a640-131">Schalen: nieuwe exemplaren toe te voegen aan een bestaande cloudservice moet toewijzen in hetzelfde cluster.</span><span class="sxs-lookup"><span data-stu-id="2a640-131">Scaling - Adding new instances to an existing cloud service must allocate in the same cluster.</span></span>  <span data-ttu-id="2a640-132">Kleine schaal aanvragen kan doorgaans worden verdeeld, maar niet altijd.</span><span class="sxs-lookup"><span data-stu-id="2a640-132">Small scaling requests can usually be allocated, but not always.</span></span> <span data-ttu-id="2a640-133">Als het cluster heeft capaciteit bijna bereikt, kan het verzoek mislukken.</span><span class="sxs-lookup"><span data-stu-id="2a640-133">If the cluster is nearing capacity, the request may fail.</span></span>
* <span data-ttu-id="2a640-134">Affiniteitsgroep - een nieuwe implementatie met een leeg cloudservice kan worden toegewezen door de infrastructuurresources in een cluster in deze regio, tenzij de cloudservice is vastgemaakt aan een affiniteitsgroep.</span><span class="sxs-lookup"><span data-stu-id="2a640-134">Affinity Group - A new deployment to an empty cloud service can be allocated by the fabric in any cluster in that region, unless the cloud service is pinned to an affinity group.</span></span> <span data-ttu-id="2a640-135">Implementaties van dezelfde affiniteitsgroep worden geprobeerd in hetzelfde cluster.</span><span class="sxs-lookup"><span data-stu-id="2a640-135">Deployments to the same affinity group will be attempted on the same cluster.</span></span> <span data-ttu-id="2a640-136">Als het cluster heeft capaciteit bijna bereikt, kan het verzoek mislukken.</span><span class="sxs-lookup"><span data-stu-id="2a640-136">If the cluster is nearing capacity, the request may fail.</span></span>
* <span data-ttu-id="2a640-137">Affiniteitsgroep vNet - oudere virtuele netwerken zijn gekoppeld aan affiniteitsgroepen in plaats van de regio's en cloudservices in deze virtuele netwerken zou worden vastgemaakt aan het cluster affiniteitsgroep.</span><span class="sxs-lookup"><span data-stu-id="2a640-137">Affinity Group vNet - Older Virtual Networks were tied to affinity groups instead of regions, and cloud services in these Virtual Networks would be pinned to the affinity group cluster.</span></span> <span data-ttu-id="2a640-138">Implementaties voor dit type virtueel netwerk wordt een poging op het cluster vastgemaakt.</span><span class="sxs-lookup"><span data-stu-id="2a640-138">Deployments to this type of virtual network will be attempted on the pinned cluster.</span></span> <span data-ttu-id="2a640-139">Als het cluster heeft capaciteit bijna bereikt, kan het verzoek mislukken.</span><span class="sxs-lookup"><span data-stu-id="2a640-139">If the cluster is nearing capacity, the request may fail.</span></span>

## <a name="solutions"></a><span data-ttu-id="2a640-140">Oplossingen</span><span class="sxs-lookup"><span data-stu-id="2a640-140">Solutions</span></span>
1. <span data-ttu-id="2a640-141">Implementeren naar een nieuwe cloudservice - deze oplossing is waarschijnlijk meest geslaagd omdat het platform kunt kiezen uit alle clusters in deze regio.</span><span class="sxs-lookup"><span data-stu-id="2a640-141">Redeploy to a new cloud service - This solution is likely to be most successful as it allows the platform to choose from all clusters in that region.</span></span>

   * <span data-ttu-id="2a640-142">De werkbelasting implementeren op een nieuwe cloudservice</span><span class="sxs-lookup"><span data-stu-id="2a640-142">Deploy the workload to a new cloud service</span></span>  
   * <span data-ttu-id="2a640-143">De CNAME- of een record verkeer verwijst naar de nieuwe cloudservice bijwerken</span><span class="sxs-lookup"><span data-stu-id="2a640-143">Update the CNAME or A record to point traffic to the new cloud service</span></span>
   * <span data-ttu-id="2a640-144">Zodra de oude site nul verkeer gaat, kunt u de oude cloudservice verwijderen.</span><span class="sxs-lookup"><span data-stu-id="2a640-144">Once zero traffic is going to the old site, you can delete the old cloud service.</span></span> <span data-ttu-id="2a640-145">Deze oplossing moet rekening worden gebracht zonder uitvaltijd.</span><span class="sxs-lookup"><span data-stu-id="2a640-145">This solution should incur zero downtime.</span></span>
2. <span data-ttu-id="2a640-146">Verwijderen van de productie- en staging-sleuven: deze oplossing uw bestaande DNS-naam blijft behouden, maar zal leiden tot uitvaltijd voor uw toepassing.</span><span class="sxs-lookup"><span data-stu-id="2a640-146">Delete both production and staging slots - This solution will preserve your existing DNS name, but will cause downtime to your application.</span></span>

   * <span data-ttu-id="2a640-147">De productie- en staging-sleuven van een bestaande cloudservice zodat de cloudservice leeg is, verwijderen en vervolgens</span><span class="sxs-lookup"><span data-stu-id="2a640-147">Delete the production and staging slots of an existing cloud service so that the cloud service is empty, and then</span></span>
   * <span data-ttu-id="2a640-148">Maak een nieuwe implementatie in de bestaande cloudservice.</span><span class="sxs-lookup"><span data-stu-id="2a640-148">Create a new deployment in the existing cloud service.</span></span> <span data-ttu-id="2a640-149">Dit wordt opnieuw geprobeerd te toewijzing in alle clusters in de regio.</span><span class="sxs-lookup"><span data-stu-id="2a640-149">This will re-attempt to allocation on all clusters in the region.</span></span> <span data-ttu-id="2a640-150">Zorg ervoor dat de cloudservice is niet gekoppeld aan een affiniteitsgroep.</span><span class="sxs-lookup"><span data-stu-id="2a640-150">Ensure the cloud service is not tied to an affinity group.</span></span>
3. <span data-ttu-id="2a640-151">Gereserveerd IP - behoudt deze oplossing voor uw bestaande IP-adres, maar zal leiden tot uitvaltijd voor uw toepassing.</span><span class="sxs-lookup"><span data-stu-id="2a640-151">Reserved IP -  This solution will preserve your existing IP address, but will cause downtime to your application.</span></span>  

   * <span data-ttu-id="2a640-152">Maken van een ReservedIP voor uw bestaande implementatie met behulp van Powershell</span><span class="sxs-lookup"><span data-stu-id="2a640-152">Create a ReservedIP for your existing deployment using Powershell</span></span>

     ```
     New-AzureReservedIP -ReservedIPName {new reserved IP name} -Location {location} -ServiceName {existing service name}
     ```
   * <span data-ttu-id="2a640-153">Ga als volgt #2 hierboven, alleen voor zorgen dat de nieuwe ReservedIP opgeven in de service CSCFG.</span><span class="sxs-lookup"><span data-stu-id="2a640-153">Follow #2 from above, making sure to specify the new ReservedIP in the service's CSCFG.</span></span>
4. <span data-ttu-id="2a640-154">Verwijder affiniteitsgroep voor nieuwe implementaties - Affiniteitsgroepen niet langer worden aanbevolen.</span><span class="sxs-lookup"><span data-stu-id="2a640-154">Remove affinity group for new deployments - Affinity Groups are no longer recommended.</span></span> <span data-ttu-id="2a640-155">Volg de stappen voor #1 hierboven voor het implementeren van een nieuwe cloudservice.</span><span class="sxs-lookup"><span data-stu-id="2a640-155">Follow steps for #1 above to deploy a new cloud service.</span></span> <span data-ttu-id="2a640-156">Zorg ervoor dat cloudservice is niet in een affiniteitsgroep.</span><span class="sxs-lookup"><span data-stu-id="2a640-156">Ensure cloud service is not in an affinity group.</span></span>
5. <span data-ttu-id="2a640-157">Converteren naar een regionaal virtueel netwerk - Zie [van Affiniteitsgroepen migreren naar een regionaal virtueel netwerk (VNet)](../virtual-network/virtual-networks-migrate-to-regional-vnet.md).</span><span class="sxs-lookup"><span data-stu-id="2a640-157">Convert to a Regional Virtual Network - See [How to migrate from Affinity Groups to a Regional Virtual Network (VNet)](../virtual-network/virtual-networks-migrate-to-regional-vnet.md).</span></span>
