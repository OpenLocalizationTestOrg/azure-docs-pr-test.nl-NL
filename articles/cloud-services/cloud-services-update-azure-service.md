---
title: Het bijwerken van een service in de cloud | Microsoft Docs
description: Informatie over het bijwerken van cloudservices in Azure. Meer informatie over hoe een update op een cloudservice wordt uitgevoerd om beschikbaarheid te garanderen.
services: cloud-services
documentationcenter: 
author: Thraka
manager: timlt
editor: 
ms.assetid: c6a8b5e6-5c99-454c-9911-5c7ae8d1af63
ms.service: cloud-services
ms.workload: tbd
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 04/19/2017
ms.author: adegeo
ms.openlocfilehash: 2ba9676ed2afce7f18446642527971f5001b5ca7
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 07/11/2017
---
# <a name="how-to-update-a-cloud-service"></a><span data-ttu-id="d43fc-104">Het bijwerken van een service in de cloud</span><span class="sxs-lookup"><span data-stu-id="d43fc-104">How to update a cloud service</span></span>

<span data-ttu-id="d43fc-105">Bijwerken van een cloudservice, inclusief de functies en de gastbesturingssysteem, is een proces drie stappen.</span><span class="sxs-lookup"><span data-stu-id="d43fc-105">Updating a cloud service, including both its roles and guest OS, is a three step process.</span></span> <span data-ttu-id="d43fc-106">Eerst moeten de binaire bestanden en de configuratiebestanden voor de nieuwe cloudservice of de versie van het besturingssysteem worden geüpload.</span><span class="sxs-lookup"><span data-stu-id="d43fc-106">First, the binaries and configuration files for the new cloud service or OS version must be uploaded.</span></span> <span data-ttu-id="d43fc-107">Vervolgens reserveert Azure compute- en netwerkbronnen voor de cloudservice op basis van de vereisten van de nieuwe versie van de cloud-service.</span><span class="sxs-lookup"><span data-stu-id="d43fc-107">Next, Azure reserves compute and network resources for the cloud service based on the requirements of the new cloud service version.</span></span> <span data-ttu-id="d43fc-108">Ten slotte voert Azure een uitrollende upgrade voor het bijwerken van de tenant stapsgewijs naar de nieuwe versie of een gastbesturingssysteem, behoud uw beschikbaarheid.</span><span class="sxs-lookup"><span data-stu-id="d43fc-108">Finally, Azure performs a rolling upgrade to incrementally update the tenant to the new version or guest OS, while preserving your availability.</span></span> <span data-ttu-id="d43fc-109">Dit artikel worden de details van deze laatste stap – de rolling upgrade.</span><span class="sxs-lookup"><span data-stu-id="d43fc-109">This article discusses the details of this last step – the rolling upgrade.</span></span>

## <a name="update-an-azure-service"></a><span data-ttu-id="d43fc-110">Een Azure-Service bijwerken</span><span class="sxs-lookup"><span data-stu-id="d43fc-110">Update an Azure Service</span></span>
<span data-ttu-id="d43fc-111">Azure worden uw rolinstanties georganiseerd in logische groepen indelen upgradedomeinen (UD) genoemd.</span><span class="sxs-lookup"><span data-stu-id="d43fc-111">Azure organizes your role instances into logical groupings called upgrade domains (UD).</span></span> <span data-ttu-id="d43fc-112">Upgradedomeinen (UD) zijn logische verzamelingen rolexemplaren die als een groep worden bijgewerkt.</span><span class="sxs-lookup"><span data-stu-id="d43fc-112">Upgrade domains (UD) are logical sets of role instances that are updated as a group.</span></span>  <span data-ttu-id="d43fc-113">Azure-updates een cloud service één UD tegelijk, waardoor exemplaren worden weergegeven in andere UDs om door te gaan voor verkeer.</span><span class="sxs-lookup"><span data-stu-id="d43fc-113">Azure updates a cloud service one UD at a time, which allows instances in other UDs to continue serving traffic.</span></span>

<span data-ttu-id="d43fc-114">Aantal upgradedomeinen is 5.</span><span class="sxs-lookup"><span data-stu-id="d43fc-114">The default number of upgrade domains is 5.</span></span> <span data-ttu-id="d43fc-115">U kunt een verschillend aantal upgradedomeinen opgeven door het kenmerk upgradeDomainCount in de service-definitiebestand (.csdef).</span><span class="sxs-lookup"><span data-stu-id="d43fc-115">You can specify a different number of upgrade domains by including the upgradeDomainCount attribute in the service’s definition file (.csdef).</span></span> <span data-ttu-id="d43fc-116">Zie voor meer informatie over het kenmerk upgradeDomainCount [WebRole Schema](https://msdn.microsoft.com/library/azure/gg557553.aspx) of [WorkerRole Schema](https://msdn.microsoft.com/library/azure/gg557552.aspx).</span><span class="sxs-lookup"><span data-stu-id="d43fc-116">For more information about the upgradeDomainCount attribute, see [WebRole Schema](https://msdn.microsoft.com/library/azure/gg557553.aspx) or [WorkerRole Schema](https://msdn.microsoft.com/library/azure/gg557552.aspx).</span></span>

<span data-ttu-id="d43fc-117">Wanneer u een update in plaats van een of meer rollen in uw service uitvoert, Azure-updates sets rolinstanties volgens het upgradedomein waartoe ze behoren.</span><span class="sxs-lookup"><span data-stu-id="d43fc-117">When you perform an in-place update of one or more roles in your service, Azure updates sets of role instances according to the upgrade domain to which they belong.</span></span> <span data-ttu-id="d43fc-118">Alle exemplaren van in een opgegeven upgradedomein – stoppen, bijwerken, worden gezet online – back-Azure-updates gaat vervolgens naar het volgende domein.</span><span class="sxs-lookup"><span data-stu-id="d43fc-118">Azure updates all of the instances in a given upgrade domain – stopping them, updating them, bringing them back on-line – then moves onto the next domain.</span></span> <span data-ttu-id="d43fc-119">Door alleen de exemplaren die worden uitgevoerd in het huidige upgradedomein stoppen, ervoor Azure zorgt dat een update met het zo weinig mogelijk gevolgen voor de uitgevoerde service plaatsvindt.</span><span class="sxs-lookup"><span data-stu-id="d43fc-119">By stopping only the instances running in the current upgrade domain, Azure makes sure that an update occurs with the least possible impact to the running service.</span></span> <span data-ttu-id="d43fc-120">Zie voor meer informatie [hoe de update wordt voortgezet](#howanupgradeproceeds) verderop in dit artikel.</span><span class="sxs-lookup"><span data-stu-id="d43fc-120">For more information, see [How the update proceeds](#howanupgradeproceeds) later in this article.</span></span>

> [!NOTE]
> <span data-ttu-id="d43fc-121">Terwijl de voorwaarden **bijwerken** en **upgrade** iets andere betekenis hebben in de context van Azure, ze door elkaar kunnen worden gebruikt voor de processen en beschrijvingen van de functies in dit document.</span><span class="sxs-lookup"><span data-stu-id="d43fc-121">While the terms **update** and **upgrade** have slightly different meaning in the context Azure, they can be used interchangeably for the processes and descriptions of the features in this document.</span></span>
>
>

<span data-ttu-id="d43fc-122">Uw service moet ten minste twee exemplaren van een rol voor deze rol worden bijgewerkt definiëren in-place zonder uitvaltijd.</span><span class="sxs-lookup"><span data-stu-id="d43fc-122">Your service must define at least two instances of a role for that role to be updated in-place without downtime.</span></span> <span data-ttu-id="d43fc-123">Als de service uit slechts één exemplaar van een rol bestaat, zijn uw service niet beschikbaar totdat de update in-place is voltooid.</span><span class="sxs-lookup"><span data-stu-id="d43fc-123">If the service consists of only one instance of one role, your service will be unavailable until the in-place update has finished.</span></span>

<span data-ttu-id="d43fc-124">In dit onderwerp worden de volgende informatie over Azure-updates:</span><span class="sxs-lookup"><span data-stu-id="d43fc-124">This topic covers the following information about Azure updates:</span></span>

* [<span data-ttu-id="d43fc-125">Servicewijzigingen toegestaan tijdens het bijwerken</span><span class="sxs-lookup"><span data-stu-id="d43fc-125">Allowed service changes during an update</span></span>](#AllowedChanges)
* [<span data-ttu-id="d43fc-126">Hoe een upgrade wordt uitgevoerd</span><span class="sxs-lookup"><span data-stu-id="d43fc-126">How an upgrade proceeds</span></span>](#howanupgradeproceeds)
* [<span data-ttu-id="d43fc-127">Terugdraaien van een update</span><span class="sxs-lookup"><span data-stu-id="d43fc-127">Rollback of an update</span></span>](#RollbackofanUpdate)
* [<span data-ttu-id="d43fc-128">Meerdere mutating bewerkingen op een actieve implementatie initiëren</span><span class="sxs-lookup"><span data-stu-id="d43fc-128">Initiating multiple mutating operations on an ongoing deployment</span></span>](#multiplemutatingoperations)
* [<span data-ttu-id="d43fc-129">Distributie van functies tussen domeinen upgraden</span><span class="sxs-lookup"><span data-stu-id="d43fc-129">Distribution of roles across upgrade domains</span></span>](#distributiondfroles)

<a name="AllowedChanges"></a>

## <a name="allowed-service-changes-during-an-update"></a><span data-ttu-id="d43fc-130">Servicewijzigingen toegestaan tijdens het bijwerken</span><span class="sxs-lookup"><span data-stu-id="d43fc-130">Allowed service changes during an update</span></span>
<span data-ttu-id="d43fc-131">De volgende tabel toont de toegestane wijzigingen in een service tijdens het bijwerken:</span><span class="sxs-lookup"><span data-stu-id="d43fc-131">The following table shows the allowed changes to a service during an update:</span></span>

| <span data-ttu-id="d43fc-132">Wijzigingen die zijn toegestaan als host fungeert, services en functies</span><span class="sxs-lookup"><span data-stu-id="d43fc-132">Changes permitted to hosting, services, and roles</span></span> | <span data-ttu-id="d43fc-133">InPlace-update</span><span class="sxs-lookup"><span data-stu-id="d43fc-133">In-place update</span></span> | <span data-ttu-id="d43fc-134">Gefaseerde (VIP's wisselen)</span><span class="sxs-lookup"><span data-stu-id="d43fc-134">Staged (VIP swap)</span></span> | <span data-ttu-id="d43fc-135">Verwijderen en opnieuw implementeren</span><span class="sxs-lookup"><span data-stu-id="d43fc-135">Delete and re-deploy</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="d43fc-136">Besturingssysteem</span><span class="sxs-lookup"><span data-stu-id="d43fc-136">Operating system version</span></span> |<span data-ttu-id="d43fc-137">Ja</span><span class="sxs-lookup"><span data-stu-id="d43fc-137">Yes</span></span> |<span data-ttu-id="d43fc-138">Ja</span><span class="sxs-lookup"><span data-stu-id="d43fc-138">Yes</span></span> |<span data-ttu-id="d43fc-139">Ja</span><span class="sxs-lookup"><span data-stu-id="d43fc-139">Yes</span></span> |
| <span data-ttu-id="d43fc-140">.NET-vertrouwensniveau</span><span class="sxs-lookup"><span data-stu-id="d43fc-140">.NET trust level</span></span> |<span data-ttu-id="d43fc-141">Ja</span><span class="sxs-lookup"><span data-stu-id="d43fc-141">Yes</span></span> |<span data-ttu-id="d43fc-142">Ja</span><span class="sxs-lookup"><span data-stu-id="d43fc-142">Yes</span></span> |<span data-ttu-id="d43fc-143">Ja</span><span class="sxs-lookup"><span data-stu-id="d43fc-143">Yes</span></span> |
| <span data-ttu-id="d43fc-144">Grootte van virtuele machine<sup>1</sup></span><span class="sxs-lookup"><span data-stu-id="d43fc-144">Virtual machine size<sup>1</sup></span></span> |<span data-ttu-id="d43fc-145">Ja<sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="d43fc-145">Yes<sup>2</sup></span></span> |<span data-ttu-id="d43fc-146">Ja</span><span class="sxs-lookup"><span data-stu-id="d43fc-146">Yes</span></span> |<span data-ttu-id="d43fc-147">Ja</span><span class="sxs-lookup"><span data-stu-id="d43fc-147">Yes</span></span> |
| <span data-ttu-id="d43fc-148">Instellingen voor de lokale opslag</span><span class="sxs-lookup"><span data-stu-id="d43fc-148">Local storage settings</span></span> |<span data-ttu-id="d43fc-149">Alleen verhogen<sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="d43fc-149">Increase only<sup>2</sup></span></span> |<span data-ttu-id="d43fc-150">Ja</span><span class="sxs-lookup"><span data-stu-id="d43fc-150">Yes</span></span> |<span data-ttu-id="d43fc-151">Ja</span><span class="sxs-lookup"><span data-stu-id="d43fc-151">Yes</span></span> |
| <span data-ttu-id="d43fc-152">Toevoegen of verwijderen van rollen in een service</span><span class="sxs-lookup"><span data-stu-id="d43fc-152">Add or remove roles in a service</span></span> |<span data-ttu-id="d43fc-153">Ja</span><span class="sxs-lookup"><span data-stu-id="d43fc-153">Yes</span></span> |<span data-ttu-id="d43fc-154">Ja</span><span class="sxs-lookup"><span data-stu-id="d43fc-154">Yes</span></span> |<span data-ttu-id="d43fc-155">Ja</span><span class="sxs-lookup"><span data-stu-id="d43fc-155">Yes</span></span> |
| <span data-ttu-id="d43fc-156">Aantal exemplaren van een bepaalde rol</span><span class="sxs-lookup"><span data-stu-id="d43fc-156">Number of instances of a particular role</span></span> |<span data-ttu-id="d43fc-157">Ja</span><span class="sxs-lookup"><span data-stu-id="d43fc-157">Yes</span></span> |<span data-ttu-id="d43fc-158">Ja</span><span class="sxs-lookup"><span data-stu-id="d43fc-158">Yes</span></span> |<span data-ttu-id="d43fc-159">Ja</span><span class="sxs-lookup"><span data-stu-id="d43fc-159">Yes</span></span> |
| <span data-ttu-id="d43fc-160">Aantal of type eindpunten voor een service</span><span class="sxs-lookup"><span data-stu-id="d43fc-160">Number or type of endpoints for a service</span></span> |<span data-ttu-id="d43fc-161">Ja<sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="d43fc-161">Yes<sup>2</sup></span></span> |<span data-ttu-id="d43fc-162">Nee</span><span class="sxs-lookup"><span data-stu-id="d43fc-162">No</span></span> |<span data-ttu-id="d43fc-163">Ja</span><span class="sxs-lookup"><span data-stu-id="d43fc-163">Yes</span></span> |
| <span data-ttu-id="d43fc-164">Namen en waarden van configuratie-instellingen</span><span class="sxs-lookup"><span data-stu-id="d43fc-164">Names and values of configuration settings</span></span> |<span data-ttu-id="d43fc-165">Ja</span><span class="sxs-lookup"><span data-stu-id="d43fc-165">Yes</span></span> |<span data-ttu-id="d43fc-166">Ja</span><span class="sxs-lookup"><span data-stu-id="d43fc-166">Yes</span></span> |<span data-ttu-id="d43fc-167">Ja</span><span class="sxs-lookup"><span data-stu-id="d43fc-167">Yes</span></span> |
| <span data-ttu-id="d43fc-168">Waarden (maar niet de namen van) van configuratie-instellingen</span><span class="sxs-lookup"><span data-stu-id="d43fc-168">Values (but not names) of configuration settings</span></span> |<span data-ttu-id="d43fc-169">Ja</span><span class="sxs-lookup"><span data-stu-id="d43fc-169">Yes</span></span> |<span data-ttu-id="d43fc-170">Ja</span><span class="sxs-lookup"><span data-stu-id="d43fc-170">Yes</span></span> |<span data-ttu-id="d43fc-171">Ja</span><span class="sxs-lookup"><span data-stu-id="d43fc-171">Yes</span></span> |
| <span data-ttu-id="d43fc-172">Nieuwe certificaten toevoegen</span><span class="sxs-lookup"><span data-stu-id="d43fc-172">Add new certificates</span></span> |<span data-ttu-id="d43fc-173">Ja</span><span class="sxs-lookup"><span data-stu-id="d43fc-173">Yes</span></span> |<span data-ttu-id="d43fc-174">Ja</span><span class="sxs-lookup"><span data-stu-id="d43fc-174">Yes</span></span> |<span data-ttu-id="d43fc-175">Ja</span><span class="sxs-lookup"><span data-stu-id="d43fc-175">Yes</span></span> |
| <span data-ttu-id="d43fc-176">Wijzigen van bestaande certificaten</span><span class="sxs-lookup"><span data-stu-id="d43fc-176">Change existing certificates</span></span> |<span data-ttu-id="d43fc-177">Ja</span><span class="sxs-lookup"><span data-stu-id="d43fc-177">Yes</span></span> |<span data-ttu-id="d43fc-178">Ja</span><span class="sxs-lookup"><span data-stu-id="d43fc-178">Yes</span></span> |<span data-ttu-id="d43fc-179">Ja</span><span class="sxs-lookup"><span data-stu-id="d43fc-179">Yes</span></span> |
| <span data-ttu-id="d43fc-180">Implementeer nieuwe code</span><span class="sxs-lookup"><span data-stu-id="d43fc-180">Deploy new code</span></span> |<span data-ttu-id="d43fc-181">Ja</span><span class="sxs-lookup"><span data-stu-id="d43fc-181">Yes</span></span> |<span data-ttu-id="d43fc-182">Ja</span><span class="sxs-lookup"><span data-stu-id="d43fc-182">Yes</span></span> |<span data-ttu-id="d43fc-183">Ja</span><span class="sxs-lookup"><span data-stu-id="d43fc-183">Yes</span></span> |

<span data-ttu-id="d43fc-184"><sup>1</sup> formaat wijzigen beperkt tot de subset met grootten beschikbaar voor de cloudservice.</span><span class="sxs-lookup"><span data-stu-id="d43fc-184"><sup>1</sup> Size change limited to the subset of sizes available for the cloud service.</span></span>

<span data-ttu-id="d43fc-185"><sup>2</sup> vereist Azure SDK 1.5 of hoger.</span><span class="sxs-lookup"><span data-stu-id="d43fc-185"><sup>2</sup> Requires Azure SDK 1.5 or later versions.</span></span>

> [!WARNING]
> <span data-ttu-id="d43fc-186">De grootte van de virtuele machine wijzigen, zullen lokale gegevens.</span><span class="sxs-lookup"><span data-stu-id="d43fc-186">Changing the virtual machine size will destroy local data.</span></span>
>
>

<span data-ttu-id="d43fc-187">De volgende items worden niet ondersteund tijdens het bijwerken:</span><span class="sxs-lookup"><span data-stu-id="d43fc-187">The following items are not supported during an update:</span></span>

* <span data-ttu-id="d43fc-188">De naam van een rol wijzigen.</span><span class="sxs-lookup"><span data-stu-id="d43fc-188">Changing the name of a role.</span></span> <span data-ttu-id="d43fc-189">Verwijderen en voeg vervolgens de rol met de nieuwe naam.</span><span class="sxs-lookup"><span data-stu-id="d43fc-189">Remove and then add the role with the new name.</span></span>
* <span data-ttu-id="d43fc-190">Het wijzigen van het aantal upgraden-domein.</span><span class="sxs-lookup"><span data-stu-id="d43fc-190">Changing of the Upgrade Domain count.</span></span>
* <span data-ttu-id="d43fc-191">De grootte van de lokale resources wordt verminderd.</span><span class="sxs-lookup"><span data-stu-id="d43fc-191">Decreasing the size of the local resources.</span></span>

<span data-ttu-id="d43fc-192">Als u andere updates aan de definitie van uw service, zoals het verlagen van de grootte van de lokale resource moet u een VIP wisselen update uitvoeren.</span><span class="sxs-lookup"><span data-stu-id="d43fc-192">If you are making other updates to your service's definition, such as decreasing the size of local resource, you must perform a VIP swap update instead.</span></span> <span data-ttu-id="d43fc-193">Zie voor meer informatie [wisselen implementatie](https://msdn.microsoft.com/library/azure/ee460814.aspx).</span><span class="sxs-lookup"><span data-stu-id="d43fc-193">For more information, see [Swap Deployment](https://msdn.microsoft.com/library/azure/ee460814.aspx).</span></span>

<a name="howanupgradeproceeds"></a>

## <a name="how-an-upgrade-proceeds"></a><span data-ttu-id="d43fc-194">Hoe een upgrade wordt uitgevoerd</span><span class="sxs-lookup"><span data-stu-id="d43fc-194">How an upgrade proceeds</span></span>
<span data-ttu-id="d43fc-195">U kunt beslissen of u wilt bijwerken van de rollen in uw service of een enkele rol in de service.</span><span class="sxs-lookup"><span data-stu-id="d43fc-195">You can decide whether you want to update all of the roles in your service or a single role in the service.</span></span> <span data-ttu-id="d43fc-196">In beide gevallen worden alle exemplaren van elke rol die wordt bijgewerkt en deel uitmaken van het eerste upgradedomein is gestopt, bijgewerkt en weer online.</span><span class="sxs-lookup"><span data-stu-id="d43fc-196">In either case, all instances of each role that is being upgraded and belong to the first upgrade domain are stopped, upgraded, and brought back online.</span></span> <span data-ttu-id="d43fc-197">Zodra deze weer online zijn, zijn de exemplaren in de tweede upgradedomein is gestopt, bijgewerkt en weer online.</span><span class="sxs-lookup"><span data-stu-id="d43fc-197">Once they are back online, the instances in the second upgrade domain are stopped, upgraded, and brought back online.</span></span> <span data-ttu-id="d43fc-198">Een cloudservice kan maximaal één upgrade tegelijk actief hebben.</span><span class="sxs-lookup"><span data-stu-id="d43fc-198">A cloud service can have at most one upgrade active at a time.</span></span> <span data-ttu-id="d43fc-199">De upgrade wordt altijd uitgevoerd op de meest recente versie van de cloudservice.</span><span class="sxs-lookup"><span data-stu-id="d43fc-199">The upgrade is always performed against the latest version of the cloud service.</span></span>

<span data-ttu-id="d43fc-200">Het volgende diagram illustreert hoe de upgrade wordt uitgevoerd als u een van alle van de rollen in de service upgrade:</span><span class="sxs-lookup"><span data-stu-id="d43fc-200">The following diagram illustrates how the upgrade proceeds if you are upgrading all of the roles in the service:</span></span>

<span data-ttu-id="d43fc-201">![Upgrade van service](media/cloud-services-update-azure-service/IC345879.png "Upgrade van service")</span><span class="sxs-lookup"><span data-stu-id="d43fc-201">![Upgrade service](media/cloud-services-update-azure-service/IC345879.png "Upgrade service")</span></span>

<span data-ttu-id="d43fc-202">Deze volgende diagram ziet u hoe de update wordt uitgevoerd als u slechts één functie bijwerkt:</span><span class="sxs-lookup"><span data-stu-id="d43fc-202">This next diagram illustrates how the update proceeds if you are upgrading only a single role:</span></span>

<span data-ttu-id="d43fc-203">![Upgrade rol](media/cloud-services-update-azure-service/IC345880.png "Upgrade rol")</span><span class="sxs-lookup"><span data-stu-id="d43fc-203">![Upgrade role](media/cloud-services-update-azure-service/IC345880.png "Upgrade role")</span></span>  

<span data-ttu-id="d43fc-204">De Azure-Infrastructuurcontroller tijdens een automatische update periodiek de status van de cloudservice om te bepalen wanneer dit veilig Doorloop de volgende UD geëvalueerd.</span><span class="sxs-lookup"><span data-stu-id="d43fc-204">During an automatic update, the Azure Fabric Controller periodically evaluates the health of the cloud service to determine when it’s safe to walk the next UD.</span></span> <span data-ttu-id="d43fc-205">Deze health-evaluatie wordt uitgevoerd op basis van per rol en overweegt alleen exemplaren in de meest recente versie (dat wil zeggen de exemplaren van UDs die al zijn gelopen).</span><span class="sxs-lookup"><span data-stu-id="d43fc-205">This health evaluation is performed on a per-role basis and considers only instances in the latest version (i.e. instances from UDs that have already been walked).</span></span> <span data-ttu-id="d43fc-206">Controleert of dat een minimum aantal rolexemplaren, voor elke rol, hebben een goede definitieve status bereikt.</span><span class="sxs-lookup"><span data-stu-id="d43fc-206">It verifies that a minimum number of role instances, for each role, have achieved a satisfactory terminal state.</span></span>

### <a name="role-instance-start-timeout"></a><span data-ttu-id="d43fc-207">Time-out voor de Start van de rol exemplaar</span><span class="sxs-lookup"><span data-stu-id="d43fc-207">Role Instance Start Timeout</span></span>
<span data-ttu-id="d43fc-208">De Controller wacht 30 minuten voor elk rolexemplaar een gestart status bereikte.</span><span class="sxs-lookup"><span data-stu-id="d43fc-208">The Fabric Controller will wait 30 minutes for each role instance to reach a Started state.</span></span> <span data-ttu-id="d43fc-209">Als de time-outduur verstrijkt, blijft de Controller voor roulatie van het volgende rolexemplaar.</span><span class="sxs-lookup"><span data-stu-id="d43fc-209">If the timeout duration elapses, the Fabric Controller will continue walking to the next role instance.</span></span>

### <a name="impact-to-drive-data-during-cloud-service-upgrades"></a><span data-ttu-id="d43fc-210">Gevolgen voor de gegevens van de stations tijdens de Cloudservice upgrades</span><span class="sxs-lookup"><span data-stu-id="d43fc-210">Impact to drive data during Cloud Service upgrades</span></span>

<span data-ttu-id="d43fc-211">Bij het bijwerken van een service vanuit één exemplaar naar meerdere exemplaren wordt uw service worden verbroken tijdens de upgrade wordt uitgevoerd vanwege de manier waarop Azure upgrades-services.</span><span class="sxs-lookup"><span data-stu-id="d43fc-211">When upgrading a service from a single instance to multiple instances your service will be brought down while the upgrade is performed due to the way Azure upgrades services.</span></span> <span data-ttu-id="d43fc-212">Service level agreement aansprakelijke beschikbaarheid van de service is alleen van toepassing op services die zijn geïmplementeerd met meer dan één exemplaar.</span><span class="sxs-lookup"><span data-stu-id="d43fc-212">The service level agreement guaranteeing service availability only applies to services that are deployed with more than one instance.</span></span> <span data-ttu-id="d43fc-213">De volgende lijst wordt beschreven hoe de gegevens op elk station wordt beïnvloed door elke Azure-service-upgrade scenario:</span><span class="sxs-lookup"><span data-stu-id="d43fc-213">The following list describes how the data on each drive is affected by each Azure service upgrade scenario:</span></span>

|<span data-ttu-id="d43fc-214">Scenario</span><span class="sxs-lookup"><span data-stu-id="d43fc-214">Scenario</span></span>|<span data-ttu-id="d43fc-215">C-schijf</span><span class="sxs-lookup"><span data-stu-id="d43fc-215">C Drive</span></span>|<span data-ttu-id="d43fc-216">D-station</span><span class="sxs-lookup"><span data-stu-id="d43fc-216">D Drive</span></span>|<span data-ttu-id="d43fc-217">E-station</span><span class="sxs-lookup"><span data-stu-id="d43fc-217">E Drive</span></span>|
|--------|-------|-------|-------|
|<span data-ttu-id="d43fc-218">VM opnieuw wordt opgestart</span><span class="sxs-lookup"><span data-stu-id="d43fc-218">VM reboot</span></span>|<span data-ttu-id="d43fc-219">Behouden</span><span class="sxs-lookup"><span data-stu-id="d43fc-219">Preserved</span></span>|<span data-ttu-id="d43fc-220">Behouden</span><span class="sxs-lookup"><span data-stu-id="d43fc-220">Preserved</span></span>|<span data-ttu-id="d43fc-221">Behouden</span><span class="sxs-lookup"><span data-stu-id="d43fc-221">Preserved</span></span>|
|<span data-ttu-id="d43fc-222">Portal opnieuw opstarten</span><span class="sxs-lookup"><span data-stu-id="d43fc-222">Portal reboot</span></span>|<span data-ttu-id="d43fc-223">Behouden</span><span class="sxs-lookup"><span data-stu-id="d43fc-223">Preserved</span></span>|<span data-ttu-id="d43fc-224">Behouden</span><span class="sxs-lookup"><span data-stu-id="d43fc-224">Preserved</span></span>|<span data-ttu-id="d43fc-225">Vernietigd</span><span class="sxs-lookup"><span data-stu-id="d43fc-225">Destroyed</span></span>|
|<span data-ttu-id="d43fc-226">Portal terugzetten van de installatiekopie</span><span class="sxs-lookup"><span data-stu-id="d43fc-226">Portal reimage</span></span>|<span data-ttu-id="d43fc-227">Behouden</span><span class="sxs-lookup"><span data-stu-id="d43fc-227">Preserved</span></span>|<span data-ttu-id="d43fc-228">Vernietigd</span><span class="sxs-lookup"><span data-stu-id="d43fc-228">Destroyed</span></span>|<span data-ttu-id="d43fc-229">Vernietigd</span><span class="sxs-lookup"><span data-stu-id="d43fc-229">Destroyed</span></span>|
|<span data-ttu-id="d43fc-230">In-Place Upgrade</span><span class="sxs-lookup"><span data-stu-id="d43fc-230">In-Place Upgrade</span></span>|<span data-ttu-id="d43fc-231">Behouden</span><span class="sxs-lookup"><span data-stu-id="d43fc-231">Preserved</span></span>|<span data-ttu-id="d43fc-232">Behouden</span><span class="sxs-lookup"><span data-stu-id="d43fc-232">Preserved</span></span>|<span data-ttu-id="d43fc-233">Vernietigd</span><span class="sxs-lookup"><span data-stu-id="d43fc-233">Destroyed</span></span>|
|<span data-ttu-id="d43fc-234">Migratie van knooppunt</span><span class="sxs-lookup"><span data-stu-id="d43fc-234">Node migration</span></span>|<span data-ttu-id="d43fc-235">Vernietigd</span><span class="sxs-lookup"><span data-stu-id="d43fc-235">Destroyed</span></span>|<span data-ttu-id="d43fc-236">Vernietigd</span><span class="sxs-lookup"><span data-stu-id="d43fc-236">Destroyed</span></span>|<span data-ttu-id="d43fc-237">Vernietigd</span><span class="sxs-lookup"><span data-stu-id="d43fc-237">Destroyed</span></span>|

<span data-ttu-id="d43fc-238">Houd er rekening mee dat in de bovenstaande lijst de station E: het basisstation van de rol vertegenwoordigt, en niet vastgelegd worden moet.</span><span class="sxs-lookup"><span data-stu-id="d43fc-238">Note that, in the above list, the E: drive represents the role’s root drive, and should not be hard-coded.</span></span> <span data-ttu-id="d43fc-239">Gebruik in plaats daarvan de **% RoleRoot %** omgevingsvariabele vertegenwoordigt het station.</span><span class="sxs-lookup"><span data-stu-id="d43fc-239">Instead, use the **%RoleRoot%** environment variable to represent the drive.</span></span>

<span data-ttu-id="d43fc-240">Als u wilt de downtime minimaliseren bij een upgrade van een single instance-service, een nieuwe meerdere exemplaren service implementeren in de staging-server en geen VIP's wisselen.</span><span class="sxs-lookup"><span data-stu-id="d43fc-240">To minimize the downtime when upgrading a single-instance service, deploy a new multi-instance service to the staging server and perform a VIP swap.</span></span>

<a name="RollbackofanUpdate"></a>

## <a name="rollback-of-an-update"></a><span data-ttu-id="d43fc-241">Terugdraaien van een update</span><span class="sxs-lookup"><span data-stu-id="d43fc-241">Rollback of an update</span></span>
<span data-ttu-id="d43fc-242">Azure biedt flexibiliteit voor het beheren van services tijdens het bijwerken doordat u kunt aanvullende bewerkingen op een service starten na de initiële update-aanvraag wordt geaccepteerd door de Azure-Infrastructuurcontroller.</span><span class="sxs-lookup"><span data-stu-id="d43fc-242">Azure provides flexibility in managing services during an update by letting you initiate additional operations on a service, after the initial update request is accepted by the Azure Fabric Controller.</span></span> <span data-ttu-id="d43fc-243">Terugdraaien kan alleen worden uitgevoerd wanneer een update (configuratie wijzigen) of upgrade wordt het **Bezig** status op de implementatie.</span><span class="sxs-lookup"><span data-stu-id="d43fc-243">A rollback can only be performed when an update (configuration change) or upgrade is in the **in progress** state on the deployment.</span></span> <span data-ttu-id="d43fc-244">Een update of upgrade wordt beschouwd als wordt uitgevoerd, zolang er is ten minste één exemplaar van de service die nog niet zijn bijgewerkt naar de nieuwe versie.</span><span class="sxs-lookup"><span data-stu-id="d43fc-244">An update or upgrade is considered to be in-progress as long as there is at least one instance of the service which has not yet been updated to the new version.</span></span> <span data-ttu-id="d43fc-245">Als u wilt testen of een terugdraaien is toegestaan, Controleer de waarde van de vlag RollbackAllowed geretourneerd door [ophalen implementatie](https://msdn.microsoft.com/library/azure/ee460804.aspx) en [Cloud Service-eigenschappen ophalen](https://msdn.microsoft.com/library/azure/ee460806.aspx) bewerkingen, is ingesteld op true.</span><span class="sxs-lookup"><span data-stu-id="d43fc-245">To test whether a rollback is allowed, check the value of the RollbackAllowed flag, returned by [Get Deployment](https://msdn.microsoft.com/library/azure/ee460804.aspx) and [Get Cloud Service Properties](https://msdn.microsoft.com/library/azure/ee460806.aspx) operations, is set to true.</span></span>

> [!NOTE]
> <span data-ttu-id="d43fc-246">Het alleen zinvol om aan te roepen terugdraaien op een **in-place** bijwerken of bijwerken omdat het VIP wisselen upgrades hebben betrekking op één volledige actief exemplaar van uw service met een andere vervangen.</span><span class="sxs-lookup"><span data-stu-id="d43fc-246">It only makes sense to call Rollback on an **in-place** update or upgrade because VIP swap upgrades involve replacing one entire running instance of your service with another.</span></span>
>
>

<span data-ttu-id="d43fc-247">Terugdraaien van een update wordt uitgevoerd, heeft de volgende gevolgen voor de implementatie:</span><span class="sxs-lookup"><span data-stu-id="d43fc-247">Rollback of an in-progress update has the following effects on the deployment:</span></span>

* <span data-ttu-id="d43fc-248">Alle rolinstanties die was nog niet zijn bijgewerkt of upgrade naar de nieuwe versie worden niet bijgewerkt of bijgewerkt, omdat de instanties van de doelversie van de service al wordt uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="d43fc-248">Any role instances which had not yet been updated or upgraded to the new version are not updated or upgraded, because those instances are already running the target version of the service.</span></span>
* <span data-ttu-id="d43fc-249">Alle rolinstanties die u al had zijn bijgewerkt of bijgewerkt naar de nieuwe versie van het servicepakket (\*.cspkg) bestand of de serviceconfiguratie (\*.cscfg)-bestand (of beide bestanden) de vóór de upgrade versie van deze bestanden zijn hersteld.</span><span class="sxs-lookup"><span data-stu-id="d43fc-249">Any role instances which had already been updated or upgraded to the new version of the service package (\*.cspkg) file or the service configuration (\*.cscfg) file (or both files) are reverted to the pre-upgrade version of these files.</span></span>

<span data-ttu-id="d43fc-250">Dit is functioneel bepaald door de volgende functies:</span><span class="sxs-lookup"><span data-stu-id="d43fc-250">This functionally is provided by the following features:</span></span>

* <span data-ttu-id="d43fc-251">De [terugdraaien bijwerken of bijwerken](https://msdn.microsoft.com/library/azure/hh403977.aspx) bewerking die kan worden aangeroepen voor een configuratie-update (geactiveerd door het aanroepen van [implementatie-configuratie wijzigen](https://msdn.microsoft.com/library/azure/ee460809.aspx)) of een upgrade (geactiveerd door het aanroepen van [ Upgrade-implementatie](https://msdn.microsoft.com/library/azure/ee460793.aspx)), zolang er is ten minste één exemplaar in de service die nog niet zijn bijgewerkt naar de nieuwe versie.</span><span class="sxs-lookup"><span data-stu-id="d43fc-251">The [Rollback Update Or Upgrade](https://msdn.microsoft.com/library/azure/hh403977.aspx) operation, which can be called on a configuration update (triggered by calling [Change Deployment Configuration](https://msdn.microsoft.com/library/azure/ee460809.aspx)) or an upgrade (triggered by calling [Upgrade Deployment](https://msdn.microsoft.com/library/azure/ee460793.aspx)) as long as there is at least one instance in the service which has not yet been updated to the new version.</span></span>
* <span data-ttu-id="d43fc-252">Het element vergrendeld en het element RollbackAllowed worden geretourneerd als onderdeel van de hoofdtekst van de reactie van de [ophalen implementatie](https://msdn.microsoft.com/library/azure/ee460804.aspx) en [Cloud Service-eigenschappen ophalen](https://msdn.microsoft.com/library/azure/ee460806.aspx) bewerkingen:</span><span class="sxs-lookup"><span data-stu-id="d43fc-252">The Locked element and the RollbackAllowed element, which are returned as part of the response body of the [Get Deployment](https://msdn.microsoft.com/library/azure/ee460804.aspx) and [Get Cloud Service Properties](https://msdn.microsoft.com/library/azure/ee460806.aspx) operations:</span></span>

  1. <span data-ttu-id="d43fc-253">Het element vergrendeld, kunt u detecteren wanneer een mutating bewerking kan worden aangeroepen voor een bepaalde implementatie.</span><span class="sxs-lookup"><span data-stu-id="d43fc-253">The Locked element allows you to detect when a mutating operation can be invoked on a given deployment.</span></span>
  2. <span data-ttu-id="d43fc-254">Het element RollbackAllowed kunt u detecteren wanneer de [terugdraaien van de Update of Upgrade](https://msdn.microsoft.com/library/azure/hh403977.aspx) bewerking kan worden aangeroepen voor een bepaalde implementatie.</span><span class="sxs-lookup"><span data-stu-id="d43fc-254">The RollbackAllowed element allows you to detect when the [Rollback Update Or Upgrade](https://msdn.microsoft.com/library/azure/hh403977.aspx) operation can be called on a given deployment.</span></span>

  <span data-ttu-id="d43fc-255">U hebt om uit te voeren een terugdraaiactie heeft plaatsgevonden, niet zowel de vergrendeld als de RollbackAllowed-elementen.</span><span class="sxs-lookup"><span data-stu-id="d43fc-255">In order to perform a rollback, you do not have to check both the Locked and the RollbackAllowed elements.</span></span> <span data-ttu-id="d43fc-256">Deze achtervoegsels om te bevestigen dat RollbackAllowed is ingesteld op true.</span><span class="sxs-lookup"><span data-stu-id="d43fc-256">It suffices to confirm that RollbackAllowed is set to true.</span></span> <span data-ttu-id="d43fc-257">Deze elementen zijn alleen geretourneerd als deze methoden worden aangeroepen met behulp van de aanvraagheader ingesteld op ' x-ms-version: 2011-10-01 ' of een latere versie.</span><span class="sxs-lookup"><span data-stu-id="d43fc-257">These elements are only returned if these methods are invoked by using the request header set to “x-ms-version: 2011-10-01” or a later version.</span></span> <span data-ttu-id="d43fc-258">Zie voor meer informatie over kopteksten versioning [Management Serviceversiebeheer](https://msdn.microsoft.com/library/azure/gg592580.aspx).</span><span class="sxs-lookup"><span data-stu-id="d43fc-258">For more information about versioning headers, see [Service Management Versioning](https://msdn.microsoft.com/library/azure/gg592580.aspx).</span></span>

<span data-ttu-id="d43fc-259">Zijn er situaties waarin een terugdraaien van een update of upgrade wordt niet ondersteund, dit als volgt zijn:</span><span class="sxs-lookup"><span data-stu-id="d43fc-259">There are some situations where a rollback of an update or upgrade is not supported, these are as follows:</span></span>

* <span data-ttu-id="d43fc-260">Verlaging van de lokale bronnen - als de update de lokale bronnen voor een functie van de Azure-platform verhoogt kunnen niet worden teruggedraaid.</span><span class="sxs-lookup"><span data-stu-id="d43fc-260">Reduction in local resources - If the update increases the local resources for a role the Azure platform does not allow rolling back.</span></span>
* <span data-ttu-id="d43fc-261">Quotumbeperkingen - hebben als de update is een schaal omlaag bewerking die u mogelijk niet meer voldoende quotum aangepaste compute om het van de terugdraaibewerking te voltooien.</span><span class="sxs-lookup"><span data-stu-id="d43fc-261">Quota limitations - If the update was a scale down operation you may no longer have sufficient compute quota to complete the rollback operation.</span></span> <span data-ttu-id="d43fc-262">Elk Azure-abonnement heeft een quotum gekoppeld waarmee het maximum aantal kernen dat kan worden gebruikt door alle gehoste services die deel uitmaken van dat abonnement.</span><span class="sxs-lookup"><span data-stu-id="d43fc-262">Each Azure subscription has a quota associated with it that specifies the maximum number of cores which can be consumed by all hosted services that belong to that subscription.</span></span> <span data-ttu-id="d43fc-263">Als u dat terugdraaien van een bepaalde update uw abonnement via quotum vervolgens die plaatst wordt een rollback niet ingeschakeld.</span><span class="sxs-lookup"><span data-stu-id="d43fc-263">If performing a rollback of a given update would put your subscription over quota then that a rollback will not be enabled.</span></span>
* <span data-ttu-id="d43fc-264">Race condition - als de eerste update is voltooid, terugdraaien is niet mogelijk.</span><span class="sxs-lookup"><span data-stu-id="d43fc-264">Race condition - If the initial update has completed, a rollback is not possible.</span></span>

<span data-ttu-id="d43fc-265">Een voorbeeld van wanneer het terugdraaien van een update mogelijk nuttig is wanneer u gebruikt de [Upgrade-implementatie](https://msdn.microsoft.com/library/azure/ee460793.aspx) bewerking in de handmatige modus voor het beheren van de snelheid waarmee een belangrijke in-place upgrade uw Azure service gehoste is geïmplementeerd.</span><span class="sxs-lookup"><span data-stu-id="d43fc-265">An example of when the rollback of an update might be useful is if you are using the [Upgrade Deployment](https://msdn.microsoft.com/library/azure/ee460793.aspx) operation in manual mode to control the rate at which a major in-place upgrade to your Azure hosted service is rolled out.</span></span>

<span data-ttu-id="d43fc-266">Tijdens de implementatie van de upgrade u aanroepen [Upgrade-implementatie](https://msdn.microsoft.com/library/azure/ee460793.aspx) in de handmatige modus en doorloop upgradedomeinen beginnen.</span><span class="sxs-lookup"><span data-stu-id="d43fc-266">During the rollout of the upgrade you call [Upgrade Deployment](https://msdn.microsoft.com/library/azure/ee460793.aspx) in manual mode and begin to walk upgrade domains.</span></span> <span data-ttu-id="d43fc-267">Als op een bepaald moment tijdens het controleren van de upgrade moet u rekening mee houden sommige rolinstanties in de eerste upgradedomeinen die u hebt niet meer reageren, kunt u bellen de [terugdraaien van de Update of Upgrade](https://msdn.microsoft.com/library/azure/hh403977.aspx) bewerking op de implementatie blijft nog op de exemplaren die was nog niet zijn bijgewerkt en de rollback-serverexemplaren die is bijgewerkt naar de vorige servicepakket en configuratie.</span><span class="sxs-lookup"><span data-stu-id="d43fc-267">If at some point, as you monitor the upgrade, you note some role instances in the first upgrade domains that you examine have become unresponsive, you can call the [Rollback Update Or Upgrade](https://msdn.microsoft.com/library/azure/hh403977.aspx) operation on the deployment, which will leave untouched the instances which had not yet been upgraded and rollback instances which had been upgraded to the previous service package and configuration.</span></span>

<a name="multiplemutatingoperations"></a>

## <a name="initiating-multiple-mutating-operations-on-an-ongoing-deployment"></a><span data-ttu-id="d43fc-268">Meerdere mutating bewerkingen op een actieve implementatie initiëren</span><span class="sxs-lookup"><span data-stu-id="d43fc-268">Initiating multiple mutating operations on an ongoing deployment</span></span>
<span data-ttu-id="d43fc-269">In sommige gevallen wilt u mogelijk meerdere gelijktijdige mutating bewerkingen voor de implementatie van een doorlopende starten.</span><span class="sxs-lookup"><span data-stu-id="d43fc-269">In some cases you may want to initiate multiple simultaneous mutating operations on an ongoing deployment.</span></span> <span data-ttu-id="d43fc-270">Bijvoorbeeld u een service-update kunt uitvoeren en, terwijl deze update is teruggedraaid uit over uw service, die u wilt bijvoorbeeld een wijziging aanbrengen om te draaien terug in de update, een andere update toepassen of zelfs het verwijderen van de implementatie.</span><span class="sxs-lookup"><span data-stu-id="d43fc-270">For example, you may perform a service update and, while that update is being rolled out across your service, you want to make some change, e.g. to roll the update back, apply a different update, or even delete the deployment.</span></span> <span data-ttu-id="d43fc-271">Een aanvraag waarin dit wordt mogelijk nodig is als een service-upgrade bevat buggy code die ervoor zorgt dat een bijgewerkte rolinstantie herhaaldelijk vastloopt.</span><span class="sxs-lookup"><span data-stu-id="d43fc-271">A case in which this might be necessary is if a service upgrade contains buggy code which causes an upgraded role instance to repeatedly crash.</span></span> <span data-ttu-id="d43fc-272">In dit geval is de Azure-Infrastructuurcontroller niet mogelijk voortgang bij de toepassing die niet upgraden omdat een onvoldoende aantal exemplaren in de bijgewerkte domein zijn in orde.</span><span class="sxs-lookup"><span data-stu-id="d43fc-272">In this case, the Azure Fabric Controller will not be able to make progress in applying that upgrade because an insufficient number of instances in the upgraded domain are healthy.</span></span> <span data-ttu-id="d43fc-273">Deze status wordt aangeduid als een *vastgelopen implementatie*.</span><span class="sxs-lookup"><span data-stu-id="d43fc-273">This state is referred to as a *stuck deployment*.</span></span> <span data-ttu-id="d43fc-274">U kunt de implementatie door het terugdraaien van de update of een nieuwe update toepassen via de bovenkant van het mislukken van de Registreer een.</span><span class="sxs-lookup"><span data-stu-id="d43fc-274">You can unstick the deployment by rolling back the update or applying a fresh update over top of the failing one.</span></span>

<span data-ttu-id="d43fc-275">Nadat de eerste aanvraag bijwerken of upgrade van de service is ontvangen door de Azure-Infrastructuurcontroller, kunt u verdere mutating bewerkingen starten.</span><span class="sxs-lookup"><span data-stu-id="d43fc-275">Once the initial request to update or upgrade the service has been received by the Azure Fabric Controller, you can start subsequent mutating operations.</span></span> <span data-ttu-id="d43fc-276">U hebt dat wil zeggen, niet te wachten op de eerste bewerking is voltooid voordat u kunt een andere mutating bewerking.</span><span class="sxs-lookup"><span data-stu-id="d43fc-276">That is, you do not have to wait for the initial operation to complete before you can start another mutating operation.</span></span>

<span data-ttu-id="d43fc-277">Een tweede update-bewerking starten terwijl de eerste update uitgevoerd wordt wordt vergelijkbaar met de rollback-bewerking uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="d43fc-277">Initiating a second update operation while the first update is ongoing will perform similar to the rollback operation.</span></span> <span data-ttu-id="d43fc-278">Als de tweede update in de automatische modus is wordt het eerste upgradedomein bijgewerkt onmiddellijk mogelijk leiden tot exemplaren van meerdere upgradedomeinen wordt offline op een bepaald punt in tijd.</span><span class="sxs-lookup"><span data-stu-id="d43fc-278">If the second update is in automatic mode, the first upgrade domain will be upgraded immediately, possibly leading to instances from multiple upgrade domains being offline at the same point in time.</span></span>

<span data-ttu-id="d43fc-279">De mutating bewerkingen zijn als volgt: [implementatie-configuratie wijzigen](https://msdn.microsoft.com/library/azure/ee460809.aspx), [Upgrade-implementatie](https://msdn.microsoft.com/library/azure/ee460793.aspx), [Update Implementatiestatus](https://msdn.microsoft.com/library/azure/ee460808.aspx), [implementatie verwijderen ](https://msdn.microsoft.com/library/azure/ee460815.aspx), en [terugdraaien van de Update of Upgrade](https://msdn.microsoft.com/library/azure/hh403977.aspx).</span><span class="sxs-lookup"><span data-stu-id="d43fc-279">The mutating operations are as follows: [Change Deployment Configuration](https://msdn.microsoft.com/library/azure/ee460809.aspx), [Upgrade Deployment](https://msdn.microsoft.com/library/azure/ee460793.aspx), [Update Deployment Status](https://msdn.microsoft.com/library/azure/ee460808.aspx), [Delete Deployment](https://msdn.microsoft.com/library/azure/ee460815.aspx), and [Rollback Update Or Upgrade](https://msdn.microsoft.com/library/azure/hh403977.aspx).</span></span>

<span data-ttu-id="d43fc-280">Twee bewerkingen [ophalen implementatie](https://msdn.microsoft.com/library/azure/ee460804.aspx) en [Cloud Service-eigenschappen ophalen](https://msdn.microsoft.com/library/azure/ee460806.aspx), de vergrendeld vlag waarmee kan worden onderzocht om te bepalen of een mutating bewerking kan worden aangeroepen voor een bepaalde implementatie te retourneren.</span><span class="sxs-lookup"><span data-stu-id="d43fc-280">Two operations, [Get Deployment](https://msdn.microsoft.com/library/azure/ee460804.aspx) and [Get Cloud Service Properties](https://msdn.microsoft.com/library/azure/ee460806.aspx), return the Locked flag which can be examined to determine whether a mutating operation can be invoked on a given deployment.</span></span>

<span data-ttu-id="d43fc-281">Als u wilt de versie van deze methoden die als resultaat van de vlag vergrendeld aanroepen, moet u aanvraagheader instellen op ' x-ms-version: 2011-10-01 ' of een later.</span><span class="sxs-lookup"><span data-stu-id="d43fc-281">In order to call the version of these methods which returns the Locked flag, you must set request header to “x-ms-version: 2011-10-01” or a later.</span></span> <span data-ttu-id="d43fc-282">Zie voor meer informatie over kopteksten versioning [Management Serviceversiebeheer](https://msdn.microsoft.com/library/azure/gg592580.aspx).</span><span class="sxs-lookup"><span data-stu-id="d43fc-282">For more information about versioning headers, see [Service Management Versioning](https://msdn.microsoft.com/library/azure/gg592580.aspx).</span></span>

<a name="distributiondfroles"></a>

## <a name="distribution-of-roles-across-upgrade-domains"></a><span data-ttu-id="d43fc-283">Distributie van functies tussen domeinen upgraden</span><span class="sxs-lookup"><span data-stu-id="d43fc-283">Distribution of roles across upgrade domains</span></span>
<span data-ttu-id="d43fc-284">Azure worden exemplaren van een rol gelijkmatig verdeeld over een bepaald aantal upgradedomeinen die kan worden geconfigureerd als onderdeel van het servicedefinitiebestand (.csdef).</span><span class="sxs-lookup"><span data-stu-id="d43fc-284">Azure distributes instances of a role evenly across a set number of upgrade domains, which can be configured as part of the service definition (.csdef) file.</span></span> <span data-ttu-id="d43fc-285">Het maximum aantal upgradedomeinen is 20 en de standaardwaarde is 5.</span><span class="sxs-lookup"><span data-stu-id="d43fc-285">The max number of upgrade domains is 20 and the default is 5.</span></span> <span data-ttu-id="d43fc-286">Zie voor meer informatie over het wijzigen van het servicedefinitiebestand [Azure Service definitie Schema (.csdef-bestand)](cloud-services-model-and-package.md#csdef).</span><span class="sxs-lookup"><span data-stu-id="d43fc-286">For more information about how to modify the service definition file, see [Azure Service Definition Schema (.csdef File)](cloud-services-model-and-package.md#csdef).</span></span>

<span data-ttu-id="d43fc-287">Bijvoorbeeld, als uw rol tien exemplaren heeft, bevat elk upgradedomein standaard twee exemplaren.</span><span class="sxs-lookup"><span data-stu-id="d43fc-287">For example, if your role has ten instances, by default each upgrade domain contains two instances.</span></span> <span data-ttu-id="d43fc-288">Als uw rol 14 exemplaren heeft, bevat vier van de upgradedomeinen drie exemplaren en een vijfde domein bevat twee.</span><span class="sxs-lookup"><span data-stu-id="d43fc-288">If your role has 14 instances, then four of the upgrade domains contain three instances, and a fifth domain contains two.</span></span>

<span data-ttu-id="d43fc-289">Upgradedomeinen worden aangeduid met een op nul gebaseerde index: het eerste upgradedomein heeft een 0-ID en het tweede upgradedomein heeft een ID van 1, enzovoort.</span><span class="sxs-lookup"><span data-stu-id="d43fc-289">Upgrade domains are identified with a zero-based index: the first upgrade domain has an ID of 0, and the second upgrade domain has an ID of 1, and so on.</span></span>

<span data-ttu-id="d43fc-290">Het volgende diagram illustreert hoe een service dan bevat twee rollen worden gedistribueerd wanneer de service definieert twee upgradedomeinen.</span><span class="sxs-lookup"><span data-stu-id="d43fc-290">The following diagram illustrates how a service than contains two roles are distributed when the service defines two upgrade domains.</span></span> <span data-ttu-id="d43fc-291">De service wordt uitgevoerd acht exemplaren van de Webrol en negen exemplaren van de werkrol.</span><span class="sxs-lookup"><span data-stu-id="d43fc-291">The service is running eight instances of the web role and nine instances of the worker role.</span></span>

<span data-ttu-id="d43fc-292">![Distributie van Upgradedomeinen](media/cloud-services-update-azure-service/IC345533.png "distributie van Upgradedomeinen")</span><span class="sxs-lookup"><span data-stu-id="d43fc-292">![Distribution of Upgrade Domains](media/cloud-services-update-azure-service/IC345533.png "Distribution of Upgrade Domains")</span></span>

> [!NOTE]
> <span data-ttu-id="d43fc-293">Houd er rekening mee dat Azure bepaalt hoe exemplaren worden toegewezen via upgradedomeinen.</span><span class="sxs-lookup"><span data-stu-id="d43fc-293">Note that Azure controls how instances are allocated across upgrade domains.</span></span> <span data-ttu-id="d43fc-294">Het is niet mogelijk om op te geven welke exemplaren zijn toegewezen aan een domein.</span><span class="sxs-lookup"><span data-stu-id="d43fc-294">It's not possible to specify which instances are allocated to which domain.</span></span>
>
>

## <a name="next-steps"></a><span data-ttu-id="d43fc-295">Volgende stappen</span><span class="sxs-lookup"><span data-stu-id="d43fc-295">Next steps</span></span>
[<span data-ttu-id="d43fc-296">Cloud Services beheren</span><span class="sxs-lookup"><span data-stu-id="d43fc-296">How to Manage Cloud Services</span></span>](cloud-services-how-to-manage.md)  
[<span data-ttu-id="d43fc-297">Het bewaken van Cloud-Services</span><span class="sxs-lookup"><span data-stu-id="d43fc-297">How to Monitor Cloud Services</span></span>](cloud-services-how-to-monitor.md)  
[<span data-ttu-id="d43fc-298">Cloud Services configureren</span><span class="sxs-lookup"><span data-stu-id="d43fc-298">How to Configure Cloud Services</span></span>](cloud-services-how-to-configure.md)  
