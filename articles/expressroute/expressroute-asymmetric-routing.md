---
title: Asymmetrische routering | Microsoft Docs
description: In dit artikel komen problemen met asymmetrische routering aan de orde die een klant kan tegenkomen in een netwerk dat meerdere koppelingen naar een bestemming heeft.
documentationcenter: na
services: expressroute
author: osamazia
manager: carmonm
editor: 
ms.assetid: a754bff9-95c9-44b5-9796-377fc21e8322
ms.service: expressroute
ms.devlang: na
ms.topic: get-started-article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 10/10/2016
ms.author: osamam
ms.openlocfilehash: 8568c13d2834a0643e15ab1814a35c92123837d1
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 07/11/2017
---
# <a name="asymmetric-routing-with-multiple-network-paths"></a><span data-ttu-id="b35c3-103">Asymmetrische routering met meerdere netwerkpaden</span><span class="sxs-lookup"><span data-stu-id="b35c3-103">Asymmetric routing with multiple network paths</span></span>
<span data-ttu-id="b35c3-104">In dit artikel wordt uitgelegd hoe uitgaand en binnenkomend netwerkverkeer verschillende routes kan nemen wanneer er meerdere paden beschikbaar zijn tussen netwerkbron en -bestemming.</span><span class="sxs-lookup"><span data-stu-id="b35c3-104">This article explains how forward and return network traffic might take different routes when multiple paths are available between network source and destination.</span></span>

<span data-ttu-id="b35c3-105">Om asymmetrische routering te begrijpen, moet u twee concepten begrijpen.</span><span class="sxs-lookup"><span data-stu-id="b35c3-105">It's important to understand two concepts to understand asymmetric routing.</span></span> <span data-ttu-id="b35c3-106">Het ene is het effect van meerdere netwerkpaden.</span><span class="sxs-lookup"><span data-stu-id="b35c3-106">One is the effect of multiple network paths.</span></span> <span data-ttu-id="b35c3-107">Het andere is hoe apparaten, zoals een firewall, hun staat behouden (keep state).</span><span class="sxs-lookup"><span data-stu-id="b35c3-107">The other is how devices, like a firewall, keep state.</span></span> <span data-ttu-id="b35c3-108">Dit soort apparaten worden stateful apparaten genoemd.</span><span class="sxs-lookup"><span data-stu-id="b35c3-108">These types of devices are called stateful devices.</span></span> <span data-ttu-id="b35c3-109">Door een combinatie van deze twee factoren ontstaan scenario's waarin verkeer wordt verwijderd door een stateful apparaat, omdat het stateful apparaat niet heeft gedetecteerd dat verkeer afkomstig was van het apparaat zelf.</span><span class="sxs-lookup"><span data-stu-id="b35c3-109">A combination of these two factors creates scenarios in which network traffic is dropped by a stateful device because the stateful device didn't detect that traffic originated with the device itself.</span></span>

## <a name="multiple-network-paths"></a><span data-ttu-id="b35c3-110">Meerdere netwerkpaden</span><span class="sxs-lookup"><span data-stu-id="b35c3-110">Multiple network paths</span></span>
<span data-ttu-id="b35c3-111">Wanneer een bedrijfsnetwerk maar één koppeling met internet heeft via de internetprovider, loopt al het verkeer naar en van internet via hetzelfde pad.</span><span class="sxs-lookup"><span data-stu-id="b35c3-111">When an enterprise network has only one link to the Internet through their Internet service provider, all traffic to and from the Internet travels the same path.</span></span> <span data-ttu-id="b35c3-112">Bedrijven schaffen vaak meerdere aansluitingen aan, als redundante paden, ter verbetering van de uptime van het netwerk.</span><span class="sxs-lookup"><span data-stu-id="b35c3-112">Often, companies purchase multiple circuits, as redundant paths, to improve network uptime.</span></span> <span data-ttu-id="b35c3-113">In die gevallen is het mogelijk dat verkeer dat buiten het netwerk naar internet gaat via de ene koppeling gaat, en het retourverkeer via een andere koppeling komt.</span><span class="sxs-lookup"><span data-stu-id="b35c3-113">When this happens, it's possible that traffic that goes outside of the network, to the Internet, goes through one link, and the return traffic goes through a different link.</span></span> <span data-ttu-id="b35c3-114">Dit wordt doorgaans asymmetrische routering genoemd.</span><span class="sxs-lookup"><span data-stu-id="b35c3-114">This is commonly known as asymmetric routing.</span></span> <span data-ttu-id="b35c3-115">Bij asymmetrische routering neemt het terugkerende netwerkverkeer een andere weg dan de uitgaande stroom.</span><span class="sxs-lookup"><span data-stu-id="b35c3-115">In asymmetric routing, reverse network traffic takes a different path from the original flow.</span></span>

![Netwerk met meerdere paden](./media/expressroute-asymmetric-routing/AsymmetricRouting3.png)

<span data-ttu-id="b35c3-117">Hoewel dit zich voornamelijk voordoet op internet, is asymmetrische routering ook van toepassing op andere combinaties van meerdere paden.</span><span class="sxs-lookup"><span data-stu-id="b35c3-117">Although it primarily occurs on the Internet, asymmetric routing also applies to other combinations of multiple paths.</span></span> <span data-ttu-id="b35c3-118">Het is bijvoorbeeld ook van toepassing wanneer een internetpad en een persoonlijk pad dezelfde bestemming hebben, en wanneer meerdere persoonlijke paden eenzelfde bestemming hebben.</span><span class="sxs-lookup"><span data-stu-id="b35c3-118">It applies, for example, both to an Internet path and a private path that go to the same destination, and to multiple private paths that go to the same destination.</span></span>

<span data-ttu-id="b35c3-119">Elke router berekent onderweg van bron naar doel het beste pad om een bestemming te bereiken.</span><span class="sxs-lookup"><span data-stu-id="b35c3-119">Each router along the way, from source to destination, computes the best path to reach a destination.</span></span> <span data-ttu-id="b35c3-120">De manier waarop de router het optimale pad bepaalt, is gebaseerd op twee hoofdfactoren:</span><span class="sxs-lookup"><span data-stu-id="b35c3-120">The router's determination of best possible path is based on two main factors:</span></span>

* <span data-ttu-id="b35c3-121">Routering tussen externe netwerken is gebaseerd op een routeringsprotocol, het Border Gateway Protocol (BGP).</span><span class="sxs-lookup"><span data-stu-id="b35c3-121">Routing between external networks is based on a routing protocol, Border Gateway Protocol (BGP).</span></span> <span data-ttu-id="b35c3-122">BGP kijkt naar aankondigingen van neighbors en voert hier een aantal stappen op uit om het beste pad naar de bestemming te bepalen.</span><span class="sxs-lookup"><span data-stu-id="b35c3-122">BGP takes advertisements from neighbors and runs them through a series of steps to determine the best path to the intended destination.</span></span> <span data-ttu-id="b35c3-123">Het beste pad wordt opgeslagen in de routeringstabel.</span><span class="sxs-lookup"><span data-stu-id="b35c3-123">It stores the best path in its routing table.</span></span>
* <span data-ttu-id="b35c3-124">De routeringspaden worden beïnvloed door de lengte van een subnetmasker dat aan een route is gekoppeld.</span><span class="sxs-lookup"><span data-stu-id="b35c3-124">The length of a subnet mask associated with a route influences routing paths.</span></span> <span data-ttu-id="b35c3-125">Als een router meerdere aankondigingen voor hetzelfde IP-adres maar met verschillende subnetmaskers ontvangt, krijgt de aankondiging met het langere subnetmasker de voorkeur, omdat deze als een meer specifieke route wordt beschouwd.</span><span class="sxs-lookup"><span data-stu-id="b35c3-125">If a router receives multiple advertisements for the same IP address but with different subnet masks, the router prefers the advertisement with a longer subnet mask because it's considered a more specific route.</span></span>

## <a name="stateful-devices"></a><span data-ttu-id="b35c3-126">Stateful apparaten</span><span class="sxs-lookup"><span data-stu-id="b35c3-126">Stateful devices</span></span>
<span data-ttu-id="b35c3-127">Routers kijken naar de IP-header van een pakket voor routeringsdoeleinden.</span><span class="sxs-lookup"><span data-stu-id="b35c3-127">Routers look at the IP header of a packet for routing purposes.</span></span> <span data-ttu-id="b35c3-128">Er zijn echter apparaten die nog dieper in het pakket kijken.</span><span class="sxs-lookup"><span data-stu-id="b35c3-128">Some devices look even deeper inside the packet.</span></span> <span data-ttu-id="b35c3-129">Normaal gesproken kijken deze apparaten naar Layer4- (Transmission Control Protocol of TCP; of User Datagram Protocol of UDP), of zelfs Layer7-headers (toepassingslaag).</span><span class="sxs-lookup"><span data-stu-id="b35c3-129">Typically, these devices look at Layer4 (Transmission Control Protocol, or TCP; or User Datagram Protocol, or UDP), or even Layer7 (Application Layer) headers.</span></span> <span data-ttu-id="b35c3-130">Dergelijke apparaten zijn beveiligingsapparaten of apparaten die de bandbreedte optimaliseren.</span><span class="sxs-lookup"><span data-stu-id="b35c3-130">These kinds of devices are either security devices or bandwidth-optimization devices.</span></span> 

<span data-ttu-id="b35c3-131">Een firewall is een algemeen voorbeeld van een stateful apparaat.</span><span class="sxs-lookup"><span data-stu-id="b35c3-131">A firewall is a common example of a stateful device.</span></span> <span data-ttu-id="b35c3-132">De firewall bepaalt op basis van verschillende velden, zoals protocol, TCP/UDP-poort en URL-headers, of een pakket de interfaces mag passeren.</span><span class="sxs-lookup"><span data-stu-id="b35c3-132">A firewall allows or denies a packet to pass through its interfaces based on various fields such as protocol, TCP/UDP port, and URL headers.</span></span> <span data-ttu-id="b35c3-133">Dit niveau van pakketinspectie betekent een grote verwerkingsbelasting voor het apparaat.</span><span class="sxs-lookup"><span data-stu-id="b35c3-133">This level of packet inspection puts a heavy processing load on the device.</span></span> <span data-ttu-id="b35c3-134">Om de prestaties te verbeteren, inspecteert de firewall het eerste pakket van een stroom.</span><span class="sxs-lookup"><span data-stu-id="b35c3-134">To improve performance, the firewall inspects the first packet of a flow.</span></span> <span data-ttu-id="b35c3-135">Als het pakket mag doorgaan, worden de stroomgegevens in de statustabel van de firewall bewaard.</span><span class="sxs-lookup"><span data-stu-id="b35c3-135">If it allows the packet to proceed, it keeps the flow information in its state table.</span></span> <span data-ttu-id="b35c3-136">Alle volgende pakketten met betrekking tot deze stroom zijn toegestaan op basis van de eerste beslissing.</span><span class="sxs-lookup"><span data-stu-id="b35c3-136">All subsequent packets related to this flow are allowed based on the initial determination.</span></span> <span data-ttu-id="b35c3-137">Een pakket dat deel uitmaakt van een bestaande stroom, kan aankomen bij de firewall.</span><span class="sxs-lookup"><span data-stu-id="b35c3-137">A packet that is part of an existing flow might arrive at the firewall.</span></span> <span data-ttu-id="b35c3-138">Als de firewall geen eerdere statusinformatie over het pakket heeft, wordt het pakket door de firewall geweigerd.</span><span class="sxs-lookup"><span data-stu-id="b35c3-138">If the firewall has no prior state information about it, the firewall drops the packet.</span></span>

## <a name="asymmetric-routing-with-expressroute"></a><span data-ttu-id="b35c3-139">Asymmetrische routering met ExpressRoute</span><span class="sxs-lookup"><span data-stu-id="b35c3-139">Asymmetric routing with ExpressRoute</span></span>
<span data-ttu-id="b35c3-140">Wanneer u via ExpressRoute verbinding maakt met Microsoft, verandert het netwerk als volgt:</span><span class="sxs-lookup"><span data-stu-id="b35c3-140">When you connect to Microsoft through Azure ExpressRoute, your network changes like this:</span></span>

* <span data-ttu-id="b35c3-141">U hebt meerdere koppelingen naar Microsoft.</span><span class="sxs-lookup"><span data-stu-id="b35c3-141">You have multiple links to Microsoft.</span></span> <span data-ttu-id="b35c3-142">De ene koppeling is uw bestaande internetverbinding en de andere gaat via ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="b35c3-142">One link is your existing Internet connection, and the other is via ExpressRoute.</span></span> <span data-ttu-id="b35c3-143">Bepaald verkeer naar Microsoft kan via internet gaan maar kan terugkeren via ExpressRoute of andersom.</span><span class="sxs-lookup"><span data-stu-id="b35c3-143">Some traffic to Microsoft might go through the Internet but come back via ExpressRoute, or vice versa.</span></span>
* <span data-ttu-id="b35c3-144">U ontvangt specifiekere IP-adressen via ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="b35c3-144">You receive more specific IP addresses via ExpressRoute.</span></span> <span data-ttu-id="b35c3-145">Voor verkeer van uw netwerk naar Microsoft voor services die worden aangeboden via ExpressRoute, geven routers dus altijd de voorkeur aan ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="b35c3-145">So, for traffic from your network to Microsoft for services offered via ExpressRoute, routers always prefer ExpressRoute.</span></span>

<span data-ttu-id="b35c3-146">Om te begrijpen welk effect deze twee wijzigingen op een netwerk hebben, gaan we enkele scenario's bekijken.</span><span class="sxs-lookup"><span data-stu-id="b35c3-146">To understand the effect these two changes have on a network, let’s consider some scenarios.</span></span> <span data-ttu-id="b35c3-147">Stel, u hebt maar één aansluiting met internet en alle Microsoft-services worden via internet gebruikt.</span><span class="sxs-lookup"><span data-stu-id="b35c3-147">As an example, you have only one circuit to the Internet and you consume all Microsoft services via the Internet.</span></span> <span data-ttu-id="b35c3-148">Het verkeer van uw netwerk naar Microsoft en terug passeert via dezelfde internetkoppeling en passeert de firewall.</span><span class="sxs-lookup"><span data-stu-id="b35c3-148">The traffic from your network to Microsoft and back traverses the same Internet link and passes through the firewall.</span></span> <span data-ttu-id="b35c3-149">De firewall registreert de stroom wanneer het eerste pakket binnenkomt en retourpakketten worden toegestaan, aangezien de stroom in de statustabel bestaat.</span><span class="sxs-lookup"><span data-stu-id="b35c3-149">The firewall records the flow as it sees the first packet and return packets are allowed because the flow exists in the state table.</span></span>

![Asymmetrische routering met ExpressRoute](./media/expressroute-asymmetric-routing/AsymmetricRouting1.png)

<span data-ttu-id="b35c3-151">Vervolgens schakelt u ExpressRoute in, en gebruikt u services die door Microsoft worden aangeboden nu via ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="b35c3-151">Then, you turn on ExpressRoute and consume services offered by Microsoft over ExpressRoute.</span></span> <span data-ttu-id="b35c3-152">Alle andere services van Microsoft worden via internet gebruikt.</span><span class="sxs-lookup"><span data-stu-id="b35c3-152">All other services from Microsoft are consumed over the Internet.</span></span> <span data-ttu-id="b35c3-153">U implementeert een afzonderlijke firewall aan de rand die is verbonden met ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="b35c3-153">You deploy a separate firewall at your edge that is connected to ExpressRoute.</span></span> <span data-ttu-id="b35c3-154">Microsoft kondigt voor specifieke services specifiekere voorvoegsels naar het netwerk via ExpressRoute aan.</span><span class="sxs-lookup"><span data-stu-id="b35c3-154">Microsoft advertises more specific prefixes to your network over ExpressRoute for specific services.</span></span> <span data-ttu-id="b35c3-155">De routeringsinfrastructuur kiest ExpressRoute als het voorkeurspad voor die voorvoegsels.</span><span class="sxs-lookup"><span data-stu-id="b35c3-155">Your routing infrastructure chooses ExpressRoute as the preferred path for those prefixes.</span></span> <span data-ttu-id="b35c3-156">Als u uw openbare IP-adressen niet bij Microsoft aankondigt via ExpressRoute, zal Microsoft via internet met uw openbare IP-adressen communiceren.</span><span class="sxs-lookup"><span data-stu-id="b35c3-156">If you are not advertising your public IP addresses to Microsoft over ExpressRoute, Microsoft communicates with your public IP addresses via the Internet.</span></span> <span data-ttu-id="b35c3-157">Voorwaarts verkeer van uw netwerk naar Microsoft gebruikt dus ExpressRoute, en terugkerend verkeer van Microsoft maakt gebruik van internet.</span><span class="sxs-lookup"><span data-stu-id="b35c3-157">Forward traffic from your network to Microsoft uses ExpressRoute, and reverse traffic from Microsoft uses the Internet.</span></span> <span data-ttu-id="b35c3-158">Wanneer de firewall aan de rand een antwoordpakket ziet voor een stroom die niet wordt gevonden in de statustabel, wordt het retourverkeer verwijderd.</span><span class="sxs-lookup"><span data-stu-id="b35c3-158">When the firewall at the edge sees a response packet for a flow that it does not find in the state table, it drops the return traffic.</span></span>

<span data-ttu-id="b35c3-159">Als u ervoor kiest om dezelfde NAT-pool (Network Address Translation) te gebruiken voor ExpressRoute en voor internet, treden er vergelijkbare problemen op met de clients in uw netwerk met persoonlijke IP-adressen.</span><span class="sxs-lookup"><span data-stu-id="b35c3-159">If you choose to use the same network address translation (NAT) pool for ExpressRoute and for the Internet, you'll see similar issues with the clients in your network on private IP addresses.</span></span> <span data-ttu-id="b35c3-160">Aanvragen voor services zoals Windows Update verlopen via internet omdat IP-adressen voor deze services niet worden verzonden via ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="b35c3-160">Requests for services like Windows Update go via the Internet because IP addresses for these services are not advertised via ExpressRoute.</span></span> <span data-ttu-id="b35c3-161">Het retourverkeer keert echter terug via ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="b35c3-161">However, the return traffic comes back via ExpressRoute.</span></span> <span data-ttu-id="b35c3-162">Als Microsoft een IP-adres met hetzelfde subnetmasker van internet en ExpressRoute ontvangt, verkiest het ExpressRoute boven internet.</span><span class="sxs-lookup"><span data-stu-id="b35c3-162">If Microsoft receives an IP address with the same subnet mask from the Internet and ExpressRoute, it prefers ExpressRoute over the Internet.</span></span> <span data-ttu-id="b35c3-163">Als een firewall of een ander stateful apparaat aan de rand van uw netwerk en gericht op ExpressRoute geen eerdere informatie over de stroom heeft, worden de pakketten die behoren tot deze gegevensstroom verwijderd.</span><span class="sxs-lookup"><span data-stu-id="b35c3-163">If a firewall or another stateful device that is on your network edge and facing ExpressRoute has no prior information about the flow, it drops the packets that belong to that flow.</span></span>

## <a name="asymmetric-routing-solutions"></a><span data-ttu-id="b35c3-164">Oplossingen voor asymmetrische routering</span><span class="sxs-lookup"><span data-stu-id="b35c3-164">Asymmetric routing solutions</span></span>
<span data-ttu-id="b35c3-165">Er zijn in feite twee oplossingen voor het probleem van asymmetrische routering.</span><span class="sxs-lookup"><span data-stu-id="b35c3-165">You have two main options to solve the problem of asymmetric routing.</span></span> <span data-ttu-id="b35c3-166">De ene is routering en de andere is het gebruik van brongebaseerde NAT (SNAT).</span><span class="sxs-lookup"><span data-stu-id="b35c3-166">One is through routing, and the other is by using source-based NAT (SNAT).</span></span>

### <a name="routing"></a><span data-ttu-id="b35c3-167">Routering</span><span class="sxs-lookup"><span data-stu-id="b35c3-167">Routing</span></span>
<span data-ttu-id="b35c3-168">Zorg ervoor dat uw openbare IP-adressen zijn aangekondigd aan de juiste WAN-koppelingen (Wide Area Network).</span><span class="sxs-lookup"><span data-stu-id="b35c3-168">Ensure that your public IP addresses are advertised to appropriate wide area network (WAN) links.</span></span> <span data-ttu-id="b35c3-169">Als u bijvoorbeeld internet wilt gebruiken voor verificatieverkeer en ExpressRoute voor uw e-mailverkeer, dan moet u uw openbare IP-adressen voor AD FS (Active Directory Federation Services) niet aankondigen via ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="b35c3-169">For example, if you want to use the Internet for authentication traffic and ExpressRoute for your mail traffic, you should not advertise your Active Directory Federation Services (AD FS) public IP addresses over ExpressRoute.</span></span> <span data-ttu-id="b35c3-170">Evenzo moet u ervoor zorgen dat u een on-premises AD FS-server niet blootstelt aan IP-adressen die de router via ExpressRoute ontvangt.</span><span class="sxs-lookup"><span data-stu-id="b35c3-170">Similarly, be sure not to expose an on-premises AD FS server to IP addresses that the router receives over ExpressRoute.</span></span> <span data-ttu-id="b35c3-171">Routes die worden ontvangen via ExpressRoute zijn specifieker, zodat ExpressRoute het voorkeurspad wordt voor verificatieverkeer naar Microsoft.</span><span class="sxs-lookup"><span data-stu-id="b35c3-171">Routes received over ExpressRoute are more specific so they make ExpressRoute the preferred path for authentication traffic to Microsoft.</span></span> <span data-ttu-id="b35c3-172">Dit veroorzaakt asymmetrische routering.</span><span class="sxs-lookup"><span data-stu-id="b35c3-172">This causes asymmetric routing.</span></span>

<span data-ttu-id="b35c3-173">Als u ExpressRoute wilt gebruiken voor verificatie, zorg dan dat u openbare IP-adressen van ADFS via ExpressRoute aankondigt zonder NAT.</span><span class="sxs-lookup"><span data-stu-id="b35c3-173">If you want to use ExpressRoute for authentication, make sure that you are advertising AD FS public IP addresses over ExpressRoute without NAT.</span></span> <span data-ttu-id="b35c3-174">Op deze manier loopt het verkeer dat afkomstig is van Microsoft en naar een on-premises AD FS-server gaat via ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="b35c3-174">This way, traffic that originates from Microsoft and goes to an on-premises AD FS server goes over ExpressRoute.</span></span> <span data-ttu-id="b35c3-175">Retourverkeer van de klant naar Microsoft maakt gebruik van ExpressRoute omdat het de voorkeursroute is via internet.</span><span class="sxs-lookup"><span data-stu-id="b35c3-175">Return traffic from customer to Microsoft uses ExpressRoute because it's the preferred route over the Internet.</span></span>

### <a name="source-based-nat"></a><span data-ttu-id="b35c3-176">Brongebaseerde NAT</span><span class="sxs-lookup"><span data-stu-id="b35c3-176">Source-based NAT</span></span>
<span data-ttu-id="b35c3-177">Een andere oplossing voor problemen met asymmetrische routering is het gebruik van SNAT.</span><span class="sxs-lookup"><span data-stu-id="b35c3-177">Another way of solving asymmetric routing issues is by using SNAT.</span></span> <span data-ttu-id="b35c3-178">U hebt bijvoorbeeld het openbare IP-adres van een on-premises SMTP-server (Simple Mail Transfer Protocol) niet via ExpressRoute aangekondigd omdat u voor dit type communicatie internet wilt gebruiken.</span><span class="sxs-lookup"><span data-stu-id="b35c3-178">For example, you have not advertised the public IP address of an on-premises Simple Mail Transfer Protocol (SMTP) server over ExpressRoute because you intend to use the Internet for this type of communication.</span></span> <span data-ttu-id="b35c3-179">Een aanvraag die afkomstig is van Microsoft en vervolgens naar uw on-premises SMTP-server gaat, passeert via internet.</span><span class="sxs-lookup"><span data-stu-id="b35c3-179">A request that originates with Microsoft and then goes to your on-premises SMTP server traverses the Internet.</span></span> <span data-ttu-id="b35c3-180">U verzendt de inkomende aanvraag via SNAT naar een intern IP-adres.</span><span class="sxs-lookup"><span data-stu-id="b35c3-180">You SNAT the incoming request to an internal IP address.</span></span> <span data-ttu-id="b35c3-181">Terugkerend verkeer van de SMTP-server gaat naar de edge-firewall (die u voor NAT gebruikt) in plaats van via ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="b35c3-181">Reverse traffic from the SMTP server goes to the edge firewall (which you use for NAT) instead of through ExpressRoute.</span></span> <span data-ttu-id="b35c3-182">Het retourverkeer gaat terug via internet.</span><span class="sxs-lookup"><span data-stu-id="b35c3-182">The return traffic goes back via the Internet.</span></span>

![Brongebaseerde NAT-netwerkconfiguratie](./media/expressroute-asymmetric-routing/AsymmetricRouting2.png)

## <a name="asymmetric-routing-detection"></a><span data-ttu-id="b35c3-184">Detectie van asymmetrische routering</span><span class="sxs-lookup"><span data-stu-id="b35c3-184">Asymmetric routing detection</span></span>
<span data-ttu-id="b35c3-185">Traceroute is de beste manier om ervoor te zorgen dat uw netwerkverkeer via het verwachte pad loopt.</span><span class="sxs-lookup"><span data-stu-id="b35c3-185">Traceroute is the best way to make sure that your network traffic is traversing the expected path.</span></span> <span data-ttu-id="b35c3-186">Als u verwacht dat verkeer van de on-premises SMTP-server naar Microsoft via het internetpad gaat, dan loopt de verwachte traceroute van de SMTP-server naar Office 365.</span><span class="sxs-lookup"><span data-stu-id="b35c3-186">If you expect traffic from your on-premises SMTP server to Microsoft to take the Internet path, the expected traceroute is from the SMTP server to Office 365.</span></span> <span data-ttu-id="b35c3-187">Zo wordt gevalideerd of het verkeer inderdaad uw netwerk verlaat richting internet en niet richting ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="b35c3-187">The result validates that traffic is indeed leaving your network toward the Internet and not toward ExpressRoute.</span></span>

