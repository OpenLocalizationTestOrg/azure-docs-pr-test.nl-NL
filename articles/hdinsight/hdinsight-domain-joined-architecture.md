---
title: Domein Azure HDInsight-architectuur | Microsoft Docs
description: Meer informatie over het plannen van aan domein gekoppelde HDInsight.
services: hdinsight
documentationcenter: 
author: saurinsh
manager: jhubbard
editor: cgronlun
tags: azure-portal
ms.assetid: 7dc6847d-10d4-4b5c-9c83-cc513cf91965
ms.service: hdinsight
ms.custom: hdinsightactive
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: big-data
ms.date: 02/03/2017
ms.author: saurinsh
ms.openlocfilehash: 7e34f47f09466a40993b4cc797ff1cad2bdaeafe
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 07/11/2017
---
# <a name="plan-azure-domain-joined-hadoop-clusters-in-hdinsight"></a><span data-ttu-id="e0601-103">Azure Hadoop-clusters in aan domein gekoppelde HDInsight plannen</span><span class="sxs-lookup"><span data-stu-id="e0601-103">Plan Azure domain-joined Hadoop clusters in HDInsight</span></span>

<span data-ttu-id="e0601-104">Het traditionele Hadoop is een cluster met één gebruiker.</span><span class="sxs-lookup"><span data-stu-id="e0601-104">The traditional Hadoop is a single-user cluster.</span></span> <span data-ttu-id="e0601-105">Dit is geschikt voor de meeste bedrijven met kleinere toepassingsteams die workloads met veel gegevens maken.</span><span class="sxs-lookup"><span data-stu-id="e0601-105">It is suitable for most companies that have smaller application teams building large data workloads.</span></span> <span data-ttu-id="e0601-106">Naarmate Hadoop populairder wordt, stappen veel bedrijven over op een model waarin clusters worden beheerd door IT-teams en meerdere toepassingsteams clusters delen.</span><span class="sxs-lookup"><span data-stu-id="e0601-106">As Hadoop gains popularity, many enterprises are moving toward a model in which clusters are managed by IT teams and multiple application teams share clusters.</span></span> <span data-ttu-id="e0601-107">Daarom zijn functies met clusters voor meerdere gebruikers onder de meest gevraagde functies in Azure HDInsight.</span><span class="sxs-lookup"><span data-stu-id="e0601-107">Thus, functionalities involving multiuser clusters are among the most requested functionalities in Azure HDInsight.</span></span>

<span data-ttu-id="e0601-108">In plaats van het bouwen van een eigen voor meerdere gebruikers verificatie en autorisatie is HDInsight is afhankelijk van de meest populaire id-provider--Active Directory (AD).</span><span class="sxs-lookup"><span data-stu-id="e0601-108">Instead of building its own multiuser authentication and authorization, HDInsight relies on the most popular identity provider--Active Directory (AD).</span></span> <span data-ttu-id="e0601-109">De krachtige beveiligingsfuncties in AD kan worden gebruikt voor het beheren van meerdere gebruikers autorisatie in HDInsight.</span><span class="sxs-lookup"><span data-stu-id="e0601-109">The powerful security functionality in AD can be used to manage multiuser authorization in HDInsight.</span></span> <span data-ttu-id="e0601-110">Door te integreren HDInsight met AD, kunt u communiceren met de clusters met behulp van uw AD-referenties.</span><span class="sxs-lookup"><span data-stu-id="e0601-110">By integrating HDInsight with AD, you can communicate with the clusters by using your AD credentials.</span></span> <span data-ttu-id="e0601-111">Een AD-gebruiker wordt HDInsight toegewezen aan een gebruiker met lokale Hadoop, zodat alle services die worden uitgevoerd op HDInsight (Ambari, Hive-server, Zwerver, Spark thrift-server en andere) naadloos voor de geverifieerde gebruiker.</span><span class="sxs-lookup"><span data-stu-id="e0601-111">HDInsight maps an AD user to a local Hadoop user, so all the services running on HDInsight (Ambari, Hive server, Ranger, Spark thrift server, and others) work seamlessly for the authenticated user.</span></span>

## <a name="integrate-hdinsight-with-ad-and-ad-on-iaas-vm"></a><span data-ttu-id="e0601-112">HDInsight integreren met AD- en AD op IaaS VM</span><span class="sxs-lookup"><span data-stu-id="e0601-112">Integrate HDInsight with AD and AD on IaaS VM</span></span>

<span data-ttu-id="e0601-113">Door te integreren HDInsight met Azure AD of AD op Iaas VM, zijn de clusterknooppunten HDInsight domein is gekoppeld aan een domein.</span><span class="sxs-lookup"><span data-stu-id="e0601-113">By integrating HDInsight with Azure AD or AD on Iaas VM, the HDInsight cluster nodes are domain-joined to a domain.</span></span> <span data-ttu-id="e0601-114">HDInsight maakt service-principals voor het Hadoop-services uitgevoerd op het cluster en binnen een opgegeven organisatie-eenheid (OE) in Azure AD of AD op IaaS VM geplaatst.</span><span class="sxs-lookup"><span data-stu-id="e0601-114">HDInsight creates service principals for the Hadoop services running on the cluster and places them within a specified organizational unit (OU) in Azure AD or AD on IaaS VM.</span></span> <span data-ttu-id="e0601-115">HDInsight maakt ook omgekeerde DNS-toewijzingen in het domein voor de IP-adressen van de knooppunten die zijn gekoppeld aan het domein.</span><span class="sxs-lookup"><span data-stu-id="e0601-115">HDInsight also creates reverse DNS mappings in the domain for the IP addresses of the nodes that are joined to the domain.</span></span>

<span data-ttu-id="e0601-116">U kunt deze configuratie bereiken met behulp van verschillende architecturen.</span><span class="sxs-lookup"><span data-stu-id="e0601-116">You can achieve this setup by using multiple architectures.</span></span> <span data-ttu-id="e0601-117">U kunt kiezen uit de volgende architecturen.</span><span class="sxs-lookup"><span data-stu-id="e0601-117">You can choose from the following architectures.</span></span>

<span data-ttu-id="e0601-118">**HDInsight is geïntegreerd met AD uitgevoerd op Azure IaaS**</span><span class="sxs-lookup"><span data-stu-id="e0601-118">**HDInsight integrated with AD running on Azure IaaS**</span></span>

<span data-ttu-id="e0601-119">Dit is de eenvoudigste architectuur om HDInsight te integreren met Active Directory.</span><span class="sxs-lookup"><span data-stu-id="e0601-119">This is the simplest architecture for integrating HDInsight with Active Directory.</span></span> <span data-ttu-id="e0601-120">De AD-domeincontroller wordt uitgevoerd op een (of meerdere) virtuele machines (VM's) in Azure.</span><span class="sxs-lookup"><span data-stu-id="e0601-120">The AD domain controller runs on one (or multiple) virtual machines (VMs) in Azure.</span></span> <span data-ttu-id="e0601-121">Deze VM's bevinden zich meestal in een virtueel netwerk.</span><span class="sxs-lookup"><span data-stu-id="e0601-121">These VMs are usually in a virtual network.</span></span> <span data-ttu-id="e0601-122">U stelt een ander virtueel netwerk in voor het HDInsight-cluster.</span><span class="sxs-lookup"><span data-stu-id="e0601-122">You set up another virtual network for the HDInsight cluster.</span></span> <span data-ttu-id="e0601-123">Voor HDInsight om een regel zicht naar Active Directory, moet u deze virtuele netwerken met behulp van peer [VNet-naar-VNet-peering](../virtual-network/virtual-network-create-peering.md).</span><span class="sxs-lookup"><span data-stu-id="e0601-123">For HDInsight to have a line of sight to Active Directory, you need to peer these virtual networks by using [VNet-to-VNet peering](../virtual-network/virtual-network-create-peering.md).</span></span> <span data-ttu-id="e0601-124">Als u de Active Directory in ARM maakt, klikt u vervolgens kunt u de Active Directory en HDInsight maken in hetzelfde VNet en u hoeft niet te doen peering.</span><span class="sxs-lookup"><span data-stu-id="e0601-124">If you create the Active Directory in ARM, then you can create the Active Directory and HDInsight in the same VNet and you don't need to do peering.</span></span> 

![Topologie van aan domein gekoppeld HDInsight-cluster](./media/hdinsight-domain-joined-architecture/hdinsight-domain-joined-architecture_1.png)

> [!NOTE]
> <span data-ttu-id="e0601-126">In deze architectuur kunt u Azure Data Lake Store niet gebruiken met HDInsight-cluster.</span><span class="sxs-lookup"><span data-stu-id="e0601-126">In this architecture, you cannot use Azure Data Lake Store with the HDInsight cluster.</span></span>


<span data-ttu-id="e0601-127">Vereisten voor Active Directory:</span><span class="sxs-lookup"><span data-stu-id="e0601-127">Prerequisites for Active Directory:</span></span>

* <span data-ttu-id="e0601-128">Er moet een [organisatie-eenheid](../active-directory-domain-services/active-directory-ds-admin-guide-create-ou.md) worden gemaakt waarin u de VM's van het HDInsight-cluster en de service-principals die door het cluster worden gebruikt, plaatst.</span><span class="sxs-lookup"><span data-stu-id="e0601-128">An [organizational unit](../active-directory-domain-services/active-directory-ds-admin-guide-create-ou.md) must be created, within which you place the HDInsight cluster VMs and the service principals used by the cluster.</span></span>
* <span data-ttu-id="e0601-129">[Lightweight Directory Access protocollen](../active-directory-domain-services/active-directory-ds-admin-guide-configure-secure-ldap.md) (LDAPs) moeten worden ingesteld voor communicatie met AD.</span><span class="sxs-lookup"><span data-stu-id="e0601-129">[Lightweight Directory Access Protocols](../active-directory-domain-services/active-directory-ds-admin-guide-configure-secure-ldap.md) (LDAPs) must be set up for communicating with AD.</span></span> <span data-ttu-id="e0601-130">Het certificaat dat voor het instellen van LDAPS wordt gebruikt, moet een echt certificaat zijn (niet een zelfondertekend certificaat).</span><span class="sxs-lookup"><span data-stu-id="e0601-130">The certificate used to set up LDAPS must be a real certificate (not a self-signed certificate).</span></span>
* <span data-ttu-id="e0601-131">Er moeten omgekeerde DNS-zones in het domein worden gemaakt voor het IP-adresbereik van het HDInsight-subnet (bijvoorbeeld 10.2.0.0/24 in de vorige afbeelding).</span><span class="sxs-lookup"><span data-stu-id="e0601-131">Reverse DNS zones must be created on the domain for the IP address range of the HDInsight subnet (for example, 10.2.0.0/24 in the previous picture).</span></span>
* <span data-ttu-id="e0601-132">Een service-account of gebruikersaccount is vereist.</span><span class="sxs-lookup"><span data-stu-id="e0601-132">A service account or a user account is needed.</span></span> <span data-ttu-id="e0601-133">Gebruik dit account om de HDInsight-cluster te maken.</span><span class="sxs-lookup"><span data-stu-id="e0601-133">Use this account to create the HDInsight cluster.</span></span> <span data-ttu-id="e0601-134">Dit account moet de volgende machtigingen hebben:</span><span class="sxs-lookup"><span data-stu-id="e0601-134">This account must have the following permissions:</span></span>

    - <span data-ttu-id="e0601-135">Machtigingen om service-principal- en machineobjecten in de organisatie-eenheid te maken</span><span class="sxs-lookup"><span data-stu-id="e0601-135">Permissions to create service principal objects and machine objects within the organizational unit</span></span>
    - <span data-ttu-id="e0601-136">Machtigingen om regels voor omgekeerde DNS-proxy's te maken.</span><span class="sxs-lookup"><span data-stu-id="e0601-136">Permissions to create reverse DNS proxy rules</span></span>
    - <span data-ttu-id="e0601-137">Machtigingen om machines lid te maken van het Active Directory-domein</span><span class="sxs-lookup"><span data-stu-id="e0601-137">Permissions to join machines to the Active Directory domain</span></span>

<span data-ttu-id="e0601-138">**HDInsight geïntegreerd met een alleen-cloud Azure AD**</span><span class="sxs-lookup"><span data-stu-id="e0601-138">**HDInsight integrated with cloud-only Azure AD**</span></span>

<span data-ttu-id="e0601-139">Configureer een domeincontroller voor alleen-cloud Azure AD, zodat HDInsight kan worden geïntegreerd met Azure AD.</span><span class="sxs-lookup"><span data-stu-id="e0601-139">For cloud-only Azure AD, configure a domain controller so that HDInsight can be integrated with Azure AD.</span></span> <span data-ttu-id="e0601-140">Dit wordt bereikt door middel [Azure Active Directory Domain Services](../active-directory-domain-services/active-directory-ds-overview.md) (Azure AD DS).</span><span class="sxs-lookup"><span data-stu-id="e0601-140">This is achieved by using [Azure Active Directory Domain Services](../active-directory-domain-services/active-directory-ds-overview.md) (Azure AD DS).</span></span> <span data-ttu-id="e0601-141">Azure AD DS maakt domeincontrollermachines in de cloud en biedt de IP-adressen van deze machines.</span><span class="sxs-lookup"><span data-stu-id="e0601-141">Azure AD DS creates domain controller machines on the cloud and provides IP addresses for them.</span></span> <span data-ttu-id="e0601-142">Voor maximale beschikbaarheid worden er twee domeincontrollers gemaakt.</span><span class="sxs-lookup"><span data-stu-id="e0601-142">It creates two domain controllers for high availability.</span></span>

<span data-ttu-id="e0601-143">Azure AD DS bestaat op dit moment alleen in klassieke virtuele netwerken.</span><span class="sxs-lookup"><span data-stu-id="e0601-143">Currently, Azure AD DS exists only in classic virtual networks.</span></span> <span data-ttu-id="e0601-144">Het is alleen toegankelijk via de klassieke Azure-portal.</span><span class="sxs-lookup"><span data-stu-id="e0601-144">It is only accessible by using the Azure classic portal.</span></span> <span data-ttu-id="e0601-145">Het virtuele netwerk van HDInsight bestaat in Azure Portal, die met behulp van VNet-naar-VNet-peering moet worden gepeerd met het klassieke virtuele netwerk.</span><span class="sxs-lookup"><span data-stu-id="e0601-145">The HDInsight virtual network exists in the Azure portal, which needs to be peered with the classic virtual network by using VNet-to-VNet peering.</span></span>

> [!NOTE]
> <span data-ttu-id="e0601-146">Voor peering tussen een klassiek virtueel netwerk en een virtueel netwerk van Azure Resource Manager moeten beide virtuele netwerken zich in dezelfde regio bevinden en hetzelfde Azure-abonnement hebben.</span><span class="sxs-lookup"><span data-stu-id="e0601-146">Peering between a classic virtual network and an Azure Resource Manager virtual network requires that both virtual networks are in the same region and under the same Azure subscription.</span></span>

![Topologie van aan domein gekoppeld HDInsight-cluster](./media/hdinsight-domain-joined-architecture/hdinsight-domain-joined-architecture_2.png)

<span data-ttu-id="e0601-148">Vereisten voor Azure AD:</span><span class="sxs-lookup"><span data-stu-id="e0601-148">Prerequisites for Azure AD:</span></span>

* <span data-ttu-id="e0601-149">Er moet een [organisatie-eenheid](../active-directory-domain-services/active-directory-ds-admin-guide-create-ou.md) worden gemaakt waarin u de VM's van het HDInsight-cluster en de service-principals die door het cluster worden gebruikt, plaatst.</span><span class="sxs-lookup"><span data-stu-id="e0601-149">An [organizational unit](../active-directory-domain-services/active-directory-ds-admin-guide-create-ou.md) must be created within which you place the HDInsight cluster VMs and the service principals used by the cluster.</span></span>
* <span data-ttu-id="e0601-150">Tijdens de configuratie van Azure AD DS moet [LDAPS](../active-directory-domain-services/active-directory-ds-admin-guide-configure-secure-ldap.md) worden ingesteld.</span><span class="sxs-lookup"><span data-stu-id="e0601-150">[LDAPS](../active-directory-domain-services/active-directory-ds-admin-guide-configure-secure-ldap.md) must be set up when you configure Azure AD DS.</span></span> <span data-ttu-id="e0601-151">Het certificaat dat voor het instellen van LDAPS wordt gebruikt, moet een echt certificaat zijn (niet een zelfondertekend certificaat).</span><span class="sxs-lookup"><span data-stu-id="e0601-151">The certificate used to set up LDAPS must be a real certificate (not a self-signed certificate).</span></span>
* <span data-ttu-id="e0601-152">Er moeten omgekeerde DNS-zones in het domein worden gemaakt voor het IP-adresbereik van het HDInsight-subnet (bijvoorbeeld 10.2.0.0/24 in de vorige afbeelding).</span><span class="sxs-lookup"><span data-stu-id="e0601-152">Reverse DNS zones must be created on the domain for the IP address range of the HDInsight subnet (for example, 10.2.0.0/24 in the previous picture).</span></span>
* <span data-ttu-id="e0601-153">[Wachtwoord-hashes](../active-directory-domain-services/active-directory-ds-getting-started-password-sync.md) moeten vanuit Azure AD worden gesynchroniseerd met Azure AD DS.</span><span class="sxs-lookup"><span data-stu-id="e0601-153">[Password hashes](../active-directory-domain-services/active-directory-ds-getting-started-password-sync.md) must be synced from Azure AD to Azure AD DS.</span></span>
* <span data-ttu-id="e0601-154">Een service-account of gebruikersaccount is vereist.</span><span class="sxs-lookup"><span data-stu-id="e0601-154">A service account or a user account is needed.</span></span> <span data-ttu-id="e0601-155">Gebruik dit account om de HDInsight-cluster te maken.</span><span class="sxs-lookup"><span data-stu-id="e0601-155">Use this account to create the HDInsight cluster.</span></span> <span data-ttu-id="e0601-156">Dit account moet de volgende machtigingen hebben:</span><span class="sxs-lookup"><span data-stu-id="e0601-156">This account must have the following permissions:</span></span>

    - <span data-ttu-id="e0601-157">Machtigingen om service-principal- en machineobjecten in de organisatie-eenheid te maken</span><span class="sxs-lookup"><span data-stu-id="e0601-157">Permissions to create service principal objects and machine objects within the organizational unit</span></span>
    - <span data-ttu-id="e0601-158">Machtigingen om regels voor omgekeerde DNS-proxy's te maken.</span><span class="sxs-lookup"><span data-stu-id="e0601-158">Permissions to create reverse DNS proxy rules</span></span>
    - <span data-ttu-id="e0601-159">Machtigingen om machines lid te maken van het Azure AD-domein</span><span class="sxs-lookup"><span data-stu-id="e0601-159">Permissions to join machines to the Azure AD domain</span></span>

## <a name="next-steps"></a><span data-ttu-id="e0601-160">Volgende stappen</span><span class="sxs-lookup"><span data-stu-id="e0601-160">Next steps</span></span>
* <span data-ttu-id="e0601-161">Zie [Configure Domain-joined HDInsight clusters](hdinsight-domain-joined-configure.md) (Aan een domein gekoppelde HDInsight-clusters configureren) om een HDInsight-cluster te configureren dat is gekoppeld aan een domein.</span><span class="sxs-lookup"><span data-stu-id="e0601-161">To configure a domain-joined HDInsight cluster, see [Configure domain-joined HDInsight clusters](hdinsight-domain-joined-configure.md).</span></span>
* <span data-ttu-id="e0601-162">Zie [Manage Domain-joined HDInsight clusters](hdinsight-domain-joined-manage.md) (Aan een domein gekoppelde HDInsight-clusters beheren) om HDInsight-clusters te beheren die zijn gekoppeld aan een domein.</span><span class="sxs-lookup"><span data-stu-id="e0601-162">To manage domain-joined HDInsight clusters, see [Manage domain-joined HDInsight clusters](hdinsight-domain-joined-manage.md).</span></span>
* <span data-ttu-id="e0601-163">Zie [Configure Hive policies for Domain-joined HDInsight clusters](hdinsight-domain-joined-run-hive.md) (Hive-beleid configureren voor aan een domein gekoppelde HDInsight-clusters) om Hive-beleid te configureren en Hive-query's uit te voeren.</span><span class="sxs-lookup"><span data-stu-id="e0601-163">To configure Hive policies and run Hive queries, see [Configure Hive policies for domain-joined HDInsight clusters](hdinsight-domain-joined-run-hive.md).</span></span>
* <span data-ttu-id="e0601-164">Zie voor informatie over het uitvoeren van Hive-query's met behulp van SSH op HDInsight-clusters domein [SSH gebruiken met HDInsight](hdinsight-hadoop-linux-use-ssh-unix.md).</span><span class="sxs-lookup"><span data-stu-id="e0601-164">To run Hive queries by using SSH on domain-joined HDInsight clusters, see [Use SSH with HDInsight](hdinsight-hadoop-linux-use-ssh-unix.md).</span></span>
