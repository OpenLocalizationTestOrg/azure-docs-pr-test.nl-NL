---
title: Actie bij het ontwikkelen met HDInsight - Azure aaaScript | Microsoft Docs
description: "Meer informatie over hoe toocustomize Hadoop-clusters met scriptactie. Scriptactie mag gebruikte tooinstall aanvullende software die worden uitgevoerd op een Hadoop-cluster of toochange Hallo configuratie van toepassingen zijn geïnstalleerd op een cluster."
services: hdinsight
documentationcenter: 
tags: azure-portal
author: mumian
manager: jhubbard
editor: cgronlun
ms.assetid: 836d68a8-8b21-4d69-8b61-281a7fe67f21
ms.service: hdinsight
ms.workload: big-data
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 05/25/2017
ms.author: jgao
ROBOTS: NOINDEX
ms.openlocfilehash: 4fc3a389df8a003f7129ab00b4cd9bc7ad81a419
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 10/06/2017
---
# <a name="develop-script-action-scripts-for-hdinsight-windows-based-clusters"></a><span data-ttu-id="c42f2-104">Scripts voor HDInsight Windows gebaseerde clusters scriptactie ontwikkelen</span><span class="sxs-lookup"><span data-stu-id="c42f2-104">Develop Script Action scripts for HDInsight Windows-based clusters</span></span>
<span data-ttu-id="c42f2-105">Meer informatie over hoe toowrite scriptactie scripts voor HDInsight.</span><span class="sxs-lookup"><span data-stu-id="c42f2-105">Learn how toowrite Script Action scripts for HDInsight.</span></span> <span data-ttu-id="c42f2-106">Zie voor meer informatie over het gebruik van de scriptactie scripts [aanpassen HDInsight-clusters met behulp van de scriptactie](hdinsight-hadoop-customize-cluster.md).</span><span class="sxs-lookup"><span data-stu-id="c42f2-106">For information on using Script Action scripts, see [Customize HDInsight clusters using Script Action](hdinsight-hadoop-customize-cluster.md).</span></span> <span data-ttu-id="c42f2-107">Zie voor Hallo hetzelfde artikel is geschreven voor Linux gebaseerde HDInsight-clusters, [scriptactie ontwikkelen scripts voor HDInsight](hdinsight-hadoop-script-actions-linux.md).</span><span class="sxs-lookup"><span data-stu-id="c42f2-107">For hello same article written for Linux-based HDInsight clusters, see [Develop Script Action scripts for HDInsight](hdinsight-hadoop-script-actions-linux.md).</span></span>



> [!IMPORTANT]
> <span data-ttu-id="c42f2-108">Hallo stappen in dit document alleen werk voor op Windows gebaseerde HDInsight-clusters.</span><span class="sxs-lookup"><span data-stu-id="c42f2-108">hello steps in this document only work for Windows-based HDInsight clusters.</span></span> <span data-ttu-id="c42f2-109">HDInsight is alleen beschikbaar in Windows voor versies lager is dan HDInsight 3.4.</span><span class="sxs-lookup"><span data-stu-id="c42f2-109">HDInsight is only available on Windows for versions lower than HDInsight 3.4.</span></span> <span data-ttu-id="c42f2-110">Linux is Hallo enige besturingssysteem gebruikt op HDInsight versie 3.4 of hoger.</span><span class="sxs-lookup"><span data-stu-id="c42f2-110">Linux is hello only operating system used on HDInsight version 3.4 or greater.</span></span> <span data-ttu-id="c42f2-111">Zie [HDInsight retirement on Windows](hdinsight-component-versioning.md#hdinsight-windows-retirement) (HDInsight buiten gebruik gestel voor Windows) voor meer informatie.</span><span class="sxs-lookup"><span data-stu-id="c42f2-111">For more information, see [HDInsight retirement on Windows](hdinsight-component-versioning.md#hdinsight-windows-retirement).</span></span> <span data-ttu-id="c42f2-112">Zie voor meer informatie over het gebruik van scriptacties met Linux gebaseerde clusters [Scriptactieontwikkeling met HDInsight (Linux)](hdinsight-hadoop-script-actions-linux.md).</span><span class="sxs-lookup"><span data-stu-id="c42f2-112">For information on using script actions with Linux-based clusters, see [Script action development with HDInsight (Linux)](hdinsight-hadoop-script-actions-linux.md).</span></span>
>
>



<span data-ttu-id="c42f2-113">Scriptactie mag gebruikte tooinstall aanvullende software die worden uitgevoerd op een Hadoop-cluster of toochange Hallo configuratie van toepassingen zijn geïnstalleerd op een cluster.</span><span class="sxs-lookup"><span data-stu-id="c42f2-113">Script Action can be used tooinstall additional software running on a Hadoop cluster or toochange hello configuration of applications installed on a cluster.</span></span> <span data-ttu-id="c42f2-114">Scriptacties zijn scripts die worden uitgevoerd op de clusterknooppunten Hallo bij HDInsight-clusters worden geïmplementeerd en ze worden uitgevoerd zodra de knooppunten in cluster Hallo HDInsight-configuratie voltooien.</span><span class="sxs-lookup"><span data-stu-id="c42f2-114">Script actions are scripts that run on hello cluster nodes when HDInsight clusters are deployed, and they are executed once nodes in hello cluster complete HDInsight configuration.</span></span> <span data-ttu-id="c42f2-115">Een scriptactie wordt uitgevoerd onder system-account beheerdersbevoegdheden en biedt volledige toegangsrechten toohello clusterknooppunten.</span><span class="sxs-lookup"><span data-stu-id="c42f2-115">A script action is executed under system admin account privileges and provides full access rights toohello cluster nodes.</span></span> <span data-ttu-id="c42f2-116">Elk cluster kan worden opgegeven met een lijst met script acties toobe uitgevoerd in Hallo volgorde waarin ze worden opgegeven.</span><span class="sxs-lookup"><span data-stu-id="c42f2-116">Each cluster can be provided with a list of script actions toobe executed in hello order in which they are specified.</span></span>

> [!NOTE]
> <span data-ttu-id="c42f2-117">Als u Hallo volgende foutbericht weergegeven ondervindt:</span><span class="sxs-lookup"><span data-stu-id="c42f2-117">If you experience hello following error message:</span></span>
>
> <span data-ttu-id="c42f2-118">System.Management.Automation.CommandNotFoundException; ExceptionMessage: Hallo term 'Opslaan HDIFile' wordt niet herkend als Hallo-naam van een cmdlet, functie, scriptbestand of programma.</span><span class="sxs-lookup"><span data-stu-id="c42f2-118">System.Management.Automation.CommandNotFoundException; ExceptionMessage : hello term 'Save-HDIFile' is not recognized as hello name of a cmdlet, function, script file, or operable program.</span></span> <span data-ttu-id="c42f2-119">Controleer de spelling Hallo van Hallo-naam of als een pad opgenomen is, Verifieer dat Hallo pad juist is en probeer het opnieuw.</span><span class="sxs-lookup"><span data-stu-id="c42f2-119">Check hello spelling of hello name, or if a path was included, verify that hello path is correct and try again.</span></span>
> <span data-ttu-id="c42f2-120">Omdat u niet hebt opgenomen methoden hello wordt.</span><span class="sxs-lookup"><span data-stu-id="c42f2-120">It is because you didn't include hello helper methods.</span></span>  <span data-ttu-id="c42f2-121">Zie [Help-methoden voor aangepaste scripts](hdinsight-hadoop-script-actions.md#helper-methods-for-custom-scripts).</span><span class="sxs-lookup"><span data-stu-id="c42f2-121">See [Helper methods for custom scripts](hdinsight-hadoop-script-actions.md#helper-methods-for-custom-scripts).</span></span>
>
>

## <a name="sample-scripts"></a><span data-ttu-id="c42f2-122">Voorbeeldscripts</span><span class="sxs-lookup"><span data-stu-id="c42f2-122">Sample scripts</span></span>
<span data-ttu-id="c42f2-123">Hallo scriptactie is voor het maken van HDInsight-clusters op Windows-besturingssysteem, Azure PowerShell-script.</span><span class="sxs-lookup"><span data-stu-id="c42f2-123">For creating HDInsight clusters on Windows operating system, hello Script Action is Azure PowerShell script.</span></span> <span data-ttu-id="c42f2-124">Hallo is volgende script een voorbeeld voor het configureren van configuratiebestanden Hallo-site:</span><span class="sxs-lookup"><span data-stu-id="c42f2-124">hello following script is a sample for configuring hello site configuration files:</span></span>

[!INCLUDE [upgrade-powershell](../../includes/hdinsight-use-latest-powershell.md)]

    param (
        [parameter(Mandatory)][string] $ConfigFileName,
        [parameter(Mandatory)][string] $Name,
        [parameter(Mandatory)][string] $Value,
        [parameter()][string] $Description
    )

    if (!$Description) {
        $Description = ""
    }

    $hdiConfigFiles = @{
        "hive-site.xml" = "$env:HIVE_HOME\conf\hive-site.xml";
        "core-site.xml" = "$env:HADOOP_HOME\etc\hadoop\core-site.xml";
        "hdfs-site.xml" = "$env:HADOOP_HOME\etc\hadoop\hdfs-site.xml";
        "mapred-site.xml" = "$env:HADOOP_HOME\etc\hadoop\mapred-site.xml";
        "yarn-site.xml" = "$env:HADOOP_HOME\etc\hadoop\yarn-site.xml"
    }

    if (!($hdiConfigFiles[$ConfigFileName])) {
        Write-HDILog "Unable tooconfigure $ConfigFileName because it is not part of hello HDI configuration files."
        return
    }

    [xml]$configFile = Get-Content $hdiConfigFiles[$ConfigFileName]

    $existingproperty = $configFile.configuration.property | where {$_.Name -eq $Name}

    if ($existingproperty) {
        $existingproperty.Value = $Value
        $existingproperty.Description = $Description
    } else {
        $newproperty = @($configFile.configuration.property)[0].Clone()
        $newproperty.Name = $Name
        $newproperty.Value = $Value
        $newproperty.Description = $Description
        $configFile.configuration.AppendChild($newproperty)
    }

    $configFile.Save($hdiConfigFiles[$ConfigFileName])

    Write-HDILog "$configFileName has been configured."

<span data-ttu-id="c42f2-125">Hallo script neemt vier parameters, naam configuratiebestand hello, Hallo-eigenschap die u wilt dat toomodify, Hallo-waarde die u wilt tooset en een beschrijving.</span><span class="sxs-lookup"><span data-stu-id="c42f2-125">hello script takes four parameters, hello configuration file name, hello property you want toomodify, hello value you want tooset, and a description.</span></span> <span data-ttu-id="c42f2-126">Bijvoorbeeld:</span><span class="sxs-lookup"><span data-stu-id="c42f2-126">For example:</span></span>

    hive-site.xml hive.metastore.client.socket.timeout 90

<span data-ttu-id="c42f2-127">Deze parameters stelt Hallo hive.metastore.client.socket.timeout waarde too90 in bestand Hallo-hive-site.xml.</span><span class="sxs-lookup"><span data-stu-id="c42f2-127">These parameters sets hello hive.metastore.client.socket.timeout value too90 in hello hive-site.xml file.</span></span>  <span data-ttu-id="c42f2-128">Hallo-standaardwaarde is 60 seconden.</span><span class="sxs-lookup"><span data-stu-id="c42f2-128">hello default value is 60 seconds.</span></span>

<span data-ttu-id="c42f2-129">Dit voorbeeldscript kan ook worden gevonden op [https://hditutorialdata.blob.core.windows.net/customizecluster/editSiteConfig.ps1](https://hditutorialdata.blob.core.windows.net/customizecluster/editSiteConfig.ps1).</span><span class="sxs-lookup"><span data-stu-id="c42f2-129">This sample script can also be found at [https://hditutorialdata.blob.core.windows.net/customizecluster/editSiteConfig.ps1](https://hditutorialdata.blob.core.windows.net/customizecluster/editSiteConfig.ps1).</span></span>

<span data-ttu-id="c42f2-130">HDInsight biedt verschillende scripts tooinstall extra onderdelen op HDInsight-clusters:</span><span class="sxs-lookup"><span data-stu-id="c42f2-130">HDInsight provides several scripts tooinstall additional components on HDInsight clusters:</span></span>

| <span data-ttu-id="c42f2-131">Naam</span><span class="sxs-lookup"><span data-stu-id="c42f2-131">Name</span></span> | <span data-ttu-id="c42f2-132">Script</span><span class="sxs-lookup"><span data-stu-id="c42f2-132">Script</span></span> |
| --- | --- |
| <span data-ttu-id="c42f2-133">**Spark installeren**</span><span class="sxs-lookup"><span data-stu-id="c42f2-133">**Install Spark**</span></span> |<span data-ttu-id="c42f2-134">https://hdiconfigactions.BLOB.Core.Windows.NET/sparkconfigactionv03/Spark-Installer-v03.ps1.</span><span class="sxs-lookup"><span data-stu-id="c42f2-134">https://hdiconfigactions.blob.core.windows.net/sparkconfigactionv03/spark-installer-v03.ps1.</span></span> <span data-ttu-id="c42f2-135">Zie [installeert en gebruikt Spark in HDInsight-clusters][hdinsight-install-spark].</span><span class="sxs-lookup"><span data-stu-id="c42f2-135">See [Install and use Spark on HDInsight clusters][hdinsight-install-spark].</span></span> |
| <span data-ttu-id="c42f2-136">**R installeren**</span><span class="sxs-lookup"><span data-stu-id="c42f2-136">**Install R**</span></span> |<span data-ttu-id="c42f2-137">https://hdiconfigactions.BLOB.Core.Windows.NET/rconfigactionv02/r-Installer-v02.ps1.</span><span class="sxs-lookup"><span data-stu-id="c42f2-137">https://hdiconfigactions.blob.core.windows.net/rconfigactionv02/r-installer-v02.ps1.</span></span> <span data-ttu-id="c42f2-138">Zie [installeert en gebruikt R op HDInsight-clusters][hdinsight-r-scripts].</span><span class="sxs-lookup"><span data-stu-id="c42f2-138">See [Install and use R on HDInsight clusters][hdinsight-r-scripts].</span></span> |
| <span data-ttu-id="c42f2-139">**Solr installeren**</span><span class="sxs-lookup"><span data-stu-id="c42f2-139">**Install Solr**</span></span> |<span data-ttu-id="c42f2-140">https://hdiconfigactions.BLOB.Core.Windows.NET/solrconfigactionv01/solr-Installer-v01.ps1.</span><span class="sxs-lookup"><span data-stu-id="c42f2-140">https://hdiconfigactions.blob.core.windows.net/solrconfigactionv01/solr-installer-v01.ps1.</span></span> <span data-ttu-id="c42f2-141">Zie [installeert en gebruikt Solr op HDInsight-clusters](hdinsight-hadoop-solr-install.md).</span><span class="sxs-lookup"><span data-stu-id="c42f2-141">See [Install and use Solr on HDInsight clusters](hdinsight-hadoop-solr-install.md).</span></span> |
| <span data-ttu-id="c42f2-142">- **Giraph installeren**</span><span class="sxs-lookup"><span data-stu-id="c42f2-142">- **Install Giraph**</span></span> |<span data-ttu-id="c42f2-143">https://hdiconfigactions.BLOB.Core.Windows.NET/giraphconfigactionv01/giraph-Installer-v01.ps1.</span><span class="sxs-lookup"><span data-stu-id="c42f2-143">https://hdiconfigactions.blob.core.windows.net/giraphconfigactionv01/giraph-installer-v01.ps1.</span></span> <span data-ttu-id="c42f2-144">Zie [installeert en gebruikt Giraph op HDInsight-clusters](hdinsight-hadoop-giraph-install.md).</span><span class="sxs-lookup"><span data-stu-id="c42f2-144">See [Install and use Giraph on HDInsight clusters](hdinsight-hadoop-giraph-install.md).</span></span> |

<span data-ttu-id="c42f2-145">Scriptactie kan worden geïmplementeerd vanaf hello Azure-portal, Azure PowerShell of met behulp van Hallo HDInsight .NET SDK.</span><span class="sxs-lookup"><span data-stu-id="c42f2-145">Script Action can be deployed from hello Azure portal, Azure PowerShell or by using hello HDInsight .NET SDK.</span></span>  <span data-ttu-id="c42f2-146">Zie voor meer informatie [aanpassen HDInsight-clusters met behulp van de scriptactie][hdinsight-cluster-customize].</span><span class="sxs-lookup"><span data-stu-id="c42f2-146">For more information, see [Customize HDInsight clusters using Script Action][hdinsight-cluster-customize].</span></span>

> [!NOTE]
> <span data-ttu-id="c42f2-147">Hallo-voorbeeldscripts werkt alleen met HDInsight-cluster versie 3.1 of hoger.</span><span class="sxs-lookup"><span data-stu-id="c42f2-147">hello sample scripts work only with HDInsight cluster version 3.1 or above.</span></span> <span data-ttu-id="c42f2-148">Zie voor meer informatie over de versies van HDInsight-cluster, [versies van HDInsight-cluster](hdinsight-component-versioning.md).</span><span class="sxs-lookup"><span data-stu-id="c42f2-148">For more information on HDInsight cluster versions, see [HDInsight cluster versions](hdinsight-component-versioning.md).</span></span>
>
>

## <a name="helper-methods-for-custom-scripts"></a><span data-ttu-id="c42f2-149">Help-methoden voor aangepaste scripts</span><span class="sxs-lookup"><span data-stu-id="c42f2-149">Helper methods for custom scripts</span></span>
<span data-ttu-id="c42f2-150">Script actie Help-methoden zijn hulpprogramma's die u gebruiken kunt bij het schrijven van aangepaste scripts.</span><span class="sxs-lookup"><span data-stu-id="c42f2-150">Script Action helper methods are utilities that you can use while writing custom scripts.</span></span> <span data-ttu-id="c42f2-151">Deze methoden zijn gedefinieerd in [https://hdiconfigactions.blob.core.windows.net/configactionmodulev05/HDInsightUtilities-v05.psm1](https://hdiconfigactions.blob.core.windows.net/configactionmodulev05/HDInsightUtilities-v05.psm1), en kan worden opgenomen in uw scripts met Hallo voorbeeld te volgen:</span><span class="sxs-lookup"><span data-stu-id="c42f2-151">These methods are defined in [https://hdiconfigactions.blob.core.windows.net/configactionmodulev05/HDInsightUtilities-v05.psm1](https://hdiconfigactions.blob.core.windows.net/configactionmodulev05/HDInsightUtilities-v05.psm1), and can be included in your scripts using hello following sample:</span></span>

    # Download config action module from a well-known directory.
    $CONFIGACTIONURI = "https://hdiconfigactions.blob.core.windows.net/configactionmodulev05/HDInsightUtilities-v05.psm1";
    $CONFIGACTIONMODULE = "C:\apps\dist\HDInsightUtilities.psm1";
    $webclient = New-Object System.Net.WebClient;
    $webclient.DownloadFile($CONFIGACTIONURI, $CONFIGACTIONMODULE);

    # (TIP) Import config action helper method module toomake writing config action easy.
    if (Test-Path ($CONFIGACTIONMODULE))
    {
        Import-Module $CONFIGACTIONMODULE;
    }
    else
    {
        Write-Output "Failed tooload HDInsightUtilities module, exiting ...";
        exit;
    }

<span data-ttu-id="c42f2-152">Hier volgen Hallo Help-methoden die worden geleverd door dit script:</span><span class="sxs-lookup"><span data-stu-id="c42f2-152">Here are hello helper methods that are provided by this script:</span></span>

| <span data-ttu-id="c42f2-153">Help-methode</span><span class="sxs-lookup"><span data-stu-id="c42f2-153">Helper method</span></span> | <span data-ttu-id="c42f2-154">Beschrijving</span><span class="sxs-lookup"><span data-stu-id="c42f2-154">Description</span></span> |
| --- | --- |
| <span data-ttu-id="c42f2-155">**Opslaan HDIFile**</span><span class="sxs-lookup"><span data-stu-id="c42f2-155">**Save-HDIFile**</span></span> |<span data-ttu-id="c42f2-156">Download een bestand van Hallo opgegeven Uniform Resource Identifier (URI) tooa locatie op Hallo lokale schijf die is gekoppeld aan het cluster toegewezen toohello hello Azure VM-knooppunten.</span><span class="sxs-lookup"><span data-stu-id="c42f2-156">Download a file from hello specified Uniform Resource Identifier (URI) tooa location on hello local disk that is associated with hello Azure VM node assigned toohello cluster.</span></span> |
| <span data-ttu-id="c42f2-157">**Vouw HDIZippedFile**</span><span class="sxs-lookup"><span data-stu-id="c42f2-157">**Expand-HDIZippedFile**</span></span> |<span data-ttu-id="c42f2-158">Een ZIP-bestand uitpakken.</span><span class="sxs-lookup"><span data-stu-id="c42f2-158">Unzip a zipped file.</span></span> |
| <span data-ttu-id="c42f2-159">**Aanroepen HDICmdScript**</span><span class="sxs-lookup"><span data-stu-id="c42f2-159">**Invoke-HDICmdScript**</span></span> |<span data-ttu-id="c42f2-160">Een script uitvoeren vanaf cmd.exe.</span><span class="sxs-lookup"><span data-stu-id="c42f2-160">Run a script from cmd.exe.</span></span> |
| <span data-ttu-id="c42f2-161">**Schrijven HDILog**</span><span class="sxs-lookup"><span data-stu-id="c42f2-161">**Write-HDILog**</span></span> |<span data-ttu-id="c42f2-162">Uitvoer van Hallo aangepast script gebruikt voor de scriptactie van een schrijven.</span><span class="sxs-lookup"><span data-stu-id="c42f2-162">Write output from hello custom script used for a script action.</span></span> |
| <span data-ttu-id="c42f2-163">**Get-Services**</span><span class="sxs-lookup"><span data-stu-id="c42f2-163">**Get-Services**</span></span> |<span data-ttu-id="c42f2-164">Ophalen van een lijst met services die worden uitgevoerd op de machine Hallo waar Hallo script wordt uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="c42f2-164">Get a list of services running on hello machine where hello script executes.</span></span> |
| <span data-ttu-id="c42f2-165">**Get-Service**</span><span class="sxs-lookup"><span data-stu-id="c42f2-165">**Get-Service**</span></span> |<span data-ttu-id="c42f2-166">Met de Hallo specifieke servicenaam als invoer, krijgt u gedetailleerde informatie voor een specifieke service (servicenaam, proces-ID, status, enz.) op Hallo machine waar Hallo script wordt uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="c42f2-166">With hello specific service name as input, get detailed information for a specific service (service name, process ID, state, etc.) on hello machine where hello script executes.</span></span> |
| <span data-ttu-id="c42f2-167">**Get-HDIServices**</span><span class="sxs-lookup"><span data-stu-id="c42f2-167">**Get-HDIServices**</span></span> |<span data-ttu-id="c42f2-168">Haal een lijst van HDInsight-services die worden uitgevoerd op de computer Hallo waar Hallo script wordt uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="c42f2-168">Get a list of HDInsight services running on hello computer where hello script executes.</span></span> |
| <span data-ttu-id="c42f2-169">**Get-HDIService**</span><span class="sxs-lookup"><span data-stu-id="c42f2-169">**Get-HDIService**</span></span> |<span data-ttu-id="c42f2-170">Met de Hallo specifieke HDInsight servicenaam als invoer, krijgt u gedetailleerde informatie voor een specifieke service (servicenaam, proces-ID, status, enz.) op Hallo machine waar Hallo script wordt uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="c42f2-170">With hello specific HDInsight service name as input, get detailed information for a specific service (service name, process ID, state, etc.) on hello machine where hello script executes.</span></span> |
| <span data-ttu-id="c42f2-171">**Get-ServicesRunning**</span><span class="sxs-lookup"><span data-stu-id="c42f2-171">**Get-ServicesRunning**</span></span> |<span data-ttu-id="c42f2-172">Ophalen van een lijst met services die worden uitgevoerd op Hallo computer waar Hallo script wordt uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="c42f2-172">Get a list of services that are running on hello computer where hello script executes.</span></span> |
| <span data-ttu-id="c42f2-173">**Get-ServiceRunning**</span><span class="sxs-lookup"><span data-stu-id="c42f2-173">**Get-ServiceRunning**</span></span> |<span data-ttu-id="c42f2-174">Controleer of een specifieke service (met de naam) wordt uitgevoerd op de computer Hallo waar Hallo script wordt uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="c42f2-174">Check if a specific service (by name) is running on hello computer where hello script executes.</span></span> |
| <span data-ttu-id="c42f2-175">**Get-HDIServicesRunning**</span><span class="sxs-lookup"><span data-stu-id="c42f2-175">**Get-HDIServicesRunning**</span></span> |<span data-ttu-id="c42f2-176">Haal een lijst van HDInsight-services die worden uitgevoerd op de computer Hallo waar Hallo script wordt uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="c42f2-176">Get a list of HDInsight services running on hello computer where hello script executes.</span></span> |
| <span data-ttu-id="c42f2-177">**Get-HDIServiceRunning**</span><span class="sxs-lookup"><span data-stu-id="c42f2-177">**Get-HDIServiceRunning**</span></span> |<span data-ttu-id="c42f2-178">Controleer of een specifieke HDInsight-service (met de naam) wordt uitgevoerd op de computer Hallo waar Hallo script wordt uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="c42f2-178">Check if a specific HDInsight service (by name) is running on hello computer where hello script executes.</span></span> |
| <span data-ttu-id="c42f2-179">**Get-HDIHadoopVersion**</span><span class="sxs-lookup"><span data-stu-id="c42f2-179">**Get-HDIHadoopVersion**</span></span> |<span data-ttu-id="c42f2-180">Hallo-versie van Hadoop geïnstalleerd op Hallo computer waar Hallo script wordt uitgevoerd krijgen.</span><span class="sxs-lookup"><span data-stu-id="c42f2-180">Get hello version of Hadoop installed on hello computer where hello script executes.</span></span> |
| <span data-ttu-id="c42f2-181">**Test IsHDIHeadNode**</span><span class="sxs-lookup"><span data-stu-id="c42f2-181">**Test-IsHDIHeadNode**</span></span> |<span data-ttu-id="c42f2-182">Controleer of Hallo computer waar Hallo script wordt uitgevoerd een hoofdknooppunt.</span><span class="sxs-lookup"><span data-stu-id="c42f2-182">Check if hello computer where hello script executes is a head node.</span></span> |
| <span data-ttu-id="c42f2-183">**Test IsActiveHDIHeadNode**</span><span class="sxs-lookup"><span data-stu-id="c42f2-183">**Test-IsActiveHDIHeadNode**</span></span> |<span data-ttu-id="c42f2-184">Controleer of Hallo computer waar Hallo script wordt uitgevoerd een actieve hoofdknooppunt is.</span><span class="sxs-lookup"><span data-stu-id="c42f2-184">Check if hello computer where hello script executes is an active head node.</span></span> |
| <span data-ttu-id="c42f2-185">**Test IsHDIDataNode**</span><span class="sxs-lookup"><span data-stu-id="c42f2-185">**Test-IsHDIDataNode**</span></span> |<span data-ttu-id="c42f2-186">Controleer of Hallo computer waar Hallo script wordt uitgevoerd een gegevensknooppunt is.</span><span class="sxs-lookup"><span data-stu-id="c42f2-186">Check if hello computer where hello script executes is a data node.</span></span> |
| <span data-ttu-id="c42f2-187">**Bewerken HDIConfigFile**</span><span class="sxs-lookup"><span data-stu-id="c42f2-187">**Edit-HDIConfigFile**</span></span> |<span data-ttu-id="c42f2-188">Hallo config bestanden hive-site.xml, core site.xml, hdfs-site.xml, mapred site.xml of yarn-site.xml bewerken.</span><span class="sxs-lookup"><span data-stu-id="c42f2-188">Edit hello config files hive-site.xml, core-site.xml, hdfs-site.xml, mapred-site.xml, or yarn-site.xml.</span></span> |

## <a name="best-practices-for-script-development"></a><span data-ttu-id="c42f2-189">Aanbevolen procedures voor het ontwikkelen van scripts</span><span class="sxs-lookup"><span data-stu-id="c42f2-189">Best practices for script development</span></span>
<span data-ttu-id="c42f2-190">Wanneer u een aangepast script voor een HDInsight-cluster ontwikkelt, zijn er enkele aanbevolen procedures tookeep rekening:</span><span class="sxs-lookup"><span data-stu-id="c42f2-190">When you develop a custom script for an HDInsight cluster, there are several best practices tookeep in mind:</span></span>

* <span data-ttu-id="c42f2-191">Controle op Hallo Hadoop-versie</span><span class="sxs-lookup"><span data-stu-id="c42f2-191">Check for hello Hadoop version</span></span>

    <span data-ttu-id="c42f2-192">Alleen HDInsight versie 3.1 (Hadoop 2.4) en hoger ondersteuning met scriptactie tooinstall aangepaste onderdelen op een cluster.</span><span class="sxs-lookup"><span data-stu-id="c42f2-192">Only HDInsight version 3.1 (Hadoop 2.4) and above support using Script Action tooinstall custom components on a cluster.</span></span> <span data-ttu-id="c42f2-193">In een script, moet u Hallo **Get-HDIHadoopVersion** helper methode toocheck hello Hadoop versie voordat u doorgaat met de andere taken uitvoeren in Hallo-script.</span><span class="sxs-lookup"><span data-stu-id="c42f2-193">In your custom script, you must use hello **Get-HDIHadoopVersion** helper method toocheck hello Hadoop version before proceeding with performing other tasks in hello script.</span></span>
* <span data-ttu-id="c42f2-194">Geef stabiel koppelingen tooscript resources</span><span class="sxs-lookup"><span data-stu-id="c42f2-194">Provide stable links tooscript resources</span></span>

    <span data-ttu-id="c42f2-195">Gebruikers Zorg ervoor dat alle Hallo scripts en andere artefacten in Hallo aanpassing van een cluster gebruikt beschikbaar tijdens de levensduur Hallo van Hallo cluster blijven en dat Hallo versies van deze bestanden niet voor de duur van Hallo wijzigen.</span><span class="sxs-lookup"><span data-stu-id="c42f2-195">Users should make sure that all hello scripts and other artifacts used in hello customization of a cluster remain available throughout hello lifetime of hello cluster and that hello versions of these files do not change for hello duration.</span></span> <span data-ttu-id="c42f2-196">Deze resources zijn vereist als Hallo teruggezet van knooppunten in cluster Hallo vereist is.</span><span class="sxs-lookup"><span data-stu-id="c42f2-196">These resources are required if hello reimaging of nodes in hello cluster is required.</span></span> <span data-ttu-id="c42f2-197">Hallo aanbevolen procedure is toodownload en alles in een opslagaccount die gebruikersbesturingselementen Hallo gearchiveerd.</span><span class="sxs-lookup"><span data-stu-id="c42f2-197">hello best practice is toodownload and archive everything in a Storage account that hello user controls.</span></span> <span data-ttu-id="c42f2-198">Dit kan zijn standaardopslagaccount hello of een van de Hallo extra opslagaccounts op Hallo moment van implementatie voor een cluster met aangepaste opgegeven.</span><span class="sxs-lookup"><span data-stu-id="c42f2-198">This can be hello default Storage account or any of hello additional Storage accounts specified at hello time of deployment for a customized cluster.</span></span>
    <span data-ttu-id="c42f2-199">Hallo Spark en R aangepast cluster voorbeelden opgegeven in de documentatie Hallo bijvoorbeeld we hebben aangebracht een lokale kopie van het Hallo-resources in dit opslagaccount: https://hdiconfigactions.blob.core.windows.net/.</span><span class="sxs-lookup"><span data-stu-id="c42f2-199">In hello Spark and R customized cluster samples provided in hello documentation, for example, we have made a local copy of hello resources in this Storage account: https://hdiconfigactions.blob.core.windows.net/.</span></span>
* <span data-ttu-id="c42f2-200">Zorg ervoor dat Hallo cluster aanpassing script idempotent</span><span class="sxs-lookup"><span data-stu-id="c42f2-200">Ensure that hello cluster customization script is idempotent</span></span>

    <span data-ttu-id="c42f2-201">U moet verwachten dat Hallo knooppunten van een HDInsight-cluster wordt teruggezet tijdens de levensduur van de Hallo-cluster.</span><span class="sxs-lookup"><span data-stu-id="c42f2-201">You must expect that hello nodes of an HDInsight cluster is reimaged during hello cluster lifetime.</span></span> <span data-ttu-id="c42f2-202">Hallo cluster aanpassing script wordt uitgevoerd wanneer de installatiekopie van een cluster wordt hersteld.</span><span class="sxs-lookup"><span data-stu-id="c42f2-202">hello cluster customization script is run whenever a cluster is reimaged.</span></span> <span data-ttu-id="c42f2-203">Dit script moet worden ontworpen toobe idempotent in Hallo zin dat bij teruggezet, Hallo script moet ervoor zorgen dat cluster Hallo toohello die dezelfde staat waarin deze zich bevond vlak nadat de eerste keer wanneer Hallo-cluster in eerste instantie was voor Hallo uitvoerde Hallo script aangepaste wordt geretourneerd gemaakt.</span><span class="sxs-lookup"><span data-stu-id="c42f2-203">This script must be designed toobe idempotent in hello sense that upon reimaging, hello script should ensure that hello cluster is returned toohello same customized state that it was in just after hello script ran for hello first time when hello cluster was initially created.</span></span> <span data-ttu-id="c42f2-204">Bijvoorbeeld als een aangepast script een toepassing op D:\AppLocation geïnstalleerd op het eerst wordt uitgevoerd, wordt bij elke volgende uitvoeren, bij teruggezet, Hallo script moet controleren of de toepassing hello op Hallo D:\AppLocation locatie voordat u doorgaat met andere bestaat de stappen in Hallo-script.</span><span class="sxs-lookup"><span data-stu-id="c42f2-204">For example, if a custom script installed an application at D:\AppLocation on its first run, then on each subsequent run, upon reimaging, hello script should check whether hello application exists at hello D:\AppLocation location before proceeding with other steps in hello script.</span></span>
* <span data-ttu-id="c42f2-205">Aangepaste onderdelen installeren op Hallo optimale locatie</span><span class="sxs-lookup"><span data-stu-id="c42f2-205">Install custom components in hello optimal location</span></span>

    <span data-ttu-id="c42f2-206">Wanneer de clusterknooppunten worden teruggezet, kunnen Hallo C:\ resource station en D:\ systeemstation worden geformatteerd, Hallo verlies van gegevens en toepassingen die was geïnstalleerd op deze schijven.</span><span class="sxs-lookup"><span data-stu-id="c42f2-206">When cluster nodes are reimaged, hello C:\ resource drive and D:\ system drive can be reformatted, resulting in hello loss of data and applications that had been installed on those drives.</span></span> <span data-ttu-id="c42f2-207">Dit kan ook gebeuren als een virtuele Azure-machine (VM)-knooppunt dat deel uitmaakt van Hallo cluster uitvalt en wordt vervangen door een nieuw knooppunt.</span><span class="sxs-lookup"><span data-stu-id="c42f2-207">This could also happen if an Azure virtual machine (VM) node that is part of hello cluster goes down and is replaced by a new node.</span></span> <span data-ttu-id="c42f2-208">U kunt onderdelen installeren op station D:\ Hallo of in Hallo C:\apps locatie op Hallo-cluster.</span><span class="sxs-lookup"><span data-stu-id="c42f2-208">You can install components on hello D:\ drive or in hello C:\apps location on hello cluster.</span></span> <span data-ttu-id="c42f2-209">Alle andere locaties op Hallo station C:\ zijn gereserveerd.</span><span class="sxs-lookup"><span data-stu-id="c42f2-209">All other locations on hello C:\ drive are reserved.</span></span> <span data-ttu-id="c42f2-210">Hallo-locatie waar toepassingen of -bibliotheken geïnstalleerd in Hallo cluster aanpassing script toobe zijn opgeven.</span><span class="sxs-lookup"><span data-stu-id="c42f2-210">Specify hello location where applications or libraries are toobe installed in hello cluster customization script.</span></span>
* <span data-ttu-id="c42f2-211">Zorg ervoor dat hoge beschikbaarheid van Hallo cluster-architectuur</span><span class="sxs-lookup"><span data-stu-id="c42f2-211">Ensure high availability of hello cluster architecture</span></span>

    <span data-ttu-id="c42f2-212">HDInsight is een actief / passief-architectuur voor hoge beschikbaarheid, in welke één hoofdknooppunt is in de actieve modus (waarbij Hallo HDInsight services worden uitgevoerd) en Hallo andere hoofdknooppunt in standby-modus (in welke HDInsight services niet worden uitgevoerd).</span><span class="sxs-lookup"><span data-stu-id="c42f2-212">HDInsight has an active-passive architecture for high availability, in which one head node is in active mode (where hello HDInsight services are running) and hello other head node is in standby mode (in which HDInsight services are not running).</span></span> <span data-ttu-id="c42f2-213">Hallo knooppunten overschakelen actieve en passieve modus als de HDInsight-services worden onderbroken.</span><span class="sxs-lookup"><span data-stu-id="c42f2-213">hello nodes switch active and passive modes if HDInsight services are interrupted.</span></span> <span data-ttu-id="c42f2-214">Als een scriptactie gebruikte tooinstall services op beide hoofdknooppunten voor hoge beschikbaarheid, houd er rekening mee dat Hallo HDInsight failover-mechanisme niet kunnen tooautomatically mislukken via deze services gebruiker geïnstalleerd.</span><span class="sxs-lookup"><span data-stu-id="c42f2-214">If a script action is used tooinstall services on both head nodes for high availability, note that hello HDInsight failover mechanism is not able tooautomatically fail over these user-installed services.</span></span> <span data-ttu-id="c42f2-215">Gebruiker geïnstalleerd dus services op hoofdknooppunten HDInsight die verwachte toobe maximaal beschikbare moeten hebben hun eigen mechanisme voor failover als deze in de modus actief-passief of in de actieve-actieve modus.</span><span class="sxs-lookup"><span data-stu-id="c42f2-215">So user-installed services on HDInsight head nodes that are expected toobe highly available must either have their own failover mechanism if in active-passive mode or be in active-active mode.</span></span>

    <span data-ttu-id="c42f2-216">Een HDInsight-scriptactie-opdracht wordt uitgevoerd op beide hoofdknooppunten wanneer Hallo hoofdknooppunt rol is opgegeven als een waarde in Hallo *ClusterRoleCollection* parameter.</span><span class="sxs-lookup"><span data-stu-id="c42f2-216">An HDInsight Script Action command runs on both head nodes when hello head-node role is specified as a value in hello *ClusterRoleCollection* parameter.</span></span> <span data-ttu-id="c42f2-217">Wanneer u een aangepast script ontwerpt, zorg er dus dat uw script hoogte van deze installatie is.</span><span class="sxs-lookup"><span data-stu-id="c42f2-217">So when you design a custom script, make sure that your script is aware of this setup.</span></span> <span data-ttu-id="c42f2-218">U moet niet uitvoeren op problemen waar hello dezelfde services zijn geïnstalleerd en gestart op zowel de hoofdknooppunten Hallo en ze met elkaar concurreren.</span><span class="sxs-lookup"><span data-stu-id="c42f2-218">You should not run into problems where hello same services are installed and started on both of hello head nodes and they end up competing with each other.</span></span> <span data-ttu-id="c42f2-219">Let op dat gegevens niet verloren tijdens teruggezet, zodat software is geïnstalleerd via een scriptactie toobe robuuste toosuch gebeurtenissen heeft.</span><span class="sxs-lookup"><span data-stu-id="c42f2-219">Also, be aware that data is lost during reimaging, so software installed via Script Action has toobe resilient toosuch events.</span></span> <span data-ttu-id="c42f2-220">Toepassingen moeten worden ontworpen toowork met maximaal beschikbare gegevens die wordt gedistribueerd over veel knooppunten.</span><span class="sxs-lookup"><span data-stu-id="c42f2-220">Applications should be designed toowork with highly available data that is distributed across many nodes.</span></span> <span data-ttu-id="c42f2-221">Houd er rekening mee dat wel 1/5 Hallo knooppunten in een cluster kunnen worden hersteld met een installatiekopie op Hallo hetzelfde moment.</span><span class="sxs-lookup"><span data-stu-id="c42f2-221">Note that as many as 1/5 of hello nodes in a cluster can be reimaged at hello same time.</span></span>
* <span data-ttu-id="c42f2-222">Hallo aangepaste onderdelen toouse Azure Blob-opslag configureren</span><span class="sxs-lookup"><span data-stu-id="c42f2-222">Configure hello custom components toouse Azure Blob storage</span></span>

    <span data-ttu-id="c42f2-223">Hallo aangepaste onderdelen die u op de clusterknooppunten Hallo installeert wellicht een standaard configuratie toouse Hadoop Distributed File System (HDFS) opslag.</span><span class="sxs-lookup"><span data-stu-id="c42f2-223">hello custom components that you install on hello cluster nodes might have a default configuration toouse Hadoop Distributed File System (HDFS) storage.</span></span> <span data-ttu-id="c42f2-224">In plaats daarvan moet u Hallo configuratie toouse Azure Blob-opslag wijzigen.</span><span class="sxs-lookup"><span data-stu-id="c42f2-224">You should change hello configuration toouse Azure Blob storage instead.</span></span> <span data-ttu-id="c42f2-225">Terugzetten van een cluster de installatiekopie, Hallo HDFS-bestandssysteem geformatteerd opgehaald en verliest u gegevens die is opgeslagen.</span><span class="sxs-lookup"><span data-stu-id="c42f2-225">On a cluster reimage, hello HDFS file system gets formatted and you would lose any data that is stored there.</span></span> <span data-ttu-id="c42f2-226">Azure Blob storage in plaats daarvan zorgt ervoor dat uw gegevens worden bewaard.</span><span class="sxs-lookup"><span data-stu-id="c42f2-226">Using Azure Blob storage instead ensures that your data is retained.</span></span>

## <a name="common-usage-patterns"></a><span data-ttu-id="c42f2-227">Algemene gebruikspatronen</span><span class="sxs-lookup"><span data-stu-id="c42f2-227">Common usage patterns</span></span>
<span data-ttu-id="c42f2-228">Deze sectie bevat richtlijnen over het implementeren van een aantal Hallo algemene gebruikspatronen die u tegenkomen kunt tijdens het schrijven van uw eigen aangepaste scripts.</span><span class="sxs-lookup"><span data-stu-id="c42f2-228">This section provides guidance on implementing some of hello common usage patterns that you might run into while writing your own custom script.</span></span>

### <a name="configure-environment-variables"></a><span data-ttu-id="c42f2-229">Omgevingsvariabelen configureren</span><span class="sxs-lookup"><span data-stu-id="c42f2-229">Configure environment variables</span></span>
<span data-ttu-id="c42f2-230">Vaak in script actie ontwikkeling, u denkt dat Hallo moet tooset omgevingsvariabelen.</span><span class="sxs-lookup"><span data-stu-id="c42f2-230">Often in script action development, you feel hello need tooset environment variables.</span></span> <span data-ttu-id="c42f2-231">Een meest waarschijnlijke scenario is bijvoorbeeld: wanneer u een binair bestand vanaf een externe site downloaden op Hallo-cluster installeren en voeg Hallo-locatie van waar het geïnstalleerde tooyour 'PATH' omgevingsvariabele is.</span><span class="sxs-lookup"><span data-stu-id="c42f2-231">For instance, a most likely scenario is when you download a binary from an external site, install it on hello cluster, and add hello location of where it is installed tooyour ‘PATH’ environment variable.</span></span> <span data-ttu-id="c42f2-232">Hallo volgende codefragment ziet u hoe de omgevingsvariabelen tooset in Hallo aangepast script.</span><span class="sxs-lookup"><span data-stu-id="c42f2-232">hello following snippet shows you how tooset environment variables in hello custom script.</span></span>

    Write-HDILog "Starting environment variable setting at: $(Get-Date)";
    [Environment]::SetEnvironmentVariable('MDS_RUNNER_CUSTOM_CLUSTER', 'true', 'Machine');

<span data-ttu-id="c42f2-233">Deze instructie stelt de omgevingsvariabele Hallo **MDS_RUNNER_CUSTOM_CLUSTER** toohello waarde 'true' en ook sets Hallo bereik van deze variabele toobe alle computers.</span><span class="sxs-lookup"><span data-stu-id="c42f2-233">This statement sets hello environment variable **MDS_RUNNER_CUSTOM_CLUSTER** toohello value 'true' and also sets hello scope of this variable toobe machine-wide.</span></span> <span data-ttu-id="c42f2-234">Soms is het belangrijk dat de omgevingsvariabelen worden ingesteld op Hallo geschikte bereik – computer of gebruiker.</span><span class="sxs-lookup"><span data-stu-id="c42f2-234">At times it is important that environment variables are set at hello appropriate scope – machine or user.</span></span> <span data-ttu-id="c42f2-235">Raadpleeg [hier] [ 1] voor meer informatie over het instellen van omgevingsvariabelen.</span><span class="sxs-lookup"><span data-stu-id="c42f2-235">Refer [here][1] for more information on setting environment variables.</span></span>

### <a name="access-toolocations-where-hello-custom-scripts-are-stored"></a><span data-ttu-id="c42f2-236">Toegang tot toolocations waar Hallo aangepaste scripts worden opgeslagen</span><span class="sxs-lookup"><span data-stu-id="c42f2-236">Access toolocations where hello custom scripts are stored</span></span>
<span data-ttu-id="c42f2-237">Scripts die worden gebruikt toocustomize een cluster moet tooeither zich in Hallo storage-standaardaccount voor Hallo cluster of in een openbare alleen-lezen container op andere storage-account.</span><span class="sxs-lookup"><span data-stu-id="c42f2-237">Scripts used toocustomize a cluster needs tooeither be in hello default storage account for hello cluster or in a public read-only container on any other storage account.</span></span> <span data-ttu-id="c42f2-238">Als uw script toegang heeft tot resources die zich ergens anders bevindt deze toobe in een openbaar toegankelijk moeten zijn (ten minste openbare alleen-lezen).</span><span class="sxs-lookup"><span data-stu-id="c42f2-238">If your script accesses resources located elsewhere these need toobe in a publicly accessible (at least public read-only).</span></span> <span data-ttu-id="c42f2-239">Voor instantie mogelijk tooaccess een bestand en sla het Hallo SaveFile HDI-opdracht.</span><span class="sxs-lookup"><span data-stu-id="c42f2-239">For instance you might want tooaccess a file and save it using hello SaveFile-HDI command.</span></span>

    Save-HDIFile -SrcUri 'https://somestorageaccount.blob.core.windows.net/somecontainer/some-file.jar' -DestFile 'C:\apps\dist\hadoop-2.4.0.2.1.9.0-2196\share\hadoop\mapreduce\some-file.jar'

<span data-ttu-id="c42f2-240">In dit voorbeeld moet u ervoor zorgen dat container Hallo 'somecontainer' in de storage-account 'somestorageaccount' openbaar toegankelijk is.</span><span class="sxs-lookup"><span data-stu-id="c42f2-240">In this example, you must ensure that hello container 'somecontainer' in storage account 'somestorageaccount' is publicly accessible.</span></span> <span data-ttu-id="c42f2-241">Anders Hallo script genereert een uitzondering 'Niet gevonden' en mislukken.</span><span class="sxs-lookup"><span data-stu-id="c42f2-241">Otherwise, hello script throws a ‘Not Found’ exception and fail.</span></span>

### <a name="pass-parameters-toohello-add-azurermhdinsightscriptaction-cmdlet"></a><span data-ttu-id="c42f2-242">Parameters toohello toevoegen AzureRmHDInsightScriptAction cmdlet doorgeven</span><span class="sxs-lookup"><span data-stu-id="c42f2-242">Pass parameters toohello Add-AzureRmHDInsightScriptAction cmdlet</span></span>
<span data-ttu-id="c42f2-243">toopass meerdere parameters toohello toevoegen AzureRmHDInsightScriptAction cmdlet, moet u tooformat Hallo tekenreeks waarde toocontain alle parameters voor Hallo-script.</span><span class="sxs-lookup"><span data-stu-id="c42f2-243">toopass multiple parameters toohello Add-AzureRmHDInsightScriptAction cmdlet, you need tooformat hello string value toocontain all parameters for hello script.</span></span> <span data-ttu-id="c42f2-244">Bijvoorbeeld:</span><span class="sxs-lookup"><span data-stu-id="c42f2-244">For example:</span></span>

    "-CertifcateUri wasb:///abc.pfx -CertificatePassword 123456 -InstallFolderName MyFolder"

<span data-ttu-id="c42f2-245">of</span><span class="sxs-lookup"><span data-stu-id="c42f2-245">or</span></span>

    $parameters = '-Parameters "{0};{1};{2}"' -f $CertificateName,$certUriWithSasToken,$CertificatePassword


### <a name="throw-exception-for-failed-cluster-deployment"></a><span data-ttu-id="c42f2-246">Uitzondering voor mislukte Clusterimplementatie</span><span class="sxs-lookup"><span data-stu-id="c42f2-246">Throw exception for failed cluster deployment</span></span>
<span data-ttu-id="c42f2-247">Als u wilt dat tooget nauwkeurig Hallo feit gemeld dat cluster aanpassing is niet gelukt zoals verwacht, maar belangrijke toothrow is een uitzondering maken van het cluster Hallo mislukken.</span><span class="sxs-lookup"><span data-stu-id="c42f2-247">If you want tooget accurately notified of hello fact that cluster customization did not succeed as expected, it is important toothrow an exception and fail hello cluster creation.</span></span> <span data-ttu-id="c42f2-248">U kan bijvoorbeeld tooprocess een bestand wilt als deze bestaat en verwerken Hallo foutaanvraag waar Hallo bestand niet bestaat.</span><span class="sxs-lookup"><span data-stu-id="c42f2-248">For instance, you might want tooprocess a file if it exists and handle hello error case where hello file does not exist.</span></span> <span data-ttu-id="c42f2-249">Dit zou ervoor dat Hallo script wordt probleemloos afgesloten en Hallo staat van Hallo cluster goed bekend is.</span><span class="sxs-lookup"><span data-stu-id="c42f2-249">This would ensure that hello script exits gracefully and hello state of hello cluster is correctly known.</span></span> <span data-ttu-id="c42f2-250">Hallo volgende fragment geeft een voorbeeld van hoe tooachieve dit:</span><span class="sxs-lookup"><span data-stu-id="c42f2-250">hello following snippet gives an example of how tooachieve this:</span></span>

    If(Test-Path($SomePath)) {
        #Process file in some way
    } else {
        # File does not exist; handle error case
        # Print error message
    exit
    }

<span data-ttu-id="c42f2-251">In dit fragment als Hallo-bestand niet bestaat, zou dit leiden tooa status Hallo script daadwerkelijk wordt afgesloten zonder problemen na het afdrukken van het foutbericht Hallo waarbij Hallo cluster actief is, ervan uitgaande dat deze ' ' voltooid cluster aanpassing is bereikt.</span><span class="sxs-lookup"><span data-stu-id="c42f2-251">In this snippet, if hello file did not exist, it would lead tooa state where hello script actually exits gracefully after printing hello error message, and hello cluster reaches running state assuming it "successfully" completed cluster customization process.</span></span> <span data-ttu-id="c42f2-252">Als u wilt dat toobe nauwkeurig Hallo feit gemeld dat cluster aanpassing in principe kan niet zoals verwacht vanwege een ontbrekend bestand, geschiktere toothrow is een uitzondering en Hallo cluster aanpassing stap mislukt.</span><span class="sxs-lookup"><span data-stu-id="c42f2-252">If you want toobe accurately notified of hello fact that cluster customization essentially did not succeed as expected because of a missing file, it is more appropriate toothrow an exception and fail hello cluster customization step.</span></span> <span data-ttu-id="c42f2-253">tooachieve dit moet u Hallo voorbeeld codefragment in plaats daarvan te volgen.</span><span class="sxs-lookup"><span data-stu-id="c42f2-253">tooachieve this you must use hello following sample code snippet instead.</span></span>

    If(Test-Path($SomePath)) {
        #Process file in some way
    } else {
        # File does not exist; handle error case
        # Print error message
    throw
    }


## <a name="checklist-for-deploying-a-script-action"></a><span data-ttu-id="c42f2-254">Controlelijst voor het implementeren van een scriptactie</span><span class="sxs-lookup"><span data-stu-id="c42f2-254">Checklist for deploying a script action</span></span>
<span data-ttu-id="c42f2-255">Hier volgen Hallo stappen werd bij het voorbereiden van toodeploy deze scripts:</span><span class="sxs-lookup"><span data-stu-id="c42f2-255">Here are hello steps we took when preparing toodeploy these scripts:</span></span>

1. <span data-ttu-id="c42f2-256">Hallo-bestanden met aangepaste scripts op een locatie die toegankelijk is voor de clusterknooppunten Hallo tijdens de implementatie van Hallo plaatsen.</span><span class="sxs-lookup"><span data-stu-id="c42f2-256">Put hello files that contain hello custom scripts in a place that is accessible by hello cluster nodes during deployment.</span></span> <span data-ttu-id="c42f2-257">Dit kan zijn Hallo standaard of extra opslagaccounts bij Hallo van implementatie van het cluster of een andere openbaar toegankelijke storage-container worden opgegeven.</span><span class="sxs-lookup"><span data-stu-id="c42f2-257">This can be any of hello default or additional Storage accounts specified at hello time of cluster deployment, or any other publicly accessible storage container.</span></span>
2. <span data-ttu-id="c42f2-258">Toevoegen van controles in scripts toomake zeker van te zijn dat ze idempotently, uitvoeren zodat Hallo script kan meerdere keren worden uitgevoerd op Hallo hetzelfde knooppunt.</span><span class="sxs-lookup"><span data-stu-id="c42f2-258">Add checks into scripts toomake sure that they execute idempotently, so that hello script can be executed multiple times on hello same node.</span></span>
3. <span data-ttu-id="c42f2-259">Gebruik Hallo **Write-Output** Azure PowerShell-cmdlet tooprint tooSTDOUT, evenals STDERR.</span><span class="sxs-lookup"><span data-stu-id="c42f2-259">Use hello **Write-Output** Azure PowerShell cmdlet tooprint tooSTDOUT as well as STDERR.</span></span> <span data-ttu-id="c42f2-260">Gebruik geen **Write-Host**.</span><span class="sxs-lookup"><span data-stu-id="c42f2-260">Do not use **Write-Host**.</span></span>
4. <span data-ttu-id="c42f2-261">Gebruik een tijdelijke map, zoals $env: TEMP tookeep Hallo gedownloade bestand dat wordt gebruikt door Hallo scripts en vervolgens opschonen van nadat scripts hebt uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="c42f2-261">Use a temporary file folder, such as $env:TEMP, tookeep hello downloaded file used by hello scripts and then clean them up after scripts have executed.</span></span>
5. <span data-ttu-id="c42f2-262">Aangepaste software alleen op D:\ of C:\apps installeren.</span><span class="sxs-lookup"><span data-stu-id="c42f2-262">Install custom software only at D:\ or C:\apps.</span></span> <span data-ttu-id="c42f2-263">Andere locaties op Hallo station C: mag niet worden gebruikt als deze gereserveerd zijn.</span><span class="sxs-lookup"><span data-stu-id="c42f2-263">Other locations on hello C: drive should not be used as they are reserved.</span></span> <span data-ttu-id="c42f2-264">Houd er rekening mee dat bestanden op Hallo C:-schijf buiten de Hallo C:\apps map installeren leiden setup kopieerfouten tijdens reimages van Hallo-knooppunt tot kan.</span><span class="sxs-lookup"><span data-stu-id="c42f2-264">Note that installing files on hello C: drive outside of hello C:\apps folder may result in setup failures during reimages of hello node.</span></span>
6. <span data-ttu-id="c42f2-265">In de gebeurtenis Hallo OS-niveau instellingen of configuratiebestanden voor Hadoop-service zijn gewijzigd, kunt u toorestart HDInsight services zodat ze kunnen alle instellingen OS-niveau, zoals Hallo omgevingsvariabelen ingesteld in Hallo scripts ophalen.</span><span class="sxs-lookup"><span data-stu-id="c42f2-265">In hello event that OS-level settings or Hadoop service configuration files were changed, you may want toorestart HDInsight services so that they can pick up any OS-level settings, such as hello environment variables set in hello scripts.</span></span>

## <a name="debug-custom-scripts"></a><span data-ttu-id="c42f2-266">Fouten opsporen in aangepaste scripts</span><span class="sxs-lookup"><span data-stu-id="c42f2-266">Debug custom scripts</span></span>
<span data-ttu-id="c42f2-267">Hallo script foutenlogboeken zijn opgeslagen, samen met andere uitvoer, in Hallo Storage-standaardaccount die u hebt opgegeven voor de cluster Hallo bij het maken ervan.</span><span class="sxs-lookup"><span data-stu-id="c42f2-267">hello script error logs are stored, along with other output, in hello default Storage account that you specified for hello cluster at its creation.</span></span> <span data-ttu-id="c42f2-268">Hallo logboeken worden opgeslagen in een tabel met naam Hallo *u < \cluster-name-fragment >< \time-stamp > bestand*.</span><span class="sxs-lookup"><span data-stu-id="c42f2-268">hello logs are stored in a table with hello name *u<\cluster-name-fragment><\time-stamp>setuplog*.</span></span> <span data-ttu-id="c42f2-269">Dit zijn de cumulatieve logboeken die records uit alle Hallo knooppunten hoofdknooppunt en worker-knooppunten, op welke Hallo script wordt uitgevoerd in de cluster Hallo hebben.</span><span class="sxs-lookup"><span data-stu-id="c42f2-269">These are aggregated logs that have records from all of hello nodes (head node and worker nodes) on which hello script runs in hello cluster.</span></span>
<span data-ttu-id="c42f2-270">Een eenvoudige manier toocheck Hallo Logboeken is toouse HDInsight Tools voor Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="c42f2-270">An easy way toocheck hello logs is toouse HDInsight Tools for Visual Studio.</span></span> <span data-ttu-id="c42f2-271">Zie voor het installeren van extra Hallo [aan de slag met Visual Studio Hadoop-hulpprogramma's voor HDInsight](hdinsight-hadoop-visual-studio-tools-get-started.md#install-data-lake-tools-for-visual-studio)</span><span class="sxs-lookup"><span data-stu-id="c42f2-271">For installing hello tools, see [Get started using Visual Studio Hadoop tools for HDInsight](hdinsight-hadoop-visual-studio-tools-get-started.md#install-data-lake-tools-for-visual-studio)</span></span>

<span data-ttu-id="c42f2-272">**toocheck hello logboek met Visual Studio**</span><span class="sxs-lookup"><span data-stu-id="c42f2-272">**toocheck hello log using Visual Studio**</span></span>

1. <span data-ttu-id="c42f2-273">Open Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="c42f2-273">Open Visual Studio.</span></span>
2. <span data-ttu-id="c42f2-274">Klik op **weergave**, en klik vervolgens op **Server Explorer**.</span><span class="sxs-lookup"><span data-stu-id="c42f2-274">Click **View**, and then click **Server Explorer**.</span></span>
3. <span data-ttu-id="c42f2-275">Met de rechtermuisknop op de 'Azure', klikt u op verbinden te**Microsoft Azure-abonnementen**, en voer uw referenties.</span><span class="sxs-lookup"><span data-stu-id="c42f2-275">Right-click "Azure", click Connect too**Microsoft Azure Subscriptions**, and then enter your credentials.</span></span>
4. <span data-ttu-id="c42f2-276">Vouw **opslag**, vouw hello Azure storage-account gebruikt als het standaardbestandssysteem Hallo uit, vouw **tabellen**, en dubbelklik vervolgens op Hallo tabelnaam.</span><span class="sxs-lookup"><span data-stu-id="c42f2-276">Expand **Storage**, expand hello Azure storage account used as hello default file system, expand **Tables**, and then double-click hello table name.</span></span>

<span data-ttu-id="c42f2-277">U kunt ook externe in Hallo cluster knooppunten toosee zowel STDOUT en STDERR voor aangepaste scripts.</span><span class="sxs-lookup"><span data-stu-id="c42f2-277">You can also remote into hello cluster nodes toosee both STDOUT and STDERR for custom scripts.</span></span> <span data-ttu-id="c42f2-278">Hallo-logboeken op elk knooppunt zijn specifiek alleen toothat-knooppunt en vastgelegd in **C:\HDInsightLogs\DeploymentAgent.log**.</span><span class="sxs-lookup"><span data-stu-id="c42f2-278">hello logs on each node are specific only toothat node and are logged into **C:\HDInsightLogs\DeploymentAgent.log**.</span></span> <span data-ttu-id="c42f2-279">Deze logboekbestanden Leg alle uitvoerwaarden van een aangepast script Hallo.</span><span class="sxs-lookup"><span data-stu-id="c42f2-279">These log files record all outputs from hello custom script.</span></span> <span data-ttu-id="c42f2-280">Een voorbeeld logboek codefragment voor een Spark-scriptactie ziet er als volgt:</span><span class="sxs-lookup"><span data-stu-id="c42f2-280">An example log snippet for a Spark script action looks like this:</span></span>

    Microsoft.Hadoop.Deployment.Engine.CustomPowershellScriptCommand; Details : BEGIN: Invoking powershell script https://configactions.blob.core.windows.net/sparkconfigactions/spark-installer.ps1.;
    Version : 2.1.0.0;
    ActivityId : 739e61f5-aa22-4254-aafc-9faf56fc2692;
    AzureVMName : HEADNODE0;
    IsException : False;
    ExceptionType : ;
    ExceptionMessage : ;
    InnerExceptionType : ;
    InnerExceptionMessage : ;
    Exception : ;
    ...

    Starting Spark installation at: 09/04/2014 21:46:02 Done with Spark installation at: 09/04/2014 21:46:38;

    Version : 2.1.0.0;
    ActivityId : 739e61f5-aa22-4254-aafc-9faf56fc2692;
    AzureVMName : HEADNODE0;
    IsException : False;
    ExceptionType : ;
    ExceptionMessage : ;
    InnerExceptionType : ;
    InnerExceptionMessage : ;
    Exception : ;
    ...

    Microsoft.Hadoop.Deployment.Engine.CustomPowershellScriptCommand;
    Details : END: Invoking powershell script https://configactions.blob.core.windows.net/sparkconfigactions/spark-installer.ps1.;
    Version : 2.1.0.0;
    ActivityId : 739e61f5-aa22-4254-aafc-9faf56fc2692;
    AzureVMName : HEADNODE0;
    IsException : False;
    ExceptionType : ;
    ExceptionMessage : ;
    InnerExceptionType : ;
    InnerExceptionMessage : ;
    Exception : ;


<span data-ttu-id="c42f2-281">In dit logboek is duidelijk dat Hallo Spark scriptactie is uitgevoerd op virtuele machine met de naam HEADNODE0 Hallo en dat er geen uitzonderingen tijdens het Hallo uitvoeren veroorzaakt.</span><span class="sxs-lookup"><span data-stu-id="c42f2-281">In this log, it is clear that hello Spark script action has been executed on hello VM named HEADNODE0 and that no exceptions were thrown during hello execution.</span></span>

<span data-ttu-id="c42f2-282">In het Hallo-gebeurtenis die een uitvoeringsfout optreedt, met een beschrijving van het Hallo-uitvoer ook deel uitmaakt van dit logboekbestand.</span><span class="sxs-lookup"><span data-stu-id="c42f2-282">In hello event that an execution failure occurs, hello output describing it is also contained in this log file.</span></span> <span data-ttu-id="c42f2-283">Hallo informatie in deze logboeken zijn te helpen bij foutopsporing script problemen die zich kunnen voordoen.</span><span class="sxs-lookup"><span data-stu-id="c42f2-283">hello information provided in these logs should be helpful in debugging script problems that may arise.</span></span>

## <a name="see-also"></a><span data-ttu-id="c42f2-284">Zie ook</span><span class="sxs-lookup"><span data-stu-id="c42f2-284">See also</span></span>
* <span data-ttu-id="c42f2-285">[HDInsight-clusters met behulp van de scriptactie aanpassen][hdinsight-cluster-customize]</span><span class="sxs-lookup"><span data-stu-id="c42f2-285">[Customize HDInsight clusters using Script Action][hdinsight-cluster-customize]</span></span>
* <span data-ttu-id="c42f2-286">[Installeren en gebruiken van Spark in HDInsight-clusters][hdinsight-install-spark]</span><span class="sxs-lookup"><span data-stu-id="c42f2-286">[Install and use Spark on HDInsight clusters][hdinsight-install-spark]</span></span>
* <span data-ttu-id="c42f2-287">[Installeren en gebruiken van R op HDInsight-clusters][hdinsight-r-scripts]</span><span class="sxs-lookup"><span data-stu-id="c42f2-287">[Install and use R on HDInsight clusters][hdinsight-r-scripts]</span></span>
* <span data-ttu-id="c42f2-288">[Installeren en gebruiken van Solr op HDInsight-clusters](hdinsight-hadoop-solr-install.md).</span><span class="sxs-lookup"><span data-stu-id="c42f2-288">[Install and use Solr on HDInsight clusters](hdinsight-hadoop-solr-install.md).</span></span>
* <span data-ttu-id="c42f2-289">[Installeren en gebruiken van Giraph op HDInsight-clusters](hdinsight-hadoop-giraph-install.md).</span><span class="sxs-lookup"><span data-stu-id="c42f2-289">[Install and use Giraph on HDInsight clusters](hdinsight-hadoop-giraph-install.md).</span></span>

[hdinsight-provision]: hdinsight-provision-clusters.md
[hdinsight-cluster-customize]: hdinsight-hadoop-customize-cluster.md
[hdinsight-install-spark]: hdinsight-hadoop-spark-install.md
[hdinsight-r-scripts]: hdinsight-hadoop-r-scripts.md
[powershell-install-configure]: install-configure-powershell.md

<!--Reference links in article-->
[1]: https://msdn.microsoft.com/library/96xafkes(v=vs.110).aspx
