---
title: Excel en Hadoop koppelen met Power Query - Azure HDInsight | Microsoft Docs
description: Informatie over het profiteren van business intelligence-onderdelen en het gebruik van Power Query voor Excel voor toegang tot gegevens die zijn opgeslagen in Hadoop op HDInsight.
services: hdinsight
documentationcenter: 
tags: azure-portal
author: mumian
manager: jhubbard
editor: cgronlun
ms.assetid: 01ad2f90-7520-44d9-8c16-4d936faaff9b
ms.service: hdinsight
ms.custom: hdinsightactive
ms.workload: big-data
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/11/2017
ms.author: jgao
ms.openlocfilehash: 6a15efb091b4faaa7305bb8faa362c62fac595cb
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 08/03/2017
---
# <a name="connect-excel-to-hadoop-by-using-power-query"></a><span data-ttu-id="bbd5c-103">Excel en Hadoop koppelen met Power Query</span><span class="sxs-lookup"><span data-stu-id="bbd5c-103">Connect Excel to Hadoop by using Power Query</span></span>
<span data-ttu-id="bbd5c-104">Een belangrijke functie van de Microsoft big data-oplossing is de integratie van Microsoft business intelligence (BI)-onderdelen met Hadoop-clusters in Azure HDInsight.</span><span class="sxs-lookup"><span data-stu-id="bbd5c-104">One key feature of the Microsoft big-data solution is the integration of Microsoft business intelligence (BI) components with Hadoop clusters in Azure HDInsight.</span></span> <span data-ttu-id="bbd5c-105">Een voorbeeld van een primaire is de mogelijkheid Excel verbindt met de Azure Storage-account met de gegevens die zijn gekoppeld aan de Hadoop-cluster met behulp van de Microsoft Power Query voor Excel-invoegtoepassing.</span><span class="sxs-lookup"><span data-stu-id="bbd5c-105">A primary example is the ability to connect Excel to the Azure Storage account that contains the data associated with your Hadoop cluster by using the Microsoft Power Query for Excel add-in.</span></span> <span data-ttu-id="bbd5c-106">Dit artikel begeleidt u bij het instellen en gebruiken van Power Query query uitvoeren op gegevens die zijn gekoppeld aan een beheerd met HDInsight Hadoop-cluster.</span><span class="sxs-lookup"><span data-stu-id="bbd5c-106">This article walks you through how to set up and use Power Query to query data associated with a Hadoop cluster managed with HDInsight.</span></span>

### <a name="prerequisites"></a><span data-ttu-id="bbd5c-107">Vereisten</span><span class="sxs-lookup"><span data-stu-id="bbd5c-107">Prerequisites</span></span>
<span data-ttu-id="bbd5c-108">Voordat u dit artikel, hebt u de volgende items:</span><span class="sxs-lookup"><span data-stu-id="bbd5c-108">Before you begin this article, you must have the following items:</span></span>

* <span data-ttu-id="bbd5c-109">**Een HDInsight-cluster**.</span><span class="sxs-lookup"><span data-stu-id="bbd5c-109">**An HDInsight cluster**.</span></span> <span data-ttu-id="bbd5c-110">Zie configureren van een [aan de slag met Azure HDInsight][hdinsight-get-started].</span><span class="sxs-lookup"><span data-stu-id="bbd5c-110">To configure one, see [Get started with Azure HDInsight][hdinsight-get-started].</span></span>
* <span data-ttu-id="bbd5c-111">**Een werkstation** waarop Windows 7, Windows Server 2008 R2 of een nieuwer besturingssysteem wordt uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="bbd5c-111">**A workstation** that is running Windows 7, Windows Server 2008 R2, or a later operating system.</span></span>
* <span data-ttu-id="bbd5c-112">**Office 2016, Office 2013 Professional Plus Office 365 ProPlus, zelfstandige versie van Excel 2013 of Office 2010 Professional Plus**.</span><span class="sxs-lookup"><span data-stu-id="bbd5c-112">**Office 2016, Office 2013 Professional Plus, Office 365 ProPlus, Excel 2013 Standalone, or Office 2010 Professional Plus**.</span></span>

## <a name="install-power-query"></a><span data-ttu-id="bbd5c-113">Power Query installeren</span><span class="sxs-lookup"><span data-stu-id="bbd5c-113">Install Power Query</span></span>
<span data-ttu-id="bbd5c-114">Power Query kunt importeren van gegevens die de uitvoer heeft zijn of die is gegenereerd door een Hadoop-taak uitgevoerd op een HDInsight-cluster.</span><span class="sxs-lookup"><span data-stu-id="bbd5c-114">Power Query can import data that has been output or that has been generated by a Hadoop job running on an HDInsight cluster.</span></span>

<span data-ttu-id="bbd5c-115">In Excel 2016 is Power Query ge√Øntegreerd in het lint gegevens onder de sectie transformatie & ophalen.</span><span class="sxs-lookup"><span data-stu-id="bbd5c-115">In Excel 2016, Power Query has been integrated into the Data ribbon under the Get & Transform section.</span></span> <span data-ttu-id="bbd5c-116">Voor oudere versies van Excel, download u Microsoft Power Query voor Excel uit de [Microsoft Download Center] [ powerquery-download] en te installeren.</span><span class="sxs-lookup"><span data-stu-id="bbd5c-116">For older Excel versions, download Microsoft Power Query for Excel from the [Microsoft Download Center][powerquery-download] and install it.</span></span>

## <a name="import-hdinsight-data-into-excel"></a><span data-ttu-id="bbd5c-117">HDInsight-gegevens importeren in Excel</span><span class="sxs-lookup"><span data-stu-id="bbd5c-117">Import HDInsight data into Excel</span></span>
<span data-ttu-id="bbd5c-118">De Power Query-invoegtoepassing voor Excel kunt u eenvoudig gegevens importeren uit uw HDInsight-cluster in Excel, waarbij BI-hulpprogramma's zoals PowerPivot en Power kaart kunnen worden gebruikt om te controleren, analyseren en de gegevens aanwezig.</span><span class="sxs-lookup"><span data-stu-id="bbd5c-118">The Power Query add-in for Excel makes it easy to import data from your HDInsight cluster into Excel, where BI tools such as PowerPivot and Power Map can be used to inspect, analyze, and present the data.</span></span>

<span data-ttu-id="bbd5c-119">**Gegevens importeren uit een HDInsight-cluster**</span><span class="sxs-lookup"><span data-stu-id="bbd5c-119">**To import data from an HDInsight cluster**</span></span>

1. <span data-ttu-id="bbd5c-120">Open Excel.</span><span class="sxs-lookup"><span data-stu-id="bbd5c-120">Open Excel.</span></span>
2. <span data-ttu-id="bbd5c-121">Maak een nieuwe lege werkmap.</span><span class="sxs-lookup"><span data-stu-id="bbd5c-121">Create a new blank workbook.</span></span>
3. <span data-ttu-id="bbd5c-122">Voer de volgende stappen uit op basis van de versie van Excel:</span><span class="sxs-lookup"><span data-stu-id="bbd5c-122">Perform the following steps based on the Excel version:</span></span>

    - <span data-ttu-id="bbd5c-123">Excel 2016</span><span class="sxs-lookup"><span data-stu-id="bbd5c-123">Excel 2016</span></span>

        - <span data-ttu-id="bbd5c-124">Klik op de **gegevens** menu, klikt u op **gegevens ophalen** van de **transformeren gegevens & ophalen** lint, klikt u op **van Azure**, en klik vervolgens op **Van Azure HDInsight(HDFS)**.</span><span class="sxs-lookup"><span data-stu-id="bbd5c-124">Click the **Data** menu, click **Get Data** from the **Get & Transform Data** ribbon, click **From Azure**, and then click **From Azure HDInsight(HDFS)**.</span></span>

        ![HDI. PowerQuery.SelectHdiSource](./media/hdinsight-connect-excel-power-query/hdi.powerquery.selecthdisource.excel2016.png)

    - <span data-ttu-id="bbd5c-126">Excel 2013/2010</span><span class="sxs-lookup"><span data-stu-id="bbd5c-126">Excel 2013/2010</span></span>

        - <span data-ttu-id="bbd5c-127">Klik op de **Power Query** menu, klikt u op **van Azure**, en klik vervolgens op **van Microsoft Azure HDInsight**.</span><span class="sxs-lookup"><span data-stu-id="bbd5c-127">Click the **Power Query** menu, click **From Azure**, and then click **From Microsoft Azure HDInsight**.</span></span>
   
        ![HDI. PowerQuery.SelectHdiSource][image-hdi-powerquery-hdi-source]
       
        <span data-ttu-id="bbd5c-129">**Opmerking:** als er geen de **Power Query** menu, gaat u naar **bestand** > **opties** > **-invoegtoepassingen**, en selecteer **COM-invoegtoepassingen** in de vervolgkeuzelijst **beheren** vak aan de onderkant van de pagina.</span><span class="sxs-lookup"><span data-stu-id="bbd5c-129">**Note:** If you don't see the **Power Query** menu, go to **File** > **Options** > **Add-Ins**, and select **COM Add-ins** from the drop-down **Manage** box at the bottom of the page.</span></span> <span data-ttu-id="bbd5c-130">Selecteer de **gaan...**  knop en controleer of het selectievakje uit voor de Power Query voor Excel-invoegtoepassing is gecontroleerd.</span><span class="sxs-lookup"><span data-stu-id="bbd5c-130">Select the **Go...** button and verify that the box for the Power Query for Excel add-in has been checked.</span></span>
       
        <span data-ttu-id="bbd5c-131">**Opmerking:** Power Query kunt u gegevens uit HDFS importeren door te klikken op **van andere bronnen**.</span><span class="sxs-lookup"><span data-stu-id="bbd5c-131">**Note:** Power Query also allows you to import data from HDFS by clicking **From Other Sources**.</span></span>
4. <span data-ttu-id="bbd5c-132">Voor **accountnaam**, voer de naam van de Azure Blob storage-account die is gekoppeld aan het cluster en klik vervolgens op **OK**.</span><span class="sxs-lookup"><span data-stu-id="bbd5c-132">For **Account Name**, enter the name of the Azure Blob storage account associated with your cluster, and then click **OK**.</span></span> <span data-ttu-id="bbd5c-133">Dit account kan worden de [standaard opslagaccount](hdinsight-administer-use-management-portal.md#find-the-default-storage-account) of een gekoppeld opslagaccount.</span><span class="sxs-lookup"><span data-stu-id="bbd5c-133">This account can be the [default storage account](hdinsight-administer-use-management-portal.md#find-the-default-storage-account) or a linked storage account.</span></span>  <span data-ttu-id="bbd5c-134">De indeling is *https://&lt;StorageAccountName >.blob.core.windows.net/*.</span><span class="sxs-lookup"><span data-stu-id="bbd5c-134">The format is *https://&lt;StorageAccountName>.blob.core.windows.net/*.</span></span>
5. <span data-ttu-id="bbd5c-135">Voor **Accountsleutel**, voer de sleutel voor de Blob storage-account en klik vervolgens op **opslaan**.</span><span class="sxs-lookup"><span data-stu-id="bbd5c-135">For **Account Key**, enter the key for the Blob storage account, and then click **Save**.</span></span> <span data-ttu-id="bbd5c-136">(U moet de account informatie alleen de eerste keer dat u toegang dit archief tot invoeren.)</span><span class="sxs-lookup"><span data-stu-id="bbd5c-136">(You need to enter the account information only the first time you access this store.)</span></span>
6. <span data-ttu-id="bbd5c-137">In de **Navigator** in het linkerdeelvenster van de Query-Editor, dubbelklikt u op de naam van de Blob-container.</span><span class="sxs-lookup"><span data-stu-id="bbd5c-137">In the **Navigator** pane on the left of the Query Editor, double-click the Blob storage container name.</span></span> <span data-ttu-id="bbd5c-138">De containernaam is standaard dezelfde naam als de naam van het cluster.</span><span class="sxs-lookup"><span data-stu-id="bbd5c-138">By default, the container name is the same name as the cluster name.</span></span>
7. <span data-ttu-id="bbd5c-139">Zoek **HiveSampleData.txt** in de **naam** kolom (het mappad is **... / hive/datawarehouse/hivesampletable/**), en klik vervolgens op **binaire** aan de linkerkant van HiveSampleData.txt.</span><span class="sxs-lookup"><span data-stu-id="bbd5c-139">Locate **HiveSampleData.txt** in the **Name** column (the folder path is **../hive/warehouse/hivesampletable/**), and then click **Binary** on the left of HiveSampleData.txt.</span></span> <span data-ttu-id="bbd5c-140">HiveSampleData.txt wordt geleverd met het cluster.</span><span class="sxs-lookup"><span data-stu-id="bbd5c-140">HiveSampleData.txt comes with all the cluster.</span></span> <span data-ttu-id="bbd5c-141">Desgewenst kunt u uw eigen-bestand.</span><span class="sxs-lookup"><span data-stu-id="bbd5c-141">Optionally, you can use your own file.</span></span>
   
    ![HDI. PowerQuery.ImportData][image-hdi-powerquery-importdata]
8. <span data-ttu-id="bbd5c-143">Als u wilt, kunt u de kolomnamen van de wijzigen.</span><span class="sxs-lookup"><span data-stu-id="bbd5c-143">If you want, you can rename the column names.</span></span> <span data-ttu-id="bbd5c-144">Wanneer u klaar bent, klikt u op **sluit & laden**.</span><span class="sxs-lookup"><span data-stu-id="bbd5c-144">When you are ready, click **Close & Load**.</span></span>  <span data-ttu-id="bbd5c-145">De gegevens zijn geladen met uw werkmap:</span><span class="sxs-lookup"><span data-stu-id="bbd5c-145">The data has been loaded to your workbook:</span></span>
   
    ![HDI. PowerQuery.ImportedTable][image-hdi-powerquery-imported-table]

## <a name="next-steps"></a><span data-ttu-id="bbd5c-147">Volgende stappen</span><span class="sxs-lookup"><span data-stu-id="bbd5c-147">Next steps</span></span>
<span data-ttu-id="bbd5c-148">In dit artikel hebt u geleerd hoe gebruik Power Query om gegevens te halen uit HDInsight in Excel.</span><span class="sxs-lookup"><span data-stu-id="bbd5c-148">In this article, you learned how to use Power Query to retrieve data from HDInsight into Excel.</span></span> <span data-ttu-id="bbd5c-149">Op deze manier kunt u gegevens ophalen uit HDInsight in Azure SQL Database.</span><span class="sxs-lookup"><span data-stu-id="bbd5c-149">Similarly, you can retrieve data from HDInsight into Azure SQL Database.</span></span> <span data-ttu-id="bbd5c-150">Het is ook mogelijk om gegevens te uploaden naar HDInsight.</span><span class="sxs-lookup"><span data-stu-id="bbd5c-150">It is also possible to upload data into HDInsight.</span></span> <span data-ttu-id="bbd5c-151">Zie voor meer informatie de volgende artikelen:</span><span class="sxs-lookup"><span data-stu-id="bbd5c-151">To learn more, see the following articles:</span></span>

* <span data-ttu-id="bbd5c-152">[Excel verbinden met HDInsight met het Microsoft Hive ODBC-stuurprogramma][hdinsight-ODBC]</span><span class="sxs-lookup"><span data-stu-id="bbd5c-152">[Connect Excel to HDInsight with the Microsoft Hive ODBC Driver][hdinsight-ODBC]</span></span>
* <span data-ttu-id="bbd5c-153">[Gegevens uploaden naar HDInsight][hdinsight-upload-data]</span><span class="sxs-lookup"><span data-stu-id="bbd5c-153">[Upload Data to HDInsight][hdinsight-upload-data]</span></span>

[hdinsight-ODBC]: hdinsight-connect-excel-hive-odbc-driver.md
[hdinsight-get-started]: hdinsight-hadoop-linux-tutorial-get-started.md
[hdinsight-upload-data]: hdinsight-upload-data.md

[image-hdi-powerquery-hdi-source]: ./media/hdinsight-connect-excel-power-query/hdi.powerquery.selecthdisource.png
[image-hdi-powerquery-importdata]: ./media/hdinsight-connect-excel-power-query/hdi.powerquery.importdata.png
[image-hdi-powerquery-imported-table]: ./media/hdinsight-connect-excel-power-query/hdi.powerquery.importedtable.PNG

[powerquery-download]: http://go.microsoft.com/fwlink/?LinkID=286689
