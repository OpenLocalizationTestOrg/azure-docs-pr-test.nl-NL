---
title: aaaUsing elastische database-clientbibliotheek met Dapper | Microsoft Docs
description: Gebruik de clientbibliotheek voor elastische database met Dapper.
services: sql-database
documentationcenter: 
manager: jhubbard
author: torsteng
ms.assetid: 463d2676-3b19-47c2-83df-f8c50492c9d2
ms.service: sql-database
ms.custom: scale out apps
ms.workload: sql-database
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 05/27/2016
ms.author: torsteng
ms.openlocfilehash: c22ece2a977265e93850f0ad3f3ca48f0a8733ac
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 10/06/2017
---
# <a name="using-elastic-database-client-library-with-dapper"></a><span data-ttu-id="393ba-103">Clientbibliotheek voor elastische database gebruiken met Dapper</span><span class="sxs-lookup"><span data-stu-id="393ba-103">Using elastic database client library with Dapper</span></span>
<span data-ttu-id="393ba-104">Dit document is bedoeld voor ontwikkelaars die afhankelijk zijn van Dapper toobuild toepassingen, maar ook wilt tooembrace [elastische database tooling](sql-database-elastic-scale-introduction.md) toocreate toepassingen die sharding tooscale-out hun gegevenslaag implementeren.</span><span class="sxs-lookup"><span data-stu-id="393ba-104">This document is for developers that rely on Dapper toobuild applications, but also want tooembrace [elastic database tooling](sql-database-elastic-scale-introduction.md) toocreate applications that implement sharding tooscale-out their data tier.</span></span>  <span data-ttu-id="393ba-105">Dit document ziet u Hallo wijzigingen in Dapper-toepassingen die nodig zijn toointegrate met hulpprogramma's voor elastische database zijn.</span><span class="sxs-lookup"><span data-stu-id="393ba-105">This document illustrates hello changes in Dapper-based applications that are necessary toointegrate with elastic database tools.</span></span> <span data-ttu-id="393ba-106">Onze focus is op het samenstellen van Hallo elastische database shard-beheer en afhankelijk van de gegevens routering met Dapper.</span><span class="sxs-lookup"><span data-stu-id="393ba-106">Our focus is on composing hello elastic database shard management and data dependent routing with Dapper.</span></span> 

<span data-ttu-id="393ba-107">**Voorbeeldcode**: [hulpmiddelen voor elastische databases voor Azure SQL Database - Dapper integratie](https://code.msdn.microsoft.com/Elastic-Scale-with-Azure-e19fc77f).</span><span class="sxs-lookup"><span data-stu-id="393ba-107">**Sample Code**: [Elastic database tools for Azure SQL Database - Dapper integration](https://code.msdn.microsoft.com/Elastic-Scale-with-Azure-e19fc77f).</span></span>

<span data-ttu-id="393ba-108">Integratie van **Dapper** en **DapperExtensions** Hello elastische database-clientbibliotheek voor Azure SQL Database is eenvoudig.</span><span class="sxs-lookup"><span data-stu-id="393ba-108">Integrating **Dapper** and **DapperExtensions** with hello elastic database client library for Azure SQL Database is easy.</span></span> <span data-ttu-id="393ba-109">Uw toepassingen kunnen gebruikmaken van afhankelijke routering door het wijzigen van Hallo maken en openen van nieuwe gegevens [SqlConnection](http://msdn.microsoft.com/library/system.data.sqlclient.sqlconnection.aspx) objecten toouse hello [OpenConnectionForKey](http://msdn.microsoft.com/library/azure/dn807226.aspx) aanroepen vanuit Hallo [client bibliotheek](http://msdn.microsoft.com/library/azure/dn765902.aspx).</span><span class="sxs-lookup"><span data-stu-id="393ba-109">Your applications can use data dependent routing by changing hello creation and opening of new [SqlConnection](http://msdn.microsoft.com/library/system.data.sqlclient.sqlconnection.aspx) objects toouse hello [OpenConnectionForKey](http://msdn.microsoft.com/library/azure/dn807226.aspx) call from hello [client library](http://msdn.microsoft.com/library/azure/dn765902.aspx).</span></span> <span data-ttu-id="393ba-110">Dit beperkt de wijzigingen in uw toepassing tooonly waarbij nieuwe verbindingen zijn gemaakt en geopend.</span><span class="sxs-lookup"><span data-stu-id="393ba-110">This limits changes in your application tooonly where new connections are created and opened.</span></span> 

## <a name="dapper-overview"></a><span data-ttu-id="393ba-111">Overzicht van dapper</span><span class="sxs-lookup"><span data-stu-id="393ba-111">Dapper overview</span></span>
<span data-ttu-id="393ba-112">**Dapper** is een object-relationele toewijzen.</span><span class="sxs-lookup"><span data-stu-id="393ba-112">**Dapper** is an object-relational mapper.</span></span> <span data-ttu-id="393ba-113">Het .NET-objecten uit uw toepassing tooa relationele database (en omgekeerd) worden toegewezen.</span><span class="sxs-lookup"><span data-stu-id="393ba-113">It maps .NET objects from your application tooa relational database (and vice versa).</span></span> <span data-ttu-id="393ba-114">Hallo eerste deel van Hallo voorbeeldcode ziet u hoe u Hallo-clientbibliotheek voor elastische database kunt integreren met Dapper gebaseerde toepassingen.</span><span class="sxs-lookup"><span data-stu-id="393ba-114">hello first part of hello sample code illustrates how you can integrate hello elastic database client library with Dapper-based applications.</span></span> <span data-ttu-id="393ba-115">Hallo secondegedeelte van Hallo voorbeeldcode ziet u hoe toointegrate bij gebruik van zowel Dapper en DapperExtensions.</span><span class="sxs-lookup"><span data-stu-id="393ba-115">hello second part of hello sample code illustrates how toointegrate when using both Dapper and DapperExtensions.</span></span>  

<span data-ttu-id="393ba-116">Hallo mapper-functionaliteit in Dapper biedt uitbreidingsmethoden op databaseverbindingen die verzenden T-SQL-instructies voor uitvoering of opvragen Hallo-database vereenvoudigen.</span><span class="sxs-lookup"><span data-stu-id="393ba-116">hello mapper functionality in Dapper provides extension methods on database connections that simplify submitting T-SQL statements for execution or querying hello database.</span></span> <span data-ttu-id="393ba-117">Bijvoorbeeld: Dapper maakt het eenvoudig toomap tussen uw .NET-objecten en het Hallo-parameters van de SQL-instructies voor **Execute** aanroepen of tooconsume Hallo resultaten van uw SQL-query's in .NET-objecten met behulp van **Query**aanroepen vanuit Dapper.</span><span class="sxs-lookup"><span data-stu-id="393ba-117">For instance, Dapper makes it easy toomap between your .NET objects and hello parameters of SQL statements for **Execute** calls, or tooconsume hello results of your SQL queries into .NET objects using **Query** calls from Dapper.</span></span> 

<span data-ttu-id="393ba-118">Wanneer u DapperExtensions gebruikt, moet u niet langer tooprovide Hallo SQL-instructies.</span><span class="sxs-lookup"><span data-stu-id="393ba-118">When using DapperExtensions, you no longer need tooprovide hello SQL statements.</span></span> <span data-ttu-id="393ba-119">Extensies methoden zoals **GetList** of **invoegen** maken via de databaseverbinding Hallo HALLO hallo achtergrond SQL-instructies.</span><span class="sxs-lookup"><span data-stu-id="393ba-119">Extensions methods such as **GetList** or **Insert** over hello database connection create hello SQL statements behind hello scenes.</span></span>

<span data-ttu-id="393ba-120">Een ander voordeel van Dapper en ook DapperExtensions is dat Hallo toepassing besturingselementen maken van verbinding met database Hallo Hallo.</span><span class="sxs-lookup"><span data-stu-id="393ba-120">Another benefit of Dapper and also DapperExtensions is that hello application controls hello creation of hello database connection.</span></span> <span data-ttu-id="393ba-121">Dit helpt communiceren met de clientbibliotheek van Hallo elastische database die beleggingsmakelaars-databaseverbindingen op basis van Hallo toewijzing van shardlets toodatabases.</span><span class="sxs-lookup"><span data-stu-id="393ba-121">This helps interact with hello elastic database client library which brokers database connections based on hello mapping of shardlets toodatabases.</span></span>

<span data-ttu-id="393ba-122">tooget hello Dapper verzamelingen, Zie [Dapper punt net](http://www.nuget.org/packages/Dapper/).</span><span class="sxs-lookup"><span data-stu-id="393ba-122">tooget hello Dapper assemblies, see [Dapper dot net](http://www.nuget.org/packages/Dapper/).</span></span> <span data-ttu-id="393ba-123">Zie voor Dapper Hallo-extensies [DapperExtensions](http://www.nuget.org/packages/DapperExtensions).</span><span class="sxs-lookup"><span data-stu-id="393ba-123">For hello Dapper extensions, see [DapperExtensions](http://www.nuget.org/packages/DapperExtensions).</span></span>

## <a name="a-quick-look-at-hello-elastic-database-client-library"></a><span data-ttu-id="393ba-124">Een kort overzicht van Hallo-clientbibliotheek voor elastische database</span><span class="sxs-lookup"><span data-stu-id="393ba-124">A quick Look at hello elastic database client library</span></span>
<span data-ttu-id="393ba-125">Met Hallo elastische database-clientbibliotheek, definieert u de partities van de toepassingsgegevens aangeroepen *shardlets* toodatabases toewijzen en deze door herkennen *sharding sleutels*.</span><span class="sxs-lookup"><span data-stu-id="393ba-125">With hello elastic database client library, you define partitions of your application data called *shardlets* , map them toodatabases, and identify them by *sharding keys*.</span></span> <span data-ttu-id="393ba-126">U kunt zoveel databases als u uw shardlets verdelen over deze databases nodig hebben.</span><span class="sxs-lookup"><span data-stu-id="393ba-126">You can have as many databases as you need and distribute your shardlets across these databases.</span></span> <span data-ttu-id="393ba-127">Hallo-toewijzing van sharding sleutelwaarden toohello databases is door een shard-toewijzing geleverd door de API's Hallo-bibliotheek opgeslagen.</span><span class="sxs-lookup"><span data-stu-id="393ba-127">hello mapping of sharding key values toohello databases is stored by a shard map provided by hello library’s APIs.</span></span> <span data-ttu-id="393ba-128">Deze mogelijkheid wordt aangeroepen **shard kaart management**.</span><span class="sxs-lookup"><span data-stu-id="393ba-128">This capability is called **shard map management**.</span></span> <span data-ttu-id="393ba-129">Hallo shard kaart fungeert ook als Hallo broker databaseverbindingen voor aanvragen die een sharding-sleutel bevatten.</span><span class="sxs-lookup"><span data-stu-id="393ba-129">hello shard map also serves as hello broker of database connections for requests that carry a sharding key.</span></span> <span data-ttu-id="393ba-130">Deze mogelijkheid is waarnaar wordt verwezen tooas **gegevensafhankelijke routering**.</span><span class="sxs-lookup"><span data-stu-id="393ba-130">This capability is referred tooas **data dependent routing**.</span></span>

![Shard-kaarten en gegevensafhankelijke routering][1]

<span data-ttu-id="393ba-132">Hallo shard-toewijzing manager beveiligt gebruikers tegen inconsistente weergaven in shardlet gegevens die optreden kunnen wanneer de gelijktijdige shardlet bewerkingen plaatsvinden op Hallo-databases.</span><span class="sxs-lookup"><span data-stu-id="393ba-132">hello shard map manager protects users from inconsistent views into shardlet data that can occur when concurrent shardlet management operations are happening on hello databases.</span></span> <span data-ttu-id="393ba-133">toodo Hallo dus shard maps broker Hallo-databaseverbindingen voor een toepassing die is gebouwd met Hallo-bibliotheek.</span><span class="sxs-lookup"><span data-stu-id="393ba-133">toodo so, hello shard maps broker hello database connections for an application built with hello library.</span></span> <span data-ttu-id="393ba-134">Wanneer de shard-beheerbewerkingen kunnen invloed hebben op Hallo shardlet, hierdoor Hallo shard kaart functionaliteit tooautomatically kill een databaseverbinding.</span><span class="sxs-lookup"><span data-stu-id="393ba-134">When shard management operations could impact hello shardlet, this allows hello shard map functionality tooautomatically kill a database connection.</span></span> 

<span data-ttu-id="393ba-135">In plaats van Hallo traditionele manier toocreate verbindingen voor Dapper, moeten we toouse hello [OpenConnectionForKey methode](http://msdn.microsoft.com/library/azure/dn824099.aspx).</span><span class="sxs-lookup"><span data-stu-id="393ba-135">Instead of using hello traditional way toocreate connections for Dapper, we need toouse hello [OpenConnectionForKey method](http://msdn.microsoft.com/library/azure/dn824099.aspx).</span></span> <span data-ttu-id="393ba-136">Dit zorgt ervoor dat alle Hallo validatie plaats vindt en verbindingen correct worden beheerd als er gegevens worden verplaatst tussen shards.</span><span class="sxs-lookup"><span data-stu-id="393ba-136">This ensures that all hello validation takes place and connections are managed properly when any data moves between shards.</span></span>

### <a name="requirements-for-dapper-integration"></a><span data-ttu-id="393ba-137">Vereisten voor Dapper-integratie</span><span class="sxs-lookup"><span data-stu-id="393ba-137">Requirements for Dapper integration</span></span>
<span data-ttu-id="393ba-138">Als u werkt met Hallo-clientbibliotheek voor elastische database en Hallo Dapper API's, willen we tooretain Hallo volgende eigenschappen:</span><span class="sxs-lookup"><span data-stu-id="393ba-138">When working with both hello elastic database client library and hello Dapper APIs, we want tooretain hello following properties:</span></span>

* <span data-ttu-id="393ba-139">**Scaleout**: We wilt tooadd of databases uit de gegevenslaag Hallo van shard toepassing hello die nodig zijn voor Hallo capaciteit eisen van de toepassing hello verwijderen.</span><span class="sxs-lookup"><span data-stu-id="393ba-139">**Scaleout**: We want tooadd or remove databases from hello data tier of hello sharded application as necessary for hello capacity demands of hello application.</span></span> 
* <span data-ttu-id="393ba-140">**Consistentie**: omdat de toepassing is uitgebreid met behulp van sharding, moeten we tooperform gegevensafhankelijke routering.</span><span class="sxs-lookup"><span data-stu-id="393ba-140">**Consistency**: Since our application is scaled out using sharding, we need tooperform data dependent routing.</span></span> <span data-ttu-id="393ba-141">Willen we dus toouse Hallo gegevens afhankelijke routering mogelijkheden van Hallo bibliotheek toodo.</span><span class="sxs-lookup"><span data-stu-id="393ba-141">We want toouse hello Data dependent routing capabilities of hello library toodo so.</span></span> <span data-ttu-id="393ba-142">In het bijzonder, willen we tooretain Hallo validatie en consistentie wordt geleverd door verbindingen die worden geleverd door Hallo shard kaart manager in volgorde tooavoid beschadiging of onjuiste queryresultaten.</span><span class="sxs-lookup"><span data-stu-id="393ba-142">In particular, we want tooretain hello validation and consistency guarantees provided by connections that are brokered through hello shard map manager in order tooavoid corruption or wrong query results.</span></span> <span data-ttu-id="393ba-143">Dit zorgt ervoor dat verbindingen tooa shardlet gegeven zijn afgewezen of gestopt als (bijvoorbeeld) Hallo shardlet momenteel verplaatste tooa verschillende shard met gesplitste/Merge-API's.</span><span class="sxs-lookup"><span data-stu-id="393ba-143">This ensures that connections tooa given shardlet are rejected or stopped if (for instance) hello shardlet is currently moved tooa different shard using Split/Merge APIs.</span></span>
* <span data-ttu-id="393ba-144">**Objecttoewijzing**: We willen tooretain Hallo gemak geleverd door Dapper tootranslate tussen klassen in de toepassing hello en onderliggende databasestructuren Hallo Hallo-toewijzingen.</span><span class="sxs-lookup"><span data-stu-id="393ba-144">**Object Mapping**: We want tooretain hello convenience of hello mappings provided by Dapper tootranslate between classes in hello application and hello underlying database structures.</span></span> 

<span data-ttu-id="393ba-145">Hallo volgende sectie bevat hulp voor deze vereisten voor toepassingen op basis van **Dapper** en **DapperExtensions**.</span><span class="sxs-lookup"><span data-stu-id="393ba-145">hello following section provides guidance for these requirements for applications based on **Dapper** and **DapperExtensions**.</span></span>

## <a name="technical-guidance"></a><span data-ttu-id="393ba-146">Technische richtlijnen</span><span class="sxs-lookup"><span data-stu-id="393ba-146">Technical Guidance</span></span>
### <a name="data-dependent-routing-with-dapper"></a><span data-ttu-id="393ba-147">Afhankelijke routering met Dapper gegevens</span><span class="sxs-lookup"><span data-stu-id="393ba-147">Data dependent routing with Dapper</span></span>
<span data-ttu-id="393ba-148">Met Dapper is de toepassing hello gewoonlijk verantwoordelijk is voor het maken en openen van Hallo verbindingen toohello onderliggende database.</span><span class="sxs-lookup"><span data-stu-id="393ba-148">With Dapper, hello application is typically responsible for creating and opening hello connections toohello underlying database.</span></span> <span data-ttu-id="393ba-149">Een type T gezien door de toepassing hello, retourneert Dapper queryresultaten zoals .NET verzamelingen van het type T. Dapper voert Hallo toewijzing van Hallo T-SQL rijen toohello resultaatobjecten van het type T. Op deze manier maps Dapper .NET-objecten in SQL-waarden of de parameters voor instructies voor data manipulatie language (DML).</span><span class="sxs-lookup"><span data-stu-id="393ba-149">Given a type T by hello application, Dapper returns query results as .NET collections of type T. Dapper performs hello mapping from hello T-SQL result rows toohello objects of type T. Similarly, Dapper maps .NET objects into SQL values or parameters for data manipulation language (DML) statements.</span></span> <span data-ttu-id="393ba-150">Dapper biedt deze functionaliteit via uitbreidingsmethoden op Hallo reguliere [SqlConnection](http://msdn.microsoft.com/library/system.data.sqlclient.sqlconnection.aspx) object uit Hallo ADO .NET SQL clientbibliotheken.</span><span class="sxs-lookup"><span data-stu-id="393ba-150">Dapper offers this functionality via extension methods on hello regular [SqlConnection](http://msdn.microsoft.com/library/system.data.sqlclient.sqlconnection.aspx) object from hello ADO .NET SQL Client libraries.</span></span> <span data-ttu-id="393ba-151">Hallo SQL-verbinding die wordt geretourneerd door Hallo Elastic Scale API's voor DDR zijn ook reguliere [SqlConnection](http://msdn.microsoft.com/library/system.data.sqlclient.sqlconnection.aspx) objecten.</span><span class="sxs-lookup"><span data-stu-id="393ba-151">hello SQL connection returned by hello Elastic Scale APIs for DDR are also regular [SqlConnection](http://msdn.microsoft.com/library/system.data.sqlclient.sqlconnection.aspx) objects.</span></span> <span data-ttu-id="393ba-152">Hierdoor kunnen ons toodirectly gebruik Dapper extensies via Hallo type dat wordt geretourneerd door Hallo-clientbibliotheek van DDR-API, zoals het is ook een eenvoudige SQL Client verbinding.</span><span class="sxs-lookup"><span data-stu-id="393ba-152">This allows us toodirectly use Dapper extensions over hello type returned by hello client library’s DDR API, as it is also a simple SQL Client connection.</span></span>

<span data-ttu-id="393ba-153">Deze opmerkingen kunnen u eenvoudig toouse verbindingen brokered door Hallo elastische database-clientbibliotheek voor Dapper.</span><span class="sxs-lookup"><span data-stu-id="393ba-153">These observations make it straightforward toouse connections brokered by hello elastic database client library for Dapper.</span></span>

<span data-ttu-id="393ba-154">Dit codevoorbeeld (van Hallo begeleidende voorbeeld) ziet u Hallo benadering waarbij Hallo sharding-sleutel wordt geleverd door Hallo toepassing toohello bibliotheek toobroker Hallo verbinding toohello rechts shard.</span><span class="sxs-lookup"><span data-stu-id="393ba-154">This code example (from hello accompanying sample) illustrates hello approach where hello sharding key is provided by hello application toohello library toobroker hello connection toohello right shard.</span></span>   

    using (SqlConnection sqlconn = shardingLayer.ShardMap.OpenConnectionForKey(
                     key: tenantId1, 
                     connectionString: connStrBldr.ConnectionString, 
                     options: ConnectionOptions.Validate))
    {
        var blog = new Blog { Name = name };
        sqlconn.Execute(@"
                      INSERT INTO
                            Blog (Name)
                            VALUES (@name)", new { name = blog.Name }
                        );
    }

<span data-ttu-id="393ba-155">Hallo aanroep toohello [OpenConnectionForKey](http://msdn.microsoft.com/library/azure/dn807226.aspx) API vervangt Hallo standaard maken en openen van een SQL-clientverbinding.</span><span class="sxs-lookup"><span data-stu-id="393ba-155">hello call toohello [OpenConnectionForKey](http://msdn.microsoft.com/library/azure/dn807226.aspx) API replaces hello default creation and opening of a SQL Client connection.</span></span> <span data-ttu-id="393ba-156">Hallo [OpenConnectionForKey](http://msdn.microsoft.com/library/azure/dn807226.aspx) aanroep heeft Hallo argumenten die vereist voor het gegevensafhankelijke routering zijn:</span><span class="sxs-lookup"><span data-stu-id="393ba-156">hello [OpenConnectionForKey](http://msdn.microsoft.com/library/azure/dn807226.aspx) call takes hello arguments that are required for data dependent routing:</span></span> 

* <span data-ttu-id="393ba-157">Hallo shard-toewijzing tooaccess Hallo afhankelijke routeringsinterfaces gegevens</span><span class="sxs-lookup"><span data-stu-id="393ba-157">hello shard map tooaccess hello data dependent routing interfaces</span></span>
* <span data-ttu-id="393ba-158">Hallo sharding key tooidentify hello shardlet</span><span class="sxs-lookup"><span data-stu-id="393ba-158">hello sharding key tooidentify hello shardlet</span></span>
* <span data-ttu-id="393ba-159">Hallo referenties (gebruikersnaam en wachtwoord) tooconnect toohello shard</span><span class="sxs-lookup"><span data-stu-id="393ba-159">hello credentials (user name and password) tooconnect toohello shard</span></span>

<span data-ttu-id="393ba-160">Hallo shard-toewijzingsobject maakt een verbinding toohello shard die Hallo shardlet voor Hallo opgegeven sharding-sleutel bevat.</span><span class="sxs-lookup"><span data-stu-id="393ba-160">hello shard map object creates a connection toohello shard that holds hello shardlet for hello given sharding key.</span></span> <span data-ttu-id="393ba-161">Hallo elastische databaseclient-API's ook labelen Hallo verbinding tooimplement wordt gegarandeerd dat de consistentie.</span><span class="sxs-lookup"><span data-stu-id="393ba-161">hello elastic database client APIs also tag hello connection tooimplement its consistency guarantees.</span></span> <span data-ttu-id="393ba-162">Sinds Hallo aanroepen te[OpenConnectionForKey](http://msdn.microsoft.com/library/azure/dn807226.aspx) retourneert een object reguliere SQL clientverbinding, Hallo volgende aanroep toohello **Execute** uitbreidingsmethode van Dapper volgt Hallo standaard Dapper Oefening.</span><span class="sxs-lookup"><span data-stu-id="393ba-162">Since hello call too[OpenConnectionForKey](http://msdn.microsoft.com/library/azure/dn807226.aspx) returns a regular SQL Client connection object, hello subsequent call toohello **Execute** extension method from Dapper follows hello standard Dapper practice.</span></span>

<span data-ttu-id="393ba-163">Query's werk te veel Hallo dezelfde manier - u eerst opent Hallo verbinding met [OpenConnectionForKey](http://msdn.microsoft.com/library/azure/dn807226.aspx) van Hallo client-API.</span><span class="sxs-lookup"><span data-stu-id="393ba-163">Queries work very much hello same way - you first open hello connection using [OpenConnectionForKey](http://msdn.microsoft.com/library/azure/dn807226.aspx) from hello client API.</span></span> <span data-ttu-id="393ba-164">U Hallo reguliere Dapper uitbreiding methoden toomap Hallo resultaten van uw SQL-query in .NET-objecten gebruiken:</span><span class="sxs-lookup"><span data-stu-id="393ba-164">Then you use hello regular Dapper extension methods toomap hello results of your SQL query into .NET objects:</span></span>

    using (SqlConnection sqlconn = shardingLayer.ShardMap.OpenConnectionForKey(
                    key: tenantId1, 
                    connectionString: connStrBldr.ConnectionString, 
                    options: ConnectionOptions.Validate ))
    {    
           // Display all Blogs for tenant 1
           IEnumerable<Blog> result = sqlconn.Query<Blog>(@"
                                SELECT * 
                                FROM Blog
                                ORDER BY Name");

           Console.WriteLine("All blogs for tenant id {0}:", tenantId1);
           foreach (var item in result)
           {
                Console.WriteLine(item.Name);
            }
    }

<span data-ttu-id="393ba-165">Houd er rekening mee dat Hallo **met** blokkeren met Hallo DDR verbinding scopes alle databasebewerkingen in Hallo blok toohello één shard waar tenantId1 wordt gehouden.</span><span class="sxs-lookup"><span data-stu-id="393ba-165">Note that hello **using** block with hello DDR connection scopes all database operations within hello block toohello one shard where tenantId1 is kept.</span></span> <span data-ttu-id="393ba-166">Hallo query retourneert alleen blogs opgeslagen op de huidige shard hello, maar niet Hallo die zijn opgeslagen op een andere shards.</span><span class="sxs-lookup"><span data-stu-id="393ba-166">hello query only returns blogs stored on hello current shard, but not hello ones stored on any other shards.</span></span> 

## <a name="data-dependent-routing-with-dapper-and-dapperextensions"></a><span data-ttu-id="393ba-167">Afhankelijke routering met Dapper en DapperExtensions gegevens</span><span class="sxs-lookup"><span data-stu-id="393ba-167">Data dependent routing with Dapper and DapperExtensions</span></span>
<span data-ttu-id="393ba-168">Dapper wordt geleverd met een ecosysteem van de aanvullende extensies die verdere gemak en abstractie uit hello database bieden kunnen bij het ontwikkelen van databasetoepassingen.</span><span class="sxs-lookup"><span data-stu-id="393ba-168">Dapper comes with an ecosystem of additional extensions that can provide further convenience and abstraction from hello database when developing database applications.</span></span> <span data-ttu-id="393ba-169">DapperExtensions is een voorbeeld.</span><span class="sxs-lookup"><span data-stu-id="393ba-169">DapperExtensions is an example.</span></span> 

<span data-ttu-id="393ba-170">DapperExtensions gebruiken in uw toepassing wordt niet gewijzigd hoe databaseverbindingen gemaakt en beheerd.</span><span class="sxs-lookup"><span data-stu-id="393ba-170">Using DapperExtensions in your application does not change how database connections are created and managed.</span></span> <span data-ttu-id="393ba-171">Nog steeds van toepassing hello verantwoordelijkheid tooopen verbindingen en reguliere SQL Client connection-objecten door Hallo uitbreidingsmethoden worden verwacht.</span><span class="sxs-lookup"><span data-stu-id="393ba-171">It is still hello application’s responsibility tooopen connections, and regular SQL Client connection objects are expected by hello extension methods.</span></span> <span data-ttu-id="393ba-172">We kunnen vertrouwen op Hallo [OpenConnectionForKey](http://msdn.microsoft.com/library/azure/dn807226.aspx) hierboven.</span><span class="sxs-lookup"><span data-stu-id="393ba-172">We can rely on hello [OpenConnectionForKey](http://msdn.microsoft.com/library/azure/dn807226.aspx) as outlined above.</span></span> <span data-ttu-id="393ba-173">Hallo tonen volgende codevoorbeelden, Hallo enige wijziging is dat er niet langer hoeft toowrite Hallo T-SQL-instructies:</span><span class="sxs-lookup"><span data-stu-id="393ba-173">As hello following code samples show, hello only change is that we do no longer have toowrite hello T-SQL statements:</span></span>

    using (SqlConnection sqlconn = shardingLayer.ShardMap.OpenConnectionForKey(
                    key: tenantId2, 
                    connectionString: connStrBldr.ConnectionString, 
                    options: ConnectionOptions.Validate))
    {
           var blog = new Blog { Name = name2 };
           sqlconn.Insert(blog);
    }

<span data-ttu-id="393ba-174">En dit codevoorbeeld Hallo voor Hallo-query is:</span><span class="sxs-lookup"><span data-stu-id="393ba-174">And here is hello code sample for hello query:</span></span> 

    using (SqlConnection sqlconn = shardingLayer.ShardMap.OpenConnectionForKey(
                    key: tenantId2, 
                    connectionString: connStrBldr.ConnectionString, 
                    options: ConnectionOptions.Validate))
    {
           // Display all Blogs for tenant 2
           IEnumerable<Blog> result = sqlconn.GetList<Blog>();
           Console.WriteLine("All blogs for tenant id {0}:", tenantId2);
           foreach (var item in result)
           {
               Console.WriteLine(item.Name);
           }
    }

### <a name="handling-transient-faults"></a><span data-ttu-id="393ba-175">Afhandeling van tijdelijke fouten</span><span class="sxs-lookup"><span data-stu-id="393ba-175">Handling transient faults</span></span>
<span data-ttu-id="393ba-176">Hallo Microsoft Patterns en procedures in een team gepubliceerde Hallo [tijdelijke fout afhandeling van Application Block](http://msdn.microsoft.com/library/hh680934.aspx) toohelp toepassingsontwikkelaars algemene tijdelijke storingen opgetreden tijdens het uitvoeren in de cloud Hallo beperken.</span><span class="sxs-lookup"><span data-stu-id="393ba-176">hello Microsoft Patterns & Practices team published hello [Transient Fault Handling Application Block](http://msdn.microsoft.com/library/hh680934.aspx) toohelp application developers mitigate common transient fault conditions encountered when running in hello cloud.</span></span> <span data-ttu-id="393ba-177">Zie voor meer informatie [Perseverance, geheim van alle successen: Hallo tijdelijke fout afhandeling van Application Block met](http://msdn.microsoft.com/library/dn440719.aspx).</span><span class="sxs-lookup"><span data-stu-id="393ba-177">For more information, see [Perseverance, Secret of All Triumphs: Using hello Transient Fault Handling Application Block](http://msdn.microsoft.com/library/dn440719.aspx).</span></span>

<span data-ttu-id="393ba-178">Hallo-codevoorbeeld is afhankelijk van Hallo tijdelijke fout bibliotheek tooprotect tegen tijdelijke fouten.</span><span class="sxs-lookup"><span data-stu-id="393ba-178">hello code sample relies on hello transient fault library tooprotect against transient faults.</span></span> 

    SqlDatabaseUtils.SqlRetryPolicy.ExecuteAction(() =>
    {
       using (SqlConnection sqlconn = 
          shardingLayer.ShardMap.OpenConnectionForKey(tenantId2, connStrBldr.ConnectionString, ConnectionOptions.Validate))
          {
              var blog = new Blog { Name = name2 };
              sqlconn.Insert(blog);
          }
    });

<span data-ttu-id="393ba-179">**SqlDatabaseUtils.SqlRetryPolicy** in Hallo bovenstaande code wordt gedefinieerd als een **SqlDatabaseTransientErrorDetectionStrategy** met een aantal nieuwe pogingen van 10 en 5 seconden wachttijd tussen nieuwe pogingen.</span><span class="sxs-lookup"><span data-stu-id="393ba-179">**SqlDatabaseUtils.SqlRetryPolicy** in hello code above is defined as a **SqlDatabaseTransientErrorDetectionStrategy** with a retry count of 10, and 5 seconds wait time between retries.</span></span> <span data-ttu-id="393ba-180">Als u van transacties gebruikmaakt, zorgt u ervoor dat uw bereik opnieuw terug toohello begin van de transactie in geval van een tijdelijke fout Hallo Hallo.</span><span class="sxs-lookup"><span data-stu-id="393ba-180">If you are using transactions, make sure that your retry scope goes back toohello beginning of hello transaction in hello case of a transient fault.</span></span>

## <a name="limitations"></a><span data-ttu-id="393ba-181">Beperkingen</span><span class="sxs-lookup"><span data-stu-id="393ba-181">Limitations</span></span>
<span data-ttu-id="393ba-182">Hallo-methoden die worden beschreven in dit document leidt tot een aantal beperkingen:</span><span class="sxs-lookup"><span data-stu-id="393ba-182">hello approaches outlined in this document entail a couple of limitations:</span></span>

* <span data-ttu-id="393ba-183">Hallo voorbeeldcode voor dit document biedt niet laten zien hoe toomanage schema via shards.</span><span class="sxs-lookup"><span data-stu-id="393ba-183">hello sample code for this document does not demonstrate how toomanage schema across shards.</span></span>
* <span data-ttu-id="393ba-184">Een aanvraag opgegeven, gaan we ervan uit dat alle bijbehorende verwerken van de database zich in een enkel shard aangeduid met de Hallo sharding sleutel van het Hallo-aanvraag.</span><span class="sxs-lookup"><span data-stu-id="393ba-184">Given a request, we assume that all its database processing is contained within a single shard as identified by hello sharding key provided by hello request.</span></span> <span data-ttu-id="393ba-185">Echter, deze aanname niet altijd bijhoudt, bijvoorbeeld wanneer het niet mogelijk toomake een sharding-sleutel beschikbaar.</span><span class="sxs-lookup"><span data-stu-id="393ba-185">However, this assumption does not always hold, for example, when it is not possible toomake a sharding key available.</span></span> <span data-ttu-id="393ba-186">tooaddress deze, Hallo clientbibliotheek voor elastische databases bevat Hallo [MultiShardQuery klasse](http://msdn.microsoft.com/library/azure/microsoft.azure.sqldatabase.elasticscale.query.multishardexception.aspx).</span><span class="sxs-lookup"><span data-stu-id="393ba-186">tooaddress this, hello elastic database client library includes hello [MultiShardQuery class](http://msdn.microsoft.com/library/azure/microsoft.azure.sqldatabase.elasticscale.query.multishardexception.aspx).</span></span> <span data-ttu-id="393ba-187">Hallo klasse implementeert een abstractie van de verbinding voor het uitvoeren van query's via meerdere shards.</span><span class="sxs-lookup"><span data-stu-id="393ba-187">hello class implements a connection abstraction for querying over several shards.</span></span> <span data-ttu-id="393ba-188">MultiShardQuery gebruiken in combinatie met Dapper valt buiten bereik Hallo van dit document.</span><span class="sxs-lookup"><span data-stu-id="393ba-188">Using MultiShardQuery in combination with Dapper is beyond hello scope of this document.</span></span>

## <a name="conclusion"></a><span data-ttu-id="393ba-189">Conclusie</span><span class="sxs-lookup"><span data-stu-id="393ba-189">Conclusion</span></span>
<span data-ttu-id="393ba-190">Toepassingen met Dapper en DapperExtensions kunnen eenvoudig profiteren van de hulpmiddelen voor elastische databases voor Azure SQL Database.</span><span class="sxs-lookup"><span data-stu-id="393ba-190">Applications using Dapper and DapperExtensions can easily benefit from elastic database tools for Azure SQL Database.</span></span> <span data-ttu-id="393ba-191">Via Hallo stappen in dit document, die toepassingen de mogelijkheid Hallo-hulpprogramma kunnen gebruiken voor afhankelijke routering door het wijzigen van Hallo maken en openen van nieuwe gegevens [SqlConnection](http://msdn.microsoft.com/library/system.data.sqlclient.sqlconnection.aspx) objecten toouse hello [ OpenConnectionForKey](http://msdn.microsoft.com/library/azure/dn807226.aspx) aanroep van Hallo-clientbibliotheek voor elastische database.</span><span class="sxs-lookup"><span data-stu-id="393ba-191">Through hello steps outlined in this document, those applications can use hello tool's capability for data dependent routing by changing hello creation and opening of new [SqlConnection](http://msdn.microsoft.com/library/system.data.sqlclient.sqlconnection.aspx) objects toouse hello [OpenConnectionForKey](http://msdn.microsoft.com/library/azure/dn807226.aspx) call of hello elastic database client library.</span></span> <span data-ttu-id="393ba-192">Dit beperkt Hallo toepassing wijzigingen vereist toothose plaatsen waar nieuwe verbindingen zijn gemaakt en geopend.</span><span class="sxs-lookup"><span data-stu-id="393ba-192">This limits hello application changes required toothose places where new connections are created and opened.</span></span> 

[!INCLUDE [elastic-scale-include](../../includes/elastic-scale-include.md)]

<!--Image references-->
[1]: ./media/sql-database-elastic-scale-working-with-dapper/dapperimage1.png
