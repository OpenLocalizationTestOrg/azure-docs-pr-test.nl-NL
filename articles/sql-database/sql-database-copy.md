---
title: "Kopiëren van een Azure SQL database | Microsoft Docs"
description: Maak een kopie van een Azure SQL database
services: sql-database
documentationcenter: 
author: CarlRabeler
manager: jhubbard
editor: 
ms.assetid: 5aaf6bcd-3839-49b5-8c77-cbdf786e359b
ms.service: sql-database
ms.custom: load & move data
ms.devlang: NA
ms.date: 06/15/2017
ms.author: carlrab
ms.workload: data-management
ms.topic: article
ms.tgt_pltfrm: NA
ms.openlocfilehash: 8c1e3c80b9f24089dc99463d6ea8ae5d0ea7b19d
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 07/11/2017
---
# <a name="copy-an-azure-sql-database"></a><span data-ttu-id="ec41b-103">Een Azure SQL database kopiëren</span><span class="sxs-lookup"><span data-stu-id="ec41b-103">Copy an Azure SQL database</span></span>

<span data-ttu-id="ec41b-104">Azure SQL Database biedt verschillende methoden voor het maken van een transactioneel consistent kopie van een bestaande Azure SQL-database op dezelfde server of een andere server.</span><span class="sxs-lookup"><span data-stu-id="ec41b-104">Azure SQL Database provides several methods for creating a transactionally consistent copy of an existing Azure SQL database on either the same server or a different server.</span></span> <span data-ttu-id="ec41b-105">U kunt een SQL-database kopiëren met behulp van de Azure-portal, PowerShell of T-SQL.</span><span class="sxs-lookup"><span data-stu-id="ec41b-105">You can copy a SQL database by using the Azure portal, PowerShell, or T-SQL.</span></span> 

## <a name="overview"></a><span data-ttu-id="ec41b-106">Overzicht</span><span class="sxs-lookup"><span data-stu-id="ec41b-106">Overview</span></span>

<span data-ttu-id="ec41b-107">Een databasekopie is een momentopname van de brondatabase vanaf het moment van de aanvraag van de kopie.</span><span class="sxs-lookup"><span data-stu-id="ec41b-107">A database copy is a snapshot of the source database as of the time of the copy request.</span></span> <span data-ttu-id="ec41b-108">U kunt dezelfde server of een andere server, de servicelaag en prestatieniveau of een andere prestatieniveau binnen de dezelfde servicetier (editie) selecteren.</span><span class="sxs-lookup"><span data-stu-id="ec41b-108">You can select the same server or a different server, its service tier and performance level, or a different performance level within the same service tier (edition).</span></span> <span data-ttu-id="ec41b-109">Nadat de kopie voltooid is, wordt een volledig functionele, onafhankelijke database.</span><span class="sxs-lookup"><span data-stu-id="ec41b-109">After the copy is complete, it becomes a fully functional, independent database.</span></span> <span data-ttu-id="ec41b-110">U kunt op dit moment upgrade of het downgraden naar een versie.</span><span class="sxs-lookup"><span data-stu-id="ec41b-110">At this point, you can upgrade or downgrade it to any edition.</span></span> <span data-ttu-id="ec41b-111">De aanmeldingen, gebruikers en machtigingen kunnen afzonderlijk worden beheerd.</span><span class="sxs-lookup"><span data-stu-id="ec41b-111">The logins, users, and permissions can be managed independently.</span></span>  

## <a name="logins-in-the-database-copy"></a><span data-ttu-id="ec41b-112">Aanmeldingen in de database-exemplaar</span><span class="sxs-lookup"><span data-stu-id="ec41b-112">Logins in the database copy</span></span>

<span data-ttu-id="ec41b-113">Wanneer u een database met dezelfde logische server kopieert, kunnen de dezelfde aanmeldingen op beide databases worden gebruikt.</span><span class="sxs-lookup"><span data-stu-id="ec41b-113">When you copy a database to the same logical server, the same logins can be used on both databases.</span></span> <span data-ttu-id="ec41b-114">De beveiligings-principal dat u gebruiken om te kopiëren van de database wordt de eigenaar van de database op de nieuwe database.</span><span class="sxs-lookup"><span data-stu-id="ec41b-114">The security principal you use to copy the database becomes the database owner on the new database.</span></span> <span data-ttu-id="ec41b-115">Alle databasegebruikers en hun machtigingen hun beveiligings-id's (SID's) gekopieerd naar het database-exemplaar.</span><span class="sxs-lookup"><span data-stu-id="ec41b-115">All database users, their permissions, and their security identifiers (SIDs) are copied to the database copy.</span></span>  

<span data-ttu-id="ec41b-116">Wanneer u een database naar een andere logische server kopiëren, wordt de beveiligings-principal op de nieuwe server in de database-eigenaar voor de nieuwe database.</span><span class="sxs-lookup"><span data-stu-id="ec41b-116">When you copy a database to a different logical server, the security principal on the new server becomes the database owner on the new database.</span></span> <span data-ttu-id="ec41b-117">Als u [databasegebruikers opgenomen](sql-database-manage-logins.md) voor toegang tot gegevens, zorg ervoor dat de primaire en secundaire databases altijd dezelfde gebruikersreferenties zodat nadat de kopie voltooid is u onmiddellijk toegang met dezelfde aanmeldingsgegevens.</span><span class="sxs-lookup"><span data-stu-id="ec41b-117">If you use [contained database users](sql-database-manage-logins.md) for data access, ensure that both the primary and secondary databases always have the same user credentials, so that after the copy is complete you can immediately access it with the same credentials.</span></span> 

<span data-ttu-id="ec41b-118">Als u [Azure Active Directory](../active-directory/active-directory-whatis.md), kunt u de noodzaak voor het beheren van referenties in de kopie volledig elimineren.</span><span class="sxs-lookup"><span data-stu-id="ec41b-118">If you use [Azure Active Directory](../active-directory/active-directory-whatis.md), you can completely eliminate the need for managing credentials in the copy.</span></span> <span data-ttu-id="ec41b-119">Echter, wanneer u de database naar een nieuwe server kopiëren, de aanmelding gebaseerde toegang werkt mogelijk niet, omdat de aanmeldingen niet bestaan op de nieuwe server.</span><span class="sxs-lookup"><span data-stu-id="ec41b-119">However, when you copy the database to a new server, the login-based access might not work, because the logins do not exist on the new server.</span></span> <span data-ttu-id="ec41b-120">Zie voor meer informatie over het beheren van aanmeldingen wanneer u een database naar een andere logische server kopiëren, [beveiliging voor Azure SQL database beheren na het herstel na noodgevallen](sql-database-geo-replication-security-config.md).</span><span class="sxs-lookup"><span data-stu-id="ec41b-120">To learn about managing logins when you copy a database to a different logical server, see [How to manage Azure SQL database security after disaster recovery](sql-database-geo-replication-security-config.md).</span></span> 

<span data-ttu-id="ec41b-121">Nadat het kopiëren is geslaagd en voordat andere gebruikers worden toegewezen, kunnen alleen de aanmelding die geïnitieerd het kopiëren, de eigenaar van de database zich kunt aanmelden bij de nieuwe database.</span><span class="sxs-lookup"><span data-stu-id="ec41b-121">After the copying succeeds and before other users are remapped, only the login that initiated the copying, the database owner, can log in to the new database.</span></span> <span data-ttu-id="ec41b-122">Om op te lossen aanmeldingen nadat het kopiëren voltooid is, Zie [aanmeldingen oplossen](#resolve-logins).</span><span class="sxs-lookup"><span data-stu-id="ec41b-122">To resolve logins after the copying operation is complete, see [Resolve logins](#resolve-logins).</span></span>

## <a name="copy-a-database-by-using-the-azure-portal"></a><span data-ttu-id="ec41b-123">Kopiëren van een database met behulp van de Azure-portal</span><span class="sxs-lookup"><span data-stu-id="ec41b-123">Copy a database by using the Azure portal</span></span>

<span data-ttu-id="ec41b-124">Als u wilt kopiëren van een database met behulp van de Azure-portal, open de pagina voor de database en klik vervolgens op **kopie**.</span><span class="sxs-lookup"><span data-stu-id="ec41b-124">To copy a database by using the Azure portal, open the page for your database, and then click **Copy**.</span></span> 

   ![Database-exemplaar](./media/sql-database-copy/database-copy.png)

## <a name="copy-a-database-by-using-powershell"></a><span data-ttu-id="ec41b-126">Een database met behulp van PowerShell kopiëren</span><span class="sxs-lookup"><span data-stu-id="ec41b-126">Copy a database by using PowerShell</span></span>

<span data-ttu-id="ec41b-127">Om te kopiëren van een database met behulp van PowerShell, gebruikt de [nieuw AzureRmSqlDatabaseCopy](/powershell/module/azurerm.sql/new-azurermsqldatabasecopy) cmdlet.</span><span class="sxs-lookup"><span data-stu-id="ec41b-127">To copy a database by using PowerShell, use the [New-AzureRmSqlDatabaseCopy](/powershell/module/azurerm.sql/new-azurermsqldatabasecopy) cmdlet.</span></span> 

```PowerShell
New-AzureRmSqlDatabaseCopy -ResourceGroupName "myResourceGroup" `
    -ServerName $sourceserver `
    -DatabaseName "MySampleDatabase" `
    -CopyResourceGroupName "myResourceGroup" `
    -CopyServerName $targetserver `
    -CopyDatabaseName "CopyOfMySampleDatabase"
```

<span data-ttu-id="ec41b-128">Zie voor een volledige voorbeeldscript [een database kopiëren naar een nieuwe server](scripts/sql-database-copy-database-to-new-server-powershell.md).</span><span class="sxs-lookup"><span data-stu-id="ec41b-128">For a complete sample script, see [Copy a database to a new server](scripts/sql-database-copy-database-to-new-server-powershell.md).</span></span>

## <a name="copy-a-database-by-using-transact-sql"></a><span data-ttu-id="ec41b-129">Kopiëren van een database met behulp van Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="ec41b-129">Copy a database by using Transact-SQL</span></span>

<span data-ttu-id="ec41b-130">Aanmelden bij de database master met de principal-aanmelding op serverniveau of de aanmelding die gemaakt van de database die u wilt kopiëren.</span><span class="sxs-lookup"><span data-stu-id="ec41b-130">Log in to the master database with the server-level principal login or the login that created the database you want to copy.</span></span> <span data-ttu-id="ec41b-131">Aanmeldingen die niet het niveau van de server principal moet voor de database kopiëren te laten slagen, leden van de rol dbmanager.</span><span class="sxs-lookup"><span data-stu-id="ec41b-131">For database copying to succeed, logins that are not the server-level principal must be members of the dbmanager role.</span></span> <span data-ttu-id="ec41b-132">Zie voor meer informatie over aanmeldingen en verbinding maken met de server [aanmeldingen beheren](sql-database-manage-logins.md).</span><span class="sxs-lookup"><span data-stu-id="ec41b-132">For more information about logins and connecting to the server, see [Manage logins](sql-database-manage-logins.md).</span></span>

<span data-ttu-id="ec41b-133">Beginnen met het kopiëren van de brondatabase met de [CREATE DATABASE](https://msdn.microsoft.com/library/ms176061.aspx) instructie.</span><span class="sxs-lookup"><span data-stu-id="ec41b-133">Start copying the source database with the [CREATE DATABASE](https://msdn.microsoft.com/library/ms176061.aspx) statement.</span></span> <span data-ttu-id="ec41b-134">Deze instructie uitvoert, wordt de database kopiëren proces gestart.</span><span class="sxs-lookup"><span data-stu-id="ec41b-134">Executing this statement initiates the database copying process.</span></span> <span data-ttu-id="ec41b-135">Omdat het kopiëren van een database een asynchrone is, retourneert de instructie CREATE DATABASE voordat het kopiëren van de database voltooid is.</span><span class="sxs-lookup"><span data-stu-id="ec41b-135">Because copying a database is an asynchronous process, the CREATE DATABASE statement returns before the database copying is complete.</span></span>

### <a name="copy-a-sql-database-to-the-same-server"></a><span data-ttu-id="ec41b-136">Een SQL-database kopiëren naar dezelfde server</span><span class="sxs-lookup"><span data-stu-id="ec41b-136">Copy a SQL database to the same server</span></span>
<span data-ttu-id="ec41b-137">Aanmelden bij de database master met de principal-aanmelding op serverniveau of de aanmelding die gemaakt van de database die u wilt kopiëren.</span><span class="sxs-lookup"><span data-stu-id="ec41b-137">Log in to the master database with the server-level principal login or the login that created the database you want to copy.</span></span> <span data-ttu-id="ec41b-138">Aanmeldingen die niet het niveau van de server principal moet voor de database kopiëren te laten slagen, leden van de rol dbmanager.</span><span class="sxs-lookup"><span data-stu-id="ec41b-138">For database copying to succeed, logins that are not the server-level principal must be members of the dbmanager role.</span></span>

<span data-ttu-id="ec41b-139">Met deze opdracht wordt Database1 gekopieerd naar een nieuwe database met de naam Database2 op dezelfde server.</span><span class="sxs-lookup"><span data-stu-id="ec41b-139">This command copies Database1 to a new database named Database2 on the same server.</span></span> <span data-ttu-id="ec41b-140">Afhankelijk van de grootte van uw database, kan de kopiëren bewerking even duren om te voltooien.</span><span class="sxs-lookup"><span data-stu-id="ec41b-140">Depending on the size of your database, the copying operation might take some time to complete.</span></span>

    -- Execute on the master database.
    -- Start copying.
    CREATE DATABASE Database1_copy AS COPY OF Database1;

### <a name="copy-a-sql-database-to-a-different-server"></a><span data-ttu-id="ec41b-141">Een SQL-database kopiëren naar een andere server</span><span class="sxs-lookup"><span data-stu-id="ec41b-141">Copy a SQL database to a different server</span></span>

<span data-ttu-id="ec41b-142">Aanmelden bij de database master van de doelserver, de SQL-databaseserver waar de nieuwe database wordt gemaakt.</span><span class="sxs-lookup"><span data-stu-id="ec41b-142">Log in to the master database of the destination server, the SQL database server where the new database is to be created.</span></span> <span data-ttu-id="ec41b-143">Gebruik een aanmelding met dezelfde naam en hetzelfde wachtwoord als de database-eigenaar van de brondatabase op de bronserver voor de SQL-database.</span><span class="sxs-lookup"><span data-stu-id="ec41b-143">Use a login that has the same name and password as the database owner of the source database on the source SQL database server.</span></span> <span data-ttu-id="ec41b-144">De aanmelding op de doelserver moet ook lid zijn van de rol dbmanager of worden de principal-aanmelding op serverniveau.</span><span class="sxs-lookup"><span data-stu-id="ec41b-144">The login on the destination server must also be a member of the dbmanager role or be the server-level principal login.</span></span>

<span data-ttu-id="ec41b-145">Deze opdracht kopieert Database1 op server1 naar een nieuwe database met de naam Database2 op server2.</span><span class="sxs-lookup"><span data-stu-id="ec41b-145">This command copies Database1 on server1 to a new database named Database2 on server2.</span></span> <span data-ttu-id="ec41b-146">Afhankelijk van de grootte van uw database, kan de kopiëren bewerking even duren om te voltooien.</span><span class="sxs-lookup"><span data-stu-id="ec41b-146">Depending on the size of your database, the copying operation might take some time to complete.</span></span>

    -- Execute on the master database of the target server (server2)
    -- Start copying from Server1 to Server2
    CREATE DATABASE Database1_copy AS COPY OF server1.Database1;


### <a name="monitor-the-progress-of-the-copying-operation"></a><span data-ttu-id="ec41b-147">De voortgang van de bewerking uit te kopiëren</span><span class="sxs-lookup"><span data-stu-id="ec41b-147">Monitor the progress of the copying operation</span></span>

<span data-ttu-id="ec41b-148">Het kopieerproces door het opvragen van de weergaven sys.databases en sys.dm_database_copies controleren.</span><span class="sxs-lookup"><span data-stu-id="ec41b-148">Monitor the copying process by querying the sys.databases and sys.dm_database_copies views.</span></span> <span data-ttu-id="ec41b-149">Terwijl het kopiëren uitgevoerd wordt, de **state_desc** kolom van de sys.databases voor de nieuwe database is ingesteld op **kopiëren**.</span><span class="sxs-lookup"><span data-stu-id="ec41b-149">While the copying is in progress, the **state_desc** column of the sys.databases view for the new database is set to **COPYING**.</span></span>

* <span data-ttu-id="ec41b-150">Als het kopiëren is mislukt, de **state_desc** kolom van de sys.databases voor de nieuwe database is ingesteld op **VERMOEDT**.</span><span class="sxs-lookup"><span data-stu-id="ec41b-150">If the copying fails, the **state_desc** column of the sys.databases view for the new database is set to **SUSPECT**.</span></span> <span data-ttu-id="ec41b-151">De instructie DROP niet uitvoeren op de nieuwe database en probeer het later opnieuw.</span><span class="sxs-lookup"><span data-stu-id="ec41b-151">Execute the DROP statement on the new database, and try again later.</span></span>
* <span data-ttu-id="ec41b-152">Als het kopiëren is gelukt, de **state_desc** kolom van de sys.databases voor de nieuwe database is ingesteld op **ONLINE**.</span><span class="sxs-lookup"><span data-stu-id="ec41b-152">If the copying succeeds, the **state_desc** column of the sys.databases view for the new database is set to **ONLINE**.</span></span> <span data-ttu-id="ec41b-153">Het kopiëren is voltooid en de nieuwe database is een reguliere-database die onafhankelijk van de brondatabase kan worden gewijzigd.</span><span class="sxs-lookup"><span data-stu-id="ec41b-153">The copying is complete, and the new database is a regular database that can be changed independent of the source database.</span></span>

> [!NOTE]
> <span data-ttu-id="ec41b-154">Uitvoeren als u besluit om te annuleren kopiëren terwijl deze uitgevoerd wordt, de [DROP DATABASE](https://msdn.microsoft.com/library/ms178613.aspx) instructie op de nieuwe database.</span><span class="sxs-lookup"><span data-stu-id="ec41b-154">If you decide to cancel the copying while it is in progress, execute the [DROP DATABASE](https://msdn.microsoft.com/library/ms178613.aspx) statement on the new database.</span></span> <span data-ttu-id="ec41b-155">U kunt ook annuleert de instructie DROP DATABASE worden uitgevoerd op de brondatabase ook het kopieerproces.</span><span class="sxs-lookup"><span data-stu-id="ec41b-155">Alternatively, executing the DROP DATABASE statement on the source database also cancels the copying process.</span></span>
> 

## <a name="resolve-logins"></a><span data-ttu-id="ec41b-156">Aanmeldingen oplossen</span><span class="sxs-lookup"><span data-stu-id="ec41b-156">Resolve logins</span></span>

<span data-ttu-id="ec41b-157">Nadat de nieuwe database op de doelserver online is, gebruikt u de [ALTER USER](https://msdn.microsoft.com/library/ms176060.aspx) instructie opnieuw toewijzen van de gebruikers van de nieuwe database aan aanmeldingen op de doelserver.</span><span class="sxs-lookup"><span data-stu-id="ec41b-157">After the new database is online on the destination server, use the [ALTER USER](https://msdn.microsoft.com/library/ms176060.aspx) statement to remap the users from the new database to logins on the destination server.</span></span> <span data-ttu-id="ec41b-158">Raadpleeg voor het oplossen van zwevende gebruikers [zwevende gebruikers dat problemen met](https://msdn.microsoft.com/library/ms175475.aspx).</span><span class="sxs-lookup"><span data-stu-id="ec41b-158">To resolve orphaned users, see [Troubleshoot Orphaned Users](https://msdn.microsoft.com/library/ms175475.aspx).</span></span> <span data-ttu-id="ec41b-159">Zie ook [beveiliging voor Azure SQL database beheren na het herstel na noodgevallen](sql-database-geo-replication-security-config.md).</span><span class="sxs-lookup"><span data-stu-id="ec41b-159">See also [How to manage Azure SQL database security after disaster recovery](sql-database-geo-replication-security-config.md).</span></span>

<span data-ttu-id="ec41b-160">Alle gebruikers in de nieuwe database behouden de machtigingen die ze hebben als in de brondatabase.</span><span class="sxs-lookup"><span data-stu-id="ec41b-160">All users in the new database retain the permissions that they had in the source database.</span></span> <span data-ttu-id="ec41b-161">De gebruiker die het database-exemplaar gestart wordt de database-eigenaar van de nieuwe database en een nieuwe beveiligings-id (SID) is toegewezen.</span><span class="sxs-lookup"><span data-stu-id="ec41b-161">The user who initiated the database copy becomes the database owner of the new database and is assigned a new security identifier (SID).</span></span> <span data-ttu-id="ec41b-162">Nadat het kopiëren is geslaagd en voordat andere gebruikers worden toegewezen, kunnen alleen de aanmelding die geïnitieerd het kopiëren, de eigenaar van de database zich kunt aanmelden bij de nieuwe database.</span><span class="sxs-lookup"><span data-stu-id="ec41b-162">After the copying succeeds and before other users are remapped, only the login that initiated the copying, the database owner, can log in to the new database.</span></span>

<span data-ttu-id="ec41b-163">Zie voor meer informatie over het beheren van gebruikers en aanmeldingen wanneer u een database naar een andere logische server kopiëren, [beveiliging voor Azure SQL database beheren na het herstel na noodgevallen](sql-database-geo-replication-security-config.md).</span><span class="sxs-lookup"><span data-stu-id="ec41b-163">To learn about managing users and logins when you copy a database to a different logical server, see [How to manage Azure SQL database security after disaster recovery](sql-database-geo-replication-security-config.md).</span></span>

## <a name="next-steps"></a><span data-ttu-id="ec41b-164">Volgende stappen</span><span class="sxs-lookup"><span data-stu-id="ec41b-164">Next steps</span></span>

* <span data-ttu-id="ec41b-165">Zie voor meer informatie over aanmeldingen [aanmeldingen beheren](sql-database-manage-logins.md) en [beveiliging voor Azure SQL database beheren na het herstel na noodgevallen](sql-database-geo-replication-security-config.md).</span><span class="sxs-lookup"><span data-stu-id="ec41b-165">For information about logins, see [Manage logins](sql-database-manage-logins.md) and [How to manage Azure SQL database security after disaster recovery](sql-database-geo-replication-security-config.md).</span></span>
* <span data-ttu-id="ec41b-166">Zie voor het exporteren van een database [exporteren van de database naar een BACPAC](sql-database-export.md).</span><span class="sxs-lookup"><span data-stu-id="ec41b-166">To export a database, see [Export the database to a BACPAC](sql-database-export.md).</span></span>
