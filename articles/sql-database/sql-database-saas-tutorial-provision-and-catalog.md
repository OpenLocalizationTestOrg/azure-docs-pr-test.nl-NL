---
title: nieuwe tenants aaaProvision in een multitenant-app die gebruikmaakt van Azure SQL Database | Microsoft Docs
description: Meer informatie over hoe tooprovision en catalogus nieuwe tenants in Hallo Wingtip SaaS-app
keywords: zelfstudie sql-database
services: sql-database
documentationcenter: 
author: stevestein
manager: craigg
editor: 
ms.assetid: 
ms.service: sql-database
ms.custom: scale out apps
ms.workload: data-management
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 08/11/2017
ms.author: sstein
ms.openlocfilehash: eb26f523305650c2124e36707d187dfcdad06fcc
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 10/06/2017
---
# <a name="provision-new-tenants-and-register-them-in-hello-catalog"></a><span data-ttu-id="3386d-104">Inrichten van nieuwe tenants en registreert u ze in de catalogus Hallo</span><span class="sxs-lookup"><span data-stu-id="3386d-104">Provision new tenants and register them in hello catalog</span></span>

<span data-ttu-id="3386d-105">In deze zelfstudie leert u Hallo inrichten en catalogus SaaS patronen en hoe ze worden geïmplementeerd in Hallo Wingtip SaaS-toepassing.</span><span class="sxs-lookup"><span data-stu-id="3386d-105">In this tutorial, you learn about hello provision and catalog SaaS patterns, and how they are implemented in hello Wingtip SaaS application.</span></span> <span data-ttu-id="3386d-106">U maakt en initialiseren van de nieuwe tenant-databases en registreert u ze in van de toepassing hello tenant-catalogus.</span><span class="sxs-lookup"><span data-stu-id="3386d-106">You create and initialize new tenant databases, and register them in hello application’s tenant catalog.</span></span> <span data-ttu-id="3386d-107">Hallo-catalogus is een database die wordt onderhouden door Hallo toewijzing tussen Hallo SaaS-toepassing van tal van tenants en hun gegevens.</span><span class="sxs-lookup"><span data-stu-id="3386d-107">hello catalog is a database that maintains hello mapping between hello SaaS application's many tenants and their data.</span></span> <span data-ttu-id="3386d-108">Hallo catalogus speelt een belangrijke rol toepassing aanvragen toohello juiste database sturen.</span><span class="sxs-lookup"><span data-stu-id="3386d-108">hello catalog plays an important role directing application requests toohello correct database.</span></span>  

<span data-ttu-id="3386d-109">In deze zelfstudie leert u het volgende:</span><span class="sxs-lookup"><span data-stu-id="3386d-109">In this tutorial, you learn how to:</span></span>

> [!div class="checklist"]

> * <span data-ttu-id="3386d-110">Een enkele nieuwe tenant, met inbegrip van hoe deze wordt geïmplementeerd doorlopen inrichten</span><span class="sxs-lookup"><span data-stu-id="3386d-110">Provision a single new tenant, including stepping through how this is implemented</span></span>
> * <span data-ttu-id="3386d-111">Verschillende tenants tegelijk inrichten</span><span class="sxs-lookup"><span data-stu-id="3386d-111">Provision a batch of additional tenants</span></span>


<span data-ttu-id="3386d-112">toocomplete in deze zelfstudie, zorg ervoor dat Hallo volgende vereisten zijn voltooid:</span><span class="sxs-lookup"><span data-stu-id="3386d-112">toocomplete this tutorial, make sure hello following prerequisites are completed:</span></span>

* <span data-ttu-id="3386d-113">Hallo Wingtip SaaS-app wordt geïmplementeerd.</span><span class="sxs-lookup"><span data-stu-id="3386d-113">hello Wingtip SaaS app is deployed.</span></span> <span data-ttu-id="3386d-114">Zie toodeploy in minder dan vijf minuten [implementeren en verkennen Hallo Wingtip SaaS-toepassing](sql-database-saas-tutorial.md)</span><span class="sxs-lookup"><span data-stu-id="3386d-114">toodeploy in less than five minutes, see [Deploy and explore hello Wingtip SaaS application](sql-database-saas-tutorial.md)</span></span>
* <span data-ttu-id="3386d-115">Azure PowerShell is geïnstalleerd.</span><span class="sxs-lookup"><span data-stu-id="3386d-115">Azure PowerShell is installed.</span></span> <span data-ttu-id="3386d-116">Zie [Aan de slag met Azure PowerShell](https://docs.microsoft.com/powershell/azure/get-started-azureps) voor meer informatie.</span><span class="sxs-lookup"><span data-stu-id="3386d-116">For details, see [Getting started with Azure PowerShell](https://docs.microsoft.com/powershell/azure/get-started-azureps)</span></span>

## <a name="introduction-toohello-saas-catalog-pattern"></a><span data-ttu-id="3386d-117">Inleiding toohello patroon van de SaaS-catalogus</span><span class="sxs-lookup"><span data-stu-id="3386d-117">Introduction toohello SaaS Catalog pattern</span></span>

<span data-ttu-id="3386d-118">Het is belangrijk tooknow waar informatie voor elke tenant wordt opgeslagen in een database back multitenant SaaS-toepassing.</span><span class="sxs-lookup"><span data-stu-id="3386d-118">In a database-backed multi-tenant SaaS application, it's important tooknow where information for each tenant is stored.</span></span> <span data-ttu-id="3386d-119">In Hallo SaaS catalogus patroon is een catalogusdatabase gebruikte toohold Hallo toewijzing tussen elke tenant en waar hun gegevens worden opgeslagen.</span><span class="sxs-lookup"><span data-stu-id="3386d-119">In hello SaaS catalog pattern, a catalog database is used toohold hello mapping between each tenant and where their data is stored.</span></span> <span data-ttu-id="3386d-120">Hallo Wingtip SaaS app gebruikmaakt van een één-tenant per database-architectuur, maar Hallo basispatroon voor het opslaan van de toewijzing van de tenant-naar-database in een catalogus van toepassing of een database met meerdere of één tenant wordt gebruikt.</span><span class="sxs-lookup"><span data-stu-id="3386d-120">hello Wingtip SaaS app uses a single-tenant per database architecture, but hello basic pattern of storing tenant-to-database mapping in a catalog applies whether a multi-tenant or single-tenant database is used.</span></span>

<span data-ttu-id="3386d-121">Elke tenant een sleutel die ze kunnen worden geïdentificeerd in de catalogus Hallo is toegewezen en toohello locatie van de juiste database Hallo die is toegewezen.</span><span class="sxs-lookup"><span data-stu-id="3386d-121">Each tenant is assigned a key that identifies them in hello catalog and which is mapped toohello location of hello appropriate database.</span></span> <span data-ttu-id="3386d-122">In-app Wingtip SaaS Hallo wordt Hallo-sleutel gevormd door een hash van Hallo tenantnaam.</span><span class="sxs-lookup"><span data-stu-id="3386d-122">In hello Wingtip SaaS app, hello key is formed from a hash of hello tenant’s name.</span></span> <span data-ttu-id="3386d-123">Dit kunt Hallo tenant-gedeelte van Hallo toepassing URL toobe tooconstruct Hallo sleutel gebruikt.</span><span class="sxs-lookup"><span data-stu-id="3386d-123">This allows hello tenant name portion of hello application URL toobe used tooconstruct hello key.</span></span> <span data-ttu-id="3386d-124">Andere schema's voor tenant-sleutel kunnen worden gebruikt.</span><span class="sxs-lookup"><span data-stu-id="3386d-124">Other tenant key schemes could be used.</span></span>  

<span data-ttu-id="3386d-125">Hallo catalogus kunt Hallo-naam of locatie van Hallo database toobe met minimale gevolgen voor de toepassing hello gewijzigd.</span><span class="sxs-lookup"><span data-stu-id="3386d-125">hello catalog allows hello name or location of hello database toobe changed with minimal impact on hello application.</span></span>  <span data-ttu-id="3386d-126">In een multitenant databasemodel dit ook geschikt is voor 'verplaatsen' een tenant tussen databases.</span><span class="sxs-lookup"><span data-stu-id="3386d-126">In a multi-tenant database model, this also accommodates ‘moving’ a tenant between databases.</span></span>  <span data-ttu-id="3386d-127">Hallo catalogus kan ook worden gebruikt tooindicate of een tenant of database offline is voor onderhoud of andere acties.</span><span class="sxs-lookup"><span data-stu-id="3386d-127">hello catalog can also be used tooindicate whether a tenant or database is offline for maintenance or other actions.</span></span> <span data-ttu-id="3386d-128">Dit is verkend in Hallo [herstellen van de zelfstudie voor één tenant](sql-database-saas-tutorial-restore-single-tenant.md).</span><span class="sxs-lookup"><span data-stu-id="3386d-128">This is explored in hello [restore single tenant tutorial](sql-database-saas-tutorial-restore-single-tenant.md).</span></span>

<span data-ttu-id="3386d-129">Bovendien Hallo catalog, wat een management-database voor een SaaS-toepassing actief is, kan extra tenant of database-metagegevens opslaan, zoals Hallo laag of editie van een database, schemaversie, service-abonnement of sla's aangeboden tootenants en andere gegevens die Hiermee kunt toepassingsbeheer, klantenondersteuning of devops-processen.</span><span class="sxs-lookup"><span data-stu-id="3386d-129">In addition, hello catalog, which is in effect a management database for a SaaS application, can store additional tenant or database metadata, such as hello tier or edition of a database, schema version, service plan, or SLAs offered tootenants, and other info that enables application management, customer support, or devops processes.</span></span>  

<span data-ttu-id="3386d-130">Afgezien van SaaS-toepassing hello, kunt Hallo catalogus Databasehulpprogramma's inschakelen.</span><span class="sxs-lookup"><span data-stu-id="3386d-130">Beyond hello SaaS application, hello catalog can enable database tools.</span></span>  <span data-ttu-id="3386d-131">In voorbeeld Wingtip SaaS Hallo Hallo catalogus gebruikte tooenable cross-tenant query, verkend in Hallo is [ad-hoc analytics zelfstudie](sql-database-saas-tutorial-adhoc-analytics.md).</span><span class="sxs-lookup"><span data-stu-id="3386d-131">In hello Wingtip SaaS sample, hello catalog is used tooenable cross-tenant query, explored in hello [ad hoc analytics tutorial](sql-database-saas-tutorial-adhoc-analytics.md).</span></span> <span data-ttu-id="3386d-132">Jobbeheer cross-database wordt verkend in Hallo [Schemabeheer](sql-database-saas-tutorial-schema-management.md) en [tenant analytics](sql-database-saas-tutorial-tenant-analytics.md) zelfstudies.</span><span class="sxs-lookup"><span data-stu-id="3386d-132">Cross-database job management is explored in hello [schema management](sql-database-saas-tutorial-schema-management.md) and [tenant analytics](sql-database-saas-tutorial-tenant-analytics.md) tutorials.</span></span> 

<span data-ttu-id="3386d-133">In-app Wingtip SaaS Hallo Hallo catalogus wordt geïmplementeerd met het Hallo Shard-beheerfuncties van Hallo met [elastische Database Client bibliotheek (EDCL)](sql-database-elastic-database-client-library.md).</span><span class="sxs-lookup"><span data-stu-id="3386d-133">In hello Wingtip SaaS app, hello catalog is implemented using hello Shard Management features of hello [Elastic Database Client Library (EDCL)](sql-database-elastic-database-client-library.md).</span></span> <span data-ttu-id="3386d-134">Hallo EDCL kunt u een toepassing toocreate, beheren en gebruiken van een database back shard-toewijzing.</span><span class="sxs-lookup"><span data-stu-id="3386d-134">hello EDCL enables an application toocreate, manage, and use a database-backed shard map.</span></span> <span data-ttu-id="3386d-135">Een shard-toewijzing bevat een lijst met shards (databases) en Hallo toewijzing tussen sleutels (tenants) en databases.</span><span class="sxs-lookup"><span data-stu-id="3386d-135">A shard map contains a list of shards (databases) and hello mapping between keys (tenants) and databases.</span></span>  <span data-ttu-id="3386d-136">EDCL functies uit toepassingen of PowerShell-scripts kunnen worden gebruikt tijdens tenant toocreate Hallo vermeldingen in de shard-toewijzing Hallo inrichting en van toepassingen tooefficiently verbinding maken met de juiste database toohello.</span><span class="sxs-lookup"><span data-stu-id="3386d-136">EDCL functions can be used from applications or PowerShell scripts during tenant provisioning toocreate hello entries in hello shard map, and from applications tooefficiently connect toohello correct database.</span></span> <span data-ttu-id="3386d-137">EDCL in de cache opgeslagen verbinding informatie toominimize Hallo verkeer toohello catalogusdatabase en de toepassing hello te versnellen.</span><span class="sxs-lookup"><span data-stu-id="3386d-137">EDCL caches connection information toominimize hello traffic toohello catalog database and speed up hello application.</span></span>  

> [!IMPORTANT]
> <span data-ttu-id="3386d-138">Hallo toewijzingsgegevens is toegankelijk in de database van de catalogus hello, maar *niet bewerken*!</span><span class="sxs-lookup"><span data-stu-id="3386d-138">hello mapping data is accessible in hello catalog database, but *don't edit it*!</span></span> <span data-ttu-id="3386d-139">Wijzig de toewijzingsgegevens alleen via API's van EDCL.</span><span class="sxs-lookup"><span data-stu-id="3386d-139">Edit mapping data using Elastic Database Client Library APIs only.</span></span> <span data-ttu-id="3386d-140">Rechtstreeks bewerken van Hallo toewijzingsgegevens risico's te beschadigen Hallo-catalogus en wordt niet ondersteund.</span><span class="sxs-lookup"><span data-stu-id="3386d-140">Directly manipulating hello mapping data risks corrupting hello catalog and is not supported.</span></span>


## <a name="introduction-toohello-saas-provisioning-pattern"></a><span data-ttu-id="3386d-141">Inleiding toohello SaaS inrichting patroon</span><span class="sxs-lookup"><span data-stu-id="3386d-141">Introduction toohello SaaS Provisioning pattern</span></span>

<span data-ttu-id="3386d-142">Bij het voorbereiden van een nieuwe tenant in een SaaS-toepassing die gebruikmaakt van moet een databasemodel voor één tenant-een nieuwe tenant-database worden ingericht.</span><span class="sxs-lookup"><span data-stu-id="3386d-142">When onboarding a new tenant in a SaaS application that uses a single-tenant database model a new tenant database must be provisioned.</span></span>  <span data-ttu-id="3386d-143">Deze moet worden gemaakt in de juiste locatie Hallo en geïnitialiseerd met het juiste schema- en referentiegegevens samenvoegt en vervolgens geregistreerd in de catalogus Hallo onder de juiste tenantsleutel Hallo servicelaag.</span><span class="sxs-lookup"><span data-stu-id="3386d-143">It must be created in hello appropriate location and service tier, initialized with appropriate schema and reference data, and then registered in hello catalog under hello appropriate tenant key.</span></span>  

<span data-ttu-id="3386d-144">Verschillende benaderingen kunnen gebruikte toodatabase inrichting, waaronder SQL-scripts uitvoeren, een bacpac implementeren of kopiëren van een sjabloondatabase van de 'gouden' kan worden.</span><span class="sxs-lookup"><span data-stu-id="3386d-144">Different approaches can be used toodatabase provisioning, which could include executing SQL scripts, deploying a bacpac, or copying a 'golden' template database.</span></span>  

<span data-ttu-id="3386d-145">Hallo inrichting aanpak die u gebruikt moet worden comprehended in de algemene schema beheerstrategie, die u ervoor zorgen moet dat nieuwe databases zijn ingericht met de meest recente schema Hallo.</span><span class="sxs-lookup"><span data-stu-id="3386d-145">hello provisioning approach you use must be comprehended in your overall schema management strategy, which must ensure that new databases are provisioned with hello latest schema.</span></span>  <span data-ttu-id="3386d-146">Dit is verkend in Hallo [schema management zelfstudie](sql-database-saas-tutorial-schema-management.md).</span><span class="sxs-lookup"><span data-stu-id="3386d-146">This is explored in hello [schema management tutorial](sql-database-saas-tutorial-schema-management.md).</span></span>  

<span data-ttu-id="3386d-147">Hallo Wingtip SaaS app bepalingen nieuwe tenants door het kopiëren van een gouden database met de naam basetenantdb, geïmplementeerd op Hallo-catalogusserver.</span><span class="sxs-lookup"><span data-stu-id="3386d-147">hello Wingtip SaaS app provisions new tenants by copying a golden database named basetenantdb, deployed on hello catalog server.</span></span>  <span data-ttu-id="3386d-148">Inrichting kan worden geïntegreerd in de toepassing hello als onderdeel van een aanmelding ervaring en/of ondersteunde offline met behulp van scripts.</span><span class="sxs-lookup"><span data-stu-id="3386d-148">Provisioning could be integrated into hello application as part of a sign-up experience, and/or supported offline using scripts.</span></span> <span data-ttu-id="3386d-149">Deze zelfstudie verkennen inrichten met behulp van PowerShell.</span><span class="sxs-lookup"><span data-stu-id="3386d-149">This tutorial will explore provisioning using PowerShell.</span></span> <span data-ttu-id="3386d-150">Hallo inrichting scripts Hallo basetenantdb toocreate een nieuwe tenant-database in een elastische pool kopiëren en vervolgens het met tenant-specifieke gegevens initialiseren en registreren in Hallo catalogus shard-toewijzing.</span><span class="sxs-lookup"><span data-stu-id="3386d-150">hello provisioning scripts copy hello basetenantdb toocreate a new tenant database in an elastic pool, then initialize it with tenant-specific info and register it in hello catalog shard map.</span></span>  <span data-ttu-id="3386d-151">In de voorbeeld-app Hallo krijgen databases namen op basis van de tenantnaam hello, maar dit is geen een essentieel onderdeel van het Hallo-patroon – Hallo Hallo catalog kunnen elke database met naam toobe toegewezen toohello. +</span><span class="sxs-lookup"><span data-stu-id="3386d-151">In hello sample app, databases are given names based on hello tenant name, but this is not a critical part of hello pattern – hello use of hello catalog allows any name toobe assigned toohello database.+</span></span> 


## <a name="get-hello-wingtip-application-scripts"></a><span data-ttu-id="3386d-152">Hallo Wingtip toepassingsscripts ophalen</span><span class="sxs-lookup"><span data-stu-id="3386d-152">Get hello Wingtip application scripts</span></span>

<span data-ttu-id="3386d-153">Hallo Wingtip SaaS-scripts en broncode van toepassing zijn beschikbaar in Hallo [WingtipSaaS](https://github.com/Microsoft/WingtipSaaS) github-opslagplaats.</span><span class="sxs-lookup"><span data-stu-id="3386d-153">hello Wingtip SaaS scripts and application source code are available in hello [WingtipSaaS](https://github.com/Microsoft/WingtipSaaS) github repo.</span></span> <span data-ttu-id="3386d-154">[Stappen toodownload Hallo Wingtip SaaS scripts](sql-database-wtp-overview.md#download-and-unblock-the-wingtip-saas-scripts).</span><span class="sxs-lookup"><span data-stu-id="3386d-154">[Steps toodownload hello Wingtip SaaS scripts](sql-database-wtp-overview.md#download-and-unblock-the-wingtip-saas-scripts).</span></span>


## <a name="provision-and-catalog-detailed-walkthrough"></a><span data-ttu-id="3386d-155">Gedetailleerd overzicht van inrichten en catalogiseren</span><span class="sxs-lookup"><span data-stu-id="3386d-155">Provision and catalog detailed walkthrough</span></span>

<span data-ttu-id="3386d-156">toounderstand hoe Hallo Wingtip toepassing implementeert een nieuwe tenant inrichting, een onderbrekingspunt toevoegen en doorloop Hallo werkstroom tijdens het inrichten van een tenant:</span><span class="sxs-lookup"><span data-stu-id="3386d-156">toounderstand how hello Wingtip application implements new tenant provisioning, add a breakpoint and step through hello workflow while provisioning a tenant:</span></span>

1. <span data-ttu-id="3386d-157">Open... \\Learning-Modules\\ProvisionAndCatalog\\_Demo ProvisionAndCatalog.ps1_ en Hallo set parameters te volgen:</span><span class="sxs-lookup"><span data-stu-id="3386d-157">Open ...\\Learning Modules\\ProvisionAndCatalog\\_Demo-ProvisionAndCatalog.ps1_ and set hello following parameters:</span></span>
   * <span data-ttu-id="3386d-158">**$TenantName** = Hallo-naam van de nieuwe wetten hello (bijvoorbeeld *Bushwillow blauwe*).</span><span class="sxs-lookup"><span data-stu-id="3386d-158">**$TenantName** = hello name of hello new venue (for example, *Bushwillow Blues*).</span></span>
   * <span data-ttu-id="3386d-159">**$VenueType** = Hallo vooraf gedefinieerde wetten soorten: *blauwe*, classicalmusic, dans, jazz, judo, motorracing multipurpose, opera, rockmusic, doel.</span><span class="sxs-lookup"><span data-stu-id="3386d-159">**$VenueType** = one of hello pre-defined venue types: *blues*, classicalmusic, dance, jazz, judo, motorracing, multipurpose, opera, rockmusic, soccer.</span></span>
   * <span data-ttu-id="3386d-160">**$DemoScenario** = **1**stelt te**1** te*inrichten van een enkele tenant*.</span><span class="sxs-lookup"><span data-stu-id="3386d-160">**$DemoScenario** = **1**, Set too**1** too*Provision a single tenant*.</span></span>

1. <span data-ttu-id="3386d-161">Een onderbrekingspunt toevoegen door de gegevens van de cursor overal op 48, Hallo regel waarin wordt gemeld: *New-Tenant '*, en druk op **F9**.</span><span class="sxs-lookup"><span data-stu-id="3386d-161">Add a breakpoint by putting your cursor anywhere on line 48, hello line that says: *New-Tenant \`*, and press **F9**.</span></span>

   ![onderbrekingspunt](media/sql-database-saas-tutorial-provision-and-catalog/breakpoint.png)

1. <span data-ttu-id="3386d-163">Druk op toorun Hallo script **F5**.</span><span class="sxs-lookup"><span data-stu-id="3386d-163">toorun hello script press **F5**.</span></span>

1. <span data-ttu-id="3386d-164">Nadat de uitvoering van het script Hallo stopt bij onderbrekingspunt Hallo, drukt u op **F11** toostep in Hallo-code.</span><span class="sxs-lookup"><span data-stu-id="3386d-164">After hello script execution stops at hello breakpoint, press **F11** toostep into hello code.</span></span>

   ![onderbrekingspunt](media/sql-database-saas-tutorial-provision-and-catalog/debug.png)



<span data-ttu-id="3386d-166">Hallo-script uitvoeren met behulp van Hallo traceren **Debug** menuopties - **F10** en **F11** toostep via of in Hallo functies genoemd.</span><span class="sxs-lookup"><span data-stu-id="3386d-166">Trace hello script's execution using hello **Debug** menu options - **F10** and **F11** toostep over or into hello called functions.</span></span> <span data-ttu-id="3386d-167">Zie voor meer informatie over foutopsporing van PowerShell-scripts [Tips voor het werken met en foutopsporing van PowerShell-scripts](https://msdn.microsoft.com/powershell/scripting/core-powershell/ise/how-to-debug-scripts-in-windows-powershell-ise).</span><span class="sxs-lookup"><span data-stu-id="3386d-167">For more information about debugging PowerShell scripts, see [Tips on working with and debugging PowerShell scripts](https://msdn.microsoft.com/powershell/scripting/core-powershell/ise/how-to-debug-scripts-in-windows-powershell-ise).</span></span>


<span data-ttu-id="3386d-168">Hallo volgen niet tooexplicitly Volg stappen, maar een uitleg van Hallo werkstroom doorlopen tijdens het opsporen van Hallo script:</span><span class="sxs-lookup"><span data-stu-id="3386d-168">hello following are not steps tooexplicitly follow, but an explanation of hello workflow you step through while debugging hello script:</span></span>

1. <span data-ttu-id="3386d-169">**Importeren Hallo SubscriptionManagement.psm1** module met functies voor tooAzure aanmelden en Hallo u met werkt Azure-abonnement selecteren.</span><span class="sxs-lookup"><span data-stu-id="3386d-169">**Import hello SubscriptionManagement.psm1** module that contains functions for signing in tooAzure and selecting hello Azure subscription you are working with.</span></span>
1. <span data-ttu-id="3386d-170">**Importeren Hallo CatalogAndDatabaseManagement.psm1** module die voorziet in een catalogus en op tenantniveau abstractie via Hallo [Shard Management](sql-database-elastic-scale-shard-map-management.md) functies.</span><span class="sxs-lookup"><span data-stu-id="3386d-170">**Import hello CatalogAndDatabaseManagement.psm1** module that provides a catalog and tenant-level abstraction over hello [Shard Management](sql-database-elastic-scale-shard-map-management.md) functions.</span></span> <span data-ttu-id="3386d-171">Dit is een belangrijk module die veel Hallo catalogus patroon ingekapseld en waard.</span><span class="sxs-lookup"><span data-stu-id="3386d-171">This is an important module that encapsulates much of hello catalog pattern and is worth exploring.</span></span>
1. <span data-ttu-id="3386d-172">**Ophalen van configuratiedetails**.</span><span class="sxs-lookup"><span data-stu-id="3386d-172">**Get configuration details**.</span></span> <span data-ttu-id="3386d-173">Stap in de Get-configuratie (met F11) en Zie hoe Hallo app-configuratie is opgegeven.</span><span class="sxs-lookup"><span data-stu-id="3386d-173">Step into Get-Configuration (with F11) and see how hello app config is specified.</span></span> <span data-ttu-id="3386d-174">Resourcenamen en andere waarden van app-specifiek hier zijn gedefinieerd, maar niet wijzigen van deze waarden totdat u bekend met het Hallo-scripts bent.</span><span class="sxs-lookup"><span data-stu-id="3386d-174">Resource names and other app-specific values are defined here, but do not change any of these values until you are familiar with hello scripts.</span></span>
1. <span data-ttu-id="3386d-175">**Ophalen van Hallo catalogusobject**.</span><span class="sxs-lookup"><span data-stu-id="3386d-175">**Get hello catalog object**.</span></span> <span data-ttu-id="3386d-176">Stap in dit stelt het bericht en retourneert een catalogusobject dat wordt gebruikt in een hoger niveau Hallo-script Get-catalogus.</span><span class="sxs-lookup"><span data-stu-id="3386d-176">Step into Get-Catalog which composes and returns a catalog object that is used in hello higher-level script.</span></span>  <span data-ttu-id="3386d-177">Hierbij wordt gebruikgemaakt van Shard-Management-functies die worden geïmporteerd vanuit **AzureShardManagement.psm1**.</span><span class="sxs-lookup"><span data-stu-id="3386d-177">This function uses Shard Management functions that are imported from **AzureShardManagement.psm1**.</span></span> <span data-ttu-id="3386d-178">Hallo catalog-object van Hallo volgende bestaat:</span><span class="sxs-lookup"><span data-stu-id="3386d-178">hello catalog object is composed of hello following:</span></span>
   * <span data-ttu-id="3386d-179">$catalogServerFullyQualifiedName is opgesteld met standaard stam Hallo plus uw gebruikersnaam: _catalogus -\<gebruiker\>. database.windows.net_.</span><span class="sxs-lookup"><span data-stu-id="3386d-179">$catalogServerFullyQualifiedName is constructed using hello standard stem plus your User name: _catalog-\<user\>.database.windows.net_.</span></span>
   * <span data-ttu-id="3386d-180">$catalogDatabaseName wordt opgehaald uit het Hallo-config: *tenantcatalog*.</span><span class="sxs-lookup"><span data-stu-id="3386d-180">$catalogDatabaseName is retrieved from hello config: *tenantcatalog*.</span></span>
   * <span data-ttu-id="3386d-181">$shardMapManager object is uit Hallo catalogusdatabase geïnitialiseerd.</span><span class="sxs-lookup"><span data-stu-id="3386d-181">$shardMapManager object is initialized from hello catalog database.</span></span>
   * <span data-ttu-id="3386d-182">$shardMap object wordt geïnitialiseerd vanuit Hallo *tenantcatalog* shard-toewijzing in Hallo catalogus-database.</span><span class="sxs-lookup"><span data-stu-id="3386d-182">$shardMap object is initialized from hello *tenantcatalog* shard map in hello catalog database.</span></span>
   <span data-ttu-id="3386d-183">Een catalogusobject is samengesteld, geretourneerd en gebruikt in een hoger niveau Hallo-script.</span><span class="sxs-lookup"><span data-stu-id="3386d-183">A catalog object is composed and returned, and used in hello higher-level script.</span></span>
1. <span data-ttu-id="3386d-184">**Berekenen van de nieuwe tenantsleutel hello**.</span><span class="sxs-lookup"><span data-stu-id="3386d-184">**Calculate hello new tenant key**.</span></span> <span data-ttu-id="3386d-185">Een hash-functie is gebruikte toocreate Hallo-tenantsleutel van Hallo tenantnaam.</span><span class="sxs-lookup"><span data-stu-id="3386d-185">A hash function is used toocreate hello tenant key from hello tenant name.</span></span>
1. <span data-ttu-id="3386d-186">**Controleer of de tenantsleutel Hallo al bestaat**.</span><span class="sxs-lookup"><span data-stu-id="3386d-186">**Check if hello tenant key already exists**.</span></span> <span data-ttu-id="3386d-187">Hallo-catalogus wordt gecontroleerd tooensure Hallo sleutel beschikbaar is.</span><span class="sxs-lookup"><span data-stu-id="3386d-187">hello catalog is checked tooensure hello key is available.</span></span>
1. <span data-ttu-id="3386d-188">**Hallo tenant-database is ingericht met New-TenantDatabase.**</span><span class="sxs-lookup"><span data-stu-id="3386d-188">**hello tenant database is provisioned with New-TenantDatabase.**</span></span> <span data-ttu-id="3386d-189">Gebruik **F11** toostep in en Zie hoe Hallo-database is ingericht met behulp van een [Azure Resource Manager-sjabloon](../azure-resource-manager/resource-manager-template-walkthrough.md).</span><span class="sxs-lookup"><span data-stu-id="3386d-189">Use **F11** toostep in and see how hello database is provisioned using an [Azure Resource Manager template](../azure-resource-manager/resource-manager-template-walkthrough.md).</span></span>

<span data-ttu-id="3386d-190">Hallo-databasenaam is samengesteld uit Hallo tenant naam toomake het wissen welke shard toowhich tenant behoort.</span><span class="sxs-lookup"><span data-stu-id="3386d-190">hello database name is constructed from hello tenant name toomake it clear which shard belongs toowhich tenant.</span></span> <span data-ttu-id="3386d-191">(Andere strategieën voor het benoemen van de database kunnen eenvoudig worden gebruikt.) + Een Resource Manager-sjabloon is gebruikte toocreate een tenant-database door het kopiëren van een gouden database (baseTenantDB) op Hallo-catalogusserver.</span><span class="sxs-lookup"><span data-stu-id="3386d-191">(Other strategies for database naming could easily be used.)+ A Resource Manager template is used toocreate a tenant database by copying a golden database (baseTenantDB) on hello catalog server.</span></span> <span data-ttu-id="3386d-192">Een alternatieve methode kan worden toocreate een lege database en vervolgens het initialiseren door het importeren van een Bacpac- of tooexecute een script voor initialisatie van een bekende locatie.</span><span class="sxs-lookup"><span data-stu-id="3386d-192">An alternative approach could be toocreate an empty database and then initialize it by importing a bacpac, or tooexecute an initialization script from a well-known location.</span></span>  

<span data-ttu-id="3386d-193">Hallo Resource Manager-sjabloon bevindt zich in Hallo ...\Learning Modules\Common\ map: *tenantdatabasecopytemplate.json*</span><span class="sxs-lookup"><span data-stu-id="3386d-193">hello Resource Manager template is in hello …\Learning Modules\Common\ folder: *tenantdatabasecopytemplate.json*</span></span>

<span data-ttu-id="3386d-194">Nadat het Hallo-tenant-database is gemaakt, is deze verdere **geïnitialiseerd met hello wilt (tenant) naam en type op Hallo wilt**.</span><span class="sxs-lookup"><span data-stu-id="3386d-194">After hello tenant database is created, it is then further **initialized with hello venue (tenant) name and hello venue type**.</span></span> <span data-ttu-id="3386d-195">Hier kunnen ook andere initialisaties plaatsvinden.</span><span class="sxs-lookup"><span data-stu-id="3386d-195">Other initialization could also be done here.</span></span>

<span data-ttu-id="3386d-196">Hallo **tenant-database is geregistreerd in de catalogus Hallo** met *toevoegen TenantDatabaseToCatalog* hello tenantsleutel.</span><span class="sxs-lookup"><span data-stu-id="3386d-196">hello **tenant database is registered in hello catalog** with *Add-TenantDatabaseToCatalog* using hello tenant key.</span></span> <span data-ttu-id="3386d-197">Gebruik **F11** toostep in Hallo details:</span><span class="sxs-lookup"><span data-stu-id="3386d-197">Use **F11** toostep into hello details:</span></span>

* <span data-ttu-id="3386d-198">Hallo catalogusdatabase toegevoegd toohello shard-toewijzing (Hallo lijst met bekende databases).</span><span class="sxs-lookup"><span data-stu-id="3386d-198">hello catalog database is added toohello shard map (hello list of known databases).</span></span>
* <span data-ttu-id="3386d-199">toewijzing van die koppelingen Hallo sleutelwaarde toohello shard Hello wordt gemaakt.</span><span class="sxs-lookup"><span data-stu-id="3386d-199">hello mapping that links hello key value toohello shard is created.</span></span>
* <span data-ttu-id="3386d-200">Aanvullende metagegevens (naam van hello wilt) over Hallo-tenant is toohello Tenants tabel toegevoegd in Hallo-catalogus.</span><span class="sxs-lookup"><span data-stu-id="3386d-200">Additional meta data (hello venue's name) about hello tenant is added toohello Tenants table in hello catalog.</span></span>  <span data-ttu-id="3386d-201">Hallo Tenants tabel maakt geen deel uit van Hallo ShardManagement schema en niet is geïnstalleerd door Hallo EDCL.</span><span class="sxs-lookup"><span data-stu-id="3386d-201">hello Tenants table is not part of hello ShardManagement schema and is not installed by hello EDCL.</span></span>  <span data-ttu-id="3386d-202">Deze tabel ziet u hoe Hallo catalogusdatabase kan worden uitgebreid toosupport aanvullende toepassingsspecifieke gegevens.</span><span class="sxs-lookup"><span data-stu-id="3386d-202">This table illustrates how hello Catalog database can be extended toosupport additional application-specific data.</span></span>   


<span data-ttu-id="3386d-203">Nadat het inrichten is voltooid, uitvoering retourneert toohello oorspronkelijke *Demo ProvisionAndCatalog* script, dat wordt geopend Hallo **gebeurtenissen** pagina voor de nieuwe tenant in de browser Hallo Hallo:</span><span class="sxs-lookup"><span data-stu-id="3386d-203">After provisioning completes, execution returns toohello original *Demo-ProvisionAndCatalog* script, which opens hello **Events** page for hello new tenant in hello browser:</span></span>

   ![events](media/sql-database-saas-tutorial-provision-and-catalog/new-tenant.png)


## <a name="provision-a-batch-of-tenants"></a><span data-ttu-id="3386d-205">Een batch van tenants inrichten</span><span class="sxs-lookup"><span data-stu-id="3386d-205">Provision a batch of tenants</span></span>

<span data-ttu-id="3386d-206">In deze oefening voorziet in een batch 17 tenants.</span><span class="sxs-lookup"><span data-stu-id="3386d-206">This exercise provisions a batch of 17 tenants.</span></span> <span data-ttu-id="3386d-207">Het raadzaam dat u deze batch van tenants voordat u andere zelfstudies Wingtip SaaS zodat er meer dan een paar databases toowork met inrichten.</span><span class="sxs-lookup"><span data-stu-id="3386d-207">It’s recommended you provision this batch of tenants before starting other Wingtip SaaS tutorials, so there's more than just a few databases toowork with.</span></span>

1. <span data-ttu-id="3386d-208">Open... \\Learning-Modules\\ProvisionAndCatalog\\*Demo ProvisionAndCatalog.ps1* in Hallo *PowerShell ISE* en wijzig Hallo *$ DemoScenario* parameter too3:</span><span class="sxs-lookup"><span data-stu-id="3386d-208">Open ...\\Learning Modules\\ProvisionAndCatalog\\*Demo-ProvisionAndCatalog.ps1* in hello *PowerShell ISE* and change hello *$DemoScenario* parameter too3:</span></span>
   * <span data-ttu-id="3386d-209">**$DemoScenario** = **3**, ook wijzigen**3** te*inrichten van een batch van tenants*.</span><span class="sxs-lookup"><span data-stu-id="3386d-209">**$DemoScenario** = **3**, change too**3** too*Provision a batch of tenants*.</span></span>
1. <span data-ttu-id="3386d-210">Druk op **F5** Hallo script en uitvoeren.</span><span class="sxs-lookup"><span data-stu-id="3386d-210">Press **F5** and run hello script.</span></span>

<span data-ttu-id="3386d-211">Hallo-script wordt een reeks extra tentants geïmplementeerd.</span><span class="sxs-lookup"><span data-stu-id="3386d-211">hello script deploys a batch of additional tenants.</span></span> <span data-ttu-id="3386d-212">Dit maakt gebruik van een [Azure Resource Manager-sjabloon](../azure-resource-manager/resource-manager-template-walkthrough.md) die Hallo batch regelt en vervolgens delegeert inrichten van elke database tooa gekoppelde sjabloon.</span><span class="sxs-lookup"><span data-stu-id="3386d-212">It uses an [Azure Resource Manager template](../azure-resource-manager/resource-manager-template-walkthrough.md) that controls hello batch and then delegates provisioning of each database tooa linked template.</span></span> <span data-ttu-id="3386d-213">Met behulp van sjablonen op deze manier kunt Azure Resource Manager toobroker Hallo inrichtingsproces voor uw script.</span><span class="sxs-lookup"><span data-stu-id="3386d-213">Using templates in this way allows Azure Resource Manager toobroker hello provisioning process for your script.</span></span> <span data-ttu-id="3386d-214">Sjablonen inrichten databases parallel waar het kan en pogingen indien nodig, verwerkt Hallo algemene processen te optimaliseren.</span><span class="sxs-lookup"><span data-stu-id="3386d-214">Templates provision databases in parallel where it can, and handles retries if needed, optimizing hello overall process.</span></span> <span data-ttu-id="3386d-215">Hallo script is idempotent dus als dit mislukt of om welke reden gestopt Voer dit opnieuw.</span><span class="sxs-lookup"><span data-stu-id="3386d-215">hello script is idempotent so if it fails or stops for any reason, run it again.</span></span>

### <a name="verify-hello-batch-of-tenants-successfully-deployed"></a><span data-ttu-id="3386d-216">Controleer of Hallo batch van tenants is geïmplementeerd</span><span class="sxs-lookup"><span data-stu-id="3386d-216">Verify hello batch of tenants successfully deployed</span></span>

* <span data-ttu-id="3386d-217">Open Hallo *tenants1* server door te bladeren tooyour lijst met servers in Hallo [Azure-portal](https://portal.azure.com), klikt u op **SQL-databases**, en controleer of Hallo batch van 17 extra databases zijn nu in de lijst Hallo:</span><span class="sxs-lookup"><span data-stu-id="3386d-217">Open hello *tenants1* server by browsing tooyour list of servers in hello [Azure portal](https://portal.azure.com), click **SQL databases**, and verify hello batch of 17 additional databases are now in hello list:</span></span>

   ![databaselijst](media/sql-database-saas-tutorial-provision-and-catalog/database-list.png)



## <a name="other-provisioning-patterns"></a><span data-ttu-id="3386d-219">Andere inrichtingspatronen</span><span class="sxs-lookup"><span data-stu-id="3386d-219">Other provisioning patterns</span></span>

<span data-ttu-id="3386d-220">Dit zijn twee inrichtingspatronen die niet aan bod zijn gekomen in deze zelfstudie:</span><span class="sxs-lookup"><span data-stu-id="3386d-220">Other provisioning patterns not included in this tutorial include:</span></span>

<span data-ttu-id="3386d-221">**Vooraf inrichten van databases.**</span><span class="sxs-lookup"><span data-stu-id="3386d-221">**Pre-provisioning databases.**</span></span> <span data-ttu-id="3386d-222">Hallo vooraf inrichten patroon aanvallen op Hallo feit dat de databases in een elastische pool Voeg geen extra kosten verbonden.</span><span class="sxs-lookup"><span data-stu-id="3386d-222">hello pre-provisioning pattern exploits hello fact that databases in an elastic pool do not add extra cost.</span></span> <span data-ttu-id="3386d-223">Facturering voor de elastische groep Hallo is, niet Hallo databases en niet-actieve databases geen resources gebruiken.</span><span class="sxs-lookup"><span data-stu-id="3386d-223">Billing is for hello elastic pool, not hello databases, and idle databases consume no resources.</span></span> <span data-ttu-id="3386d-224">Databases in een pool vooraf worden ingericht en wijzen wanneer dit nodig is, kan de tenant onboarding tijd aanzienlijk worden verkleind.</span><span class="sxs-lookup"><span data-stu-id="3386d-224">By pre-provisioning databases in a pool and allocating them when needed, tenant onboarding time can be reduced significantly.</span></span> <span data-ttu-id="3386d-225">Hallo aantal databases dat vooraf is ingericht kan worden aangepast benodigde tookeep een buffer die geschikt is voor Hallo verwacht snelheid wordt ingericht.</span><span class="sxs-lookup"><span data-stu-id="3386d-225">hello number of databases pre-provisioned could be adjusted as needed tookeep a buffer suitable for hello anticipated provisioning rate.</span></span>

<span data-ttu-id="3386d-226">**Automatische inrichting.**</span><span class="sxs-lookup"><span data-stu-id="3386d-226">**Auto-provisioning.**</span></span> <span data-ttu-id="3386d-227">In Hallo automatische inrichting patroon een speciale inrichting service is gebruikte tooprovision servers, -adresgroepen en -databases automatisch naar behoefte – waaronder vooraf inrichten databases in een elastische pools indien gewenst.</span><span class="sxs-lookup"><span data-stu-id="3386d-227">In hello auto-provisioning pattern, a dedicated provisioning service is used tooprovision servers, pools, and databases automatically as needed – including pre-provisioning databases in elastic pools if desired.</span></span> <span data-ttu-id="3386d-228">En als de databases zijn opdracht ongedaan en verwijderd, hiaten in de elastische pools kunnen worden gevuld door Hallo-service naar wens inricht.</span><span class="sxs-lookup"><span data-stu-id="3386d-228">And if databases are de-commissioned and deleted, gaps in elastic pools can be filled by hello provisioning service as desired.</span></span> <span data-ttu-id="3386d-229">Deze service kan eenvoudig of complex – bijvoorbeeld afhandeling van de inrichting voor meerdere locaties en kan geo-replicatie wordt automatisch ingesteld als deze strategie wordt gebruikt voor herstel na noodgevallen.</span><span class="sxs-lookup"><span data-stu-id="3386d-229">Such a service could be simple or complex – for example, handling provisioning across multiple geographies, and could set up geo-replication automatically if that strategy is being used for disaster recovery.</span></span> <span data-ttu-id="3386d-230">Hallo automatische inrichting patroon een clienttoepassing of script zou een inrichting wachtrij toobe voor aanvraag tooa verwerkt door het Hallo-service inricht verzenden en zou vervolgens Hallo service toodetermine voltooiing pollen.</span><span class="sxs-lookup"><span data-stu-id="3386d-230">With hello auto-provisioning pattern, a client application or script would submit a provisioning request tooa queue toobe processed by hello provisioning service, and would then poll hello service toodetermine completion.</span></span> <span data-ttu-id="3386d-231">Als vooraf inrichten wordt gebruikt, zou aanvragen snel worden verwerkt met Hallo-service beheert het inrichten van een vervanging-database op de achtergrond Hallo uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="3386d-231">If pre-provisioning is used, requests would be handled quickly with hello service managing provisioning of a replacement database running in hello background.</span></span>



## <a name="next-steps"></a><span data-ttu-id="3386d-232">Volgende stappen</span><span class="sxs-lookup"><span data-stu-id="3386d-232">Next steps</span></span>

<span data-ttu-id="3386d-233">In deze zelfstudie hebt u het volgende geleerd:</span><span class="sxs-lookup"><span data-stu-id="3386d-233">In this tutorial you learned how to:</span></span>

> [!div class="checklist"]

> * <span data-ttu-id="3386d-234">Eén nieuwe tenant inrichten</span><span class="sxs-lookup"><span data-stu-id="3386d-234">Provision a single new tenant</span></span>
> * <span data-ttu-id="3386d-235">Verschillende tenants tegelijk inrichten</span><span class="sxs-lookup"><span data-stu-id="3386d-235">Provision a batch of additional tenants</span></span>
> * <span data-ttu-id="3386d-236">Stap in de details van de inrichting van tenants en geregistreerd in de catalogus Hallo Hallo</span><span class="sxs-lookup"><span data-stu-id="3386d-236">Step into hello details of provisioning tenants, and registering them into hello catalog</span></span>

<span data-ttu-id="3386d-237">Probeer Hallo [prestaties bewaking zelfstudie](sql-database-saas-tutorial-performance-monitoring.md).</span><span class="sxs-lookup"><span data-stu-id="3386d-237">Try hello [Performance monitoring tutorial](sql-database-saas-tutorial-performance-monitoring.md).</span></span>

## <a name="additional-resources"></a><span data-ttu-id="3386d-238">Aanvullende resources</span><span class="sxs-lookup"><span data-stu-id="3386d-238">Additional Resources</span></span>

* <span data-ttu-id="3386d-239">Aanvullende [zelfstudies waarin voort op Hallo Wingtip SaaS-toepassing bouwen](sql-database-wtp-overview.md#sql-database-wingtip-saas-tutorials)</span><span class="sxs-lookup"><span data-stu-id="3386d-239">Additional [tutorials that build upon hello Wingtip SaaS application](sql-database-wtp-overview.md#sql-database-wingtip-saas-tutorials)</span></span>
* [<span data-ttu-id="3386d-240">Clientbibliotheek voor Elastic Database</span><span class="sxs-lookup"><span data-stu-id="3386d-240">Elastic database client library</span></span>](https://docs.microsoft.com/azure/sql-database/sql-database-elastic-database-client-library)
* [<span data-ttu-id="3386d-241">Hoe tooDebug Scripts in Windows PowerShell ISE</span><span class="sxs-lookup"><span data-stu-id="3386d-241">How tooDebug Scripts in Windows PowerShell ISE</span></span>](https://msdn.microsoft.com/powershell/scripting/core-powershell/ise/how-to-debug-scripts-in-windows-powershell-ise)
