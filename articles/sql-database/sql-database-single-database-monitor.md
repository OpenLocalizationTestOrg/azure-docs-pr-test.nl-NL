---
title: prestaties van de database in Azure SQL Database aaaMonitoring | Microsoft Docs
description: Meer informatie over het Hallo-opties voor het controleren van de database met Azure-hulpprogramma's en dynamische Beheerweergave.
keywords: database bewaken, prestaties van clouddatabase
services: sql-database
documentationcenter: 
author: CarlRabeler
manager: jhubbard
editor: 
ms.assetid: a2e47475-c955-4a8d-a65c-cbef9a6d9b9f
ms.service: sql-database
ms.custom: monitor & tune
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: data-management
ms.date: 01/10/2017
ms.author: carlrab
ms.openlocfilehash: b13771183d4ccf37f58e2fc518b9b14de38212dc
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 10/06/2017
---
# <a name="monitoring-database-performance-in-azure-sql-database"></a><span data-ttu-id="b706a-104">Databaseprestaties bewaken in Azure SQL Database</span><span class="sxs-lookup"><span data-stu-id="b706a-104">Monitoring database performance in Azure SQL Database</span></span>
<span data-ttu-id="b706a-105">Hallo prestatiecontrole van een SQL-database in Azure begint met het bewaken van Hallo resource relatieve toohello het gebruiksniveau van databaseprestaties.</span><span class="sxs-lookup"><span data-stu-id="b706a-105">Monitoring hello performance of a SQL database in Azure starts with monitoring hello resource utilization relative toohello level of database performance you choose.</span></span> <span data-ttu-id="b706a-106">Bewaking, kunt u bepalen of uw database veel capaciteit heeft of juist problemen heeft omdat resources volledig worden benut uit en vervolgens besluit of het is tijd tooadjust Hallo prestatieniveau en [servicelaag](sql-database-service-tiers.md) van uw database.</span><span class="sxs-lookup"><span data-stu-id="b706a-106">Monitoring helps you  determine whether your database has excess capacity or is having trouble because resources are maxed out, and then decide whether it's time tooadjust hello performance level and [service tier](sql-database-service-tiers.md) of your database.</span></span> <span data-ttu-id="b706a-107">U kunt een database bewaken met grafische hulpprogramma's in Hallo [Azure-portal](https://portal.azure.com) of met behulp van SQL [dynamische beheerweergaven](https://msdn.microsoft.com/library/ms188754.aspx).</span><span class="sxs-lookup"><span data-stu-id="b706a-107">You can monitor your database using graphical tools in hello [Azure portal](https://portal.azure.com) or using SQL [dynamic management views](https://msdn.microsoft.com/library/ms188754.aspx).</span></span>

## <a name="monitor-databases-using-hello-azure-portal"></a><span data-ttu-id="b706a-108">Databases bewaken via hello Azure-portal</span><span class="sxs-lookup"><span data-stu-id="b706a-108">Monitor databases using hello Azure portal</span></span>
<span data-ttu-id="b706a-109">In Hallo [Azure-portal](https://portal.azure.com/), kunt u gebruik van een individuele database bewaken door uw database selecteren en te klikken op Hallo **bewaking** grafiek.</span><span class="sxs-lookup"><span data-stu-id="b706a-109">In hello [Azure portal](https://portal.azure.com/), you can monitor a single database’s utilization by selecting your database and clicking hello **Monitoring** chart.</span></span> <span data-ttu-id="b706a-110">Hiermee wordt een **metriek** venster die u wijzigen kunt door te klikken op Hallo **grafiek bewerken** knop.</span><span class="sxs-lookup"><span data-stu-id="b706a-110">This brings up a **Metric** window that you can change by clicking hello **Edit chart** button.</span></span> <span data-ttu-id="b706a-111">Voeg Hallo metrische gegevens te volgen:</span><span class="sxs-lookup"><span data-stu-id="b706a-111">Add hello following metrics:</span></span>

* <span data-ttu-id="b706a-112">CPU-percentage</span><span class="sxs-lookup"><span data-stu-id="b706a-112">CPU percentage</span></span>
* <span data-ttu-id="b706a-113">DTU-percentage</span><span class="sxs-lookup"><span data-stu-id="b706a-113">DTU percentage</span></span>
* <span data-ttu-id="b706a-114">Gegevens-I/O-percentage</span><span class="sxs-lookup"><span data-stu-id="b706a-114">Data IO percentage</span></span>
* <span data-ttu-id="b706a-115">Databaseomvangpercentage</span><span class="sxs-lookup"><span data-stu-id="b706a-115">Database size percentage</span></span>

<span data-ttu-id="b706a-116">Nadat u deze metrische gegevens hebt toegevoegd, kunt u tooview blijven ze in Hallo **bewaking** grafiek met meer informatie over Hallo **metriek** venster.</span><span class="sxs-lookup"><span data-stu-id="b706a-116">Once you’ve added these metrics, you can continue tooview them in hello **Monitoring** chart with more details on hello **Metric** window.</span></span> <span data-ttu-id="b706a-117">Alle vier metrische gegevens tonen Hallo Gemiddeld gebruik percentage relatieve toohello **DTU** van uw database.</span><span class="sxs-lookup"><span data-stu-id="b706a-117">All four metrics show hello average utilization percentage relative toohello **DTU** of your database.</span></span> <span data-ttu-id="b706a-118">Zie Hallo [Servicelagen](sql-database-service-tiers.md) voor meer informatie over dtu's.</span><span class="sxs-lookup"><span data-stu-id="b706a-118">See hello [service tiers](sql-database-service-tiers.md) article for details about DTUs.</span></span>

![Servicelaagbewaking van databaseprestaties.](./media/sql-database-service-tiers/sqldb_service_tier_monitoring.png)

<span data-ttu-id="b706a-120">U kunt ook waarschuwingen configureren op Hallo-maatstaven voor prestaties.</span><span class="sxs-lookup"><span data-stu-id="b706a-120">You can also configure alerts on hello performance metrics.</span></span> <span data-ttu-id="b706a-121">Klik op Hallo **waarschuwing toevoegen** knop in Hallo **metriek** venster.</span><span class="sxs-lookup"><span data-stu-id="b706a-121">Click hello **Add alert** button in hello **Metric** window.</span></span> <span data-ttu-id="b706a-122">Ga als volgt Hallo wizard tooconfigure de waarschuwing.</span><span class="sxs-lookup"><span data-stu-id="b706a-122">Follow hello wizard tooconfigure your alert.</span></span> <span data-ttu-id="b706a-123">U hebt Hallo optie tooalert als Hallo metrische gegevens een bepaalde drempelwaarde overschrijden of als Hallo onder een bepaalde drempelwaarde komt meetpunt.</span><span class="sxs-lookup"><span data-stu-id="b706a-123">You have hello option tooalert if hello metrics exceed a certain threshold or if hello metric falls below a certain threshold.</span></span>

<span data-ttu-id="b706a-124">Bijvoorbeeld, als u Hallo werkbelasting op uw database toogrow verwacht, kunt u tooconfigure een e-mailmelding telkens wanneer uw database 80% van een Hallo prestatiewaarden heeft bereikt.</span><span class="sxs-lookup"><span data-stu-id="b706a-124">For example, if you expect hello workload on your database toogrow, you can choose tooconfigure an email alert whenever your database reaches 80% on any of hello performance metrics.</span></span> <span data-ttu-id="b706a-125">U kunt dit gebruiken als een vroegtijdige waarschuwing toofigure uit wanneer u tooswitch toohello hoger prestatieniveau wellicht.</span><span class="sxs-lookup"><span data-stu-id="b706a-125">You can use this as an early warning toofigure out when you might have tooswitch toohello next higher performance level.</span></span>

<span data-ttu-id="b706a-126">Hallo-maatstaven voor prestaties kunt u bepalen of u kunt toodowngrade tooa lager prestatieniveau.</span><span class="sxs-lookup"><span data-stu-id="b706a-126">hello performance metrics can also help you determine if you are able toodowngrade tooa lower performance level.</span></span> <span data-ttu-id="b706a-127">Stel dat u gebruikmaakt van een Standard S2-database en alle prestaties metrische gegevens weergeven die database gemiddeld Hallo gebruikt niet meer dan 10% op elk moment.</span><span class="sxs-lookup"><span data-stu-id="b706a-127">Assume you are using a Standard S2 database and all performance metrics show that hello database on average does not use more than 10% at any given time.</span></span> <span data-ttu-id="b706a-128">Is het waarschijnlijk dat Hallo-database in Standard S1 goed werkt.</span><span class="sxs-lookup"><span data-stu-id="b706a-128">It is likely that hello database will work well in Standard S1.</span></span> <span data-ttu-id="b706a-129">Echter wel rekening met workloads die pieken of fluctueren, voordat u Hallo besluit toomove tooa lager prestatieniveau.</span><span class="sxs-lookup"><span data-stu-id="b706a-129">However, be aware of workloads that spike or fluctuate before making hello decision toomove tooa lower performance level.</span></span>

## <a name="monitor-databases-using-dmvs"></a><span data-ttu-id="b706a-130">Databases bewaken via DMV's</span><span class="sxs-lookup"><span data-stu-id="b706a-130">Monitor databases using DMVs</span></span>
<span data-ttu-id="b706a-131">Hallo dezelfde metrische gegevens die beschikbaar zijn in de portal Hallo zijn ook beschikbaar via systeemweergaven: [sys.resource_stats](https://msdn.microsoft.com/library/dn269979.aspx) in logische Hallo **master** database van de server en [sys.dm_db_ resource_stats](https://msdn.microsoft.com/library/dn800981.aspx) in Hallo-gebruikersdatabase.</span><span class="sxs-lookup"><span data-stu-id="b706a-131">hello same metrics that are exposed in hello portal are also available through system views: [sys.resource_stats](https://msdn.microsoft.com/library/dn269979.aspx) in hello logical **master** database of your server, and [sys.dm_db_resource_stats](https://msdn.microsoft.com/library/dn800981.aspx) in hello user database.</span></span> <span data-ttu-id="b706a-132">Gebruik **sys.resource_stats** desgewenst toomonitor minder gedetailleerde gegevens over een langere periode.</span><span class="sxs-lookup"><span data-stu-id="b706a-132">Use **sys.resource_stats** if you need toomonitor less granular data across a longer period of time.</span></span> <span data-ttu-id="b706a-133">Gebruik **sys.dm_db_resource_stats** als u toomonitor moet meer gedetailleerde gegevens binnen een kleinere tijdsbestek.</span><span class="sxs-lookup"><span data-stu-id="b706a-133">Use **sys.dm_db_resource_stats** if you need toomonitor more granular data within a smaller time frame.</span></span> <span data-ttu-id="b706a-134">Zie [Richtlijnen voor Azure SQL Database-prestaties](sql-database-single-database-monitor.md#monitor-resource-use) voor meer informatie.</span><span class="sxs-lookup"><span data-stu-id="b706a-134">For more information, see [Azure SQL Database Performance Guidance](sql-database-single-database-monitor.md#monitor-resource-use).</span></span>

> [!NOTE]
> <span data-ttu-id="b706a-135">**sys.dm_db_resource_stats** retourneert een lege resultatenset als deze wordt gebruikt voor de buiten gebruik gestelde Web en Business Edition-databases.</span><span class="sxs-lookup"><span data-stu-id="b706a-135">**sys.dm_db_resource_stats** returns an empty result set when used in Web and Business edition databases, which are retired.</span></span>
>
>

### <a name="monitor-resource-use"></a><span data-ttu-id="b706a-136">Brongebruik controleren</span><span class="sxs-lookup"><span data-stu-id="b706a-136">Monitor resource use</span></span>

<span data-ttu-id="b706a-137">U kunt controleren met resource-gebruik [SQL Database Query Performance Insight](sql-database-query-performance.md) en [Query Store](https://msdn.microsoft.com/library/dn817826.aspx).</span><span class="sxs-lookup"><span data-stu-id="b706a-137">You can monitor resource usage using [SQL Database Query Performance Insight](sql-database-query-performance.md) and [Query Store](https://msdn.microsoft.com/library/dn817826.aspx).</span></span>

<span data-ttu-id="b706a-138">U kunt ook gebruik van deze twee weergaven met bewaken:</span><span class="sxs-lookup"><span data-stu-id="b706a-138">You can also monitor usage using these two views:</span></span>

* [<span data-ttu-id="b706a-139">sys.dm_db_resource_stats</span><span class="sxs-lookup"><span data-stu-id="b706a-139">sys.dm_db_resource_stats</span></span>](https://msdn.microsoft.com/library/dn800981.aspx)
* [<span data-ttu-id="b706a-140">sys.resource_stats</span><span class="sxs-lookup"><span data-stu-id="b706a-140">sys.resource_stats</span></span>](https://msdn.microsoft.com/library/dn269979.aspx)

#### <a name="sysdmdbresourcestats"></a><span data-ttu-id="b706a-141">sys.dm_db_resource_stats</span><span class="sxs-lookup"><span data-stu-id="b706a-141">sys.dm_db_resource_stats</span></span>
<span data-ttu-id="b706a-142">U kunt Hallo [sys.dm_db_resource_stats](https://msdn.microsoft.com/library/dn800981.aspx) weergave in elke SQL-database.</span><span class="sxs-lookup"><span data-stu-id="b706a-142">You can use hello [sys.dm_db_resource_stats](https://msdn.microsoft.com/library/dn800981.aspx) view in every SQL database.</span></span> <span data-ttu-id="b706a-143">Hallo **sys.dm_db_resource_stats** weergave toont recente resource Gebruik relatieve toohello service gegevenslaag.</span><span class="sxs-lookup"><span data-stu-id="b706a-143">hello **sys.dm_db_resource_stats** view shows recent resource use data relative toohello service tier.</span></span> <span data-ttu-id="b706a-144">Gemiddelde percentages voor CPU, i/o-gegevens, logboekschrijfbewerkingen en geheugen elke 15 seconden worden vastgelegd en worden bewaard 1 uur.</span><span class="sxs-lookup"><span data-stu-id="b706a-144">Average percentages for CPU, data I/O, log writes, and memory are recorded every 15 seconds and are maintained for 1 hour.</span></span>

<span data-ttu-id="b706a-145">Omdat deze weergave een meer gedetailleerd blik op gebruik van bronnen biedt, gebruikt u **sys.dm_db_resource_stats** eerste voor een analyse van de huidige status of het oplossen van problemen.</span><span class="sxs-lookup"><span data-stu-id="b706a-145">Because this view provides a more granular look at resource use, use **sys.dm_db_resource_stats** first for any current-state analysis or troubleshooting.</span></span> <span data-ttu-id="b706a-146">Deze query geeft bijvoorbeeld Hallo gemiddelde en maximale gebruiken voor de huidige database Hallo over Hallo afgelopen uur:</span><span class="sxs-lookup"><span data-stu-id="b706a-146">For example, this query shows hello average and maximum resource use for hello current database over hello past hour:</span></span>

    SELECT  
        AVG(avg_cpu_percent) AS 'Average CPU use in percent',
        MAX(avg_cpu_percent) AS 'Maximum CPU use in percent',
        AVG(avg_data_io_percent) AS 'Average data I/O in percent',
        MAX(avg_data_io_percent) AS 'Maximum data I/O in percent',
        AVG(avg_log_write_percent) AS 'Average log write use in percent',
        MAX(avg_log_write_percent) AS 'Maximum log write use in percent',
        AVG(avg_memory_usage_percent) AS 'Average memory use in percent',
        MAX(avg_memory_usage_percent) AS 'Maximum memory use in percent'
    FROM sys.dm_db_resource_stats;  

<span data-ttu-id="b706a-147">Zie voor andere query's, Hallo voorbeelden in [sys.dm_db_resource_stats](https://msdn.microsoft.com/library/dn800981.aspx).</span><span class="sxs-lookup"><span data-stu-id="b706a-147">For other queries, see hello examples in [sys.dm_db_resource_stats](https://msdn.microsoft.com/library/dn800981.aspx).</span></span>

#### <a name="sysresourcestats"></a><span data-ttu-id="b706a-148">sys.resource_stats</span><span class="sxs-lookup"><span data-stu-id="b706a-148">sys.resource_stats</span></span>
<span data-ttu-id="b706a-149">Hallo [sys.resource_stats](https://msdn.microsoft.com/library/dn269979.aspx) weergave in Hallo **master** database bevat extra informatie kunt u Hallo prestaties van uw SQL-database op het niveau van prijscategorie en prestatieniveau specifieke service bewaken .</span><span class="sxs-lookup"><span data-stu-id="b706a-149">hello [sys.resource_stats](https://msdn.microsoft.com/library/dn269979.aspx) view in hello **master** database has additional information that can help you monitor hello performance of your SQL database at its specific service tier and performance level.</span></span> <span data-ttu-id="b706a-150">Hallo-gegevens worden verzameld om de 5 minuten en ongeveer 35 dagen wordt bijgehouden.</span><span class="sxs-lookup"><span data-stu-id="b706a-150">hello data is collected every 5 minutes and is maintained for approximately 35 days.</span></span> <span data-ttu-id="b706a-151">Deze weergave is handig voor een langere historische analyse van hoe uw SQL-database maakt gebruik van bronnen.</span><span class="sxs-lookup"><span data-stu-id="b706a-151">This view is useful for a longer-term historical analysis of how your SQL database uses resources.</span></span>

<span data-ttu-id="b706a-152">Hallo volgende grafiek ziet Hallo CPU gebruik van bronnen voor een Premium-database met Hallo P2 prestatieniveau voor elk uur in een week.</span><span class="sxs-lookup"><span data-stu-id="b706a-152">hello following graph shows hello CPU resource use for a Premium database with hello P2 performance level for each hour in a week.</span></span> <span data-ttu-id="b706a-153">Deze grafiek begint op een maandag, ziet u 5 werkdagen en geeft vervolgens een weekend, als er veel minder gebeurt op Hallo-toepassing.</span><span class="sxs-lookup"><span data-stu-id="b706a-153">This graph starts on a Monday, shows 5 work days, and then shows a weekend, when much less happens on hello application.</span></span>

![Gebruik van SQL database-bronnen](./media/sql-database-performance-guidance/sql_db_resource_utilization.png)

<span data-ttu-id="b706a-155">Vanuit de Hallo gegevens, is deze database momenteel een piek CPU-belasting van iets meer dan 50 procent CPU-gebruik relatieve toohello P2 prestatieniveau (middaguur op dinsdag).</span><span class="sxs-lookup"><span data-stu-id="b706a-155">From hello data, this database currently has a peak CPU load of just over 50 percent CPU use relative toohello P2 performance level (midday on Tuesday).</span></span> <span data-ttu-id="b706a-156">Als CPU Hallo verwerkingsflexibiliteit factor in resource-profiel van de toepassing hello, kunt vervolgens u besluiten dat P2 is Hallo rechts prestaties niveau tooguarantee die Hallo werkbelasting altijd past.</span><span class="sxs-lookup"><span data-stu-id="b706a-156">If CPU is hello dominant factor in hello application’s resource profile, then you might decide that P2 is hello right performance level tooguarantee that hello workload always fits.</span></span> <span data-ttu-id="b706a-157">Als u een toepassing toogrow na verloop van tijd verwacht, is een goed idee toohave een buffer extra bron zodat de toepassing hello niet ooit Hallo prestatieniveau limiet bereikt.</span><span class="sxs-lookup"><span data-stu-id="b706a-157">If you expect an application toogrow over time, it's a good idea toohave an extra resource buffer so that hello application doesn't ever reach hello performance-level limit.</span></span> <span data-ttu-id="b706a-158">Als u het prestatieniveau Hallo verhoogt, kunt u helpen te voorkomen dat zichtbaar is voor een klant fouten die optreden mogelijk wanneer een database geen voldoende power tooprocess aanvragen effectief, met name in omgevingen latentie gevoelig.</span><span class="sxs-lookup"><span data-stu-id="b706a-158">If you increase hello performance level, you can help avoid customer-visible errors that might occur when a database doesn't have enough power tooprocess requests effectively, especially in latency-sensitive environments.</span></span> <span data-ttu-id="b706a-159">Een voorbeeld is een database die een toepassing die worden getekend door webpagina's op basis van Hallo resultaten van de database-aanroepen ondersteunt.</span><span class="sxs-lookup"><span data-stu-id="b706a-159">An example is a database that supports an application that paints webpages based on hello results of database calls.</span></span>

<span data-ttu-id="b706a-160">Andere soorten toepassingen mogelijk dezelfde anders graph Hallo interpreteren.</span><span class="sxs-lookup"><span data-stu-id="b706a-160">Other application types might interpret hello same graph differently.</span></span> <span data-ttu-id="b706a-161">Bijvoorbeeld, als een toepassing tooprocess salarissen gegevens per dag probeert en Hallo heeft kunt dezelfde grafiek die dit kind van 'batchverwerking' model doen goed op prestatieniveau P1.</span><span class="sxs-lookup"><span data-stu-id="b706a-161">For example, if an application tries tooprocess payroll data each day and has hello same chart, this kind of "batch job" model might do fine at a P1 performance level.</span></span> <span data-ttu-id="b706a-162">Hallo prestatieniveau P1 heeft 100 dtu's vergeleken too200 dtu's op Hallo P2 prestatieniveau.</span><span class="sxs-lookup"><span data-stu-id="b706a-162">hello P1 performance level has 100 DTUs compared too200 DTUs at hello P2 performance level.</span></span> <span data-ttu-id="b706a-163">Hallo prestatieniveau P1 biedt half Hallo prestaties van Hallo P2 prestatieniveau.</span><span class="sxs-lookup"><span data-stu-id="b706a-163">hello P1 performance level provides half hello performance of hello P2 performance level.</span></span> <span data-ttu-id="b706a-164">Dus 50 procent van de CPU-gebruik in P2 is gelijk aan 100 procent CPU-gebruik in P1.</span><span class="sxs-lookup"><span data-stu-id="b706a-164">So, 50 percent of CPU use in P2 equals 100 percent CPU use in P1.</span></span> <span data-ttu-id="b706a-165">Als de toepassing hello geen time-outs, maakt het niet uit als een taak 2 uur of 2,5 uur toofinish duurt, als het vandaag wordt voltooid.</span><span class="sxs-lookup"><span data-stu-id="b706a-165">If hello application does not have timeouts, it might not matter if a job takes 2 hours or 2.5 hours toofinish, if it gets done today.</span></span> <span data-ttu-id="b706a-166">Een toepassing in deze categorie kunt waarschijnlijk prestatieniveau P1 gebruiken.</span><span class="sxs-lookup"><span data-stu-id="b706a-166">An application in this category probably can use a P1 performance level.</span></span> <span data-ttu-id="b706a-167">U kunt profiteren van Hallo feit dat er perioden tijdens Hallo dag wanneer bronnengebruik ligt, zodat eventuele 'big piek' kan worden gelekt via in één Hallo holten later op Hallo dag zijn.</span><span class="sxs-lookup"><span data-stu-id="b706a-167">You can take advantage of hello fact that there are periods of time during hello day when resource use is lower, so that any "big peak" might spill over into one of hello troughs later in hello day.</span></span> <span data-ttu-id="b706a-168">Hallo prestatieniveau P1 mogelijk geschikt voor dit soort van toepassing (en geld besparen), zolang Hallo taken op tijd per dag voltooien kunnen.</span><span class="sxs-lookup"><span data-stu-id="b706a-168">hello P1 performance level might be good for that kind of application (and save money), as long as hello jobs can finish on time each day.</span></span>

<span data-ttu-id="b706a-169">Azure SQL Database worden verbruikt resourcegegevens voor elke actieve database in Hallo **sys.resource_stats** weergave Hallo **master** database op elke server.</span><span class="sxs-lookup"><span data-stu-id="b706a-169">Azure SQL Database exposes consumed resource information for each active database in hello **sys.resource_stats** view of hello **master** database in each server.</span></span> <span data-ttu-id="b706a-170">Hallo-gegevens in de tabel Hallo worden samengevoegd voor 5 minuten durende intervallen.</span><span class="sxs-lookup"><span data-stu-id="b706a-170">hello data in hello table is aggregated for 5-minute intervals.</span></span> <span data-ttu-id="b706a-171">Met Hallo Basic, Standard en Premium Servicelagen, kunnen Hallo gegevens worden meer dan 5 minuten tooappear in tabel hello, betekent dat deze gegevens nuttiger voor historische analyse in plaats van in de buurt van de realtime-analyse.</span><span class="sxs-lookup"><span data-stu-id="b706a-171">With hello Basic, Standard, and Premium service tiers, hello data can take more than 5 minutes tooappear in hello table, so this data is more useful for historical analysis rather than near-real-time analysis.</span></span> <span data-ttu-id="b706a-172">Query Hallo **sys.resource_stats** weergave toosee Hallo recente geschiedenis van een database en toovalidate Hallo reservering gekozen bezorgd Hallo prestaties die u wilt zien wanneer nodig.</span><span class="sxs-lookup"><span data-stu-id="b706a-172">Query hello **sys.resource_stats** view toosee hello recent history of a database and toovalidate whether hello reservation you chose delivered hello performance you want when needed.</span></span>

> [!NOTE]
> <span data-ttu-id="b706a-173">U moet verbonden toohello **master** database van de logische SQL database-server tooquery **sys.resource_stats** in Hallo volgen voorbeelden.</span><span class="sxs-lookup"><span data-stu-id="b706a-173">You must be connected toohello **master** database of your logical SQL database server tooquery **sys.resource_stats** in hello following examples.</span></span>
> 
> 

<span data-ttu-id="b706a-174">Dit voorbeeld ziet u hoe Hallo-gegevens in deze weergave wordt weergegeven:</span><span class="sxs-lookup"><span data-stu-id="b706a-174">This example shows you how hello data in this view is exposed:</span></span>

    SELECT TOP 10 *
    FROM sys.resource_stats
    WHERE database_name = 'resource1'
    ORDER BY start_time DESC

![Hallo sys.resource_stats catalogusweergave](./media/sql-database-performance-guidance/sys_resource_stats.png)

<span data-ttu-id="b706a-176">Hallo volgende voorbeeld ziet u verschillende manieren waarmee u Hallo kunt **sys.resource_stats** catalogus tooget-informatie over hoe uw SQL-database maakt gebruik van bronnen weergeven:</span><span class="sxs-lookup"><span data-stu-id="b706a-176">hello next example shows you different ways that you can use hello **sys.resource_stats** catalog view tooget information about how your SQL database uses resources:</span></span>

1. <span data-ttu-id="b706a-177">toolook op Hallo voorbij de bron van de week voor Hallo database userdb1 gebruiken, kunt u deze query uitvoeren:</span><span class="sxs-lookup"><span data-stu-id="b706a-177">toolook at hello past week’s resource use for hello database userdb1, you can run this query:</span></span>
   
        SELECT *
        FROM sys.resource_stats
        WHERE database_name = 'userdb1' AND
              start_time > DATEADD(day, -7, GETDATE())
        ORDER BY start_time DESC;
2. <span data-ttu-id="b706a-178">hoe goed uw werkbelasting past Hallo prestatieniveau tooevaluate, moet u toodrill omlaag in elk aspect van Hallo resource metrische gegevens: CPU, lezen, schrijven, aantal werknemers en aantal sessies.</span><span class="sxs-lookup"><span data-stu-id="b706a-178">tooevaluate how well your workload fits hello performance level, you need toodrill down into each aspect of hello resource metrics: CPU, reads, writes, number of workers, and number of sessions.</span></span> <span data-ttu-id="b706a-179">Hier volgt een herziene query met **sys.resource_stats** tooreport Hallo gemiddelde en maximale waarden van deze resource metrische gegevens:</span><span class="sxs-lookup"><span data-stu-id="b706a-179">Here's a revised query using **sys.resource_stats** tooreport hello average and maximum values of these resource metrics:</span></span>
   
        SELECT
            avg(avg_cpu_percent) AS 'Average CPU use in percent',
            max(avg_cpu_percent) AS 'Maximum CPU use in percent',
            avg(avg_data_io_percent) AS 'Average physical data I/O use in percent',
            max(avg_data_io_percent) AS 'Maximum physical data I/O use in percent',
            avg(avg_log_write_percent) AS 'Average log write use in percent',
            max(avg_log_write_percent) AS 'Maximum log write use in percent',
            avg(max_session_percent) AS 'Average % of sessions',
            max(max_session_percent) AS 'Maximum % of sessions',
            avg(max_worker_percent) AS 'Average % of workers',
            max(max_worker_percent) AS 'Maximum % of workers'
        FROM sys.resource_stats
        WHERE database_name = 'userdb1' AND start_time > DATEADD(day, -7, GETDATE());
3. <span data-ttu-id="b706a-180">U kunt met deze informatie over Hallo gemiddelde en maximale waarden van elke resource metrische gegevens kunt beoordelen hoe goed uw werkbelasting in Hallo prestatieniveau die u hebt gekozen past.</span><span class="sxs-lookup"><span data-stu-id="b706a-180">With this information about hello average and maximum values of each resource metric, you can assess how well your workload fits into hello performance level you chose.</span></span> <span data-ttu-id="b706a-181">Normaal gesproken gemiddelde waarden van **sys.resource_stats** bieden u een goede basis toouse tegen Hallo doelgrootte.</span><span class="sxs-lookup"><span data-stu-id="b706a-181">Usually, average values from **sys.resource_stats** give you a good baseline toouse against hello target size.</span></span> <span data-ttu-id="b706a-182">Moet uw primaire meting stick.</span><span class="sxs-lookup"><span data-stu-id="b706a-182">It should be your primary measurement stick.</span></span> <span data-ttu-id="b706a-183">Voor een voorbeeld mogelijk Hallo standaard servicelaag wordt gebruikt met S2 prestatieniveau.</span><span class="sxs-lookup"><span data-stu-id="b706a-183">For an example, you might be using hello Standard service tier with S2 performance level.</span></span> <span data-ttu-id="b706a-184">Hallo gemiddelde gebruik percentages voor CPU- en i/o-leesbewerkingen en schrijfbewerkingen zijn dan 40 procent en gemiddelde aantal werknemers Hallo lager is dan 50 Hallo gemiddeld aantal sessies lager is dan 200.</span><span class="sxs-lookup"><span data-stu-id="b706a-184">hello average use percentages for CPU and I/O reads and writes are below 40 percent, hello average number of workers is below 50, and hello average number of sessions is below 200.</span></span> <span data-ttu-id="b706a-185">Uw werkbelasting mogelijk in Hallo prestatieniveau S1 past.</span><span class="sxs-lookup"><span data-stu-id="b706a-185">Your workload might fit into hello S1 performance level.</span></span> <span data-ttu-id="b706a-186">Het is gemakkelijk toosee of geschikt is voor uw database in Hallo worker en sessielimieten.</span><span class="sxs-lookup"><span data-stu-id="b706a-186">It's easy toosee whether your database fits in hello worker and session limits.</span></span> <span data-ttu-id="b706a-187">toosee tooCPU, lees- en schrijfbewerkingen, of een database in een lager prestatieniveau met past beschouwt Hallo DTU aantal Hallo lager prestatieniveau delen door Hallo DTU-nummer van uw huidige prestatieniveau en vervolgens Hallo resultaat vermenigvuldigd met 100:</span><span class="sxs-lookup"><span data-stu-id="b706a-187">toosee whether a database fits into a lower performance level with regards tooCPU, reads, and writes, divide hello DTU number of hello lower performance level by hello DTU number of your current performance level, and then multiply hello result by 100:</span></span>
   
    <span data-ttu-id="b706a-188">**S1 DTU / S2 DTU * 100 = 20 / 50 * 100 = 40**</span><span class="sxs-lookup"><span data-stu-id="b706a-188">**S1 DTU / S2 DTU * 100 = 20 / 50 * 100 = 40**</span></span>
   
    <span data-ttu-id="b706a-189">Hallo-resultaat is Hallo relatieve prestatieverschil tussen twee prestatieniveaus Hallo in een percentage.</span><span class="sxs-lookup"><span data-stu-id="b706a-189">hello result is hello relative performance difference between hello two performance levels in percentage.</span></span> <span data-ttu-id="b706a-190">Als uw gebruik van de resource niet groter zijn dan deze hoeveelheid, kan uw werkbelasting past in Hallo lager prestatieniveau.</span><span class="sxs-lookup"><span data-stu-id="b706a-190">If your resource use doesn't exceed this amount, your workload might fit into hello lower performance level.</span></span> <span data-ttu-id="b706a-191">Echter u moet toolook op alle bereiken van waarden voor het gebruik van resources en vastgesteld door percentage, hoe vaak de werkbelasting van uw database valt in Hallo lager prestatieniveau.</span><span class="sxs-lookup"><span data-stu-id="b706a-191">However, you need toolook at all ranges of resource use values, and determine, by percentage, how often your database workload would fit into hello lower performance level.</span></span> <span data-ttu-id="b706a-192">Hallo levert volgende query Hallo past percentage per resourcedimensie, op basis van Hallo drempelwaarde van 40 procent die in dit voorbeeld is berekend:</span><span class="sxs-lookup"><span data-stu-id="b706a-192">hello following query outputs hello fit percentage per resource dimension, based on hello threshold of 40 percent that we calculated in this example:</span></span>
   
        SELECT
            (COUNT(database_name) - SUM(CASE WHEN avg_cpu_percent >= 40 THEN 1 ELSE 0 END) * 1.0) / COUNT(database_name) AS 'CPU Fit Percent'
            ,(COUNT(database_name) - SUM(CASE WHEN avg_log_write_percent >= 40 THEN 1 ELSE 0 END) * 1.0) / COUNT(database_name) AS 'Log Write Fit Percent'
            ,(COUNT(database_name) - SUM(CASE WHEN avg_data_io_percent >= 40 THEN 1 ELSE 0 END) * 1.0) / COUNT(database_name) AS 'Physical Data IO Fit Percent'
        FROM sys.resource_stats
        WHERE database_name = 'userdb1' AND start_time > DATEADD(day, -7, GETDATE());
   
    <span data-ttu-id="b706a-193">Op basis van uw database serviceniveaudoelstelling (SLO), kunt u beslissen of uw werkbelasting in Hallo lager prestatieniveau past.</span><span class="sxs-lookup"><span data-stu-id="b706a-193">Based on your database service level objective (SLO), you can decide whether your workload fits into hello lower performance level.</span></span> <span data-ttu-id="b706a-194">Als de werkbelasting van uw database SLO 99,9 procent en hello voorgaande query waarden groter dan 99,9% voor alle drie resourcedimensies retourneert, wordt uw workload waarschijnlijk in Hallo lager prestatieniveau past.</span><span class="sxs-lookup"><span data-stu-id="b706a-194">If your database workload SLO is 99.9 percent and hello preceding query returns values greater than 99.9 percent for all three resource dimensions, your workload likely fits into hello lower performance level.</span></span>
   
    <span data-ttu-id="b706a-195">Bekijkt hello past percentage biedt ook inzicht in of u niveau prestaties toomeet van toohello volgende hogere uw SLO overstappen moet.</span><span class="sxs-lookup"><span data-stu-id="b706a-195">Looking at hello fit percentage also gives you insight into whether you should move toohello next higher performance level toomeet your SLO.</span></span> <span data-ttu-id="b706a-196">Userdb1 ziet u bijvoorbeeld Hallo CPU-gebruik voor Hallo afgelopen week te volgen:</span><span class="sxs-lookup"><span data-stu-id="b706a-196">For example, userdb1 shows hello following CPU use for hello past week:</span></span>
   
   | <span data-ttu-id="b706a-197">Gemiddelde CPU-percentage</span><span class="sxs-lookup"><span data-stu-id="b706a-197">Average CPU percent</span></span> | <span data-ttu-id="b706a-198">Maximale CPU-percentage</span><span class="sxs-lookup"><span data-stu-id="b706a-198">Maximum CPU percent</span></span> |
   | --- | --- |
   | <span data-ttu-id="b706a-199">24.5</span><span class="sxs-lookup"><span data-stu-id="b706a-199">24.5</span></span> |<span data-ttu-id="b706a-200">100.00</span><span class="sxs-lookup"><span data-stu-id="b706a-200">100.00</span></span> |
   
    <span data-ttu-id="b706a-201">gemiddelde CPU Hallo is over een kwartaal van het Hallo-limiet van Hallo prestatieniveau, zijn voor Hallo prestatieniveau van Hallo-database geschikt zou.</span><span class="sxs-lookup"><span data-stu-id="b706a-201">hello average CPU is about a quarter of hello limit of hello performance level, which would fit well into hello performance level of hello database.</span></span> <span data-ttu-id="b706a-202">Maar Hallo maximale waarde bevat dat die database Hallo Hallo bereikt van het prestatieniveau Hallo.</span><span class="sxs-lookup"><span data-stu-id="b706a-202">But, hello maximum value shows that hello database reaches hello limit of hello performance level.</span></span> <span data-ttu-id="b706a-203">Wilt u toomove toohello hoger prestatieniveau hebben?</span><span class="sxs-lookup"><span data-stu-id="b706a-203">Do you need toomove toohello next higher performance level?</span></span> <span data-ttu-id="b706a-204">Kijken hoe vaak uw werkbelasting bereikt 100 procent en vergelijk dit tooyour database werkbelasting SLO.</span><span class="sxs-lookup"><span data-stu-id="b706a-204">Look at how many times your workload reaches 100 percent, and then compare it tooyour database workload SLO.</span></span>
   
        SELECT
        (COUNT(database_name) - SUM(CASE WHEN avg_cpu_percent >= 100 THEN 1 ELSE 0 END) * 1.0) / COUNT(database_name) AS 'CPU fit percent'
        ,(COUNT(database_name) - SUM(CASE WHEN avg_log_write_percent >= 100 THEN 1 ELSE 0 END) * 1.0) / COUNT(database_name) AS 'Log write fit percent'
        ,(COUNT(database_name) - SUM(CASE WHEN avg_data_io_percent >= 100 THEN 1 ELSE 0 END) * 1.0) / COUNT(database_name) AS 'Physical data I/O fit percent'
        FROM sys.resource_stats
        WHERE database_name = 'userdb1' AND start_time > DATEADD(day, -7, GETDATE());
   
    <span data-ttu-id="b706a-205">Als u deze query retourneert een waarde minder dan 99,9 procent voor een van drie Hallo resourcedimensies, houd rekening met beide bewegende toohello hoger prestatieniveau of technieken tooreduce Hallo load afstemming van toepassingen op Hallo SQL-database.</span><span class="sxs-lookup"><span data-stu-id="b706a-205">If this query returns a value less than 99.9 percent for any of hello three resource dimensions, consider either moving toohello next higher performance level or use application-tuning techniques tooreduce hello load on hello SQL database.</span></span>
4. <span data-ttu-id="b706a-206">In deze oefening tevens rekening gehouden met de verwachte werkbelasting toename Hallo toekomstige.</span><span class="sxs-lookup"><span data-stu-id="b706a-206">This exercise also considers your projected workload increase in hello future.</span></span>

<span data-ttu-id="b706a-207">Voor elastische pools, kunt u afzonderlijke databases in de groep Hallo bewaken met Hallo technieken die in deze sectie beschreven.</span><span class="sxs-lookup"><span data-stu-id="b706a-207">For elastic pools, you can monitor individual databases in hello pool with hello techniques described in this section.</span></span> <span data-ttu-id="b706a-208">Maar u kunt ook Hallo pool als geheel bewaken.</span><span class="sxs-lookup"><span data-stu-id="b706a-208">But you can also monitor hello pool as a whole.</span></span> <span data-ttu-id="b706a-209">Zie [Een elastische pool bewaken en beheren](sql-database-elastic-pool-manage-portal.md) voor meer informatie.</span><span class="sxs-lookup"><span data-stu-id="b706a-209">For information, see [Monitor and manage an elastic pool](sql-database-elastic-pool-manage-portal.md).</span></span>


### <a name="maximum-concurrent-requests"></a><span data-ttu-id="b706a-210">Maximum aantal gelijktijdige aanvragen</span><span class="sxs-lookup"><span data-stu-id="b706a-210">Maximum concurrent requests</span></span>
<span data-ttu-id="b706a-211">toosee Hallo aantal gelijktijdige aanvragen, wordt deze Transact-SQL-query uitvoeren op de SQL-database:</span><span class="sxs-lookup"><span data-stu-id="b706a-211">toosee hello number of concurrent requests, run this Transact-SQL query on your SQL database:</span></span>

    SELECT COUNT(*) AS [Concurrent_Requests]
    FROM sys.dm_exec_requests R

<span data-ttu-id="b706a-212">tooanalyze hello werkbelasting van een lokale SQL Server-database wijzigen deze query toofilter op Hallo specifieke database die u wilt tooanalyze.</span><span class="sxs-lookup"><span data-stu-id="b706a-212">tooanalyze hello workload of an on-premises SQL Server database, modify this query toofilter on hello specific database you want tooanalyze.</span></span> <span data-ttu-id="b706a-213">Bijvoorbeeld, als er een lokale database met de naam MijnDatabase, retourneert deze Transact-SQL-query Hallo aantal gelijktijdige aanvragen in de database:</span><span class="sxs-lookup"><span data-stu-id="b706a-213">For example, if you have an on-premises database named MyDatabase, this Transact-SQL query returns hello count of concurrent requests in that database:</span></span>

    SELECT COUNT(*) AS [Concurrent_Requests]
    FROM sys.dm_exec_requests R
    INNER JOIN sys.databases D ON D.database_id = R.database_id
    AND D.name = 'MyDatabase'

<span data-ttu-id="b706a-214">Dit is slechts een momentopname op één punt in tijd.</span><span class="sxs-lookup"><span data-stu-id="b706a-214">This is just a snapshot at a single point in time.</span></span> <span data-ttu-id="b706a-215">tooget een beter inzicht in uw werkbelasting en de vereisten voor gelijktijdige aanvragen, moet u toocollect veel voorbeelden gedurende een bepaalde periode.</span><span class="sxs-lookup"><span data-stu-id="b706a-215">tooget a better understanding of your workload and concurrent request requirements, you'll need toocollect many samples over time.</span></span>

### <a name="maximum-concurrent-logins"></a><span data-ttu-id="b706a-216">Maximum aantal gelijktijdige aanmeldingen</span><span class="sxs-lookup"><span data-stu-id="b706a-216">Maximum concurrent logins</span></span>
<span data-ttu-id="b706a-217">U kunt uw gebruikers- en patronen tooget een idee van de frequentie van aanmeldingen Hallo analyseren.</span><span class="sxs-lookup"><span data-stu-id="b706a-217">You can analyze your user and application patterns tooget an idea of hello frequency of logins.</span></span> <span data-ttu-id="b706a-218">U kunt ook werkelijke hoeveelheden uitvoeren in een omgeving toomake voor test zeker dat u bent niet kunt u door deze of andere limieten in dit artikel besproken.</span><span class="sxs-lookup"><span data-stu-id="b706a-218">You also can run real-world loads in a test environment toomake sure that you're not hitting this or other limits we discuss in this article.</span></span> <span data-ttu-id="b706a-219">Er is een enkele query of de dynamische beheerweergave (DMV) die u kunt u zien gelijktijdige aanmelding telt of de geschiedenis niet.</span><span class="sxs-lookup"><span data-stu-id="b706a-219">There isn’t a single query or dynamic management view (DMV) that can show you concurrent login counts or history.</span></span>

<span data-ttu-id="b706a-220">Als meerdere clients gebruik Hallo dezelfde verbindingsreeks hello service verifieert voor elke aanmelding.</span><span class="sxs-lookup"><span data-stu-id="b706a-220">If multiple clients use hello same connection string, hello service authenticates each login.</span></span> <span data-ttu-id="b706a-221">Als 10 gebruikers tegelijk verbinding maken met database met behulp van tooa Hallo dezelfde gebruikersnaam en wachtwoord, zou er 10 gelijktijdige aanmeldingen.</span><span class="sxs-lookup"><span data-stu-id="b706a-221">If 10 users simultaneously connect tooa database by using hello same username and password, there would be 10 concurrent logins.</span></span> <span data-ttu-id="b706a-222">Deze beperking geldt alleen toohello duur van het Hallo-aanmelding en verificatie.</span><span class="sxs-lookup"><span data-stu-id="b706a-222">This limit applies only toohello duration of hello login and authentication.</span></span> <span data-ttu-id="b706a-223">Als Hallo dezelfde 10 gebruikers verbinding sequentieel toohello database maakt, zou het aantal gelijktijdige aanmeldingen Hallo niet groter dan 1.</span><span class="sxs-lookup"><span data-stu-id="b706a-223">If hello same 10 users connect toohello database sequentially, hello number of concurrent logins would never be greater than 1.</span></span>

> [!NOTE]
> <span data-ttu-id="b706a-224">Op dit moment is deze limiet niet van toepassing toodatabases in elastische pools.</span><span class="sxs-lookup"><span data-stu-id="b706a-224">Currently, this limit does not apply toodatabases in elastic pools.</span></span>
> 
> 

### <a name="maximum-sessions"></a><span data-ttu-id="b706a-225">Maximum aantal sessies</span><span class="sxs-lookup"><span data-stu-id="b706a-225">Maximum sessions</span></span>
<span data-ttu-id="b706a-226">toosee hello aantal huidige actieve sessies, wordt deze Transact-SQL-query uitvoeren op de SQL-database:</span><span class="sxs-lookup"><span data-stu-id="b706a-226">toosee hello number of current active sessions, run this Transact-SQL query on your SQL database:</span></span>

    SELECT COUNT(*) AS [Sessions]
    FROM sys.dm_exec_connections

<span data-ttu-id="b706a-227">Als u van een lokale SQL Server-werkbelasting analyseren bent, wijzigt u Hallo query toofocus op een specifieke database.</span><span class="sxs-lookup"><span data-stu-id="b706a-227">If you're analyzing an on-premises SQL Server workload, modify hello query toofocus on a specific database.</span></span> <span data-ttu-id="b706a-228">Deze query kunt u beter bepalen mogelijke sessie behoeften voor Hallo database als u overweegt tooAzure SQL-Database te verplaatsen.</span><span class="sxs-lookup"><span data-stu-id="b706a-228">This query helps you determine possible session needs for hello database if you are considering moving it tooAzure SQL Database.</span></span>

    SELECT COUNT(*)  AS [Sessions]
    FROM sys.dm_exec_connections C
    INNER JOIN sys.dm_exec_sessions S ON (S.session_id = C.session_id)
    INNER JOIN sys.databases D ON (D.database_id = S.database_id)
    WHERE D.name = 'MyDatabase'

<span data-ttu-id="b706a-229">Deze query's retourneren opnieuw een punt in tijd telling.</span><span class="sxs-lookup"><span data-stu-id="b706a-229">Again, these queries return a point-in-time count.</span></span> <span data-ttu-id="b706a-230">Als u meerdere steekproeven gedurende een bepaalde periode verzamelt, hebt u Hallo best inzicht in uw sessie gebruiken.</span><span class="sxs-lookup"><span data-stu-id="b706a-230">If you collect multiple samples over time, you’ll have hello best understanding of your session use.</span></span>

<span data-ttu-id="b706a-231">Voor analyse van de SQL-Database, kunt u historische statistieken opvragen op sessies door het uitvoeren van query's Hallo [sys.resource_stats](https://msdn.microsoft.com/library/dn269979.aspx) weergeven en beoordelen van Hallo **active_session_count** kolom.</span><span class="sxs-lookup"><span data-stu-id="b706a-231">For SQL Database analysis, you can get historical statistics on sessions by querying hello [sys.resource_stats](https://msdn.microsoft.com/library/dn269979.aspx) view and reviewing hello **active_session_count** column.</span></span> 
