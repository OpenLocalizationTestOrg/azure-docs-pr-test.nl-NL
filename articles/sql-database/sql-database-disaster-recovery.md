---
title: Database-noodherstel aaaSQL | Microsoft Docs
description: Meer informatie over hoe toorecover een database van een storing in regionale datacenter of falen met hello Azure SQL Database actieve geo-replicatie en geo-restore-mogelijkheden.
services: sql-database
documentationcenter: 
author: anosov1960
manager: jhubbard
editor: monicar
ms.assetid: 4800960e-3f9d-40ce-9e55-fb7f2784c067
ms.service: sql-database
ms.custom: business continuity
ms.devlang: NA
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 04/14/2017
ms.author: sashan
ms.openlocfilehash: bae08485863067748107ec4808e52d8e88e2de0d
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 10/06/2017
---
# <a name="restore-an-azure-sql-database-or-failover-tooa-secondary"></a><span data-ttu-id="e8b95-103">Een Azure SQL Database of failover tooa secundaire herstellen</span><span class="sxs-lookup"><span data-stu-id="e8b95-103">Restore an Azure SQL Database or failover tooa secondary</span></span>
<span data-ttu-id="e8b95-104">Azure SQL Database biedt Hallo mogelijkheden voor het herstellen van een storing te volgen:</span><span class="sxs-lookup"><span data-stu-id="e8b95-104">Azure SQL Database offers hello following capabilities for recovering from an outage:</span></span>

* [<span data-ttu-id="e8b95-105">Actieve Geo-replicatie</span><span class="sxs-lookup"><span data-stu-id="e8b95-105">Active geo-replication</span></span>](sql-database-geo-replication-overview.md)
* [<span data-ttu-id="e8b95-106">Geo-herstel</span><span class="sxs-lookup"><span data-stu-id="e8b95-106">Geo-restore</span></span>](sql-database-recovery-using-backups.md#point-in-time-restore)

<span data-ttu-id="e8b95-107">toolearn over zakelijke continuïteit-scenario's en Hallo-functies ondersteunen van deze scenario's, Zie [bedrijfscontinuïteit](sql-database-business-continuity.md).</span><span class="sxs-lookup"><span data-stu-id="e8b95-107">toolearn about business continuity scenarios and hello features supporting these scenarios, see [Business continuity](sql-database-business-continuity.md).</span></span>

### <a name="prepare-for-hello-event-of-an-outage"></a><span data-ttu-id="e8b95-108">Hallo-gebeurtenis van een storing voorbereiden</span><span class="sxs-lookup"><span data-stu-id="e8b95-108">Prepare for hello event of an outage</span></span>
<span data-ttu-id="e8b95-109">Geslaagd en herstel tooanother-gegevensgebied met behulp van actieve geo-replicatie of geografisch redundante back-ups, moet u tooprepare een server in een ander datacenter onderbreking toobecome Hallo nieuwe primaire server moet Hallo moet zich voordoen als goed gedefinieerde stappen hebben gedocumenteerde en geteste tooensure smooth herstel.</span><span class="sxs-lookup"><span data-stu-id="e8b95-109">For success with recovery tooanother data region using either active geo-replication or geo-redundant backups, you need tooprepare a server in another data center outage toobecome hello new primary server should hello need arise as well as have well-defined steps documented and tested tooensure a smooth recovery.</span></span> <span data-ttu-id="e8b95-110">Deze voorbereidende stappen omvatten:</span><span class="sxs-lookup"><span data-stu-id="e8b95-110">These preparation steps include:</span></span>

* <span data-ttu-id="e8b95-111">Identificeer Hallo logische server in een andere regio toobecome Hallo nieuwe primaire server.</span><span class="sxs-lookup"><span data-stu-id="e8b95-111">Identify hello logical server in another region toobecome hello new primary server.</span></span> <span data-ttu-id="e8b95-112">Met actieve geo-replicatie, wordt dit ten minste één en mogelijk een van de secundaire servers Hallo zijn.</span><span class="sxs-lookup"><span data-stu-id="e8b95-112">With active geo-replication, this will be at least one and perhaps each of hello secondary servers.</span></span> <span data-ttu-id="e8b95-113">Geo-Herstel dit in het algemeen is een server in Hallo [gekoppelde regio](../best-practices-availability-paired-regions.md) voor Hallo regio waarin uw database zich bevindt.</span><span class="sxs-lookup"><span data-stu-id="e8b95-113">For geo-restore, this will generally be a server in hello [paired region](../best-practices-availability-paired-regions.md) for hello region in which your database is located.</span></span>
* <span data-ttu-id="e8b95-114">Identificeren en desgewenst definiëren, Hallo serverniveau firewallregels nodig op voor gebruikers tooaccess Hallo nieuwe primaire database.</span><span class="sxs-lookup"><span data-stu-id="e8b95-114">Identify, and optionally define, hello server-level firewall rules needed on for users tooaccess hello new primary database.</span></span>
* <span data-ttu-id="e8b95-115">Bepalen hoe u tooredirect gebruikers toohello nieuwe primaire server gaat zoals door verbindingsreeksen wijzigen of door het wijzigen van DNS-vermeldingen.</span><span class="sxs-lookup"><span data-stu-id="e8b95-115">Determine how you are going tooredirect users toohello new primary server, such as by changing connection strings or by changing DNS entries.</span></span>
* <span data-ttu-id="e8b95-116">Identificeren, en desgewenst maken, Hallo aanmeldingen die moeten aanwezig zijn in de hoofddatabase Hallo op Hallo van de nieuwe primaire server en zorg ervoor dat deze aanmeldingen geschikte machtigingen hebben in de hoofddatabase hello, indien van toepassing.</span><span class="sxs-lookup"><span data-stu-id="e8b95-116">Identify, and optionally create, hello logins that must be present in hello master database on hello new primary server, and ensure these logins have appropriate permissions in hello master database, if any.</span></span> <span data-ttu-id="e8b95-117">Zie voor meer informatie [beveiliging van SQL Database na het herstel na noodgevallen](sql-database-geo-replication-security-config.md)</span><span class="sxs-lookup"><span data-stu-id="e8b95-117">For more information, see [SQL Database security after disaster recovery](sql-database-geo-replication-security-config.md)</span></span>
* <span data-ttu-id="e8b95-118">Regels voor waarschuwingen die toobe bijgewerkte toomap toohello nieuwe primaire database moet identificeren.</span><span class="sxs-lookup"><span data-stu-id="e8b95-118">Identify alert rules that will need toobe updated toomap toohello new primary database.</span></span>
* <span data-ttu-id="e8b95-119">Document Hallo controleconfiguratie op Hallo van de huidige primaire database</span><span class="sxs-lookup"><span data-stu-id="e8b95-119">Document hello auditing configuration on hello current primary database</span></span>
* <span data-ttu-id="e8b95-120">Voer een [disaster recovery inzoomen](sql-database-disaster-recovery-drills.md).</span><span class="sxs-lookup"><span data-stu-id="e8b95-120">Perform a [disaster recovery drill](sql-database-disaster-recovery-drills.md).</span></span> <span data-ttu-id="e8b95-121">toosimulate een storing voor geo-restore kunt u verwijderen of wijzig de naam van Hallo bron toocause toepassing connectiviteit databasefout.</span><span class="sxs-lookup"><span data-stu-id="e8b95-121">toosimulate an outage for geo-restore, you can delete or rename hello source database toocause application connectivity failure.</span></span> <span data-ttu-id="e8b95-122">toosimulate een storing voor actieve geo-replicatie, kunt u Hallo-webtoepassing of virtuele machine verbonden toohello database of failover Hallo database toocause connectiviteit toepassingsfouten uitschakelen.</span><span class="sxs-lookup"><span data-stu-id="e8b95-122">toosimulate an outage for active geo-replication, you can disable hello web application or virtual machine connected toohello database or failover hello database toocause application connectivity failures.</span></span>

## <a name="when-tooinitiate-recovery"></a><span data-ttu-id="e8b95-123">Wanneer tooinitiate herstel</span><span class="sxs-lookup"><span data-stu-id="e8b95-123">When tooinitiate recovery</span></span>
<span data-ttu-id="e8b95-124">Hallo-toepassing heeft gevolgen voor Hallo herstelbewerking wordt uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="e8b95-124">hello recovery operation impacts hello application.</span></span> <span data-ttu-id="e8b95-125">Het wijzigen van het SQL-verbindingsreeks Hallo of met behulp van DNS-omleiding is vereist en kan leiden tot permanent verlies van gegevens.</span><span class="sxs-lookup"><span data-stu-id="e8b95-125">It requires changing hello SQL connection string or redirection using DNS and could result in permanent data loss.</span></span> <span data-ttu-id="e8b95-126">Daarom mag deze alleen worden uitgevoerd wanneer Hallo onderbreking waarschijnlijk toolast langer is dan de beoogde hersteltijd van uw toepassing is.</span><span class="sxs-lookup"><span data-stu-id="e8b95-126">Therefore, it should be done only when hello outage is likely toolast longer than your application's recovery time objective.</span></span> <span data-ttu-id="e8b95-127">Wanneer hello toepassing geïmplementeerde tooproduction moet u regelmatige controle van de toepassingsstatus Hallo uitvoert en Hallo punten tooassert die Hallo herstel gerechtvaardigd is gegevens te volgen:</span><span class="sxs-lookup"><span data-stu-id="e8b95-127">When hello application is deployed tooproduction you should perform regular monitoring of hello application health and use hello following data points tooassert that hello recovery is warranted:</span></span>

1. <span data-ttu-id="e8b95-128">Permanente verbindingsfout van laag Hallo-toohello toepassingsdatabase.</span><span class="sxs-lookup"><span data-stu-id="e8b95-128">Permanent connectivity failure from hello application tier toohello database.</span></span>
2. <span data-ttu-id="e8b95-129">Hello Azure-portal geeft een waarschuwing over een incident in Hallo-gebied met een grote impact.</span><span class="sxs-lookup"><span data-stu-id="e8b95-129">hello Azure portal shows an alert about an incident in hello region with broad impact.</span></span>
3. <span data-ttu-id="e8b95-130">Hello Azure SQL Database-server is gemarkeerd als beschadigd.</span><span class="sxs-lookup"><span data-stu-id="e8b95-130">hello Azure SQL Database server is marked as degraded.</span></span>

<span data-ttu-id="e8b95-131">U kunt Hallo volgende herstelopties overwegen, afhankelijk van uw toepassing tolerantie toodowntime en mogelijke business aansprakelijkheid.</span><span class="sxs-lookup"><span data-stu-id="e8b95-131">Depending on your application tolerance toodowntime and possible business liability you can consider hello following recovery options.</span></span>

<span data-ttu-id="e8b95-132">Gebruik Hallo [herstelbare Database ophalen](https://msdn.microsoft.com/library/dn800985.aspx) (*LastAvailableBackupDate*) tooget Hallo nieuwste geogerepliceerde herstelpunt.</span><span class="sxs-lookup"><span data-stu-id="e8b95-132">Use hello [Get Recoverable Database](https://msdn.microsoft.com/library/dn800985.aspx) (*LastAvailableBackupDate*) tooget hello latest Geo-replicated restore point.</span></span>

## <a name="wait-for-service-recovery"></a><span data-ttu-id="e8b95-133">Wachttijd voor het herstel</span><span class="sxs-lookup"><span data-stu-id="e8b95-133">Wait for service recovery</span></span>
<span data-ttu-id="e8b95-134">Hello samenwerken Azure teams naar eer en geweten toorestore servicebeschikbaarheid snel mogelijk, maar, afhankelijk van de hoofdoorzaak Hallo duren uren of dagen voordat kan.</span><span class="sxs-lookup"><span data-stu-id="e8b95-134">hello Azure teams work diligently toorestore service availability as quickly as possible but depending on hello root cause it can take hours or days.</span></span>  <span data-ttu-id="e8b95-135">Als uw toepassing aanzienlijke downtime tolereren kan kunt u eenvoudig hello herstel toocomplete wachten.</span><span class="sxs-lookup"><span data-stu-id="e8b95-135">If your application can tolerate significant downtime you can simply wait for hello recovery toocomplete.</span></span> <span data-ttu-id="e8b95-136">In dit geval is geen actie ondernemen vereist.</span><span class="sxs-lookup"><span data-stu-id="e8b95-136">In this case, no action on your part is required.</span></span> <span data-ttu-id="e8b95-137">U kunt de huidige servicestatus Hallo zien op onze [Azure Service Health Dashboard](https://azure.microsoft.com/status/).</span><span class="sxs-lookup"><span data-stu-id="e8b95-137">You can see hello current service status on our [Azure Service Health Dashboard](https://azure.microsoft.com/status/).</span></span> <span data-ttu-id="e8b95-138">Na het herstel van de regio Hallo Hallo wordt beschikbaarheid van uw toepassing hersteld.</span><span class="sxs-lookup"><span data-stu-id="e8b95-138">After hello recovery of hello region your application’s availability will be restored.</span></span>

## <a name="fail-over-toogeo-replicated-secondary-database"></a><span data-ttu-id="e8b95-139">Failover toogeo gerepliceerde secundaire database</span><span class="sxs-lookup"><span data-stu-id="e8b95-139">Fail over toogeo-replicated secondary database</span></span>
<span data-ttu-id="e8b95-140">Als uitvaltijd van uw toepassing tot zakelijke aansprakelijkheid leiden kan moet u databases geo-replicatie in uw toepassing.</span><span class="sxs-lookup"><span data-stu-id="e8b95-140">If your application’s downtime can result in business liability you should be using geo-replicated database(s) in your application.</span></span> <span data-ttu-id="e8b95-141">Hallo tooquickly terugzetten beschikbaarheid in een andere regio bij een stroomstoring wordt het ingeschakeld.</span><span class="sxs-lookup"><span data-stu-id="e8b95-141">It will enable hello application tooquickly restore availability in a different region in case of an outage.</span></span> <span data-ttu-id="e8b95-142">Meer informatie over hoe te[geo-replicatie configureren](sql-database-geo-replication-portal.md).</span><span class="sxs-lookup"><span data-stu-id="e8b95-142">Learn how too[configure geo-replication](sql-database-geo-replication-portal.md).</span></span>

<span data-ttu-id="e8b95-143">beschikbaarheid van Hallo toorestore database(s) u moet tooinitiate Hallo failover toohello geo-replicatie secundaire met een van de methoden Hallo ondersteund.</span><span class="sxs-lookup"><span data-stu-id="e8b95-143">toorestore availability of hello database(s) you need tooinitiate hello failover toohello geo-replicated secondary using one of hello supported methods.</span></span>

<span data-ttu-id="e8b95-144">Gebruik een van de Hallo handleidingen toofail via tooa geo-replicatie secundaire database te volgen:</span><span class="sxs-lookup"><span data-stu-id="e8b95-144">Use one of hello following guides toofail over tooa geo-replicated secondary database:</span></span>

* [<span data-ttu-id="e8b95-145">Failover tooa geo-replicatie secundaire met Azure Portal</span><span class="sxs-lookup"><span data-stu-id="e8b95-145">Fail over tooa geo-replicated secondary using Azure Portal</span></span>](sql-database-geo-replication-portal.md)
* [<span data-ttu-id="e8b95-146">Failover-tooa-secundaire geo-replicatie met PowerShell</span><span class="sxs-lookup"><span data-stu-id="e8b95-146">Fail over tooa geo-replicated secondary using PowerShell</span></span>](scripts/sql-database-setup-geodr-and-failover-database-powershell.md)
* [<span data-ttu-id="e8b95-147">Failover tooa geo-replicatie secundaire met T-SQL</span><span class="sxs-lookup"><span data-stu-id="e8b95-147">Fail over tooa geo-replicated secondary using T-SQL</span></span>](sql-database-geo-replication-transact-sql.md)

## <a name="recover-using-geo-restore"></a><span data-ttu-id="e8b95-148">Herstellen met behulp van geo-herstel</span><span class="sxs-lookup"><span data-stu-id="e8b95-148">Recover using geo-restore</span></span>
<span data-ttu-id="e8b95-149">Als uw toepassing uitvaltijd niet in business aansprakelijkheid resulteert kunt u [geo-restore](sql-database-recovery-using-backups.md) als een methode toorecover de databases van uw toepassing.</span><span class="sxs-lookup"><span data-stu-id="e8b95-149">If your application’s downtime does not result in business liability you can use [geo-restore](sql-database-recovery-using-backups.md) as a method toorecover your application database(s).</span></span> <span data-ttu-id="e8b95-150">Een kopie van Hallo-database wordt gemaakt van de meest recente geografisch redundante back-up.</span><span class="sxs-lookup"><span data-stu-id="e8b95-150">It creates a copy of hello database from its latest geo-redundant backup.</span></span>

## <a name="configure-your-database-after-recovery"></a><span data-ttu-id="e8b95-151">Uw database na herstel configureren</span><span class="sxs-lookup"><span data-stu-id="e8b95-151">Configure your database after recovery</span></span>
<span data-ttu-id="e8b95-152">Als u van geo-replicatie, failover of toorecover geo-herstel van een storing gebruikmaakt, moet u ervoor zorgen dat Hallo connectiviteit toohello nieuwe databases correct is geconfigureerd, zodat Hallo normale toepassing functie kan worden hervat.</span><span class="sxs-lookup"><span data-stu-id="e8b95-152">If you are using either geo-replication failover or geo-restore toorecover from an outage, you must make sure that hello connectivity toohello new databases is properly configured so that hello normal application function can be resumed.</span></span> <span data-ttu-id="e8b95-153">Dit is een controlelijst met taken tooget de herstelde database productie gereed.</span><span class="sxs-lookup"><span data-stu-id="e8b95-153">This is a checklist of tasks tooget your recovered database production ready.</span></span>

### <a name="update-connection-strings"></a><span data-ttu-id="e8b95-154">Verbindingstekenreeksen bijwerken</span><span class="sxs-lookup"><span data-stu-id="e8b95-154">Update connection strings</span></span>
<span data-ttu-id="e8b95-155">Omdat de herstelde database bevindt zich in een andere server, moet u tooupdate van uw toepassing connection string toopoint toothat-server.</span><span class="sxs-lookup"><span data-stu-id="e8b95-155">Because your recovered database will reside in a different server, you need tooupdate your application’s connection string toopoint toothat server.</span></span>

<span data-ttu-id="e8b95-156">Zie voor meer informatie over het wijzigen van verbindingsreeksen Hallo ontwikkeling van de juiste taal voor uw [verbindingsbibliotheek](sql-database-libraries.md).</span><span class="sxs-lookup"><span data-stu-id="e8b95-156">For more information about changing connection strings, see hello appropriate development language for your [connection library](sql-database-libraries.md).</span></span>

### <a name="configure-firewall-rules"></a><span data-ttu-id="e8b95-157">Firewallregels configureren</span><span class="sxs-lookup"><span data-stu-id="e8b95-157">Configure Firewall Rules</span></span>
<span data-ttu-id="e8b95-158">Moet u ervoor dat Hallo firewallregels zijn geconfigureerd op de server en op Hallo database overeen die zijn geconfigureerd op de primaire server Hallo en de primaire database toomake.</span><span class="sxs-lookup"><span data-stu-id="e8b95-158">You need toomake sure that hello firewall rules configured on server and on hello database match those that were configured on hello primary server and primary database.</span></span> <span data-ttu-id="e8b95-159">Zie voor meer informatie [procedure: Firewall-instellingen configureren (Azure SQL Database)](sql-database-configure-firewall-settings.md).</span><span class="sxs-lookup"><span data-stu-id="e8b95-159">For more information, see [How to: Configure Firewall Settings (Azure SQL Database)](sql-database-configure-firewall-settings.md).</span></span>

### <a name="configure-logins-and-database-users"></a><span data-ttu-id="e8b95-160">Aanmeldingen en databasegebruikers configureren</span><span class="sxs-lookup"><span data-stu-id="e8b95-160">Configure logins and database users</span></span>
<span data-ttu-id="e8b95-161">Moet u ervoor dat alle Hallo aanmeldingen gebruikt door de toepassing op Hallo-server die als host de herstelde database fungeert toomake.</span><span class="sxs-lookup"><span data-stu-id="e8b95-161">You need toomake sure that all hello logins used by your application exist on hello server which is hosting your recovered database.</span></span> <span data-ttu-id="e8b95-162">Zie voor meer informatie [beveiligingsconfiguratie voor de geo-replicatie](sql-database-geo-replication-security-config.md).</span><span class="sxs-lookup"><span data-stu-id="e8b95-162">For more information, see [Security Configuration for geo-replication](sql-database-geo-replication-security-config.md).</span></span>

> [!NOTE]
> <span data-ttu-id="e8b95-163">U moet configureren en testen van de firewallregels voor server en aanmeldingen (en hun machtigingen) tijdens een herstel na noodgevallen detailanalyse.</span><span class="sxs-lookup"><span data-stu-id="e8b95-163">You should configure and test your server firewall rules and logins (and their permissions) during a disaster recovery drill.</span></span> <span data-ttu-id="e8b95-164">Deze objecten van het niveau van de server en de bijbehorende configuratie mogelijk niet beschikbaar tijdens het Hallo-storing.</span><span class="sxs-lookup"><span data-stu-id="e8b95-164">These server-level objects and their configuration may not be available during hello outage.</span></span>
> 
> 

### <a name="setup-telemetry-alerts"></a><span data-ttu-id="e8b95-165">Telemetrie-waarschuwingen instellen</span><span class="sxs-lookup"><span data-stu-id="e8b95-165">Setup telemetry alerts</span></span>
<span data-ttu-id="e8b95-166">Moet u ervoor dat de bestaande instellingen voor de waarschuwingsregel bijgewerkte toomap toohello herstelde database en Hallo andere server toomake.</span><span class="sxs-lookup"><span data-stu-id="e8b95-166">You need toomake sure your existing alert rule settings are updated toomap toohello recovered database and hello different server.</span></span>

<span data-ttu-id="e8b95-167">Zie voor meer informatie over database waarschuwingsregels [waarschuwing meldingen ontvangen](../monitoring-and-diagnostics/insights-receive-alert-notifications.md) en [bijhouden servicestatus](../monitoring-and-diagnostics/insights-service-health.md).</span><span class="sxs-lookup"><span data-stu-id="e8b95-167">For more information about database alert rules, see [Receive Alert Notifications](../monitoring-and-diagnostics/insights-receive-alert-notifications.md) and [Track Service Health](../monitoring-and-diagnostics/insights-service-health.md).</span></span>

### <a name="enable-auditing"></a><span data-ttu-id="e8b95-168">Controle inschakelen</span><span class="sxs-lookup"><span data-stu-id="e8b95-168">Enable auditing</span></span>
<span data-ttu-id="e8b95-169">Als controle vereist tooaccess is de database, moet u tooenable controle na het herstel van Hallo-database.</span><span class="sxs-lookup"><span data-stu-id="e8b95-169">If auditing is required tooaccess your database, you need tooenable Auditing after hello database recovery.</span></span> <span data-ttu-id="e8b95-170">Zie voor meer informatie [Databasecontrole](sql-database-auditing.md).</span><span class="sxs-lookup"><span data-stu-id="e8b95-170">For more information, see [Database auditing](sql-database-auditing.md).</span></span>

## <a name="next-steps"></a><span data-ttu-id="e8b95-171">Volgende stappen</span><span class="sxs-lookup"><span data-stu-id="e8b95-171">Next steps</span></span>
* <span data-ttu-id="e8b95-172">toolearn over Azure SQL Database automatische back-ups, Zie [geautomatiseerde back-ups van SQL-Database](sql-database-automated-backups.md)</span><span class="sxs-lookup"><span data-stu-id="e8b95-172">toolearn about Azure SQL Database automated backups, see [SQL Database automated backups](sql-database-automated-backups.md)</span></span>
* <span data-ttu-id="e8b95-173">toolearn over zakelijke continuïteit ontwerp- en herstelinstellingen scenario's, Zie [continuïteit scenario's](sql-database-business-continuity.md)</span><span class="sxs-lookup"><span data-stu-id="e8b95-173">toolearn about business continuity design and recovery scenarios, see [Continuity scenarios](sql-database-business-continuity.md)</span></span>
* <span data-ttu-id="e8b95-174">toolearn over het gebruik van automatische back-ups voor herstel, Zie [een database terugzetten vanuit Hallo service geïnitieerde back-ups](sql-database-recovery-using-backups.md)</span><span class="sxs-lookup"><span data-stu-id="e8b95-174">toolearn about using automated backups for recovery, see [restore a database from hello service-initiated backups](sql-database-recovery-using-backups.md)</span></span>

