---
title: Een IoT-oplossing bouwen met behulp van de Stream Analytics | Microsoft Docs
description: Zelfstudie voor de Stream Analytics IoT-oplossing van een scenario tolhuisje aan de slag
keywords: IOT-oplossing, vensterfuncties
documentationcenter: 
services: stream-analytics
author: samacha
manager: jhubbard
editor: cgronlun
ms.assetid: a473ea0a-3eaa-4e5b-aaa1-fec7e9069f20
ms.service: stream-analytics
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: data-services
ms.date: 03/28/2017
ms.author: samacha
ms.openlocfilehash: a93693ef7d40025fa96846594a8eb525a50b6885
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 08/18/2017
---
# <a name="build-an-iot-solution-by-using-stream-analytics"></a><span data-ttu-id="18c85-104">Een IoT-oplossing bouwen met behulp van de Stream Analytics</span><span class="sxs-lookup"><span data-stu-id="18c85-104">Build an IoT solution by using Stream Analytics</span></span>
## <a name="introduction"></a><span data-ttu-id="18c85-105">Inleiding</span><span class="sxs-lookup"><span data-stu-id="18c85-105">Introduction</span></span>
<span data-ttu-id="18c85-106">In deze zelfstudie leert u hoe u met Azure Stream Analytics realtime-inzichten verkrijgen van uw gegevens.</span><span class="sxs-lookup"><span data-stu-id="18c85-106">In this tutorial, you will learn how to use Azure Stream Analytics to get real-time insights from your data.</span></span> <span data-ttu-id="18c85-107">Ontwikkelaars kunnen eenvoudig gegevensstromen, zoals Klik streams logboeken en gebeurtenissen die door de apparaten worden gegenereerd met historische records of referentiegegevens worden afgeleid van zakelijke inzichten combineren.</span><span class="sxs-lookup"><span data-stu-id="18c85-107">Developers can easily combine streams of data, such as click-streams, logs, and device-generated events, with historical records or reference data to derive business insights.</span></span> <span data-ttu-id="18c85-108">Als een volledig beheerde, realtime stroom berekening service die wordt gehost in Microsoft Azure, biedt Azure Stream Analytics ingebouwde tolerantie, lage latentie en schaalbaarheid voor bent u in minuten uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="18c85-108">As a fully managed, real-time stream computation service that's hosted in Microsoft Azure, Azure Stream Analytics provides built-in resiliency, low latency, and scalability to get you up and running in minutes.</span></span>

<span data-ttu-id="18c85-109">Na het voltooien van deze zelfstudie, kunt u zich kunt:</span><span class="sxs-lookup"><span data-stu-id="18c85-109">After completing this tutorial, you will be able to:</span></span>

* <span data-ttu-id="18c85-110">Tijd om uzelf bekend met de Azure Stream Analytics-portal.</span><span class="sxs-lookup"><span data-stu-id="18c85-110">Familiarize yourself with the Azure Stream Analytics portal.</span></span>
* <span data-ttu-id="18c85-111">Configureren en implementeren van een streaming-taak.</span><span class="sxs-lookup"><span data-stu-id="18c85-111">Configure and deploy a streaming job.</span></span>
* <span data-ttu-id="18c85-112">Bewoordingen aan echte problemen en ze op te lossen met behulp van de Stream Analytics query language.</span><span class="sxs-lookup"><span data-stu-id="18c85-112">Articulate real-world problems and solve them by using the Stream Analytics query language.</span></span>
* <span data-ttu-id="18c85-113">Ontwikkel streaming van oplossingen voor uw klanten met behulp van de Stream Analytics met vertrouwen.</span><span class="sxs-lookup"><span data-stu-id="18c85-113">Develop streaming solutions for your customers by using Stream Analytics with confidence.</span></span>
* <span data-ttu-id="18c85-114">Gebruik de controle en logboekregistratie ervaring problemen kunt oplossen.</span><span class="sxs-lookup"><span data-stu-id="18c85-114">Use the monitoring and logging experience to troubleshoot issues.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="18c85-115">Vereisten</span><span class="sxs-lookup"><span data-stu-id="18c85-115">Prerequisites</span></span>
<span data-ttu-id="18c85-116">U moet de volgende vereisten om deze zelfstudie te voltooien:</span><span class="sxs-lookup"><span data-stu-id="18c85-116">You will need the following prerequisites to complete this tutorial:</span></span>

* <span data-ttu-id="18c85-117">De nieuwste versie van [Azure PowerShell](/powershell/azure/overview)</span><span class="sxs-lookup"><span data-stu-id="18c85-117">The latest version of [Azure PowerShell](/powershell/azure/overview)</span></span>
* <span data-ttu-id="18c85-118">Visual Studio 2017 2015, of het gratis [Visual Studio Community](https://www.visualstudio.com/products/visual-studio-community-vs.aspx)</span><span class="sxs-lookup"><span data-stu-id="18c85-118">Visual Studio 2017, 2015, or the free [Visual Studio Community](https://www.visualstudio.com/products/visual-studio-community-vs.aspx)</span></span>
* <span data-ttu-id="18c85-119">Een [Azure-abonnement](https://azure.microsoft.com/pricing/free-trial/)</span><span class="sxs-lookup"><span data-stu-id="18c85-119">An [Azure subscription](https://azure.microsoft.com/pricing/free-trial/)</span></span>
* <span data-ttu-id="18c85-120">Beheerdersbevoegdheden op de computer</span><span class="sxs-lookup"><span data-stu-id="18c85-120">Administrative privileges on the computer</span></span>
* <span data-ttu-id="18c85-121">Het downloaden van de [TollApp.zip](https://github.com/Azure/azure-stream-analytics/blob/master/Samples/TollApp/TollApp.zip) uit het Microsoft Downloadcentrum</span><span class="sxs-lookup"><span data-stu-id="18c85-121">Download of [TollApp.zip](https://github.com/Azure/azure-stream-analytics/blob/master/Samples/TollApp/TollApp.zip) from the Microsoft Download Center</span></span>
* <span data-ttu-id="18c85-122">Optioneel: De broncode voor de generator van de gebeurtenis TollApp in [GitHub](https://aka.ms/azure-stream-analytics-toll-source)</span><span class="sxs-lookup"><span data-stu-id="18c85-122">Optional: Source code for the TollApp event generator in [GitHub](https://aka.ms/azure-stream-analytics-toll-source)</span></span>

## <a name="scenario-introduction-hello-toll"></a><span data-ttu-id="18c85-123">Scenario Inleiding: "Hallo, Tolstation!"</span><span class="sxs-lookup"><span data-stu-id="18c85-123">Scenario introduction: “Hello, Toll!”</span></span>
<span data-ttu-id="18c85-124">Een station tolstation is een algemene verschijnsel.</span><span class="sxs-lookup"><span data-stu-id="18c85-124">A toll station is a common phenomenon.</span></span> <span data-ttu-id="18c85-125">Tijdens deze veel autowegen bruggen en tunnels over de hele wereld.</span><span class="sxs-lookup"><span data-stu-id="18c85-125">You encounter them on many expressways, bridges, and tunnels across the world.</span></span> <span data-ttu-id="18c85-126">Elk station tolstation heeft meerdere tolstation stands.</span><span class="sxs-lookup"><span data-stu-id="18c85-126">Each toll station has multiple toll booths.</span></span> <span data-ttu-id="18c85-127">U stoppen als u wilt de tolstation betalen aan een daarmee gepaard gaande op handmatige stands.</span><span class="sxs-lookup"><span data-stu-id="18c85-127">At manual booths, you stop to pay the toll to an attendant.</span></span> <span data-ttu-id="18c85-128">Een sensor boven op elke stand scant op geautomatiseerde stands een RFID-kaart wordt aangebracht op de voorruit van uw vehicle verwerkt als u de gratis stand doorgeven.</span><span class="sxs-lookup"><span data-stu-id="18c85-128">At automated booths, a sensor on top of each booth scans an RFID card that's affixed to the windshield of your vehicle as you pass the toll booth.</span></span> <span data-ttu-id="18c85-129">Het is gemakkelijk om te visualiseren van het verstrijken van de door middel van deze stations tolstation als een stroom gebeurtenissen waarover interessante bewerkingen kunnen worden uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="18c85-129">It is easy to visualize the passage of vehicles through these toll stations as an event stream over which interesting operations can be performed.</span></span>

![Afbeelding van auto's op een tolstation stands](media/stream-analytics-build-an-iot-solution-using-stream-analytics/image1.jpg)

## <a name="incoming-data"></a><span data-ttu-id="18c85-131">Binnenkomende gegevens</span><span class="sxs-lookup"><span data-stu-id="18c85-131">Incoming data</span></span>
<span data-ttu-id="18c85-132">Deze zelfstudie werkt met twee streams gegevens.</span><span class="sxs-lookup"><span data-stu-id="18c85-132">This tutorial works with two streams of data.</span></span> <span data-ttu-id="18c85-133">Sensoren die zijn geïnstalleerd in de in- en afsluiten van de stations tolstation produceren de eerste stroom.</span><span class="sxs-lookup"><span data-stu-id="18c85-133">Sensors installed in the entrance and exit of the toll stations produce the first stream.</span></span> <span data-ttu-id="18c85-134">De tweede stroom is een statische lookup gegevensset die vehicle registratiegegevens heeft.</span><span class="sxs-lookup"><span data-stu-id="18c85-134">The second stream is a static lookup dataset that has vehicle registration data.</span></span>

### <a name="entry-data-stream"></a><span data-ttu-id="18c85-135">Gegevensstroom van vermelding</span><span class="sxs-lookup"><span data-stu-id="18c85-135">Entry data stream</span></span>
<span data-ttu-id="18c85-136">De gegevensstroom vermelding bevat informatie over auto's wanneer deze stations tolstation binnengaat.</span><span class="sxs-lookup"><span data-stu-id="18c85-136">The entry data stream contains information about cars as they enter toll stations.</span></span>

| <span data-ttu-id="18c85-137">TollID</span><span class="sxs-lookup"><span data-stu-id="18c85-137">TollID</span></span> | <span data-ttu-id="18c85-138">EntryTime</span><span class="sxs-lookup"><span data-stu-id="18c85-138">EntryTime</span></span> | <span data-ttu-id="18c85-139">LicensePlate</span><span class="sxs-lookup"><span data-stu-id="18c85-139">LicensePlate</span></span> | <span data-ttu-id="18c85-140">Status</span><span class="sxs-lookup"><span data-stu-id="18c85-140">State</span></span> | <span data-ttu-id="18c85-141">Maken</span><span class="sxs-lookup"><span data-stu-id="18c85-141">Make</span></span> | <span data-ttu-id="18c85-142">Model</span><span class="sxs-lookup"><span data-stu-id="18c85-142">Model</span></span> | <span data-ttu-id="18c85-143">VehicleType</span><span class="sxs-lookup"><span data-stu-id="18c85-143">VehicleType</span></span> | <span data-ttu-id="18c85-144">VehicleWeight</span><span class="sxs-lookup"><span data-stu-id="18c85-144">VehicleWeight</span></span> | <span data-ttu-id="18c85-145">Gratis</span><span class="sxs-lookup"><span data-stu-id="18c85-145">Toll</span></span> | <span data-ttu-id="18c85-146">Label</span><span class="sxs-lookup"><span data-stu-id="18c85-146">Tag</span></span> |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="18c85-147">1</span><span class="sxs-lookup"><span data-stu-id="18c85-147">1</span></span> |<span data-ttu-id="18c85-148">2014-09-10 12:01:00.000</span><span class="sxs-lookup"><span data-stu-id="18c85-148">2014-09-10 12:01:00.000</span></span> |<span data-ttu-id="18c85-149">7001 JNB</span><span class="sxs-lookup"><span data-stu-id="18c85-149">JNB 7001</span></span> |<span data-ttu-id="18c85-150">NY</span><span class="sxs-lookup"><span data-stu-id="18c85-150">NY</span></span> |<span data-ttu-id="18c85-151">Honda</span><span class="sxs-lookup"><span data-stu-id="18c85-151">Honda</span></span> |<span data-ttu-id="18c85-152">CRV</span><span class="sxs-lookup"><span data-stu-id="18c85-152">CRV</span></span> |<span data-ttu-id="18c85-153">1</span><span class="sxs-lookup"><span data-stu-id="18c85-153">1</span></span> |<span data-ttu-id="18c85-154">0</span><span class="sxs-lookup"><span data-stu-id="18c85-154">0</span></span> |<span data-ttu-id="18c85-155">7</span><span class="sxs-lookup"><span data-stu-id="18c85-155">7</span></span> | |
| <span data-ttu-id="18c85-156">1</span><span class="sxs-lookup"><span data-stu-id="18c85-156">1</span></span> |<span data-ttu-id="18c85-157">2014-09-10 12:02:00.000</span><span class="sxs-lookup"><span data-stu-id="18c85-157">2014-09-10 12:02:00.000</span></span> |<span data-ttu-id="18c85-158">YXZ 1001</span><span class="sxs-lookup"><span data-stu-id="18c85-158">YXZ 1001</span></span> |<span data-ttu-id="18c85-159">NY</span><span class="sxs-lookup"><span data-stu-id="18c85-159">NY</span></span> |<span data-ttu-id="18c85-160">Toyota</span><span class="sxs-lookup"><span data-stu-id="18c85-160">Toyota</span></span> |<span data-ttu-id="18c85-161">Camry</span><span class="sxs-lookup"><span data-stu-id="18c85-161">Camry</span></span> |<span data-ttu-id="18c85-162">1</span><span class="sxs-lookup"><span data-stu-id="18c85-162">1</span></span> |<span data-ttu-id="18c85-163">0</span><span class="sxs-lookup"><span data-stu-id="18c85-163">0</span></span> |<span data-ttu-id="18c85-164">4</span><span class="sxs-lookup"><span data-stu-id="18c85-164">4</span></span> |<span data-ttu-id="18c85-165">123456789</span><span class="sxs-lookup"><span data-stu-id="18c85-165">123456789</span></span> |
| <span data-ttu-id="18c85-166">3</span><span class="sxs-lookup"><span data-stu-id="18c85-166">3</span></span> |<span data-ttu-id="18c85-167">2014-09-10 12:02:00.000</span><span class="sxs-lookup"><span data-stu-id="18c85-167">2014-09-10 12:02:00.000</span></span> |<span data-ttu-id="18c85-168">ABC 1004</span><span class="sxs-lookup"><span data-stu-id="18c85-168">ABC 1004</span></span> |<span data-ttu-id="18c85-169">CT</span><span class="sxs-lookup"><span data-stu-id="18c85-169">CT</span></span> |<span data-ttu-id="18c85-170">Ford</span><span class="sxs-lookup"><span data-stu-id="18c85-170">Ford</span></span> |<span data-ttu-id="18c85-171">Taurus</span><span class="sxs-lookup"><span data-stu-id="18c85-171">Taurus</span></span> |<span data-ttu-id="18c85-172">1</span><span class="sxs-lookup"><span data-stu-id="18c85-172">1</span></span> |<span data-ttu-id="18c85-173">0</span><span class="sxs-lookup"><span data-stu-id="18c85-173">0</span></span> |<span data-ttu-id="18c85-174">5</span><span class="sxs-lookup"><span data-stu-id="18c85-174">5</span></span> |<span data-ttu-id="18c85-175">456789123</span><span class="sxs-lookup"><span data-stu-id="18c85-175">456789123</span></span> |
| <span data-ttu-id="18c85-176">2</span><span class="sxs-lookup"><span data-stu-id="18c85-176">2</span></span> |<span data-ttu-id="18c85-177">2014-09-10 12:03:00.000</span><span class="sxs-lookup"><span data-stu-id="18c85-177">2014-09-10 12:03:00.000</span></span> |<span data-ttu-id="18c85-178">XYZ 1003</span><span class="sxs-lookup"><span data-stu-id="18c85-178">XYZ 1003</span></span> |<span data-ttu-id="18c85-179">CT</span><span class="sxs-lookup"><span data-stu-id="18c85-179">CT</span></span> |<span data-ttu-id="18c85-180">Toyota</span><span class="sxs-lookup"><span data-stu-id="18c85-180">Toyota</span></span> |<span data-ttu-id="18c85-181">Corolla</span><span class="sxs-lookup"><span data-stu-id="18c85-181">Corolla</span></span> |<span data-ttu-id="18c85-182">1</span><span class="sxs-lookup"><span data-stu-id="18c85-182">1</span></span> |<span data-ttu-id="18c85-183">0</span><span class="sxs-lookup"><span data-stu-id="18c85-183">0</span></span> |<span data-ttu-id="18c85-184">4</span><span class="sxs-lookup"><span data-stu-id="18c85-184">4</span></span> | |
| <span data-ttu-id="18c85-185">1</span><span class="sxs-lookup"><span data-stu-id="18c85-185">1</span></span> |<span data-ttu-id="18c85-186">2014-09-10 12:03:00.000</span><span class="sxs-lookup"><span data-stu-id="18c85-186">2014-09-10 12:03:00.000</span></span> |<span data-ttu-id="18c85-187">1007 BNJ</span><span class="sxs-lookup"><span data-stu-id="18c85-187">BNJ 1007</span></span> |<span data-ttu-id="18c85-188">NY</span><span class="sxs-lookup"><span data-stu-id="18c85-188">NY</span></span> |<span data-ttu-id="18c85-189">Honda</span><span class="sxs-lookup"><span data-stu-id="18c85-189">Honda</span></span> |<span data-ttu-id="18c85-190">CRV</span><span class="sxs-lookup"><span data-stu-id="18c85-190">CRV</span></span> |<span data-ttu-id="18c85-191">1</span><span class="sxs-lookup"><span data-stu-id="18c85-191">1</span></span> |<span data-ttu-id="18c85-192">0</span><span class="sxs-lookup"><span data-stu-id="18c85-192">0</span></span> |<span data-ttu-id="18c85-193">5</span><span class="sxs-lookup"><span data-stu-id="18c85-193">5</span></span> |<span data-ttu-id="18c85-194">789123456</span><span class="sxs-lookup"><span data-stu-id="18c85-194">789123456</span></span> |
| <span data-ttu-id="18c85-195">2</span><span class="sxs-lookup"><span data-stu-id="18c85-195">2</span></span> |<span data-ttu-id="18c85-196">2014-09-10 12:05:00.000</span><span class="sxs-lookup"><span data-stu-id="18c85-196">2014-09-10 12:05:00.000</span></span> |<span data-ttu-id="18c85-197">CDE 1007</span><span class="sxs-lookup"><span data-stu-id="18c85-197">CDE 1007</span></span> |<span data-ttu-id="18c85-198">NJ</span><span class="sxs-lookup"><span data-stu-id="18c85-198">NJ</span></span> |<span data-ttu-id="18c85-199">Toyota</span><span class="sxs-lookup"><span data-stu-id="18c85-199">Toyota</span></span> |<span data-ttu-id="18c85-200">4 x 4</span><span class="sxs-lookup"><span data-stu-id="18c85-200">4x4</span></span> |<span data-ttu-id="18c85-201">1</span><span class="sxs-lookup"><span data-stu-id="18c85-201">1</span></span> |<span data-ttu-id="18c85-202">0</span><span class="sxs-lookup"><span data-stu-id="18c85-202">0</span></span> |<span data-ttu-id="18c85-203">6</span><span class="sxs-lookup"><span data-stu-id="18c85-203">6</span></span> |<span data-ttu-id="18c85-204">321987654</span><span class="sxs-lookup"><span data-stu-id="18c85-204">321987654</span></span> |

<span data-ttu-id="18c85-205">Hier volgt een korte beschrijving van de kolommen:</span><span class="sxs-lookup"><span data-stu-id="18c85-205">Here is a short description of the columns:</span></span>

| <span data-ttu-id="18c85-206">Kolom</span><span class="sxs-lookup"><span data-stu-id="18c85-206">Column</span></span> | <span data-ttu-id="18c85-207">Beschrijving</span><span class="sxs-lookup"><span data-stu-id="18c85-207">Description</span></span> |
| --- | --- |
| <span data-ttu-id="18c85-208">TollID</span><span class="sxs-lookup"><span data-stu-id="18c85-208">TollID</span></span> |<span data-ttu-id="18c85-209">De tolstation stand-ID die een unieke identificatie van een stand tolstation</span><span class="sxs-lookup"><span data-stu-id="18c85-209">The toll booth ID that uniquely identifies a toll booth</span></span> |
| <span data-ttu-id="18c85-210">EntryTime</span><span class="sxs-lookup"><span data-stu-id="18c85-210">EntryTime</span></span> |<span data-ttu-id="18c85-211">De datum en tijd van de vermelding van de drager naar de stand tolstation in UTC</span><span class="sxs-lookup"><span data-stu-id="18c85-211">The date and time of entry of the vehicle to the toll booth in UTC</span></span> |
| <span data-ttu-id="18c85-212">LicensePlate</span><span class="sxs-lookup"><span data-stu-id="18c85-212">LicensePlate</span></span> |<span data-ttu-id="18c85-213">De sofi-nummer van de drager</span><span class="sxs-lookup"><span data-stu-id="18c85-213">The license plate number of the vehicle</span></span> |
| <span data-ttu-id="18c85-214">Status</span><span class="sxs-lookup"><span data-stu-id="18c85-214">State</span></span> |<span data-ttu-id="18c85-215">Een status in de Verenigde Staten</span><span class="sxs-lookup"><span data-stu-id="18c85-215">A state in United States</span></span> |
| <span data-ttu-id="18c85-216">Maken</span><span class="sxs-lookup"><span data-stu-id="18c85-216">Make</span></span> |<span data-ttu-id="18c85-217">De fabrikant van de auto</span><span class="sxs-lookup"><span data-stu-id="18c85-217">The manufacturer of the automobile</span></span> |
| <span data-ttu-id="18c85-218">Model</span><span class="sxs-lookup"><span data-stu-id="18c85-218">Model</span></span> |<span data-ttu-id="18c85-219">Het modelnummer van het auto</span><span class="sxs-lookup"><span data-stu-id="18c85-219">The model number of the automobile</span></span> |
| <span data-ttu-id="18c85-220">VehicleType</span><span class="sxs-lookup"><span data-stu-id="18c85-220">VehicleType</span></span> |<span data-ttu-id="18c85-221">1 voor passagiers voertuigen of 2 voor commerciële voertuigen</span><span class="sxs-lookup"><span data-stu-id="18c85-221">Either 1 for passenger vehicles or 2 for commercial vehicles</span></span> |
| <span data-ttu-id="18c85-222">WeightType</span><span class="sxs-lookup"><span data-stu-id="18c85-222">WeightType</span></span> |<span data-ttu-id="18c85-223">Toegestaan gewicht in ton; 0 voor passagiers voertuigen</span><span class="sxs-lookup"><span data-stu-id="18c85-223">Vehicle weight in tons; 0 for passenger vehicles</span></span> |
| <span data-ttu-id="18c85-224">Gratis</span><span class="sxs-lookup"><span data-stu-id="18c85-224">Toll</span></span> |<span data-ttu-id="18c85-225">De waarde tolstation in USD</span><span class="sxs-lookup"><span data-stu-id="18c85-225">The toll value in USD</span></span> |
| <span data-ttu-id="18c85-226">Label</span><span class="sxs-lookup"><span data-stu-id="18c85-226">Tag</span></span> |<span data-ttu-id="18c85-227">De e-code op de auto die betaling automatiseert. lege wanneer de betaling handmatig is uitgevoerd</span><span class="sxs-lookup"><span data-stu-id="18c85-227">The e-Tag on the automobile that automates payment; blank where the payment was done manually</span></span> |

### <a name="exit-data-stream"></a><span data-ttu-id="18c85-228">De gegevensstroom afsluiten</span><span class="sxs-lookup"><span data-stu-id="18c85-228">Exit data stream</span></span>
<span data-ttu-id="18c85-229">De gegevensstroom afsluiten bevat informatie over het station tolstation verlaten auto's.</span><span class="sxs-lookup"><span data-stu-id="18c85-229">The exit data stream contains information about cars leaving the toll station.</span></span>

| <span data-ttu-id="18c85-230">**TollId**</span><span class="sxs-lookup"><span data-stu-id="18c85-230">**TollId**</span></span> | <span data-ttu-id="18c85-231">**ExitTime**</span><span class="sxs-lookup"><span data-stu-id="18c85-231">**ExitTime**</span></span> | <span data-ttu-id="18c85-232">**LicensePlate**</span><span class="sxs-lookup"><span data-stu-id="18c85-232">**LicensePlate**</span></span> |
| --- | --- | --- |
| <span data-ttu-id="18c85-233">1</span><span class="sxs-lookup"><span data-stu-id="18c85-233">1</span></span> |<span data-ttu-id="18c85-234">2014-09-10T12:03:00.0000000Z</span><span class="sxs-lookup"><span data-stu-id="18c85-234">2014-09-10T12:03:00.0000000Z</span></span> |<span data-ttu-id="18c85-235">7001 JNB</span><span class="sxs-lookup"><span data-stu-id="18c85-235">JNB 7001</span></span> |
| <span data-ttu-id="18c85-236">1</span><span class="sxs-lookup"><span data-stu-id="18c85-236">1</span></span> |<span data-ttu-id="18c85-237">2014-09-10T12:03:00.0000000Z</span><span class="sxs-lookup"><span data-stu-id="18c85-237">2014-09-10T12:03:00.0000000Z</span></span> |<span data-ttu-id="18c85-238">YXZ 1001</span><span class="sxs-lookup"><span data-stu-id="18c85-238">YXZ 1001</span></span> |
| <span data-ttu-id="18c85-239">3</span><span class="sxs-lookup"><span data-stu-id="18c85-239">3</span></span> |<span data-ttu-id="18c85-240">2014-09-10T12:04:00.0000000Z</span><span class="sxs-lookup"><span data-stu-id="18c85-240">2014-09-10T12:04:00.0000000Z</span></span> |<span data-ttu-id="18c85-241">ABC 1004</span><span class="sxs-lookup"><span data-stu-id="18c85-241">ABC 1004</span></span> |
| <span data-ttu-id="18c85-242">2</span><span class="sxs-lookup"><span data-stu-id="18c85-242">2</span></span> |<span data-ttu-id="18c85-243">2014-09-10T12:07:00.0000000Z</span><span class="sxs-lookup"><span data-stu-id="18c85-243">2014-09-10T12:07:00.0000000Z</span></span> |<span data-ttu-id="18c85-244">XYZ 1003</span><span class="sxs-lookup"><span data-stu-id="18c85-244">XYZ 1003</span></span> |
| <span data-ttu-id="18c85-245">1</span><span class="sxs-lookup"><span data-stu-id="18c85-245">1</span></span> |<span data-ttu-id="18c85-246">2014-09-10T12:08:00.0000000Z</span><span class="sxs-lookup"><span data-stu-id="18c85-246">2014-09-10T12:08:00.0000000Z</span></span> |<span data-ttu-id="18c85-247">1007 BNJ</span><span class="sxs-lookup"><span data-stu-id="18c85-247">BNJ 1007</span></span> |
| <span data-ttu-id="18c85-248">2</span><span class="sxs-lookup"><span data-stu-id="18c85-248">2</span></span> |<span data-ttu-id="18c85-249">2014-09-10T12:07:00.0000000Z</span><span class="sxs-lookup"><span data-stu-id="18c85-249">2014-09-10T12:07:00.0000000Z</span></span> |<span data-ttu-id="18c85-250">CDE 1007</span><span class="sxs-lookup"><span data-stu-id="18c85-250">CDE 1007</span></span> |

<span data-ttu-id="18c85-251">Hier volgt een korte beschrijving van de kolommen:</span><span class="sxs-lookup"><span data-stu-id="18c85-251">Here is a short description of the columns:</span></span>

| <span data-ttu-id="18c85-252">Kolom</span><span class="sxs-lookup"><span data-stu-id="18c85-252">Column</span></span> | <span data-ttu-id="18c85-253">Beschrijving</span><span class="sxs-lookup"><span data-stu-id="18c85-253">Description</span></span> |
| --- | --- |
| <span data-ttu-id="18c85-254">TollID</span><span class="sxs-lookup"><span data-stu-id="18c85-254">TollID</span></span> |<span data-ttu-id="18c85-255">De tolstation stand-ID die een unieke identificatie van een stand tolstation</span><span class="sxs-lookup"><span data-stu-id="18c85-255">The toll booth ID that uniquely identifies a toll booth</span></span> |
| <span data-ttu-id="18c85-256">ExitTime</span><span class="sxs-lookup"><span data-stu-id="18c85-256">ExitTime</span></span> |<span data-ttu-id="18c85-257">De datum en tijd van af te sluiten van de drager van tolstation stand in UTC</span><span class="sxs-lookup"><span data-stu-id="18c85-257">The date and time of exit of the vehicle from toll booth in UTC</span></span> |
| <span data-ttu-id="18c85-258">LicensePlate</span><span class="sxs-lookup"><span data-stu-id="18c85-258">LicensePlate</span></span> |<span data-ttu-id="18c85-259">De sofi-nummer van de drager</span><span class="sxs-lookup"><span data-stu-id="18c85-259">The license plate number of the vehicle</span></span> |

### <a name="commercial-vehicle-registration-data"></a><span data-ttu-id="18c85-260">De registratiegegevens commerciële vehicle</span><span class="sxs-lookup"><span data-stu-id="18c85-260">Commercial vehicle registration data</span></span>
<span data-ttu-id="18c85-261">De zelfstudie maakt gebruik van een momentopname van een registratiedatabase commerciële vehicle verwerkt.</span><span class="sxs-lookup"><span data-stu-id="18c85-261">The tutorial uses a static snapshot of a commercial vehicle registration database.</span></span>

| <span data-ttu-id="18c85-262">LicensePlate</span><span class="sxs-lookup"><span data-stu-id="18c85-262">LicensePlate</span></span> | <span data-ttu-id="18c85-263">Registratie-id</span><span class="sxs-lookup"><span data-stu-id="18c85-263">RegistrationId</span></span> | <span data-ttu-id="18c85-264">Verlopen</span><span class="sxs-lookup"><span data-stu-id="18c85-264">Expired</span></span> |
| --- | --- | --- |
| <span data-ttu-id="18c85-265">SVT 6023</span><span class="sxs-lookup"><span data-stu-id="18c85-265">SVT 6023</span></span> |<span data-ttu-id="18c85-266">285429838</span><span class="sxs-lookup"><span data-stu-id="18c85-266">285429838</span></span> |<span data-ttu-id="18c85-267">1</span><span class="sxs-lookup"><span data-stu-id="18c85-267">1</span></span> |
| <span data-ttu-id="18c85-268">XLZ 3463</span><span class="sxs-lookup"><span data-stu-id="18c85-268">XLZ 3463</span></span> |<span data-ttu-id="18c85-269">362715656</span><span class="sxs-lookup"><span data-stu-id="18c85-269">362715656</span></span> |<span data-ttu-id="18c85-270">0</span><span class="sxs-lookup"><span data-stu-id="18c85-270">0</span></span> |
| <span data-ttu-id="18c85-271">1005 BACK</span><span class="sxs-lookup"><span data-stu-id="18c85-271">BAC 1005</span></span> |<span data-ttu-id="18c85-272">876133137</span><span class="sxs-lookup"><span data-stu-id="18c85-272">876133137</span></span> |<span data-ttu-id="18c85-273">1</span><span class="sxs-lookup"><span data-stu-id="18c85-273">1</span></span> |
| <span data-ttu-id="18c85-274">RIV 8632</span><span class="sxs-lookup"><span data-stu-id="18c85-274">RIV 8632</span></span> |<span data-ttu-id="18c85-275">992711956</span><span class="sxs-lookup"><span data-stu-id="18c85-275">992711956</span></span> |<span data-ttu-id="18c85-276">0</span><span class="sxs-lookup"><span data-stu-id="18c85-276">0</span></span> |
| <span data-ttu-id="18c85-277">SNY 7188</span><span class="sxs-lookup"><span data-stu-id="18c85-277">SNY 7188</span></span> |<span data-ttu-id="18c85-278">592133890</span><span class="sxs-lookup"><span data-stu-id="18c85-278">592133890</span></span> |<span data-ttu-id="18c85-279">0</span><span class="sxs-lookup"><span data-stu-id="18c85-279">0</span></span> |
| <span data-ttu-id="18c85-280">ELH 9896</span><span class="sxs-lookup"><span data-stu-id="18c85-280">ELH 9896</span></span> |<span data-ttu-id="18c85-281">678427724</span><span class="sxs-lookup"><span data-stu-id="18c85-281">678427724</span></span> |<span data-ttu-id="18c85-282">1</span><span class="sxs-lookup"><span data-stu-id="18c85-282">1</span></span> |

<span data-ttu-id="18c85-283">Hier volgt een korte beschrijving van de kolommen:</span><span class="sxs-lookup"><span data-stu-id="18c85-283">Here is a short description of the columns:</span></span>

| <span data-ttu-id="18c85-284">Kolom</span><span class="sxs-lookup"><span data-stu-id="18c85-284">Column</span></span> | <span data-ttu-id="18c85-285">Beschrijving</span><span class="sxs-lookup"><span data-stu-id="18c85-285">Description</span></span> |
| --- | --- |
| <span data-ttu-id="18c85-286">LicensePlate</span><span class="sxs-lookup"><span data-stu-id="18c85-286">LicensePlate</span></span> |<span data-ttu-id="18c85-287">De sofi-nummer van de drager</span><span class="sxs-lookup"><span data-stu-id="18c85-287">The license plate number of the vehicle</span></span> |
| <span data-ttu-id="18c85-288">Registratie-id</span><span class="sxs-lookup"><span data-stu-id="18c85-288">RegistrationId</span></span> |<span data-ttu-id="18c85-289">De drager registratie-ID</span><span class="sxs-lookup"><span data-stu-id="18c85-289">The vehicle's registration ID</span></span> |
| <span data-ttu-id="18c85-290">Verlopen</span><span class="sxs-lookup"><span data-stu-id="18c85-290">Expired</span></span> |<span data-ttu-id="18c85-291">De registratiestatus van de drager: 0 of vehicle registratie actief is, is 1 als de registratie is verlopen</span><span class="sxs-lookup"><span data-stu-id="18c85-291">The registration status of the vehicle: 0 if vehicle registration is active, 1 if registration is expired</span></span> |

## <a name="set-up-the-environment-for-azure-stream-analytics"></a><span data-ttu-id="18c85-292">Instellen van de omgeving voor Azure Stream Analytics</span><span class="sxs-lookup"><span data-stu-id="18c85-292">Set up the environment for Azure Stream Analytics</span></span>
<span data-ttu-id="18c85-293">Voor deze zelfstudie hebt voltooid, moet u een Microsoft Azure-abonnement.</span><span class="sxs-lookup"><span data-stu-id="18c85-293">To complete this tutorial, you need a Microsoft Azure subscription.</span></span> <span data-ttu-id="18c85-294">Microsoft biedt een gratis proefversie van Microsoft Azure-services.</span><span class="sxs-lookup"><span data-stu-id="18c85-294">Microsoft offers free trial for Microsoft Azure services.</span></span>

<span data-ttu-id="18c85-295">Als u geen Azure-account hebt, kunt u [aanvragen van een gratis evaluatieversie](http://azure.microsoft.com/pricing/free-trial/).</span><span class="sxs-lookup"><span data-stu-id="18c85-295">If you do not have an Azure account, you can [request a free trial version](http://azure.microsoft.com/pricing/free-trial/).</span></span>

> [!NOTE]
> <span data-ttu-id="18c85-296">Als u wilt aanmelden voor een gratis proefversie, moet u een mobiel apparaat dat u kunt tekstberichten en een geldige creditcard ontvangen.</span><span class="sxs-lookup"><span data-stu-id="18c85-296">To sign up for a free trial, you need a mobile device that can receive text messages and a valid credit card.</span></span>
> 
> 

<span data-ttu-id="18c85-297">Zorg ervoor dat de stappen in de sectie 'Opschonen van uw Azure-account' aan het einde van dit artikel zodat u kunt het beste gebruik van uw Azure-tegoed.</span><span class="sxs-lookup"><span data-stu-id="18c85-297">Be sure to follow the steps in the “Clean up your Azure account” section at the end of this article so that you can make the best use of your Azure credit.</span></span>

## <a name="provision-azure-resources-required-for-the-tutorial"></a><span data-ttu-id="18c85-298">Azure-resources nodig zijn voor de zelfstudie inrichten</span><span class="sxs-lookup"><span data-stu-id="18c85-298">Provision Azure resources required for the tutorial</span></span>
<span data-ttu-id="18c85-299">Deze zelfstudie vereist twee event hubs ontvangen *vermelding* en *sluiten* gegevensstromen.</span><span class="sxs-lookup"><span data-stu-id="18c85-299">This tutorial requires two event hubs to receive *entry* and *exit* data streams.</span></span> <span data-ttu-id="18c85-300">Azure SQL Database worden de resultaten van de Stream Analytics-taken.</span><span class="sxs-lookup"><span data-stu-id="18c85-300">Azure SQL Database outputs the results of the Stream Analytics jobs.</span></span> <span data-ttu-id="18c85-301">Azure Storage worden opgeslagen referentiegegevens over vehicle registraties.</span><span class="sxs-lookup"><span data-stu-id="18c85-301">Azure Storage stores reference data about vehicle registrations.</span></span>

<span data-ttu-id="18c85-302">U kunt het script Setup.ps1 in de map TollApp op GitHub gebruiken om alle vereiste resources te maken.</span><span class="sxs-lookup"><span data-stu-id="18c85-302">You can use the Setup.ps1 script in the TollApp folder on GitHub to create all required resources.</span></span> <span data-ttu-id="18c85-303">Met het oog op tijd, is het raadzaam dat u het uitvoert.</span><span class="sxs-lookup"><span data-stu-id="18c85-303">In the interest of time, we recommend that you run it.</span></span> <span data-ttu-id="18c85-304">Als u meer informatie over het configureren van deze resources in de Azure portal wilt, raadpleegt u de bijlage 'Zelfstudie resources in Azure-portal configureren'.</span><span class="sxs-lookup"><span data-stu-id="18c85-304">If you would like to learn more about how to configure these resources in the Azure portal, refer to the “Configuring tutorial resources in Azure portal” appendix.</span></span>

<span data-ttu-id="18c85-305">Download en sla de ondersteunende [TollApp](https://github.com/Azure/azure-stream-analytics/blob/master/Samples/TollApp/TollApp.zip) map en bestanden.</span><span class="sxs-lookup"><span data-stu-id="18c85-305">Download and save the supporting [TollApp](https://github.com/Azure/azure-stream-analytics/blob/master/Samples/TollApp/TollApp.zip) folder and files.</span></span>

<span data-ttu-id="18c85-306">Open een **Microsoft Azure PowerShell** venster *als beheerder*.</span><span class="sxs-lookup"><span data-stu-id="18c85-306">Open a **Microsoft Azure PowerShell** window *as an administrator*.</span></span> <span data-ttu-id="18c85-307">Als u nog geen Azure PowerShell, volg de instructies in [Azure PowerShell installeren en configureren](/powershell/azure/overview) om deze te installeren.</span><span class="sxs-lookup"><span data-stu-id="18c85-307">If you do not yet have Azure PowerShell, follow the instructions in [Install and configure Azure PowerShell](/powershell/azure/overview) to install it.</span></span>

<span data-ttu-id="18c85-308">Omdat Windows wordt automatisch geblokkeerd .ps1-, dll- en .exe-bestanden, moet u het uitvoeringsbeleid instellen voordat u het script uitvoeren.</span><span class="sxs-lookup"><span data-stu-id="18c85-308">Because Windows automatically blocks .ps1, .dll, and .exe files, you need to set the execution policy before you run the script.</span></span> <span data-ttu-id="18c85-309">Zorg ervoor dat de Azure PowerShell-venster wordt uitgevoerd *als beheerder*.</span><span class="sxs-lookup"><span data-stu-id="18c85-309">Make sure the Azure PowerShell window is running *as an administrator*.</span></span> <span data-ttu-id="18c85-310">Voer **Set-ExecutionPolicy unrestricted**.</span><span class="sxs-lookup"><span data-stu-id="18c85-310">Run **Set-ExecutionPolicy unrestricted**.</span></span> <span data-ttu-id="18c85-311">Wanneer u wordt gevraagd, typt u **Y**.</span><span class="sxs-lookup"><span data-stu-id="18c85-311">When prompted, type **Y**.</span></span>

![Schermopname van 'Set-ExecutionPolicy unrestricted' uitgevoerd in Azure PowerShell-venster](media/stream-analytics-build-an-iot-solution-using-stream-analytics/image2.png)

<span data-ttu-id="18c85-313">Voer **Get-ExecutionPolicy** om ervoor te zorgen dat de opdracht gewerkt.</span><span class="sxs-lookup"><span data-stu-id="18c85-313">Run **Get-ExecutionPolicy** to make sure that the command worked.</span></span>

![Schermopname van 'Get-ExecutionPolicy' uitgevoerd in Azure PowerShell-venster](media/stream-analytics-build-an-iot-solution-using-stream-analytics/image3.png)

<span data-ttu-id="18c85-315">Ga naar de map waarin de scripts en de generator van toepassing is.</span><span class="sxs-lookup"><span data-stu-id="18c85-315">Go to the directory that has the scripts and generator application.</span></span>

![Schermopname van 'cd .\TollApp\TollApp' in de Azure PowerShell-venster](media/stream-analytics-build-an-iot-solution-using-stream-analytics/image4.png)

<span data-ttu-id="18c85-317">Type **.\\ Setup.ps1** als u uw Azure-account instelt, maken en alle vereiste bronnen configureren en starten gebeurtenissen genereren.</span><span class="sxs-lookup"><span data-stu-id="18c85-317">Type **.\\Setup.ps1** to set up your Azure account, create and configure all required resources, and start to generate events.</span></span> <span data-ttu-id="18c85-318">Het script willekeurig neemt over een regio om uw resources te maken.</span><span class="sxs-lookup"><span data-stu-id="18c85-318">The script randomly picks up a region to create your resources.</span></span> <span data-ttu-id="18c85-319">Als u expliciet een regio, u kunt doorgeven de **-locatie** parameter zoals in het volgende voorbeeld:</span><span class="sxs-lookup"><span data-stu-id="18c85-319">To explicitly specify a region, you can pass the **-location** parameter as in the following example:</span></span>

<span data-ttu-id="18c85-320">**. \\Setup.ps1-locatie 'VS-midden'**</span><span class="sxs-lookup"><span data-stu-id="18c85-320">**.\\Setup.ps1 -location “Central US”**</span></span>

![Schermafbeelding van de Azure-aanmeldingspagina](media/stream-analytics-build-an-iot-solution-using-stream-analytics/image5.png)

<span data-ttu-id="18c85-322">Hiermee opent u het script de **aanmelden** pagina voor Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="18c85-322">The script opens the **Sign In** page for Microsoft Azure.</span></span> <span data-ttu-id="18c85-323">Voer de referenties van uw account.</span><span class="sxs-lookup"><span data-stu-id="18c85-323">Enter your account credentials.</span></span>

> [!NOTE]
> <span data-ttu-id="18c85-324">Als uw account toegang tot meerdere abonnementen heeft, wordt u gevraagd de naam van het abonnement dat u wilt gebruiken voor de zelfstudie invoeren.</span><span class="sxs-lookup"><span data-stu-id="18c85-324">If your account has access to multiple subscriptions, you will be asked to enter the subscription name that you want to use for the tutorial.</span></span>
> 
> 

<span data-ttu-id="18c85-325">Het script kan enige tijd duren om uit te voeren.</span><span class="sxs-lookup"><span data-stu-id="18c85-325">The script can take several minutes to run.</span></span> <span data-ttu-id="18c85-326">Nadat deze is voltooid, wordt de uitvoer moet eruitzien als in de volgende schermafbeelding.</span><span class="sxs-lookup"><span data-stu-id="18c85-326">After it finishes, the output should look like the following screenshot.</span></span>

![Schermopname van het resultaat van het script in de Azure PowerShell-venster](media/stream-analytics-build-an-iot-solution-using-stream-analytics/image6.PNG)

<span data-ttu-id="18c85-328">U ziet ook een ander venster die vergelijkbaar is met de volgende schermopname.</span><span class="sxs-lookup"><span data-stu-id="18c85-328">You will also see another window that's similar to the following screenshot.</span></span> <span data-ttu-id="18c85-329">Deze toepassing is het verzenden van gebeurtenissen naar Azure Event Hubs, die is vereist voor het uitvoeren van de zelfstudie.</span><span class="sxs-lookup"><span data-stu-id="18c85-329">This application is sending events to Azure Event Hubs, which is required to run the tutorial.</span></span> <span data-ttu-id="18c85-330">Dus geen stop de toepassing of dit venster sluiten totdat u de zelfstudie hebt voltooid.</span><span class="sxs-lookup"><span data-stu-id="18c85-330">So, do not stop the application or close this window until you finish the tutorial.</span></span>

![Schermopname van 'Verzenden event hub gegevens'](media/stream-analytics-build-an-iot-solution-using-stream-analytics/image7.png)

<span data-ttu-id="18c85-332">U moet nu zien van uw resources in Azure-portal.</span><span class="sxs-lookup"><span data-stu-id="18c85-332">You should be able to see your resources in Azure portal now.</span></span> <span data-ttu-id="18c85-333">Ga naar <https://portal.azure.com>, en meld u aan met referenties van uw account.</span><span class="sxs-lookup"><span data-stu-id="18c85-333">Go to <https://portal.azure.com>, and sign in with your account credentials.</span></span> <span data-ttu-id="18c85-334">Houd er rekening mee dat momenteel bepaalde functionaliteit maakt gebruik van de klassieke portal.</span><span class="sxs-lookup"><span data-stu-id="18c85-334">Note that currently some functionality utilizes the classic portal.</span></span> <span data-ttu-id="18c85-335">Deze stappen worden duidelijk vermeld.</span><span class="sxs-lookup"><span data-stu-id="18c85-335">These steps will be clearly indicated.</span></span>

### <a name="azure-event-hubs"></a><span data-ttu-id="18c85-336">Azure Event Hubs</span><span class="sxs-lookup"><span data-stu-id="18c85-336">Azure Event Hubs</span></span>
<span data-ttu-id="18c85-337">Klik in de Azure-portal op **meer services** aan de onderkant van het deelvenster links management.</span><span class="sxs-lookup"><span data-stu-id="18c85-337">In the Azure portal, click **More services** on the bottom of the left management pane.</span></span> <span data-ttu-id="18c85-338">Type **Event hubs** opgegeven in het veld en klikt u op **Event hubs**.</span><span class="sxs-lookup"><span data-stu-id="18c85-338">Type **Event hubs** in the field provided and click **Event hubs**.</span></span> <span data-ttu-id="18c85-339">Dit start een nieuw browservenster om weer te geven de **SERVICE BUS** gebied in de **klassieke portal**.</span><span class="sxs-lookup"><span data-stu-id="18c85-339">This launches a new browser window to display the **SERVICE BUS** area in the **classic portal**.</span></span> <span data-ttu-id="18c85-340">Hier ziet u de Event Hub gemaakt door het script Setup.ps1.</span><span class="sxs-lookup"><span data-stu-id="18c85-340">Here you can see the Event Hub created by the Setup.ps1 script.</span></span>

![Service Bus](media/stream-analytics-build-an-iot-solution-using-stream-analytics/image8.png)

<span data-ttu-id="18c85-342">Klik op de computer die met begint *tolldata*.</span><span class="sxs-lookup"><span data-stu-id="18c85-342">Click the one that starts with *tolldata*.</span></span> <span data-ttu-id="18c85-343">Klik op de **EVENT HUBS** tabblad. Ziet u twee event hubs met de naam *vermelding* en *sluiten* gemaakt in deze naamruimte.</span><span class="sxs-lookup"><span data-stu-id="18c85-343">Click the **EVENT HUBS** tab. You will see two event hubs named *entry* and *exit* created in this namespace.</span></span>

![Event Hubs-tabblad in de klassieke portal](media/stream-analytics-build-an-iot-solution-using-stream-analytics/image9.png)

### <a name="azure-storage-container"></a><span data-ttu-id="18c85-345">Azure Storage-container</span><span class="sxs-lookup"><span data-stu-id="18c85-345">Azure Storage container</span></span>
1. <span data-ttu-id="18c85-346">Ga terug naar het tabblad in uw browser geopend naar Azure-portal.</span><span class="sxs-lookup"><span data-stu-id="18c85-346">Go back to the tab in your browser open to Azure portal.</span></span> <span data-ttu-id="18c85-347">Klik op **opslag** aan de linkerkant van de Azure portal om te zien van de Azure Storage-container die in de zelfstudie wordt gebruikt.</span><span class="sxs-lookup"><span data-stu-id="18c85-347">Click **STORAGE** on the left side of the Azure portal to see the Azure Storage container that's used in the tutorial.</span></span>
   
    ![Opslag menu-item](media/stream-analytics-build-an-iot-solution-using-stream-analytics/image11.png)
2. <span data-ttu-id="18c85-349">Klik op de computer die beginnen met *tolldata*.</span><span class="sxs-lookup"><span data-stu-id="18c85-349">Click the one that start with *tolldata*.</span></span> <span data-ttu-id="18c85-350">Klik op de **CONTAINERS** tabblad voor een overzicht van de container gemaakt.</span><span class="sxs-lookup"><span data-stu-id="18c85-350">Click the **CONTAINERS** tab to see the created container.</span></span>
   
    ![Tabblad containers in de Azure portal](media/stream-analytics-build-an-iot-solution-using-stream-analytics/image10.png)
3. <span data-ttu-id="18c85-352">Klik op de **tolldata** container om te zien van het geüploade JSON-bestand met registratiegegevens vehicle verwerkt.</span><span class="sxs-lookup"><span data-stu-id="18c85-352">Click the **tolldata** container to see the uploaded JSON file that has vehicle registration data.</span></span>
   
    ![Schermopname van het bestand registration.json in de container](media/stream-analytics-build-an-iot-solution-using-stream-analytics/image12.png)

### <a name="azure-sql-database"></a><span data-ttu-id="18c85-354">Azure SQL Database</span><span class="sxs-lookup"><span data-stu-id="18c85-354">Azure SQL Database</span></span>
1. <span data-ttu-id="18c85-355">Ga terug naar de Azure-portal op het eerste tabblad die is geopend in de browser.</span><span class="sxs-lookup"><span data-stu-id="18c85-355">Go back to the Azure portal on the first tab that was opened in the browser.</span></span> <span data-ttu-id="18c85-356">Klik op **SQL-DATABASES** aan de linkerkant van de Azure portal om te zien van de SQL-database die wordt gebruikt in de zelfstudie en klik op **tolldatadb**.</span><span class="sxs-lookup"><span data-stu-id="18c85-356">Click **SQL DATABASES** on the left side of the Azure portal to see the SQL database that will be used in the tutorial and click **tolldatadb**.</span></span>
   
    ![Schermafbeelding van de SQL-database gemaakt](media/stream-analytics-build-an-iot-solution-using-stream-analytics/image15.png)
2. <span data-ttu-id="18c85-358">Kopieer de naam van de server zonder het poortnummer (*servername*. database.windows.net bijvoorbeeld).</span><span class="sxs-lookup"><span data-stu-id="18c85-358">Copy the server name without the port number (*servername*.database.windows.net, for example).</span></span>
    <span data-ttu-id="18c85-359">![Schermafbeelding van de gemaakte database van SQL database](media/stream-analytics-build-an-iot-solution-using-stream-analytics/image15a.png)</span><span class="sxs-lookup"><span data-stu-id="18c85-359">![Screenshot of the created SQL database db](media/stream-analytics-build-an-iot-solution-using-stream-analytics/image15a.png)</span></span>

## <a name="connect-to-the-database-from-visual-studio"></a><span data-ttu-id="18c85-360">Verbinding maken met de database vanuit Visual Studio</span><span class="sxs-lookup"><span data-stu-id="18c85-360">Connect to the database from Visual Studio</span></span>
<span data-ttu-id="18c85-361">Visual Studio gebruiken voor toegang tot de resultaten van de query in de Uitvoerdatabase.</span><span class="sxs-lookup"><span data-stu-id="18c85-361">Use Visual Studio to access query results in the output database.</span></span>

<span data-ttu-id="18c85-362">Verbinding maken met de SQL-database (doel) vanuit Visual Studio:</span><span class="sxs-lookup"><span data-stu-id="18c85-362">Connect to the SQL database (the destination) from Visual Studio:</span></span>

1. <span data-ttu-id="18c85-363">Open Visual Studio en klik vervolgens op **extra** > **verbinding maken met Database**.</span><span class="sxs-lookup"><span data-stu-id="18c85-363">Open Visual Studio, and then click **Tools** > **Connect to Database**.</span></span>
2. <span data-ttu-id="18c85-364">Als u wordt gevraagd, klikt u op **Microsoft SQL Server** als gegevensbron.</span><span class="sxs-lookup"><span data-stu-id="18c85-364">If asked, click **Microsoft SQL Server** as a data source.</span></span>
   
    ![Het dialoogvenster gegevensbron wijzigen](media/stream-analytics-build-an-iot-solution-using-stream-analytics/image16.png)
3. <span data-ttu-id="18c85-366">In de **servernaam** veld, plak de naam die u in de vorige sectie hebt gekopieerd vanuit de Azure-portal (dat wil zeggen, *servername*. database.windows.net).</span><span class="sxs-lookup"><span data-stu-id="18c85-366">In the **Server name** field, paste the name that you copied in the previous section from the Azure portal (that is, *servername*.database.windows.net).</span></span>
4. <span data-ttu-id="18c85-367">Klik op **SQL Server-verificatie gebruiken**.</span><span class="sxs-lookup"><span data-stu-id="18c85-367">Click **Use SQL Server Authentication**.</span></span>
5. <span data-ttu-id="18c85-368">Voer **tolladmin** in de **gebruikersnaam** veld en **123toll!**</span><span class="sxs-lookup"><span data-stu-id="18c85-368">Enter **tolladmin** in the **User name** field and **123toll!**</span></span> <span data-ttu-id="18c85-369">in de **wachtwoord** veld.</span><span class="sxs-lookup"><span data-stu-id="18c85-369">in the **Password** field.</span></span>
6. <span data-ttu-id="18c85-370">Klik op **Selecteer of voer een databasenaam**, en selecteer **TollDataDB** als de database.</span><span class="sxs-lookup"><span data-stu-id="18c85-370">Click **Select or enter a database name**, and select **TollDataDB** as the database.</span></span>
   
    ![Het dialoogvenster verbinding toevoegen](media/stream-analytics-build-an-iot-solution-using-stream-analytics/image17.jpg)
7. <span data-ttu-id="18c85-372">Klik op **OK**.</span><span class="sxs-lookup"><span data-stu-id="18c85-372">Click **OK**.</span></span>
8. <span data-ttu-id="18c85-373">Open in Server Explorer.</span><span class="sxs-lookup"><span data-stu-id="18c85-373">Open Server Explorer.</span></span>
   
    ![Server Explorer](media/stream-analytics-build-an-iot-solution-using-stream-analytics/image18.png)
9. <span data-ttu-id="18c85-375">Zie vier tabellen in de database TollDataDB.</span><span class="sxs-lookup"><span data-stu-id="18c85-375">See four tables in the TollDataDB database.</span></span>
   
    ![Tabellen in de database TollDataDB](media/stream-analytics-build-an-iot-solution-using-stream-analytics/image19.jpg)

## <a name="event-generator-tollapp-sample-project"></a><span data-ttu-id="18c85-377">Gebeurtenis generator: TollApp-voorbeeldproject</span><span class="sxs-lookup"><span data-stu-id="18c85-377">Event generator: TollApp sample project</span></span>
<span data-ttu-id="18c85-378">Het PowerShell-script wordt automatisch gestart voor het verzenden van gebeurtenissen met behulp van de toepassing van TollApp voorbeeld.</span><span class="sxs-lookup"><span data-stu-id="18c85-378">The PowerShell script automatically starts to send events by using the TollApp sample application program.</span></span> <span data-ttu-id="18c85-379">U hoeft niet te eventuele extra stappen uitvoeren.</span><span class="sxs-lookup"><span data-stu-id="18c85-379">You don’t need to perform any additional steps.</span></span>

<span data-ttu-id="18c85-380">Als u geïnteresseerd in de implementatiegegevens bent, kunt u de broncode van de toepassing TollApp vinden in GitHub [samples/TollApp](https://aka.ms/azure-stream-analytics-toll-source).</span><span class="sxs-lookup"><span data-stu-id="18c85-380">However, if you are interested in implementation details, you can find the source code of the TollApp application in GitHub [samples/TollApp](https://aka.ms/azure-stream-analytics-toll-source).</span></span>

![Schermopname van voorbeeldcode weergegeven in Visual Studio](media/stream-analytics-build-an-iot-solution-using-stream-analytics/image20.png)

## <a name="create-a-stream-analytics-job"></a><span data-ttu-id="18c85-382">Een Stream Analytics-taak maken</span><span class="sxs-lookup"><span data-stu-id="18c85-382">Create a Stream Analytics job</span></span>
1. <span data-ttu-id="18c85-383">Klik op het groen plusteken in de linkerbovenhoek van de pagina voor het maken van een nieuwe Stream Analytics-taak in de Azure portal.</span><span class="sxs-lookup"><span data-stu-id="18c85-383">In the Azure portal, click the green plus sign in the top-left corner of the page to create a new Stream Analytics job.</span></span> <span data-ttu-id="18c85-384">Selecteer **Intelligence en analyse** en klik vervolgens op **Stream Analytics-taak**.</span><span class="sxs-lookup"><span data-stu-id="18c85-384">Select **Intelligence + Analytics** and then click **Stream Analytics job**.</span></span>
   
    ![Knop Nieuw](media/stream-analytics-build-an-iot-solution-using-stream-analytics/image21.png)
2. <span data-ttu-id="18c85-386">Geef de taaknaam van een, het valideren van het abonnement is corrigeren en vervolgens een nieuwe resourcegroep maken in dezelfde regio bevinden als de Event hub-opslag (is standaard Zuid-centraal VS voor het script).</span><span class="sxs-lookup"><span data-stu-id="18c85-386">Provide a job name, validate the subscription is correct and then create a new Resource group in the same region as the Event hub storage (default is South Central US for the script).</span></span>
3. <span data-ttu-id="18c85-387">Klik op **vastmaken aan dashboard** en vervolgens **maken** aan de onderkant van de pagina.</span><span class="sxs-lookup"><span data-stu-id="18c85-387">Click **Pin to dashboard** and then **CREATE** at the bottom of the page.</span></span>
   
    ![Optie voor Stream Analytics-taak maken](media/stream-analytics-build-an-iot-solution-using-stream-analytics/image22.png)

## <a name="define-input-sources"></a><span data-ttu-id="18c85-389">Invoerbronnen definiëren</span><span class="sxs-lookup"><span data-stu-id="18c85-389">Define input sources</span></span>
1. <span data-ttu-id="18c85-390">De taak maakt en open de pagina van de taak.</span><span class="sxs-lookup"><span data-stu-id="18c85-390">The job will create and open the job page.</span></span> <span data-ttu-id="18c85-391">U kunt ook op de gemaakte analytics-taak op het portal-dashboard.</span><span class="sxs-lookup"><span data-stu-id="18c85-391">Or you can click the created analytics job on the portal dashboard.</span></span>

2. <span data-ttu-id="18c85-392">Klik op de **invoer** tabblad de brongegevens definiëren.</span><span class="sxs-lookup"><span data-stu-id="18c85-392">Click the **INPUTS** tab to define the source data.</span></span>
   
    ![Het tabblad invoer](media/stream-analytics-build-an-iot-solution-using-stream-analytics/image24.png)
3. <span data-ttu-id="18c85-394">Klik op **invoer toevoegen**.</span><span class="sxs-lookup"><span data-stu-id="18c85-394">Click **ADD AN INPUT**.</span></span>
   
    ![Het toevoegen van een invoer-optie](media/stream-analytics-build-an-iot-solution-using-stream-analytics/image25.png)
4. <span data-ttu-id="18c85-396">Voer **EntryStream** als **INVOERALIAS**.</span><span class="sxs-lookup"><span data-stu-id="18c85-396">Enter **EntryStream** as **INPUT ALIAS**.</span></span>
5. <span data-ttu-id="18c85-397">Brontype is **gegevensstroom**</span><span class="sxs-lookup"><span data-stu-id="18c85-397">Source Type is **Data Stream**</span></span>
6. <span data-ttu-id="18c85-398">Bron is **Event hub**.</span><span class="sxs-lookup"><span data-stu-id="18c85-398">Source is **Event hub**.</span></span>
7. <span data-ttu-id="18c85-399">**Service bus-naamruimte** moet u de TollData een in de vervolgkeuzelijst.</span><span class="sxs-lookup"><span data-stu-id="18c85-399">**Service bus namespace** should be the TollData one in the drop down.</span></span>
8. <span data-ttu-id="18c85-400">**Naam Event hub** moet worden ingesteld op **vermelding**.</span><span class="sxs-lookup"><span data-stu-id="18c85-400">**Event hub name** should be set to **entry**.</span></span>
9. <span data-ttu-id="18c85-401">**Naam Event hub beleid*is **RootManageSharedAccessKey** (de standaardwaarde).</span><span class="sxs-lookup"><span data-stu-id="18c85-401">**Event hub policy name*is **RootManageSharedAccessKey**  (the default value).</span></span>
10. <span data-ttu-id="18c85-402">Selecteer **JSON** voor **GEBEURTENIS SERIALISATIE-indeling** en **UTF8** voor **codering**.</span><span class="sxs-lookup"><span data-stu-id="18c85-402">Select **JSON** for **EVENT SERIALIZATION FORMAT** and **UTF8** for **ENCODING**.</span></span>
   
    <span data-ttu-id="18c85-403">Uw instellingen, ziet er als:</span><span class="sxs-lookup"><span data-stu-id="18c85-403">Your settings will look like:</span></span>
   
    ![Event hub-instellingen](media/stream-analytics-build-an-iot-solution-using-stream-analytics/image28.png)

10. <span data-ttu-id="18c85-405">Klik op **maken** onder aan de pagina om de wizard te voltooien.</span><span class="sxs-lookup"><span data-stu-id="18c85-405">Click **Create** at the bottom of the page to finish the wizard.</span></span>
    
    <span data-ttu-id="18c85-406">Nu u de stroom van de vermelding hebt gemaakt, wordt u dezelfde stappen voor het maken van de stroom afsluiten volgt.</span><span class="sxs-lookup"><span data-stu-id="18c85-406">Now that you've created the entry stream, you will follow the same steps to create the exit stream.</span></span> <span data-ttu-id="18c85-407">Moet u waarden op te geven als op de volgende schermafbeelding.</span><span class="sxs-lookup"><span data-stu-id="18c85-407">Be sure to enter values as on the following screenshot.</span></span>
    
    ![Instellingen voor de stroom afsluiten](media/stream-analytics-build-an-iot-solution-using-stream-analytics/image31.png)
    
    <span data-ttu-id="18c85-409">U hebt twee invoer streams gedefinieerd:</span><span class="sxs-lookup"><span data-stu-id="18c85-409">You have defined two input streams:</span></span>
    
    ![Invoer streams gedefinieerd in de Azure-portal](media/stream-analytics-build-an-iot-solution-using-stream-analytics/image32.png)
    
    <span data-ttu-id="18c85-411">Vervolgens voegt u gegevensinvoer verwijzing voor het blob-bestand dat de registratiegegevens auto bevat.</span><span class="sxs-lookup"><span data-stu-id="18c85-411">Next, you will add reference data input for the blob file that contains car registration data.</span></span>
11. <span data-ttu-id="18c85-412">Klik op **toevoegen**, en doe hetzelfde voor de invoer stroom maar selecteer **REFERENTIEGEGEVENS** in plaats van **gegevensstroom** en de **invoer Alias** is **registratie**.</span><span class="sxs-lookup"><span data-stu-id="18c85-412">Click **ADD**, and then follow the same process for the stream inputs but select **REFERENCE DATA** instead of **Data Stream** and the **Input Alias** is **Registration**.</span></span>

12. <span data-ttu-id="18c85-413">Storage-account die met begint **tolldata**.</span><span class="sxs-lookup"><span data-stu-id="18c85-413">storage account that starts with **tolldata**.</span></span> <span data-ttu-id="18c85-414">De containernaam moet **tolldata**, en de **pad PATROON** moet **registration.json**.</span><span class="sxs-lookup"><span data-stu-id="18c85-414">The container name should be **tolldata**, and the **PATH PATTERN** should be **registration.json**.</span></span> <span data-ttu-id="18c85-415">Deze naam is hoofdlettergevoelig en moet **kleine**.</span><span class="sxs-lookup"><span data-stu-id="18c85-415">This file name is case sensitive and should be **lowercase**.</span></span>
    
    ![Instellingen voor de opslag blog](media/stream-analytics-build-an-iot-solution-using-stream-analytics/image34.png)
13. <span data-ttu-id="18c85-417">Klik op **maken** om de wizard te voltooien.</span><span class="sxs-lookup"><span data-stu-id="18c85-417">Click **Create** to finish the wizard.</span></span>

<span data-ttu-id="18c85-418">Nu worden alle invoer gedefinieerd.</span><span class="sxs-lookup"><span data-stu-id="18c85-418">Now all inputs are defined.</span></span>

## <a name="define-output"></a><span data-ttu-id="18c85-419">Uitvoer definiëren</span><span class="sxs-lookup"><span data-stu-id="18c85-419">Define output</span></span>
1. <span data-ttu-id="18c85-420">Selecteer in het deelvenster Beheeroverzicht van Stream Analytics-taak **uitvoer**.</span><span class="sxs-lookup"><span data-stu-id="18c85-420">On the Stream Analytics job overview pane, select **OUTPUTS**.</span></span>
   
    ![De optie 'Uitvoer toevoegen' en het tabblad uitvoer](media/stream-analytics-build-an-iot-solution-using-stream-analytics/image37.png)
2. <span data-ttu-id="18c85-422">Klik op **Add**.</span><span class="sxs-lookup"><span data-stu-id="18c85-422">Click **Add**.</span></span>
3. <span data-ttu-id="18c85-423">Stel de **uitvoeraliassen** aan 'uitvoer' en vervolgens **Sink** naar **SQL-database**.</span><span class="sxs-lookup"><span data-stu-id="18c85-423">Set the **Output alias** to 'output' and then **Sink** to **SQL database**.</span></span>
3. <span data-ttu-id="18c85-424">Selecteer de naam van de server die is gebruikt in de sectie 'Verbinding naar Database vanuit Visual Studio' van het artikel.</span><span class="sxs-lookup"><span data-stu-id="18c85-424">Select the server name that was used in the “Connect to Database from Visual Studio” section of the article.</span></span> <span data-ttu-id="18c85-425">De databasenaam is **TollDataDB**.</span><span class="sxs-lookup"><span data-stu-id="18c85-425">The database name is **TollDataDB**.</span></span>
4. <span data-ttu-id="18c85-426">Voer **tolladmin** in de **gebruikersnaam** veld **123toll!**</span><span class="sxs-lookup"><span data-stu-id="18c85-426">Enter **tolladmin** in the **USERNAME** field, **123toll!**</span></span> <span data-ttu-id="18c85-427">in de **wachtwoord** veld en **TollDataRefJoin** in de **tabel** veld.</span><span class="sxs-lookup"><span data-stu-id="18c85-427">in the **PASSWORD** field, and **TollDataRefJoin** in the **TABLE** field.</span></span>
   
    ![SQL Database-instellingen](media/stream-analytics-build-an-iot-solution-using-stream-analytics/image38.png)
5. <span data-ttu-id="18c85-429">Klik op **Create**.</span><span class="sxs-lookup"><span data-stu-id="18c85-429">Click **Create**.</span></span>

## <a name="azure-stream-analytics-query"></a><span data-ttu-id="18c85-430">Azure Stream analytics query</span><span class="sxs-lookup"><span data-stu-id="18c85-430">Azure Stream analytics query</span></span>
<span data-ttu-id="18c85-431">De **QUERY** tabblad bevat een SQL-query waarmee de inkomende gegevens worden omgezet.</span><span class="sxs-lookup"><span data-stu-id="18c85-431">The **QUERY** tab contains a SQL query that transforms the incoming data.</span></span>

![Een query die wordt toegevoegd aan het tabblad Query](media/stream-analytics-build-an-iot-solution-using-stream-analytics/image39.png)

<span data-ttu-id="18c85-433">Deze zelfstudie probeert te beantwoorden verschillende bedrijfsvragen die gerelateerd zijn aan tolbruggen gegevens en constructies Stream Analytics query's die kunnen worden gebruikt in Azure Stream Analytics een relevant antwoord te geven.</span><span class="sxs-lookup"><span data-stu-id="18c85-433">This tutorial attempts to answer several business questions that are related to toll data and constructs Stream Analytics queries that can be used in Azure Stream Analytics to provide a relevant answer.</span></span>

<span data-ttu-id="18c85-434">Voordat u uw eerste Stream Analytics-taak kijken dan enkele scenario's en de syntaxis van de query.</span><span class="sxs-lookup"><span data-stu-id="18c85-434">Before you start your first Stream Analytics job, let’s explore a few scenarios and the query syntax.</span></span>

## <a name="introduction-to-azure-stream-analytics-query-language"></a><span data-ttu-id="18c85-435">Inleiding tot Azure Stream Analytics query language</span><span class="sxs-lookup"><span data-stu-id="18c85-435">Introduction to Azure Stream Analytics query language</span></span>
- - -
<span data-ttu-id="18c85-436">Stel dat u moet het aantal voertuigen die een tolstation stand invoeren.</span><span class="sxs-lookup"><span data-stu-id="18c85-436">Let’s say that you need to count the number of vehicles that enter a toll booth.</span></span> <span data-ttu-id="18c85-437">Omdat dit een continue stroom van gebeurtenissen, hebt u voor het definiëren van een 'tijdsperiode."</span><span class="sxs-lookup"><span data-stu-id="18c85-437">Because this is a continuous stream of events, you have to define a “period of time.”</span></span> <span data-ttu-id="18c85-438">Laten we wijzigen de vraag om 'hoeveel voertuigen Geef een tolstation stand elke drie minuten?'.</span><span class="sxs-lookup"><span data-stu-id="18c85-438">Let's modify the question to be “How many vehicles enter a toll booth every three minutes?”.</span></span> <span data-ttu-id="18c85-439">Dit wordt vaak aangeduid als het aantal daling.</span><span class="sxs-lookup"><span data-stu-id="18c85-439">This is commonly referred to as the tumbling count.</span></span>

<span data-ttu-id="18c85-440">Bekijk de Azure Stream Analytics query waarmee deze vraag worden beantwoord:</span><span class="sxs-lookup"><span data-stu-id="18c85-440">Let’s look at the Azure Stream Analytics query that answers this question:</span></span>

    SELECT TollId, System.Timestamp AS WindowEnd, COUNT(*) AS Count
    FROM EntryStream TIMESTAMP BY EntryTime
    GROUP BY TUMBLINGWINDOW(minute, 3), TollId

<span data-ttu-id="18c85-441">Zoals u ziet, Azure Stream Analytics maakt gebruik van een querytaal die lijkt op SQL en enkele uitbreidingen om op te geven tijd gerelateerde aspecten van de query toegevoegd.</span><span class="sxs-lookup"><span data-stu-id="18c85-441">As you can see, Azure Stream Analytics uses a query language that's like SQL and adds a few extensions to specify time-related aspects of the query.</span></span>

<span data-ttu-id="18c85-442">Lees voor meer informatie over [Time Management](https://msdn.microsoft.com/library/azure/mt582045.aspx) en [Windowing](https://msdn.microsoft.com/library/azure/dn835019.aspx) constructies die worden gebruikt in de query van MSDN.</span><span class="sxs-lookup"><span data-stu-id="18c85-442">For more details, read about [Time Management](https://msdn.microsoft.com/library/azure/mt582045.aspx) and [Windowing](https://msdn.microsoft.com/library/azure/dn835019.aspx) constructs used in the query from MSDN.</span></span>

## <a name="testing-azure-stream-analytics-queries"></a><span data-ttu-id="18c85-443">Azure Stream Analytics query's testen</span><span class="sxs-lookup"><span data-stu-id="18c85-443">Testing Azure Stream Analytics queries</span></span>
<span data-ttu-id="18c85-444">Nu u uw eerste Azure Stream Analytics query hebt geschreven, is het tijd om deze te testen met behulp van bestanden met voorbeeldgegevens zich in de map TollApp in het volgende pad:</span><span class="sxs-lookup"><span data-stu-id="18c85-444">Now that you have written your first Azure Stream Analytics query, it is time to test it by using sample data files located in your TollApp folder in the following path:</span></span>

<span data-ttu-id="18c85-445">**.. \\TollApp\\TollApp\\gegevens**</span><span class="sxs-lookup"><span data-stu-id="18c85-445">**..\\TollApp\\TollApp\\Data**</span></span>

<span data-ttu-id="18c85-446">Deze map bevat de volgende bestanden:</span><span class="sxs-lookup"><span data-stu-id="18c85-446">This folder contains the following files:</span></span>

* <span data-ttu-id="18c85-447">Entry.JSON</span><span class="sxs-lookup"><span data-stu-id="18c85-447">Entry.json</span></span>
* <span data-ttu-id="18c85-448">Exit.JSON</span><span class="sxs-lookup"><span data-stu-id="18c85-448">Exit.json</span></span>
* <span data-ttu-id="18c85-449">Registration.JSON</span><span class="sxs-lookup"><span data-stu-id="18c85-449">Registration.json</span></span>

## <a name="question-1-number-of-vehicles-entering-a-toll-booth"></a><span data-ttu-id="18c85-450">Vraag 1: Het aantal voertuigen een tolstation stand</span><span class="sxs-lookup"><span data-stu-id="18c85-450">Question 1: Number of vehicles entering a toll booth</span></span>
1. <span data-ttu-id="18c85-451">Open de Azure-portal en gaat u naar uw gemaakte Azure Stream Analytics-taak.</span><span class="sxs-lookup"><span data-stu-id="18c85-451">Open the Azure portal and go to your created Azure Stream Analytics job.</span></span> <span data-ttu-id="18c85-452">Klik op de **QUERY** tabblad en plak de query uit de vorige sectie.</span><span class="sxs-lookup"><span data-stu-id="18c85-452">Click the **QUERY** tab and paste query from the previous section.</span></span>

2. <span data-ttu-id="18c85-453">Voor het valideren van deze query op de voorbeeldgegevens, de gegevens uploaden naar de invoer EntryStream door te klikken op de... symbool en het selecteren van **voorbeeldgegevens uit bestand uploaden**.</span><span class="sxs-lookup"><span data-stu-id="18c85-453">To validate this query against sample data, upload the data into the EntryStream input by clicking the ... symbol and selecting **Upload sample data from file**.</span></span>

    ![Schermopname van het bestand Entry.json](media/stream-analytics-build-an-iot-solution-using-stream-analytics/image41.png)
3. <span data-ttu-id="18c85-455">Selecteer het bestand (Entry.json) op uw lokale computer in het deelvenster die wordt weergegeven en klik op **OK**.</span><span class="sxs-lookup"><span data-stu-id="18c85-455">In the pane that appears select the file (Entry.json) on your local machine and click **OK**.</span></span> <span data-ttu-id="18c85-456">De **Test** pictogram wordt nu verlichten en worden geklikt.</span><span class="sxs-lookup"><span data-stu-id="18c85-456">The **Test** icon will now illuminate and be clickable.</span></span>
   
    ![Schermopname van het bestand Entry.json](media/stream-analytics-build-an-iot-solution-using-stream-analytics/image42.png)
3. <span data-ttu-id="18c85-458">Valideren dat de uitvoer van de query is zoals verwacht:</span><span class="sxs-lookup"><span data-stu-id="18c85-458">Validate that the output of the query is as expected:</span></span>
   
    ![Resultaten van de test](media/stream-analytics-build-an-iot-solution-using-stream-analytics/image43.png)

## <a name="question-2-report-total-time-for-each-car-to-pass-through-the-toll-booth"></a><span data-ttu-id="18c85-460">Vraag 2: Rapport totale tijd voor elke auto doorgeven aan de stand tolstation</span><span class="sxs-lookup"><span data-stu-id="18c85-460">Question 2: Report total time for each car to pass through the toll booth</span></span>
<span data-ttu-id="18c85-461">De gemiddelde tijd die zijn voor een auto vereist doorgeven aan de tolstation helpt bij het beoordelen van de efficiëntie van het proces en de gebruikerservaring.</span><span class="sxs-lookup"><span data-stu-id="18c85-461">The average time that's required for a car to pass through the toll helps to assess the efficiency of the process and the customer experience.</span></span>

<span data-ttu-id="18c85-462">Ga voor de totale tijd die u wilt deelnemen aan de stroom ExitTime EntryTime stream.</span><span class="sxs-lookup"><span data-stu-id="18c85-462">To find the total time, you need to join the EntryTime stream with the ExitTime stream.</span></span> <span data-ttu-id="18c85-463">U kunt de stromen voor TollId en LicencePlate kolommen wordt toegevoegd.</span><span class="sxs-lookup"><span data-stu-id="18c85-463">You will join the streams on TollId and LicencePlate columns.</span></span> <span data-ttu-id="18c85-464">De **JOIN** operator moet u tijdelijke eenheidsprofiel die het toegestane tijdverschil de gekoppelde gebeurtenissen beschrijft opgeven.</span><span class="sxs-lookup"><span data-stu-id="18c85-464">The **JOIN** operator requires you to specify temporal leeway that describes the acceptable time difference between the joined events.</span></span> <span data-ttu-id="18c85-465">U gaat gebruiken **DATEDIFF** functie opgeven die gebeurtenissen langer zijn dan 15 minuten van elkaar moet.</span><span class="sxs-lookup"><span data-stu-id="18c85-465">You will use **DATEDIFF** function to specify that events should be no more than 15 minutes from each other.</span></span> <span data-ttu-id="18c85-466">U wordt ook van toepassing de **DATEDIFF** functie om af te sluiten en tijden van vermelding voor het berekenen van de werkelijke tijd waarop een auto doorbrengt in het station tolstation.</span><span class="sxs-lookup"><span data-stu-id="18c85-466">You will also apply the **DATEDIFF** function to exit and entry times to compute the actual time that a car spends in the toll station.</span></span> <span data-ttu-id="18c85-467">Noteer het verschil van het gebruik van **DATEDIFF** wanneer het wordt gebruikt in een **Selecteer** instructie in plaats van een **JOIN** voorwaarde.</span><span class="sxs-lookup"><span data-stu-id="18c85-467">Note the difference of the use of **DATEDIFF** when it's used in a **SELECT** statement rather than a **JOIN** condition.</span></span>

    SELECT EntryStream.TollId, EntryStream.EntryTime, ExitStream.ExitTime, EntryStream.LicensePlate, DATEDIFF (minute , EntryStream.EntryTime, ExitStream.ExitTime) AS DurationInMinutes
    FROM EntryStream TIMESTAMP BY EntryTime
    JOIN ExitStream TIMESTAMP BY ExitTime
    ON (EntryStream.TollId= ExitStream.TollId AND EntryStream.LicensePlate = ExitStream.LicensePlate)
    AND DATEDIFF (minute, EntryStream, ExitStream ) BETWEEN 0 AND 15

1. <span data-ttu-id="18c85-468">Als u wilt deze query testen, kunt u de query bijwerken op de **QUERY** voor de taak.</span><span class="sxs-lookup"><span data-stu-id="18c85-468">To test this query, update the query on the **QUERY** for the job.</span></span> <span data-ttu-id="18c85-469">Toevoegen van het testbestand voor **ExitStream** net als bij **EntryStream** hierboven is opgegeven.</span><span class="sxs-lookup"><span data-stu-id="18c85-469">Add the test file for **ExitStream** just like **EntryStream** was entered above.</span></span>
   
2. <span data-ttu-id="18c85-470">Klik op **Test**.</span><span class="sxs-lookup"><span data-stu-id="18c85-470">Click **Test**.</span></span>

3. <span data-ttu-id="18c85-471">Schakel het selectievakje in voor het testen van de query en de uitvoer weergeven:</span><span class="sxs-lookup"><span data-stu-id="18c85-471">Select the check box to test the query and view the output:</span></span>
   
    ![Uitvoer van de test](media/stream-analytics-build-an-iot-solution-using-stream-analytics/image45.png)

## <a name="question-3-report-all-commercial-vehicles-with-expired-registration"></a><span data-ttu-id="18c85-473">Vraag 3: Alle commerciële voertuigen met verlopen registratie rapporteren</span><span class="sxs-lookup"><span data-stu-id="18c85-473">Question 3: Report all commercial vehicles with expired registration</span></span>
<span data-ttu-id="18c85-474">Azure Stream Analytics kunt statische momentopnamen van gegevens samen te voegen met de tijdelijke gegevensstromen.</span><span class="sxs-lookup"><span data-stu-id="18c85-474">Azure Stream Analytics can use static snapshots of data to join with temporal data streams.</span></span> <span data-ttu-id="18c85-475">Gebruik de volgende voorbeeldquery vraag ter illustratie van deze mogelijkheid.</span><span class="sxs-lookup"><span data-stu-id="18c85-475">To demonstrate this capability, use the following sample question.</span></span>

<span data-ttu-id="18c85-476">Als een commerciële-medium is geregistreerd bij het bedrijf tolstation, kan deze de tolstation stand passeren zonder te zijn gestopt voor inspectie.</span><span class="sxs-lookup"><span data-stu-id="18c85-476">If a commercial vehicle is registered with the toll company, it can pass through the toll booth without being stopped for inspection.</span></span> <span data-ttu-id="18c85-477">U gebruikt opzoektabel commerciële Vehicle registratie voor het identificeren van alle commerciële voertuigen die registraties zijn verlopen.</span><span class="sxs-lookup"><span data-stu-id="18c85-477">You will use Commercial Vehicle Registration lookup table to identify all commercial vehicles that have expired registrations.</span></span>

```
SELECT EntryStream.EntryTime, EntryStream.LicensePlate, EntryStream.TollId, Registration.RegistrationId
FROM EntryStream TIMESTAMP BY EntryTime
JOIN Registration
ON EntryStream.LicensePlate = Registration.LicensePlate
WHERE Registration.Expired = '1'
```

<span data-ttu-id="18c85-478">Als u wilt een query testen met behulp van referentiegegevens, moet u definiëren invoerbron voor de verwijzingsgegevens, die u al hebt gedaan.</span><span class="sxs-lookup"><span data-stu-id="18c85-478">To test a query by using reference data, you need to define an input source for the reference data, which you have done already.</span></span>

<span data-ttu-id="18c85-479">Als u wilt deze query testen, plakt u de query in de **QUERY** tabblad **testen**, en geeft u de twee invoerbronnen en de registratie van voorbeeldgegevens en klikt u op **testen**.</span><span class="sxs-lookup"><span data-stu-id="18c85-479">To test this query, paste the query into the **QUERY** tab, click **Test**, and specify the two input sources and the registration sample data and click **Test**.</span></span>  
   
![Uitvoer van de test](media/stream-analytics-build-an-iot-solution-using-stream-analytics/image46.png)

## <a name="start-the-stream-analytics-job"></a><span data-ttu-id="18c85-481">De Stream Analytics-taak starten</span><span class="sxs-lookup"><span data-stu-id="18c85-481">Start the Stream Analytics job</span></span>
<span data-ttu-id="18c85-482">Nu is het tijd om de configuratie te voltooien en start de taak.</span><span class="sxs-lookup"><span data-stu-id="18c85-482">Now it's time to finish the configuration and start the job.</span></span> <span data-ttu-id="18c85-483">Sla de query van vraag 3, waarmee die wordt geproduceerd uitvoer die overeenkomt met het schema van de **TollDataRefJoin** uitvoertabel.</span><span class="sxs-lookup"><span data-stu-id="18c85-483">Save the query from Question 3, which will produce output that matches the schema of the **TollDataRefJoin** output table.</span></span>

<span data-ttu-id="18c85-484">Ga naar de taak **DASHBOARD**, en klik op **START**.</span><span class="sxs-lookup"><span data-stu-id="18c85-484">Go to the job **DASHBOARD**, and click **START**.</span></span>

![Schermafbeelding van de knop Start in het dashboard van de taak](media/stream-analytics-build-an-iot-solution-using-stream-analytics/image48.png)

<span data-ttu-id="18c85-486">Wijzig in het dialoogvenster de **START uitvoer** tijd **aangepaste tijd**.</span><span class="sxs-lookup"><span data-stu-id="18c85-486">In the dialog box that opens, change the **START OUTPUT** time to **CUSTOM TIME**.</span></span> <span data-ttu-id="18c85-487">Wijzig het uur in één uur vóór de huidige tijd.</span><span class="sxs-lookup"><span data-stu-id="18c85-487">Change the hour to one hour before the current time.</span></span> <span data-ttu-id="18c85-488">Deze wijziging zorgt ervoor dat alle gebeurtenissen van de event hub worden verwerkt sinds het begin van de gebeurtenissen aan het begin van de zelfstudie te genereren.</span><span class="sxs-lookup"><span data-stu-id="18c85-488">This change ensures that all events from the event hub are processed since you started to generate the events at the beginning of the tutorial.</span></span> <span data-ttu-id="18c85-489">Klik nu op de **Start** knop om de taak te starten.</span><span class="sxs-lookup"><span data-stu-id="18c85-489">Now click the **Start** button to start the job.</span></span>

![Selectie van aangepaste tijd](media/stream-analytics-build-an-iot-solution-using-stream-analytics/image49.png)

<span data-ttu-id="18c85-491">Start de taak kan enkele minuten duren.</span><span class="sxs-lookup"><span data-stu-id="18c85-491">Starting the job can take a few minutes.</span></span> <span data-ttu-id="18c85-492">U kunt de status weergegeven op de pagina op het hoogste niveau voor Stream Analytics.</span><span class="sxs-lookup"><span data-stu-id="18c85-492">You can see the status on the top-level page for Stream Analytics.</span></span>

![Schermafbeelding van de status van de taak](media/stream-analytics-build-an-iot-solution-using-stream-analytics/image50.png)

## <a name="check-results-in-visual-studio"></a><span data-ttu-id="18c85-494">Controleer de resultaten in Visual Studio</span><span class="sxs-lookup"><span data-stu-id="18c85-494">Check results in Visual Studio</span></span>
1. <span data-ttu-id="18c85-495">Open Visual Studio Server Explorer en met de rechtermuisknop op de **TollDataRefJoin** tabel.</span><span class="sxs-lookup"><span data-stu-id="18c85-495">Open Visual Studio Server Explorer, and right-click the **TollDataRefJoin** table.</span></span>
2. <span data-ttu-id="18c85-496">Klik op **tabelgegevens weergeven** om te zien van de uitvoer van de taak.</span><span class="sxs-lookup"><span data-stu-id="18c85-496">Click **Show Table Data** to see the output of your job.</span></span>
   
    ![Selectie van 'Tabelgegevens weergeven' in Server Explorer](media/stream-analytics-build-an-iot-solution-using-stream-analytics/image51.jpg)

## <a name="scale-out-azure-stream-analytics-jobs"></a><span data-ttu-id="18c85-498">Azure Stream Analytics uitbreiden met taken</span><span class="sxs-lookup"><span data-stu-id="18c85-498">Scale out Azure Stream Analytics jobs</span></span>
<span data-ttu-id="18c85-499">Azure Stream Analytics is ontworpen voor elastisch schalen zodat deze kan grote hoeveelheden gegevens verwerken.</span><span class="sxs-lookup"><span data-stu-id="18c85-499">Azure Stream Analytics is designed to elastically scale so that it can handle a lot of data.</span></span> <span data-ttu-id="18c85-500">De Azure Stream Analytics query kunt gebruiken een **PARTITION BY** component zien of het systeem in deze stap wordt uitgebreid. **PartitionId** is een speciale kolom die het systeem wordt toegevoegd aan de partitie-ID van de invoer (event hub).</span><span class="sxs-lookup"><span data-stu-id="18c85-500">The Azure Stream Analytics query can use a **PARTITION BY** clause to tell the system that this step will scale out. **PartitionId** is a special column that the system adds to match the partition ID of the input (event hub).</span></span>

    SELECT TollId, System.Timestamp AS WindowEnd, COUNT(*)AS Count
    FROM EntryStream TIMESTAMP BY EntryTime PARTITION BY PartitionId
    GROUP BY TUMBLINGWINDOW(minute,3), TollId, PartitionId

1. <span data-ttu-id="18c85-501">Stoppen van de huidige taak, het bijwerken van de query in de **QUERY** tabblad en open de **instellingen** stemmen in het dashboard van de taak.</span><span class="sxs-lookup"><span data-stu-id="18c85-501">Stop the current job, update the query in the **QUERY** tab, and open the **Settings** gear in the job dashboard.</span></span> <span data-ttu-id="18c85-502">Klik op **Scale**.</span><span class="sxs-lookup"><span data-stu-id="18c85-502">Click **Scale**.</span></span>
   
    <span data-ttu-id="18c85-503">**STREAMING-eenheden** definiëren van de hoeveelheid rekenkracht die de taak kan ontvangen.</span><span class="sxs-lookup"><span data-stu-id="18c85-503">**STREAMING UNITS** define the amount of compute power that the job can receive.</span></span>
2. <span data-ttu-id="18c85-504">Wijzig de vervolgkeuzelijst omlaag van 1 6.</span><span class="sxs-lookup"><span data-stu-id="18c85-504">Change the drop down from 1 from 6.</span></span>
   
    ![Schermopname van het selecteren van 6 streaming-eenheden](media/stream-analytics-build-an-iot-solution-using-stream-analytics/image52.png)
3. <span data-ttu-id="18c85-506">Ga naar de **uitvoer** tabblad en de naam van de SQL-tabel om te wijzigen **TollDataTumblingCountPartitioned**.</span><span class="sxs-lookup"><span data-stu-id="18c85-506">Go to the **OUTPUTS** tab and change the name of the SQL table to **TollDataTumblingCountPartitioned**.</span></span>

<span data-ttu-id="18c85-507">Als u de taak start nu kunt Azure Stream Analytics werk verdelen over meer computerresources en een betere doorvoer behalen.</span><span class="sxs-lookup"><span data-stu-id="18c85-507">If you start the job now, Azure Stream Analytics can distribute work across more compute resources and achieve better throughput.</span></span> <span data-ttu-id="18c85-508">Houd er rekening mee dat de toepassing TollApp ook gebeurtenissen gepartitioneerd door TollId verzendt.</span><span class="sxs-lookup"><span data-stu-id="18c85-508">Please note that the TollApp application is also sending events partitioned by TollId.</span></span>

## <a name="monitor"></a><span data-ttu-id="18c85-509">Bewaken</span><span class="sxs-lookup"><span data-stu-id="18c85-509">Monitor</span></span>
<span data-ttu-id="18c85-510">De **MONITOR** gebied statistieken over actieve taak bevat.</span><span class="sxs-lookup"><span data-stu-id="18c85-510">The **MONITOR** area contains statistics about the running job.</span></span> <span data-ttu-id="18c85-511">Eerste keer configuratie nodig is voor het gebruik van de opslag-account in dezelfde regio (tolstation naam als de rest van dit document).</span><span class="sxs-lookup"><span data-stu-id="18c85-511">First time configuration is needed to use the storage account in the same region (name toll like the rest of this document).</span></span>   

![Schermopname van monitor](media/stream-analytics-build-an-iot-solution-using-stream-analytics/monitoring.png)

<span data-ttu-id="18c85-513">U hebt toegang tot **activiteitenlogboeken** vanuit het dashboard taak **instellingen** ook gebied.</span><span class="sxs-lookup"><span data-stu-id="18c85-513">You can access **Activity Logs** from the job dashboard **Settings** area as well.</span></span>


## <a name="conclusion"></a><span data-ttu-id="18c85-514">Conclusie</span><span class="sxs-lookup"><span data-stu-id="18c85-514">Conclusion</span></span>
<span data-ttu-id="18c85-515">Deze zelfstudie is geïntroduceerd met de Azure Stream Analytics-service.</span><span class="sxs-lookup"><span data-stu-id="18c85-515">This tutorial introduced you to the Azure Stream Analytics service.</span></span> <span data-ttu-id="18c85-516">Het configureren van de invoer en uitvoer voor de Stream Analytics-taak gedemonstreerd.</span><span class="sxs-lookup"><span data-stu-id="18c85-516">It demonstrated how to configure inputs and outputs for the Stream Analytics job.</span></span> <span data-ttu-id="18c85-517">Met behulp van het scenario niet gratis gegevens, de zelfstudie voorkomende problemen die optreden in de ruimte van de gegevens in beweging en hoe ze kunnen worden opgelost met eenvoudige SQL-achtige query's in Azure Stream Analytics uitgelegd.</span><span class="sxs-lookup"><span data-stu-id="18c85-517">Using the Toll Data scenario, the tutorial explained common types of problems that arise in the space of data in motion and how they can be solved with simple SQL-like queries in Azure Stream Analytics.</span></span> <span data-ttu-id="18c85-518">De zelfstudie beschreven SQL extensie constructs voor het werken met tijdelijke gegevens.</span><span class="sxs-lookup"><span data-stu-id="18c85-518">The tutorial described SQL extension constructs for working with temporal data.</span></span> <span data-ttu-id="18c85-519">Deze hebt u geleerd hoe gegevensstromen kunt koppelen, hoe de gegevensstroom met statische referentiegegevens sitmuleren en hoe moet worden uitgebreid met een query naar een hogere doorvoer te bereiken.</span><span class="sxs-lookup"><span data-stu-id="18c85-519">It showed how to join data streams, how to enrich the data stream with static reference data, and how to scale out a query to achieve higher throughput.</span></span>

<span data-ttu-id="18c85-520">Hoewel deze zelfstudie een goede inleiding biedt, is het niet voltooid door middel van.</span><span class="sxs-lookup"><span data-stu-id="18c85-520">Although this tutorial provides a good introduction, it is not complete by any means.</span></span> <span data-ttu-id="18c85-521">U vindt meer querypatronen met de taal SAQL op [voorbeelden voor het algemene gebruikspatronen van de Stream Analytics Query](stream-analytics-stream-analytics-query-patterns.md).</span><span class="sxs-lookup"><span data-stu-id="18c85-521">You can find more query patterns using the SAQL language at [Query examples for common Stream Analytics usage patterns](stream-analytics-stream-analytics-query-patterns.md).</span></span>
<span data-ttu-id="18c85-522">Raadpleeg de [onlinedocumentatie](https://azure.microsoft.com/documentation/services/stream-analytics/) voor meer informatie over Azure Stream Analytics.</span><span class="sxs-lookup"><span data-stu-id="18c85-522">Refer to the [online documentation](https://azure.microsoft.com/documentation/services/stream-analytics/) to learn more about Azure Stream Analytics.</span></span>

## <a name="clean-up-your-azure-account"></a><span data-ttu-id="18c85-523">Opschonen van uw Azure-account</span><span class="sxs-lookup"><span data-stu-id="18c85-523">Clean up your Azure account</span></span>
1. <span data-ttu-id="18c85-524">Stop de Stream Analytics-taak in de Azure portal.</span><span class="sxs-lookup"><span data-stu-id="18c85-524">Stop the Stream Analytics job in the Azure portal.</span></span>
   
    <span data-ttu-id="18c85-525">Het script Setup.ps1 maakt twee event hubs en een SQL-database.</span><span class="sxs-lookup"><span data-stu-id="18c85-525">The Setup.ps1 script creates two event hubs and a SQL database.</span></span> <span data-ttu-id="18c85-526">De volgende instructies helpen u aan het einde van de zelfstudie opschonen van resources.</span><span class="sxs-lookup"><span data-stu-id="18c85-526">The following instructions help you clean up resources at the end of the tutorial.</span></span>
2. <span data-ttu-id="18c85-527">Typ in een PowerShell-venster **.\\ CleanUp.ps1** start het script waarmee bronnen die worden gebruikt in de zelfstudie wordt verwijderd.</span><span class="sxs-lookup"><span data-stu-id="18c85-527">In a PowerShell window, type **.\\Cleanup.ps1** to start the script that deletes resources used in the tutorial.</span></span>
   
   > [!NOTE]
   > <span data-ttu-id="18c85-528">Resources worden aangeduid met de naam.</span><span class="sxs-lookup"><span data-stu-id="18c85-528">Resources are identified by the name.</span></span> <span data-ttu-id="18c85-529">Zorg ervoor dat u elk item zorgvuldig controleren vóór de verwijdering te bevestigen.</span><span class="sxs-lookup"><span data-stu-id="18c85-529">Make sure you carefully review each item before confirming removal.</span></span>
   > 
   > 


