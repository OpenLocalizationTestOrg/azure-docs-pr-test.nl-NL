---
title: JSON-uitvoer voor Stream Analytics | Microsoft Docs
description: Meer informatie over hoe Stream Analytics doel Azure Cosmos DB voor de JSON-uitvoer, voor het archiveren van gegevens en lage latentie query's op niet-gestructureerde JSON-gegevens.
keywords: JSON-uitvoer
documentationcenter: 
services: stream-analytics,documentdb
author: samacha
manager: jhubbard
editor: cgronlun
ms.assetid: 5d2a61a6-0dbf-4f1b-80af-60a80eb25dd1
ms.service: stream-analytics
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: data-services
ms.date: 03/28/2017
ms.author: samacha
ms.openlocfilehash: cc80b0080c806541362a1ef2d71b95862bd51ca2
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 08/29/2017
---
# <a name="target-azure-cosmos-db-for-json-output-from-stream-analytics"></a><span data-ttu-id="abe08-104">Azure Cosmos Doeldatabase voor JSON-uitvoer van de Stream Analytics</span><span class="sxs-lookup"><span data-stu-id="abe08-104">Target Azure Cosmos DB for JSON output from Stream Analytics</span></span>
<span data-ttu-id="abe08-105">Stream Analytics kunt richten [Azure Cosmos DB](https://azure.microsoft.com/services/documentdb/) inschakelen voor JSON-uitvoer, lage latentie en archiveren gegevensquery op niet-gestructureerde JSON-gegevens.</span><span class="sxs-lookup"><span data-stu-id="abe08-105">Stream Analytics can target [Azure Cosmos DB](https://azure.microsoft.com/services/documentdb/) for JSON output, enabling data archiving and low-latency queries on unstructured JSON data.</span></span> <span data-ttu-id="abe08-106">Dit document bevat informatie over enkele aanbevolen procedures voor het implementeren van deze configuratie.</span><span class="sxs-lookup"><span data-stu-id="abe08-106">This document covers some best practices for implementing this configuration.</span></span>

<span data-ttu-id="abe08-107">Voor gebruikers die niet bekend met Cosmos DB bent, Bekijk [leertraject voor Azure Cosmos DB](https://azure.microsoft.com/documentation/learning-paths/documentdb/) aan de slag.</span><span class="sxs-lookup"><span data-stu-id="abe08-107">For those who are unfamiliar with Cosmos DB, take a look at [Azure Cosmos DB’s learning path](https://azure.microsoft.com/documentation/learning-paths/documentdb/) to get started.</span></span> 

<span data-ttu-id="abe08-108">Opmerking: Mongo DB API gebaseerd Cosmos DB verzamelingen wordt momenteel niet ondersteund.</span><span class="sxs-lookup"><span data-stu-id="abe08-108">Note: Mongo DB API based Cosmos DB collections is currently not supported.</span></span> 

## <a name="basics-of-cosmos-db-as-an-output-target"></a><span data-ttu-id="abe08-109">Basisprincipes van Cosmos-database als een output-doel</span><span class="sxs-lookup"><span data-stu-id="abe08-109">Basics of Cosmos DB as an output target</span></span>
<span data-ttu-id="abe08-110">De Azure DB die Cosmos-uitvoer in Stream Analytics kunt schrijven uw stream resultaten als JSON-uitvoer in uw verzameling(en) Cosmos DB verwerken.</span><span class="sxs-lookup"><span data-stu-id="abe08-110">The Azure Cosmos DB output in Stream Analytics enables writing your stream processing results as JSON output into your Cosmos DB collection(s).</span></span> <span data-ttu-id="abe08-111">Stream Analytics maakt geen verzamelingen in uw database in plaats daarvan moeten ze tevoren maken.</span><span class="sxs-lookup"><span data-stu-id="abe08-111">Stream Analytics does not create collections in your database, instead requiring you to create them upfront.</span></span> <span data-ttu-id="abe08-112">Dit is zodat de facturering kosten van de Cosmos-DB verzamelingen transparant voor u zijn, en zodat u kunt afstemmen prestatie, consistentie en capaciteit van uw verzamelingen direct met de [Cosmos DB-API's](https://msdn.microsoft.com/library/azure/dn781481.aspx).</span><span class="sxs-lookup"><span data-stu-id="abe08-112">This is so that the billing costs of Cosmos DB collections are transparent to you, and so that you can tune the performance, consistency and capacity of your collections directly using the [Cosmos DB APIs](https://msdn.microsoft.com/library/azure/dn781481.aspx).</span></span> <span data-ttu-id="abe08-113">U kunt het beste een Cosmos-DB-Database per streaming-taak logische scheiding aanbrengen tussen uw verzamelingen voor streaming-taak gebruikt.</span><span class="sxs-lookup"><span data-stu-id="abe08-113">We recommend using one Cosmos DB Database per streaming job to logically separate your collections for a streaming job.</span></span>

<span data-ttu-id="abe08-114">Sommige van de opties voor het verzamelen van Cosmos DB worden hieronder beschreven.</span><span class="sxs-lookup"><span data-stu-id="abe08-114">Some of the Cosmos DB collection options are detailed below.</span></span>

## <a name="tune-consistency-availability-and-latency"></a><span data-ttu-id="abe08-115">Consistentie, beschikbaarheid en latentie afstemmen</span><span class="sxs-lookup"><span data-stu-id="abe08-115">Tune consistency, availability, and latency</span></span>
<span data-ttu-id="abe08-116">Om te voldoen aan uw toepassing, kunt Cosmos DB u fijnmazig afstemmen van de database en verzamelingen en afweging tussen de consistentie, beschikbaarheid en latentie.</span><span class="sxs-lookup"><span data-stu-id="abe08-116">To match your application requirements, Cosmos DB allows you to fine tune the database and collections and make trade-offs between consistency, availability and latency.</span></span> <span data-ttu-id="abe08-117">Afhankelijk van welke mate van lezen van consistentie op basis van de behoeften van uw scenario lezen en schrijven latentie, dat kunt u een consistentiecontrole-niveau voor het databaseaccount van uw.</span><span class="sxs-lookup"><span data-stu-id="abe08-117">Depending on what levels of read consistency your scenario needs against read and write latency, you can choose a consistency level on your database account.</span></span> <span data-ttu-id="abe08-118">Standaard kunnen Cosmos DB ook synchrone indexeren op elke bewerking CRUD aan uw verzameling.</span><span class="sxs-lookup"><span data-stu-id="abe08-118">Also by default, Cosmos DB enables synchronous indexing on each CRUD operation to your collection.</span></span> <span data-ttu-id="abe08-119">Dit is een andere nuttig optie om te bepalen van de prestaties schrijven leestijd in Cosmos-database.</span><span class="sxs-lookup"><span data-stu-id="abe08-119">This is another useful option to control the write/read performance in Cosmos DB.</span></span> <span data-ttu-id="abe08-120">Raadpleeg voor meer informatie over dit onderwerp de [wijzigen van uw database en query consistentieniveaus](../documentdb/documentdb-consistency-levels.md) artikel.</span><span class="sxs-lookup"><span data-stu-id="abe08-120">For further information on this topic, review the [change your database and query consistency levels](../documentdb/documentdb-consistency-levels.md) article.</span></span>

## <a name="upserts-from-stream-analytics"></a><span data-ttu-id="abe08-121">Upserts vanuit Stream Analytics</span><span class="sxs-lookup"><span data-stu-id="abe08-121">Upserts from Stream Analytics</span></span>
<span data-ttu-id="abe08-122">Stream Analytics-integratie met Cosmos DB kunt u invoegen of bijwerken van de records in uw Cosmos-DB-verzameling op basis van een bepaalde Document-ID-kolom.</span><span class="sxs-lookup"><span data-stu-id="abe08-122">Stream Analytics integration with Cosmos DB allows you to insert or update records in your Cosmos DB collection based on a given Document ID column.</span></span> <span data-ttu-id="abe08-123">Dit wordt ook wel een *Upsert*.</span><span class="sxs-lookup"><span data-stu-id="abe08-123">This is also referred to as an *Upsert*.</span></span>

<span data-ttu-id="abe08-124">Stream Analytics maakt gebruik van een optimistische Upsert benadering, waarbij de updates worden alleen uitgevoerd als invoegen is mislukt vanwege een conflict Document-ID.</span><span class="sxs-lookup"><span data-stu-id="abe08-124">Stream Analytics utilizes an optimistic Upsert approach, where updates are only done when insert fails due to a Document ID conflict.</span></span> <span data-ttu-id="abe08-125">Deze update wordt uitgevoerd door de Stream Analytics als een PATCH, zodat u kunt gedeeltelijke updates aan het document, dat wil zeggen het toevoegen van nieuwe eigenschappen of het vervangen van die een bestaande eigenschap incrementeel wordt uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="abe08-125">This update is performed by Stream Analytics as a PATCH, so it enables partial updates to the document, i.e. addition of new properties or replacing an existing property is performed incrementally.</span></span> <span data-ttu-id="abe08-126">Houd er rekening mee dat wijzigingen in de waarden van Matrixeigenschappen in uw JSON-document, resulteren in de gehele matrix ophalen overschreven, dat wil zeggen de matrix niet worden samengevoegd.</span><span class="sxs-lookup"><span data-stu-id="abe08-126">Note that changes in the values of array properties in your JSON document result in the entire array getting overwritten, i.e. the array is not merged.</span></span>

## <a name="data-partitioning-in-cosmos-db"></a><span data-ttu-id="abe08-127">Partitioneren van gegevens in Cosmos-DB</span><span class="sxs-lookup"><span data-stu-id="abe08-127">Data partitioning in Cosmos DB</span></span>
<span data-ttu-id="abe08-128">Cosmos DB [gepartitioneerde verzamelingen](../cosmos-db/partition-data.md) zijn de aanbevolen aanpak voor het partitioneren van uw gegevens.</span><span class="sxs-lookup"><span data-stu-id="abe08-128">Cosmos DB [partitioned collections](../cosmos-db/partition-data.md) are the recommended approach for partitioning your data.</span></span> 

<span data-ttu-id="abe08-129">Voor één Cosmos DB verzamelingen kunt Stream Analytics u nog steeds voor het partitioneren van uw gegevens op basis van de querypatronen en de prestatiebehoeften van uw toepassing.</span><span class="sxs-lookup"><span data-stu-id="abe08-129">For single Cosmos DB collections, Stream Analytics still allows you to partition your data based on both the query patterns and performance needs of your application.</span></span> <span data-ttu-id="abe08-130">Elke verzameling maximaal 10GB aan gegevens (maximaal) kan bevatten en er is momenteel geen manier voor een verzameling omhoog schalen (of overloop).</span><span class="sxs-lookup"><span data-stu-id="abe08-130">Each collection may contain up to 10GB of data (maximum) and currently there is no way to scale up (or overflow) a collection.</span></span> <span data-ttu-id="abe08-131">Voor het uitbreiden, Stream Analytics kunt u schrijven tot meerdere verzamelingen met het opgegeven voorvoegsel (Zie onderstaande details van gebruik).</span><span class="sxs-lookup"><span data-stu-id="abe08-131">For scaling out, Stream Analytics allows you to write to multiple collections with a given prefix (see usage details below).</span></span> <span data-ttu-id="abe08-132">Stream Analytics maakt gebruik van de consistente [Hash partitie Resolver](https://msdn.microsoft.com/library/azure/microsoft.azure.documents.partitioning.hashpartitionresolver.aspx) strategie op basis van de gebruiker opgegeven PartitionKey kolom voor het partitioneren van de uitvoer-records.</span><span class="sxs-lookup"><span data-stu-id="abe08-132">Stream Analytics uses the consistent [Hash Partition Resolver](https://msdn.microsoft.com/library/azure/microsoft.azure.documents.partitioning.hashpartitionresolver.aspx) strategy based on the user provided PartitionKey column to partition its output records.</span></span> <span data-ttu-id="abe08-133">Het aantal verzamelingen met het opgegeven voorvoegsel tijdens het starten van de streaming-taak wordt gebruikt als het aantal uitvoer partities, waarop de taak naar parallel schrijft (Cosmos DB verzamelingen = uitvoer partities).</span><span class="sxs-lookup"><span data-stu-id="abe08-133">The number of collections with the given prefix at the streaming job’s start time is used as the output partition count, to which the job writes to in parallel (Cosmos DB Collections = Output Partitions).</span></span> <span data-ttu-id="abe08-134">Voor één verzameling met de vertraagde indexering doen alleen ingevoegd, over 0,4 schrijfbewerkingen MB/s kan worden verwacht.</span><span class="sxs-lookup"><span data-stu-id="abe08-134">For a single collection with lazy indexing doing only inserts, about 0.4 MB/s write throughput can be expected.</span></span> <span data-ttu-id="abe08-135">Met behulp van meerdere verzamelingen, kunt u een hogere doorvoer en een verbeterde capaciteit.</span><span class="sxs-lookup"><span data-stu-id="abe08-135">Using multiple collections can allow you to achieve higher throughput and increased capacity.</span></span>

<span data-ttu-id="abe08-136">Als u van plan bent om te verhogen van het aantal partities in de toekomst, moet u mogelijk uw taak stoppen, partitioneren van de gegevens van uw bestaande verzamelingen in nieuwe verzamelingen en vervolgens de Stream Analytics-taak opnieuw te starten.</span><span class="sxs-lookup"><span data-stu-id="abe08-136">If you intend to increase the partition count in the future, you may need to stop your job, repartition the data from your existing collections into new collections and then restart the Stream Analytics job.</span></span> <span data-ttu-id="abe08-137">Meer informatie over het gebruik van PartitionResolver en opnieuw partitioneren samen met voorbeeldcode, worden opgenomen in een vervolgzelfstudie post.</span><span class="sxs-lookup"><span data-stu-id="abe08-137">More details on using PartitionResolver and re-partitioning along with sample code, will be included in a follow-up post.</span></span> <span data-ttu-id="abe08-138">Het artikel [partitionering en schalen in Cosmos DB](../documentdb/documentdb-partition-data.md) biedt ook informatie over dit.</span><span class="sxs-lookup"><span data-stu-id="abe08-138">The article [Partitioning and scaling in Cosmos DB](../documentdb/documentdb-partition-data.md) also provides details on this.</span></span>

## <a name="cosmos-db-settings-for-json-output"></a><span data-ttu-id="abe08-139">Cosmos DB-instellingen voor JSON-uitvoer</span><span class="sxs-lookup"><span data-stu-id="abe08-139">Cosmos DB settings for JSON output</span></span>
<span data-ttu-id="abe08-140">Maken van de Cosmos-DB als uitvoer in Stream Analytics genereert een prompt voor meer informatie, zoals hieronder wordt weergegeven.</span><span class="sxs-lookup"><span data-stu-id="abe08-140">Creating Cosmos DB as an output in Stream Analytics generates a prompt for information as seen below.</span></span> <span data-ttu-id="abe08-141">Deze sectie bevat een uitleg van de eigenschappen van definitie.</span><span class="sxs-lookup"><span data-stu-id="abe08-141">This section provides an explanation of the properties definition.</span></span>

<span data-ttu-id="abe08-142">Gepartitioneerde verzameling</span><span class="sxs-lookup"><span data-stu-id="abe08-142">Partitioned Collection</span></span> | <span data-ttu-id="abe08-143">Verzamelingen met meerdere 'Één partitie'</span><span class="sxs-lookup"><span data-stu-id="abe08-143">Multiple “Single Partition” collections</span></span>
---|---
![documentdb stream analytics uitvoerscherm](media/stream-analytics-documentdb-output/stream-analytics-documentdb-output-1.png) |  ![documentdb stream analytics uitvoerscherm](media/stream-analytics-documentdb-output/stream-analytics-documentdb-output-2.png)


  
> [!NOTE]
> <span data-ttu-id="abe08-146">De **meerdere verzamelingen met 'Één partitie'** scenario vereist een partitiesleutel en configuratie wel wordt ondersteund.</span><span class="sxs-lookup"><span data-stu-id="abe08-146">The **Multiple “Single Partition” collections** scenario requires a partition key and is a supported configuration.</span></span> 

* <span data-ttu-id="abe08-147">**Uitvoer Alias** – een alias voor het verwijzen deze uitvoer in uw query ASA</span><span class="sxs-lookup"><span data-stu-id="abe08-147">**Output Alias** – An alias to refer this output in your ASA query</span></span>  
* <span data-ttu-id="abe08-148">**De accountnaam** : de naam of de URI van de Cosmos-DB-account voor het eindpunt.</span><span class="sxs-lookup"><span data-stu-id="abe08-148">**Account Name** – The name or endpoint URI of the Cosmos DB account.</span></span>  
* <span data-ttu-id="abe08-149">**Account van de sleutel** – de gedeelde toegangssleutel voor het account van de Cosmos-DB.</span><span class="sxs-lookup"><span data-stu-id="abe08-149">**Account Key** – The shared access key for the Cosmos DB account.</span></span>  
* <span data-ttu-id="abe08-150">**Database** – naam van de Cosmos-DB-database.</span><span class="sxs-lookup"><span data-stu-id="abe08-150">**Database** – The Cosmos DB database name.</span></span>  
* <span data-ttu-id="abe08-151">**Verzameling naampatroon** – naam van de verzameling of het patroon voor de verzamelingen moet worden gebruikt.</span><span class="sxs-lookup"><span data-stu-id="abe08-151">**Collection Name Pattern** – The collection name or their pattern for the collections to be used.</span></span> <span data-ttu-id="abe08-152">Indeling van de Collectienaam kan worden samengesteld met behulp van de optionele {partition}-token, waarbij partities beginnen bij 0.</span><span class="sxs-lookup"><span data-stu-id="abe08-152">The collection name format can be constructed using the optional {partition} token, where partitions start from 0.</span></span> <span data-ttu-id="abe08-153">Hieronder vindt u voorbeeld geldige invoer:</span><span class="sxs-lookup"><span data-stu-id="abe08-153">Following are sample valid inputs:</span></span>  
  <span data-ttu-id="abe08-154">1\) MyCollection: een verzameling met de naam 'MyCollection' moet aanwezig zijn.</span><span class="sxs-lookup"><span data-stu-id="abe08-154">1\) MyCollection – One collection named “MyCollection” must exist.</span></span>  
  <span data-ttu-id="abe08-155">2\) MyCollection {partition} – deze verzamelingen moeten bestaan – 'MyCollection0', 'MyCollection1', 'MyCollection2', enzovoort.</span><span class="sxs-lookup"><span data-stu-id="abe08-155">2\) MyCollection{partition} – Such collections must exist– "MyCollection0”, “MyCollection1”, “MyCollection2” and so on.</span></span>  
* <span data-ttu-id="abe08-156">**Partitie-sleutel** : optioneel.</span><span class="sxs-lookup"><span data-stu-id="abe08-156">**Partition Key** – Optional.</span></span> <span data-ttu-id="abe08-157">Dit is alleen nodig als u een token {partitie} in het patroon van de naam van verzameling.</span><span class="sxs-lookup"><span data-stu-id="abe08-157">This is only needed if you are using a {parition} token in your collection name pattern.</span></span> <span data-ttu-id="abe08-158">De naam van het veld in uitvoergebeurtenissen dat wordt gebruikt om de sleutel op te geven voor het partitioneren van uitvoer in collecties.</span><span class="sxs-lookup"><span data-stu-id="abe08-158">The name of the field in output events used to specify the key for partitioning output across collections.</span></span> <span data-ttu-id="abe08-159">Voor één verzameling uitvoer, elke willekeurige uitvoerkolom kan worden gebruikt, bijvoorbeeld PartitionId.</span><span class="sxs-lookup"><span data-stu-id="abe08-159">For single collection output, any arbitrary output column can be used e.g. PartitionId.</span></span>  
* <span data-ttu-id="abe08-160">**ID-document** : optioneel.</span><span class="sxs-lookup"><span data-stu-id="abe08-160">**Document ID** – Optional.</span></span> <span data-ttu-id="abe08-161">De naam van het veld in uitvoergebeurtenissen dat wordt gebruikt voor de primaire sleutel opgeven in welke invoegen of updatebewerkingen zijn gebaseerd.</span><span class="sxs-lookup"><span data-stu-id="abe08-161">The name of the field in output events used to specify the primary key on which insert or update operations are based.</span></span>  
