---
title: 'CENC met Multi-DRM en toegangsbeheer: een verwijzing naar ontwerpen en implementeren op Azure en Azure mediaservices | Microsoft Docs'
description: "Meer informatie over hoe toolicensing Hallo Microsoft® Smooth Streaming Client overdragen Kit."
services: media-services
documentationcenter: 
author: willzhan
manager: cfowler
editor: 
ms.assetid: 7814739b-cea9-4b9b-8370-538702e5c615
ms.service: media-services
ms.workload: media
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/19/2017
ms.author: willzhan;kilroyh;yanmf;juliako
ms.openlocfilehash: 033fb618650c4fbe9069d467159a8734da759bba
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 10/06/2017
---
# <a name="cenc-with-multi-drm-and-access-control-a-reference-design-and-implementation-on-azure-and-azure-media-services"></a><span data-ttu-id="57267-103">CENC met Multi-DRM en Access Control: een referentieontwerp en -implementatie in Azure en Azure Media Services</span><span class="sxs-lookup"><span data-stu-id="57267-103">CENC with Multi-DRM and Access Control: A Reference Design and Implementation on Azure and Azure Media Services</span></span>
 
## <a name="introduction"></a><span data-ttu-id="57267-104">Inleiding</span><span class="sxs-lookup"><span data-stu-id="57267-104">Introduction</span></span>
<span data-ttu-id="57267-105">Het is bekend dat het een complexe taak toodesign en een subsysteem DRM bouwen voor een OTT of online streamingoplossing.</span><span class="sxs-lookup"><span data-stu-id="57267-105">It is well known that it is a complex task toodesign and build a DRM subsystem for an OTT or online streaming solution.</span></span> <span data-ttu-id="57267-106">En is een algemeen in de praktijk voor operators/online video providers toooutsource deze serviceproviders onderdeel toospecialized DRM.</span><span class="sxs-lookup"><span data-stu-id="57267-106">And it is a common practice for operators/online video providers toooutsource this part toospecialized DRM service providers.</span></span> <span data-ttu-id="57267-107">Hallo-doel van dit document is toopresent een referentie-ontwerp en de implementatie van end-to-end DRM-subsysteem in OTT of online streaming-oplossing.</span><span class="sxs-lookup"><span data-stu-id="57267-107">hello goal of this document is toopresent a reference design and implementation of end-to-end DRM subsystem in OTT or online streaming solution.</span></span>

<span data-ttu-id="57267-108">Hallo gericht lezers van dit document zijn engineers werken in DRM-subsysteem van OTT online streaming/meerdere-screen oplossingen of eventuele geïnteresseerd in DRM-subsysteem lezers.</span><span class="sxs-lookup"><span data-stu-id="57267-108">hello targeted readers of this document are engineers working in DRM subsystem of OTT or online streaming/multi-screen solutions, or any readers interested in DRM subsystem.</span></span> <span data-ttu-id="57267-109">Hallo verondersteld wordt dat lezers bekend met ten minste één Hallo DRM technologieën op de markt hello, zoals PlayReady, Widevine, FairPlay of Adobe Access bent.</span><span class="sxs-lookup"><span data-stu-id="57267-109">hello assumption is that readers are familiar with at least one of hello DRM technologies on hello market, such as PlayReady, Widevine, FairPlay or Adobe Access.</span></span>

<span data-ttu-id="57267-110">Door DRM opnemen we ook (Common Encryption) CENC met multi-DRM.</span><span class="sxs-lookup"><span data-stu-id="57267-110">By DRM, we also include CENC (Common Encryption) with multi-DRM.</span></span> <span data-ttu-id="57267-111">Een belangrijke trend in online streaming en OTT industrie is toouse CENC met meerdere-native-DRM op verschillende clientplatforms, een verschuiving van Hallo vorige trend van het gebruik van een enkele DRM en de client-SDK voor verschillende clientplatforms.</span><span class="sxs-lookup"><span data-stu-id="57267-111">A major trend in online streaming and OTT industry is toouse CENC with multi-native-DRM on various client platforms, which is a shift from hello previous trend of using a single DRM and its client SDK for various client platforms.</span></span> <span data-ttu-id="57267-112">Als u CENC met meerdere native DRM, zowel PlayReady als Widevine zijn versleuteld volgens Hallo [Common Encryption (ISO/IEC 23001-7 CENC)](http://www.iso.org/iso/home/store/catalogue_ics/catalogue_detail_ics.htm?csnumber=65271/) specificatie.</span><span class="sxs-lookup"><span data-stu-id="57267-112">When using CENC with multi-native-DRM, both PlayReady and Widevine are encrypted per hello [Common Encryption (ISO/IEC 23001-7 CENC)](http://www.iso.org/iso/home/store/catalogue_ics/catalogue_detail_ics.htm?csnumber=65271/) specification.</span></span>

<span data-ttu-id="57267-113">Hallo voordelen van CENC met multi-DRM zijn als volgt:</span><span class="sxs-lookup"><span data-stu-id="57267-113">hello benefits of CENC with multi-DRM are as follows:</span></span>

1. <span data-ttu-id="57267-114">Vermindert versleuteling kosten omdat de verwerking van een enkele versleuteling wordt gebruikt die gericht is op verschillende platforms met de systeemeigen DRM's;</span><span class="sxs-lookup"><span data-stu-id="57267-114">Reduces encryption cost since a single encryption processing is used targeting different platforms with its native DRMs;</span></span>
2. <span data-ttu-id="57267-115">Beperkt de kosten Hallo versleutelde activa te beheren omdat slechts één exemplaar van de versleutelde activa is vereist;</span><span class="sxs-lookup"><span data-stu-id="57267-115">Reduces hello cost of managing encrypted assets since only a single copy of encrypted assets is needed;</span></span>
3. <span data-ttu-id="57267-116">Elimineert kosten licentieverlening omdat Hallo systeemeigen DRM-client meestal vrije ruimte op het systeemeigen platform is DRM-client.</span><span class="sxs-lookup"><span data-stu-id="57267-116">Eliminates DRM client licensing cost since hello native DRM client is usually free on its native platform.</span></span>

<span data-ttu-id="57267-117">Microsoft is een actieve organisator van deze actie van DASH en CENC samen met enkele belangrijke zakelijke spelers.</span><span class="sxs-lookup"><span data-stu-id="57267-117">Microsoft has been an active promoter of DASH and CENC together with some major industry players.</span></span> <span data-ttu-id="57267-118">Microsoft Azure Media Services heeft is het bieden van ondersteuning van DASH en CENC.</span><span class="sxs-lookup"><span data-stu-id="57267-118">Microsoft Azure Media Services has been providing support of DASH and CENC.</span></span> <span data-ttu-id="57267-119">Zie voor recente aankondigingen van Mingfei blogs: [aangekondigd Google Widevine-licentie levering van services in Azure Media Services](https://azure.microsoft.com/blog/announcing-general-availability-of-google-widevine-license-services/), en [Azure Media Services wordt toegevoegd voor Google Widevine-verpakking voor het leveren van multi-DRM stroom](https://azure.microsoft.com/blog/azure-media-services-adds-google-widevine-packaging-for-delivering-multi-drm-stream/).</span><span class="sxs-lookup"><span data-stu-id="57267-119">For recent announcements, please see Mingfei’s blogs: [Announcing Google Widevine license delivery services in Azure Media Services](https://azure.microsoft.com/blog/announcing-general-availability-of-google-widevine-license-services/), and [Azure Media Services adds Google Widevine packaging for delivering multi-DRM stream](https://azure.microsoft.com/blog/azure-media-services-adds-google-widevine-packaging-for-delivering-multi-drm-stream/).</span></span>  

### <a name="overview-of-this-article"></a><span data-ttu-id="57267-120">Overzicht van dit artikel</span><span class="sxs-lookup"><span data-stu-id="57267-120">Overview of this article</span></span>
<span data-ttu-id="57267-121">Hallo-doel van dit artikel omvat Hallo volgende:</span><span class="sxs-lookup"><span data-stu-id="57267-121">hello goal of this article includes hello following:</span></span>

1. <span data-ttu-id="57267-122">Bevat een verwijzing van DRM-subsysteem met CENC met multi-DRM;</span><span class="sxs-lookup"><span data-stu-id="57267-122">Provides a reference design of DRM subsystem using CENC with multi-DRM;</span></span>
2. <span data-ttu-id="57267-123">Biedt de implementatie van een verwijzing op Microsoft Azure/Azure Media Services-platform;</span><span class="sxs-lookup"><span data-stu-id="57267-123">Provides a reference implementation on Microsoft Azure/Azure Media Services platform;</span></span>
3. <span data-ttu-id="57267-124">Sommige onderwerpen ontwerp- en implementatiestappen besproken.</span><span class="sxs-lookup"><span data-stu-id="57267-124">Discusses some design and implementation topics.</span></span>

<span data-ttu-id="57267-125">Hallo-artikel 'multi-DRM' bevat informatie over de volgende Hallo is:</span><span class="sxs-lookup"><span data-stu-id="57267-125">In hello article, “multi-DRM” covers hello following:</span></span>

1. <span data-ttu-id="57267-126">Microsoft PlayReady</span><span class="sxs-lookup"><span data-stu-id="57267-126">Microsoft PlayReady</span></span>
2. <span data-ttu-id="57267-127">Google Widevine</span><span class="sxs-lookup"><span data-stu-id="57267-127">Google Widevine</span></span>
3. <span data-ttu-id="57267-128">FairPlay van Apple</span><span class="sxs-lookup"><span data-stu-id="57267-128">Apple FairPlay</span></span> 

<span data-ttu-id="57267-129">Hallo volgende tabel ziet u Hallo systeemeigen platform/systeemeigen app en browsers die door elke DRM ondersteund.</span><span class="sxs-lookup"><span data-stu-id="57267-129">hello following table summarizes hello native platform/native app, and browsers supported by each DRM.</span></span>

| <span data-ttu-id="57267-130">**Clientplatform**</span><span class="sxs-lookup"><span data-stu-id="57267-130">**Client Platform**</span></span> | <span data-ttu-id="57267-131">**Systeemeigen DRM-ondersteuning**</span><span class="sxs-lookup"><span data-stu-id="57267-131">**Native DRM Support**</span></span> | <span data-ttu-id="57267-132">**Browser-App**</span><span class="sxs-lookup"><span data-stu-id="57267-132">**Browser/App**</span></span> | <span data-ttu-id="57267-133">**Streaming-indelingen**</span><span class="sxs-lookup"><span data-stu-id="57267-133">**Streaming Formats**</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="57267-134">**Smart tv, operator STB's, OTT STB 's**</span><span class="sxs-lookup"><span data-stu-id="57267-134">**Smart TVs, operator STBs, OTT STBs**</span></span> |<span data-ttu-id="57267-135">PlayReady voornamelijk, en/of Widevine en/of andere</span><span class="sxs-lookup"><span data-stu-id="57267-135">PlayReady primarily, and/or Widevine, and/or other</span></span> |<span data-ttu-id="57267-136">Linux, Opera, WebKit, andere</span><span class="sxs-lookup"><span data-stu-id="57267-136">Linux, Opera, WebKit, Other</span></span> |<span data-ttu-id="57267-137">Verschillende indelingen</span><span class="sxs-lookup"><span data-stu-id="57267-137">Various formats</span></span> |
| <span data-ttu-id="57267-138">**Windows 10-apparaten (Windows-PC, Windows-Tablets, Windows Phone, Xbox.)**</span><span class="sxs-lookup"><span data-stu-id="57267-138">**Windows 10 devices (Windows PC, Windows Tablets, Windows Phone, Xbox)**</span></span> |<span data-ttu-id="57267-139">PlayReady</span><span class="sxs-lookup"><span data-stu-id="57267-139">PlayReady</span></span> |<span data-ttu-id="57267-140">MS IE11-Edge/EME</span><span class="sxs-lookup"><span data-stu-id="57267-140">MS Edge/IE11/EME</span></span><br/><br/><br/><span data-ttu-id="57267-141">UWP</span><span class="sxs-lookup"><span data-stu-id="57267-141">UWP</span></span> |<span data-ttu-id="57267-142">STREEPJE (voor HLS, PlayReady wordt niet ondersteund)</span><span class="sxs-lookup"><span data-stu-id="57267-142">DASH (For HLS, PlayReady is not supported)</span></span><br/><br/><span data-ttu-id="57267-143">DASH, Smooth Streaming (HLS voor, PlayReady wordt niet ondersteund)</span><span class="sxs-lookup"><span data-stu-id="57267-143">DASH, Smooth Streaming (For HLS, PlayReady is not supported)</span></span> |
| <span data-ttu-id="57267-144">**Android-apparaten (telefoon, Tablet, TV)**</span><span class="sxs-lookup"><span data-stu-id="57267-144">**Android devices (Phone, Tablet, TV)**</span></span> |<span data-ttu-id="57267-145">Widevine</span><span class="sxs-lookup"><span data-stu-id="57267-145">Widevine</span></span> |<span data-ttu-id="57267-146">Chrome/EME</span><span class="sxs-lookup"><span data-stu-id="57267-146">Chrome/EME</span></span> |<span data-ttu-id="57267-147">DASH, HLS</span><span class="sxs-lookup"><span data-stu-id="57267-147">DASH,HLS</span></span> |
| <span data-ttu-id="57267-148">**iOS (iPhone, iPad), OS X-clients en Apple TV**</span><span class="sxs-lookup"><span data-stu-id="57267-148">**iOS (iPhone, iPad), OS X clients and Apple TV**</span></span> |<span data-ttu-id="57267-149">FairPlay</span><span class="sxs-lookup"><span data-stu-id="57267-149">FairPlay</span></span> |<span data-ttu-id="57267-150">Safari 8 +/ EME</span><span class="sxs-lookup"><span data-stu-id="57267-150">Safari 8+/EME</span></span> |<span data-ttu-id="57267-151">HLS</span><span class="sxs-lookup"><span data-stu-id="57267-151">HLS</span></span> |


<span data-ttu-id="57267-152">In overweging Hallo huidige status van implementatie voor elke DRM, een service wordt meestal wel verstandig tooimplement 2 of 3 DRM's toomake zeker dat u alle Hallo typen eindpunten in Hallo best adres manier.</span><span class="sxs-lookup"><span data-stu-id="57267-152">Considering hello current state of deployment for each DRM, a service will typically want tooimplement 2 or 3 DRMs toomake sure you address all hello types of endpoints in hello best way.</span></span>

<span data-ttu-id="57267-153">Er is een afweging tussen Hallo complexiteit van Hallo service logica en complexiteit Hallo op Hallo client side tooreach een bepaalde mate van gebruiker ervaring op Hallo verschillende clients.</span><span class="sxs-lookup"><span data-stu-id="57267-153">There is a tradeoff between hello complexity of hello service logic and hello complexity on hello client side tooreach a certain level of user experience on hello various clients.</span></span>

<span data-ttu-id="57267-154">toomake uw selectie, houd er rekening mee deze feiten:</span><span class="sxs-lookup"><span data-stu-id="57267-154">toomake your selection, keep in mind these facts:</span></span>

* <span data-ttu-id="57267-155">PlayReady is systeemeigen geïmplementeerd in elke Windows-apparaat op een Android-apparaten en beschikbaar via software-SDK's op vrijwel elk platform</span><span class="sxs-lookup"><span data-stu-id="57267-155">PlayReady is natively implemented in every Windows device, on some Android devices, and available through software SDKs on virtually any platform</span></span>
* <span data-ttu-id="57267-156">Widevine is systeemeigen geïmplementeerd in elke Android-apparaat, Chrome en sommige andere apparaten</span><span class="sxs-lookup"><span data-stu-id="57267-156">Widevine is natively implemented in every Android device, in Chrome, and in some other devices</span></span>
* <span data-ttu-id="57267-157">FairPlay is beschikbaar op iOS en Mac OS-clients of via iTunes.</span><span class="sxs-lookup"><span data-stu-id="57267-157">FairPlay is available only on iOS and Mac OS clients or through iTunes.</span></span>

<span data-ttu-id="57267-158">Zo een typische multi-DRM zijn zou:</span><span class="sxs-lookup"><span data-stu-id="57267-158">So a typical multi-DRM would be:</span></span>

* <span data-ttu-id="57267-159">Optie 1: PlayReady en Widevine</span><span class="sxs-lookup"><span data-stu-id="57267-159">Option 1: PlayReady and Widevine</span></span>
* <span data-ttu-id="57267-160">Optie 2: PlayReady, Widevine en FairPlay</span><span class="sxs-lookup"><span data-stu-id="57267-160">Option 2: PlayReady, Widevine and FairPlay</span></span>

## <a name="a-reference-design"></a><span data-ttu-id="57267-161">Een referentie-ontwerp</span><span class="sxs-lookup"><span data-stu-id="57267-161">A reference design</span></span>
<span data-ttu-id="57267-162">In deze sectie wordt een verwijzing model dat agnostisch tootechnologies gebruikt tooimplement is biedt deze.</span><span class="sxs-lookup"><span data-stu-id="57267-162">In this section, we will present a reference design which is agnostic tootechnologies used tooimplement it.</span></span>

<span data-ttu-id="57267-163">Een DRM-subsysteem kan Hallo volgende onderdelen bevatten:</span><span class="sxs-lookup"><span data-stu-id="57267-163">A DRM subsystem may contain hello following components:</span></span>

1. <span data-ttu-id="57267-164">Sleutelbeheer</span><span class="sxs-lookup"><span data-stu-id="57267-164">Key management</span></span>
2. <span data-ttu-id="57267-165">DRM verpakking</span><span class="sxs-lookup"><span data-stu-id="57267-165">DRM packaging</span></span>
3. <span data-ttu-id="57267-166">Levering van DRM-licentie</span><span class="sxs-lookup"><span data-stu-id="57267-166">DRM license delivery</span></span>
4. <span data-ttu-id="57267-167">Recht controleren</span><span class="sxs-lookup"><span data-stu-id="57267-167">Entitlement check</span></span>
5. <span data-ttu-id="57267-168">Verificatie/autorisatie</span><span class="sxs-lookup"><span data-stu-id="57267-168">Authentication/authorization</span></span>
6. <span data-ttu-id="57267-169">Player</span><span class="sxs-lookup"><span data-stu-id="57267-169">Player</span></span>
7. <span data-ttu-id="57267-170">Oorsprong/CDN</span><span class="sxs-lookup"><span data-stu-id="57267-170">Origin/CDN</span></span>

<span data-ttu-id="57267-171">Hallo illustreert volgende diagram Hallo hoog niveau interactie tussen Hallo-onderdelen in een DRM-subsysteem.</span><span class="sxs-lookup"><span data-stu-id="57267-171">hello following diagram illustrates hello high level interaction among hello components in a DRM subsystem.</span></span>

![DRM-subsysteem met CENC](./media/media-services-cenc-with-multidrm-access-control/media-services-generic-drm-subsystem-with-cenc.png)

<span data-ttu-id="57267-173">Er zijn drie basic 'lagen' hello ontwerp:</span><span class="sxs-lookup"><span data-stu-id="57267-173">There are three basic “layers” in hello design:</span></span>

1. <span data-ttu-id="57267-174">Back-office-laag (in zwart) die extern; niet worden weergegeven</span><span class="sxs-lookup"><span data-stu-id="57267-174">Back office layer (in black) which are not exposed externally;</span></span>
2. <span data-ttu-id="57267-175">'DMZ'-laag (blauw) met alle Hallo eindpunten gerichte openbare;</span><span class="sxs-lookup"><span data-stu-id="57267-175">“DMZ” layer (blue) containing all hello endpoints facing public;</span></span>
3. <span data-ttu-id="57267-176">Openbare internetlaag (lichte blauw) met CDN en spelers met verkeer via openbaar Internet.</span><span class="sxs-lookup"><span data-stu-id="57267-176">Public Internet layer (light blue) containing CDN and players with traffic across public Internet.</span></span>

<span data-ttu-id="57267-177">Er moet een inhoudsbeheer hulpprogramma voor het beheren van DRM-beveiliging, ongeacht het statische of dynamische versleuteling is.</span><span class="sxs-lookup"><span data-stu-id="57267-177">There should be a content management tool for controlling DRM protection, regardless it is static or dynamic encryption.</span></span> <span data-ttu-id="57267-178">Hallo-ingangen voor DRM-codering moeten worden opgenomen:</span><span class="sxs-lookup"><span data-stu-id="57267-178">hello inputs for DRM encryption should include:</span></span>

1. <span data-ttu-id="57267-179">MBR video-inhoud;</span><span class="sxs-lookup"><span data-stu-id="57267-179">MBR video content;</span></span>
2. <span data-ttu-id="57267-180">Inhoudssleutel;</span><span class="sxs-lookup"><span data-stu-id="57267-180">Content key;</span></span>
3. <span data-ttu-id="57267-181">URL's aanschaf van licentie.</span><span class="sxs-lookup"><span data-stu-id="57267-181">License acquisition URLs.</span></span>

<span data-ttu-id="57267-182">Tijdens het afspelen van is hoog niveau stroom Hallo:</span><span class="sxs-lookup"><span data-stu-id="57267-182">During playback time, hello high level flow is:</span></span>

1. <span data-ttu-id="57267-183">Gebruiker is geverifieerd;</span><span class="sxs-lookup"><span data-stu-id="57267-183">User is authenticated;</span></span>
2. <span data-ttu-id="57267-184">Verificatietoken is gemaakt voor gebruiker Hallo;</span><span class="sxs-lookup"><span data-stu-id="57267-184">Authorization token is created for hello user;</span></span>
3. <span data-ttu-id="57267-185">DRM beveiligde inhoud (manifest) is gedownloade tooplayer;</span><span class="sxs-lookup"><span data-stu-id="57267-185">DRM protected content (manifest) is downloaded tooplayer;</span></span>
4. <span data-ttu-id="57267-186">Player verzendt overname aanvraag toolicense licentieservers samen met sleutel-ID en -autorisatie-token.</span><span class="sxs-lookup"><span data-stu-id="57267-186">Player submits license acquisition request toolicense servers together with key ID and authorization token.</span></span>

<span data-ttu-id="57267-187">Voordat bewegende toohello Volgend onderwerp ontwerp enkele woorden op Hallo van Sleutelbeheer.</span><span class="sxs-lookup"><span data-stu-id="57267-187">Before moving toohello next topic, a few words about hello design of key management.</span></span>

| <span data-ttu-id="57267-188">**ContentKey-Asset:**</span><span class="sxs-lookup"><span data-stu-id="57267-188">**ContentKey–to-Asset**</span></span> | <span data-ttu-id="57267-189">**Scenario**</span><span class="sxs-lookup"><span data-stu-id="57267-189">**Scenario**</span></span> |
| --- | --- |
| <span data-ttu-id="57267-190">1-op-1</span><span class="sxs-lookup"><span data-stu-id="57267-190">1–to-1</span></span> |<span data-ttu-id="57267-191">de meest eenvoudige geval Hallo.</span><span class="sxs-lookup"><span data-stu-id="57267-191">hello simplest case.</span></span> <span data-ttu-id="57267-192">Het bevat beste Hallo-besturingselement.</span><span class="sxs-lookup"><span data-stu-id="57267-192">It provides hello finest control.</span></span> <span data-ttu-id="57267-193">Maar resulteert dit in het algemeen in Hallo hoogst licentie leveringskosten.</span><span class="sxs-lookup"><span data-stu-id="57267-193">But this generally results in hello highest license delivery cost.</span></span> <span data-ttu-id="57267-194">Aanvraag is vereist voor alle beveiligde activa op ten minste één licentie.</span><span class="sxs-lookup"><span data-stu-id="57267-194">At minimum one license request is required for each protected asset.</span></span> |
| <span data-ttu-id="57267-195">1-op-veel</span><span class="sxs-lookup"><span data-stu-id="57267-195">1–to-Many</span></span> |<span data-ttu-id="57267-196">U kunt dezelfde inhoud sleutel voor meerdere assets Hallo.</span><span class="sxs-lookup"><span data-stu-id="57267-196">You could use hello same content key for multiple assets.</span></span> <span data-ttu-id="57267-197">Bijvoorbeeld: voor alle Hallo activa in een logische groep zoals een genre of een subset van genre (of film gen) u kunt een enkel inhoudssleutel.</span><span class="sxs-lookup"><span data-stu-id="57267-197">For example, for all hello assets in a logical group such as a genre or subset of genre (or Movie Gene), you could use a single content key.</span></span> |
| <span data-ttu-id="57267-198">Veel-op-1</span><span class="sxs-lookup"><span data-stu-id="57267-198">Many–to-1</span></span> |<span data-ttu-id="57267-199">Meerdere inhoudssleutels nodig zijn voor elk actief.</span><span class="sxs-lookup"><span data-stu-id="57267-199">Multiple content keys are needed for each asset.</span></span> <br/><br/><span data-ttu-id="57267-200">Als u tooapply beveiliging met betrekking tot een dynamische CENC met multi-DRM voor MPEG-DASH- en dynamische AES-128-versleuteling voor HLS nodig hebt, moet u bijvoorbeeld twee afzonderlijke inhoud sleutels, elk met een eigen ContentKeyType.</span><span class="sxs-lookup"><span data-stu-id="57267-200">For example, if you need tooapply dynamic CENC protection with multi-DRM for MPEG-DASH, and dynamic AES-128 encryption for HLS, you need two separate content keys, each with its own ContentKeyType.</span></span> <span data-ttu-id="57267-201">(Voor Hallo-inhoudssleutel gebruikt voor dynamische CENC beveiliging, ContentKeyType.CommonEncryption moet worden gebruikt, terwijl voor Hallo inhoud sleutel die wordt gebruikt voor dynamische AES-128-versleuteling, ContentKeyType.EnvelopeEncryption moet worden gebruikt.)</span><span class="sxs-lookup"><span data-stu-id="57267-201">(For hello content key used for dynamic CENC protection, ContentKeyType.CommonEncryption should be used, while for hello content key used for dynamic AES-128 encryption, ContentKeyType.EnvelopeEncryption should be used.)</span></span><br/><br/><span data-ttu-id="57267-202">Inhoud van een ander voorbeeld: bij CENC bescherming van streepje, in theorie, een inhoudssleutel kan worden gebruikt tooprotect videostream en een andere inhoud sleutel tooprotect audiostroom.</span><span class="sxs-lookup"><span data-stu-id="57267-202">Another example, in CENC protection of DASH content, in theory, one content key can be used tooprotect video stream and another content key tooprotect audio stream.</span></span> |
| <span data-ttu-id="57267-203">Veel – te-veel</span><span class="sxs-lookup"><span data-stu-id="57267-203">Many – too- Many</span></span> |<span data-ttu-id="57267-204">Combinatie van Hallo hierboven twee scenario's: een set van inhoud sleutels worden gebruikt voor elk van meerdere activa in Hallo Hallo dezelfde asset 'groep'.</span><span class="sxs-lookup"><span data-stu-id="57267-204">Combination of hello above two scenarios: one set of content keys are used for each of hello multiple assets in hello same asset “group”.</span></span> |

<span data-ttu-id="57267-205">Een andere belangrijke factor tooconsider is Hallo gebruik van permanente en niet-permanente licenties.</span><span class="sxs-lookup"><span data-stu-id="57267-205">Another important factor tooconsider is hello use of persistent and non-persistent licenses.</span></span>

<span data-ttu-id="57267-206">Waarom deze overwegingen belangrijk zijn?</span><span class="sxs-lookup"><span data-stu-id="57267-206">Why are these considerations important?</span></span>

<span data-ttu-id="57267-207">Ze hebben een directe invloed toolicense levering kosten als u de openbare cloud voor de levering van licentie gebruiken.</span><span class="sxs-lookup"><span data-stu-id="57267-207">They have direct impact toolicense delivery cost if you use public cloud for license delivery.</span></span> <span data-ttu-id="57267-208">Laten we eens Hallo twee verschillende ontwerp gevallen tooillustrate te volgen:</span><span class="sxs-lookup"><span data-stu-id="57267-208">Let’s consider hello following two different design cases tooillustrate:</span></span>

1. <span data-ttu-id="57267-209">Maandabonnement: permanente licentie en 1-op-veel inhoud sleutel aan asset toewijzing gebruiken.</span><span class="sxs-lookup"><span data-stu-id="57267-209">Monthly subscription: Use persistent license, and 1-to-many content key-to-asset mapping.</span></span> <span data-ttu-id="57267-210">Bijvoorbeeld</span><span class="sxs-lookup"><span data-stu-id="57267-210">E.g.</span></span> <span data-ttu-id="57267-211">voor alle Hallo kinderen films gebruiken we een enkele inhoudssleutel voor versleuteling.</span><span class="sxs-lookup"><span data-stu-id="57267-211">for all hello kids movies, we use a single content key for encryption.</span></span> <span data-ttu-id="57267-212">In dit geval:</span><span class="sxs-lookup"><span data-stu-id="57267-212">In this case:</span></span>

    <span data-ttu-id="57267-213">Totaal aantal licenties van # aangevraagd voor alle kinderen films/apparaat = 1</span><span class="sxs-lookup"><span data-stu-id="57267-213">Total # licenses requested for all kids movies/device = 1</span></span>
2. <span data-ttu-id="57267-214">Maandabonnement: niet-permanente licentie en 1 op 1 toewijzing tussen inhoudssleutel en asset gebruiken.</span><span class="sxs-lookup"><span data-stu-id="57267-214">Monthly subscription: Use non-persistent license, and 1-to-1 mapping between content key and asset.</span></span> <span data-ttu-id="57267-215">In dit geval:</span><span class="sxs-lookup"><span data-stu-id="57267-215">In this case:</span></span>

    <span data-ttu-id="57267-216">Totaal aantal licenties van # aangevraagd voor alle kinderen films/apparaat = [# films gevolgde] x [# sessies]</span><span class="sxs-lookup"><span data-stu-id="57267-216">Total # licenses requested for all kids movies/device = [# movies watched] x [# sessions]</span></span>

<span data-ttu-id="57267-217">Zoals u kunt gemakkelijk zien, Hallo twee verschillende ontwerpen resulteren in zeer andere licentiegroepen patronen daarom licentie bezorging verzoeken kosten als service voor het leveren van licenties is opgegeven door een openbare cloud zoals Azure Media Services.</span><span class="sxs-lookup"><span data-stu-id="57267-217">As you can easily see, hello two different designs result in very different license request patterns hence license delivery cost if license delivery service is provided by a public cloud such as Azure Media Services.</span></span>

## <a name="mapping-design-tootechnology-for-implementation"></a><span data-ttu-id="57267-218">Toewijzing ontwerp tootechnology voor implementatie</span><span class="sxs-lookup"><span data-stu-id="57267-218">Mapping design tootechnology for implementation</span></span>
<span data-ttu-id="57267-219">Vervolgens toewijzen we onze algemene ontwerp tootechnologies op Microsoft Azure/Azure Media Services-platform door op te geven welke toouse technologie voor elke bouwsteen.</span><span class="sxs-lookup"><span data-stu-id="57267-219">Next, we map our generic design tootechnologies on Microsoft Azure/Azure Media Services platform, by specifying which technology toouse for each building block.</span></span>

<span data-ttu-id="57267-220">Hallo ziet volgende tabel u Hallo toewijzing:</span><span class="sxs-lookup"><span data-stu-id="57267-220">hello following table shows hello mapping:</span></span>

| <span data-ttu-id="57267-221">**Bouwstenen**</span><span class="sxs-lookup"><span data-stu-id="57267-221">**Building Block**</span></span> | <span data-ttu-id="57267-222">**Technologie**</span><span class="sxs-lookup"><span data-stu-id="57267-222">**Technology**</span></span> |
| --- | --- |
| <span data-ttu-id="57267-223">**Player**</span><span class="sxs-lookup"><span data-stu-id="57267-223">**Player**</span></span> |[<span data-ttu-id="57267-224">Azure Media Player</span><span class="sxs-lookup"><span data-stu-id="57267-224">Azure Media Player</span></span>](https://azure.microsoft.com/services/media-services/media-player/) |
| <span data-ttu-id="57267-225">**ID-Provider (IDP)**</span><span class="sxs-lookup"><span data-stu-id="57267-225">**Identity Provider (IDP)**</span></span> |<span data-ttu-id="57267-226">Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="57267-226">Azure Active Directory</span></span> |
| <span data-ttu-id="57267-227">**Beveiligde beveiligingstokenservice (STS)**</span><span class="sxs-lookup"><span data-stu-id="57267-227">**Secure Token Service (STS)**</span></span> |<span data-ttu-id="57267-228">Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="57267-228">Azure Active Directory</span></span> |
| <span data-ttu-id="57267-229">**Werkstroom van DRM-beveiliging**</span><span class="sxs-lookup"><span data-stu-id="57267-229">**DRM Protection Workflow**</span></span> |<span data-ttu-id="57267-230">Azure Media Services dynamische beveiliging</span><span class="sxs-lookup"><span data-stu-id="57267-230">Azure Media Services Dynamic Protection</span></span> |
| <span data-ttu-id="57267-231">**Levering van DRM-licentie**</span><span class="sxs-lookup"><span data-stu-id="57267-231">**DRM License Delivery**</span></span> |<span data-ttu-id="57267-232">1. Azure Media Services-licentie leveringsmethode (PlayReady, Widevine, FairPlay), of</span><span class="sxs-lookup"><span data-stu-id="57267-232">1. Azure Media Services License Delivery (PlayReady, Widevine, FairPlay), or</span></span> <br/><span data-ttu-id="57267-233">2. Axinom-licentieserver</span><span class="sxs-lookup"><span data-stu-id="57267-233">2. Axinom License Server,</span></span> <br/><span data-ttu-id="57267-234">3. Aangepaste PlayReady-licentieserver</span><span class="sxs-lookup"><span data-stu-id="57267-234">3. Custom PlayReady License Server</span></span> |
| <span data-ttu-id="57267-235">**Oorsprong**</span><span class="sxs-lookup"><span data-stu-id="57267-235">**Origin**</span></span> |<span data-ttu-id="57267-236">Azure Media Services-Streaming-eindpunt</span><span class="sxs-lookup"><span data-stu-id="57267-236">Azure Media Services Streaming Endpoint</span></span> |
| <span data-ttu-id="57267-237">**Sleutelbeheer**</span><span class="sxs-lookup"><span data-stu-id="57267-237">**Key Management**</span></span> |<span data-ttu-id="57267-238">Niet nodig zijn voor de referentie-implementatie</span><span class="sxs-lookup"><span data-stu-id="57267-238">Not needed for reference implementation</span></span> |
| <span data-ttu-id="57267-239">**Inhoudbeheer**</span><span class="sxs-lookup"><span data-stu-id="57267-239">**Content Management**</span></span> |<span data-ttu-id="57267-240">Een C#-consoletoepassing</span><span class="sxs-lookup"><span data-stu-id="57267-240">A C# console application</span></span> |

<span data-ttu-id="57267-241">Met andere woorden, zowel Identity-Provider (IDP) en Secure Token Service (STS) worden Azure AD.</span><span class="sxs-lookup"><span data-stu-id="57267-241">In other words, both Identity Provider (IDP) and Secure Token Service (STS) will be Azure AD.</span></span> <span data-ttu-id="57267-242">Voor player, gebruiken we [Azure Media Player-API](http://amp.azure.net/libs/amp/latest/docs/).</span><span class="sxs-lookup"><span data-stu-id="57267-242">For player, we will use [Azure Media Player API](http://amp.azure.net/libs/amp/latest/docs/).</span></span> <span data-ttu-id="57267-243">Zowel Azure Media Services en Azure Media Player ondersteunen DASH en CENC met multi-DRM.</span><span class="sxs-lookup"><span data-stu-id="57267-243">Both Azure Media Services and Azure Media Player support DASH and CENC with multi-DRM.</span></span>

<span data-ttu-id="57267-244">Hallo volgende diagram laat zien welke Hallo gegevensstructuur en -stromen met Hallo hierboven technologie-toewijzing.</span><span class="sxs-lookup"><span data-stu-id="57267-244">hello following diagram shows hello overall structure and flow with hello above technology mapping.</span></span>

![CENC op AMS](./media/media-services-cenc-with-multidrm-access-control/media-services-cenc-subsystem-on-AMS-platform.png)

<span data-ttu-id="57267-246">In de volgorde tooset een dynamische CENC versleuteling, Hallo inhoudsbeheer tool Hallo na invoer gebruikt:</span><span class="sxs-lookup"><span data-stu-id="57267-246">In order tooset up dynamic CENC encryption, hello content management tool will use hello following inputs:</span></span>

1. <span data-ttu-id="57267-247">Open inhoud;</span><span class="sxs-lookup"><span data-stu-id="57267-247">Open content;</span></span>
2. <span data-ttu-id="57267-248">Inhoudssleutel uit de sleutel genereren/management;</span><span class="sxs-lookup"><span data-stu-id="57267-248">Content key from key generation/management;</span></span>
3. <span data-ttu-id="57267-249">URL's aanschaf van licentie;</span><span class="sxs-lookup"><span data-stu-id="57267-249">License acquisition URLs;</span></span>
4. <span data-ttu-id="57267-250">Een lijst met gegevens uit Azure AD.</span><span class="sxs-lookup"><span data-stu-id="57267-250">A list of information from Azure AD.</span></span>

<span data-ttu-id="57267-251">Hallo-uitvoer van Hallo inhoudsbeheer hulpprogramma zijn:</span><span class="sxs-lookup"><span data-stu-id="57267-251">hello output of hello content management tool will be:</span></span>

1. <span data-ttu-id="57267-252">ContentKeyAuthorizationPolicy met Hallo-specificatie op hoe licentie levering controleert of een JWT-token en DRM licentie specificaties;</span><span class="sxs-lookup"><span data-stu-id="57267-252">ContentKeyAuthorizationPolicy containing hello specification on how license delivery verifies a JWT token and DRM license specifications;</span></span>
2. <span data-ttu-id="57267-253">AssetDeliveryPolicy met specificaties op het streaming-indeling, DRM-beveiliging en URL's aanschaf van licentie.</span><span class="sxs-lookup"><span data-stu-id="57267-253">AssetDeliveryPolicy containing specifications on streaming format, DRM protection and license acquisition URLs.</span></span>

<span data-ttu-id="57267-254">Tijdens runtime, Hallo-stroom is als hieronder:</span><span class="sxs-lookup"><span data-stu-id="57267-254">During runtime, hello flow is as below:</span></span>

1. <span data-ttu-id="57267-255">Bij verificatie van de gebruiker wordt een JWT-token gegenereerd;</span><span class="sxs-lookup"><span data-stu-id="57267-255">Upon user authentication, a JWT token is generated;</span></span>
2. <span data-ttu-id="57267-256">Een van de Hallo claims die zijn opgenomen in Hallo JWT-token is 'groepen' claim met Hallo groep object-ID van 'EntitledUserGroup'.</span><span class="sxs-lookup"><span data-stu-id="57267-256">One of hello claims contained in hello JWT token is “groups” claim containing hello group object ID of “EntitledUserGroup”.</span></span> <span data-ttu-id="57267-257">Deze claim wordt gebruikt voor het doorgeven van 'recht selectievakje'.</span><span class="sxs-lookup"><span data-stu-id="57267-257">This claim will be used for passing “entitlement check”.</span></span>
3. <span data-ttu-id="57267-258">Player downloads client manifest van een CENC beveiligde inhoud en 'ziet' hello volgende:</span><span class="sxs-lookup"><span data-stu-id="57267-258">Player downloads client manifest of a CENC protected content and “sees” hello following:</span></span>

   1. <span data-ttu-id="57267-259">sleutel-ID</span><span class="sxs-lookup"><span data-stu-id="57267-259">key ID,</span></span>
   2. <span data-ttu-id="57267-260">Hallo-inhoud is beveiligd, CENC</span><span class="sxs-lookup"><span data-stu-id="57267-260">hello content is CENC protected,</span></span>
   3. <span data-ttu-id="57267-261">URL's aanschaf van licentie.</span><span class="sxs-lookup"><span data-stu-id="57267-261">License acquisition URLs.</span></span>
4. <span data-ttu-id="57267-262">Player wordt een licentieaanvraag verkrijgen op basis van de browser Hallo/DRM die worden ondersteund.</span><span class="sxs-lookup"><span data-stu-id="57267-262">Player makes a license acquisition request based on hello browser/DRM supported.</span></span> <span data-ttu-id="57267-263">In het Hallo overname licentieaanvraag, sleutel-ID en Hallo JWT worden token ook verzonden.</span><span class="sxs-lookup"><span data-stu-id="57267-263">In hello license acquisition request, key ID and hello JWT token will also be submitted.</span></span> <span data-ttu-id="57267-264">Service voor het leveren van licenties controleert Hallo JWT-token en Hallo claims die zijn opgenomen voordat het verlenende Hallo licentie nodig.</span><span class="sxs-lookup"><span data-stu-id="57267-264">License delivery service will verify hello JWT token and hello claims contained before issuing hello needed license.</span></span>

## <a name="implementation"></a><span data-ttu-id="57267-265">Implementatie</span><span class="sxs-lookup"><span data-stu-id="57267-265">Implementation</span></span>
### <a name="implementation-procedures"></a><span data-ttu-id="57267-266">Procedures voor implementatie</span><span class="sxs-lookup"><span data-stu-id="57267-266">Implementation procedures</span></span>
<span data-ttu-id="57267-267">Hallo-implementatie bevat Hallo stappen te volgen:</span><span class="sxs-lookup"><span data-stu-id="57267-267">hello implementation will include hello following steps:</span></span>

1. <span data-ttu-id="57267-268">Test activa voorbereiden: een video test toomulti-bitrate coderen/pakket gefragmenteerd MP4 in Azure Media Services.</span><span class="sxs-lookup"><span data-stu-id="57267-268">Prepare test asset(s): encode/package a test video toomulti-bitrate fragmented MP4 in Azure Media Services.</span></span> <span data-ttu-id="57267-269">Dit asset is niet beveiligd door DRM.</span><span class="sxs-lookup"><span data-stu-id="57267-269">This asset is NOT DRM protected.</span></span> <span data-ttu-id="57267-270">DRM-beveiliging worden door dynamische beveiliging later uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="57267-270">DRM protection will be done by dynamic protection later.</span></span>
2. <span data-ttu-id="57267-271">Maken van sleutel-ID en inhoud sleutel (optioneel van sleutel seed).</span><span class="sxs-lookup"><span data-stu-id="57267-271">Create key ID and content key (optionally from key seed).</span></span> <span data-ttu-id="57267-272">Voor onze doel sleutelbeheersysteem is niet nodig omdat we zijn omgaan met slechts één set van sleutel-ID en sleutel voor een aantal test activa;</span><span class="sxs-lookup"><span data-stu-id="57267-272">For our purpose, key management system is not needed since we are dealing with only a single set of key ID and content key for a couple of test assets;</span></span>
3. <span data-ttu-id="57267-273">AMS API tooconfigure multi-DRM licentie levering van services voor Hallo test asset gebruiken.</span><span class="sxs-lookup"><span data-stu-id="57267-273">Use AMS API tooconfigure multi-DRM license delivery services for hello test asset.</span></span> <span data-ttu-id="57267-274">Als u aangepaste licentieservers door uw bedrijf of leveranciers van uw bedrijf in plaats van de licentie-services in Azure Media Services gebruikt, kunt u deze stap overslaan en licentie overname URL's in Hallo stap voor het configureren van de licentie levering opgeven.</span><span class="sxs-lookup"><span data-stu-id="57267-274">If you are using custom license servers by your company or your company’s vendors instead of license services in Azure Media Services, you can skip this step and specify license acquisition URLs in hello step for configuring license delivery.</span></span> <span data-ttu-id="57267-275">AMS API is benodigde toospecify sommige gedetailleerde configuraties, zoals autorisatie beleidsbeperking, licentie-antwoord sjablonen voor services van andere DRM-licenties, enzovoort. Op dit moment hello Azure-portal nog niet bieden Hallo gebruikersinterface nodig voor deze configuratie.</span><span class="sxs-lookup"><span data-stu-id="57267-275">AMS API is needed toospecify some detailed configurations, such as authorization policy restriction, license response templates for different DRM license services, etc. At this time, hello Azure portal does not yet provide hello needed UI for this configuration.</span></span> <span data-ttu-id="57267-276">U kunt zoeken naar API-niveau info en voorbeeldcode in Julia Kornich van document: [met behulp van PlayReady en/of Widevine Dynamic Common Encryption](media-services-protect-with-drm.md).</span><span class="sxs-lookup"><span data-stu-id="57267-276">You can find API level info and sample code in Julia Kornich’s document: [Using PlayReady and/or Widevine Dynamic Common Encryption](media-services-protect-with-drm.md).</span></span>
4. <span data-ttu-id="57267-277">Gebruik AMS API tooconfigure asset leveringsbeleid voor Hallo test asset.</span><span class="sxs-lookup"><span data-stu-id="57267-277">Use AMS API tooconfigure asset delivery policy for hello test asset.</span></span> <span data-ttu-id="57267-278">U kunt zoeken naar API-niveau info en voorbeeldcode in Julia Kornich van document: [met behulp van PlayReady en/of Widevine Dynamic Common Encryption](media-services-protect-with-drm.md).</span><span class="sxs-lookup"><span data-stu-id="57267-278">You can find API level info and sample code in Julia Kornich’s document: [Using PlayReady and/or Widevine Dynamic Common Encryption](media-services-protect-with-drm.md).</span></span>
5. <span data-ttu-id="57267-279">Maken en configureren van een Azure Active Directory-tenant in Azure.</span><span class="sxs-lookup"><span data-stu-id="57267-279">Create and configure an Azure Active Directory tenant in Azure;</span></span>
6. <span data-ttu-id="57267-280">Maken van een paar gebruikersaccounts en groepen in de Azure Active Directory-tenant: u moet ten minste maken 'EntitledUser' groeperen en een toothis gebruikersgroep toevoegen.</span><span class="sxs-lookup"><span data-stu-id="57267-280">Create a few user accounts and groups in your Azure Active Directory tenant: you should create at least “EntitledUser” group and add a user toothis group.</span></span> <span data-ttu-id="57267-281">Gebruikers in deze groep geeft recht controleren in de aanschaf van licentie en gebruikers die niet in deze groep toopass verificatieprocedure zal mislukken en zal niet kunnen tooacquire geen licentie.</span><span class="sxs-lookup"><span data-stu-id="57267-281">Users in this group will pass entitlement check in license acquisition and users not in this group will fail toopass authentication check and will not be able tooacquire any license.</span></span> <span data-ttu-id="57267-282">Een lid van deze groep 'EntitledUser' is een claim vereiste 'groepen' in hello JWT-token is uitgegeven door Azure AD.</span><span class="sxs-lookup"><span data-stu-id="57267-282">Being a member of this “EntitledUser” group is a required “groups” claim in hello JWT token issued by Azure AD.</span></span> <span data-ttu-id="57267-283">Deze vereiste claim moet worden opgegeven bij het configureren van multi-DRM licentie levering van services stap.</span><span class="sxs-lookup"><span data-stu-id="57267-283">This claim requirement should be specified in configuring multi-DRM license delivery services step.</span></span>
7. <span data-ttu-id="57267-284">Een ASP.NET MVC-app die als host de video-speler fungeert maken.</span><span class="sxs-lookup"><span data-stu-id="57267-284">Create an ASP.NET MVC app which will be hosting your video player.</span></span> <span data-ttu-id="57267-285">Deze ASP.NET-app worden beveiligd met gebruikersverificatie met hello Azure Active Directory-tenant.</span><span class="sxs-lookup"><span data-stu-id="57267-285">This ASP.NET app will be protected with user authentication against hello Azure Active Directory tenant.</span></span> <span data-ttu-id="57267-286">Juiste claims worden opgenomen in Hallo toegangstokens verkregen na verificatie van gebruiker.</span><span class="sxs-lookup"><span data-stu-id="57267-286">Proper claims will be included in hello access tokens obtained after user authentication.</span></span> <span data-ttu-id="57267-287">OpenID Connect API wordt aanbevolen voor deze stap.</span><span class="sxs-lookup"><span data-stu-id="57267-287">OpenID Connect API is recommended for this step.</span></span> <span data-ttu-id="57267-288">U moet tooinstall hello NuGet-pakketten te volgen:</span><span class="sxs-lookup"><span data-stu-id="57267-288">You need tooinstall hello following NuGet packages:</span></span>
   * <span data-ttu-id="57267-289">Install-Package Microsoft.Azure.ActiveDirectory.GraphClient</span><span class="sxs-lookup"><span data-stu-id="57267-289">Install-Package Microsoft.Azure.ActiveDirectory.GraphClient</span></span>
   * <span data-ttu-id="57267-290">Install-Package Microsoft.Owin.Security.OpenIdConnect</span><span class="sxs-lookup"><span data-stu-id="57267-290">Install-Package Microsoft.Owin.Security.OpenIdConnect</span></span>
   * <span data-ttu-id="57267-291">Install-Package Microsoft.Owin.Security.Cookies</span><span class="sxs-lookup"><span data-stu-id="57267-291">Install-Package Microsoft.Owin.Security.Cookies</span></span>
   * <span data-ttu-id="57267-292">Install-Package Microsoft.Owin.Host.SystemWeb</span><span class="sxs-lookup"><span data-stu-id="57267-292">Install-Package Microsoft.Owin.Host.SystemWeb</span></span>
   * <span data-ttu-id="57267-293">Install-Package Microsoft.IdentityModel.Clients.ActiveDirectory</span><span class="sxs-lookup"><span data-stu-id="57267-293">Install-Package Microsoft.IdentityModel.Clients.ActiveDirectory</span></span>
8. <span data-ttu-id="57267-294">Maken van een speler met [Azure Media Player-API](http://amp.azure.net/libs/amp/latest/docs/).</span><span class="sxs-lookup"><span data-stu-id="57267-294">Create a player using [Azure Media Player API](http://amp.azure.net/libs/amp/latest/docs/).</span></span> <span data-ttu-id="57267-295">[Azure Media-Player ProtectionInfo API](http://amp.azure.net/libs/amp/latest/docs/) kunt u toospecify welke toouse DRM-technologie op verschillende DRM-platform.</span><span class="sxs-lookup"><span data-stu-id="57267-295">[Azure Media Player’s ProtectionInfo API](http://amp.azure.net/libs/amp/latest/docs/) allows you toospecify which DRM technology toouse on different DRM platform.</span></span>
9. <span data-ttu-id="57267-296">Testmatrix:</span><span class="sxs-lookup"><span data-stu-id="57267-296">Test matrix:</span></span>

| <span data-ttu-id="57267-297">**DRM**</span><span class="sxs-lookup"><span data-stu-id="57267-297">**DRM**</span></span> | <span data-ttu-id="57267-298">**Browser**</span><span class="sxs-lookup"><span data-stu-id="57267-298">**Browser**</span></span> | <span data-ttu-id="57267-299">**Resultaat van het gebruiksrecht heeft gebruiker**</span><span class="sxs-lookup"><span data-stu-id="57267-299">**Result for Entitled User**</span></span> | <span data-ttu-id="57267-300">**Resultaat van de gebruiker niet gemachtigd**</span><span class="sxs-lookup"><span data-stu-id="57267-300">**Result for Un-entitled User**</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="57267-301">**PlayReady**</span><span class="sxs-lookup"><span data-stu-id="57267-301">**PlayReady**</span></span> |<span data-ttu-id="57267-302">MS rand of IE11 op Windows 10</span><span class="sxs-lookup"><span data-stu-id="57267-302">MS Edge or IE11 on Windows 10</span></span> |<span data-ttu-id="57267-303">Mislukt</span><span class="sxs-lookup"><span data-stu-id="57267-303">Succeed</span></span> |<span data-ttu-id="57267-304">Mislukt</span><span class="sxs-lookup"><span data-stu-id="57267-304">Fail</span></span> |
| <span data-ttu-id="57267-305">**Widevine**</span><span class="sxs-lookup"><span data-stu-id="57267-305">**Widevine**</span></span> |<span data-ttu-id="57267-306">Chrome op Windows 10</span><span class="sxs-lookup"><span data-stu-id="57267-306">Chrome on Windows 10</span></span> |<span data-ttu-id="57267-307">Mislukt</span><span class="sxs-lookup"><span data-stu-id="57267-307">Succeed</span></span> |<span data-ttu-id="57267-308">Mislukt</span><span class="sxs-lookup"><span data-stu-id="57267-308">Fail</span></span> |
| <span data-ttu-id="57267-309">**FairPlay**</span><span class="sxs-lookup"><span data-stu-id="57267-309">**FairPlay**</span></span> |<span data-ttu-id="57267-310">NOG TE BEPALEN</span><span class="sxs-lookup"><span data-stu-id="57267-310">TBD</span></span> | | |

<span data-ttu-id="57267-311">George Trifonov van Azure Media Services-Team blog gedetailleerde stappen bij het instellen van Azure Active Directory voor een ASP.NET MVC player-app die is geschreven: [integreren Azure Media Services OWIN MVC op basis van de app met Azure Active Directory en beperken van de sleutel inhouddistributie op basis van claims JWT](http://gtrifonov.com/2015/01/24/mvc-owin-azure-media-services-ad-integration/).</span><span class="sxs-lookup"><span data-stu-id="57267-311">George Trifonov of Azure Media Services Team has written a blog providing detailed steps in setting up Azure Active Directory for an ASP.NET MVC player app: [Integrate Azure Media Services OWIN MVC based app with Azure Active Directory and restrict content key delivery based on JWT claims](http://gtrifonov.com/2015/01/24/mvc-owin-azure-media-services-ad-integration/).</span></span>

<span data-ttu-id="57267-312">George heeft ook een blog geschreven op [JWT-token verificatie in Azure Media Services en dynamische versleuteling](http://gtrifonov.com/2015/01/03/jwt-token-authentication-in-azure-media-services-and-dynamic-encryption/).</span><span class="sxs-lookup"><span data-stu-id="57267-312">George has also written a blog on [JWT token Authentication in Azure Media Services and Dynamic Encryption](http://gtrifonov.com/2015/01/03/jwt-token-authentication-in-azure-media-services-and-dynamic-encryption/).</span></span> <span data-ttu-id="57267-313">Hier vindt hij [op Azure AD-integratie met Azure Media Services-sleutellevering](https://github.com/AzureMediaServicesSamples/Key-delivery-with-AAD-integration/).</span><span class="sxs-lookup"><span data-stu-id="57267-313">And here is his [sample on Azure AD integration with Azure Media Services key delivery](https://github.com/AzureMediaServicesSamples/Key-delivery-with-AAD-integration/).</span></span>

<span data-ttu-id="57267-314">Voor informatie over Azure Active Directory:</span><span class="sxs-lookup"><span data-stu-id="57267-314">For information on Azure Active Directory:</span></span>

* <span data-ttu-id="57267-315">U vindt informatie voor ontwikkelaars in [Azure Active Directory-handleiding voor ontwikkelaars](../active-directory/active-directory-developers-guide.md).</span><span class="sxs-lookup"><span data-stu-id="57267-315">You can find developer information in [Azure Active Directory Developer’s Guide](../active-directory/active-directory-developers-guide.md).</span></span>
* <span data-ttu-id="57267-316">U vindt informatie voor beheerders in [beheren van uw Azure AD-Directory](../active-directory/active-directory-administer.md).</span><span class="sxs-lookup"><span data-stu-id="57267-316">You can find administrator information in [Administer Your Azure AD Directory](../active-directory/active-directory-administer.md).</span></span>

### <a name="some-gotchas-in-implementation"></a><span data-ttu-id="57267-317">Sommige gotchas in uitvoering</span><span class="sxs-lookup"><span data-stu-id="57267-317">Some gotchas in implementation</span></span>
<span data-ttu-id="57267-318">Er zijn enkele 'gotchas' Hallo uitvoering.</span><span class="sxs-lookup"><span data-stu-id="57267-318">There are some “gotchas” in hello implementation.</span></span> <span data-ttu-id="57267-319">Ideale geval kunt volgt de lijst met 'gotchas' hello u het oplossen van problemen als u problemen ondervindt.</span><span class="sxs-lookup"><span data-stu-id="57267-319">Hopefully hello following list of “gotchas” can help you troubleshooting in case you run into issues.</span></span>

1. <span data-ttu-id="57267-320">**Certificaatverlener** URL moet eindigen met **'/'**.</span><span class="sxs-lookup"><span data-stu-id="57267-320">**Issuer** URL should end with **"/"**.</span></span>  

    <span data-ttu-id="57267-321">**Doelgroep** moet Hallo speler toepassing client-ID en moet u ook toevoegen **'/'** aan Hallo einde van de URL-verlener Hallo.</span><span class="sxs-lookup"><span data-stu-id="57267-321">**Audience** should be hello player application client ID and you should also add **"/"** at hello end of hello issuer URL.</span></span>

        <add key="ida:audience" value="[Application Client ID GUID]" />
        <add key="ida:issuer" value="https://sts.windows.net/[AAD Tenant ID]/" />

    <span data-ttu-id="57267-322">In [JWT Decoder](http://jwt.calebb.net/), ziet u **aud** en **iss** in Hallo JWT-token aan de onderstaande:</span><span class="sxs-lookup"><span data-stu-id="57267-322">In [JWT Decoder](http://jwt.calebb.net/), you should see **aud** and **iss** as below in hello JWT token:</span></span>

    ![1e gotcha](./media/media-services-cenc-with-multidrm-access-control/media-services-1st-gotcha.png)
2. <span data-ttu-id="57267-324">Machtigingen toohello toepassing in AAD toevoegen (op het tabblad configureren van de toepassing hello).</span><span class="sxs-lookup"><span data-stu-id="57267-324">Add Permissions toohello application in AAD (on Configure tab of hello application).</span></span> <span data-ttu-id="57267-325">Dit is vereist voor elke toepassing (lokale en geïmplementeerde versie).</span><span class="sxs-lookup"><span data-stu-id="57267-325">This is required for each application (local and deployed versions).</span></span>

    ![2e gotcha](./media/media-services-cenc-with-multidrm-access-control/media-services-perms-to-other-apps.png)
3. <span data-ttu-id="57267-327">Hallo rechts verlener bij het instellen van dynamische CENC beveiliging gebruiken:</span><span class="sxs-lookup"><span data-stu-id="57267-327">Use hello right issuer in setting up dynamic CENC protection:</span></span>

        <add key="ida:issuer" value="https://sts.windows.net/[AAD Tenant ID]/"/>

    <span data-ttu-id="57267-328">de volgende Hallo zal niet werken:</span><span class="sxs-lookup"><span data-stu-id="57267-328">hello following will not work:</span></span>

        <add key="ida:issuer" value="https://willzhanad.onmicrosoft.com/" />

    <span data-ttu-id="57267-329">Hallo GUID is Hallo AAD-tenant-ID.</span><span class="sxs-lookup"><span data-stu-id="57267-329">hello GUID is hello AAD tenant ID.</span></span> <span data-ttu-id="57267-330">Hallo GUID vindt u in de pop-up eindpunten in Azure-portal.</span><span class="sxs-lookup"><span data-stu-id="57267-330">hello GUID can be found in Endpoints popup in Azure portal.</span></span>
4. <span data-ttu-id="57267-331">Verleen het lidmaatschap van claims van bevoegdheden.</span><span class="sxs-lookup"><span data-stu-id="57267-331">Grant group membership claims privileges.</span></span> <span data-ttu-id="57267-332">Zorg ervoor dat in het manifestbestand van AAD-toepassing, we hebben de volgende Hallo</span><span class="sxs-lookup"><span data-stu-id="57267-332">Make sure in AAD application manifest file, we have hello following</span></span>

    <span data-ttu-id="57267-333">'groupMembershipClaims': 'All', (standaardwaarde Hallo is null)</span><span class="sxs-lookup"><span data-stu-id="57267-333">"groupMembershipClaims": "All",    (hello default value is null)</span></span>
5. <span data-ttu-id="57267-334">Juiste TokenType instellen bij het maken van de vereisten van de beperking.</span><span class="sxs-lookup"><span data-stu-id="57267-334">Setting proper TokenType when creating restriction requirements.</span></span>

        objTokenRestrictionTemplate.TokenType = TokenType.JWT;

    <span data-ttu-id="57267-335">Omdat het toevoegen van ondersteuning van JWT (AAD) bovendien tooSWT (ACS), is standaard Hallo TokenType TokenType.JWT.</span><span class="sxs-lookup"><span data-stu-id="57267-335">Since adding support of JWT (AAD) in addition tooSWT (ACS), hello default TokenType is TokenType.JWT.</span></span> <span data-ttu-id="57267-336">Als u SWT/ACS gebruikt, moet u tooTokenType.SWT instellen.</span><span class="sxs-lookup"><span data-stu-id="57267-336">If you use SWT/ACS, you must set tooTokenType.SWT.</span></span>

## <a name="additional-topics-for-implementation"></a><span data-ttu-id="57267-337">Aanvullende onderwerpen voor implementatie</span><span class="sxs-lookup"><span data-stu-id="57267-337">Additional Topics for Implementation</span></span>
<span data-ttu-id="57267-338">Naast we wordt naar de schijf uss sommige extra onderwerpen in onze ontwerpen en implementeren.</span><span class="sxs-lookup"><span data-stu-id="57267-338">Next we will disc uss some additional topics in our design and implementation.</span></span>

### <a name="http-or-https"></a><span data-ttu-id="57267-339">HTTP of HTTPS?</span><span class="sxs-lookup"><span data-stu-id="57267-339">HTTP or HTTPS?</span></span>
<span data-ttu-id="57267-340">Hallo ASP.NET MVC-spelertoepassing moesten moet Hallo volgende ondersteund:</span><span class="sxs-lookup"><span data-stu-id="57267-340">hello ASP.NET MVC player application we built must support hello following:</span></span>

1. <span data-ttu-id="57267-341">Gebruikersverificatie via Azure AD die toobe onder HTTPS moet;</span><span class="sxs-lookup"><span data-stu-id="57267-341">User authentication through Azure AD which needs toobe under HTTPS;</span></span>
2. <span data-ttu-id="57267-342">JWT-token exchange tussen client en Azure AD die toobe onder HTTPS moet;</span><span class="sxs-lookup"><span data-stu-id="57267-342">JWT token exchange between client and Azure AD which needs toobe under HTTPS;</span></span>
3. <span data-ttu-id="57267-343">DRM licentie overname door Hallo-client die vereist toobe onder HTTPS is als levering van de licentie wordt verstrekt door Azure Media Services.</span><span class="sxs-lookup"><span data-stu-id="57267-343">DRM license acquisition by hello client which is required toobe under HTTPS if license delivery is provided by Azure Media Services.</span></span> <span data-ttu-id="57267-344">Natuurlijk schrijft PlayReady productpakket niet voor HTTPS voor de levering van licentie.</span><span class="sxs-lookup"><span data-stu-id="57267-344">Of course, PlayReady product suite does not mandate HTTPS for license delivery.</span></span> <span data-ttu-id="57267-345">Als de licentieserver PlayReady buiten Azure Media Services is, kan via HTTP of HTTPS worden gebruikt.</span><span class="sxs-lookup"><span data-stu-id="57267-345">If your PlayReady license server is outside of Azure Media Services, either HTTP or HTTPS could be used.</span></span>

<span data-ttu-id="57267-346">Daarom wordt player-ASP.NET-toepassing hello HTTPS gebruikt als een best practice.</span><span class="sxs-lookup"><span data-stu-id="57267-346">Therefore, hello ASP.NET player application will use HTTPS as a best practice.</span></span> <span data-ttu-id="57267-347">Dit betekent dat hello die Azure Media Player uitgevoerd in een HTTPS-pagina worden.</span><span class="sxs-lookup"><span data-stu-id="57267-347">This means hello Azure Media Player will be on a page under HTTPS.</span></span> <span data-ttu-id="57267-348">Voor streaming we liever HTTP, dus moeten we tooconsider gemengde inhoud probleem.</span><span class="sxs-lookup"><span data-stu-id="57267-348">However, for streaming we prefer HTTP, hence we need tooconsider mixed content issue.</span></span>

1. <span data-ttu-id="57267-349">Browser kan geen gemengde inhoud.</span><span class="sxs-lookup"><span data-stu-id="57267-349">Browser does not allow mixed content.</span></span> <span data-ttu-id="57267-350">Maar invoegtoepassingen zoals Silverlight en OSMF-invoegtoepassing voor smooth en STREEPJES zijn toegestaan.</span><span class="sxs-lookup"><span data-stu-id="57267-350">But plugins like Silverlight and OSMF plugin for smooth and DASH allow.</span></span> <span data-ttu-id="57267-351">Gemengde inhoud is een beveiligingsprobleem - dit is vanwege toohello bedreiging van Hallo mogelijkheid tooinject Hallo schadelijke JS wat kan leiden tot klant gegevens toobe risico.</span><span class="sxs-lookup"><span data-stu-id="57267-351">Mixed content is a security concern - This is due toohello threat of hello ability tooinject malicious JS which can cause hello customer data toobe at risk.</span></span>  <span data-ttu-id="57267-352">Browsers dit standaard blokkeren en tot nu toe Hallo alleen manier toowork omheen heeft hello (oorsprong) serverzijde, tooallow alle domeinen (ongeacht https of http).</span><span class="sxs-lookup"><span data-stu-id="57267-352">Browsers block this by default and so far hello only way toowork around it is on hello server (origin) side, tooallow all domains (regardless https or http).</span></span> <span data-ttu-id="57267-353">Dit is waarschijnlijk niet een goed idee ofwel.</span><span class="sxs-lookup"><span data-stu-id="57267-353">This is probably not a good idea either.</span></span>
2. <span data-ttu-id="57267-354">Vermijd we gemengde inhoud: beide gebruik van HTTP of beide gebruik van HTTPS.</span><span class="sxs-lookup"><span data-stu-id="57267-354">We should avoid mixed content: either both use HTTP or both use HTTPS.</span></span> <span data-ttu-id="57267-355">Tijdens het afspelen van gemengde inhoud wordt silverlightSS tech vereist een gemengde inhoud waarschuwing uit te schakelen.</span><span class="sxs-lookup"><span data-stu-id="57267-355">When playing mixed content, silverlightSS tech requires clearing a mixed content warning.</span></span> <span data-ttu-id="57267-356">technische flashSS verwerkt gemengde inhoud zonder gemengde inhoud waarschuwing.</span><span class="sxs-lookup"><span data-stu-id="57267-356">flashSS tech handles mixed content without mixed content warning.</span></span>
3. <span data-ttu-id="57267-357">Als uw streaming-eindpunt is gemaakt voordat augustus 2014, wordt deze geen ondersteuning voor HTTPS.</span><span class="sxs-lookup"><span data-stu-id="57267-357">If your streaming endpoint was created before August 2014, it will not support HTTPS.</span></span> <span data-ttu-id="57267-358">In dit geval Maak en gebruik van een nieuwe streaming-eindpunt voor HTTPS.</span><span class="sxs-lookup"><span data-stu-id="57267-358">In this case, please create and use a new streaming endpoint for HTTPS.</span></span>

<span data-ttu-id="57267-359">In de implementatie van het Hallo-verwijzing, voor DRM beveiligde inhoud, zich toepassing en streaming onder HTTTPS.</span><span class="sxs-lookup"><span data-stu-id="57267-359">In hello reference implementation, for DRM protected contents, both application and streaming will be under HTTTPS.</span></span> <span data-ttu-id="57267-360">Voor open inhoud Hallo player hoeft niet verificatie of licentie, zodat u Hallo liberty toouse beide HTTP of HTTPS.</span><span class="sxs-lookup"><span data-stu-id="57267-360">For open contents, hello player does not need authentication or license, so you have hello liberty toouse either HTTP or HTTPS.</span></span>

### <a name="azure-active-directory-signing-key-rollover"></a><span data-ttu-id="57267-361">Azure Active Directory sleutelrollover ondertekenen</span><span class="sxs-lookup"><span data-stu-id="57267-361">Azure Active Directory signing key rollover</span></span>
<span data-ttu-id="57267-362">Dit is een belangrijk punt tootake in aanmerking voor de implementatie.</span><span class="sxs-lookup"><span data-stu-id="57267-362">This is an important point tootake into consideration of your implementation.</span></span> <span data-ttu-id="57267-363">Als u geen rekening dit in uw implementatie houden, niet Hallo voltooid system uiteindelijk meer volledig binnen maximaal 6 weken.</span><span class="sxs-lookup"><span data-stu-id="57267-363">If you do not consider this in your implementation, hello completed system will eventually stop working completely within at most 6 weeks.</span></span>

<span data-ttu-id="57267-364">Azure AD gebruikt bedrijfstak standaard tooestablish vertrouwensrelatie tussen zichzelf en toepassingen die gebruikmaken van Azure AD.</span><span class="sxs-lookup"><span data-stu-id="57267-364">Azure AD uses industry standard tooestablish trust between itself and applications using Azure AD.</span></span> <span data-ttu-id="57267-365">Azure AD gebruikt met name een ondertekeningssleutel die uit een openbare en persoonlijke sleutelpaar bestaat.</span><span class="sxs-lookup"><span data-stu-id="57267-365">Specifically, Azure AD uses a signing key that consists of a public and private key pair.</span></span> <span data-ttu-id="57267-366">Als u Azure AD maakt een beveiligingstoken dat informatie over Hallo gebruiker bevat, wordt dit token is ondertekend door Azure AD met behulp van de persoonlijke sleutel voordat deze terug toohello toepassing wordt verzonden.</span><span class="sxs-lookup"><span data-stu-id="57267-366">When Azure AD creates a security token that contains information about hello user, this token is signed by Azure AD using its private key before it is sent back toohello application.</span></span> <span data-ttu-id="57267-367">tooverify die Hallo token geldig is en daadwerkelijk oorsprong van Azure AD, Hallo toepassing hello-token handtekening met de Hallo openbare sleutel die worden weergegeven door Azure AD dat is opgenomen in het document met federatieve metagegevens Hallo-tenant moet valideren.</span><span class="sxs-lookup"><span data-stu-id="57267-367">tooverify that hello token is valid and actually originated from Azure AD, hello application must validate hello token’s signature using hello public key exposed by Azure AD that is contained in hello tenant’s federation metadata document.</span></span> <span data-ttu-id="57267-368">Deze openbare sleutel, en Hallo ondertekeningssleutel waarvan deze is afgeleid, is Hallo hetzelfde abonnement dat voor alle tenants in Azure AD gebruikt.</span><span class="sxs-lookup"><span data-stu-id="57267-368">This public key – and hello signing key from which it derives – is hello same one used for all tenants in Azure AD.</span></span>

<span data-ttu-id="57267-369">Gedetailleerde informatie over Azure AD-sleutelrollover vindt u in het Hallo-document: [belangrijke informatie over de overschakeling van de sleutel ondertekening in Azure AD](../active-directory/active-directory-signing-key-rollover.md).</span><span class="sxs-lookup"><span data-stu-id="57267-369">Detailed info on Azure AD key rollover can be found in hello document: [Important Information about Signing Key Rollover in Azure AD](../active-directory/active-directory-signing-key-rollover.md).</span></span>

<span data-ttu-id="57267-370">Tussen Hallo [openbaar / persoonlijk sleutelpaar](https://login.microsoftonline.com/common/discovery/keys/),</span><span class="sxs-lookup"><span data-stu-id="57267-370">Between hello [public-private key pair](https://login.microsoftonline.com/common/discovery/keys/),</span></span>

* <span data-ttu-id="57267-371">Hallo persoonlijke sleutel wordt gebruikt door Azure Active Directory-toogenerate JWT-token;</span><span class="sxs-lookup"><span data-stu-id="57267-371">hello private key is used by Azure Active Directory toogenerate a JWT token;</span></span>
* <span data-ttu-id="57267-372">Hallo openbare sleutel wordt gebruikt door een toepassing zoals DRM-Services voor het leveren van licenties in AMS tooverify hello JWT-token;</span><span class="sxs-lookup"><span data-stu-id="57267-372">hello public key is used by an application such as DRM License Delivery Services in AMS tooverify hello JWT token;</span></span>

<span data-ttu-id="57267-373">Voor beveiliging doel draait Azure Active Directory periodiek dit certificaat (elke 6 weken).</span><span class="sxs-lookup"><span data-stu-id="57267-373">For security purpose, Azure Active Directory rotates this certificate periodically (every 6 weeks).</span></span> <span data-ttu-id="57267-374">In geval van inbreuk op de beveiliging kan Hallo sleutelrollover elk gewenst moment optreden.</span><span class="sxs-lookup"><span data-stu-id="57267-374">In case of security breaches, hello key rollover can occur any time.</span></span> <span data-ttu-id="57267-375">Daarom moeten Hallo licentie levering van services in AMS tooupdate Hallo openbare sleutel gebruikt als Azure AD Hallo sleutelpaar draait, anders de verificatie van de token in AMS mislukt en er is geen licentie wordt verleend.</span><span class="sxs-lookup"><span data-stu-id="57267-375">Therefore, hello license delivery services in AMS need tooupdate hello public key used as Azure AD rotates hello key pair, otherwise token authentication in AMS will fail and no license will be issued.</span></span>

<span data-ttu-id="57267-376">Dit wordt bereikt door in te stellen TokenRestrictionTemplate.OpenIdConnectDiscoveryDocument bij het configureren van DRM-services voor het leveren van licenties.</span><span class="sxs-lookup"><span data-stu-id="57267-376">This is achieved by setting TokenRestrictionTemplate.OpenIdConnectDiscoveryDocument when configuring DRM license delivery services.</span></span>

<span data-ttu-id="57267-377">Hallo JWT-tokenstroom is als hieronder:</span><span class="sxs-lookup"><span data-stu-id="57267-377">hello JWT token flow is as below:</span></span>

1. <span data-ttu-id="57267-378">Azure AD geeft Hallo JWT-token met huidige Hallo persoonlijke sleutel voor een geverifieerde gebruiker;</span><span class="sxs-lookup"><span data-stu-id="57267-378">Azure AD will issue hello JWT token with hello current private key for an authenticated user;</span></span>
2. <span data-ttu-id="57267-379">Wanneer u een speler ziet een CENC met multi-DRM beveiligde inhoud, zoekt het eerst Hallo JWT-token is uitgegeven door Azure AD.</span><span class="sxs-lookup"><span data-stu-id="57267-379">When a player sees a CENC with multi-DRM protected content, it will first locate hello JWT token issued by Azure AD.</span></span>
3. <span data-ttu-id="57267-380">Hallo player verzendt overname licentieaanvraag met Hallo JWT-token toolicense levering van services in AMS;</span><span class="sxs-lookup"><span data-stu-id="57267-380">hello player sends license acquisition request with hello JWT token toolicense delivery services in AMS;</span></span>
4. <span data-ttu-id="57267-381">Hallo licentie levering van services in AMS gebruikt Hallo huidige/geldige openbare sleutel van Azure AD tooverify hello JWT-token, alvorens licenties.</span><span class="sxs-lookup"><span data-stu-id="57267-381">hello license delivery services in AMS will use hello current/valid public key from Azure AD tooverify hello JWT token, before issuing licenses.</span></span>

<span data-ttu-id="57267-382">DRM-services voor het leveren van licentie wordt altijd gecontroleerd of er Hallo huidige/geldige openbare sleutel van Azure AD.</span><span class="sxs-lookup"><span data-stu-id="57267-382">DRM license delivery services will always be checking for hello current/valid public key from Azure AD.</span></span> <span data-ttu-id="57267-383">Hallo openbare sleutel die wordt aangeboden door Azure AD worden Hallo-sleutel die wordt gebruikt voor het controleren van een JWT-token dat is uitgegeven door Azure AD.</span><span class="sxs-lookup"><span data-stu-id="57267-383">hello public key presented by Azure AD will be hello key used for verifying a JWT token issued by Azure AD.</span></span>

<span data-ttu-id="57267-384">Wat gebeurt er als Hallo sleutelrollover treedt op nadat de AAD JWT-token wordt gegenereerd, maar voordat Hallo JWT token is verzonden door spelers tooDRM licentie levering van services in AMS voor verificatie?</span><span class="sxs-lookup"><span data-stu-id="57267-384">What if hello key rollover happens after AAD generates a JWT token but before hello JWT token is sent by players tooDRM license delivery services in AMS for verification?</span></span>

<span data-ttu-id="57267-385">Omdat een sleutel wordt mogelijk teruggedraaid te allen tijde, is altijd meer dan één geldige openbare sleutel beschikbaar is in het document met federatieve metagegevens Hallo.</span><span class="sxs-lookup"><span data-stu-id="57267-385">Because a key may be rolled at any moment, there is always more than one valid public key available in hello federation metadata document.</span></span> <span data-ttu-id="57267-386">Azure Media Services-licentie levering kunt u elk Hallo sleutels opgegeven in Hallo document, omdat één sleutel, wordt mogelijk teruggedraaid binnenkort een andere kan worden de vervanging ervan, enzovoort.</span><span class="sxs-lookup"><span data-stu-id="57267-386">Azure Media Services license delivery can use any of hello keys specified in hello document, since one key may be rolled soon, another may be its replacement, and so forth.</span></span>

### <a name="where-is-hello-access-token"></a><span data-ttu-id="57267-387">Waar Hallo het Access Token is?</span><span class="sxs-lookup"><span data-stu-id="57267-387">Where is hello Access Token?</span></span>
<span data-ttu-id="57267-388">Als u kijken hoe een web-app een API-app onder aanroept [toepassingsidentiteit met OAuth 2.0-Client referenties Grant](../active-directory/develop/active-directory-authentication-scenarios.md#web-application-to-web-api), Hallo authenticatiestroom is als hieronder:</span><span class="sxs-lookup"><span data-stu-id="57267-388">If you look at how a web app calls an API app under [Application Identity with OAuth 2.0 Client Credentials Grant](../active-directory/develop/active-directory-authentication-scenarios.md#web-application-to-web-api), hello authentication flow is as below:</span></span>

1. <span data-ttu-id="57267-389">Een gebruiker is aangemeld in tooAzure AD in Hallo-webtoepassing (Zie Hallo [webbrowser tooWeb toepassing](../active-directory/develop/active-directory-authentication-scenarios.md#web-browser-to-web-application).</span><span class="sxs-lookup"><span data-stu-id="57267-389">A user is signed in tooAzure AD in hello web application (see hello [Web Browser tooWeb Application](../active-directory/develop/active-directory-authentication-scenarios.md#web-browser-to-web-application).</span></span>
2. <span data-ttu-id="57267-390">Hello Azure AD-autorisatie-eindpunt wordt omgeleid Hallo gebruiker agent back toohello client-toepassing met een autorisatiecode.</span><span class="sxs-lookup"><span data-stu-id="57267-390">hello Azure AD authorization endpoint redirects hello user agent back toohello client application with an authorization code.</span></span> <span data-ttu-id="57267-391">Hallo gebruikersagent retourneert autorisatie code toohello van de clienttoepassing omleidings-URI.</span><span class="sxs-lookup"><span data-stu-id="57267-391">hello user agent returns authorization code toohello client application’s redirect URI.</span></span>
3. <span data-ttu-id="57267-392">Hallo-webtoepassing moet een toegangstoken tooacquire zodat deze kan toohello web-API verifiëren en Hallo gewenst bron.</span><span class="sxs-lookup"><span data-stu-id="57267-392">hello web application needs tooacquire an access token so that it can authenticate toohello web API and retrieve hello desired resource.</span></span> <span data-ttu-id="57267-393">Er wordt een aanvraag tooAzure van AD-tokeneindpunt, Hallo referentie, client-ID en web-API van toepassings-ID-URI.</span><span class="sxs-lookup"><span data-stu-id="57267-393">It makes a request tooAzure AD’s token endpoint, providing hello credential, client ID, and web API’s application ID URI.</span></span> <span data-ttu-id="57267-394">Deze geeft Hallo autorisatie code tooprove die Hallo gebruiker heeft ingestemd.</span><span class="sxs-lookup"><span data-stu-id="57267-394">It presents hello authorization code tooprove that hello user has consented.</span></span>
4. <span data-ttu-id="57267-395">Azure AD verifieert Hallo-toepassing en een JWT-toegangstoken dat is gebruikt toocall Hallo web-API retourneert.</span><span class="sxs-lookup"><span data-stu-id="57267-395">Azure AD authenticates hello application and returns a JWT access token that is used toocall hello web API.</span></span>
5. <span data-ttu-id="57267-396">Via HTTPS gebruikt de webtoepassing Hallo Hallo JWT access token tooadd hello JWT-tekenreeks met een aanduiding 'Bearer' geretourneerd als Hallo autorisatie-header van Hallo aanvraag toohello web-API.</span><span class="sxs-lookup"><span data-stu-id="57267-396">Over HTTPS, hello web application uses hello returned JWT access token tooadd hello JWT string with a “Bearer” designation in hello Authorization header of hello request toohello web API.</span></span> <span data-ttu-id="57267-397">Hallo-web-API valideert vervolgens Hallo JWT-token en als validatie geslaagd is, retourneert Hallo resource gewenst.</span><span class="sxs-lookup"><span data-stu-id="57267-397">hello web API then validates hello JWT token, and if validation is successful, returns hello desired resource.</span></span>

<span data-ttu-id="57267-398">In deze stroom 'toepassings-id' vertrouwt Hallo web-API die Hallo web application Hallo geverifieerde gebruiker.</span><span class="sxs-lookup"><span data-stu-id="57267-398">In this “application identity” flow, hello web API trusts that hello web application authenticated hello user.</span></span> <span data-ttu-id="57267-399">Om deze reden wordt dit patroon van een vertrouwde subsysteem genoemd.</span><span class="sxs-lookup"><span data-stu-id="57267-399">For this reason, this pattern is called a trusted subsystem.</span></span> <span data-ttu-id="57267-400">Hallo [diagram op deze pagina](https://docs.microsoft.com/azure/active-directory/active-directory-protocols-oauth-code) wordt beschreven hoe de autorisatiecode stroom works verlenen.</span><span class="sxs-lookup"><span data-stu-id="57267-400">hello [diagram on this page](https://docs.microsoft.com/azure/active-directory/active-directory-protocols-oauth-code) describes how authorization code grant flow works.</span></span>

<span data-ttu-id="57267-401">In de overname van de licentie met tokenbeperking, we Hallo volgt hetzelfde patroon van de vertrouwde subsysteem.</span><span class="sxs-lookup"><span data-stu-id="57267-401">In license acquisition with token restriction, we are following hello same trusted subsystem pattern.</span></span> <span data-ttu-id="57267-402">En Hallo licentie leveringsservice in Azure Media Services Hallo web-API-resource, Hallo 'back-end voor resource' is een webtoepassing moet tooaccess.</span><span class="sxs-lookup"><span data-stu-id="57267-402">And hello license delivery service in Azure Media Services is hello web API resource, hello “backend resource” a web application needs tooaccess.</span></span> <span data-ttu-id="57267-403">Waar is dus Hallo toegangstoken?</span><span class="sxs-lookup"><span data-stu-id="57267-403">So where is hello access token?</span></span>

<span data-ttu-id="57267-404">We zijn immers toegangstoken ophalen uit Azure AD.</span><span class="sxs-lookup"><span data-stu-id="57267-404">Indeed, we are obtaining access token from Azure AD.</span></span> <span data-ttu-id="57267-405">Na een geslaagde verificatie, wordt autorisatiecode geretourneerd.</span><span class="sxs-lookup"><span data-stu-id="57267-405">After successful user authentication, authorization code is returned.</span></span> <span data-ttu-id="57267-406">Hallo autorisatiecode wordt vervolgens gebruikt samen met client-ID en app sleutel tooexchange toegangstoken.</span><span class="sxs-lookup"><span data-stu-id="57267-406">hello authorization code is then used, together with client ID and app key, tooexchange for access token.</span></span> <span data-ttu-id="57267-407">En Hallo toegangstoken voor toegang tot een 'aanwijzer' toepassing verwijst of vertegenwoordiging van Azure Media Services-service voor het leveren van licenties.</span><span class="sxs-lookup"><span data-stu-id="57267-407">And hello access token is for accessing a “pointer” application pointing or representing Azure Media Services license delivery service.</span></span>

<span data-ttu-id="57267-408">We moeten tooregister en Hallo 'aanwijzer' app in Azure AD configureren door Hallo onderstaande stappen te volgen:</span><span class="sxs-lookup"><span data-stu-id="57267-408">We need tooregister and configure hello “pointer” app in Azure AD by following hello steps below:</span></span>

1. <span data-ttu-id="57267-409">In hello Azure AD-tenant</span><span class="sxs-lookup"><span data-stu-id="57267-409">In hello Azure AD tenant</span></span>

   * <span data-ttu-id="57267-410">een toepassing (resource) met de aanmeldings-URL toevoegen:</span><span class="sxs-lookup"><span data-stu-id="57267-410">add an application (resource) with sign-on URL:</span></span>

   <span data-ttu-id="57267-411">https://[resource_name].azurewebsites.NET/ en</span><span class="sxs-lookup"><span data-stu-id="57267-411">https://[resource_name].azurewebsites.net/ and</span></span>

   * <span data-ttu-id="57267-412">App-ID-URL:</span><span class="sxs-lookup"><span data-stu-id="57267-412">app ID URL:</span></span>

   <span data-ttu-id="57267-413">https://[aad_tenant_name].onmicrosoft.com/[resource_name];</span><span class="sxs-lookup"><span data-stu-id="57267-413">https://[aad_tenant_name].onmicrosoft.com/[resource_name];</span></span>
2. <span data-ttu-id="57267-414">Voeg een nieuwe sleutel voor Hallo resource-app</span><span class="sxs-lookup"><span data-stu-id="57267-414">Add a new key for hello resource app;</span></span>
3. <span data-ttu-id="57267-415">Hallo app manifestbestand bijwerken zodat Hallo groupMembershipClaims eigenschap heeft Hallo volgende waarde: 'groupMembershipClaims': 'All',</span><span class="sxs-lookup"><span data-stu-id="57267-415">Update hello app manifest file so that hello groupMembershipClaims property has hello following value: "groupMembershipClaims": "All",</span></span>  
4. <span data-ttu-id="57267-416">Toevoegen in hello Azure AD-app wijst toohello player web-app in Hallo sectie 'machtigingen tooother toepassingen' Hallo resource-app die is toegevoegd in stap 1 hierboven.</span><span class="sxs-lookup"><span data-stu-id="57267-416">In hello Azure AD app pointing toohello player web app, in hello section “permissions tooother applications”, add hello resource app which was added in step 1 above.</span></span> <span data-ttu-id="57267-417">Controleer onder 'gemachtigd' vinkje 'Toegang [resource_name]'.</span><span class="sxs-lookup"><span data-stu-id="57267-417">Under “delegated permissions” check “Access [resource_name]” checkmark.</span></span> <span data-ttu-id="57267-418">Hiermee geeft u Hallo web-app-machtiging toocreate toegangstokens voor toegang tot Hallo resource app.</span><span class="sxs-lookup"><span data-stu-id="57267-418">This gives hello web app permission toocreate access tokens for accessing hello resource app.</span></span> <span data-ttu-id="57267-419">U moet dit doen voor zowel lokale als geïmplementeerde versie van Hallo web-app als u met Visual Studio en Azure-web-app ontwikkelt.</span><span class="sxs-lookup"><span data-stu-id="57267-419">You should do this for both local and deployed version of hello web app if you are developing with Visual Studio and Azure web app.</span></span>

<span data-ttu-id="57267-420">Hallo JWT-token is uitgegeven door Azure AD is daarom inderdaad Hallo toegangstoken voor toegang tot deze resource 'aanwijzer'.</span><span class="sxs-lookup"><span data-stu-id="57267-420">Therefore, hello JWT token issued by Azure AD is indeed hello access token for accessing this “pointer” resource.</span></span>

### <a name="what-about-live-streaming"></a><span data-ttu-id="57267-421">Wat vindt Live Streaming?</span><span class="sxs-lookup"><span data-stu-id="57267-421">What about Live Streaming?</span></span>
<span data-ttu-id="57267-422">In bovenstaande Hallo, heeft onze bespreking is gericht op activa op aanvraag.</span><span class="sxs-lookup"><span data-stu-id="57267-422">In hello above, our discussion has been focusing on on-demand assets.</span></span> <span data-ttu-id="57267-423">Wat vindt live streamen?</span><span class="sxs-lookup"><span data-stu-id="57267-423">What about live streaming?</span></span>

<span data-ttu-id="57267-424">Hallo goed nieuws is waarmee u precies kunt dezelfde ontwerpen en implementeren voor het beveiligen van live streamen in Azure Media Services door te behandelen Hallo asset die zijn gekoppeld aan een programma als een 'VOD-activum' Hallo.</span><span class="sxs-lookup"><span data-stu-id="57267-424">hello good news is that you can use exactly hello same design and implementation for protecting live streaming in Azure Media Services, by treating hello asset associated with a program as a “VOD asset”.</span></span>

<span data-ttu-id="57267-425">Het is met name bekend dat toodo live streamen in Azure Media Services, moet u toocreate een kanaal en vervolgens een programma onder Hallo-kanaal.</span><span class="sxs-lookup"><span data-stu-id="57267-425">Specifically, it is well known that toodo live streaming in Azure Media Services, you need toocreate a channel, then a program under hello channel.</span></span> <span data-ttu-id="57267-426">toocreate hello programma, moet u toocreate een asset die Hallo live archief voor Hallo programma zal bevatten.</span><span class="sxs-lookup"><span data-stu-id="57267-426">toocreate hello program, you need toocreate an asset which will contain hello live archive for hello program.</span></span> <span data-ttu-id="57267-427">In de volgorde tooprovide CENC met multi-DRM bescherming van Hallo live-inhoud, hoeft u toodo, is tooapply Hallo dezelfde setup/verwerking toohello asset alsof het een activum' VOD' voordat u Hallo programma start.</span><span class="sxs-lookup"><span data-stu-id="57267-427">In order tooprovide CENC with multi-DRM protection of hello live content, all you need toodo, is tooapply hello same setup/processing toohello asset as if it was a “VOD asset” before you start hello program.</span></span>

### <a name="what-about-license-servers-outside-of-azure-media-services"></a><span data-ttu-id="57267-428">Hoe zit het licentieservers buiten Azure Media Services?</span><span class="sxs-lookup"><span data-stu-id="57267-428">What about license servers outside of Azure Media Services?</span></span>
<span data-ttu-id="57267-429">Vaak kunnen klanten hebben geïnvesteerd in licentie server-farm zich in hun eigen gegevens centreren of gehost door DRM-providers.</span><span class="sxs-lookup"><span data-stu-id="57267-429">Often, customers may have invested in license server farm either in their own data center or hosted by DRM service providers.</span></span> <span data-ttu-id="57267-430">Gelukkig Azure Media Services Content Protection kunt u toooperate in de modus voor hybride: inhoud gehost en dynamisch in Azure Media Services beveiligd terwijl DRM-licenties worden geleverd door servers buiten Azure Media Services.</span><span class="sxs-lookup"><span data-stu-id="57267-430">Fortunately, Azure Media Services Content Protection allows you toooperate in hybrid mode: contents hosted and dynamically protected in Azure Media Services, while DRM licenses are delivered by servers outside Azure Media Services.</span></span> <span data-ttu-id="57267-431">Er zijn in dit geval Hallo van wijzigingen te volgen:</span><span class="sxs-lookup"><span data-stu-id="57267-431">In this case, there are hello following considerations of changes:</span></span>

1. <span data-ttu-id="57267-432">Hallo Secure Token Service behoeften tooissue tokens die worden geaccepteerd en kunnen worden gecontroleerd door Hallo licentie server-farm.</span><span class="sxs-lookup"><span data-stu-id="57267-432">hello Secure Token Service needs tooissue tokens which are acceptable and can be verified by hello license server farm.</span></span> <span data-ttu-id="57267-433">Widevine-licentieservers Hallo geleverd door Axinom vereist bijvoorbeeld een JWT-token die "recht bericht" bevat.</span><span class="sxs-lookup"><span data-stu-id="57267-433">For example, hello Widevine license servers provided by Axinom requires a specific JWT token which contains “entitlement message”.</span></span> <span data-ttu-id="57267-434">Daarom moet u een STS tooissue toohave dergelijke JWT-token.</span><span class="sxs-lookup"><span data-stu-id="57267-434">Therefore, you need toohave an STS tooissue such JWT token.</span></span> <span data-ttu-id="57267-435">Hallo auteurs een dergelijke implementatie hebt voltooid en u kunt Hallo details vinden in het document in volgende Hallo [documentatiecentrum van Azure](https://azure.microsoft.com/documentation/): [met behulp van Axinom toodeliver Widevine-licenties tooAzure Media Services](media-services-axinom-integration.md).</span><span class="sxs-lookup"><span data-stu-id="57267-435">hello authors have completed such an implementation and you can find hello details in hello following document in [Azure Documentation Center](https://azure.microsoft.com/documentation/): [Using Axinom toodeliver Widevine licenses tooAzure Media Services](media-services-axinom-integration.md).</span></span>
2. <span data-ttu-id="57267-436">U hoeft niet meer tooconfigure license levering-service (ContentKeyAuthorizationPolicy) in Azure Media Services.</span><span class="sxs-lookup"><span data-stu-id="57267-436">You no longer need tooconfigure license delivery service (ContentKeyAuthorizationPolicy) in Azure Media Services.</span></span> <span data-ttu-id="57267-437">Wat u moet toodo is tooprovide Hallo licentie overname URL's (voor PlayReady, Widevine en FairPlay) wanneer u AssetDeliveryPolicy bij het instellen van CENC met multi-DRM configureert.</span><span class="sxs-lookup"><span data-stu-id="57267-437">What you need toodo is tooprovide hello license acquisition URLs (for PlayReady, Widevine and FairPlay) when you configure AssetDeliveryPolicy in setting up CENC with multi-DRM.</span></span>

### <a name="what-if-i-want-toouse-a-custom-sts"></a><span data-ttu-id="57267-438">Wat gebeurt er als ik wil een aangepaste STS toouse?</span><span class="sxs-lookup"><span data-stu-id="57267-438">What if I want toouse a custom STS?</span></span>
<span data-ttu-id="57267-439">Er zijn een aantal oorzaken hebben die een klant toouse een aangepaste STS (Secure Token Service kunt) voor het ontwikkelen van JWT-tokens.</span><span class="sxs-lookup"><span data-stu-id="57267-439">There could be a few reasons that a customer may choose toouse a custom STS (Secure Token Service) for providing JWT tokens.</span></span> <span data-ttu-id="57267-440">Sommige hiervan zijn:</span><span class="sxs-lookup"><span data-stu-id="57267-440">Some of them are:</span></span>

1. <span data-ttu-id="57267-441">Hallo identiteit Provider (IDP) die wordt gebruikt door de klant Hallo biedt geen ondersteuning voor STS.</span><span class="sxs-lookup"><span data-stu-id="57267-441">hello Identity Provider (IDP) used by hello customer does not support STS.</span></span> <span data-ttu-id="57267-442">In dit geval een aangepaste STS mogelijk een optie.</span><span class="sxs-lookup"><span data-stu-id="57267-442">In this case a custom STS may be an option.</span></span>
2. <span data-ttu-id="57267-443">Hallo-klant moet mogelijk meer flexibele of strikter besturingselement in STS met van klant abonnee factureringssysteem integreren.</span><span class="sxs-lookup"><span data-stu-id="57267-443">hello customer may need more flexible or tighter control in integrating STS with customer’s subscriber billing system.</span></span> <span data-ttu-id="57267-444">Bijvoorbeeld, een operator MVPD mogelijk meerdere OTT abonnee pakketten bieden zoals premium, basic, sport, enzovoort Hallo operator desgewenst toomatch Hallo claims in een token met een abonnee pakket zodat alleen de inhoud in de juiste pakket Hallo beschikbaar wordt gesteld.</span><span class="sxs-lookup"><span data-stu-id="57267-444">For example, an MVPD operator may offer multiple OTT subscriber packages such as premium, basic, sports, etc. hello operator may want toomatch hello claims in a token with a subscriber’s package so that only contents in hello right package is made available.</span></span> <span data-ttu-id="57267-445">In dit geval een aangepaste STS biedt Hallo flexibiliteit en meer controle nodig.</span><span class="sxs-lookup"><span data-stu-id="57267-445">In this case, a custom STS provides hello needed flexibility and control.</span></span>

<span data-ttu-id="57267-446">Twee wijzigingen moeten nemen wanneer u met een aangepaste STS toobe:</span><span class="sxs-lookup"><span data-stu-id="57267-446">Two changes need toobe made when using a custom STS:</span></span>

1. <span data-ttu-id="57267-447">Wanneer u service voor het leveren van licenties voor een asset configureert, moet u toospecify Hallo-beveiligingssleutel gebruikt voor verificatie door Hallo aangepaste STS (meer details hieronder) in plaats van de huidige sleutel Hallo van Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="57267-447">When configuring license delivery service for an asset, you need toospecify hello security key used for verification by hello custom STS (more details below) instead of hello current key from Azure Active Directory.</span></span>
2. <span data-ttu-id="57267-448">Wanneer een JTW-token wordt gegenereerd, wordt een beveiligingssleutel is opgegeven in plaats van Hallo persoonlijke sleutel van het certificaat van de huidige X509 Hallo in Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="57267-448">When a JTW token is generated, a security key is specified instead of hello private key of hello current X509 certificate in Azure Active Directory.</span></span>

<span data-ttu-id="57267-449">Er zijn twee soorten beveiligingssleutels:</span><span class="sxs-lookup"><span data-stu-id="57267-449">There are two types of security keys:</span></span>

1. <span data-ttu-id="57267-450">Symmetrische sleutel: Hallo dezelfde sleutel wordt gebruikt voor zowel genereren en controleren van een JWT-token</span><span class="sxs-lookup"><span data-stu-id="57267-450">Symmetric key: hello same key is used for both generating and verifying a JWT token;</span></span>
2. <span data-ttu-id="57267-451">Asymmetrische sleutel: een openbaar / persoonlijk sleutelpaar in een X509 certificaat met persoonlijke sleutel voor het versleutelen/genereren van een JWT-token en Hallo openbare sleutel voor het controleren van Hallo-token wordt gebruikt.</span><span class="sxs-lookup"><span data-stu-id="57267-451">Asymmetric key: a public-private key pair in an X509 certificate is used with private key for encrypting/generating a JWT token and hello public key for verifying hello token.</span></span>

#### <a name="tech-note"></a><span data-ttu-id="57267-452">Technische opmerking</span><span class="sxs-lookup"><span data-stu-id="57267-452">Tech note</span></span>
<span data-ttu-id="57267-453">Als u gebruikmaakt van .NET Framework / C# als uw ontwikkelplatform Hallo X509 certificaat dat wordt gebruikt voor asymmetrische beveiligingssleutel sleutellengte ten minste 2048 moet hebben.</span><span class="sxs-lookup"><span data-stu-id="57267-453">If you use .NET Framework/C# as your development platform, hello X509 certificate used for asymmetric security key must have key length at least 2048.</span></span> <span data-ttu-id="57267-454">Dit is een vereiste van Hallo klasse System.IdentityModel.Tokens.X509AsymmetricSecurityKey in .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="57267-454">This is a requirement of hello class System.IdentityModel.Tokens.X509AsymmetricSecurityKey in .NET Framework.</span></span> <span data-ttu-id="57267-455">Anders Hallo volgende uitzondering gegenereerd:</span><span class="sxs-lookup"><span data-stu-id="57267-455">Otherwise, hello following exception will be thrown:</span></span>

<span data-ttu-id="57267-456">IDX10630: Hallo 'System.IdentityModel.Tokens.X509AsymmetricSecurityKey' voor het ondertekenen van mag niet kleiner dan '2048-bits zijn.</span><span class="sxs-lookup"><span data-stu-id="57267-456">IDX10630: hello 'System.IdentityModel.Tokens.X509AsymmetricSecurityKey' for signing cannot be smaller than '2048' bits.</span></span>

## <a name="hello-completed-system-and-test"></a><span data-ttu-id="57267-457">Hallo voltooid systeem en testen</span><span class="sxs-lookup"><span data-stu-id="57267-457">hello completed system and test</span></span>
<span data-ttu-id="57267-458">We doorlopen enkele scenario's in de end-to-end-systeem Hallo voltooid zodat lezers een eenvoudige 'afbeelding' hello gedrag hebben kunnen voordat u een aanmeldingsaccount.</span><span class="sxs-lookup"><span data-stu-id="57267-458">We will walk through a few scenarios in hello completed end-to-end system so that readers can have a basic “picture” of hello behavior before getting a login account.</span></span>

<span data-ttu-id="57267-459">Hallo player-webtoepassing en de aanmelding vindt [hier](https://openidconnectweb.azurewebsites.net/).</span><span class="sxs-lookup"><span data-stu-id="57267-459">hello player web application and its login can be found [here](https://openidconnectweb.azurewebsites.net/).</span></span>

<span data-ttu-id="57267-460">Als wat u moet 'niet geïntegreerde' scenario: video activa gehost in Azure Media Services welke zijn ofwel niet zijn beveiligd of DRM beveiligde maar zonder tokenverificatie (uitgeven van een licentie toowhoever aangevraagd), kunt u deze testen zonder aanmelding (door het overschakelen tooHTTP als uw videostreaming via HTTP).</span><span class="sxs-lookup"><span data-stu-id="57267-460">If what you need is “non-integrated” scenario: video assets hosted in Azure Media Services which are either unprotected, or DRM protected but without token authentication (issuing a license toowhoever requesting it), you can test it without login (by switching tooHTTP if your video streaming is over HTTP).</span></span>

<span data-ttu-id="57267-461">Als wat u moet de geïntegreerde scenario end-to-end: video activa ligt onder de dynamische DRM-beveiliging in Azure Media Services met tokenverificatie en JWT-token wordt gegenereerd door Azure AD, moet u toologin.</span><span class="sxs-lookup"><span data-stu-id="57267-461">If what you need is end-to-end integrated scenario: video assets is under dynamic DRM protection in Azure Media Services, with token authentication and JWT token being generated by Azure AD, you need toologin.</span></span>

### <a name="user-login"></a><span data-ttu-id="57267-462">Gebruikersaanmelding</span><span class="sxs-lookup"><span data-stu-id="57267-462">User login</span></span>
<span data-ttu-id="57267-463">In de volgorde tootest Hallo end-to-end geïntegreerde DRM-systeem moet u toohave een 'account' gemaakt of toegevoegd.</span><span class="sxs-lookup"><span data-stu-id="57267-463">In order tootest hello end-to-end integrated DRM system, you need toohave an “account” created or added.</span></span>

<span data-ttu-id="57267-464">Welk account?</span><span class="sxs-lookup"><span data-stu-id="57267-464">What account?</span></span>

<span data-ttu-id="57267-465">Hoewel Azure oorspronkelijk alleen toegang verleende aan Microsoft-accountgebruikers, staat deze nu toegang verleend aan gebruikers van beide systemen.</span><span class="sxs-lookup"><span data-stu-id="57267-465">Although Azure originally allowed access only by Microsoft account users, it now allows access by users from both systems.</span></span> <span data-ttu-id="57267-466">Dit wordt mogelijk gemaakt doordat alle hello Azure eigenschappen vertrouwensrelatie Azure AD voor de verificatie door Azure AD bedrijfsgebruikers en door een federatieve relatie te maken waarin Azure AD Hallo Microsoft-account klantidentiteitssysteem vertrouwensrelaties gebruikers van de consument tooauthenticate.</span><span class="sxs-lookup"><span data-stu-id="57267-466">This was done by having all hello Azure properties trust Azure AD for authentication, having Azure AD authenticate organizational users, and by creating a federation relationship where Azure AD trusts hello Microsoft account consumer identity system tooauthenticate consumer users.</span></span> <span data-ttu-id="57267-467">Azure AD is als gevolg hiervan kunnen tooauthenticate ' Microsoft-gastaccounts als 'systeemeigen' Azure AD-accounts.</span><span class="sxs-lookup"><span data-stu-id="57267-467">As a result, Azure AD is able tooauthenticate “guest” Microsoft accounts as well as “native” Azure AD accounts.</span></span>

<span data-ttu-id="57267-468">Omdat Azure AD wordt vertrouwd domein van de Microsoft-Account (MSA), kunt u de accounts vanaf elke Hallo na domeinen toohello aangepaste Azure AD-tenant en Hallo account toologin gebruiken kunt toevoegen:</span><span class="sxs-lookup"><span data-stu-id="57267-468">Since Azure AD trusts Microsoft Account (MSA) domain, you can add any accounts from any of hello following domains toohello custom Azure AD tenant and use hello account toologin:</span></span>

| <span data-ttu-id="57267-469">**Domeinnaam**</span><span class="sxs-lookup"><span data-stu-id="57267-469">**Domain Name**</span></span> | <span data-ttu-id="57267-470">**Domein**</span><span class="sxs-lookup"><span data-stu-id="57267-470">**Domain**</span></span> |
| --- | --- |
| <span data-ttu-id="57267-471">**Domein van de aangepaste Azure AD-tenant**</span><span class="sxs-lookup"><span data-stu-id="57267-471">**Custom Azure AD tenant domain**</span></span> |<span data-ttu-id="57267-472">somename.onmicrosoft.com</span><span class="sxs-lookup"><span data-stu-id="57267-472">somename.onmicrosoft.com</span></span> |
| <span data-ttu-id="57267-473">**Bedrijfsdomein**</span><span class="sxs-lookup"><span data-stu-id="57267-473">**Corporate domain**</span></span> |<span data-ttu-id="57267-474">Microsoft.com</span><span class="sxs-lookup"><span data-stu-id="57267-474">microsoft.com</span></span> |
| <span data-ttu-id="57267-475">**Microsoft-Account (MSA)-domein**</span><span class="sxs-lookup"><span data-stu-id="57267-475">**Microsoft Account (MSA) domain**</span></span> |<span data-ttu-id="57267-476">Outlook.com, live.com, hotmail.com</span><span class="sxs-lookup"><span data-stu-id="57267-476">outlook.com, live.com, hotmail.com</span></span> |

<span data-ttu-id="57267-477">U kunt contact opnemen met een van de Hallo auteurs toohave een account te maken of toegevoegd voor u.</span><span class="sxs-lookup"><span data-stu-id="57267-477">You may contact any of hello authors toohave an account created or added for you.</span></span>

<span data-ttu-id="57267-478">Hieronder vindt u Hallo schermopnamen van verschillende aanmeldingspagina's die worden gebruikt door andere domeinaccounts.</span><span class="sxs-lookup"><span data-stu-id="57267-478">Below are hello screenshots of different login pages used by different domain accounts.</span></span>

<span data-ttu-id="57267-479">**Aangepaste Azure AD-tenant domeinaccount**: In dit geval wordt er aangepaste aanmeldingspagina Hallo van Hallo aangepaste Azure AD-tenant-domein.</span><span class="sxs-lookup"><span data-stu-id="57267-479">**Custom Azure AD tenant domain account**: In this case, you see hello customized login page of hello custom Azure AD tenant domain.</span></span>

![Aangepaste Azure AD-tenant domeinaccount](./media/media-services-cenc-with-multidrm-access-control/media-services-ad-tenant-domain1.png)

<span data-ttu-id="57267-481">**Microsoft-domeinaccount met smartcard**: In dit geval er Hallo-aanmeldingspagina is aangepast door Microsoft zakelijke IT-medewerkers met tweeledige verificatie.</span><span class="sxs-lookup"><span data-stu-id="57267-481">**Microsoft domain account with smart card**: In this case you see hello login page customized by Microsoft corporate IT with two-factor authentication.</span></span>

![Aangepaste Azure AD-tenant domeinaccount](./media/media-services-cenc-with-multidrm-access-control/media-services-ad-tenant-domain2.png)

<span data-ttu-id="57267-483">**Microsoft-Account (MSA)**: In dit geval ziet u de aanmeldingspagina Hallo van Microsoft-Account voor consumenten.</span><span class="sxs-lookup"><span data-stu-id="57267-483">**Microsoft Account (MSA)**: In this case, you see hello login page of Microsoft Account for consumers.</span></span>

![Aangepaste Azure AD-tenant domeinaccount](./media/media-services-cenc-with-multidrm-access-control/media-services-ad-tenant-domain3.png)

### <a name="using-encrypted-media-extensions-for-playready"></a><span data-ttu-id="57267-485">Versleutelde Media-extensies gebruiken voor PlayReady</span><span class="sxs-lookup"><span data-stu-id="57267-485">Using Encrypted Media Extensions for PlayReady</span></span>
<span data-ttu-id="57267-486">Hallo op een moderne browser met versleuteld Media extensies (EME) voor ondersteuning, zoals Internet Explorer 11 op Windows 8.1 en omhoog en Microsoft Edge-browser op Windows 10, PlayReady PlayReady DRM onderliggende voor EME.</span><span class="sxs-lookup"><span data-stu-id="57267-486">On a modern browser with Encrypted Media Extensions (EME) for PlayReady support, such as IE 11 on Windows 8.1 and up, and Microsoft Edge browser on Windows 10, PlayReady will be hello underlying DRM for EME.</span></span>

![Met behulp van EME voor PlayReady](./media/media-services-cenc-with-multidrm-access-control/media-services-eme-for-playready1.png)

<span data-ttu-id="57267-488">Hallo donker player gebied is vanwege toohello feit PlayReady beveiliging voorkomt dat een schermopname van beveiligde video aanbrengen.</span><span class="sxs-lookup"><span data-stu-id="57267-488">hello dark player area is due toohello fact that PlayReady protection prevents one from making screen capture of protected video.</span></span>

<span data-ttu-id="57267-489">Hallo toont volgende scherm Hallo player-invoegtoepassingen en muis/EME ondersteuning.</span><span class="sxs-lookup"><span data-stu-id="57267-489">hello following screen shows hello player plugins and MSE/EME support.</span></span>

![Met behulp van EME voor PlayReady](./media/media-services-cenc-with-multidrm-access-control/media-services-eme-for-playready2.png)

<span data-ttu-id="57267-491">EME in de Microsoft Edge en Internet Explorer 11 op Windows 10 kunt aanroepen van [PlayReady SL3000](https://www.microsoft.com/playready/features/EnhancedContentProtection.aspx/) op Windows 10-apparaten die dit ondersteunen.</span><span class="sxs-lookup"><span data-stu-id="57267-491">EME in Microsoft Edge and IE 11 on Windows 10 allows invoking of [PlayReady SL3000](https://www.microsoft.com/playready/features/EnhancedContentProtection.aspx/) on Windows 10 devices which support it.</span></span> <span data-ttu-id="57267-492">PlayReady SL3000 ontgrendelt Hallo stroom van de inhoud van de uitgebreide premium (4K, Kopregel, enzovoort) en nieuwe inhoud leveringsmodel (vroege venster voor verbeterde inhoud).</span><span class="sxs-lookup"><span data-stu-id="57267-492">PlayReady SL3000 unlocks hello flow of enhanced premium content (4K, HDR, etc.) and new content delivery models (early window for Enhanced Content).</span></span>

<span data-ttu-id="57267-493">Ligt de nadruk op apparaten met Windows hello: PlayReady is Hallo alleen DRM in Hallo HW beschikbaar op Windows-apparaten (PlayReady SL3000).</span><span class="sxs-lookup"><span data-stu-id="57267-493">Focus on hello Windows devices: PlayReady is hello only DRM in hello HW available on Windows devices (PlayReady SL3000).</span></span> <span data-ttu-id="57267-494">Een streaming-service met PlayReady via EME of via een UWP-toepassing en bieden een hogere videokwaliteit met PlayReady SL3000 dan een andere DRM.</span><span class="sxs-lookup"><span data-stu-id="57267-494">A streaming service can use PlayReady through EME or through a UWP application and offer a higher video quality using PlayReady SL3000 than another DRM.</span></span> <span data-ttu-id="57267-495">Normaal gesproken 2 kB inhoud worden overgebracht via Chrome of Firefox en 4 K-inhoud via Microsoft Edge/IE11 of een UWP-toepassing op Hallo hetzelfde apparaat (afhankelijk van de service-instellingen en implementatie).</span><span class="sxs-lookup"><span data-stu-id="57267-495">Typically, 2K content will flow through Chrome or Firefox, and 4K content through Microsoft Edge/IE11 or a UWP application on hello same device (depending on service settings and implementation).</span></span>

#### <a name="using-eme-for-widevine"></a><span data-ttu-id="57267-496">Met behulp van EME voor Widevine</span><span class="sxs-lookup"><span data-stu-id="57267-496">Using EME for Widevine</span></span>
<span data-ttu-id="57267-497">Op een moderne browser met EME/Widevine-ondersteuning, zoals Chrome 41 + op Windows 10, Windows 8.1, Mac OS x Yosemite en Chrome op Android 4.4.4 is Google Widevine DRM achter EME Hallo.</span><span class="sxs-lookup"><span data-stu-id="57267-497">On a modern browser with EME/Widevine support, such as Chrome 41+ on Windows 10, Windows 8.1, Mac OSX Yosemite, and Chrome on Android 4.4.4, Google Widevine is hello DRM behind EME.</span></span>

![Met behulp van EME voor Widevine](./media/media-services-cenc-with-multidrm-access-control/media-services-eme-for-widevine1.png)

<span data-ttu-id="57267-499">U ziet dat Widevine voorkomt niet dat een schermopname van beveiligde video aanbrengen.</span><span class="sxs-lookup"><span data-stu-id="57267-499">Notice that Widevine does not prevent one from making screen capture of protected video.</span></span>

![Met behulp van EME voor Widevine](./media/media-services-cenc-with-multidrm-access-control/media-services-eme-for-widevine2.png)

### <a name="not-entitled-users"></a><span data-ttu-id="57267-501">Geen recht gebruikers</span><span class="sxs-lookup"><span data-stu-id="57267-501">Not entitled users</span></span>
<span data-ttu-id="57267-502">Als een gebruiker is geen lid van groep 'Gebruikers het recht', Hallo gebruiker niet kunnen toopass 'recht selectievakje' en service Hallo multi-DRM-licenties weigert tooissue Hallo aangevraagde licentie zoals hieronder wordt weergegeven.</span><span class="sxs-lookup"><span data-stu-id="57267-502">If a user is not a member of "Entitled Users" group, hello user will not be able toopass “entitlement check” and hello multi-DRM license service will refuse tooissue hello requested license as shown below.</span></span> <span data-ttu-id="57267-503">Hallo gedetailleerde beschrijving is ' licentie ophalen is mislukt ", die is ontworpen.</span><span class="sxs-lookup"><span data-stu-id="57267-503">hello detailed description is “License acquire failed”, which is as designed.</span></span>

![Heeft niet het recht gebruikers](./media/media-services-cenc-with-multidrm-access-control/media-services-unentitledusers.png)

### <a name="running-custom-secure-token-service"></a><span data-ttu-id="57267-505">Aangepaste Secure Token Service uitgevoerd</span><span class="sxs-lookup"><span data-stu-id="57267-505">Running custom Secure Token Service</span></span>
<span data-ttu-id="57267-506">Hallo scenario van het uitvoeren van aangepaste Secure Token Service (STS) worden Hallo JWT-token uitgegeven door aangepaste STS Hallo met zowel symmetrisch als asymmetrisch sleutel.</span><span class="sxs-lookup"><span data-stu-id="57267-506">For hello scenario of running custom Secure Token Service (STS), hello JWT token will be issued by hello custom STS using either symmetric or asymmetric key.</span></span>

<span data-ttu-id="57267-507">Hallo-aanvraag van het gebruik van de symmetrische sleutel (met behulp van Chrome):</span><span class="sxs-lookup"><span data-stu-id="57267-507">hello case of using symmetric key (using Chrome):</span></span>

![Aangepaste STS uitgevoerd](./media/media-services-cenc-with-multidrm-access-control/media-services-running-sts1.png)

<span data-ttu-id="57267-509">aanvraag van het gebruik van asymmetrische sleutel via een X509 Hallo van het certificaat (met behulp van Microsoft moderne browser).</span><span class="sxs-lookup"><span data-stu-id="57267-509">hello case of using asymmetric key via an X509 certificate (using Microsoft modern browser).</span></span>

![Aangepaste STS uitgevoerd](./media/media-services-cenc-with-multidrm-access-control/media-services-running-sts2.png)

<span data-ttu-id="57267-511">In beide Hallo bovenstaande gevallen Hallo gebruiker verificatie blijft dezelfde – via Azure AD.</span><span class="sxs-lookup"><span data-stu-id="57267-511">In both of hello above cases, user authentication stays hello same – through Azure AD.</span></span> <span data-ttu-id="57267-512">Hallo enige verschil is dat JWT-tokens worden uitgegeven door aangepaste STS Hallo in plaats van Azure AD.</span><span class="sxs-lookup"><span data-stu-id="57267-512">hello only difference is that JWT tokens are issued by hello custom STS instead of Azure AD.</span></span> <span data-ttu-id="57267-513">Natuurlijk bij het configureren van dynamische CENC beveiliging Hallo beperking van de service voor het leveren van licenties geeft Hallo type JWT-token zowel symmetrisch als asymmetrisch sleutel.</span><span class="sxs-lookup"><span data-stu-id="57267-513">Of course, when configuring dynamic CENC protection, hello restriction of license delivery service specifies hello type of JWT token, either symmetric or asymmetric key.</span></span>

## <a name="summary"></a><span data-ttu-id="57267-514">Samenvatting</span><span class="sxs-lookup"><span data-stu-id="57267-514">Summary</span></span>
<span data-ttu-id="57267-515">In dit document besproken CENC met meerdere native-DRM en toegangsbeheer via tokenverificatie: het ontwerp en de uitvoering ervan met behulp van Azure, Azure Media Services en Azure Media Player.</span><span class="sxs-lookup"><span data-stu-id="57267-515">In this document, we discussed CENC with multi-native-DRM and access control via token authentication: its design and its implementation using Azure, Azure Media Services and Azure Media Player.</span></span>

* <span data-ttu-id="57267-516">Een referentie-ontwerp wordt weergegeven waarin alle benodigde Hallo-onderdelen in een subsysteem DRM/CENC;</span><span class="sxs-lookup"><span data-stu-id="57267-516">A reference design is presented which contains all hello necessary components in a DRM/CENC subsystem;</span></span>
* <span data-ttu-id="57267-517">De implementatie van een verwijzing op Azure, Azure Media Services en Azure Media Player.</span><span class="sxs-lookup"><span data-stu-id="57267-517">A reference implementation on Azure, Azure Media Services and Azure Media Player.</span></span>
* <span data-ttu-id="57267-518">Sommige onderwerpen die direct betrokken zijn bij het Hallo-ontwerp en de implementatie worden ook besproken.</span><span class="sxs-lookup"><span data-stu-id="57267-518">Some topics directly involved in hello design and implementation are also discussed.</span></span>

## <a name="media-services-learning-paths"></a><span data-ttu-id="57267-519">Media Services-leertrajecten</span><span class="sxs-lookup"><span data-stu-id="57267-519">Media Services learning paths</span></span>
[!INCLUDE [media-services-learning-paths-include](../../includes/media-services-learning-paths-include.md)]

## <a name="provide-feedback"></a><span data-ttu-id="57267-520">Feedback geven</span><span class="sxs-lookup"><span data-stu-id="57267-520">Provide feedback</span></span>
[!INCLUDE [media-services-user-voice-include](../../includes/media-services-user-voice-include.md)]
 
