---
title: Isolatie van Azure Service Bus-toepassingen tegen storingen en noodsituaties | Microsoft Docs
description: Hierin wordt beschreven technieken die u gebruiken kunt voor het beveiligen van toepassingen op basis van een mogelijke onderbreking van de Service Bus.
services: service-bus-messaging
documentationcenter: na
author: sethmanheim
manager: timlt
editor: tysonn
ms.assetid: fd9fa8ab-f4c4-43f7-974f-c876df1614d4
ms.service: service-bus-messaging
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 04/12/2017
ms.author: sethm
ms.openlocfilehash: bc84dbe5c26a834b2cff5f71ba5f541e94ba0b38
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 07/11/2017
---
# <a name="best-practices-for-insulating-applications-against-service-bus-outages-and-disasters"></a><span data-ttu-id="319e5-103">Aanbevolen procedures voor de isolatie van toepassingen tegen storingen van de Service Bus en noodsituaties</span><span class="sxs-lookup"><span data-stu-id="319e5-103">Best practices for insulating applications against Service Bus outages and disasters</span></span>
<span data-ttu-id="319e5-104">Bedrijfskritieke toepassingen hanteert continu, zelfs in aanwezigheid van niet-geplande storingen of noodsituaties.</span><span class="sxs-lookup"><span data-stu-id="319e5-104">Mission-critical applications must operate continuously, even in the presence of unplanned outages or disasters.</span></span> <span data-ttu-id="319e5-105">Dit onderwerp beschrijft de technieken die u gebruiken kunt voor het beveiligen van Service Bus-toepassingen op basis van een mogelijke onderbreking van deze service of na noodgevallen.</span><span class="sxs-lookup"><span data-stu-id="319e5-105">This topic describes techniques you can use to protect Service Bus applications against a potential service outage or disaster.</span></span>

<span data-ttu-id="319e5-106">Een storing wordt gedefinieerd als Azure Service Bus, tijdelijk niet beschikbaar.</span><span class="sxs-lookup"><span data-stu-id="319e5-106">An outage is defined as the temporary unavailability of Azure Service Bus.</span></span> <span data-ttu-id="319e5-107">De storing, kan sommige onderdelen van Service Bus, zoals een berichten-store of zelfs het gehele datacenter beïnvloeden.</span><span class="sxs-lookup"><span data-stu-id="319e5-107">The outage can affect some components of Service Bus, such as a messaging store, or even the entire datacenter.</span></span> <span data-ttu-id="319e5-108">Nadat het probleem is verholpen, weer Service Bus beschikbaar is.</span><span class="sxs-lookup"><span data-stu-id="319e5-108">After the problem has been fixed, Service Bus becomes available again.</span></span> <span data-ttu-id="319e5-109">Normaal gesproken veroorzaakt een storing geen verlies van berichten of andere gegevens.</span><span class="sxs-lookup"><span data-stu-id="319e5-109">Typically, an outage does not cause loss of messages or other data.</span></span> <span data-ttu-id="319e5-110">Een voorbeeld van een onderdeelfout is het ontbreken van een bepaalde berichten-store.</span><span class="sxs-lookup"><span data-stu-id="319e5-110">An example of a component failure is the unavailability of a particular messaging store.</span></span> <span data-ttu-id="319e5-111">Een voorbeeld van een onderbreking van de hele datacenter is een stroomstoring van het datacenter of een netwerkswitch defecte datacenter.</span><span class="sxs-lookup"><span data-stu-id="319e5-111">An example of a datacenter-wide outage is a power failure of the datacenter, or a faulty datacenter network switch.</span></span> <span data-ttu-id="319e5-112">Een storing kan de laatste van enkele minuten tot enkele dagen.</span><span class="sxs-lookup"><span data-stu-id="319e5-112">An outage can last from a few minutes to a few days.</span></span>

<span data-ttu-id="319e5-113">Een noodgeval wordt gedefinieerd als permanent verlies van een Service Bus-schaaleenheid of datacenter.</span><span class="sxs-lookup"><span data-stu-id="319e5-113">A disaster is defined as the permanent loss of a Service Bus scale unit or datacenter.</span></span> <span data-ttu-id="319e5-114">Het datacenter kan of kan niet weer beschikbaar.</span><span class="sxs-lookup"><span data-stu-id="319e5-114">The datacenter may or may not become available again.</span></span> <span data-ttu-id="319e5-115">Doorgaans verloren een noodgeval enkele of alle berichten of andere gegevens.</span><span class="sxs-lookup"><span data-stu-id="319e5-115">Typically a disaster causes loss of some or all messages or other data.</span></span> <span data-ttu-id="319e5-116">Voorbeelden van noodsituaties zijn gestart, die het overspoelen of aardbeving.</span><span class="sxs-lookup"><span data-stu-id="319e5-116">Examples of disasters are fire, flooding, or earthquake.</span></span>

## <a name="current-architecture"></a><span data-ttu-id="319e5-117">Huidige architectuur</span><span class="sxs-lookup"><span data-stu-id="319e5-117">Current architecture</span></span>
<span data-ttu-id="319e5-118">Service Bus maakt gebruik van meerdere berichten-stores voor het opslaan van berichten die worden verzonden naar wachtrijen en onderwerpen.</span><span class="sxs-lookup"><span data-stu-id="319e5-118">Service Bus uses multiple messaging stores to store messages that are sent to queues or topics.</span></span> <span data-ttu-id="319e5-119">Een niet-gepartitioneerde wachtrij of onderwerp is toegewezen aan één berichten-store.</span><span class="sxs-lookup"><span data-stu-id="319e5-119">A non-partitioned queue or topic is assigned to one messaging store.</span></span> <span data-ttu-id="319e5-120">Als deze berichten-store niet beschikbaar is, mislukt de alle bewerkingen voor de wachtrij of onderwerp.</span><span class="sxs-lookup"><span data-stu-id="319e5-120">If this messaging store is unavailable, all operations on that queue or topic will fail.</span></span>

<span data-ttu-id="319e5-121">Alle Service Bus messaging-entiteiten (wachtrijen, onderwerpen, relays) zich bevinden in een service-naamruimte die is gekoppeld aan een datacenter.</span><span class="sxs-lookup"><span data-stu-id="319e5-121">All Service Bus messaging entities (queues, topics, relays) reside in a service namespace, which is affiliated with a datacenter.</span></span> <span data-ttu-id="319e5-122">Service Bus kunnen niet automatisch geo-replicatie van gegevens, noch toestaan een naamruimte te combineren van meerdere datacenters.</span><span class="sxs-lookup"><span data-stu-id="319e5-122">Service Bus does not enable automatic geo-replication of data, nor does it allow a namespace to span multiple datacenters.</span></span>

## <a name="protecting-against-acs-outages"></a><span data-ttu-id="319e5-123">Bescherming tegen storingen van ACS</span><span class="sxs-lookup"><span data-stu-id="319e5-123">Protecting against ACS outages</span></span>
<span data-ttu-id="319e5-124">Als u van referenties voor ACS gebruikmaakt en ACS niet meer beschikbaar is, kunnen clients niet langer tokens verkrijgen.</span><span class="sxs-lookup"><span data-stu-id="319e5-124">If you are using ACS credentials, and ACS becomes unavailable, clients can no longer obtain tokens.</span></span> <span data-ttu-id="319e5-125">Clients die een token hebben op het moment dat ACS uitvalt kunnen blijven gebruiken van Service Bus totdat de tokens verlopen.</span><span class="sxs-lookup"><span data-stu-id="319e5-125">Clients that have a token at the time ACS goes down can continue to use Service Bus until the tokens expire.</span></span> <span data-ttu-id="319e5-126">De standaardlevensduur van de token is drie uur.</span><span class="sxs-lookup"><span data-stu-id="319e5-126">The default token lifetime is 3 hours.</span></span>

<span data-ttu-id="319e5-127">Ter bescherming tegen storingen van ACS, gebruikt u de Shared Access Signature (SAS)-tokens.</span><span class="sxs-lookup"><span data-stu-id="319e5-127">To protect against ACS outages, use Shared Access Signature (SAS) tokens.</span></span> <span data-ttu-id="319e5-128">In dit geval verifieert de client rechtstreeks met Service Bus met een zelf minted token-ondertekening met een geheime sleutel.</span><span class="sxs-lookup"><span data-stu-id="319e5-128">In this case, the client authenticates directly with Service Bus by signing a self-minted token with a secret key.</span></span> <span data-ttu-id="319e5-129">Aanroepen naar ACS zijn niet langer vereist.</span><span class="sxs-lookup"><span data-stu-id="319e5-129">Calls to ACS are no longer required.</span></span> <span data-ttu-id="319e5-130">Zie voor meer informatie over SAS-tokens [Service Bus verificatie][Service Bus authentication].</span><span class="sxs-lookup"><span data-stu-id="319e5-130">For more information about SAS tokens, see [Service Bus authentication][Service Bus authentication].</span></span>

## <a name="protecting-queues-and-topics-against-messaging-store-failures"></a><span data-ttu-id="319e5-131">Beveiligen van wachtrijen en onderwerpen tegen storingen store messaging</span><span class="sxs-lookup"><span data-stu-id="319e5-131">Protecting queues and topics against messaging store failures</span></span>
<span data-ttu-id="319e5-132">Een niet-gepartitioneerde wachtrij of onderwerp is toegewezen aan één berichten-store.</span><span class="sxs-lookup"><span data-stu-id="319e5-132">A non-partitioned queue or topic is assigned to one messaging store.</span></span> <span data-ttu-id="319e5-133">Als deze berichten-store niet beschikbaar is, mislukt de alle bewerkingen voor de wachtrij of onderwerp.</span><span class="sxs-lookup"><span data-stu-id="319e5-133">If this messaging store is unavailable, all operations on that queue or topic will fail.</span></span> <span data-ttu-id="319e5-134">Een gepartitioneerde wachtrij aan de andere kant bestaat uit meerdere fragmenten.</span><span class="sxs-lookup"><span data-stu-id="319e5-134">A partitioned queue, on the other hand, consists of multiple fragments.</span></span> <span data-ttu-id="319e5-135">Elke fragment wordt opgeslagen in een andere berichten-store.</span><span class="sxs-lookup"><span data-stu-id="319e5-135">Each fragment is stored in a different messaging store.</span></span> <span data-ttu-id="319e5-136">Wanneer een bericht wordt verzonden naar een gepartitioneerde wachtrij of onderwerp, wijst Service Bus het bericht toe aan een van de fragmenten.</span><span class="sxs-lookup"><span data-stu-id="319e5-136">When a message is sent to a partitioned queue or topic, Service Bus assigns the message to one of the fragments.</span></span> <span data-ttu-id="319e5-137">Als de bijbehorende berichten-store niet beschikbaar is, schrijft Service Bus het bericht indien mogelijk naar een andere fragment.</span><span class="sxs-lookup"><span data-stu-id="319e5-137">If the corresponding messaging store is unavailable, Service Bus writes the message to a different fragment, if possible.</span></span> <span data-ttu-id="319e5-138">Zie voor meer informatie over gepartitioneerde entiteiten [gepartitioneerde berichtentiteiten][Partitioned messaging entities].</span><span class="sxs-lookup"><span data-stu-id="319e5-138">For more information about partitioned entities, see [Partitioned messaging entities][Partitioned messaging entities].</span></span>

## <a name="protecting-against-datacenter-outages-or-disasters"></a><span data-ttu-id="319e5-139">Bescherming tegen storingen van datacenter of rampen</span><span class="sxs-lookup"><span data-stu-id="319e5-139">Protecting against datacenter outages or disasters</span></span>
<span data-ttu-id="319e5-140">Als u wilt toestaan voor een failover tussen twee datacentra, kunt u een Service Bus-Servicenaamruimte maken in elk datacenter.</span><span class="sxs-lookup"><span data-stu-id="319e5-140">To allow for a failover between two datacenters, you can create a Service Bus service namespace in each datacenter.</span></span> <span data-ttu-id="319e5-141">Bijvoorbeeld: de Service Bus-Servicenaamruimte **contosoPrimary.servicebus.windows.net** zich mogelijk in de regio Noord/centraal van de Verenigde Staten en **contosoSecondary.servicebus.windows.net**zich mogelijk in de regio VS Zuid-/ centraal.</span><span class="sxs-lookup"><span data-stu-id="319e5-141">For example, the Service Bus service namespace **contosoPrimary.servicebus.windows.net** might be located in the United States North/Central region, and **contosoSecondary.servicebus.windows.net** might be located in the US South/Central region.</span></span> <span data-ttu-id="319e5-142">Als een Service Bus-berichtenservice entiteit blijven toegankelijk in de aanwezigheid van een storing in datacenter zijn moet, kunt u die entiteit maken in beide naamruimten.</span><span class="sxs-lookup"><span data-stu-id="319e5-142">If a Service Bus messaging entity must remain accessible in the presence of a datacenter outage, you can create that entity in both namespaces.</span></span>

<span data-ttu-id="319e5-143">Zie voor meer informatie de sectie '-fout van Servicebus binnen een Azure-datacenter in [asynchrone messaging-patronen en hoge beschikbaarheid][Asynchronous messaging patterns and high availability].</span><span class="sxs-lookup"><span data-stu-id="319e5-143">For more information, see the "Failure of Service Bus within an Azure datacenter" section in [Asynchronous messaging patterns and high availability][Asynchronous messaging patterns and high availability].</span></span>

## <a name="protecting-relay-endpoints-against-datacenter-outages-or-disasters"></a><span data-ttu-id="319e5-144">Beveiligen van eindpunten relay tegen storingen van datacenter of rampen</span><span class="sxs-lookup"><span data-stu-id="319e5-144">Protecting relay endpoints against datacenter outages or disasters</span></span>
<span data-ttu-id="319e5-145">Geo-replicatie van de relay-eindpunten kan een service waarmee een relay-eindpunt om te worden bereikt met Service Bus storingen.</span><span class="sxs-lookup"><span data-stu-id="319e5-145">Geo-replication of relay endpoints allows a service that exposes a relay endpoint to be reachable in the presence of Service Bus outages.</span></span> <span data-ttu-id="319e5-146">Als u wilt bereiken geo-replicatie, moet de service relay-eindpunten maken in verschillende naamruimten.</span><span class="sxs-lookup"><span data-stu-id="319e5-146">To achieve geo-replication, the service must create two relay endpoints in different namespaces.</span></span> <span data-ttu-id="319e5-147">De naamruimten moet zich bevinden in verschillende datacenters en de twee eindpunten moeten verschillende namen hebben.</span><span class="sxs-lookup"><span data-stu-id="319e5-147">The namespaces must reside in different datacenters and the two endpoints must have different names.</span></span> <span data-ttu-id="319e5-148">Bijvoorbeeld: een primaire eindpunt kan worden bereikt onder **contosoPrimary.servicebus.windows.net/myPrimaryService**, terwijl het bijbehorende secundaire server kan worden bereikt onder **contosoSecondary.servicebus.windows.net /mySecondaryService**.</span><span class="sxs-lookup"><span data-stu-id="319e5-148">For example, a primary endpoint can be reached under **contosoPrimary.servicebus.windows.net/myPrimaryService**, while its secondary counterpart can be reached under **contosoSecondary.servicebus.windows.net/mySecondaryService**.</span></span>

<span data-ttu-id="319e5-149">De service vervolgens luistert op beide eindpunten en een client de service via een eindpunt kunt aanroepen.</span><span class="sxs-lookup"><span data-stu-id="319e5-149">The service then listens on both endpoints, and a client can invoke the service via either endpoint.</span></span> <span data-ttu-id="319e5-150">Een clienttoepassing willekeurig een van de relays hervat als het primaire eindpunt en de aanvraag verzendt naar de actieve eindpunt.</span><span class="sxs-lookup"><span data-stu-id="319e5-150">A client application randomly picks one of the relays as the primary endpoint, and sends its request to the active endpoint.</span></span> <span data-ttu-id="319e5-151">Als de bewerking is mislukt met foutcode, wordt deze fout geeft aan de relay-eindpunt is niet beschikbaar.</span><span class="sxs-lookup"><span data-stu-id="319e5-151">If the operation fails with an error code, this failure indicates that the relay endpoint is not available.</span></span> <span data-ttu-id="319e5-152">De toepassing een kanaal geopend naar het back-eindpunt en databasebron moet worden gestuurd de aanvraag.</span><span class="sxs-lookup"><span data-stu-id="319e5-152">The application opens a channel to the backup endpoint and reissues the request.</span></span> <span data-ttu-id="319e5-153">De actieve en de back-eindpunten overschakelen op dat moment rollen: de clienttoepassing beschouwt het oude actieve eindpunt worden de nieuwe back-eindpunt en de oude back-eindpunt moet de nieuwe actieve eindpunt.</span><span class="sxs-lookup"><span data-stu-id="319e5-153">At that point the active and the backup endpoints switch roles: the client application considers the old active endpoint to be the new backup endpoint, and the old backup endpoint to be the new active endpoint.</span></span> <span data-ttu-id="319e5-154">Als beide mislukken verzendt, de functies van de twee entiteiten blijven ongewijzigd en wordt een fout geretourneerd.</span><span class="sxs-lookup"><span data-stu-id="319e5-154">If both send operations fail, the roles of the two entities remain unchanged and an error is returned.</span></span>

<span data-ttu-id="319e5-155">De [Geo-replicatie met Service Bus relayed berichten] [ Geo-replication with Service Bus relayed Messages] voorbeeld laat zien hoe u relays repliceren.</span><span class="sxs-lookup"><span data-stu-id="319e5-155">The [Geo-replication with Service Bus relayed messages][Geo-replication with Service Bus relayed Messages] sample demonstrates how to replicate relays.</span></span>

## <a name="protecting-queues-and-topics-against-datacenter-outages-or-disasters"></a><span data-ttu-id="319e5-156">Wachtrijen en onderwerpen tegen storingen van datacenter of noodsituaties beveiligen</span><span class="sxs-lookup"><span data-stu-id="319e5-156">Protecting queues and topics against datacenter outages or disasters</span></span>
<span data-ttu-id="319e5-157">Als u wilt bereiken herstelmogelijkheden tegen storingen van datacenter wanneer met behulp van brokered messaging, Service Bus ondersteunt twee methoden: *active* en *passieve* replicatie.</span><span class="sxs-lookup"><span data-stu-id="319e5-157">To achieve resilience against datacenter outages when using brokered messaging, Service Bus supports two approaches: *active* and *passive* replication.</span></span> <span data-ttu-id="319e5-158">Voor elke methode als een bepaalde wachtrij of onderwerp toegankelijk in de aanwezigheid van een storing in een datacenter blijven moet, kunt u dit maken in beide naamruimten.</span><span class="sxs-lookup"><span data-stu-id="319e5-158">For each approach, if a given queue or topic must remain accessible in the presence of a datacenter outage, you can create it in both namespaces.</span></span> <span data-ttu-id="319e5-159">Beide entiteiten kunnen dezelfde naam hebben.</span><span class="sxs-lookup"><span data-stu-id="319e5-159">Both entities can have the same name.</span></span> <span data-ttu-id="319e5-160">Bijvoorbeeld: een primaire wachtrij kan worden bereikt onder **contosoPrimary.servicebus.windows.net/myQueue**, terwijl het bijbehorende secundaire server kan worden bereikt onder **contosoSecondary.servicebus.windows.net/myQueue**.</span><span class="sxs-lookup"><span data-stu-id="319e5-160">For example, a primary queue can be reached under **contosoPrimary.servicebus.windows.net/myQueue**, while its secondary counterpart can be reached under **contosoSecondary.servicebus.windows.net/myQueue**.</span></span>

<span data-ttu-id="319e5-161">Als de toepassing geen permanente afzender naar ontvanger communicatie vereist, kan de toepassing een duurzame clientzijde wachtrij om te voorkomen dat bericht verloren gaan en af te schermen van de afzender van een tijdelijke fouten met Service Bus implementeren.</span><span class="sxs-lookup"><span data-stu-id="319e5-161">If the application does not require permanent sender-to-receiver communication, the application can implement a durable client-side queue to prevent message loss and to shield the sender from any transient Service Bus errors.</span></span>

## <a name="active-replication"></a><span data-ttu-id="319e5-162">Actieve replicatie</span><span class="sxs-lookup"><span data-stu-id="319e5-162">Active replication</span></span>
<span data-ttu-id="319e5-163">Actieve replicatie maakt gebruik van entiteiten in beide naamruimten voor elke bewerking.</span><span class="sxs-lookup"><span data-stu-id="319e5-163">Active replication uses entities in both namespaces for every operation.</span></span> <span data-ttu-id="319e5-164">Een client die u een bericht verzendt verzendt twee kopieën van hetzelfde bericht.</span><span class="sxs-lookup"><span data-stu-id="319e5-164">Any client that sends a message sends two copies of the same message.</span></span> <span data-ttu-id="319e5-165">De eerste kopie wordt verzonden naar de primaire entiteit (bijvoorbeeld **contosoPrimary.servicebus.windows.net/sales**), en de tweede kopie van het bericht wordt verzonden naar de secundaire entiteit (bijvoorbeeld  **contosoSecondary.servicebus.windows.net/sales**).</span><span class="sxs-lookup"><span data-stu-id="319e5-165">The first copy is sent to the primary entity (for example, **contosoPrimary.servicebus.windows.net/sales**), and the second copy of the message is sent to the secondary entity (for example, **contosoSecondary.servicebus.windows.net/sales**).</span></span>

<span data-ttu-id="319e5-166">Een client ontvangt berichten van beide wachtrijen.</span><span class="sxs-lookup"><span data-stu-id="319e5-166">A client receives messages from both queues.</span></span> <span data-ttu-id="319e5-167">De ontvanger de eerste kopie van een bericht verwerkt en de tweede kopie wordt onderdrukt.</span><span class="sxs-lookup"><span data-stu-id="319e5-167">The receiver processes the first copy of a message, and the second copy is suppressed.</span></span> <span data-ttu-id="319e5-168">Als u wilt onderdrukken dubbele berichten, moet de afzender elk bericht met een unieke identificatie labelen.</span><span class="sxs-lookup"><span data-stu-id="319e5-168">To suppress duplicate messages, the sender must tag each message with a unique identifier.</span></span> <span data-ttu-id="319e5-169">Beide exemplaren van het bericht moeten worden gemarkeerd met dezelfde id.</span><span class="sxs-lookup"><span data-stu-id="319e5-169">Both copies of the message must be tagged with the same identifier.</span></span> <span data-ttu-id="319e5-170">U kunt de [BrokeredMessage.MessageId] [ BrokeredMessage.MessageId] of [BrokeredMessage.Label] [ BrokeredMessage.Label] eigenschappen of een aangepaste eigenschap voor het taggen van het bericht.</span><span class="sxs-lookup"><span data-stu-id="319e5-170">You can use the [BrokeredMessage.MessageId][BrokeredMessage.MessageId] or [BrokeredMessage.Label][BrokeredMessage.Label] properties, or a custom property to tag the message.</span></span> <span data-ttu-id="319e5-171">De ontvanger moet een lijst met berichten die al zijn ontvangen onderhouden.</span><span class="sxs-lookup"><span data-stu-id="319e5-171">The receiver must maintain a list of messages that it has already received.</span></span>

<span data-ttu-id="319e5-172">De [Geo-replicatie met Service Bus Brokered berichten] [ Geo-replication with Service Bus Brokered Messages] ziet u het actieve replicatie van berichtentiteiten.</span><span class="sxs-lookup"><span data-stu-id="319e5-172">The [Geo-replication with Service Bus Brokered Messages][Geo-replication with Service Bus Brokered Messages] sample demonstrates active replication of messaging entities.</span></span>

> [!NOTE]
> <span data-ttu-id="319e5-173">De actieve replicatie aanpak verdubbelt het aantal bewerkingen, dus deze benadering kan leiden tot hogere kosten.</span><span class="sxs-lookup"><span data-stu-id="319e5-173">The active replication approach doubles the number of operations, therefore this approach can lead to higher cost.</span></span>
> 
> 

## <a name="passive-replication"></a><span data-ttu-id="319e5-174">Passieve replicatie</span><span class="sxs-lookup"><span data-stu-id="319e5-174">Passive replication</span></span>
<span data-ttu-id="319e5-175">In het geval veroorzaakt gratis passieve replicatie maakt gebruik van slechts één van de twee berichtentiteiten.</span><span class="sxs-lookup"><span data-stu-id="319e5-175">In the fault-free case, passive replication uses only one of the two messaging entities.</span></span> <span data-ttu-id="319e5-176">Een client verzendt het bericht naar de actieve entiteit.</span><span class="sxs-lookup"><span data-stu-id="319e5-176">A client sends the message to the active entity.</span></span> <span data-ttu-id="319e5-177">Als de bewerking op de actieve entiteit is mislukt met de foutcode die aangeeft van het datacenter dat als host fungeert voor de actieve entiteit is mogelijk niet beschikbaar is, verzendt de client een kopie van het bericht naar de back-entiteit.</span><span class="sxs-lookup"><span data-stu-id="319e5-177">If the operation on the active entity fails with an error code that indicates the datacenter that hosts the active entity might be unavailable, the client sends a copy of the message to the backup entity.</span></span> <span data-ttu-id="319e5-178">De actieve en de back-entiteiten overschakelen op dat moment rollen: de verzendende client beschouwt de oude active entiteit moet de nieuwe back-entiteit en de oude back-entiteit is de nieuwe actieve entiteit.</span><span class="sxs-lookup"><span data-stu-id="319e5-178">At that point the active and the backup entities switch roles: the sending client considers the old active entity to be the new backup entity, and the old backup entity is the new active entity.</span></span> <span data-ttu-id="319e5-179">Als beide mislukken verzendt, de functies van de twee entiteiten blijven ongewijzigd en wordt een fout geretourneerd.</span><span class="sxs-lookup"><span data-stu-id="319e5-179">If both send operations fail, the roles of the two entities remain unchanged and an error is returned.</span></span>

<span data-ttu-id="319e5-180">Een client ontvangt berichten van beide wachtrijen.</span><span class="sxs-lookup"><span data-stu-id="319e5-180">A client receives messages from both queues.</span></span> <span data-ttu-id="319e5-181">Omdat er een kans is dat de ontvanger twee kopieën van hetzelfde bericht ontvangt, moet de ontvanger dubbele berichten onderdrukt.</span><span class="sxs-lookup"><span data-stu-id="319e5-181">Because there is a chance that the receiver receives two copies of the same message, the receiver must suppress duplicate messages.</span></span> <span data-ttu-id="319e5-182">U kunt duplicaten onderdrukken op dezelfde manier zoals beschreven voor actieve replicatie.</span><span class="sxs-lookup"><span data-stu-id="319e5-182">You can suppress duplicates in the same way as described for active replication.</span></span>

<span data-ttu-id="319e5-183">Passieve replicatie is in het algemeen goedkoper dan actieve replicatie omdat in de meeste gevallen slechts één bewerking wordt uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="319e5-183">In general, passive replication is more economical than active replication because in most cases only one operation is performed.</span></span> <span data-ttu-id="319e5-184">Latentie, doorvoer en kosten zijn identiek aan de niet-gerepliceerde scenario.</span><span class="sxs-lookup"><span data-stu-id="319e5-184">Latency, throughput, and monetary cost are identical to the non-replicated scenario.</span></span>

<span data-ttu-id="319e5-185">Als u passieve replicatie gebruikt, in de volgende scenario's kunnen berichten zoekraken of worden twee keer ontvangen:</span><span class="sxs-lookup"><span data-stu-id="319e5-185">When using passive replication, in the following scenarios messages can be lost or received twice:</span></span>

* <span data-ttu-id="319e5-186">**Bericht vertraging of verlies**: wordt ervan uitgegaan dat de afzender een m1 bericht naar de primaire wachtrij verzonden en de wachtrij vervolgens niet beschikbaar wordt voordat de ontvanger m1 ontvangt.</span><span class="sxs-lookup"><span data-stu-id="319e5-186">**Message delay or loss**: Assume that the sender successfully sent a message m1 to the primary queue, and then the queue becomes unavailable before the receiver receives m1.</span></span> <span data-ttu-id="319e5-187">De afzender verzendt een m2 daaropvolgende bericht naar de secundaire wachtrij.</span><span class="sxs-lookup"><span data-stu-id="319e5-187">The sender sends a subsequent message m2 to the secondary queue.</span></span> <span data-ttu-id="319e5-188">Als de primaire wachtrij tijdelijk niet beschikbaar is, ontvangt de ontvanger m1 nadat de wachtrij weer beschikbaar is.</span><span class="sxs-lookup"><span data-stu-id="319e5-188">If the primary queue is temporarily unavailable, the receiver receives m1 after the queue becomes available again.</span></span> <span data-ttu-id="319e5-189">Als er een ramp optreedt ontvangt de ontvanger mogelijk nooit m1.</span><span class="sxs-lookup"><span data-stu-id="319e5-189">In case of a disaster, the receiver may never receive m1.</span></span>
* <span data-ttu-id="319e5-190">**Dubbele ontvangst**: wordt ervan uitgegaan dat de afzender een bericht m naar de primaire wachtrij verzendt.</span><span class="sxs-lookup"><span data-stu-id="319e5-190">**Duplicate reception**: Assume that the sender sends a message m to the primary queue.</span></span> <span data-ttu-id="319e5-191">Service Bus m verwerkt is, maar voor het verzenden van een antwoord is mislukt.</span><span class="sxs-lookup"><span data-stu-id="319e5-191">Service Bus successfully processes m but fails to send a response.</span></span> <span data-ttu-id="319e5-192">Nadat er is een time-out opgetreden voor de verzendbewerking, verzendt de afzender een identieke kopie van m naar de secundaire wachtrij.</span><span class="sxs-lookup"><span data-stu-id="319e5-192">After the send operation times out, the sender sends an identical copy of m to the secondary queue.</span></span> <span data-ttu-id="319e5-193">Als de ontvanger kan de eerste kopie van m ontvangen voordat de primaire wachtrij niet beschikbaar is, ontvangt de ontvanger beide kopieën van m rond dezelfde tijd.</span><span class="sxs-lookup"><span data-stu-id="319e5-193">If the receiver is able to receive the first copy of m before the primary queue becomes unavailable, the receiver receives both copies of m at approximately the same time.</span></span> <span data-ttu-id="319e5-194">Als de ontvanger kan niet ontvangen van de eerste kopie van m voordat de primaire wachtrij niet meer beschikbaar is, wordt de ontvanger in eerste instantie ontvangt alleen het tweede exemplaar van m, maar u ontvangt vervolgens een tweede kopie van m wanneer de primaire wachtrij beschikbaar komt.</span><span class="sxs-lookup"><span data-stu-id="319e5-194">If the receiver is not able to receive the first copy of m before the primary queue becomes unavailable, the receiver initially receives only the second copy of m, but then receives a second copy of m when the primary queue becomes available.</span></span>

<span data-ttu-id="319e5-195">De [Geo-replicatie met Service Bus brokered berichten] [ Geo-replication with Service Bus Brokered Messages] voorbeeld demonstreert passieve replicatie van berichtentiteiten.</span><span class="sxs-lookup"><span data-stu-id="319e5-195">The [Geo-replication with Service Bus brokered messages][Geo-replication with Service Bus Brokered Messages] sample demonstrates passive replication of messaging entities.</span></span>

## <a name="next-steps"></a><span data-ttu-id="319e5-196">Volgende stappen</span><span class="sxs-lookup"><span data-stu-id="319e5-196">Next steps</span></span>
<span data-ttu-id="319e5-197">Zie voor meer informatie over herstel na noodgevallen, deze artikelen:</span><span class="sxs-lookup"><span data-stu-id="319e5-197">To learn more about disaster recovery, see these articles:</span></span>

* <span data-ttu-id="319e5-198">[Azure SQL Database Business Continuity][Azure SQL Database Business Continuity]</span><span class="sxs-lookup"><span data-stu-id="319e5-198">[Azure SQL Database Business Continuity][Azure SQL Database Business Continuity]</span></span>
* <span data-ttu-id="319e5-199">[Robuuste toepassingen voor Azure ontwerpen][Azure resiliency technical guidance]</span><span class="sxs-lookup"><span data-stu-id="319e5-199">[Designing resilient applications for Azure][Azure resiliency technical guidance]</span></span>

[Service Bus Authentication]: service-bus-authentication-and-authorization.md
[Partitioned messaging entities]: service-bus-partitioning.md
[Asynchronous messaging patterns and high availability]: service-bus-async-messaging.md#failure-of-service-bus-within-an-azure-datacenter
[Geo-replication with Service Bus Relayed Messages]: http://code.msdn.microsoft.com/Geo-replication-with-16dbfecd
[BrokeredMessage.MessageId]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_MessageId
[BrokeredMessage.Label]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Label
[Geo-replication with Service Bus Brokered Messages]: http://code.msdn.microsoft.com/Geo-replication-with-f5688664
[Azure SQL Database Business Continuity]: ../sql-database/sql-database-business-continuity.md
[Azure resiliency technical guidance]: /azure/architecture/resiliency
