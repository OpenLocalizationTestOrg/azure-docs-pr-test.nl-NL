---
title: Toepassingen die gebruikmaken van Azure Service Bus-onderwerpen en abonnementen maken | Microsoft Docs
description: Inleiding tot het publiceren-abonneren mogelijkheden die worden aangeboden door Service Bus-onderwerpen en abonnementen.
services: service-bus-messaging
documentationcenter: na
author: sethmanheim
manager: timlt
editor: 
ms.assetid: a48fc9b0-b7b0-464e-8187-a517bf8b4eb4
ms.service: service-bus-messaging
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 04/07/2017
ms.author: sethm
ms.openlocfilehash: eb01120ce9578f716e5381c107faa93f0b36e358
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 08/18/2017
---
# <a name="create-applications-that-use-service-bus-topics-and-subscriptions"></a><span data-ttu-id="a518e-103">Toepassingen die gebruikmaken van Service Bus-onderwerpen en abonnementen maken</span><span class="sxs-lookup"><span data-stu-id="a518e-103">Create applications that use Service Bus topics and subscriptions</span></span>
<span data-ttu-id="a518e-104">Azure Service Bus ondersteunt een set van cloud-gebaseerde, bericht georiënteerd middleware-technologieën waaronder betrouwbare message Queuing- en duurzame publiceren/abonneren messaging.</span><span class="sxs-lookup"><span data-stu-id="a518e-104">Azure Service Bus supports a set of cloud-based, message-oriented middleware technologies including reliable message queuing and durable publish/subscribe messaging.</span></span> <span data-ttu-id="a518e-105">In dit artikel is gebaseerd op de informatie in [maken van toepassingen die gebruikmaken van Service Bus-wachtrijen](service-bus-create-queues.md) en biedt een inleiding tot de mogelijkheden voor publiceren/abonneren die worden aangeboden door Service Bus-onderwerpen.</span><span class="sxs-lookup"><span data-stu-id="a518e-105">This article builds on the information provided in [Create applications that use Service Bus queues](service-bus-create-queues.md) and offers an introduction to the publish/subscribe capabilities offered by Service Bus topics.</span></span>

## <a name="evolving-retail-scenario"></a><span data-ttu-id="a518e-106">Zich ontwikkelende retail-scenario</span><span class="sxs-lookup"><span data-stu-id="a518e-106">Evolving retail scenario</span></span>
<span data-ttu-id="a518e-107">In dit artikel blijft de retail-scenario gebruikt in [maken van toepassingen die gebruikmaken van Service Bus-wachtrijen](service-bus-create-queues.md).</span><span class="sxs-lookup"><span data-stu-id="a518e-107">This article continues the retail scenario used in [Create applications that use Service Bus queues](service-bus-create-queues.md).</span></span> <span data-ttu-id="a518e-108">Intrekken die verkoopgegevens uit afzonderlijke punt van verkooppunten (POS) aansluitingen moeten worden doorgestuurd naar een inventaris van een beheersysteem dat gebruikmaakt van die gegevens om te bepalen wanneer stock moet worden aangevuld.</span><span class="sxs-lookup"><span data-stu-id="a518e-108">Recall that sales data from individual Point of Sale (POS) terminals must be routed to an inventory management system which uses that data to determine when stock has to be replenished.</span></span> <span data-ttu-id="a518e-109">Elke POS-terminal rapporteert de verkoopgegevens door berichten verzenden naar de **DataCollectionQueue** wachtrij, waar ze blijven totdat ze worden ontvangen door het beheersysteem inventarisatie als volgt te werk:</span><span class="sxs-lookup"><span data-stu-id="a518e-109">Each POS terminal reports its sales data by sending messages to the **DataCollectionQueue** queue, where they remain until they are received by the inventory management system, as shown here:</span></span>

![Servicebus 1](./media/service-bus-create-topics-subscriptions/IC657161.gif)

<span data-ttu-id="a518e-111">Voor het ontwikkelen van dit scenario, een nieuwe vereiste is toegevoegd aan het systeem: de winkeleigenaar wil kunt bijhouden hoe de store presteert in realtime.</span><span class="sxs-lookup"><span data-stu-id="a518e-111">To evolve this scenario, a new requirement has been added to the system: the store owner wants to be able to monitor how the store is performing in real time.</span></span>

<span data-ttu-id="a518e-112">Om deze vereiste op te lossen, het systeem moet 'Tik op"uit de stroom verkoopgegevens.</span><span class="sxs-lookup"><span data-stu-id="a518e-112">To address this requirement, the system must "tap" off the sales data stream.</span></span> <span data-ttu-id="a518e-113">We willen nog steeds dat elk bericht verzonden door de POS-aansluitingen worden verzonden naar het beheersysteem inventaris als voordat, maar we willen dat een ander exemplaar van elk bericht die u gebruiken kunt om de dashboardweergave naar de store-eigenaar.</span><span class="sxs-lookup"><span data-stu-id="a518e-113">We still want each message sent by the POS terminals to be sent to the inventory management system as before, but we want another copy of each message that we can use to present the dashboard view to the store owner.</span></span>

<span data-ttu-id="a518e-114">In een situatie zoals deze, waarin u vereisen dat elk bericht om te worden verbruikt door meerdere partijen, kunt u Service Bus *onderwerpen*.</span><span class="sxs-lookup"><span data-stu-id="a518e-114">In any situation such as this, in which you require each message to be consumed by multiple parties, you can use Service Bus *topics*.</span></span> <span data-ttu-id="a518e-115">Onderwerpen bevatten een patroon voor publiceren/abonneren waarin elk gepubliceerde bericht beschikbaar wordt gesteld aan een of meer abonnementen die zijn geregistreerd bij het onderwerp.</span><span class="sxs-lookup"><span data-stu-id="a518e-115">Topics provide a publish/subscribe pattern in which each published message is made available to one or more subscriptions registered with the topic.</span></span> <span data-ttu-id="a518e-116">In tegenstelling met wachtrijen wordt elk bericht ontvangen door een enkele gebruiker.</span><span class="sxs-lookup"><span data-stu-id="a518e-116">In contrast, with queues each message is received by a single consumer.</span></span>

<span data-ttu-id="a518e-117">Berichten worden verzonden naar een onderwerp op dezelfde manier als ze worden verzonden naar een wachtrij.</span><span class="sxs-lookup"><span data-stu-id="a518e-117">Messages are sent to a topic in the same way as they are sent to a queue.</span></span> <span data-ttu-id="a518e-118">Echter worden berichten niet ontvangen van het onderwerp rechtstreeks; ze worden ontvangen van abonnementen.</span><span class="sxs-lookup"><span data-stu-id="a518e-118">However, messages are not received from the topic directly; they are received from subscriptions.</span></span> <span data-ttu-id="a518e-119">U kunt zien van een abonnement op een onderwerp als een virtuele wachtrij die kopieën van de berichten die worden verzonden naar dat onderwerp ontvangt.</span><span class="sxs-lookup"><span data-stu-id="a518e-119">You can think of a subscription to a topic as a virtual queue that receives copies of the messages that are sent to that topic.</span></span> <span data-ttu-id="a518e-120">Berichten worden ontvangen van een abonnement op dezelfde manier als ze worden ontvangen van een wachtrij.</span><span class="sxs-lookup"><span data-stu-id="a518e-120">Messages are received from a subscription the same way as they are received from a queue.</span></span>

<span data-ttu-id="a518e-121">Ga terug naar de retail-scenario, de wachtrij wordt vervangen door een onderwerp en een abonnement wordt toegevoegd, dat de inventariscomponent van de management-systeem kunt gebruiken.</span><span class="sxs-lookup"><span data-stu-id="a518e-121">Going back to the retail scenario, the queue is replaced by a topic, and a subscription is added, which the inventory management system component can use.</span></span> <span data-ttu-id="a518e-122">Het systeem wordt nu weergegeven als volgt:</span><span class="sxs-lookup"><span data-stu-id="a518e-122">The system now appears as follows:</span></span>

![Servicebus 2](./media/service-bus-create-topics-subscriptions/IC657165.gif)

<span data-ttu-id="a518e-124">De configuratie van de hier voert dezelfde in het vorige ontwerp op basis van een wachtrij.</span><span class="sxs-lookup"><span data-stu-id="a518e-124">The configuration here performs identically to the previous queue-based design.</span></span> <span data-ttu-id="a518e-125">Dat wil zeggen verzonden berichten aan het onderwerp worden doorgestuurd naar de **inventaris** abonnement, van waaruit de **voorraadbeheer** ze worden verbruikt.</span><span class="sxs-lookup"><span data-stu-id="a518e-125">That is, messages sent to the topic are routed to the **Inventory** subscription, from which the **Inventory Management System** consumes them.</span></span>

<span data-ttu-id="a518e-126">Om het dashboard management te ondersteunen, maken we een tweede abonnement in het onderwerp als volgt te werk:</span><span class="sxs-lookup"><span data-stu-id="a518e-126">In order to support the management dashboard, we create a second subscription on the topic, as shown here:</span></span>

![Servicebus 3](./media/service-bus-create-topics-subscriptions/IC657166.gif)

<span data-ttu-id="a518e-128">Met deze configuratie kunt elk bericht uit de POS-aansluitingen beschikbaar wordt gesteld aan zowel de **Dashboard** en **inventaris** abonnementen.</span><span class="sxs-lookup"><span data-stu-id="a518e-128">With this configuration, each message from the POS terminals is made available to both the **Dashboard** and **Inventory** subscriptions.</span></span>

## <a name="show-me-the-code"></a><span data-ttu-id="a518e-129">De code weergeven</span><span class="sxs-lookup"><span data-stu-id="a518e-129">Show me the code</span></span>
<span data-ttu-id="a518e-130">Het artikel [maken van toepassingen die gebruikmaken van Service Bus-wachtrijen](service-bus-create-queues.md) wordt beschreven hoe u zich aanmeldt voor een Azure-account en een Servicenaamruimte maken.</span><span class="sxs-lookup"><span data-stu-id="a518e-130">The article [Create applications that use Service Bus queues](service-bus-create-queues.md) describes how to sign up for an Azure account and create a service namespace.</span></span> <span data-ttu-id="a518e-131">De eenvoudigste manier om te verwijzen naar Service Bus-afhankelijkheden voor het installeren van de Service Bus is [Nuget-pakket](https://www.nuget.org/packages/WindowsAzure.ServiceBus/).</span><span class="sxs-lookup"><span data-stu-id="a518e-131">The easiest way to reference Service Bus dependencies is to install the Service Bus [Nuget package](https://www.nuget.org/packages/WindowsAzure.ServiceBus/).</span></span> <span data-ttu-id="a518e-132">U kunt ook de Service Bus-bibliotheken vinden als onderdeel van de Azure SDK.</span><span class="sxs-lookup"><span data-stu-id="a518e-132">You can also find the Service Bus libraries as part of the Azure SDK.</span></span> <span data-ttu-id="a518e-133">Het downloaden is beschikbaar op de [-SDK van Azure-downloadpagina](https://azure.microsoft.com/downloads/).</span><span class="sxs-lookup"><span data-stu-id="a518e-133">The download is available at the [Azure SDK download page](https://azure.microsoft.com/downloads/).</span></span>

### <a name="create-the-topic-and-subscriptions"></a><span data-ttu-id="a518e-134">Het onderwerp en abonnementen maken</span><span class="sxs-lookup"><span data-stu-id="a518e-134">Create the topic and subscriptions</span></span>
<span data-ttu-id="a518e-135">Beheerbewerkingen voor Service Bus messaging-entiteiten (wachtrijen en publiceren/abonneren onderwerpen) worden uitgevoerd via de [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager#microsoft_servicebus_namespacemanager) klasse.</span><span class="sxs-lookup"><span data-stu-id="a518e-135">Management operations for Service Bus messaging entities (queues and publish/subscribe topics) are performed via the [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager#microsoft_servicebus_namespacemanager) class.</span></span> <span data-ttu-id="a518e-136">Juiste referenties zijn vereist voor het maken van een **NamespaceManager** exemplaar voor een bepaalde naamruimte.</span><span class="sxs-lookup"><span data-stu-id="a518e-136">Appropriate credentials are required in order to create a **NamespaceManager** instance for a particular namespace.</span></span> <span data-ttu-id="a518e-137">Service Bus maakt gebruik van een [Shared Access Signature (SAS)](service-bus-sas.md) op basis van het beveiligingsmodel.</span><span class="sxs-lookup"><span data-stu-id="a518e-137">Service Bus uses a [Shared Access Signature (SAS)](service-bus-sas.md) based security model.</span></span> <span data-ttu-id="a518e-138">De [TokenProvider](/dotnet/api/microsoft.servicebus.tokenprovider#microsoft_servicebus_tokenprovider) klasse vertegenwoordigt een beveiligingstokenprovider met ingebouwde factorymethoden retourneren sommige bekende token providers.</span><span class="sxs-lookup"><span data-stu-id="a518e-138">The [TokenProvider](/dotnet/api/microsoft.servicebus.tokenprovider#microsoft_servicebus_tokenprovider) class represents a security token provider with built-in factory methods returning some well-known token providers.</span></span> <span data-ttu-id="a518e-139">We gebruiken een [CreateSharedAccessSignatureTokenProvider](/dotnet/api/microsoft.servicebus.tokenprovider#Microsoft_ServiceBus_TokenProvider_CreateSharedAccessSignatureTokenProvider_System_String_) methode voor het opslaan van de SAS-referenties.</span><span class="sxs-lookup"><span data-stu-id="a518e-139">We’ll use a [CreateSharedAccessSignatureTokenProvider](/dotnet/api/microsoft.servicebus.tokenprovider#Microsoft_ServiceBus_TokenProvider_CreateSharedAccessSignatureTokenProvider_System_String_) method to hold the SAS credentials.</span></span> <span data-ttu-id="a518e-140">De [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager#microsoft_servicebus_namespacemanager) exemplaar vervolgens met het basisadres van de Service Bus-naamruimte en de tokenprovider is samengesteld.</span><span class="sxs-lookup"><span data-stu-id="a518e-140">The [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager#microsoft_servicebus_namespacemanager) instance is then constructed with the base address of the Service Bus namespace and the token provider.</span></span>

<span data-ttu-id="a518e-141">De [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager#microsoft_servicebus_namespacemanager) klasse biedt methoden voor het maken, opsommen en verwijderen van berichtentiteiten.</span><span class="sxs-lookup"><span data-stu-id="a518e-141">The [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager#microsoft_servicebus_namespacemanager) class provides methods to create, enumerate and delete messaging entities.</span></span> <span data-ttu-id="a518e-142">De code die hier toont weergegeven wordt hoe de **NamespaceManager** exemplaar is gemaakt en gebruikt voor het maken van de **DataCollectionTopic** onderwerp.</span><span class="sxs-lookup"><span data-stu-id="a518e-142">The code that is shown here shows how the **NamespaceManager** instance is created and used to create the **DataCollectionTopic** topic.</span></span>

```csharp
Uri uri = ServiceBusEnvironment.CreateServiceUri("sb", "test-blog", string.Empty);
string name = "RootManageSharedAccessKey";
string key = "abcdefghijklmopqrstuvwxyz";

TokenProvider tokenProvider = TokenProvider.CreateSharedAccessSignatureTokenProvider(name, key);
NamespaceManager namespaceManager = new NamespaceManager(uri, tokenProvider);

namespaceManager.CreateTopic("DataCollectionTopic");
```

<span data-ttu-id="a518e-143">Er zijn overloads van de [CreateTopic](/dotnet/api/microsoft.servicebus.namespacemanager#Microsoft_ServiceBus_NamespaceManager_CreateTopic_System_String_) methode waarmee u eigenschappen van het onderwerp in te stellen.</span><span class="sxs-lookup"><span data-stu-id="a518e-143">Note that there are overloads of the [CreateTopic](/dotnet/api/microsoft.servicebus.namespacemanager#Microsoft_ServiceBus_NamespaceManager_CreateTopic_System_String_) method that enable you to set properties of the topic.</span></span> <span data-ttu-id="a518e-144">U kunt bijvoorbeeld instellen dat de time-to-live (TTL) standaardwaarde voor berichten die worden verzonden naar het onderwerp.</span><span class="sxs-lookup"><span data-stu-id="a518e-144">For example, you can set the default time-to-live (TTL) value for messages sent to the topic.</span></span> <span data-ttu-id="a518e-145">Vervolgens voegt u de **inventaris** en **Dashboard** abonnementen.</span><span class="sxs-lookup"><span data-stu-id="a518e-145">Next, add the **Inventory** and **Dashboard** subscriptions.</span></span>

```csharp
namespaceManager.CreateSubscription("DataCollectionTopic", "Inventory");
namespaceManager.CreateSubscription("DataCollectionTopic", "Dashboard");
```

### <a name="send-messages-to-the-topic"></a><span data-ttu-id="a518e-146">Berichten naar het onderwerp verzenden</span><span class="sxs-lookup"><span data-stu-id="a518e-146">Send messages to the topic</span></span>
<span data-ttu-id="a518e-147">Voor runtime-bewerkingen voor Service Bus-entiteiten; bijvoorbeeld, verzenden en ontvangen berichten, een toepassing moet eerst maken een [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory#microsoft_servicebus_messaging_messagingfactory) object.</span><span class="sxs-lookup"><span data-stu-id="a518e-147">For run-time operations on Service Bus entities; for example, sending and receiving messages, an application must first create a [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory#microsoft_servicebus_messaging_messagingfactory) object.</span></span> <span data-ttu-id="a518e-148">Net als bij de [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager#microsoft_servicebus_namespacemanager) klasse, de **MessagingFactory** exemplaar wordt gemaakt van het basisadres van de Servicenaamruimte en de tokenprovider.</span><span class="sxs-lookup"><span data-stu-id="a518e-148">Similar to the [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager#microsoft_servicebus_namespacemanager) class, the **MessagingFactory** instance is created from the base address of the service namespace and the token provider.</span></span>

```
MessagingFactory factory = MessagingFactory.Create(uri, tokenProvider);
```

<span data-ttu-id="a518e-149">Berichten worden verzonden naar en ontvangen van Service Bus-onderwerpen, zijn exemplaren van de [BrokeredMessage](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage) klasse.</span><span class="sxs-lookup"><span data-stu-id="a518e-149">Messages sent to and received from Service Bus topics, are instances of the [BrokeredMessage](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage) class.</span></span> <span data-ttu-id="a518e-150">Deze klasse bestaat uit een aantal standaardeigenschappen (zoals [Label](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.label?view=azureservicebus-4.0.0#Microsoft_ServiceBus_Messaging_BrokeredMessage_Label) en [TimeToLive](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.timetolive?view=azureservicebus-4.0.0#Microsoft_ServiceBus_Messaging_BrokeredMessage_TimeToLive)), een woordenlijst die wordt gebruikt om de toepassingseigenschappen van de en een hoofdtekst met willekeurige toepassingsgegevens.</span><span class="sxs-lookup"><span data-stu-id="a518e-150">This class consists of a set of standard properties (such as [Label](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.label?view=azureservicebus-4.0.0#Microsoft_ServiceBus_Messaging_BrokeredMessage_Label) and [TimeToLive](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.timetolive?view=azureservicebus-4.0.0#Microsoft_ServiceBus_Messaging_BrokeredMessage_TimeToLive)), a dictionary that is used to hold application properties, and a body of arbitrary application data.</span></span> <span data-ttu-id="a518e-151">Een toepassing kan de instantie ingesteld door door te geven in elk serialiseerbaar object (in het volgende voorbeeld wordt doorgegeven een **SalesData** -object dat staat voor de verkoopgegevens uit de terminal POS), die wordt gebruikt de [DataContractSerializer](https://msdn.microsoft.com/library/system.runtime.serialization.datacontractserializer.aspx) om het object te serialiseren.</span><span class="sxs-lookup"><span data-stu-id="a518e-151">An application can set the body by passing in any serializable object (the following example passes in a **SalesData** object that represents the sales data from the POS terminal), which will use the [DataContractSerializer](https://msdn.microsoft.com/library/system.runtime.serialization.datacontractserializer.aspx) to serialize the object.</span></span> <span data-ttu-id="a518e-152">U kunt ook een [stroom](https://msdn.microsoft.com/library/system.io.stream.aspx) object kan worden opgegeven.</span><span class="sxs-lookup"><span data-stu-id="a518e-152">Alternatively, a [Stream](https://msdn.microsoft.com/library/system.io.stream.aspx) object can be provided.</span></span>

```csharp
BrokeredMessage bm = new BrokeredMessage(salesData);
bm.Label = "SalesReport";
bm.Properties["StoreName"] = "Redmond";
bm.Properties["MachineID"] = "POS_1";
```

<span data-ttu-id="a518e-153">De eenvoudigste manier om berichten te verzenden naar het onderwerp is met [CreateMessageSender](/dotnet/api/microsoft.servicebus.messaging.messagingfactory#Microsoft_ServiceBus_Messaging_MessagingFactory_CreateMessageSender_System_String_) maken een [MessageSender](/dotnet/api/microsoft.servicebus.messaging.messagesender) object rechtstreeks vanuit de [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory) exemplaar:</span><span class="sxs-lookup"><span data-stu-id="a518e-153">The easiest way to send messages to the topic is to use [CreateMessageSender](/dotnet/api/microsoft.servicebus.messaging.messagingfactory#Microsoft_ServiceBus_Messaging_MessagingFactory_CreateMessageSender_System_String_) to create a [MessageSender](/dotnet/api/microsoft.servicebus.messaging.messagesender) object directly from the [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory) instance:</span></span>

```csharp
MessageSender sender = factory.CreateMessageSender("DataCollectionTopic");
sender.Send(bm);
```

### <a name="receive-messages-from-a-subscription"></a><span data-ttu-id="a518e-154">Berichten ontvangen van een abonnement</span><span class="sxs-lookup"><span data-stu-id="a518e-154">Receive messages from a subscription</span></span>
<span data-ttu-id="a518e-155">Vergelijkbaar met het gebruik van wachtrijen, om berichten te ontvangen van een abonnement kunt u een [MessageReceiver](/dotnet/api/microsoft.servicebus.messaging.messagereceiver) -object dat u rechtstreeks vanuit maakt de [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory) met [ CreateMessageReceiver](/dotnet/api/microsoft.servicebus.messaging.messagingfactory#Microsoft_ServiceBus_Messaging_MessagingFactory_CreateMessageReceiver_System_String_).</span><span class="sxs-lookup"><span data-stu-id="a518e-155">Similar to using queues, to receive messages from a subscription you can use a [MessageReceiver](/dotnet/api/microsoft.servicebus.messaging.messagereceiver) object which you create directly from the [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory) using [CreateMessageReceiver](/dotnet/api/microsoft.servicebus.messaging.messagingfactory#Microsoft_ServiceBus_Messaging_MessagingFactory_CreateMessageReceiver_System_String_).</span></span> <span data-ttu-id="a518e-156">U kunt een van de twee verschillende modi ontvangen (**ReceiveAndDelete** en **PeekLock**), zoals beschreven in [maken van toepassingen die gebruikmaken van Service Bus-wachtrijen](service-bus-create-queues.md).</span><span class="sxs-lookup"><span data-stu-id="a518e-156">You can use one of the two different receive modes (**ReceiveAndDelete** and **PeekLock**), as discussed in [Create applications that use Service Bus queues](service-bus-create-queues.md).</span></span>

<span data-ttu-id="a518e-157">Houd er rekening mee dat bij het maken van een **MessageReceiver** voor abonnementen, de *entityPath* parameter is van het formulier `topicPath/subscriptions/subscriptionName`.</span><span class="sxs-lookup"><span data-stu-id="a518e-157">Note that when you create a **MessageReceiver** for subscriptions, the *entityPath* parameter is of the form `topicPath/subscriptions/subscriptionName`.</span></span> <span data-ttu-id="a518e-158">Daarom maken een **MessageReceiver** voor de **inventaris** abonnement van de **DataCollectionTopic** onderwerp *entityPath* moet worden ingesteld op `DataCollectionTopic/subscriptions/Inventory`.</span><span class="sxs-lookup"><span data-stu-id="a518e-158">Therefore, to create a **MessageReceiver** for the **Inventory** subscription of the **DataCollectionTopic** topic, *entityPath* must be set to `DataCollectionTopic/subscriptions/Inventory`.</span></span> <span data-ttu-id="a518e-159">De code er als volgt:</span><span class="sxs-lookup"><span data-stu-id="a518e-159">The code appears as follows:</span></span>

```csharp
MessageReceiver receiver = factory.CreateMessageReceiver("DataCollectionTopic/subscriptions/Inventory");
BrokeredMessage receivedMessage = receiver.Receive();
try
{
    ProcessMessage(receivedMessage);
    receivedMessage.Complete();
}
catch (Exception e)
{
    receivedMessage.Abandon();
}
```

## <a name="subscription-filters"></a><span data-ttu-id="a518e-160">Abonnementsfilters</span><span class="sxs-lookup"><span data-stu-id="a518e-160">Subscription filters</span></span>
<span data-ttu-id="a518e-161">Tot nu toe, in dit scenario worden alle berichten die naar het onderwerp beschikbaar gesteld aan alle geregistreerde abonnementen.</span><span class="sxs-lookup"><span data-stu-id="a518e-161">So far, in this scenario all messages sent to the topic are made available to all registered subscriptions.</span></span> <span data-ttu-id="a518e-162">De belangrijkste woordgroep hier worden 'beschikbaar gesteld."</span><span class="sxs-lookup"><span data-stu-id="a518e-162">The key phrase here is "made available."</span></span> <span data-ttu-id="a518e-163">Bij het Service Bus-abonnementen Zie alle berichten die naar het onderwerp, kunt u alleen een subset van deze berichten kunt kopiëren naar de abonnementenwachtrij voor virtuele.</span><span class="sxs-lookup"><span data-stu-id="a518e-163">While Service Bus subscriptions see all messages sent to the topic, you can copy only a subset of those messages to the virtual subscription queue.</span></span> <span data-ttu-id="a518e-164">Dit wordt uitgevoerd met behulp van abonnement *filters*.</span><span class="sxs-lookup"><span data-stu-id="a518e-164">This is performed using subscription *filters*.</span></span> <span data-ttu-id="a518e-165">Wanneer u een abonnement maakt, kunt u een filterexpressie in de vorm van een style-predikaat van SQL92 wordt geïmplementeerd dat via de eigenschappen van het bericht, de Systeemeigenschappen werkt opgeven (bijvoorbeeld [Label](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Label)) en de eigenschappen voor toepassingen , zoals **StoreName** in het vorige voorbeeld.</span><span class="sxs-lookup"><span data-stu-id="a518e-165">When you create a subscription, you can supply a filter expression in the form of a SQL92 style predicate that operates over the properties of the message, both the system properties (for example, [Label](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Label)) and the application properties, such as **StoreName** in the previous example.</span></span>

<span data-ttu-id="a518e-166">Het scenario ter illustratie in ontwikkeling, is een tweede archief worden toegevoegd aan onze retail-scenario.</span><span class="sxs-lookup"><span data-stu-id="a518e-166">Evolving the scenario to illustrate this, a second store is to be added to our retail scenario.</span></span> <span data-ttu-id="a518e-167">Verkoopgegevens uit alle van de POS-aansluitingen van beide winkels nog steeds worden doorgestuurd naar het beheersysteem gecentraliseerde voorraad, maar een winkelmanager hulpprogramma voor het dashboard is alleen geïnteresseerd in de prestaties van dat archief.</span><span class="sxs-lookup"><span data-stu-id="a518e-167">Sales data from all of the POS terminals from both stores still have to be routed to the centralized inventory management system, but a store manager using the dashboard tool is only interested in the performance of that store.</span></span> <span data-ttu-id="a518e-168">U kunt filteren om dit te bereiken abonnement gebruiken.</span><span class="sxs-lookup"><span data-stu-id="a518e-168">You can use subscription filtering to achieve this.</span></span> <span data-ttu-id="a518e-169">Houd er rekening mee dat wanneer de POS-aansluitingen berichten publiceert, ze ingesteld de **StoreName** eigenschap van toepassing op het bericht.</span><span class="sxs-lookup"><span data-stu-id="a518e-169">Note that when the POS terminals publish messages, they set the **StoreName** application property on the message.</span></span> <span data-ttu-id="a518e-170">Bijvoorbeeld twee winkels gegeven **Redmond** en **Seattle**, het POS-aansluitingen in het archief Redmond stempel hun verkoopgegevens berichten met een **StoreName** gelijk zijn aan **Redmond**, terwijl de Seattle opslaan POS aansluitingen gebruik een **StoreName** gelijk zijn aan **Seattle**.</span><span class="sxs-lookup"><span data-stu-id="a518e-170">Given two stores, for example **Redmond** and **Seattle**, the POS terminals in the Redmond store stamp their sales data messages with a **StoreName** equal to **Redmond**, whereas the Seattle store POS terminals use a **StoreName** equal to **Seattle**.</span></span> <span data-ttu-id="a518e-171">De winkelmanager van het archief Redmond wil alleen gegevens uit de POS-aansluitingen bekijken.</span><span class="sxs-lookup"><span data-stu-id="a518e-171">The store manager of the Redmond store only wants to see data from its POS terminals.</span></span> <span data-ttu-id="a518e-172">Het systeem wordt als volgt weergegeven:</span><span class="sxs-lookup"><span data-stu-id="a518e-172">The system appears as follows:</span></span>

![Service-Bus4](./media/service-bus-create-topics-subscriptions/IC657167.gif)

<span data-ttu-id="a518e-174">Als u deze routering instelt, maakt u de **Dashboard** abonnement als volgt:</span><span class="sxs-lookup"><span data-stu-id="a518e-174">To set up this routing, you create the **Dashboard** subscription as follows:</span></span>

```csharp
SqlFilter dashboardFilter = new SqlFilter("StoreName = 'Redmond'");
namespaceManager.CreateSubscription("DataCollectionTopic", "Dashboard", dashboardFilter);
```

<span data-ttu-id="a518e-175">Met deze [abonnementfilter](/dotnet/api/microsoft.servicebus.messaging.sqlfilter), alleen berichten met de **StoreName** eigenschap ingesteld op **Redmond** wordt gekopieerd naar de virtuele wachtrij voor de  **Dashboard** abonnement.</span><span class="sxs-lookup"><span data-stu-id="a518e-175">With this [subscription filter](/dotnet/api/microsoft.servicebus.messaging.sqlfilter), only messages that have the **StoreName** property set to **Redmond** will be copied to the virtual queue for the **Dashboard** subscription.</span></span> <span data-ttu-id="a518e-176">Er is veel meer voor het abonnement filteren, maar.</span><span class="sxs-lookup"><span data-stu-id="a518e-176">There is much more to subscription filtering, however.</span></span> <span data-ttu-id="a518e-177">Toepassingen kunnen meerdere filterregels voor de per abonnement naast de mogelijkheid om te wijzigen van de eigenschappen van een bericht zoals dit wordt doorgegeven aan de virtuele wachtrij van een abonnement hebben.</span><span class="sxs-lookup"><span data-stu-id="a518e-177">Applications can have multiple filter rules per subscription in addition to the ability to modify the properties of a message as it passes to a subscription's virtual queue.</span></span>

## <a name="summary"></a><span data-ttu-id="a518e-178">Samenvatting</span><span class="sxs-lookup"><span data-stu-id="a518e-178">Summary</span></span>
<span data-ttu-id="a518e-179">Alle van de redenen om te gebruiken dat wordt beschreven in queuing [maken van toepassingen die gebruikmaken van Service Bus-wachtrijen](service-bus-create-queues.md) ook van toepassing op onderwerpen, speciaal:</span><span class="sxs-lookup"><span data-stu-id="a518e-179">All of the reasons to use queuing described in [Create applications that use Service Bus queues](service-bus-create-queues.md) also apply to topics, specifically:</span></span>

* <span data-ttu-id="a518e-180">Tijdelijke ontkoppeling – bericht producenten en consumenten hoeven niet te op hetzelfde moment online zijn.</span><span class="sxs-lookup"><span data-stu-id="a518e-180">Temporal decoupling – message producers and consumers do not have to be online at the same time.</span></span>
* <span data-ttu-id="a518e-181">Herverdeling van – pieken in load zijn vloeiend moeten worden gemaakt door het onderwerp zodat consumerende toepassingen moeten worden ingericht voor gemiddelde belasting in plaats van piekbelasting.</span><span class="sxs-lookup"><span data-stu-id="a518e-181">Load leveling – peaks in load are smoothed out by the topic enabling consuming applications to be provisioned for average load instead of peak load.</span></span>
* <span data-ttu-id="a518e-182">Taakverdeling – net als bij een wachtrij, kunt u meerdere concurrerende consumenten luistert op één abonnement, met elk bericht dat is doorgegeven aan slechts één van de consument, waardoor taakverdeling heeft.</span><span class="sxs-lookup"><span data-stu-id="a518e-182">Load balancing – similar to a queue, you can have multiple competing consumers listening on a single subscription, with each message handed off to only one of the consumers, thereby balancing load.</span></span>
* <span data-ttu-id="a518e-183">De koppeling – u kunt het messaging netwerk ontwikkelen zonder bestaande eindpunten; bijvoorbeeld, u abonnementen toevoegt of filters wijzigen naar een onderwerp om toe te staan voor nieuwe gebruikers.</span><span class="sxs-lookup"><span data-stu-id="a518e-183">Loose coupling – you can evolve the messaging network without affecting existing endpoints; for example, adding subscriptions or changing filters to a topic to allow for new consumers.</span></span>

## <a name="next-steps"></a><span data-ttu-id="a518e-184">Volgende stappen</span><span class="sxs-lookup"><span data-stu-id="a518e-184">Next steps</span></span>

<span data-ttu-id="a518e-185">Zie [maken van toepassingen die gebruikmaken van Service Bus-wachtrijen](service-bus-create-queues.md) voor informatie over het gebruik van wachtrijen in het POS retail-scenario.</span><span class="sxs-lookup"><span data-stu-id="a518e-185">See [Create applications that use Service Bus queues](service-bus-create-queues.md) for information about how to use queues in the POS retail scenario.</span></span>

