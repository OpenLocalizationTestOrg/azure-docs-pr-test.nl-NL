---
title: aaaWrite toepassingen die gebruikmaken van Azure Service Bus-wachtrijen | Microsoft Docs
description: Hoe toowrite een eenvoudige wachtrij gebaseerde toepassing die gebruikmaakt van Azure Service Bus.
services: service-bus-messaging
documentationcenter: na
author: sethmanheim
manager: timlt
editor: 
ms.assetid: 754d91b3-1426-405e-84b4-fd36d65b114a
ms.service: service-bus-messaging
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 08/07/2017
ms.author: sethm
ms.openlocfilehash: 93b75902a06becd6e33e05298e09f5669d0e2aef
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 10/06/2017
---
# <a name="create-applications-that-use-service-bus-queues"></a><span data-ttu-id="8fdf9-103">Toepassingen maken die gebruikmaken van Service Bus-wachtrijen</span><span class="sxs-lookup"><span data-stu-id="8fdf9-103">Create applications that use Service Bus queues</span></span>
<span data-ttu-id="8fdf9-104">In dit onderwerp wordt Service Bus-wachtrijen beschreven en ziet u hoe toowrite een eenvoudige wachtrij gebaseerde toepassing die gebruikmaakt van Service Bus.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-104">This topic describes Service Bus queues and shows how toowrite a simple queue-based application that uses Service Bus.</span></span>

<span data-ttu-id="8fdf9-105">Neem bijvoorbeeld een scenario van Hallo wereld van retail waarin verkoopgegevens uit afzonderlijke Point-of-Sale (POS) aansluitingen moet tooan inventaris beheersysteem dat wordt gebruikt voor Hallo gegevens toodetermine stock toobe aangevuld heeft doorgestuurd.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-105">Consider a scenario from hello world of retail in which sales data from individual Point-of-Sale (POS) terminals must be routed tooan inventory management system that uses hello data toodetermine when stock has toobe replenished.</span></span> <span data-ttu-id="8fdf9-106">Deze oplossing gebruikt Service Bus-berichtenservice voor Hallo communicatie tussen Hallo aansluitingen en beheersysteem Hallo-inventaris, zoals geïllustreerd in de volgende afbeelding Hallo:</span><span class="sxs-lookup"><span data-stu-id="8fdf9-106">This solution uses Service Bus messaging for hello communication between hello terminals and hello inventory management system, as illustrated in hello following figure:</span></span>

![Service Bus-wachtrijen afbeelding 1](./media/service-bus-create-queues/IC657161.gif)

<span data-ttu-id="8fdf9-108">Elke POS-terminal rapporteert de verkoopgegevens door het verzenden van berichten toohello **DataCollectionQueue**.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-108">Each POS terminal reports its sales data by sending messages toohello **DataCollectionQueue**.</span></span> <span data-ttu-id="8fdf9-109">Deze berichten blijven in deze wachtrij totdat ze worden opgehaald door beheersysteem Hallo-inventarisatie.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-109">These messages remain in this queue until they are retrieved by hello inventory management system.</span></span> <span data-ttu-id="8fdf9-110">Dit patroon wordt vaak aangeduid als *asynchrone messaging*omdat Hallo POS terminal heeft geen toowait op een antwoord van Hallo inventaris management system toocontinue verwerken.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-110">This pattern is often termed *asynchronous messaging*, because hello POS terminal does not have toowait for a reply from hello inventory management system toocontinue processing.</span></span>

## <a name="why-queuing"></a><span data-ttu-id="8fdf9-111">Waarom queuing?</span><span class="sxs-lookup"><span data-stu-id="8fdf9-111">Why queuing?</span></span>
<span data-ttu-id="8fdf9-112">Voordat we bekijkt hello-code die is vereist tooset van deze toepassing in, kunt u overwegen Hallo voordelen van het gebruik van een wachtrij in dit scenario in plaats van Hallo POS-aansluitingen communiceren rechtstreeks (synchroon) toohello beheersysteem inventariseren.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-112">Before we look at hello code that is required tooset up this application, consider hello advantages of using a queue in this scenario instead of having hello POS terminals talk directly (synchronously) toohello inventory management system.</span></span>

### <a name="temporal-decoupling"></a><span data-ttu-id="8fdf9-113">Tijdelijke ontkoppeling</span><span class="sxs-lookup"><span data-stu-id="8fdf9-113">Temporal decoupling</span></span>
<span data-ttu-id="8fdf9-114">Met Hallo asynchrone berichtenpatroon producenten en consumenten hoeft niet online toobe op Hallo hetzelfde moment.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-114">With hello asynchronous messaging pattern, producers and consumers do not have toobe online at hello same time.</span></span> <span data-ttu-id="8fdf9-115">Hallo berichteninfrastructuur slaat berichten veilig op totdat de verbruikende partij Hallo gereed tooreceive is ze.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-115">hello messaging infrastructure reliably stores messages until hello consuming party is ready tooreceive them.</span></span> <span data-ttu-id="8fdf9-116">Dit betekent dat het Hallo-onderdelen van Hallo gedistribueerde toepassing kunnen worden losgekoppeld-hetzij vrijwillig; bijvoorbeeld voor onderhoud, hetzij vanwege het vastlopen van tooa onderdeel, zonder het hele systeem Hallo.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-116">This means hello components of hello distributed application can be disconnected, either voluntarily; for example, for maintenance, or due tooa component crash, without affecting hello whole system.</span></span> <span data-ttu-id="8fdf9-117">Bovendien misschien verbruikt toepassing hello alleen toobe online bepaalde tijdstippen gedurende Hallo dag.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-117">Furthermore, hello consuming application may only have toobe online during certain times of hello day.</span></span> <span data-ttu-id="8fdf9-118">Bijvoorbeeld: in dit scenario retail Hallo inventaris beheersysteem mag slechts bestaan toocome online na het einde van de werkdag Hallo Hallo.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-118">For example, in this retail scenario, hello inventory management system may only have toocome online after hello end of hello business day.</span></span>

### <a name="load-leveling"></a><span data-ttu-id="8fdf9-119">Herverdeling van taken</span><span class="sxs-lookup"><span data-stu-id="8fdf9-119">Load leveling</span></span>
<span data-ttu-id="8fdf9-120">In veel toepassingen varieert de systeembelasting gedurende een periode, terwijl Hallo benodigde verwerkingstijd voor elke werkeenheid doorgaans constant blijft.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-120">In many applications system load varies over time, whereas hello processing time required for each unit of work is typically constant.</span></span> <span data-ttu-id="8fdf9-121">Tussen bericht producenten en consumenten met een wachtrij betekent dat Hallo consumerende toepassing (Hallo worker) heeft slechts toobe ingericht tooservice gemiddeld laden in plaats van een piekbelasting.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-121">Intermediating message producers and consumers with a queue means that hello consuming application (hello worker) only has toobe provisioned tooservice an average load rather than a peak load.</span></span> <span data-ttu-id="8fdf9-122">Hallo diepte van de wachtrij Hallo zal toenemen en contract zoals Hallo binnenkomende load varieert.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-122">hello depth of hello queue will grow and contract as hello incoming load varies.</span></span> <span data-ttu-id="8fdf9-123">Dit bespaart geld rechtstreeks met inachtneming van toohello hoeveelheid infrastructuur vereist tooservice Hallo toepassing werklast.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-123">This directly saves money with regard toohello amount of infrastructure required tooservice hello application load.</span></span>

![Service Bus-wachtrijen afbeelding 2](./media/service-bus-create-queues/IC657162.gif)

### <a name="load-balancing"></a><span data-ttu-id="8fdf9-125">Taakverdeling</span><span class="sxs-lookup"><span data-stu-id="8fdf9-125">Load balancing</span></span>
<span data-ttu-id="8fdf9-126">Als Hallo verkeer toeneemt, meer werkprocessen kunnen toegevoegde tooread uit Hallo worker wachtrij.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-126">As hello load increases, more worker processes can be added tooread from hello worker queue.</span></span> <span data-ttu-id="8fdf9-127">Elk bericht wordt verwerkt door slechts één van de werkprocessen Hallo.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-127">Each message is processed by only one of hello worker processes.</span></span> <span data-ttu-id="8fdf9-128">Bovendien kunt deze pull-gebaseerde taakverdeling voor optimaal gebruik van Hallo worker computers zelfs als Hallo worker computers met inachtneming van tooprocessing power verschillen, zoals ze op eigen maximale snelheid berichten ophalen.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-128">Furthermore, this pull-based load balancing allows for optimum usage of hello worker computers even if hello worker computers differ with regard tooprocessing power, as they will pull messages at their own maximum rate.</span></span> <span data-ttu-id="8fdf9-129">Dit patroon wordt vaak aangeduid als Hallo concurrerende gebruikspatroon.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-129">This pattern is often termed hello competing consumer pattern.</span></span>

![Service Bus-wachtrijen afbeelding 3](./media/service-bus-create-queues/IC657163.gif)

### <a name="loose-coupling"></a><span data-ttu-id="8fdf9-131">De koppeling</span><span class="sxs-lookup"><span data-stu-id="8fdf9-131">Loose coupling</span></span>
<span data-ttu-id="8fdf9-132">Message queuing toointermediate tussen bericht producenten en consumenten biedt een intrinsiek of koppeling tussen Hallo-onderdelen.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-132">Using message queuing toointermediate between message producers and consumers provides an intrinsic loose coupling between hello components.</span></span> <span data-ttu-id="8fdf9-133">Omdat producenten en consumenten niet op de hoogte van elkaar zijn, kan een gebruiker zonder gevolgen voor de producent Hallo worden bijgewerkt.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-133">Because producers and consumers are not aware of each other, a consumer can be upgraded without having any effect on hello producer.</span></span> <span data-ttu-id="8fdf9-134">Bovendien kan Hallo messaging-topologie ontwikkelen zonder bestaande Hallo-eindpunten.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-134">Furthermore, hello messaging topology can evolve without affecting hello existing endpoints.</span></span> <span data-ttu-id="8fdf9-135">Gaan we dit meer wanneer er iets over publiceren/abonneren.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-135">We’ll discuss this more when we talk about publish/subscribe.</span></span>

## <a name="show-me-hello-code"></a><span data-ttu-id="8fdf9-136">Hallo code weergeven</span><span class="sxs-lookup"><span data-stu-id="8fdf9-136">Show me hello code</span></span>
<span data-ttu-id="8fdf9-137">Hallo van de volgende sectie wordt weergegeven hoe toouse Service Bus toobuild deze toepassing.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-137">hello following section shows how toouse Service Bus toobuild this application.</span></span>

### <a name="sign-up-for-an-azure-account"></a><span data-ttu-id="8fdf9-138">Aanmelden voor een Azure-account</span><span class="sxs-lookup"><span data-stu-id="8fdf9-138">Sign up for an Azure account</span></span>
<span data-ttu-id="8fdf9-139">U moet een Azure-account in volgorde toostart werken met Service Bus.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-139">You’ll need an Azure account in order toostart working with Service Bus.</span></span> <span data-ttu-id="8fdf9-140">Als u nog geen een, kunt u zich aanmelden voor een gratis account [hier](https://azure.microsoft.com/pricing/free-trial/?WT.mc_id=A85619ABF).</span><span class="sxs-lookup"><span data-stu-id="8fdf9-140">If you do not already have one, you can sign up for a free account [here](https://azure.microsoft.com/pricing/free-trial/?WT.mc_id=A85619ABF).</span></span>

### <a name="create-a-namespace"></a><span data-ttu-id="8fdf9-141">Een naamruimte maken</span><span class="sxs-lookup"><span data-stu-id="8fdf9-141">Create a namespace</span></span>
<span data-ttu-id="8fdf9-142">Wanneer u een abonnement hebt, kunt u [een Servicenaamruimte maken](service-bus-create-namespace-portal.md).</span><span class="sxs-lookup"><span data-stu-id="8fdf9-142">Once you have a subscription, you can [create a service namespace](service-bus-create-namespace-portal.md).</span></span> <span data-ttu-id="8fdf9-143">Elke naamruimte fungeert als een scoping container voor een set van Service Bus-entiteiten.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-143">Each namespace acts as a scoping container for a set of Service Bus entities.</span></span> <span data-ttu-id="8fdf9-144">Geef uw nieuwe naamruimte een unieke naam alle Service Bus-accounts.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-144">Give your new namespace a unique name across all Service Bus accounts.</span></span> 

### <a name="install-hello-nuget-package"></a><span data-ttu-id="8fdf9-145">Hallo NuGet-pakket installeren</span><span class="sxs-lookup"><span data-stu-id="8fdf9-145">Install hello NuGet package</span></span>
<span data-ttu-id="8fdf9-146">toouse hello Service Bus-naamruimte, een toepassing moet verwijzen naar Hallo Service Bus, specifiek Microsoft.ServiceBus.dll-assembly.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-146">toouse hello Service Bus namespace, an application must reference hello Service Bus assembly, specifically Microsoft.ServiceBus.dll.</span></span> <span data-ttu-id="8fdf9-147">U vindt deze assembly als onderdeel van Microsoft Azure SDK Hallo en Hallo downloaden is beschikbaar op Hallo [-SDK van Azure-downloadpagina](https://azure.microsoft.com/downloads/).</span><span class="sxs-lookup"><span data-stu-id="8fdf9-147">You can find this assembly as part of hello Microsoft Azure SDK, and hello download is available at hello [Azure SDK download page](https://azure.microsoft.com/downloads/).</span></span> <span data-ttu-id="8fdf9-148">Hallo echter [Service Bus NuGet-pakket](https://www.nuget.org/packages/WindowsAzure.ServiceBus) is Hallo gemakkelijkste manier tooget Hallo Service Bus-API en tooconfigure uw toepassing met alle Hallo Service Bus-afhankelijkheden.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-148">However, hello [Service Bus NuGet package](https://www.nuget.org/packages/WindowsAzure.ServiceBus) is hello easiest way tooget hello Service Bus API and tooconfigure your application with all of hello Service Bus dependencies.</span></span>

### <a name="create-hello-queue"></a><span data-ttu-id="8fdf9-149">Hallo wachtrij maken</span><span class="sxs-lookup"><span data-stu-id="8fdf9-149">Create hello queue</span></span>
<span data-ttu-id="8fdf9-150">Beheerbewerkingen voor Service Bus messaging-entiteiten (wachtrijen en publiceren/abonneren onderwerpen) worden uitgevoerd via Hallo [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager) klasse.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-150">Management operations for Service Bus messaging entities (queues and publish/subscribe topics) are performed via hello [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager) class.</span></span> <span data-ttu-id="8fdf9-151">Service Bus maakt gebruik van een [Shared Access Signature (SAS)](service-bus-sas.md) op basis van het beveiligingsmodel.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-151">Service Bus uses a [Shared Access Signature (SAS)](service-bus-sas.md) based security model.</span></span> <span data-ttu-id="8fdf9-152">Hallo [TokenProvider](/dotnet/api/microsoft.servicebus.tokenprovider) klasse vertegenwoordigt een beveiligingstokenprovider met ingebouwde factorymethoden retourneren sommige bekende token providers.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-152">hello [TokenProvider](/dotnet/api/microsoft.servicebus.tokenprovider) class represents a security token provider with built-in factory methods returning some well-known token providers.</span></span> <span data-ttu-id="8fdf9-153">We gebruiken een [CreateSharedAccessSignatureTokenProvider](/dotnet/api/microsoft.servicebus.tokenprovider#Microsoft_ServiceBus_TokenProvider_CreateSharedAccessSignatureTokenProvider_System_String_) methode toohold Hallo SAS-referenties.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-153">We’ll use a [CreateSharedAccessSignatureTokenProvider](/dotnet/api/microsoft.servicebus.tokenprovider#Microsoft_ServiceBus_TokenProvider_CreateSharedAccessSignatureTokenProvider_System_String_) method toohold hello SAS credentials.</span></span> <span data-ttu-id="8fdf9-154">Hallo [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager) exemplaar vervolgens met het basisadres van Hallo Service Bus-naamruimte en de tokenprovider Hallo Hallo is samengesteld.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-154">hello [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager) instance is then constructed with hello base address of hello Service Bus namespace and hello token provider.</span></span>

<span data-ttu-id="8fdf9-155">Hallo [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager) klasse biedt methoden toocreate, opsommen en verwijderen van berichtentiteiten.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-155">hello [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager) class provides methods toocreate, enumerate and delete messaging entities.</span></span> <span data-ttu-id="8fdf9-156">code die hier wordt weergegeven ziet hoe Hallo Hallo [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager) exemplaar is gemaakt en gebruikt toocreate hello **DataCollectionQueue** wachtrij.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-156">hello code that is shown here shows how hello [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager) instance is created and used toocreate hello **DataCollectionQueue** queue.</span></span>

```csharp
Uri uri = ServiceBusEnvironment.CreateServiceUri("sb", 
                "test-blog", string.Empty);
string name = "RootManageSharedAccessKey";
string key = "abcdefghijklmopqrstuvwxyz";

TokenProvider tokenProvider = 
    TokenProvider.CreateSharedAccessSignatureTokenProvider(name, key);
NamespaceManager namespaceManager = 
    new NamespaceManager(uri, tokenProvider);
namespaceManager.CreateQueue("DataCollectionQueue");
```

<span data-ttu-id="8fdf9-157">Houd er rekening mee dat er overloads van Hallo zijn [CreateQueue](/dotnet/api/microsoft.servicebus.namespacemanager#Microsoft_ServiceBus_NamespaceManager_CreateQueue_System_String_) methode waarmee de eigenschappen van Hallo wachtrij toobe zijn afgestemd.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-157">Note that there are overloads of hello [CreateQueue](/dotnet/api/microsoft.servicebus.namespacemanager#Microsoft_ServiceBus_NamespaceManager_CreateQueue_System_String_) method that enable properties of hello queue toobe tuned.</span></span> <span data-ttu-id="8fdf9-158">U kunt bijvoorbeeld instellen dat Hallo time to live (TTL) standaardwaarde voor berichten die toohello wachtrij zijn verzonden.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-158">For example, you can set hello default time-to-live (TTL) value for messages sent toohello queue.</span></span>

### <a name="send-messages-toohello-queue"></a><span data-ttu-id="8fdf9-159">Berichten toohello wachtrij verzenden</span><span class="sxs-lookup"><span data-stu-id="8fdf9-159">Send messages toohello queue</span></span>
<span data-ttu-id="8fdf9-160">Voor runtime-bewerkingen voor Service Bus-entiteiten; bijvoorbeeld, verzenden en ontvangen berichten, een toepassing moet eerst maken een [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory) object.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-160">For run-time operations on Service Bus entities; for example, sending and receiving messages, an application must first create a [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory) object.</span></span> <span data-ttu-id="8fdf9-161">Vergelijkbare toohello [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager) klasse hello [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory) exemplaar uit het basisadres van Hallo-Servicenaamruimte en tokenprovider Hallo Hallo is gemaakt.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-161">Similar toohello [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager) class, hello [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory) instance is created from hello base address of hello service namespace and hello token provider.</span></span>

```csharp
 BrokeredMessage bm = new BrokeredMessage(salesData);
 bm.Label = "SalesReport";
 bm.Properties["StoreName"] = "Redmond";
 bm.Properties["MachineID"] = "POS_1";
```

<span data-ttu-id="8fdf9-162">Berichten worden verzonden naar en ontvangen van Service Bus-wachtrijen, zijn exemplaren van Hallo [BrokeredMessage](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage) klasse.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-162">Messages sent to, and received from Service Bus queues are instances of hello [BrokeredMessage](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage) class.</span></span> <span data-ttu-id="8fdf9-163">Deze klasse bestaat uit een aantal standaardeigenschappen (zoals [Label](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Label) en [TimeToLive](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_TimeToLive)), een woordenlijst die wordt gebruikt toohold toepassingseigenschappen en een hoofdtekst met willekeurige toepassingsgegevens.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-163">This class consists of a set of standard properties (such as [Label](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Label) and [TimeToLive](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_TimeToLive)), a dictionary that is used toohold application properties, and a body of arbitrary application data.</span></span> <span data-ttu-id="8fdf9-164">Een toepassing hello instantie worden ingesteld door door te geven in elk serialiseerbaar object (hello volgende voorbeeld wordt doorgegeven een **SalesData** -object met Hallo verkoopgegevens uit Hallo POS terminal), worden met bepaalde Hallo [ DataContractSerializer](https://msdn.microsoft.com/library/system.runtime.serialization.datacontractserializer.aspx) tooserialize Hallo-object.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-164">An application can set hello body by passing in any serializable object (hello following example passes in a **SalesData** object that represents hello sales data from hello POS terminal), which will use hello [DataContractSerializer](https://msdn.microsoft.com/library/system.runtime.serialization.datacontractserializer.aspx) tooserialize hello object.</span></span> <span data-ttu-id="8fdf9-165">U kunt ook een [stroom](https://msdn.microsoft.com/library/system.io.stream.aspx) object kan worden opgegeven.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-165">Alternatively, a [Stream](https://msdn.microsoft.com/library/system.io.stream.aspx) object can be provided.</span></span>

<span data-ttu-id="8fdf9-166">Hallo gemakkelijkste manier toosend berichten tooa wachtrij gegeven in ons geval Hallo **DataCollectionQueue**, is toouse [CreateMessageSender](/dotnet/api/microsoft.servicebus.messaging.messagingfactory#Microsoft_ServiceBus_Messaging_MessagingFactory_CreateMessageSender_System_String_) toocreate een [MessageSender](/dotnet/api/microsoft.servicebus.messaging.messagesender) object rechtstreeks vanuit Hallo [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory) exemplaar.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-166">hello easiest way toosend messages tooa given queue, in our case hello **DataCollectionQueue**, is toouse [CreateMessageSender](/dotnet/api/microsoft.servicebus.messaging.messagingfactory#Microsoft_ServiceBus_Messaging_MessagingFactory_CreateMessageSender_System_String_) toocreate a [MessageSender](/dotnet/api/microsoft.servicebus.messaging.messagesender) object directly from hello [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory) instance.</span></span>

```csharp
MessageSender sender = factory.CreateMessageSender("DataCollectionQueue");
sender.Send(bm);
```

### <a name="receiving-messages-from-hello-queue"></a><span data-ttu-id="8fdf9-167">Ontvangen van berichten uit de wachtrij Hallo</span><span class="sxs-lookup"><span data-stu-id="8fdf9-167">Receiving messages from hello queue</span></span>
<span data-ttu-id="8fdf9-168">tooreceive berichten uit de wachtrij hello, kunt u een [MessageReceiver](/dotnet/api/microsoft.servicebus.messaging.messagereceiver) -object dat u rechtstreeks vanuit Hallo maken [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory) met [CreateMessageReceiver](/dotnet/api/microsoft.servicebus.messaging.messagingfactory#Microsoft_ServiceBus_Messaging_MessagingFactory_CreateMessageReceiver_System_String_).</span><span class="sxs-lookup"><span data-stu-id="8fdf9-168">tooreceive messages from hello queue, you can use a [MessageReceiver](/dotnet/api/microsoft.servicebus.messaging.messagereceiver) object which you create directly from hello [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory) using [CreateMessageReceiver](/dotnet/api/microsoft.servicebus.messaging.messagingfactory#Microsoft_ServiceBus_Messaging_MessagingFactory_CreateMessageReceiver_System_String_).</span></span> <span data-ttu-id="8fdf9-169">Bericht ontvangers kunnen werken in twee verschillende modi: **ReceiveAndDelete** en **PeekLock**.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-169">Message receivers can work in two different modes: **ReceiveAndDelete** and **PeekLock**.</span></span> <span data-ttu-id="8fdf9-170">Hallo [ReceiveMode](/dotnet/api/microsoft.servicebus.messaging.receivemode) wordt ingesteld wanneer het Hallo-bericht ontvanger is gemaakt, als een parameter toohello [CreateMessageReceiver](/dotnet/api/microsoft.servicebus.messaging.messagingfactory?redirectedfrom=MSDN#Microsoft_ServiceBus_Messaging_MessagingFactory_CreateMessageReceiver_System_String_Microsoft_ServiceBus_Messaging_ReceiveMode_) aanroepen.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-170">hello [ReceiveMode](/dotnet/api/microsoft.servicebus.messaging.receivemode) is set when hello message receiver is created, as a parameter toohello [CreateMessageReceiver](/dotnet/api/microsoft.servicebus.messaging.messagingfactory?redirectedfrom=MSDN#Microsoft_ServiceBus_Messaging_MessagingFactory_CreateMessageReceiver_System_String_Microsoft_ServiceBus_Messaging_ReceiveMode_) call.</span></span>

<span data-ttu-id="8fdf9-171">Wanneer u Hallo **ReceiveAndDelete** modus Hallo ontvangen is een één bewerking uitgevoerd; dat wil zeggen als Service Bus Hallo aanvraag ontvangt, wordt gemarkeerd als verbruikt het Hallo-bericht en retourneert het toohello toepassing.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-171">When using hello **ReceiveAndDelete** mode, hello receive is a single-shot operation; that is, when Service Bus receives hello request, it marks hello message as being consumed and returns it toohello application.</span></span> <span data-ttu-id="8fdf9-172">**ReceiveAndDelete** modus is Hallo eenvoudigste model en werkt het beste voor scenario's in welke Hallo toepassing niet verwerken van een bericht tolereren kan als een fout toooccur zijn.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-172">**ReceiveAndDelete** mode is hello simplest model and works best for scenarios in which hello application can tolerate not processing a message if a failure were toooccur.</span></span> <span data-ttu-id="8fdf9-173">toounderstand dit, Neem bijvoorbeeld een scenario in welke problemen van de consument Hallo Hallo aanvraag ontvangen en vervolgens vastloopt voordat het wordt verwerkt.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-173">toounderstand this, consider a scenario in which hello consumer issues hello receive request and then crashes before processing it.</span></span> <span data-ttu-id="8fdf9-174">Omdat Service Bus gemarkeerd als verbruikt het Hallo-bericht, wanneer Hallo toepassing opnieuw wordt gestart en het verbruik van berichten opnieuw hebt gestart, ontbreekt het Hallo-bericht dat voordat Hallo vastlopen is verbruikt.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-174">Since Service Bus marked hello message as being consumed, when hello application restarts and starts consuming messages again, it will have missed hello message that was consumed before hello crash.</span></span>

<span data-ttu-id="8fdf9-175">In **PeekLock** modus Hallo ontvangen, wordt een bewerking met twee fasen, waardoor het mogelijk toosupport toepassingen die geen ontbrekende berichten kunnen tolereren.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-175">In **PeekLock** mode, hello receive becomes a two-stage operation, which makes it possible toosupport applications that cannot tolerate missing messages.</span></span> <span data-ttu-id="8fdf9-176">Als Service Bus Hallo aanvraag ontvangt, zoeken naar het volgende bericht toobe Hallo verbruikt, wordt vergrendeld tooprevent andere consumenten het ontvangen en retourneert vervolgens toohello toepassing.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-176">When Service Bus receives hello request, it finds hello next message toobe consumed, locks it tooprevent other consumers receiving it, and then returns it toohello application.</span></span> <span data-ttu-id="8fdf9-177">Nadat de toepassing hello klaar is met verwerking van het Hallo-bericht (of veilig heeft opgeslagen voor toekomstige verwerking), is de tweede fase Hallo Hallo voltooid proces ontvangen door het aanroepen van [Complete](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Complete) op Hallo ontvangen bericht.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-177">After hello application finishes processing hello message (or stores it reliably for future processing), it completes hello second stage of hello receive process by calling [Complete](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Complete) on hello received message.</span></span> <span data-ttu-id="8fdf9-178">Wanneer Service Bus de aanroep Hallo [Complete](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Complete) aanroep, worden gemarkeerd als verbruikt het Hallo-bericht.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-178">When Service Bus sees hello [Complete](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Complete) call, it marks hello message as being consumed.</span></span>

<span data-ttu-id="8fdf9-179">Er zijn twee andere resultaten mogelijk.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-179">Two other outcomes are possible.</span></span> <span data-ttu-id="8fdf9-180">Eerst als Hallo toepassing niet kan tooprocess hello bericht voor een bepaalde reden, kan worden aangeroepen [afbreken](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Abandon) op ontvangen Hallo-bericht (in plaats van [Complete](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Complete)).</span><span class="sxs-lookup"><span data-stu-id="8fdf9-180">First, if hello application is unable tooprocess hello message for some reason, it can call [Abandon](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Abandon) on hello received message (instead of [Complete](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Complete)).</span></span> <span data-ttu-id="8fdf9-181">Dit zorgt ervoor dat Service Bus toounlock Hallo-bericht en kunt u de beschikbare toobe opnieuw ontvangen, ofwel door dezelfde gebruiker Hallo of door een andere voltooit consumer.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-181">This causes Service Bus toounlock hello message and make it available toobe received again, either by hello same consumer or by another completing consumer.</span></span> <span data-ttu-id="8fdf9-182">Ten tweede er is een time-out gekoppeld aan Hallo vergrendelen en als toepassing hello Hallo-bericht kan niet worden verwerkt voordat Hallo time-out vergrendeling verloopt (bijvoorbeeld als Hallo toepassing vastloopt), en vervolgens de Service Bus wordt ontgrendeld Hallo-bericht, waardoor het beschikbaar toobe opnieuw ontvangen (in wezen uitvoeren van een [afbreken](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Abandon) bewerking standaard).</span><span class="sxs-lookup"><span data-stu-id="8fdf9-182">Second, there is a time-out associated with hello lock and if hello application cannot process hello message before hello lock time-out expires (for example, if hello application crashes), then Service Bus will unlock hello message and make it available toobe received again (essentially performing an [Abandon](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Abandon) operation by default).</span></span>

<span data-ttu-id="8fdf9-183">Houd er rekening mee dat als hello toepassing is vastgelopen na het Hallo-bericht worden verwerkt, maar voordat u Hallo [Complete](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Complete) verzoek is uitgegeven, is het Hallo-bericht opnieuw bezorgd toohello toepassing opnieuw wordt gestart.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-183">Note that if hello application crashes after it processes hello message but before hello [Complete](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Complete) request was issued, hello message will be redelivered toohello application when it restarts.</span></span> <span data-ttu-id="8fdf9-184">Dit wordt vaak aangeduid als * tenminste eenmaal * verwerken.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-184">This is often termed *At Least Once * processing.</span></span> <span data-ttu-id="8fdf9-185">Dit betekent dat elk bericht ten minste één keer wordt verwerkt, maar in bepaalde situaties Hallo hetzelfde bericht opnieuw kan worden bezorgd.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-185">This means that each message will be processed at least once but in certain situations hello same message may be redelivered.</span></span> <span data-ttu-id="8fdf9-186">Als Hallo scenario kan geen dubbele verwerking tolereren, is de aanvullende logica Hallo toepassing toodetect dubbele vereist.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-186">If hello scenario cannot tolerate duplicate processing, then additional logic is required in hello application toodetect duplicates.</span></span> <span data-ttu-id="8fdf9-187">Dit kan worden bereikt op basis van Hallo [MessageId](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_MessageId) eigenschap van het Hallo-bericht.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-187">This can be achieved based on hello [MessageId](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_MessageId) property of hello message.</span></span> <span data-ttu-id="8fdf9-188">Hallo-waarde van deze eigenschap gelijk blijft bij meerdere bezorgingspogingen.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-188">hello value of this property remains constant across delivery attempts.</span></span> <span data-ttu-id="8fdf9-189">Dit wordt aangeduid als *exact één keer* verwerken.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-189">This is termed *Exactly Once* processing.</span></span>

<span data-ttu-id="8fdf9-190">Hallo code die hier wordt weergegeven, ontvangt en verwerkt een bericht met Hallo **PeekLock** modus Hallo standaard als er geen [ReceiveMode](/dotnet/api/microsoft.servicebus.messaging.receivemode) waarde expliciet wordt aangeboden.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-190">hello code that is shown here receives and processes a message using hello **PeekLock** mode, which is hello default if no [ReceiveMode](/dotnet/api/microsoft.servicebus.messaging.receivemode) value is explicitly provided.</span></span>

```csharp
MessageReceiver receiver = factory.CreateMessageReceiver("DataCollectionQueue");
BrokeredMessage receivedMessage = receiver.Receive();
try
{
    ProcessMessage(receivedMessage);
    receivedMessage.Complete();
}
catch (Exception e)
{
    receivedMessage.Abandon();
}
```

### <a name="use-hello-queue-client"></a><span data-ttu-id="8fdf9-191">Hallo wachtrij-client gebruiken</span><span class="sxs-lookup"><span data-stu-id="8fdf9-191">Use hello queue client</span></span>
<span data-ttu-id="8fdf9-192">Hallo voorbeelden eerder in deze sectie gemaakt [MessageSender](/dotnet/api/microsoft.servicebus.messaging.messagesender) en [MessageReceiver](/dotnet/api/microsoft.servicebus.messaging.messagereceiver) objecten rechtstreeks vanuit Hallo [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory) toosend en kunnen berichten ontvangen uit de wachtrij hello, respectievelijk.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-192">hello examples earlier in this section created [MessageSender](/dotnet/api/microsoft.servicebus.messaging.messagesender) and [MessageReceiver](/dotnet/api/microsoft.servicebus.messaging.messagereceiver) objects directly from hello [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory) toosend and receive messages from hello queue, respectively.</span></span> <span data-ttu-id="8fdf9-193">Een alternatieve methode is toouse een [QueueClient](/dotnet/api/microsoft.servicebus.messaging.queueclient) object, die ondersteuning biedt zowel bij het verzenden en ontvangen van bewerkingen in toevoeging toomore geavanceerde functies, zoals sessies.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-193">An alternative approach is toouse a [QueueClient](/dotnet/api/microsoft.servicebus.messaging.queueclient) object, which supports both send and receive operations in addition toomore advanced features, such as sessions.</span></span>

```csharp
QueueClient queueClient = factory.CreateQueueClient("DataCollectionQueue");
queueClient.Send(bm);

BrokeredMessage message = queueClient.Receive();

try
{
    ProcessMessage(message);
    message.Complete();
}
catch (Exception e)
{
    message.Abandon();
} 
```

## <a name="next-steps"></a><span data-ttu-id="8fdf9-194">Volgende stappen</span><span class="sxs-lookup"><span data-stu-id="8fdf9-194">Next steps</span></span>
<span data-ttu-id="8fdf9-195">Nu u Hallo basisprincipes van wachtrijen hebt geleerd, gaat u naar [toepassingen die gebruikmaken van Service Bus-onderwerpen en abonnementen maken](service-bus-create-topics-subscriptions.md) toocontinue deze discussie met Hallo mogelijkheden voor publiceren/abonneren van Service Bus-onderwerpen en abonnementen.</span><span class="sxs-lookup"><span data-stu-id="8fdf9-195">Now that you've learned hello basics of queues, see [Create applications that use Service Bus topics and subscriptions](service-bus-create-topics-subscriptions.md) toocontinue this discussion using hello publish/subscribe capabilities of Service Bus topics and subscriptions.</span></span>

