---
title: De Azure MFA NPS-uitbreiding configureren | Microsoft Docs
description: Nadat u de extensie NPS, volg deze stappen voor geavanceerde configuratie zoals IP-whitelisting en UPN vervanging.
services: multi-factor-authentication
documentationcenter: 
author: kgremban
manager: femila
ms.assetid: 
ms.service: multi-factor-authentication
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/14/2017
ms.author: kgremban
ms.reviewer: yossib
ms.custom: it-pro
ms.openlocfilehash: ef922668f080b8f02f07c2f9724f5a98171fb754
ms.sourcegitcommit: 422efcbac5b6b68295064bd545132fcc98349d01
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 07/29/2017
---
# <a name="advanced-configuration-options-for-the-nps-extension-for-multi-factor-authentication"></a><span data-ttu-id="71bff-103">Geavanceerde configuratieopties voor de NPS-extensie voor multi-factor Authentication</span><span class="sxs-lookup"><span data-stu-id="71bff-103">Advanced configuration options for the NPS extension for Multi-Factor Authentication</span></span>

<span data-ttu-id="71bff-104">De extensie Network Policy Server (NPS) breidt uw cloud-gebaseerde Azure multi-factor Authentication-functies in uw on-premises infrastructuur.</span><span class="sxs-lookup"><span data-stu-id="71bff-104">The Network Policy Server (NPS) extension extends your cloud-based Azure Multi-Factor Authentication features into your on-premises infrastructure.</span></span> <span data-ttu-id="71bff-105">In dit artikel wordt ervan uitgegaan dat u al de extensie die is ge√Ønstalleerd hebben en wilt weten hoe de extensie aanpassen voor uw behoeften.</span><span class="sxs-lookup"><span data-stu-id="71bff-105">This article assumes that you already have the extension installed, and now want to know how to customize the extension for you needs.</span></span> 

## <a name="alternate-login-id"></a><span data-ttu-id="71bff-106">Alternatieve aanmeldings-ID</span><span class="sxs-lookup"><span data-stu-id="71bff-106">Alternate login ID</span></span>

<span data-ttu-id="71bff-107">Aangezien de NPS-extensie maakt verbinding met uw on-premises en de cloud-adreslijsten, kunnen er een probleem waarbij uw lokale UPN-namen (UPN's) komen niet overeen met de namen in de cloud.</span><span class="sxs-lookup"><span data-stu-id="71bff-107">Since the NPS extension connects to both your on-premises and cloud directories, you might encounter an issue where your on-premises user principal names (UPNs) don't match the names in the cloud.</span></span> <span data-ttu-id="71bff-108">U lost dit probleem, alternatieve aanmeldings-id's te gebruiken.</span><span class="sxs-lookup"><span data-stu-id="71bff-108">To solve this problem, use alternate login IDs.</span></span> 

<span data-ttu-id="71bff-109">Met de extensie NPS, kunt u een Active Directory-kenmerk moet worden gebruikt in plaats van de UPN voor Azure multi-factor Authentication aanwijzen.</span><span class="sxs-lookup"><span data-stu-id="71bff-109">Within the NPS extension, you can designate an Active Directory attribute to be used in place of the UPN for Azure Multi-Factor Authentication.</span></span> <span data-ttu-id="71bff-110">Hiermee kunt u bij de bescherming van uw lokale bronnen met verificatie in twee stappen zonder het wijzigen van uw lokale UPN's.</span><span class="sxs-lookup"><span data-stu-id="71bff-110">This enables you to protect your on-premises resources with two-step verification without modifying your on-premises UPNs.</span></span> 

<span data-ttu-id="71bff-111">Alternatieve aanmeldings-id's configureren, gaat u naar `HKLM\SOFTWARE\Microsoft\AzureMfa` en bewerkt u de volgende registerwaarden:</span><span class="sxs-lookup"><span data-stu-id="71bff-111">To configure alternate login IDs, go to `HKLM\SOFTWARE\Microsoft\AzureMfa` and edit the following registry values:</span></span>

| <span data-ttu-id="71bff-112">Naam</span><span class="sxs-lookup"><span data-stu-id="71bff-112">Name</span></span> | <span data-ttu-id="71bff-113">Type</span><span class="sxs-lookup"><span data-stu-id="71bff-113">Type</span></span> | <span data-ttu-id="71bff-114">Standaardwaarde</span><span class="sxs-lookup"><span data-stu-id="71bff-114">Default value</span></span> | <span data-ttu-id="71bff-115">Beschrijving</span><span class="sxs-lookup"><span data-stu-id="71bff-115">Description</span></span> |
| ---- | ---- | ------------- | ----------- |
| <span data-ttu-id="71bff-116">LDAP_ALTERNATE_LOGINID_ATTRIBUTE</span><span class="sxs-lookup"><span data-stu-id="71bff-116">LDAP_ALTERNATE_LOGINID_ATTRIBUTE</span></span> | <span data-ttu-id="71bff-117">Tekenreeks</span><span class="sxs-lookup"><span data-stu-id="71bff-117">string</span></span> | <span data-ttu-id="71bff-118">leeg</span><span class="sxs-lookup"><span data-stu-id="71bff-118">Empty</span></span> | <span data-ttu-id="71bff-119">De naam van Active Directory-kenmerk dat u wilt gebruiken in plaats van de UPN aangegeven.</span><span class="sxs-lookup"><span data-stu-id="71bff-119">Designate the name of Active Directory attribute that you want to use instead of the UPN.</span></span> <span data-ttu-id="71bff-120">Dit kenmerk wordt gebruikt als het kenmerk AlternateLoginId.</span><span class="sxs-lookup"><span data-stu-id="71bff-120">This attribute is used as the AlternateLoginId attribute.</span></span> <span data-ttu-id="71bff-121">Als deze registerwaarde is ingesteld op een [geldig Active Directory-kenmerk](https://msdn.microsoft.com/library/ms675090.aspx) (voor bijvoorbeeld e-mail of weergavenaam), klikt u vervolgens de waarde van het kenmerk wordt gebruikt in plaats van de UPN van de gebruiker voor verificatie.</span><span class="sxs-lookup"><span data-stu-id="71bff-121">If this registry value is set to a [valid Active Directory attribute](https://msdn.microsoft.com/library/ms675090.aspx) (for example, mail or displayName), then the attribute's value is used in place of the user's UPN for authentication.</span></span> <span data-ttu-id="71bff-122">Als deze registerwaarde leeg of niet is is geconfigureerd, klikt u vervolgens AlternateLoginId is uitgeschakeld en de UPN van de gebruiker wordt gebruikt voor verificatie.</span><span class="sxs-lookup"><span data-stu-id="71bff-122">If this registry value is empty or not configured, then AlternateLoginId is disabled and the user's UPN is used for authentication.</span></span> |
| <span data-ttu-id="71bff-123">LDAP_FORCE_GLOBAL_CATALOG</span><span class="sxs-lookup"><span data-stu-id="71bff-123">LDAP_FORCE_GLOBAL_CATALOG</span></span> | <span data-ttu-id="71bff-124">Booleaanse waarde</span><span class="sxs-lookup"><span data-stu-id="71bff-124">boolean</span></span> | <span data-ttu-id="71bff-125">False</span><span class="sxs-lookup"><span data-stu-id="71bff-125">False</span></span> | <span data-ttu-id="71bff-126">Deze optie om af te dwingen het gebruik van de globale catalogus voor LDAP-zoekopdrachten bij het opzoeken van AlternateLoginId gebruikt.</span><span class="sxs-lookup"><span data-stu-id="71bff-126">Use this flag to force the use of Global Catalog for LDAP searches when looking up AlternateLoginId.</span></span> <span data-ttu-id="71bff-127">Een domeincontroller configureren als een globale catalogus, het kenmerk AlternateLoginId toevoegen aan de globale catalogus en vervolgens deze optie inschakelen.</span><span class="sxs-lookup"><span data-stu-id="71bff-127">Configure a domain controller as a Global Catalog, add the AlternateLoginId attribute to the Global Catalog, and then enable this flag.</span></span> <br><br> <span data-ttu-id="71bff-128">Als LDAP_LOOKUP_FORESTS is geconfigureerd (geen lege) **deze vlag wordt afgedwongen als waar**, ongeacht de waarde van de registerinstelling.</span><span class="sxs-lookup"><span data-stu-id="71bff-128">If LDAP_LOOKUP_FORESTS is configured (not empty), **this flag is enforced as true**, regardless of the value of the registry setting.</span></span> <span data-ttu-id="71bff-129">De NPS-extensie is in dit geval wordt de globale catalogus worden geconfigureerd met het kenmerk AlternateLoginId voor elk forest vereist.</span><span class="sxs-lookup"><span data-stu-id="71bff-129">In this case, the NPS extension requires the Global Catalog to be configured with the AlternateLoginId attribute for each forest.</span></span> |
| <span data-ttu-id="71bff-130">LDAP_LOOKUP_FORESTS</span><span class="sxs-lookup"><span data-stu-id="71bff-130">LDAP_LOOKUP_FORESTS</span></span> | <span data-ttu-id="71bff-131">Tekenreeks</span><span class="sxs-lookup"><span data-stu-id="71bff-131">string</span></span> | <span data-ttu-id="71bff-132">leeg</span><span class="sxs-lookup"><span data-stu-id="71bff-132">Empty</span></span> | <span data-ttu-id="71bff-133">Geef een puntkomma's gescheiden lijst van forests om te zoeken.</span><span class="sxs-lookup"><span data-stu-id="71bff-133">Provide a semi-colon separated list of forests to search.</span></span> <span data-ttu-id="71bff-134">Bijvoorbeeld: *contoso.com;foobar.com*.</span><span class="sxs-lookup"><span data-stu-id="71bff-134">For example, *contoso.com;foobar.com*.</span></span> <span data-ttu-id="71bff-135">Als deze registerwaarde is geconfigureerd, zoekt de NPS-extensie alle forests iteratief in de volgorde waarin ze zijn vermeld, en retourneert de eerste geslaagde AlternateLoginId-waarde.</span><span class="sxs-lookup"><span data-stu-id="71bff-135">If this registry value is configured, the NPS extension iteratively searches all the forests in the order in which they were listed, and returns the first successful AlternateLoginId value.</span></span> <span data-ttu-id="71bff-136">Als deze registerwaarde niet is geconfigureerd, wordt de zoekopdracht AlternateLoginId beperkt tot het huidige domein.</span><span class="sxs-lookup"><span data-stu-id="71bff-136">If this registry value is not configured, the AlternateLoginId lookup is confined to the current domain.</span></span>|

<span data-ttu-id="71bff-137">Voor het oplossen van problemen met alternatieve aanmeldings-id's, kunt u de aanbevolen stappen voor [alternatieve aanmeldings-ID fouten](multi-factor-authentication-nps-errors.md#alternate-login-id-errors).</span><span class="sxs-lookup"><span data-stu-id="71bff-137">To troubleshoot problems with alternate login IDs, use the recommended steps for [Alternate login ID errors](multi-factor-authentication-nps-errors.md#alternate-login-id-errors).</span></span>

## <a name="ip-exceptions"></a><span data-ttu-id="71bff-138">IP-uitzonderingen</span><span class="sxs-lookup"><span data-stu-id="71bff-138">IP exceptions</span></span>

<span data-ttu-id="71bff-139">Als u bewaken van de beschikbaarheid van de server wilt, zoals als netwerktaakverdelers welke servers worden uitgevoerd controleren voordat u werkbelastingen, verzendt wilt u niet dat deze controles wordt geblokkeerd door de verificatie-aanvragen.</span><span class="sxs-lookup"><span data-stu-id="71bff-139">If you need to monitor server availability, like if load balancers verify which servers are running before sending workloads, you don't want these checks to be blocked by verification requests.</span></span> <span data-ttu-id="71bff-140">In plaats daarvan een lijst met IP-adressen die u kent worden gebruikt door de service-accounts maken en vereisten van de multi-factor Authentication voor die lijst uitschakelen.</span><span class="sxs-lookup"><span data-stu-id="71bff-140">Instead, create a list of IP addresses that you know are used by service accounts, and disable Multi-Factor Authentication requirements for that list.</span></span> 

<span data-ttu-id="71bff-141">Voor het configureren van een lijst met geaccepteerde IP-adressen, gaat u naar `HKLM\SOFTWARE\Microsoft\AzureMfa` en configureer de volgende registerwaarde:</span><span class="sxs-lookup"><span data-stu-id="71bff-141">To configure an IP whitelist, go to `HKLM\SOFTWARE\Microsoft\AzureMfa` and configure the following registry value:</span></span> 

| <span data-ttu-id="71bff-142">Naam</span><span class="sxs-lookup"><span data-stu-id="71bff-142">Name</span></span> | <span data-ttu-id="71bff-143">Type</span><span class="sxs-lookup"><span data-stu-id="71bff-143">Type</span></span> | <span data-ttu-id="71bff-144">Standaardwaarde</span><span class="sxs-lookup"><span data-stu-id="71bff-144">Default value</span></span> | <span data-ttu-id="71bff-145">Beschrijving</span><span class="sxs-lookup"><span data-stu-id="71bff-145">Description</span></span> |
| ---- | ---- | ------------- | ----------- |
| <span data-ttu-id="71bff-146">IP_WHITELIST</span><span class="sxs-lookup"><span data-stu-id="71bff-146">IP_WHITELIST</span></span> | <span data-ttu-id="71bff-147">Tekenreeks</span><span class="sxs-lookup"><span data-stu-id="71bff-147">string</span></span> | <span data-ttu-id="71bff-148">leeg</span><span class="sxs-lookup"><span data-stu-id="71bff-148">Empty</span></span> | <span data-ttu-id="71bff-149">Geef een puntkomma's gescheiden lijst van IP-adressen.</span><span class="sxs-lookup"><span data-stu-id="71bff-149">Provide a semi-colon separated list of IP addresses.</span></span> <span data-ttu-id="71bff-150">De IP-adressen van computers waar serviceaanvragen afkomstig, zoals de NAS/VPN-server zijn bevatten.</span><span class="sxs-lookup"><span data-stu-id="71bff-150">Include the IP addresses of machines where service requests originate, like the NAS/VPN server.</span></span> <span data-ttu-id="71bff-151">IP-adresbereiken zijn subnetten worden niet ondersteund.</span><span class="sxs-lookup"><span data-stu-id="71bff-151">IP ranges are subnets are not supported.</span></span> <br><br> <span data-ttu-id="71bff-152">Bijvoorbeeld: *10.0.0.1;10.0.0.2;10.0.0.3*.</span><span class="sxs-lookup"><span data-stu-id="71bff-152">For example, *10.0.0.1;10.0.0.2;10.0.0.3*.</span></span>

<span data-ttu-id="71bff-153">Wanneer een aanvraag afkomstig is van een IP-adres die in de lijst met geaccepteerde voorkomt, wordt verificatie in twee stappen overgeslagen.</span><span class="sxs-lookup"><span data-stu-id="71bff-153">When a request comes in from an IP address that exists in the whitelist, two-step verification is skipped.</span></span> <span data-ttu-id="71bff-154">De goedgekeurde IP-adressen wordt vergeleken met het IP-adres dat is opgegeven in de *ratNASIPAddress* kenmerk van de RADIUS-aanvraag.</span><span class="sxs-lookup"><span data-stu-id="71bff-154">The IP whitelist is compared to the IP address that is provided in the *ratNASIPAddress* attribute of the RADIUS request.</span></span> <span data-ttu-id="71bff-155">Als een RADIUS-aanvraag wordt geleverd zonder het kenmerk ratNASIPAddress, de volgende waarschuwing wordt vastgelegd: 'P_WHITE_LIST_WARNING::IP geaccepteerde wordt genegeerd als de bron-IP ontbreekt in de RADIUS-aanvraag in NasIpAddress-kenmerk.'</span><span class="sxs-lookup"><span data-stu-id="71bff-155">If a RADIUS request comes in without the ratNASIPAddress attribute, the following warning is logged: "P_WHITE_LIST_WARNING::IP Whitelist is being ignored as source IP is missing in RADIUS request in NasIpAddress attribute."</span></span>

## <a name="next-steps"></a><span data-ttu-id="71bff-156">Volgende stappen</span><span class="sxs-lookup"><span data-stu-id="71bff-156">Next steps</span></span>

<span data-ttu-id="71bff-157">[Resolve error messages from the NPS extension for Azure Multi-Factor Authentication](multi-factor-authentication-nps-errors.md) (Foutberichten van de NPS-extensie voor Azure Multi-Factor Authentication oplossen)</span><span class="sxs-lookup"><span data-stu-id="71bff-157">[Resolve error messages from the NPS extension for Azure Multi-Factor Authentication](multi-factor-authentication-nps-errors.md)</span></span>