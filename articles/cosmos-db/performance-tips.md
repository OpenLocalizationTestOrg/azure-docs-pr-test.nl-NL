---
title: aaaPerformance tips - Azure Cosmos DB NoSQL | Microsoft Docs
description: Meer informatie over client configuration opties tooimprove Azure Cosmos DB prestaties van de database
keywords: hoe tooimprove prestaties database
services: cosmos-db
author: mimig1
manager: jhubbard
editor: 
documentationcenter: 
ms.assetid: 94ff155e-f9bc-488f-8c7a-5e7037091bb9
ms.service: cosmos-db
ms.workload: data-services
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 02/23/2017
ms.author: mimig
ms.openlocfilehash: 4f3e82ae5048e3dbc20b0fd891a2d3aa22adf3fc
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 10/06/2017
---
# <a name="performance-tips-for-azure-cosmos-db"></a><span data-ttu-id="6684c-104">Tips voor betere prestaties voor Azure Cosmos-DB</span><span class="sxs-lookup"><span data-stu-id="6684c-104">Performance tips for Azure Cosmos DB</span></span>
<span data-ttu-id="6684c-105">Azure Cosmos-database is een snelle en flexibele gedistribueerde database waarin naadloos met gegarandeerde latentie en doorvoer schaalt.</span><span class="sxs-lookup"><span data-stu-id="6684c-105">Azure Cosmos DB is a fast and flexible distributed database that scales seamlessly with guaranteed latency and throughput.</span></span> <span data-ttu-id="6684c-106">U geen toomake architectuur van belangrijke wijzigingen hebben of complexe code tooscale uw database met Cosmos DB schrijven.</span><span class="sxs-lookup"><span data-stu-id="6684c-106">You do not have toomake major architecture changes or write complex code tooscale your database with Cosmos DB.</span></span> <span data-ttu-id="6684c-107">Omhoog en omlaag schalen is net zo eenvoudig als het maken van één API-aanroep of [SDK-aanroep van methode](set-throughput.md#set-throughput-sdk).</span><span class="sxs-lookup"><span data-stu-id="6684c-107">Scaling up and down is as easy as making a single API call or [SDK method call](set-throughput.md#set-throughput-sdk).</span></span> <span data-ttu-id="6684c-108">Omdat Cosmos DB wordt benaderd zijn er netwerk aanroepen clientzijde optimalisaties kunt u tooachieve optimale prestaties.</span><span class="sxs-lookup"><span data-stu-id="6684c-108">However, because Cosmos DB is accessed via network calls there are client-side optimizations you can make tooachieve peak performance.</span></span>

<span data-ttu-id="6684c-109">Dus als u vraagt "hoe kan ik mijn de databaseprestaties verbeteren?"</span><span class="sxs-lookup"><span data-stu-id="6684c-109">So if you're asking "How can I improve my database performance?"</span></span> <span data-ttu-id="6684c-110">Houd rekening met Hallo volgende opties:</span><span class="sxs-lookup"><span data-stu-id="6684c-110">consider hello following options:</span></span>

## <a name="networking"></a><span data-ttu-id="6684c-111">Netwerken</span><span class="sxs-lookup"><span data-stu-id="6684c-111">Networking</span></span>
<a id="direct-connection"></a>

1. <span data-ttu-id="6684c-112">**Verbindingsbeleid: de modus rechtstreekse verbinding gebruiken**</span><span class="sxs-lookup"><span data-stu-id="6684c-112">**Connection policy: Use direct connection mode**</span></span>

    <span data-ttu-id="6684c-113">Hoe een client verbinding maakt met tooCosmos DB heeft belangrijke gevolgen voor de prestaties, met name in termen van waargenomen-clientzijde latentie.</span><span class="sxs-lookup"><span data-stu-id="6684c-113">How a client connects tooCosmos DB has important implications on performance, especially in terms of observed client-side latency.</span></span> <span data-ttu-id="6684c-114">Er zijn twee belangrijke configuratie-instellingen beschikbaar zijn voor het configureren van client verbindingsbeleid – Hallo verbinding *modus* en Hallo [verbinding *protocol*](#connection-protocol).</span><span class="sxs-lookup"><span data-stu-id="6684c-114">There are two key configuration settings available for configuring client Connection Policy – hello connection *mode* and hello [connection *protocol*](#connection-protocol).</span></span>  <span data-ttu-id="6684c-115">Hallo-modi voor twee beschikbaar zijn:</span><span class="sxs-lookup"><span data-stu-id="6684c-115">hello two available modes are:</span></span>

   1. <span data-ttu-id="6684c-116">Gateway-modus (standaard)</span><span class="sxs-lookup"><span data-stu-id="6684c-116">Gateway Mode (default)</span></span>
   2. <span data-ttu-id="6684c-117">Directe modus</span><span class="sxs-lookup"><span data-stu-id="6684c-117">Direct Mode</span></span>

      <span data-ttu-id="6684c-118">Gateway-modus wordt ondersteund op alle SDK-platforms en is de standaardinstelling Hallo geconfigureerd.</span><span class="sxs-lookup"><span data-stu-id="6684c-118">Gateway Mode is supported on all SDK platforms and is hello configured default.</span></span>  <span data-ttu-id="6684c-119">Als uw toepassing wordt uitgevoerd binnen een bedrijfsnetwerk met strikte firewallbeperkingen, is Gateway modus Hallo beste keuze omdat maakt gebruik van Hallo HTTPS-poort en één eindpunt.</span><span class="sxs-lookup"><span data-stu-id="6684c-119">If your application runs within a corporate network with strict firewall restrictions, Gateway Mode is hello best choice since it uses hello standard HTTPS port and a single endpoint.</span></span> <span data-ttu-id="6684c-120">Hallo prestaties afweging, is echter dat Gateway modus betrekking heeft op een extra netwerk-hop telkens wanneer gegevens worden gelezen of geschreven tooCosmos DB.</span><span class="sxs-lookup"><span data-stu-id="6684c-120">hello performance tradeoff, however, is that Gateway Mode involves an additional network hop every time data is read or written tooCosmos DB.</span></span> <span data-ttu-id="6684c-121">Daarom biedt directe modus betere prestaties vanwege toofewer netwerkhops.</span><span class="sxs-lookup"><span data-stu-id="6684c-121">Because of this, Direct Mode offers better performance due toofewer network hops.</span></span>
<a id="use-tcp"></a>
2. <span data-ttu-id="6684c-122">**Verbindingsbeleid: Hallo TCP-protocol gebruiken**</span><span class="sxs-lookup"><span data-stu-id="6684c-122">**Connection policy: Use hello TCP protocol**</span></span>

    <span data-ttu-id="6684c-123">Wanneer u directe modus gebruikt, zijn er twee protocolopties beschikbaar:</span><span class="sxs-lookup"><span data-stu-id="6684c-123">When using Direct Mode, there are two protocol options available:</span></span>

   * <span data-ttu-id="6684c-124">TCP</span><span class="sxs-lookup"><span data-stu-id="6684c-124">TCP</span></span>
   * <span data-ttu-id="6684c-125">HTTPS</span><span class="sxs-lookup"><span data-stu-id="6684c-125">HTTPS</span></span>

     <span data-ttu-id="6684c-126">Cosmos DB biedt een eenvoudige en RESTful-programmeermodel openen via HTTPS.</span><span class="sxs-lookup"><span data-stu-id="6684c-126">Cosmos DB offers a simple and open RESTful programming model over HTTPS.</span></span> <span data-ttu-id="6684c-127">Daarnaast biedt het een efficiënte TCP-protocol, dat is ook RESTful in het communicatiemodel en is beschikbaar via Hallo .NET SDK voor clients.</span><span class="sxs-lookup"><span data-stu-id="6684c-127">Additionally, it offers an efficient TCP protocol, which is also RESTful in its communication model and is available through hello .NET client SDK.</span></span> <span data-ttu-id="6684c-128">Directe TCP- en HTTPS worden SSL gebruiken voor eerste authenticatie en versleuteling verkeer.</span><span class="sxs-lookup"><span data-stu-id="6684c-128">Both Direct TCP and HTTPS use SSL for initial authentication and encrypting traffic.</span></span> <span data-ttu-id="6684c-129">Gebruik voor de beste prestaties Hallo TCP-protocol indien mogelijk.</span><span class="sxs-lookup"><span data-stu-id="6684c-129">For best performance, use hello TCP protocol when possible.</span></span>

     <span data-ttu-id="6684c-130">Bij gebruik van TCP in de modus van de Gateway, TCP-poort 443 Hallo Cosmos-DB-poort is en 10255 hello MongoDB-API-poort is.</span><span class="sxs-lookup"><span data-stu-id="6684c-130">When using TCP in Gateway Mode, TCP Port 443 is hello Cosmos DB port, and 10255 is hello MongoDB API port.</span></span> <span data-ttu-id="6684c-131">Bij gebruik van TCP in modus voor Direct in toevoeging toohello Gateway poorten, moet u tooensure Hallo poort bereik tussen 10000 en 20000 is geopend, omdat de Cosmos-database maakt gebruik van dynamische TCP-poorten.</span><span class="sxs-lookup"><span data-stu-id="6684c-131">When using TCP in Direct Mode, in addition toohello Gateway ports, you need tooensure hello port range between 10000 and 20000 is open because Cosmos DB uses dynamic TCP ports.</span></span> <span data-ttu-id="6684c-132">Als deze poorten niet geopend zijn en u toouse TCP probeert, ontvangt u een 503 Service niet beschikbaar-fout.</span><span class="sxs-lookup"><span data-stu-id="6684c-132">If these ports are not open and you attempt toouse TCP, you receive a 503 Service Unavailable error.</span></span>

     <span data-ttu-id="6684c-133">Hallo Connectiviteitsmodus wordt geconfigureerd tijdens de constructiefase Hallo van Hallo DocumentClient exemplaar met de Hallo ConnectionPolicy parameter.</span><span class="sxs-lookup"><span data-stu-id="6684c-133">hello Connectivity Mode is configured during hello construction of hello DocumentClient instance with hello ConnectionPolicy parameter.</span></span> <span data-ttu-id="6684c-134">Als de modus Direct wordt gebruikt, kan Hallo Protocol ook worden ingesteld binnen Hallo ConnectionPolicy parameter.</span><span class="sxs-lookup"><span data-stu-id="6684c-134">If Direct Mode is used, hello Protocol can also be set within hello ConnectionPolicy parameter.</span></span>

    ```C#
    var serviceEndpoint = new Uri("https://contoso.documents.net");
    var authKey = new "your authKey from hello Azure portal";
    DocumentClient client = new DocumentClient(serviceEndpoint, authKey,
    new ConnectionPolicy
    {
        ConnectionMode = ConnectionMode.Direct,
        ConnectionProtocol = Protocol.Tcp
    });
    ```

    <span data-ttu-id="6684c-135">Omdat TCP wordt alleen ondersteund in de directe modus als Gateway-modus wordt gebruikt, vervolgens Hallo HTTPS-protocol altijd is gebruikt toocommunicate Hello Gateway en Hallo protocolwaarde in Hallo die connectionpolicy wordt genegeerd.</span><span class="sxs-lookup"><span data-stu-id="6684c-135">Because TCP is only supported in Direct Mode, if Gateway Mode is used, then hello HTTPS protocol is always used toocommunicate with hello Gateway and hello Protocol value in hello ConnectionPolicy is ignored.</span></span>

    ![Afbeelding van Hallo verbindingsbeleid Azure Cosmos-DB](./media/performance-tips/connection-policy.png)

3. <span data-ttu-id="6684c-137">**OpenAsync tooavoid opstarten latentie voor de eerste aanvraag aanroepen**</span><span class="sxs-lookup"><span data-stu-id="6684c-137">**Call OpenAsync tooavoid startup latency on first request**</span></span>

    <span data-ttu-id="6684c-138">De eerste aanvraag Hallo heeft standaard een hogere latentie omdat hieraan toofetch Hallo adres routeringstabel.</span><span class="sxs-lookup"><span data-stu-id="6684c-138">By default, hello first request has a higher latency because it has toofetch hello address routing table.</span></span> <span data-ttu-id="6684c-139">tooavoid deze latentie opstarten op Hallo eerst aanvragen, moet u OpenAsync() als volgt één keer tijdens de initialisatie aanroepen.</span><span class="sxs-lookup"><span data-stu-id="6684c-139">tooavoid this startup latency on hello first request, you should call OpenAsync() once during initialization as follows.</span></span>

        await client.OpenAsync();
   <a id="same-region"></a>
4. <span data-ttu-id="6684c-140">**Clients in hetzelfde Azure-regio voor prestaties plaatsen**</span><span class="sxs-lookup"><span data-stu-id="6684c-140">**Collocate clients in same Azure region for performance**</span></span>

    <span data-ttu-id="6684c-141">Mogelijk is, plaats alle toepassingen Cosmos DB aanroepen in dezelfde regio bevinden als Hallo Hallo wanneer Cosmos DB-database.</span><span class="sxs-lookup"><span data-stu-id="6684c-141">When possible, place any applications calling Cosmos DB in hello same region as hello Cosmos DB database.</span></span> <span data-ttu-id="6684c-142">Voor een vergelijking bij benadering, roept tooCosmos DB binnen dezelfde regio voltooid binnen 1-2-ms, maar de latentie tussen Hallo West en oostkust Hallo VS is Hallo Hallo > 50 ms.</span><span class="sxs-lookup"><span data-stu-id="6684c-142">For an approximate comparison, calls tooCosmos DB within hello same region complete within 1-2 ms, but hello latency between hello West and East coast of hello US is >50 ms.</span></span> <span data-ttu-id="6684c-143">Deze latentie variëren van aanvraag toorequest afhankelijk van het Hallo-route Hallo-aanvraag die het doorgeven van Hallo client toohello Azure-datacenter grens waarschijnlijk.</span><span class="sxs-lookup"><span data-stu-id="6684c-143">This latency can likely vary from request toorequest depending on hello route taken by hello request as it passes from hello client toohello Azure datacenter boundary.</span></span> <span data-ttu-id="6684c-144">Hallo laagst mogelijke latentie wordt gerealiseerd door ervoor te zorgen Hallo aanroepen toepassing bevindt zich in Hallo dezelfde Azure-regio als Hallo ingericht Cosmos-DB-eindpunt.</span><span class="sxs-lookup"><span data-stu-id="6684c-144">hello lowest possible latency is achieved by ensuring hello calling application is located within hello same Azure region as hello provisioned Cosmos DB endpoint.</span></span> <span data-ttu-id="6684c-145">Zie voor een lijst met beschikbare regio's, [Azure-gebieden](https://azure.microsoft.com/regions/#services).</span><span class="sxs-lookup"><span data-stu-id="6684c-145">For a list of available regions, see [Azure Regions](https://azure.microsoft.com/regions/#services).</span></span>

    <span data-ttu-id="6684c-146">![Afbeelding van Hallo verbindingsbeleid Azure Cosmos-DB](./media/performance-tips/same-region.png)
   <a id="increase-threads"></a></span><span class="sxs-lookup"><span data-stu-id="6684c-146">![Illustration of hello Azure Cosmos DB connection policy](./media/performance-tips/same-region.png)
<a id="increase-threads"></a></span></span>
5. <span data-ttu-id="6684c-147">**Verhoog het aantal threads/taken**</span><span class="sxs-lookup"><span data-stu-id="6684c-147">**Increase number of threads/tasks**</span></span>

    <span data-ttu-id="6684c-148">Omdat aanroepen tooAzure Cosmos DB worden aangebracht via Hallo netwerk, moet u mogelijk toovary Hallo mate van parallelle uitvoering van uw verzoeken, zodat de client-toepassing hello nodig heeft voor het zeer weinig tijd wachten tussen aanvragen.</span><span class="sxs-lookup"><span data-stu-id="6684c-148">Since calls tooAzure Cosmos DB are made over hello network, you may need toovary hello degree of parallelism of your requests so that hello client application spends very little time waiting between requests.</span></span> <span data-ttu-id="6684c-149">Bijvoorbeeld als u. De NET [taak parallelle bibliotheek](https://msdn.microsoft.com//library/dd460717.aspx), in volgorde van 100s van taken lezen of schrijven tooCosmos DB Hallo maken.</span><span class="sxs-lookup"><span data-stu-id="6684c-149">For example, if you're using .NET's [Task Parallel Library](https://msdn.microsoft.com//library/dd460717.aspx), create in hello order of 100s of Tasks reading or writing tooCosmos DB.</span></span>

## <a name="sdk-usage"></a><span data-ttu-id="6684c-150">Gebruik van de SDK</span><span class="sxs-lookup"><span data-stu-id="6684c-150">SDK Usage</span></span>
1. <span data-ttu-id="6684c-151">**Installeer Hallo meest recente SDK**</span><span class="sxs-lookup"><span data-stu-id="6684c-151">**Install hello most recent SDK**</span></span>

    <span data-ttu-id="6684c-152">Hallo Cosmos DB SDK's voortdurend worden verbeterd tooprovide Hallo optimale prestaties.</span><span class="sxs-lookup"><span data-stu-id="6684c-152">hello Cosmos DB SDKs are constantly being improved tooprovide hello best performance.</span></span> <span data-ttu-id="6684c-153">Zie Hallo [Cosmos DB SDK](documentdb-sdk-dotnet.md) pagina's toodetermine Hallo meest recente SDK en verbeteringen controleren.</span><span class="sxs-lookup"><span data-stu-id="6684c-153">See hello [Cosmos DB SDK](documentdb-sdk-dotnet.md) pages toodetermine hello most recent SDK and review improvements.</span></span>
2. <span data-ttu-id="6684c-154">**Een singleton Cosmos-DB-client voor de levensduur van uw toepassing hello gebruiken**</span><span class="sxs-lookup"><span data-stu-id="6684c-154">**Use a singleton Cosmos DB client for hello lifetime of your application**</span></span>

    <span data-ttu-id="6684c-155">Houd er rekening mee dat elk exemplaar DocumentClient thread-veilige en efficiënte Verbindingsbeheer en adrescaching in directe modus wordt uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="6684c-155">Note that each DocumentClient instance is thread-safe and performs efficient connection management and address caching when operating in Direct Mode.</span></span> <span data-ttu-id="6684c-156">efficiënt beheer van tooallow en betere prestaties door DocumentClient, is het aanbevolen toouse één exemplaar van de DocumentClient per AppDomain voor Hallo levensduur van de toepassing hello.</span><span class="sxs-lookup"><span data-stu-id="6684c-156">tooallow efficient connection management and better performance by DocumentClient, it is recommended toouse a single instance of DocumentClient per AppDomain for hello lifetime of hello application.</span></span>

   <a id="max-connection"></a>
3. <span data-ttu-id="6684c-157">**System.Net MaxConnections per host verhogen als u de Gateway-modus**</span><span class="sxs-lookup"><span data-stu-id="6684c-157">**Increase System.Net MaxConnections per host when using Gateway mode**</span></span>

    <span data-ttu-id="6684c-158">DB cosmos-aanvragen worden gedaan via HTTPS/REST bij gebruik van Gateway-modus en ondergaan toohello standaardlimiet verbinding per hostnaam of IP-adres zijn.</span><span class="sxs-lookup"><span data-stu-id="6684c-158">Cosmos DB requests are made over HTTPS/REST when using Gateway mode, and are subjected toohello default connection limit per hostname or IP address.</span></span> <span data-ttu-id="6684c-159">U moet mogelijk tooset Hallo MaxConnections tooa hogere waarde (100-1000) zodat hello clientbibliotheek van meerdere gelijktijdige verbindingen tooCosmos DB gebruikmaken kan.</span><span class="sxs-lookup"><span data-stu-id="6684c-159">You may need tooset hello MaxConnections tooa higher value (100-1000) so that hello client library can utilize multiple simultaneous connections tooCosmos DB.</span></span> <span data-ttu-id="6684c-160">In de .NET SDK 1.8.0 Hallo en Hallo hierboven, de standaardwaarde voor [ServicePointManager.DefaultConnectionLimit](https://msdn.microsoft.com/library/system.net.servicepointmanager.defaultconnectionlimit.aspx) is 50 en toochange Hallo waarde, kunt u instellen dat Hallo [Documents.Client.ConnectionPolicy.MaxConnectionLimit ](https://msdn.microsoft.com/library/azure/microsoft.azure.documents.client.connectionpolicy.maxconnectionlimit.aspx) tooa hogere waarde.</span><span class="sxs-lookup"><span data-stu-id="6684c-160">In hello .NET SDK 1.8.0 and above, hello default value for [ServicePointManager.DefaultConnectionLimit](https://msdn.microsoft.com/library/system.net.servicepointmanager.defaultconnectionlimit.aspx) is 50 and toochange hello value, you can set hello [Documents.Client.ConnectionPolicy.MaxConnectionLimit](https://msdn.microsoft.com/library/azure/microsoft.azure.documents.client.connectionpolicy.maxconnectionlimit.aspx) tooa higher value.</span></span>   
4. <span data-ttu-id="6684c-161">**Parallelle query's voor gepartitioneerde verzamelingen afstemmen**</span><span class="sxs-lookup"><span data-stu-id="6684c-161">**Tuning parallel queries for partitioned collections**</span></span>

     <span data-ttu-id="6684c-162">DocumentDB .NET SDK versie 1.9.0 en hoger ondersteuning parallelle query's waarmee u een gepartitioneerde verzameling worden parallel tooquery (Zie [werken met Hallo SDK's](documentdb-partition-data.md#working-with-the-azure-cosmos-db-sdks) en gerelateerde Hallo [codevoorbeelden](https://github.com/Azure/azure-documentdb-dotnet/blob/master/samples/code-samples/Queries/Program.cs) voor meer informatie).</span><span class="sxs-lookup"><span data-stu-id="6684c-162">DocumentDB .NET SDK version 1.9.0 and above support parallel queries, which enable you tooquery a partitioned collection in parallel (see [Working with hello SDKs](documentdb-partition-data.md#working-with-the-azure-cosmos-db-sdks) and hello related [code samples](https://github.com/Azure/azure-documentdb-dotnet/blob/master/samples/code-samples/Queries/Program.cs) for more info).</span></span> <span data-ttu-id="6684c-163">Parallelle query's zijn ontworpen tooimprove Querylatentie en doorvoer via hun seriële equivalent.</span><span class="sxs-lookup"><span data-stu-id="6684c-163">Parallel queries are designed tooimprove query latency and throughput over their serial counterpart.</span></span> <span data-ttu-id="6684c-164">Parallelle query's bieden twee parameters dat gebruikers toocustom aanpassen de vereisten (a) MaxDegreeOfParallelism afstemmen kunnen: toocontrol Hallo maximum aantal partities vervolgens kan worden opgevraagd in parallel en (b) MaxBufferedItemCount: toocontrol Hallo aantal vooraf opgehaalde resultaten.</span><span class="sxs-lookup"><span data-stu-id="6684c-164">Parallel queries provide two parameters that users can tune toocustom-fit their requirements, (a) MaxDegreeOfParallelism: toocontrol hello maximum number of partitions then can be queried in parallel, and (b) MaxBufferedItemCount: toocontrol hello number of pre-fetched results.</span></span>

    <span data-ttu-id="6684c-165">(a) ***afstemmen MaxDegreeOfParallelism\: *** parallelle query werkt door meerdere partities parallel uitvoeren van query's.</span><span class="sxs-lookup"><span data-stu-id="6684c-165">(a) ***Tuning MaxDegreeOfParallelism\:*** Parallel query works by querying multiple partitions in parallel.</span></span> <span data-ttu-id="6684c-166">Echter worden gegevens uit een afzonderlijke gepartitioneerde verzamelen opeenvolgend opgehaald met opzicht toohello query.</span><span class="sxs-lookup"><span data-stu-id="6684c-166">However, data from an individual partitioned collect is fetched serially with respect toohello query.</span></span> <span data-ttu-id="6684c-167">Instelling Hallo MaxDegreeOfParallelism toohello aantal partities heeft dus Hallo maximale kans op Hallo van de meeste zodat query, opgegeven blijven voor alle andere voorwaarden system Hallo dezelfde.</span><span class="sxs-lookup"><span data-stu-id="6684c-167">So, setting hello MaxDegreeOfParallelism toohello number of partitions has hello maximum chance of achieving hello most performant query, provided all other system conditions remain hello same.</span></span> <span data-ttu-id="6684c-168">Als u niet dat het aantal partities Hallo weet, kunt u Hallo MaxDegreeOfParallelism tooa groot aantal instellen en Hallo systeem kiest Hallo minimum (aantal partities, invoer van de gebruiker opgegeven) zoals MaxDegreeOfParallelism Hallo.</span><span class="sxs-lookup"><span data-stu-id="6684c-168">If you don't know hello number of partitions, you can set hello MaxDegreeOfParallelism tooa high number, and hello system chooses hello minimum (number of partitions, user provided input) as hello MaxDegreeOfParallelism.</span></span>

    <span data-ttu-id="6684c-169">Het is belangrijk toonote die parallelle query's produceren Hallo best voordelen als Hallo gegevens evenredig verdeeld over alle partities met opzicht toohello query.</span><span class="sxs-lookup"><span data-stu-id="6684c-169">It is important toonote that parallel queries produce hello best benefits if hello data is evenly distributed across all partitions with respect toohello query.</span></span> <span data-ttu-id="6684c-170">Als Hallo gepartitioneerd verzameling is gepartitioneerd zodanig dat alle of een meerderheid van Hallo-gegevens geretourneerd door een query voornamelijk in een paar partities (één partitie in ergste geval) en prestaties van query Hallo Hallo als knelpunt zou worden verwerkt door deze partities.</span><span class="sxs-lookup"><span data-stu-id="6684c-170">If hello partitioned collection is partitioned such a way that all or a majority of hello data returned by a query is concentrated in a few partitions (one partition in worst case), then hello performance of hello query would be bottlenecked by those partitions.</span></span>

    <span data-ttu-id="6684c-171">(b) ***afstemmen MaxBufferedItemCount\: *** parallelle query wordt ontworpen toopre-ophalen resultaten terwijl de huidige batch Hallo van resultaten wordt verwerkt door het Hallo-client.</span><span class="sxs-lookup"><span data-stu-id="6684c-171">(b) ***Tuning MaxBufferedItemCount\:*** Parallel query is designed toopre-fetch results while hello current batch of results is being processed by hello client.</span></span> <span data-ttu-id="6684c-172">Hallo vooraf ophalen helpt u bij algemene verbetering van de latentie van een query.</span><span class="sxs-lookup"><span data-stu-id="6684c-172">hello pre-fetching helps in overall latency improvement of a query.</span></span> <span data-ttu-id="6684c-173">MaxBufferedItemCount is Hallo parameter toolimit Hallo aantal vooraf opgehaalde resultaten.</span><span class="sxs-lookup"><span data-stu-id="6684c-173">MaxBufferedItemCount is hello parameter toolimit hello number of pre-fetched results.</span></span> <span data-ttu-id="6684c-174">Instelling MaxBufferedItemCount verwacht toohello aantal resultaten geretourneerd (of een hogere waarde) kunt Hallo query tooreceive maximaal profiteren van het vooraf ophalen.</span><span class="sxs-lookup"><span data-stu-id="6684c-174">Setting MaxBufferedItemCount toohello expected number of results returned (or a higher number) allows hello query tooreceive maximum benefit from pre-fetching.</span></span>

    <span data-ttu-id="6684c-175">Houd er rekening mee dat vooraf ophalen works Hallo dezelfde manier uitgevoerd ongeacht Hallo MaxDegreeOfParallelism, en er één buffer voor Hallo gegevens van alle partities.</span><span class="sxs-lookup"><span data-stu-id="6684c-175">Note that pre-fetching works hello same way irrespective of hello MaxDegreeOfParallelism, and there is a single buffer for hello data from all partitions.</span></span>  
5. <span data-ttu-id="6684c-176">**Schakel op de GC-serverzijde**</span><span class="sxs-lookup"><span data-stu-id="6684c-176">**Turn on server-side GC**</span></span>

    <span data-ttu-id="6684c-177">In sommige gevallen kan verminderen Hallo frequentie van garbagecollection helpen.</span><span class="sxs-lookup"><span data-stu-id="6684c-177">Reducing hello frequency of garbage collection may help in some cases.</span></span> <span data-ttu-id="6684c-178">Stel in .NET, [gcServer](https://msdn.microsoft.com/library/ms229357.aspx) tootrue.</span><span class="sxs-lookup"><span data-stu-id="6684c-178">In .NET, set [gcServer](https://msdn.microsoft.com/library/ms229357.aspx) tootrue.</span></span>
6. <span data-ttu-id="6684c-179">**Backoff RetryAfter intervallen implementeren**</span><span class="sxs-lookup"><span data-stu-id="6684c-179">**Implement backoff at RetryAfter intervals**</span></span>

    <span data-ttu-id="6684c-180">Tijdens het testen van prestaties, moet u load verhogen tot een klein aantal aanvragen ophalen beperkt.</span><span class="sxs-lookup"><span data-stu-id="6684c-180">During performance testing, you should increase load until a small rate of requests get throttled.</span></span> <span data-ttu-id="6684c-181">Als beperkt, Hallo clienttoepassing moet backoff op versnelling voor Hallo server opgegeven interval voor opnieuw proberen.</span><span class="sxs-lookup"><span data-stu-id="6684c-181">If throttled, hello client application should backoff on throttle for hello server-specified retry interval.</span></span> <span data-ttu-id="6684c-182">Hallo backoff te respecteren, zorgt u ervoor dat u besteden aan de minimale hoeveelheid tijd wachten tussen nieuwe pogingen.</span><span class="sxs-lookup"><span data-stu-id="6684c-182">Respecting hello backoff ensures that you spend minimal amount of time waiting between retries.</span></span> <span data-ttu-id="6684c-183">Ondersteuning voor nieuwe pogingen Groepsbeleid is opgenomen in versie 1.8.0 en hoger Hallo DocumentDB [.NET](documentdb-sdk-dotnet.md) en [Java](documentdb-sdk-java.md), versie 1.9.0 en hoger Hallo [Node.js](documentdb-sdk-node.md) en [ Python](documentdb-sdk-python.md), en alle ondersteunde versies van Hallo [.NET Core](documentdb-sdk-dotnet-core.md) SDK's.</span><span class="sxs-lookup"><span data-stu-id="6684c-183">Retry policy support is included in Version 1.8.0 and above of hello DocumentDB [.NET](documentdb-sdk-dotnet.md) and [Java](documentdb-sdk-java.md), version 1.9.0 and above of hello [Node.js](documentdb-sdk-node.md) and [Python](documentdb-sdk-python.md), and all supported versions of hello [.NET Core](documentdb-sdk-dotnet-core.md) SDKs.</span></span> <span data-ttu-id="6684c-184">Zie voor meer informatie [Exceeding gereserveerd doorvoerlimieten](request-units.md#RequestRateTooLarge) en [RetryAfter](https://msdn.microsoft.com/library/microsoft.azure.documents.documentclientexception.retryafter.aspx).</span><span class="sxs-lookup"><span data-stu-id="6684c-184">For more information, see [Exceeding reserved throughput limits](request-units.md#RequestRateTooLarge) and [RetryAfter](https://msdn.microsoft.com/library/microsoft.azure.documents.documentclientexception.retryafter.aspx).</span></span>
7. <span data-ttu-id="6684c-185">**Uitbreiden van de werkbelasting van uw client**</span><span class="sxs-lookup"><span data-stu-id="6684c-185">**Scale out your client-workload**</span></span>

    <span data-ttu-id="6684c-186">Als u op niveaus met hoge doorvoer testen wilt (> 50.000 RU/s), Hallo clienttoepassing mogelijk Hallo knelpunt vanwege toohello machine beperking af op CPU- of -gebruik.</span><span class="sxs-lookup"><span data-stu-id="6684c-186">If you are testing at high throughput levels (>50,000 RU/s), hello client application may become hello bottleneck due toohello machine capping out on CPU or Network utilization.</span></span> <span data-ttu-id="6684c-187">Als u deze punt bereikt, kunt u toopush hello Cosmos DB account verder gaan door uw clienttoepassingen schalen op meerdere servers.</span><span class="sxs-lookup"><span data-stu-id="6684c-187">If you reach this point, you can continue toopush hello Cosmos DB account further by scaling out your client applications across multiple servers.</span></span>
8. <span data-ttu-id="6684c-188">**Cache document URI's voor lagere latentie mogelijk lezen**</span><span class="sxs-lookup"><span data-stu-id="6684c-188">**Cache document URIs for lower read latency**</span></span>

    <span data-ttu-id="6684c-189">URI's waar mogelijk voor de beste lezen prestaties Hallo document in de cache.</span><span class="sxs-lookup"><span data-stu-id="6684c-189">Cache document URIs whenever possible for hello best read performance.</span></span>
   <a id="tune-page-size"></a>
9. <span data-ttu-id="6684c-190">**Hallo paginagrootte voor query's leestijd feeds voor betere prestaties afstemmen**</span><span class="sxs-lookup"><span data-stu-id="6684c-190">**Tune hello page size for queries/read feeds for better performance**</span></span>

    <span data-ttu-id="6684c-191">Bij het uitvoeren van een bulksgewijs documenten met behulp van de feed functionaliteit (bijvoorbeeld ReadDocumentFeedAsync) lezen of lezen bij de uitgifte van een DocumentDB SQL-query, zijn Hallo resultaten op een gesegmenteerde wijze als Hallo resultatenset te groot is.</span><span class="sxs-lookup"><span data-stu-id="6684c-191">When performing a bulk read of documents using read feed functionality (for example, ReadDocumentFeedAsync) or when issuing a DocumentDB SQL query, hello results are returned in a segmented fashion if hello result set is too large.</span></span> <span data-ttu-id="6684c-192">Standaard resultaten worden geretourneerd in segmenten van 100 items of 1 MB, eerst de limiet is bereikt.</span><span class="sxs-lookup"><span data-stu-id="6684c-192">By default, results are returned in chunks of 100 items or 1 MB, whichever limit is hit first.</span></span>

    <span data-ttu-id="6684c-193">tooreduce hello aantal netwerk retouren vereist tooretrieve alle toepasselijke resultaten, kunt u de paginagrootte Hallo met behulp van de x-ms-max-item-count-aanvraag-header tooup too1000 verhogen.</span><span class="sxs-lookup"><span data-stu-id="6684c-193">tooreduce hello number of network round trips required tooretrieve all applicable results, you can increase hello page size using x-ms-max-item-count request header tooup too1000.</span></span> <span data-ttu-id="6684c-194">In gevallen waarin u toodisplay alleen enkele resultaten moet bijvoorbeeld, als uw gebruikers-interface of toepassing API retourneert alleen 10 een tijd resulteert, u kunt ook verlagen Hallo pagina grootte too10 tooreduce Hallo doorvoer verbruikt voor leesbewerkingen en query's.</span><span class="sxs-lookup"><span data-stu-id="6684c-194">In cases where you need toodisplay only a few results, for example, if your user interface or application API returns only 10 results a time, you can also decrease hello page size too10 tooreduce hello throughput consumed for reads and queries.</span></span>

    <span data-ttu-id="6684c-195">Hallo paginaformaat kunnen ook worden ingesteld met behulp van Hallo beschikbaar Cosmos DB-SDK's.</span><span class="sxs-lookup"><span data-stu-id="6684c-195">You may also set hello page size using hello available Cosmos DB SDKs.</span></span>  <span data-ttu-id="6684c-196">Bijvoorbeeld:</span><span class="sxs-lookup"><span data-stu-id="6684c-196">For example:</span></span>

        IQueryable<dynamic> authorResults = client.CreateDocumentQuery(documentCollection.SelfLink, "SELECT p.Author FROM Pages p WHERE p.Title = 'About Seattle'", new FeedOptions { MaxItemCount = 1000 });
10. <span data-ttu-id="6684c-197">**Verhoog het aantal threads/taken**</span><span class="sxs-lookup"><span data-stu-id="6684c-197">**Increase number of threads/tasks**</span></span>

    <span data-ttu-id="6684c-198">Zie [Verhoog het aantal threads/taken](#increase-threads) in Hallo sectie over netwerken.</span><span class="sxs-lookup"><span data-stu-id="6684c-198">See [Increase number of threads/tasks](#increase-threads) in hello Networking section.</span></span>

11. <span data-ttu-id="6684c-199">**Gebruik 64-bits host verwerken**</span><span class="sxs-lookup"><span data-stu-id="6684c-199">**Use 64-bit host processing**</span></span>

    <span data-ttu-id="6684c-200">Hallo DocumentDB SDK werkt in een 32-bits hostproces wanneer u de DocumentDB .NET SDK versie 1.11.4 gebruikt en hoger.</span><span class="sxs-lookup"><span data-stu-id="6684c-200">hello DocumentDB SDK works in a 32-bit host process when you are using DocumentDB .NET SDK version 1.11.4 and above.</span></span> <span data-ttu-id="6684c-201">Als u over verschillende partitie query's gebruikt, wordt 64-bits host verwerken echter aanbevolen voor verbeterde prestaties.</span><span class="sxs-lookup"><span data-stu-id="6684c-201">However, if you are using cross partition queries, 64-bit host processing is recommended for improved performance.</span></span> <span data-ttu-id="6684c-202">Hallo volgende soorten toepassingen hebben 32-bits host als Hallo standaard verwerken, dus in volgorde toochange dat too64-bits, als volgt op basis van uw toepassing hello type:</span><span class="sxs-lookup"><span data-stu-id="6684c-202">hello following types of applications have 32-bit host process as hello default, so in order toochange that too64-bit, follow these steps based on hello type of your application:</span></span>

    - <span data-ttu-id="6684c-203">Voor uitvoerbare toepassingen, kan dit worden gedaan door unchecking hello **liever 32-bits** optie in Hallo **Projecteigenschappen** venster op Hallo **bouwen** tabblad.</span><span class="sxs-lookup"><span data-stu-id="6684c-203">For Executable applications, this can be done by unchecking hello **Prefer 32-bit** option in hello **Project Properties** window, on hello **Build** tab.</span></span>

    - <span data-ttu-id="6684c-204">Voor VSTest op basis van de Testprojecten, kunt u dit doen door te selecteren **testen**->**instellingen testen**->**processorarchitectuur standaard als X64**, van Hallo **Visual Studio Test** menuoptie.</span><span class="sxs-lookup"><span data-stu-id="6684c-204">For VSTest based test projects, this can be done by selecting **Test**->**Test Settings**->**Default Processor Architecture as X64**, from hello **Visual Studio Test** menu option.</span></span>

    - <span data-ttu-id="6684c-205">Voor lokaal geïmplementeerde ASP.NET-webtoepassingen, kunt dit doen door te controleren Hallo **gebruik Hallo 64-bits versie van IIS Express voor websites en projecten**onder **extra** ->  **Opties**->**projecten en oplossingen**->**Web-projecten**.</span><span class="sxs-lookup"><span data-stu-id="6684c-205">For locally deployed ASP.NET Web applications, this can be done by checking hello **Use hello 64-bit version of IIS Express for web sites and projects**, under **Tools**->**Options**->**Projects and Solutions**->**Web Projects**.</span></span>

    - <span data-ttu-id="6684c-206">Voor ASP.NET-webtoepassingen wordt geïmplementeerd in Azure, kunt dit doen door te kiezen Hallo **Platform als 64-bits** in Hallo **toepassingsinstellingen** op Hallo Azure-portal.</span><span class="sxs-lookup"><span data-stu-id="6684c-206">For ASP.NET Web applications deployed on Azure, this can be done by choosing hello **Platform as 64-bit** in hello **Application Settings** on hello Azure portal.</span></span>

## <a name="indexing-policy"></a><span data-ttu-id="6684c-207">Indexeringsbeleid</span><span class="sxs-lookup"><span data-stu-id="6684c-207">Indexing Policy</span></span>
1. <span data-ttu-id="6684c-208">**Gebruik vertraagde indexering voor snellere piek tijd opname tarieven**</span><span class="sxs-lookup"><span data-stu-id="6684c-208">**Use lazy indexing for faster peak time ingestion rates**</span></span>

    <span data-ttu-id="6684c-209">Cosmos DB kunt u toospecify – op niveau Hallo verzameling – indexeringsbeleid, waarmee u toochoose als u wilt dat Hallo documenten in een verzameling toobe automatisch geïndexeerd of niet.</span><span class="sxs-lookup"><span data-stu-id="6684c-209">Cosmos DB allows you toospecify – at hello collection level – an indexing policy, which enables you toochoose if you want hello documents in a collection toobe automatically indexed or not.</span></span>  <span data-ttu-id="6684c-210">U kunt bovendien ook tussen synchrone (consistente) en updates van de index asynchrone (Lazy).</span><span class="sxs-lookup"><span data-stu-id="6684c-210">In addition, you may also choose between synchronous (Consistent) and asynchronous (Lazy) index updates.</span></span> <span data-ttu-id="6684c-211">Hallo-index wordt standaard synchroon bijgewerkt op elke invoegen, vervangen of verwijderen van een document toohello-verzameling.</span><span class="sxs-lookup"><span data-stu-id="6684c-211">By default, hello index is updated synchronously on each insert, replace, or delete of a document toohello collection.</span></span> <span data-ttu-id="6684c-212">Synchroon modus schakelt Hallo query's toohonor Hallo dezelfde [consistentieniveau](consistency-levels.md) als die van Hallo document leest zonder enige vertraging voor Hallo-index te 'lopen'.</span><span class="sxs-lookup"><span data-stu-id="6684c-212">Synchronously mode enables hello queries toohonor hello same [consistency level](consistency-levels.md) as that of hello document reads without any delay for hello index too“catch up".</span></span>

    <span data-ttu-id="6684c-213">Vertraagde indexeren kan worden overwogen om scenario's waarin gegevens worden geschreven in bursts en u wilt dat tooamortize Hallo werk dat nodig is tooindex inhoud gedurende een langere periode.</span><span class="sxs-lookup"><span data-stu-id="6684c-213">Lazy indexing may be considered for scenarios in which data is written in bursts, and you want tooamortize hello work required tooindex content over a longer period of time.</span></span> <span data-ttu-id="6684c-214">Vertraagde indexeren kunt u ook toouse uw doorvoer effectief ingericht en dienst schrijfaanvragen piekuren met een minimale latentie.</span><span class="sxs-lookup"><span data-stu-id="6684c-214">Lazy indexing also allows you toouse your provisioned throughput effectively and serve write requests at peak times with minimal latency.</span></span> <span data-ttu-id="6684c-215">Het is belangrijk toonote, echter dat wanneer vertraagde indexeren is ingeschakeld, queryresultaten uiteindelijk consistent ongeacht Hallo consistentieniveau geconfigureerd voor Hallo Cosmos-DB-account zijn.</span><span class="sxs-lookup"><span data-stu-id="6684c-215">It is important toonote, however, that when lazy indexing is enabled, query results are eventually consistent regardless of hello consistency level configured for hello Cosmos DB account.</span></span>

    <span data-ttu-id="6684c-216">Daarom Hallo hoogste aanvraag eenheid kosten per schrijfbewerking tijdens het indexeren modus (IndexingPolicy.IndexingMode wordt ingesteld tooLazy) en geen indexering Lazy leidt ertoe dat Consistent indexing-modus (IndexingPolicy.IndexingMode wordt ingesteld tooConsistent) (IndexingPolicy.Automatic is ingesteld tooFalse) hebben van nul indexering kosten op Hallo moment van schrijven.</span><span class="sxs-lookup"><span data-stu-id="6684c-216">Hence, Consistent indexing mode (IndexingPolicy.IndexingMode is set tooConsistent) incurs hello highest request unit charge per write, while Lazy indexing mode (IndexingPolicy.IndexingMode is set tooLazy) and no indexing (IndexingPolicy.Automatic is set tooFalse) have zero indexing cost at hello time of write.</span></span>
2. <span data-ttu-id="6684c-217">**Ongebruikte paden uitsluiten van indexering voor snellere schrijfbewerkingen**</span><span class="sxs-lookup"><span data-stu-id="6684c-217">**Exclude unused paths from indexing for faster writes**</span></span>

    <span data-ttu-id="6684c-218">Indexeringsbeleid cosmos van de database kunt u ook toospecify die paden tooinclude document of uitsluiten door gebruik te indexeren paden (IndexingPolicy.IncludedPaths en IndexingPolicy.ExcludedPaths) te indexeren.</span><span class="sxs-lookup"><span data-stu-id="6684c-218">Cosmos DB’s indexing policy also allows you toospecify which document paths tooinclude or exclude from indexing by leveraging Indexing Paths (IndexingPolicy.IncludedPaths and IndexingPolicy.ExcludedPaths).</span></span> <span data-ttu-id="6684c-219">Hallo-gebruik van het indexeren paden kunt aanbieden verbeterde schrijfprestaties en lagere opslagkosten voor index voor scenario's in welke Hallo querypatronen zijn wel tevoren indexering kosten zijn rechtstreeks gecorreleerde toohello aantal unieke paden die zijn geïndexeerd.</span><span class="sxs-lookup"><span data-stu-id="6684c-219">hello use of indexing paths can offer improved write performance and lower index storage for scenarios in which hello query patterns are known beforehand, as indexing costs are directly correlated toohello number of unique paths indexed.</span></span>  <span data-ttu-id="6684c-220">Bijvoorbeeld toont Hallo volgende code hoe tooexclude een hele sectie Hallo documenten (ook</span><span class="sxs-lookup"><span data-stu-id="6684c-220">For example, hello following code shows how tooexclude an entire section of hello documents (a.k.a.</span></span> <span data-ttu-id="6684c-221">een substructuur) niet kan indexeren met behulp van Hallo ' * ' jokerteken.</span><span class="sxs-lookup"><span data-stu-id="6684c-221">a subtree) from indexing using hello "*" wildcard.</span></span>

    ```C#
    var collection = new DocumentCollection { Id = "excludedPathCollection" };
    collection.IndexingPolicy.IncludedPaths.Add(new IncludedPath { Path = "/*" });
    collection.IndexingPolicy.ExcludedPaths.Add(new ExcludedPath { Path = "/nonIndexedContent/*");
    collection = await client.CreateDocumentCollectionAsync(UriFactory.CreateDatabaseUri("db"), excluded);
    ```

    <span data-ttu-id="6684c-222">Zie voor meer informatie [Azure Cosmos DB indexeren beleid](indexing-policies.md).</span><span class="sxs-lookup"><span data-stu-id="6684c-222">For more information, see [Azure Cosmos DB indexing policies](indexing-policies.md).</span></span>

## <a name="throughput"></a><span data-ttu-id="6684c-223">Doorvoer</span><span class="sxs-lookup"><span data-stu-id="6684c-223">Throughput</span></span>
<a id="measure-rus"></a>

1. <span data-ttu-id="6684c-224">**Meten en stemmen voor lagere aanvraag eenheden/seconde gebruik**</span><span class="sxs-lookup"><span data-stu-id="6684c-224">**Measure and tune for lower request units/second usage**</span></span>

    <span data-ttu-id="6684c-225">Cosmos DB biedt een uitgebreide reeks databasebewerkingen, met inbegrip van relationele en hiërarchische query's met UDF's, opgeslagen procedures en triggers – alle operationele op Hallo documenten binnen een verzameling van de database.</span><span class="sxs-lookup"><span data-stu-id="6684c-225">Cosmos DB offers a rich set of database operations including relational and hierarchical queries with UDFs, stored procedures, and triggers – all operating on hello documents within a database collection.</span></span> <span data-ttu-id="6684c-226">Hallo kosten die zijn gekoppeld aan elk van deze bewerkingen varieert op basis van Hallo CPU, IO en geheugen vereist toocomplete Hallo-bewerking.</span><span class="sxs-lookup"><span data-stu-id="6684c-226">hello cost associated with each of these operations varies based on hello CPU, IO, and memory required toocomplete hello operation.</span></span> <span data-ttu-id="6684c-227">In plaats van het denken over en beheer van hardwareresources, kunt u zien van een aanvraag-eenheid (RU) als één maatregel voor Hallo resources vereist tooperform diverse databasebewerkingen en service een toepassingsaanvraag.</span><span class="sxs-lookup"><span data-stu-id="6684c-227">Instead of thinking about and managing hardware resources, you can think of a request unit (RU) as a single measure for hello resources required tooperform various database operations and service an application request.</span></span>

    <span data-ttu-id="6684c-228">[Aanvraageenheden](request-units.md) zijn ingericht voor het account van elke database op basis van het aantal eenheden voor capaciteit die u aanschaft Hallo.</span><span class="sxs-lookup"><span data-stu-id="6684c-228">[Request units](request-units.md) are provisioned for each database account based on hello number of capacity units that you purchase.</span></span> <span data-ttu-id="6684c-229">Aanvraag eenheidsverbruik wordt geëvalueerd als een percentage per seconde.</span><span class="sxs-lookup"><span data-stu-id="6684c-229">Request unit consumption is evaluated as a rate per second.</span></span> <span data-ttu-id="6684c-230">Toepassingen die groter zijn dan Hallo ingerichte aanvraag eenheid beoordelen voor het account beperkt is pas Hallo snelheid Hallo gereserveerde serviceniveau voor Hallo-account.</span><span class="sxs-lookup"><span data-stu-id="6684c-230">Applications that exceed hello provisioned request unit rate for their account is limited until hello rate drops below hello reserved level for hello account.</span></span> <span data-ttu-id="6684c-231">Als uw toepassing een hogere mate van doorvoer vereist, kunt u extra capaciteitseenheden aanschaffen.</span><span class="sxs-lookup"><span data-stu-id="6684c-231">If your application requires a higher level of throughput, you can purchase additional capacity units.</span></span>

    <span data-ttu-id="6684c-232">Hallo complexiteit van een query heeft gevolgen voor het aantal eenheden van de aanvraag voor een bewerking worden verbruikt.</span><span class="sxs-lookup"><span data-stu-id="6684c-232">hello complexity of a query impacts how many Request Units are consumed for an operation.</span></span> <span data-ttu-id="6684c-233">aantal predicaten Hello, aard van Hallo predicaten, UDF's aantal en grootte van alle Hallo kosten van invloed zijn op bron-gegevensset voor Hallo Hallo query bewerkingen.</span><span class="sxs-lookup"><span data-stu-id="6684c-233">hello number of predicates, nature of hello predicates, number of UDFs, and hello size of hello source data set all influence hello cost of query operations.</span></span>

    <span data-ttu-id="6684c-234">toomeasure hello overhead van elke bewerking (maken, bijwerken of verwijderen) inspecteren Hallo x-ms-aanvraag-kosten header (of gelijkwaardige RequestCharge-eigenschap in ResourceResponse Hallo<T> of FeedResponse<T> in .NET SDK Hallo) toomeasure Hallo aantal aanvraageenheden verbruikt door deze bewerkingen.</span><span class="sxs-lookup"><span data-stu-id="6684c-234">toomeasure hello overhead of any operation (create, update, or delete), inspect hello x-ms-request-charge header (or hello equivalent RequestCharge property in ResourceResponse<T> or FeedResponse<T> in hello .NET SDK) toomeasure hello number of request units consumed by these operations.</span></span>

    ```C#
    // Measure hello performance (request units) of writes
    ResourceResponse<Document> response = await client.CreateDocumentAsync(collectionSelfLink, myDocument);
    Console.WriteLine("Insert of document consumed {0} request units", response.RequestCharge);
    // Measure hello performance (request units) of queries
    IDocumentQuery<dynamic> queryable = client.CreateDocumentQuery(collectionSelfLink, queryString).AsDocumentQuery();
    while (queryable.HasMoreResults)
         {
              FeedResponse<dynamic> queryResponse = await queryable.ExecuteNextAsync<dynamic>();
              Console.WriteLine("Query batch consumed {0} request units", queryResponse.RequestCharge);
         }
    ```             

    <span data-ttu-id="6684c-235">Hallo aanvraag kosten geretourneerd in deze header is een fractie van de ingerichte doorvoer (dat wil zeggen, 2000 RUs / seconde).</span><span class="sxs-lookup"><span data-stu-id="6684c-235">hello request charge returned in this header is a fraction of your provisioned throughput (i.e., 2000 RUs / second).</span></span> <span data-ttu-id="6684c-236">Bijvoorbeeld, als hello voorgaande query 1000 1KB-documenten retourneert, is Hallo kosten van het Hallo-bewerking 1000.</span><span class="sxs-lookup"><span data-stu-id="6684c-236">For example, if hello preceding query returns 1000 1KB-documents, hello cost of hello operation is 1000.</span></span> <span data-ttu-id="6684c-237">Als zodanig binnen één seconde Hallo server respecteert slechts twee dergelijke aanvragen voordat de beperking van de volgende aanvragen.</span><span class="sxs-lookup"><span data-stu-id="6684c-237">As such, within one second, hello server honors only two such requests before throttling subsequent requests.</span></span> <span data-ttu-id="6684c-238">Zie voor meer informatie [Aanvraageenheden](request-units.md) en Hallo [aanvraag eenheid Rekenmachine](https://www.documentdb.com/capacityplanner).</span><span class="sxs-lookup"><span data-stu-id="6684c-238">For more information, see [Request units](request-units.md) and hello [request unit calculator](https://www.documentdb.com/capacityplanner).</span></span>
<a id="429"></a>
2. <span data-ttu-id="6684c-239">**Verwerken frequentie beperken/aanvraagsnelheid te groot**</span><span class="sxs-lookup"><span data-stu-id="6684c-239">**Handle rate limiting/request rate too large**</span></span>

    <span data-ttu-id="6684c-240">Wanneer een client tooexceed Hallo gereserveerde doorvoer voor een account probeert, is er geen verslechtering van prestaties optreedt op Hallo-server en er geen gebruik van doorvoercapaciteit buiten Hallo gereserveerd niveau.</span><span class="sxs-lookup"><span data-stu-id="6684c-240">When a client attempts tooexceed hello reserved throughput for an account, there is no performance degradation at hello server and no use of throughput capacity beyond hello reserved level.</span></span> <span data-ttu-id="6684c-241">Hallo server beëindigd optie preventief Hallo-aanvraag met RequestRateTooLarge (HTTP-statuscode 429) en wordt geretourneerd Hallo header x-ms-opnieuw-na-ms aangegeven hoeveelheid tijd in milliseconden die gebruiker Hallo Hallo moet wachten voordat het opnieuw proberen van Hallo aanvraag.</span><span class="sxs-lookup"><span data-stu-id="6684c-241">hello server will preemptively end hello request with RequestRateTooLarge (HTTP status code 429) and return hello x-ms-retry-after-ms header indicating hello amount of time, in milliseconds, that hello user must wait before reattempting hello request.</span></span>

        HTTP Status 429,
        Status Line: RequestRateTooLarge
        x-ms-retry-after-ms :100

    <span data-ttu-id="6684c-242">Hallo-SDK's alle impliciet dit antwoord catch, te respecteren Hallo server opgegeven opnieuw proberen na header en Hallo aanvraag opnieuw proberen.</span><span class="sxs-lookup"><span data-stu-id="6684c-242">hello SDKs all implicitly catch this response, respect hello server-specified retry-after header, and retry hello request.</span></span> <span data-ttu-id="6684c-243">Tenzij uw account wordt door meerdere clients tegelijkertijd geopend, wordt een nieuwe poging gedaan Hallo slaagt.</span><span class="sxs-lookup"><span data-stu-id="6684c-243">Unless your account is being accessed concurrently by multiple clients, hello next retry will succeed.</span></span>

    <span data-ttu-id="6684c-244">Als er meer dan één client cumulatief werken consistent boven aanvraagsnelheid hello, Hallo standaardaantal nieuwe pogingen momenteel set too9 intern door Hallo-client niet toereikend zijn; in dit geval Hallo client genereert een DocumentClientException met status code 429 toohello toepassing.</span><span class="sxs-lookup"><span data-stu-id="6684c-244">If you have more than one client cumulatively operating consistently above hello request rate, hello default retry count currently set too9 internally by hello client may not suffice; in this case, hello client throws a DocumentClientException with status code 429 toohello application.</span></span> <span data-ttu-id="6684c-245">aantal nieuwe pogingen van Hallo standaard kan worden gewijzigd door de instelling Hallo RetryOptions op Hallo ConnectionPolicy exemplaar.</span><span class="sxs-lookup"><span data-stu-id="6684c-245">hello default retry count can be changed by setting hello RetryOptions on hello ConnectionPolicy instance.</span></span> <span data-ttu-id="6684c-246">Standaard Hallo DocumentClientException met statuscode 429 na een cumulatieve wachttijd van 30 seconden geretourneerd als Hallo aanvraag toooperate hierboven Hallo aanvraagsnelheid blijft.</span><span class="sxs-lookup"><span data-stu-id="6684c-246">By default, hello DocumentClientException with status code 429 is returned after a cumulative wait time of 30 seconds if hello request continues toooperate above hello request rate.</span></span> <span data-ttu-id="6684c-247">Dit gebeurt zelfs wanneer de huidige pogingen Hallo kleiner is dan Hallo max. aantal, het Hallo-standaardwaarde van 9 of een door de gebruiker gedefinieerde waarde.</span><span class="sxs-lookup"><span data-stu-id="6684c-247">This occurs even when hello current retry count is less than hello max retry count, be it hello default of 9 or a user-defined value.</span></span>

    <span data-ttu-id="6684c-248">Hoewel Hallo geautomatiseerde gedrag voor het opnieuw kunt tooimprove tolerantie en gebruiksgemak voor Hallo de meeste toepassingen, deze mogelijk geleverd op odds bij het uitvoeren van prestatiebenchmarks, vooral wanneer meten latentie.</span><span class="sxs-lookup"><span data-stu-id="6684c-248">While hello automated retry behavior helps tooimprove resiliency and usability for hello most applications, it might come at odds when doing performance benchmarks, especially when measuring latency.</span></span>  <span data-ttu-id="6684c-249">Hallo client waargenomen-latentie wordt pieken als Hallo experiment Hallo server versnelling treffers en zorgt ervoor Hallo client SDK toosilently probeer het opnieuw dat.</span><span class="sxs-lookup"><span data-stu-id="6684c-249">hello client-observed latency will spike if hello experiment hits hello server throttle and causes hello client SDK toosilently retry.</span></span> <span data-ttu-id="6684c-250">tooavoid latentie bereikt tijdens prestaties experimenten, meting Hallo kosten geretourneerd door elke bewerking en zorg ervoor dat aanvragen hieronder Hallo gereserveerde aanvraagsnelheid werkt.</span><span class="sxs-lookup"><span data-stu-id="6684c-250">tooavoid latency spikes during performance experiments, measure hello charge returned by each operation and ensure that requests are operating below hello reserved request rate.</span></span> <span data-ttu-id="6684c-251">Zie voor meer informatie [Aanvraageenheden](request-units.md).</span><span class="sxs-lookup"><span data-stu-id="6684c-251">For more information, see [Request units](request-units.md).</span></span>
3. <span data-ttu-id="6684c-252">**Ontwerp voor kleinere documenten voor een hogere doorvoer**</span><span class="sxs-lookup"><span data-stu-id="6684c-252">**Design for smaller documents for higher throughput**</span></span>

    <span data-ttu-id="6684c-253">Hallo aanvraag kosten (dat wil zeggen aanvraagverwerking kosten) van een bepaalde bewerking is rechtstreeks gecorreleerde toohello grootte van het Hallo-document.</span><span class="sxs-lookup"><span data-stu-id="6684c-253">hello request charge (i.e. request processing cost) of a given operation is directly correlated toohello size of hello document.</span></span> <span data-ttu-id="6684c-254">Bewerkingen op grote documenten duurder dan bewerkingen voor kleine documenten.</span><span class="sxs-lookup"><span data-stu-id="6684c-254">Operations on large documents cost more than operations for small documents.</span></span>

## <a name="next-steps"></a><span data-ttu-id="6684c-255">Volgende stappen</span><span class="sxs-lookup"><span data-stu-id="6684c-255">Next steps</span></span>
<span data-ttu-id="6684c-256">Zie voor een voorbeeld toepassing gebruikt tooevaluate Cosmos DB voor scenario's met hoge prestaties op enkele clientcomputers, [prestaties en schaal testen met Cosmos DB](performance-testing.md).</span><span class="sxs-lookup"><span data-stu-id="6684c-256">For a sample application used tooevaluate Cosmos DB for high-performance scenarios on a few client machines, see [Performance and scale testing with Cosmos DB](performance-testing.md).</span></span>

<span data-ttu-id="6684c-257">Toolearn meer informatie over het ontwerpen van uw aanvraag voor schaal en hoge prestaties, Zie ook [partitionering en schalen in Azure Cosmos DB](partition-data.md).</span><span class="sxs-lookup"><span data-stu-id="6684c-257">Also, toolearn more about designing your application for scale and high performance, see [Partitioning and scaling in Azure Cosmos DB](partition-data.md).</span></span>
