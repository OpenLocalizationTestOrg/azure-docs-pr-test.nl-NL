---
title: Azure DB Cosmos-firewallondersteuning & IP-toegangsbeheer | Microsoft Docs
description: Informatie over het gebruik van IP-beleid voor toegangsbeheer voor firewallondersteuning op de accounts van Azure DB die Cosmos-database.
keywords: Toegangsbeheer voor IP-, firewallondersteuning
services: cosmos-db
author: shahankur11
manager: jhubbard
editor: 
tags: azure-resource-manager
documentationcenter: 
ms.assetid: c1b9ede0-ed93-411a-ac9a-62c113a8e887
ms.service: cosmos-db
ms.workload: data-services
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 05/22/2017
ms.author: ankshah
ms.openlocfilehash: e08c0ba9c1fc0bab72ae8c1158aafaad4f66920e
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 07/11/2017
---
# <a name="azure-cosmos-db-firewall-support"></a><span data-ttu-id="663ec-104">Ondersteuning van Azure DB Cosmos-firewall</span><span class="sxs-lookup"><span data-stu-id="663ec-104">Azure Cosmos DB firewall support</span></span>
<span data-ttu-id="663ec-105">Als u wilt beveiligen gegevens die zijn opgeslagen in een databaseaccount Azure Cosmos DB, Azure Cosmos DB heeft biedt ondersteuning voor een geheim op basis van [autorisatie model](https://msdn.microsoft.com/library/azure/dn783368.aspx) die gebruikmaakt van een sterke Hash-based message authentication code (HMAC).</span><span class="sxs-lookup"><span data-stu-id="663ec-105">To secure data stored in an Azure Cosmos DB database account, Azure Cosmos DB has provided support for a secret based [authorization model](https://msdn.microsoft.com/library/azure/dn783368.aspx) that utilizes a strong Hash-based message authentication code (HMAC).</span></span> <span data-ttu-id="663ec-106">Azure Cosmos DB ondersteunt nu, naast het model geheime gebaseerde autorisatie beleid IP gebaseerd toegangsbeheer voor binnenkomende firewallondersteuning aangestuurd.</span><span class="sxs-lookup"><span data-stu-id="663ec-106">Now, in addition to the secret based authorization model, Azure Cosmos DB supports policy driven IP-based access controls for inbound firewall support.</span></span> <span data-ttu-id="663ec-107">Dit model is vergelijkbaar met de firewallregels van een systeem van traditionele databases en biedt een extra beveiligingsniveau voor de account van de Azure DB die Cosmos-database.</span><span class="sxs-lookup"><span data-stu-id="663ec-107">This model is very similar to the firewall rules of a traditional database system and provides an additional level of security to the Azure Cosmos DB database account.</span></span> <span data-ttu-id="663ec-108">Met dit model, kunt u nu een databaseaccount Azure Cosmos DB om te worden alleen toegankelijk vanuit een goedgekeurde set machines en/of cloud services configureren.</span><span class="sxs-lookup"><span data-stu-id="663ec-108">With this model, you can now configure an Azure Cosmos DB database account to be accessible only from an approved set of machines and/or cloud services.</span></span> <span data-ttu-id="663ec-109">Toegang tot Azure Cosmos DB resources uit deze goedgekeurde sets met machines en services vereisen nog steeds de aanroeper om weer te geven van een geldige verificatietoken.</span><span class="sxs-lookup"><span data-stu-id="663ec-109">Access to Azure Cosmos DB resources from these approved sets of machines and services still require the caller to present a valid authorization token.</span></span>

## <a name="ip-access-control-overview"></a><span data-ttu-id="663ec-110">IP-Toegangsbeheer-overzicht</span><span class="sxs-lookup"><span data-stu-id="663ec-110">IP access control overview</span></span>
<span data-ttu-id="663ec-111">Een Azure DB die Cosmos-databaseaccount is standaard toegankelijk is vanaf het openbare internet, zolang de aanvraag vergezeld van een geldige verificatietoken gaat.</span><span class="sxs-lookup"><span data-stu-id="663ec-111">By default, an Azure Cosmos DB database account is accessible from public internet as long as the request is accompanied by a valid authorization token.</span></span> <span data-ttu-id="663ec-112">De gebruiker moet de verzameling van IP-adressen of IP-adresbereiken in CIDR-formulier moeten worden opgenomen als de lijst met toegestane van client-IP-adressen voor een bepaalde database-account opgeven voor het configureren van IP-toegangsbeheer op basis van beleid.</span><span class="sxs-lookup"><span data-stu-id="663ec-112">To configure IP policy-based access control, the user must provide the set of IP addresses or IP address ranges in CIDR form to be included as the allowed list of client IPs for a given database account.</span></span> <span data-ttu-id="663ec-113">Nadat deze configuratie is toegepast, worden alle aanvragen die afkomstig zijn van computers buiten deze lijst met toegestane wordt geblokkeerd door de server.</span><span class="sxs-lookup"><span data-stu-id="663ec-113">Once this configuration is applied, all requests originating from machines outside this allowed list will be blocked by the server.</span></span>  <span data-ttu-id="663ec-114">De verwerking van de stroom voor het besturingselement toegang op basis van IP-verbinding wordt beschreven in het volgende diagram.</span><span class="sxs-lookup"><span data-stu-id="663ec-114">The connection processing flow for the IP-based access control is described in the following diagram.</span></span>

![Diagram van het verbindingsproces voor toegangsbeheer op basis van IP](./media/firewall-support/firewall-support-flow.png)

## <a name="connections-from-cloud-services"></a><span data-ttu-id="663ec-116">Verbindingen met cloudservices</span><span class="sxs-lookup"><span data-stu-id="663ec-116">Connections from cloud services</span></span>
<span data-ttu-id="663ec-117">Cloudservices zijn in Azure, een veelgebruikte manier voor het hosten van de middelste laag service logica met behulp van Azure Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="663ec-117">In Azure, cloud services are a very common way for hosting middle tier service logic using Azure Cosmos DB.</span></span> <span data-ttu-id="663ec-118">Als u wilt toegang inschakelen voor een Azure DB die Cosmos-databaseaccount van een cloudservice, het openbare IP-adres van de cloudservice moet worden toegevoegd aan de lijst met toegestane IP-adressen die zijn gekoppeld aan uw Azure DB die Cosmos-databaseaccount door [configureren van de IP-beleid voor toegangsbeheer](#configure-ip-policy).</span><span class="sxs-lookup"><span data-stu-id="663ec-118">To enable access to an Azure Cosmos DB database account from a cloud service, the public IP address of the cloud service must be added to the allowed list of IP addresses associated with your Azure Cosmos DB database account by [configuring the IP access control policy](#configure-ip-policy).</span></span>  <span data-ttu-id="663ec-119">Dit zorgt ervoor dat alle rolexemplaren van cloud-services toegang tot uw databaseaccount Azure Cosmos DB hebben.</span><span class="sxs-lookup"><span data-stu-id="663ec-119">This ensures that all role instances of cloud services have access to your Azure Cosmos DB database account.</span></span> <span data-ttu-id="663ec-120">U kunt IP-adressen ophalen voor uw cloudservices in de Azure portal, zoals wordt weergegeven in de volgende schermafbeelding.</span><span class="sxs-lookup"><span data-stu-id="663ec-120">You can retrieve IP addresses for your cloud services in the Azure portal, as shown in the following screenshot.</span></span>

![Schermopname van het openbare IP-adres voor een cloudservice die wordt weergegeven in de Azure-portal](./media/firewall-support/public-ip-addresses.png)

<span data-ttu-id="663ec-122">Wanneer u uw cloudservice uitbreiden door aanvullende rol exemplaren toe te voegen, hebben deze nieuwe exemplaren automatisch toegang tot het account van de Azure DB die Cosmos-database omdat ze deel van dezelfde cloudservice uitmaken.</span><span class="sxs-lookup"><span data-stu-id="663ec-122">When you scale out your cloud service by adding additional role instance(s), those new instances will automatically have access to the Azure Cosmos DB database account since they are part of the same cloud service.</span></span>

## <a name="connections-from-virtual-machines"></a><span data-ttu-id="663ec-123">Verbindingen van virtuele machines</span><span class="sxs-lookup"><span data-stu-id="663ec-123">Connections from virtual machines</span></span>
<span data-ttu-id="663ec-124">[Virtuele machines](https://azure.microsoft.com/services/virtual-machines/) of [virtuele-machineschaalsets](../virtual-machine-scale-sets/virtual-machine-scale-sets-overview.md) kan ook worden gebruikt voor het hosten van de middelste laag services met behulp van Azure Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="663ec-124">[Virtual machines](https://azure.microsoft.com/services/virtual-machines/) or [virtual machine scale sets](../virtual-machine-scale-sets/virtual-machine-scale-sets-overview.md) can also be used to host middle tier services using Azure Cosmos DB.</span></span>  <span data-ttu-id="663ec-125">Voor het configureren van de account van de Azure DB die Cosmos-database voor toegang van virtuele machines, openbare IP-adressen van virtuele machine en/of de virtuele-machineschaalset moeten worden geconfigureerd als een van de toegestane IP-adressen voor het account van uw Azure DB die Cosmos-database door [configureren van de IP-beleid voor toegangsbeheer](#configure-ip-policy).</span><span class="sxs-lookup"><span data-stu-id="663ec-125">To configure the Azure Cosmos DB database account to allow access from virtual machines, public IP addresses of virtual machine and/or virtual machine scale set must be configured as one of the allowed IP addresses for your Azure Cosmos DB database account by [configuring the IP access control policy](#configure-ip-policy).</span></span> <span data-ttu-id="663ec-126">U kunt IP-adressen voor virtuele machines in de Azure-portal ophalen, zoals wordt weergegeven in de volgende schermafbeelding.</span><span class="sxs-lookup"><span data-stu-id="663ec-126">You can retrieve IP addresses for virtual machines in the Azure portal, as shown in the following screenshot.</span></span>

![Schermopname van een openbaar IP-adres voor een virtuele machine weergegeven in de Azure-portal](./media/firewall-support/public-ip-addresses-dns.png)

<span data-ttu-id="663ec-128">Wanneer u aanvullende virtuele machines aan de groep toevoegt, worden ze automatisch toegang tot uw Azure DB die Cosmos-databaseaccount opgegeven.</span><span class="sxs-lookup"><span data-stu-id="663ec-128">When you add additional virtual machine instances to the group, they are automatically provided access to your Azure Cosmos DB database account.</span></span>

## <a name="connections-from-the-internet"></a><span data-ttu-id="663ec-129">Clientverbindingen van het internet</span><span class="sxs-lookup"><span data-stu-id="663ec-129">Connections from the internet</span></span>
<span data-ttu-id="663ec-130">Wanneer u een databaseaccount Azure Cosmos DB vanaf een computer op het internet openen, moet de client-IP-adres of IP-adresbereik van de machine worden toegevoegd aan de lijst met toegestane IP-adres voor het account van de Azure DB die Cosmos-database.</span><span class="sxs-lookup"><span data-stu-id="663ec-130">When you access an Azure Cosmos DB database account from a computer on the internet, the client IP address or IP address range of the machine must be added to the allowed list of IP address for the Azure Cosmos DB database account.</span></span> 

## <span data-ttu-id="663ec-131"><a id="configure-ip-policy"></a>Het IP-beleid voor toegangsbeheer configureren</span><span class="sxs-lookup"><span data-stu-id="663ec-131"><a id="configure-ip-policy"></a> Configuring the IP access control policy</span></span>
<span data-ttu-id="663ec-132">Het IP-beleid voor toegangsbeheer kan worden ingesteld in de Azure portal of programmatisch via [Azure CLI](cli-samples.md), [Azure Powershell](powershell-samples.md), of de [REST-API](/rest/api/documentdb/) door het bijwerken van de `ipRangeFilter` eigenschap.</span><span class="sxs-lookup"><span data-stu-id="663ec-132">The IP access control policy can be set in the Azure portal, or programmatically through [Azure CLI](cli-samples.md), [Azure Powershell](powershell-samples.md), or the [REST API](/rest/api/documentdb/) by updating the `ipRangeFilter` property.</span></span> <span data-ttu-id="663ec-133">IP-adressen of-adresbereiken moet door komma's gescheiden en mag geen spaties bevatten.</span><span class="sxs-lookup"><span data-stu-id="663ec-133">IP addresses/ranges must be comma separated and must not contain any spaces.</span></span> <span data-ttu-id="663ec-134">Voorbeeld: '13.91.6.132,13.91.6.1/24'.</span><span class="sxs-lookup"><span data-stu-id="663ec-134">Example: "13.91.6.132,13.91.6.1/24".</span></span> <span data-ttu-id="663ec-135">Wanneer uw databaseaccount wordt bijgewerkt via deze methoden, zorg er dan voor dat alle eigenschappen om te voorkomen dat de standaardinstellingen herstelt vullen.</span><span class="sxs-lookup"><span data-stu-id="663ec-135">When updating your database account through these methods, be sure to populate all of the properties to prevent resetting to default settings.</span></span>

> [!NOTE]
> <span data-ttu-id="663ec-136">Als u een IP-toegangsbeleid voor het account van uw Azure DB die Cosmos-database, alle toegang tot uw Azure DB die Cosmos-databaseaccount vanaf computers buiten de geconfigureerde toegestaan lijst met IP-adresbereiken worden geblokkeerd.</span><span class="sxs-lookup"><span data-stu-id="663ec-136">By enabling an IP access control policy for your Azure Cosmos DB database account, all access to your Azure Cosmos DB database account from machines outside the configured allowed list of IP address ranges are blocked.</span></span> <span data-ttu-id="663ec-137">Doordat dit model wordt bladeren door de bewerking voor het vlak van gegevens vanuit de portal ook geblokkeerd om te controleren of de integriteit van toegangsbeheer.</span><span class="sxs-lookup"><span data-stu-id="663ec-137">By virtue of this model, browsing the data plane operation from the portal will also be blocked to ensure the integrity of access control.</span></span>

<span data-ttu-id="663ec-138">Als u wilt vereenvoudigen, de Azure-portal helpt u te identificeren en het IP-adres van uw client-computer toevoegen aan de lijst met toegestane zodat apps die worden uitgevoerd van de computer toegang heeft tot de Azure DB die Cosmos-account.</span><span class="sxs-lookup"><span data-stu-id="663ec-138">To simplify development, the Azure portal helps you identify and add the IP of your client machine to the allowed list, so that apps running your machine can access the Azure Cosmos DB account.</span></span> <span data-ttu-id="663ec-139">Houd er rekening mee dat de IP-adres van de client hier is gedetecteerd in de portal.</span><span class="sxs-lookup"><span data-stu-id="663ec-139">Note that the client IP address here is detected as seen by the portal.</span></span> <span data-ttu-id="663ec-140">Kan de client-IP-adres van uw machine zijn, maar dit kan ook worden de IP-adres van de gateway van uw netwerk.</span><span class="sxs-lookup"><span data-stu-id="663ec-140">It may be the client IP address of your machine, but it could also be the IP address of your network gateway.</span></span> <span data-ttu-id="663ec-141">Vergeet niet om deze te verwijderen voordat u doorgaat naar productie.</span><span class="sxs-lookup"><span data-stu-id="663ec-141">Do not forget to remove it before going to production.</span></span>

<span data-ttu-id="663ec-142">Om in te stellen de IP-beleid voor toegangsbeheer in Azure portal, Ga naar de blade van Azure DB die Cosmos-account, klikt u op **Firewall** Klik in het navigatiemenu **ON**</span><span class="sxs-lookup"><span data-stu-id="663ec-142">To set the IP access control policy in the Azure portal, navigate to the Azure Cosmos DB account blade, click **Firewall** in the navigation menu, then click **ON**</span></span> 

![Schermopname die laat zien hoe u de Firewall-blade geopend in de Azure portal](./media/firewall-support/azure-portal-firewall.png)

<span data-ttu-id="663ec-144">Geef op of de Azure-portal kunt toegang het account tot en andere adressen en -bereiken als in de toepassing en klik vervolgens op toevoegen in het nieuwe deelvenster **opslaan**.</span><span class="sxs-lookup"><span data-stu-id="663ec-144">In the new pane, specify whether the Azure portal can access the account, and add other addresses and ranges as appropriate, then click **Save**.</span></span>  

> [!NOTE]
> <span data-ttu-id="663ec-145">Wanneer u een IP-beleid voor toegangsbeheer inschakelt, moet u het IP-adres voor de Azure portal toegankelijk toevoegen.</span><span class="sxs-lookup"><span data-stu-id="663ec-145">When you enable an IP access control policy, you need to add the IP address for the Azure portal to maintain access.</span></span> <span data-ttu-id="663ec-146">De portal IP-adressen zijn:</span><span class="sxs-lookup"><span data-stu-id="663ec-146">The portal IP addresses are:</span></span>
> |<span data-ttu-id="663ec-147">Regio</span><span class="sxs-lookup"><span data-stu-id="663ec-147">Region</span></span>|<span data-ttu-id="663ec-148">IP-adres</span><span class="sxs-lookup"><span data-stu-id="663ec-148">IP address</span></span>|
> |------|----------|
> |<span data-ttu-id="663ec-149">Alle regio's die zijn opgegeven behalve hieronder</span><span class="sxs-lookup"><span data-stu-id="663ec-149">All regions except those specified below</span></span>| <span data-ttu-id="663ec-150">104.42.195.92</span><span class="sxs-lookup"><span data-stu-id="663ec-150">104.42.195.92</span></span>|
> |<span data-ttu-id="663ec-151">Duitsland</span><span class="sxs-lookup"><span data-stu-id="663ec-151">Germany</span></span>|<span data-ttu-id="663ec-152">51.4.229.218</span><span class="sxs-lookup"><span data-stu-id="663ec-152">51.4.229.218</span></span>|
> |<span data-ttu-id="663ec-153">China</span><span class="sxs-lookup"><span data-stu-id="663ec-153">China</span></span>|<span data-ttu-id="663ec-154">139.217.8.252</span><span class="sxs-lookup"><span data-stu-id="663ec-154">139.217.8.252</span></span>|
> |<span data-ttu-id="663ec-155">VS (overheid) - Arizona</span><span class="sxs-lookup"><span data-stu-id="663ec-155">US Gov Arizona</span></span>|<span data-ttu-id="663ec-156">52.244.48.71</span><span class="sxs-lookup"><span data-stu-id="663ec-156">52.244.48.71</span></span>|
>

![Schermopname die laat zien hoe u een firewall-instellingen configureren in de Azure portal](./media/firewall-support/azure-portal-firewall-configure.png)

## <a name="troubleshooting-the-ip-access-control-policy"></a><span data-ttu-id="663ec-158">Het oplossen van het IP-beleid voor toegangsbeheer</span><span class="sxs-lookup"><span data-stu-id="663ec-158">Troubleshooting the IP access control policy</span></span>
### <a name="portal-operations"></a><span data-ttu-id="663ec-159">Portal-bewerkingen</span><span class="sxs-lookup"><span data-stu-id="663ec-159">Portal operations</span></span>
<span data-ttu-id="663ec-160">Als u een IP-toegangsbeleid voor het account van uw Azure DB die Cosmos-database, alle toegang tot uw Azure DB die Cosmos-databaseaccount vanaf computers buiten de geconfigureerde toegestaan lijst met IP-adresbereiken worden geblokkeerd.</span><span class="sxs-lookup"><span data-stu-id="663ec-160">By enabling an IP access control policy for your Azure Cosmos DB database account, all access to your Azure Cosmos DB database account from machines outside the configured allowed list of IP address ranges are blocked.</span></span> <span data-ttu-id="663ec-161">Dus als u inschakelen portal gegevens vlak bewerkingen wilt zoals het bladeren door verzamelingen en query-documenten, moet u expliciet toestaan toegang tot de Azure portal met behulp van de **Firewall** blade in de portal.</span><span class="sxs-lookup"><span data-stu-id="663ec-161">Therefore if you want to enable portal data plane operations like browsing collections and query documents, you need to explicitly allow Azure portal access using the **Firewall** blade in the portal.</span></span> 

![Schermopname die laat zien hoe u een voor toegang tot de Azure-portal](./media/firewall-support/azure-portal-access-firewall.png)

### <a name="sdk--rest-api"></a><span data-ttu-id="663ec-163">SDK & Rest-API</span><span class="sxs-lookup"><span data-stu-id="663ec-163">SDK & Rest API</span></span>
<span data-ttu-id="663ec-164">Voor toegang via SDK of REST-API van computers niet in de lijst met toegestane uit veiligheidsoverwegingen het resultaat van algemene 404 niet gevonden zonder extra details.</span><span class="sxs-lookup"><span data-stu-id="663ec-164">For security reasons, access via SDK or REST API from machines not on the allowed list will return a generic 404 Not Found response with no additional details.</span></span> <span data-ttu-id="663ec-165">Controleer of het IP-adres toegestaan lijst die zijn geconfigureerd voor het account van uw Azure DB die Cosmos-database om te controleren of de dat configuratie van het juiste beleid wordt toegepast op uw databaseaccount Azure Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="663ec-165">Please verify the IP allowed list configured for your Azure Cosmos DB database account to ensure the correct policy configuration is applied to your Azure Cosmos DB database account.</span></span>

## <a name="next-steps"></a><span data-ttu-id="663ec-166">Volgende stappen</span><span class="sxs-lookup"><span data-stu-id="663ec-166">Next steps</span></span>
<span data-ttu-id="663ec-167">Zie voor informatie over het netwerk gerelateerde prestatietips [tips voor betere prestaties](performance-tips.md).</span><span class="sxs-lookup"><span data-stu-id="663ec-167">For information about network related performance tips, see [Performance tips](performance-tips.md).</span></span>

