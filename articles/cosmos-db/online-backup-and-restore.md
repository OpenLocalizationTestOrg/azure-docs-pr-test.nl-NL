---
title: Online back-up en herstel met Azure Cosmos DB | Microsoft Docs
description: Informatie over het uitvoeren van automatische back-up en herstellen op een Azure DB die Cosmos-database.
keywords: Backup and restore online back-up
services: cosmos-db
documentationcenter: 
author: RahulPrasad16
manager: jhubbard
editor: monicar
ms.assetid: 98eade4a-7ef4-4667-b167-6603ecd80b79
ms.service: cosmos-db
ms.workload: data-services
ms.tgt_pltfrm: na
ms.devlang: multiple
ms.topic: article
ms.date: 08/11/2017
ms.author: raprasa
ms.openlocfilehash: 130f0eb259621737d6dbdb151e363915fb334ce1
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 08/18/2017
---
# <a name="automatic-online-backup-and-restore-with-azure-cosmos-db"></a><span data-ttu-id="ac043-104">Automatische online back-up en herstel met Azure Cosmos-DB</span><span class="sxs-lookup"><span data-stu-id="ac043-104">Automatic online backup and restore with Azure Cosmos DB</span></span>
<span data-ttu-id="ac043-105">Azure Cosmos-database wordt automatisch back-ups van al uw gegevens met regelmatige tussenpozen.</span><span class="sxs-lookup"><span data-stu-id="ac043-105">Azure Cosmos DB automatically takes backups of all your data at regular intervals.</span></span> <span data-ttu-id="ac043-106">De automatische back-ups worden gemaakt zonder de prestaties of beschikbaarheid van uw databasebewerkingen.</span><span class="sxs-lookup"><span data-stu-id="ac043-106">The automatic backups are taken without affecting the performance or availability of your database operations.</span></span> <span data-ttu-id="ac043-107">Uw back-ups apart zijn opgeslagen in een andere storage-service en deze back-ups globaal voor tolerantie tegen regionale noodsituaties worden gerepliceerd.</span><span class="sxs-lookup"><span data-stu-id="ac043-107">All your backups are stored separately in another storage service, and those backups are globally replicated for resiliency against regional disasters.</span></span> <span data-ttu-id="ac043-108">De automatische back-ups zijn bedoeld voor scenario's wanneer u uw Comos DB-container per ongeluk verwijdert en later nodig hebt voor herstel van gegevens of een noodherstel.</span><span class="sxs-lookup"><span data-stu-id="ac043-108">The automatic backups are intended for scenarios when you accidentally delete your Comos DB container and later require data recovery or a disaster recovery solution.</span></span>  

<span data-ttu-id="ac043-109">Dit artikel begint met een snelle samenvatting van de gegevensredundantie en beschikbaarheid in een Cosmos-database en vervolgens back-ups besproken.</span><span class="sxs-lookup"><span data-stu-id="ac043-109">This article starts with a quick recap of the data redundancy and availability in Cosmos DB, and then discusses backups.</span></span> 

## <a name="high-availability-with-cosmos-db---a-recap"></a><span data-ttu-id="ac043-110">Hoge beschikbaarheid met Cosmos-DB - een samenvatting</span><span class="sxs-lookup"><span data-stu-id="ac043-110">High availability with Cosmos DB - a recap</span></span>
<span data-ttu-id="ac043-111">Cosmos DB is ontworpen om te worden [globaal gedistribueerde](distribute-data-globally.md) – Hiermee kunt u de schaal van doorvoer voor meerdere Azure-regio's samen met aangestuurd transparante multihoming API's en failover-beleid.</span><span class="sxs-lookup"><span data-stu-id="ac043-111">Cosmos DB is designed to be [globally distributed](distribute-data-globally.md) – it allows you to scale throughput across multiple Azure regions along with policy driven failover and transparent multi-homing APIs.</span></span> <span data-ttu-id="ac043-112">Als een database system aanbieding [99,99% beschikbaarheid serviceovereenkomsten](https://azure.microsoft.com/support/legal/sla/cosmos-db), alle schrijfbewerkingen in Cosmos DB zijn blijvend doorgevoerd naar lokale schijven door een quorum van replica's binnen een lokale datacentrum voordat naar de client zijn bevestigd.</span><span class="sxs-lookup"><span data-stu-id="ac043-112">As a database system offering [99.99% availability SLAs](https://azure.microsoft.com/support/legal/sla/cosmos-db), all the writes in Cosmos DB are durably committed to local disks by a quorum of replicas within a local data center before acknowledging to the client.</span></span> <span data-ttu-id="ac043-113">Houd er rekening mee dat de hoge beschikbaarheid van de Cosmos-DB is afhankelijk van de lokale opslag, en is niet afhankelijk van een externe opslagtechnologieën.</span><span class="sxs-lookup"><span data-stu-id="ac043-113">Note that the high availability of Cosmos DB relies on local storage and does not depend on any external storage technologies.</span></span> <span data-ttu-id="ac043-114">Als de databaseaccount gekoppeld aan meer dan één Azure-regio is, worden uw schrijfbewerkingen bovendien gerepliceerd in andere regio's ook.</span><span class="sxs-lookup"><span data-stu-id="ac043-114">Additionally, if your database account is associated with more than one Azure region, your writes are replicated across other regions as well.</span></span> <span data-ttu-id="ac043-115">Als u wilt schalen de doorvoer en toegang tot gegevens op lage latenties, kunt u hebben zoals veel gebieden die zijn gekoppeld aan uw databaseaccount als u wilt lezen.</span><span class="sxs-lookup"><span data-stu-id="ac043-115">To scale your throughput and access data at low latencies, you can have as many read regions associated with your database account as you like.</span></span> <span data-ttu-id="ac043-116">In elke regio lezen, wordt de (gerepliceerde) gegevens blijvend vastgehouden in een replicaset.</span><span class="sxs-lookup"><span data-stu-id="ac043-116">In each read region, the (replicated) data is durably persisted across a replica set.</span></span>  

<span data-ttu-id="ac043-117">Zoals weergegeven in het volgende diagram, is het een enkele container van de Cosmos-DB [horizontaal gepartitioneerde](partition-data.md).</span><span class="sxs-lookup"><span data-stu-id="ac043-117">As illustrated in the following diagram, a single Cosmos DB container is [horizontally partitioned](partition-data.md).</span></span> <span data-ttu-id="ac043-118">Een 'partitie' wordt aangeduid met een cirkel in het volgende diagram en elke partitie is maximaal beschikbaar is via een replicaset is gemaakt.</span><span class="sxs-lookup"><span data-stu-id="ac043-118">A “partition” is denoted by a circle in the following diagram, and each partition is made highly available via a replica set.</span></span> <span data-ttu-id="ac043-119">Dit is de lokale distributiepunten binnen (aangeduid met de X-as) één Azure-regio.</span><span class="sxs-lookup"><span data-stu-id="ac043-119">This is the local distribution within a single Azure region (denoted by the X axis).</span></span> <span data-ttu-id="ac043-120">Elke partitie (met de bijbehorende replica is ingesteld) wordt verder dan globaal gedistribueerd over meerdere regio's die zijn gekoppeld aan uw databaseaccount (bijvoorbeeld in deze afbeelding de drie regio's: VS-Oost, VS-West en centrale India).</span><span class="sxs-lookup"><span data-stu-id="ac043-120">Further, each partition (with its corresponding replica set) is then globally distributed across multiple regions associated with your database account (for example, in this illustration the three regions – East US, West US and Central India).</span></span> <span data-ttu-id="ac043-121">Het 'instellen voor partitie' is een wereldwijd gedistribueerde entiteit die bestaat uit meerdere exemplaren van uw gegevens in elke regio (aangeduid met de Y-as).</span><span class="sxs-lookup"><span data-stu-id="ac043-121">The “partition set” is a globally distributed entity comprising of multiple copies of your data in each region (denoted by the Y axis).</span></span> <span data-ttu-id="ac043-122">U kunt de prioriteit toewijzen aan de regio's die zijn gekoppeld aan uw databaseaccount en Cosmos DB wordt transparant failover naar de volgende regio in geval van noodsituaties.</span><span class="sxs-lookup"><span data-stu-id="ac043-122">You can assign priority to the regions associated with your database account and Cosmos DB will transparently failover to the next region in case of disaster.</span></span> <span data-ttu-id="ac043-123">U kunt ook handmatig failover wilt testen, de beschikbaarheid van de end-to-end van uw toepassing simuleren.</span><span class="sxs-lookup"><span data-stu-id="ac043-123">You can also manually simulate failover to test the end-to-end availability of your application.</span></span>  

<span data-ttu-id="ac043-124">De volgende afbeelding ziet u de hoge mate van redundantie met Cosmos-DB.</span><span class="sxs-lookup"><span data-stu-id="ac043-124">The following image illustrates the high degree of redundancy with Cosmos DB.</span></span>

![Hoge mate van redundantie met Cosmos-DB](./media/online-backup-and-restore/redundancy.png)

![Hoge mate van redundantie met Cosmos-DB](./media/online-backup-and-restore/global-distribution.png)

## <a name="full-automatic-online-backups"></a><span data-ttu-id="ac043-127">Volledige, automatische, online back-ups</span><span class="sxs-lookup"><span data-stu-id="ac043-127">Full, automatic, online backups</span></span>
<span data-ttu-id="ac043-128">Oeps, verwijderd ik mijn container of de database.</span><span class="sxs-lookup"><span data-stu-id="ac043-128">Oops, I deleted my container or database!</span></span> <span data-ttu-id="ac043-129">Met Cosmos DB, niet alleen uw gegevens, maar de back-ups van uw gegevens worden ook aangebracht maximaal redundante en robuuste regionale noodsituaties.</span><span class="sxs-lookup"><span data-stu-id="ac043-129">With Cosmos DB, not only your data, but the backups of your data are also made highly redundant and resilient to regional disasters.</span></span> <span data-ttu-id="ac043-130">Deze automatische back-ups worden momenteel ongeveer elke vier uur genomen en meest recente 2 back-ups te allen tijde worden opgeslagen.</span><span class="sxs-lookup"><span data-stu-id="ac043-130">These automated backups are currently taken approximately every four hours and latest 2 backups are stored at all times.</span></span> <span data-ttu-id="ac043-131">Als de gegevens per ongeluk is verwijderd of beschadigd, neem [Neem contact op met de ondersteuning van Azure](https://azure.microsoft.com/support/options/) binnen de 8 uur.</span><span class="sxs-lookup"><span data-stu-id="ac043-131">If the data is accidently dropped or corrupted, please [contact Azure support](https://azure.microsoft.com/support/options/) within 8 hours.</span></span> 

<span data-ttu-id="ac043-132">De back-ups worden gemaakt zonder de prestaties of beschikbaarheid van uw databasebewerkingen.</span><span class="sxs-lookup"><span data-stu-id="ac043-132">The backups are taken without affecting the performance or availability of your database operations.</span></span> <span data-ttu-id="ac043-133">Cosmos DB neemt de back-up op de achtergrond, zonder uw ingerichte RUs verbruikt of die betrekking hebben op de prestaties en zonder de beschikbaarheid van uw database.</span><span class="sxs-lookup"><span data-stu-id="ac043-133">Cosmos DB takes the backup in the background without consuming your provisioned RUs or affecting the performance and without affecting the availability of your database.</span></span> 

<span data-ttu-id="ac043-134">In tegenstelling tot de gegevens die zijn opgeslagen in Cosmos DB, worden de automatische back-ups worden opgeslagen in Azure Blob Storage-service.</span><span class="sxs-lookup"><span data-stu-id="ac043-134">Unlike your data that is stored inside Cosmos DB, the automatic backups are stored in Azure Blob Storage service.</span></span> <span data-ttu-id="ac043-135">Om te waarborgen van de lage latentie/efficiënt uploaden, wordt de momentopname van de back-up geüpload naar een exemplaar van Azure Blob storage in dezelfde regio bevinden als de huidige schrijven regio van uw databaseaccount Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="ac043-135">To guarantee the low latency/efficient upload, the snapshot of your backup is uploaded to an instance of Azure Blob storage in the same region as the current write region of your Cosmos DB database account.</span></span> <span data-ttu-id="ac043-136">Voor tolerantie tegen regionale na noodgevallen, elke momentopname van de back-upgegevens in Azure Blob-opslag opnieuw gerepliceerd via geografisch redundante opslag (GRS) naar een andere regio.</span><span class="sxs-lookup"><span data-stu-id="ac043-136">For resiliency against regional disaster, each snapshot of your backup data in Azure Blob Storage is again replicated via geo-redundant storage (GRS) to another region.</span></span> <span data-ttu-id="ac043-137">Het volgende diagram ziet dat de volledige container Cosmos-DB (met alle drie primaire partities in VS-West, in dit voorbeeld) is een back-up in een externe Azure Blob Storage-account in VS-West en vervolgens GRS gerepliceerd naar VS-Oost.</span><span class="sxs-lookup"><span data-stu-id="ac043-137">The following diagram shows that the entire Cosmos DB container (with all three primary partitions in West US, in this example) is backed up in a remote Azure Blob Storage account in West US and then GRS replicated to East US.</span></span> 

<span data-ttu-id="ac043-138">De volgende afbeelding ziet u periodieke volledige back-ups van alle Cosmos DB entiteiten in GRS Azure Storage.</span><span class="sxs-lookup"><span data-stu-id="ac043-138">The following image illustrates periodic full backups of all Cosmos DB entities in GRS Azure Storage.</span></span>

![Periodieke volledige back-ups van alle Cosmos DB entiteiten in GRS Azure Storage](./media/online-backup-and-restore/automatic-backup.png)

## <a name="backup-retention-period"></a><span data-ttu-id="ac043-140">Back-up bewaarperiode</span><span class="sxs-lookup"><span data-stu-id="ac043-140">Backup retention period</span></span>
<span data-ttu-id="ac043-141">Zoals hierboven wordt beschreven, wordt Azure Cosmos DB duurt momentopnamen van uw gegevens om de vier uur en behoudt de laatste twee momentopnamen van elke partitie gedurende 30 dagen.</span><span class="sxs-lookup"><span data-stu-id="ac043-141">As described above, Azure Cosmos DB takes snapshots of your data every four hours and retains the last two snapshots of every partition for 30 days.</span></span> <span data-ttu-id="ac043-142">Per onze nalevingsreglementen worden momentopnamen na 90 dagen permanent verwijderd.</span><span class="sxs-lookup"><span data-stu-id="ac043-142">Per our compliance regulations, snapshots are purged after 90 days.</span></span>

<span data-ttu-id="ac043-143">Als u onderhouden van uw eigen momentopnamen wilt, kunt u het exporteren naar een JSON-optie gebruiken in de database van de Cosmos Azure [hulpprogramma voor gegevensmigratie](import-data.md#export-to-json-file) aanvullende back-ups plannen.</span><span class="sxs-lookup"><span data-stu-id="ac043-143">If you want to maintain your own snapshots, you can use the export to JSON option in the Azure Cosmos DB [Data Migration tool](import-data.md#export-to-json-file) to schedule additional backups.</span></span> 

## <a name="restoring-a-database-from-an-online-backup"></a><span data-ttu-id="ac043-144">Een database terugzetten vanuit een online back-up</span><span class="sxs-lookup"><span data-stu-id="ac043-144">Restoring a database from an online backup</span></span>
<span data-ttu-id="ac043-145">Als u de database of een verzameling per ongeluk verwijdert, kunt u [bestand een ondersteuningsticket](https://portal.azure.com/?#blade/Microsoft_Azure_Support/HelpAndSupportBlade) of [contact op met ondersteuning voor Azure](https://azure.microsoft.com/support/options/) de gegevens van de laatste automatische back-up wilt terugzetten.</span><span class="sxs-lookup"><span data-stu-id="ac043-145">If you accidentally delete your database or collection, you can [file a support ticket](https://portal.azure.com/?#blade/Microsoft_Azure_Support/HelpAndSupportBlade) or [call Azure support](https://azure.microsoft.com/support/options/) to restore the data from the last automatic backup.</span></span> <span data-ttu-id="ac043-146">Als u uw database terugzetten vanwege beschadigingsprobleem gegevens wilt, Zie [afhandeling van gegevensbeschadiging](#handling-data-corruption) als u aanvullende stappen uitvoeren om te voorkomen dat de beschadigde gegevens van de back-ups vocht nodig.</span><span class="sxs-lookup"><span data-stu-id="ac043-146">If you need to restore your database because of data corruption issue, see [Handling data corruption](#handling-data-corruption) as you need to take additional steps to prevent the corrupted data from penetrating the backups.</span></span> <span data-ttu-id="ac043-147">Voor een specifieke momentopname van de back-up moet worden hersteld, vereist Cosmos DB dat de gegevens voor de duur van de back-cyclus voor het die momentopname beschikbaar is.</span><span class="sxs-lookup"><span data-stu-id="ac043-147">For a specific snapshot of your backup to be restored, Cosmos DB requires that the data was available for the duration of the backup cycle for that snapshot.</span></span>

## <a name="handling-data-corruption"></a><span data-ttu-id="ac043-148">Beschadigde gegevens verwerken</span><span class="sxs-lookup"><span data-stu-id="ac043-148">Handling data corruption</span></span>
<span data-ttu-id="ac043-149">Azure Cosmos DB behoudt de laatste twee back-ups van elke partitie in het systeem.</span><span class="sxs-lookup"><span data-stu-id="ac043-149">Azure Cosmos DB retains the last two backups of every partition in the system.</span></span> <span data-ttu-id="ac043-150">Dit model werkt uitstekend wanneer een container (verzameling van documenten, grafiek, tabel) of een database per ongeluk worden verwijderd omdat een van de laatste versies kan worden hersteld.</span><span class="sxs-lookup"><span data-stu-id="ac043-150">This model works very well when a container (collection of documents, graph, table) or a database is accidentally deleted since one of the last versions can be restored.</span></span> <span data-ttu-id="ac043-151">Echter, in het geval wanneer wanneer gebruikers leiden een probleem met de beschadiging van gegevens tot kunnen, Azure Cosmos DB mogelijk niet bewust zijn van de gegevens beschadigd en is het mogelijk de beschadiging van de back-ups mogelijk hebben gepenetreerd.</span><span class="sxs-lookup"><span data-stu-id="ac043-151">However, in the case when when users may introduce a data corruption issue, Azure Cosmos DB may be unaware of the data corruption, and it is possible that the corruption may have penetrated the backups.</span></span> <span data-ttu-id="ac043-152">Zo snel is beschadigd, moet u de beschadigde container (graph-verzameling/tabelnaam) verwijderen zodat back-ups worden beveiligd met beschadigde gegevens wordt overschreven.</span><span class="sxs-lookup"><span data-stu-id="ac043-152">As soon as corruption is detected, you should delete the corrupted container (collection/graph/table) so that backups are protected from being overwritten with corrupted data.</span></span> <span data-ttu-id="ac043-153">Omdat de laatste back-up kan vier uur oud is, kunt gebruikmaken van de gebruiker [wijzigen van de feed](change-feed.md) vastleggen en opslaan van de laatste vier uur waard van gegevens voor het verwijderen van de container.</span><span class="sxs-lookup"><span data-stu-id="ac043-153">Since the last backup could be four hours old, the user can employ [change feed](change-feed.md) to capture and store the last four hours worth of data before deleting the container.</span></span>

## <a name="next-steps"></a><span data-ttu-id="ac043-154">Volgende stappen</span><span class="sxs-lookup"><span data-stu-id="ac043-154">Next steps</span></span>

<span data-ttu-id="ac043-155">Als u wilt repliceren uw database in meerdere datacenters, Zie [distribueren van uw gegevens globaal met Cosmos DB](distribute-data-globally.md).</span><span class="sxs-lookup"><span data-stu-id="ac043-155">To replicate your database in multiple data centers, see [distribute your data globally with Cosmos DB](distribute-data-globally.md).</span></span> 

<span data-ttu-id="ac043-156">Bestand contact opnemen met ondersteuning van Azure [bestand een ticket vanuit de Azure-portal](https://portal.azure.com/?#blade/Microsoft_Azure_Support/HelpAndSupportBlade).</span><span class="sxs-lookup"><span data-stu-id="ac043-156">To file contact Azure Support, [file a ticket from the Azure portal](https://portal.azure.com/?#blade/Microsoft_Azure_Support/HelpAndSupportBlade).</span></span>

