---
title: SQL-query metrische gegevens voor de API van Azure Cosmos DB DocumentDB | Microsoft Docs
description: Meer informatie over het instrumenteren en de prestaties van de SQL-query's van Azure DB die Cosmos-aanvragen voor foutopsporing.
keywords: SQL-syntaxis, sql-query, sql-query's, json-querytaal, database-concepten en sql-query's, statistische functies
services: cosmos-db
documentationcenter: 
author: arramac
manager: jhubbard
editor: monicar
ms.assetid: b2fa8e8f-7291-45a3-9bd1-7284ed9077f8
ms.service: cosmos-db
ms.workload: data-services
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 08/15/2017
ms.author: arramac
ms.openlocfilehash: d928113e809e5ad43901e79dc256a8a39c210181
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 08/18/2017
---
# <a name="tuning-query-performance-with-azure-cosmos-db"></a><span data-ttu-id="c4372-104">Prestaties van query's met Azure Cosmos DB afstemmen</span><span class="sxs-lookup"><span data-stu-id="c4372-104">Tuning query performance with Azure Cosmos DB</span></span>
<span data-ttu-id="c4372-105">Azure Cosmos DB biedt een [SQL-API voor het opvragen van gegevens](documentdb-sql-query.md), zonder schema of secundaire indexen.</span><span class="sxs-lookup"><span data-stu-id="c4372-105">Azure Cosmos DB provides a [SQL API for querying data](documentdb-sql-query.md), without requiring schema or secondary indexes.</span></span> <span data-ttu-id="c4372-106">In dit artikel biedt de volgende informatie voor ontwikkelaars:</span><span class="sxs-lookup"><span data-stu-id="c4372-106">This article provides the following information for developers:</span></span>

* <span data-ttu-id="c4372-107">Details op hoog niveau over de werking van Azure Cosmos DB SQL-query-uitvoering</span><span class="sxs-lookup"><span data-stu-id="c4372-107">High-level details on how Azure Cosmos DB's SQL query execution works</span></span>
* <span data-ttu-id="c4372-108">Meer informatie over de aanvraag- en reactieheaders query en opties voor client-SDK</span><span class="sxs-lookup"><span data-stu-id="c4372-108">Details on query request and response headers, and client SDK options</span></span>
* <span data-ttu-id="c4372-109">Tips en aanbevolen procedures voor prestaties van query 's</span><span class="sxs-lookup"><span data-stu-id="c4372-109">Tips and best practices for query performance</span></span>
* <span data-ttu-id="c4372-110">Voorbeelden van hoe u kunt gebruikmaken van SQL-Uitvoeringsstatistieken voor foutopsporing van de prestaties van query 's</span><span class="sxs-lookup"><span data-stu-id="c4372-110">Examples of how to utilize SQL execution statistics to debug query performance</span></span>

## <a name="about-sql-query-execution"></a><span data-ttu-id="c4372-111">Over het uitvoeren van de SQL-query</span><span class="sxs-lookup"><span data-stu-id="c4372-111">About SQL query execution</span></span>

<span data-ttu-id="c4372-112">In Azure Cosmos DB, slaat u de gegevens in de containers die kunnen worden uitgebreid naar een [grootte of aanvraag opslagdoorvoer](partition-data.md).</span><span class="sxs-lookup"><span data-stu-id="c4372-112">In Azure Cosmos DB, you store data in containers, which can grow to any [storage size or request throughput](partition-data.md).</span></span> <span data-ttu-id="c4372-113">Azure Cosmos DB schaalt naadloos gegevens meerdere fysieke partities achter de Gegevensgroei verwerken of worden verhoogd met ingerichte doorvoer.</span><span class="sxs-lookup"><span data-stu-id="c4372-113">Azure Cosmos DB seamlessly scales data across physical partitions under the covers to handle data growth or increase in provisioned throughput.</span></span> <span data-ttu-id="c4372-114">U kunt de SQL-query's naar een container met de REST-API of een van de ondersteunde opdracht [DocumentDB SDK's](documentdb-sdk-dotnet.md).</span><span class="sxs-lookup"><span data-stu-id="c4372-114">You can issue SQL queries to any container using the REST API or one of the supported [DocumentDB SDKs](documentdb-sdk-dotnet.md).</span></span>

<span data-ttu-id="c4372-115">Een kort overzicht van het partitioneren: definieert u een partitiesleutel zoals 'plaats', waarmee wordt bepaald hoe gegevens zijn verdeeld over fysieke partities.</span><span class="sxs-lookup"><span data-stu-id="c4372-115">A brief overview of partitioning: you define a partition key like "city", which determines how data is split across physical partitions.</span></span> <span data-ttu-id="c4372-116">Gegevens die behoren tot een enkele partitie-sleutel (bijvoorbeeld 'city' == "Seattle") zijn opgeslagen in een fysieke partitie, maar één fysieke partitie heeft doorgaans meerdere partitiesleutels.</span><span class="sxs-lookup"><span data-stu-id="c4372-116">Data belonging to a single partition key (for example, "city" == "Seattle") is stored within a physical partition, but typically a single physical partition has multiple partition keys.</span></span> <span data-ttu-id="c4372-117">Wanneer een partitie zijn opslaggrootte bereikt, de service naadloos de partitie worden gesplitst in twee nieuwe partities en de partitiesleutel gelijkmatig wordt verdeeld over deze partities.</span><span class="sxs-lookup"><span data-stu-id="c4372-117">When a partition reaches its storage size, the service seamlessly splits the partition into two new partitions, and divides the partition key evenly across these partitions.</span></span> <span data-ttu-id="c4372-118">Aangezien partities tijdelijke zijn, gebruiken de API's een abstractie van een 'partitiesleutelbereik', waarmee de bereiken van de belangrijkste hashes partitie.</span><span class="sxs-lookup"><span data-stu-id="c4372-118">Since partitions are transient, the APIs use an abstraction of a "partition key range", which denotes the ranges of partition key hashes.</span></span> 

<span data-ttu-id="c4372-119">Wanneer u een query voor Azure Cosmos DB uitgeeft, voert de SDK deze logische stappen:</span><span class="sxs-lookup"><span data-stu-id="c4372-119">When you issue a query to Azure Cosmos DB, the SDK performs these logical steps:</span></span>

* <span data-ttu-id="c4372-120">Parseren van de SQL-query om te bepalen van het queryplan kan worden uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="c4372-120">Parse the SQL query to determine the query execution plan.</span></span> 
* <span data-ttu-id="c4372-121">Als de query een filter voor de partitiesleutel bevat, zoals `SELECT * FROM c WHERE c.city = "Seattle"`, wordt deze doorgestuurd naar één partitie.</span><span class="sxs-lookup"><span data-stu-id="c4372-121">If the query includes a filter against the partition key, like `SELECT * FROM c WHERE c.city = "Seattle"`, it is routed to a single partition.</span></span> <span data-ttu-id="c4372-122">Als de query heeft geen een filter voor de partitiesleutel en vervolgens deze wordt uitgevoerd in alle partities en de resultaten worden samengevoegd clientzijde.</span><span class="sxs-lookup"><span data-stu-id="c4372-122">If the query does not have a filter on partition key, then it is executed in all partitions, and results are merged client side.</span></span>
* <span data-ttu-id="c4372-123">De query is uitgevoerd binnen elke partitie in de reeks of parallel, op basis van de clientconfiguratie.</span><span class="sxs-lookup"><span data-stu-id="c4372-123">The query is executed within each partition in series or parallel, based on client configuration.</span></span> <span data-ttu-id="c4372-124">Binnen elke partitie kan in de query maken een of meer retouren afhankelijk van de complexiteit query paginagrootte geconfigureerd en ingerichte doorvoer van de verzameling.</span><span class="sxs-lookup"><span data-stu-id="c4372-124">Within each partition, the query might make one or more round trips depending on the query complexity, configured page size, and provisioned throughput of the collection.</span></span> <span data-ttu-id="c4372-125">Elke uitvoering retourneert het aantal [aanvraageenheden](request-units.md) verbruikt door uitvoering van de query, en desgewenst Uitvoeringsstatistieken query.</span><span class="sxs-lookup"><span data-stu-id="c4372-125">Each execution returns the number of [request units](request-units.md) consumed by query execution, and optionally, query execution statistics.</span></span> 
* <span data-ttu-id="c4372-126">De SDK voert een samenvatting van de queryresultaten meerdere partities.</span><span class="sxs-lookup"><span data-stu-id="c4372-126">The SDK performs a summarization of the query results across partitions.</span></span> <span data-ttu-id="c4372-127">Bijvoorbeeld als de query een ORDER BY meerdere partities moet, zijn vervolgens resultaten uit afzonderlijke partities voor het retourneren van resultaten in een globaal gesorteerde volgorde gesorteerd samenvoegen.</span><span class="sxs-lookup"><span data-stu-id="c4372-127">For example, if the query involves an ORDER BY across partitions, then results from individual partitions are merge-sorted to return results in globally sorted order.</span></span> <span data-ttu-id="c4372-128">Als de query een aggregatie zoals is `COUNT`, het aantal uit afzonderlijke partities voor het produceren van het totale aantal worden opgeteld.</span><span class="sxs-lookup"><span data-stu-id="c4372-128">If the query is an aggregation like `COUNT`, the counts from individual partitions are summed to produce the overall count.</span></span>

<span data-ttu-id="c4372-129">De SDK's bieden verschillende opties voor het uitvoeren van de query.</span><span class="sxs-lookup"><span data-stu-id="c4372-129">The SDKs provide various options for query execution.</span></span> <span data-ttu-id="c4372-130">Bijvoorbeeld in .NET deze opties zijn beschikbaar in de `FeedOptions` klasse.</span><span class="sxs-lookup"><span data-stu-id="c4372-130">For example, in .NET these options are available in the `FeedOptions` class.</span></span> <span data-ttu-id="c4372-131">De volgende tabel beschrijft deze opties en hoe ze invloed hebben op uitvoeringstijd van de query.</span><span class="sxs-lookup"><span data-stu-id="c4372-131">The following table describes these options and how they impact query execution time.</span></span> 

| <span data-ttu-id="c4372-132">Optie</span><span class="sxs-lookup"><span data-stu-id="c4372-132">Option</span></span> | <span data-ttu-id="c4372-133">Beschrijving</span><span class="sxs-lookup"><span data-stu-id="c4372-133">Description</span></span> |
| ------ | ----------- |
| `EnableCrossPartitionQuery` | <span data-ttu-id="c4372-134">Moet worden ingesteld op true voor een query die moet worden uitgevoerd op meer dan één partitie.</span><span class="sxs-lookup"><span data-stu-id="c4372-134">Must be set to true for any query that requires to be executed across more than one partition.</span></span> <span data-ttu-id="c4372-135">Dit is een expliciete vlag zodat u deze kunt u weloverwogen prestatie-en nadelen tijdens de ontwikkeling.</span><span class="sxs-lookup"><span data-stu-id="c4372-135">This is an explicit flag to enable you to make conscious performance tradeoffs during development time.</span></span> |
| `EnableScanInQuery` | <span data-ttu-id="c4372-136">Moet worden ingesteld op true als u ervoor hebt gekozen buiten het indexeren, maar de query toch uitvoeren via een scan.</span><span class="sxs-lookup"><span data-stu-id="c4372-136">Must be set to true if you have opted out of indexing, but want to run the query via a scan anyway.</span></span> <span data-ttu-id="c4372-137">Alleen is van toepassing als indexering voor de aangevraagde filterpad uitgeschakeld.</span><span class="sxs-lookup"><span data-stu-id="c4372-137">Only applicable if indexing for the requested filter path is disabled.</span></span> | 
| `MaxItemCount` | <span data-ttu-id="c4372-138">Het maximum aantal items per round trip terugkeren naar de server.</span><span class="sxs-lookup"><span data-stu-id="c4372-138">The maximum number of items to return per round trip to the server.</span></span> <span data-ttu-id="c4372-139">Door de instelling op-1 kunt u de server die het aantal items beheren.</span><span class="sxs-lookup"><span data-stu-id="c4372-139">By setting to -1, you can let the server manage the number of items.</span></span> <span data-ttu-id="c4372-140">Of u kunt deze waarde voor het ophalen van een klein aantal items per round trip verlagen.</span><span class="sxs-lookup"><span data-stu-id="c4372-140">Or, you can lower this value to retrieve only a small number of items per round trip.</span></span> 
| `MaxBufferedItemCount` | <span data-ttu-id="c4372-141">Dit is een optie voor de clientzijde, en gebruikt voor het beperken van het geheugenverbruik bij het uitvoeren van cross-partitie ORDER BY.</span><span class="sxs-lookup"><span data-stu-id="c4372-141">This is a client-side option, and used to limit the memory consumption when performing cross-partition ORDER BY.</span></span> <span data-ttu-id="c4372-142">Een hogere waarde vermindert de latentie van cross-partitie sorteren.</span><span class="sxs-lookup"><span data-stu-id="c4372-142">A higher value helps reduce the latency of cross-partition sorting.</span></span> |
| `MaxDegreeOfParallelism` | <span data-ttu-id="c4372-143">Opgehaald of ingesteld van het aantal gelijktijdige bewerkingen clientzijde tijdens parallelle queryuitvoering in de Azure DocumentDB-database-service wordt uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="c4372-143">Gets or sets the number of concurrent operations run client side during parallel query execution in the Azure DocumentDB database service.</span></span> <span data-ttu-id="c4372-144">Een positief eigenschapswaarde beperkt het aantal gelijktijdige bewerkingen op de waarde ingesteld.</span><span class="sxs-lookup"><span data-stu-id="c4372-144">A positive property value limits the number of concurrent operations to the set value.</span></span> <span data-ttu-id="c4372-145">Als deze is ingesteld op minder dan 0, besluit het systeem automatisch het aantal gelijktijdige bewerkingen om uit te voeren.</span><span class="sxs-lookup"><span data-stu-id="c4372-145">If it is set to less than 0, the system automatically decides the number of concurrent operations to run.</span></span> |
| `PopulateQueryMetrics` | <span data-ttu-id="c4372-146">Hiermee gedetailleerde logboekregistratie van statistieken voor de tijd die is doorgebracht in verschillende fasen van de uitvoering van de query zoals compileertijd en index Lustijd document laden tijd.</span><span class="sxs-lookup"><span data-stu-id="c4372-146">Enables detailed logging of statistics of time spent in various phases of query execution like compilation time, index loop time, and document load time.</span></span> <span data-ttu-id="c4372-147">U kunt uitvoer van de query statistieken delen met Azure-ondersteuning voor het vaststellen van prestatieproblemen met de query.</span><span class="sxs-lookup"><span data-stu-id="c4372-147">You can share output from query statistics with Azure Support to diagnose query performance issues.</span></span> |
| `RequestContinuation` | <span data-ttu-id="c4372-148">U kunt de queryuitvoering hervatten door door te geven in het ondoorzichtige vervolgtoken geretourneerd door een query.</span><span class="sxs-lookup"><span data-stu-id="c4372-148">You can resume query execution by passing in the opaque continuation token returned by any query.</span></span> <span data-ttu-id="c4372-149">Het vervolgtoken ingekapseld alle staat is vereist voor uitvoering van de query.</span><span class="sxs-lookup"><span data-stu-id="c4372-149">The continuation token encapsulates all state required for query execution.</span></span> |
| `ResponseContinuationTokenLimitInKb` | <span data-ttu-id="c4372-150">U kunt de maximale grootte van het vervolgtoken geretourneerd door de server kunt beperken.</span><span class="sxs-lookup"><span data-stu-id="c4372-150">You can limit the maximum size of the continuation token returned by the server.</span></span> <span data-ttu-id="c4372-151">Mogelijk moet u dit instellen als uw toepassingshost limieten op antwoord header-grootte.</span><span class="sxs-lookup"><span data-stu-id="c4372-151">You might need to set this if your application host has limits on response header size.</span></span> <span data-ttu-id="c4372-152">In te stellen, kan de totale duur en RUs gebruikt voor de query verhogen.</span><span class="sxs-lookup"><span data-stu-id="c4372-152">Setting this may increase the overall duration and RUs consumed for the query.</span></span>  |

<span data-ttu-id="c4372-153">Bijvoorbeeld, u gaat nu een voorbeeldquery op partitiesleutel is aangevraagd op een verzameling met `/city` als de partitie sleutel en ingericht met 100.000 RU/s doorvoer.</span><span class="sxs-lookup"><span data-stu-id="c4372-153">For example, let's take an example query on partition key requested on a collection with `/city` as the partition key and provisioned with 100,000 RU/s of throughput.</span></span> <span data-ttu-id="c4372-154">U deze query met aanvragen `CreateDocumentQuery<T>` in .NET als volgt:</span><span class="sxs-lookup"><span data-stu-id="c4372-154">You request this query using `CreateDocumentQuery<T>` in .NET like the following:</span></span>

```cs
IDocumentQuery<dynamic> query = client.CreateDocumentQuery(
    UriFactory.CreateDocumentCollectionUri(DatabaseName, CollectionName), 
    "SELECT * FROM c WHERE c.city = 'Seattle'", 
    new FeedOptions 
    { 
        PopulateQueryMetrics = true, 
        MaxItemCount = -1, 
        MaxDegreeOfParallelism = -1, 
        EnableCrossPartitionQuery = true 
    }).AsDocumentQuery();

FeedResponse<dynamic> result = await query.ExecuteNextAsync();
```

<span data-ttu-id="c4372-155">De SDK-codefragment hierboven, overeenkomt met de volgende REST-API-aanvraag:</span><span class="sxs-lookup"><span data-stu-id="c4372-155">The SDK snippet shown above, corresponds to the following REST API request:</span></span>

```
POST https://arramacquerymetrics-westus.documents.azure.com/dbs/db/colls/sample/docs HTTP/1.1
x-ms-continuation: 
x-ms-documentdb-isquery: True
x-ms-max-item-count: -1
x-ms-documentdb-query-enablecrosspartition: True
x-ms-documentdb-query-parallelizecrosspartitionquery: True
x-ms-documentdb-query-iscontinuationexpected: True
x-ms-documentdb-populatequerymetrics: True
x-ms-date: Tue, 27 Jun 2017 21:52:18 GMT
authorization: type%3dmaster%26ver%3d1.0%26sig%3drp1Hi83Y8aVV5V6LzZ6xhtQVXRAMz0WNMnUuvriUv%2b4%3d
x-ms-session-token: 7:8,6:2008,5:8,4:2008,3:8,2:2008,1:8,0:8,9:8,8:4008
Cache-Control: no-cache
x-ms-consistency-level: Session
User-Agent: documentdb-dotnet-sdk/1.14.1 Host/32-bit MicrosoftWindowsNT/6.2.9200.0
x-ms-version: 2017-02-22
Accept: application/json
Content-Type: application/query+json
Host: arramacquerymetrics-westus.documents.azure.com
Content-Length: 52
Expect: 100-continue

{"query":"SELECT * FROM c WHERE c.city = 'Seattle'"}
```

<span data-ttu-id="c4372-156">Elke pagina van de uitvoering van query komt overeen met een REST-API `POST` met de `Accept: application/query+json` header en de SQL-query in de hoofdtekst.</span><span class="sxs-lookup"><span data-stu-id="c4372-156">Each query execution page corresponds to a REST API `POST` with the `Accept: application/query+json` header, and the SQL query in the body.</span></span> <span data-ttu-id="c4372-157">Elke query kunnen een of meer retouren naar de server met de `x-ms-continuation` token gekopieerd tussen de client en server uitvoering te hervatten.</span><span class="sxs-lookup"><span data-stu-id="c4372-157">Each query makes one or more round trips to the server with the `x-ms-continuation` token echoed between the client and server to resume execution.</span></span> <span data-ttu-id="c4372-158">De configuratieopties in FeedOptions worden doorgegeven aan de server in de vorm van de aanvraagheaders.</span><span class="sxs-lookup"><span data-stu-id="c4372-158">The configuration options in FeedOptions are passed to the server in the form of request headers.</span></span> <span data-ttu-id="c4372-159">Bijvoorbeeld: `MaxItemCount` komt overeen met `x-ms-max-item-count`.</span><span class="sxs-lookup"><span data-stu-id="c4372-159">For example, `MaxItemCount` corresponds to `x-ms-max-item-count`.</span></span> 

<span data-ttu-id="c4372-160">De aanvraag de volgende (afgekapt voor leesbaarheid) antwoord geretourneerd:</span><span class="sxs-lookup"><span data-stu-id="c4372-160">The request returns the following (truncated for readability) response:</span></span>

```
HTTP/1.1 200 Ok
Cache-Control: no-store, no-cache
Pragma: no-cache
Transfer-Encoding: chunked
Content-Type: application/json
Server: Microsoft-HTTPAPI/2.0
Strict-Transport-Security: max-age=31536000
x-ms-last-state-change-utc: Tue, 27 Jun 2017 21:01:57.561 GMT
x-ms-resource-quota: documentSize=10240;documentsSize=10485760;documentsCount=-1;collectionSize=10485760;
x-ms-resource-usage: documentSize=1;documentsSize=884;documentsCount=2000;collectionSize=1408;
x-ms-item-count: 2000
x-ms-schemaversion: 1.3
x-ms-alt-content-path: dbs/db/colls/sample
x-ms-content-path: +9kEANVq0wA=
x-ms-xp-role: 1
x-ms-documentdb-query-metrics: totalExecutionTimeInMs=33.67;queryCompileTimeInMs=0.06;queryLogicalPlanBuildTimeInMs=0.02;queryPhysicalPlanBuildTimeInMs=0.10;queryOptimizationTimeInMs=0.00;VMExecutionTimeInMs=32.56;indexLookupTimeInMs=0.36;documentLoadTimeInMs=9.58;systemFunctionExecuteTimeInMs=0.00;userFunctionExecuteTimeInMs=0.00;retrievedDocumentCount=2000;retrievedDocumentSize=1125600;outputDocumentCount=2000;writeOutputTimeInMs=18.10;indexUtilizationRatio=1.00
x-ms-request-charge: 604.42
x-ms-serviceversion: version=1.14.34.4
x-ms-activity-id: 0df8b5f6-83b9-4493-abda-cce6d0f91486
x-ms-session-token: 2:2008
x-ms-gatewayversion: version=1.14.33.2
Date: Tue, 27 Jun 2017 21:59:49 GMT
```

<span data-ttu-id="c4372-161">De belangrijkste antwoordheaders geretourneerd van de query omvatten het volgende:</span><span class="sxs-lookup"><span data-stu-id="c4372-161">The key response headers returned from the query include the following:</span></span>

| <span data-ttu-id="c4372-162">Optie</span><span class="sxs-lookup"><span data-stu-id="c4372-162">Option</span></span> | <span data-ttu-id="c4372-163">Beschrijving</span><span class="sxs-lookup"><span data-stu-id="c4372-163">Description</span></span> |
| ------ | ----------- |
| `x-ms-item-count` | <span data-ttu-id="c4372-164">Het aantal items in het antwoord geretourneerd.</span><span class="sxs-lookup"><span data-stu-id="c4372-164">The number of items returned in the response.</span></span> <span data-ttu-id="c4372-165">Dit is afhankelijk van de opgegeven `x-ms-max-item-count`, het aantal items dat binnen de maximale reactiegrootte nettolading, de ingerichte doorvoer en de uitvoeringstijd van de query past.</span><span class="sxs-lookup"><span data-stu-id="c4372-165">This is dependent on the supplied `x-ms-max-item-count`, the number of items that can be fit within the maximum response payload size, the provisioned throughput, and query execution time.</span></span> |  
| `x-ms-continuation:` | <span data-ttu-id="c4372-166">Het vervolgtoken uitvoering van de query te hervatten als extra resultaten beschikbaar zijn.</span><span class="sxs-lookup"><span data-stu-id="c4372-166">The continuation token to resume execution of the query, if additional results are available.</span></span> | 
| `x-ms-documentdb-query-metrics` | <span data-ttu-id="c4372-167">De statistieken van de query voor de uitvoering.</span><span class="sxs-lookup"><span data-stu-id="c4372-167">The query statistics for the execution.</span></span> <span data-ttu-id="c4372-168">Dit is een tekenreeks met scheidingstekens met statistieken van de tijd besteed aan de verschillende fasen van de uitvoering van de query.</span><span class="sxs-lookup"><span data-stu-id="c4372-168">This is a delimited string containing statistics of time spent in the various phases of query execution.</span></span> <span data-ttu-id="c4372-169">Geretourneerde als `x-ms-documentdb-populatequerymetrics` is ingesteld op `True`.</span><span class="sxs-lookup"><span data-stu-id="c4372-169">Returned if `x-ms-documentdb-populatequerymetrics` is set to `True`.</span></span> | 
| `x-ms-request-charge` | <span data-ttu-id="c4372-170">Het aantal [aanvraageenheden](request-units.md) verbruikt door de query.</span><span class="sxs-lookup"><span data-stu-id="c4372-170">The number of [request units](request-units.md) consumed by the query.</span></span> | 

<span data-ttu-id="c4372-171">Zie voor meer informatie over de REST-API-headers voor aanvraag en de opties [opvragen van resources met behulp van de REST-API van DocumentDB](https://docs.microsoft.com/rest/api/documentdb/querying-documentdb-resources-using-the-rest-api).</span><span class="sxs-lookup"><span data-stu-id="c4372-171">For details on the REST API request headers and options, see [Querying resources using the DocumentDB REST API](https://docs.microsoft.com/rest/api/documentdb/querying-documentdb-resources-using-the-rest-api).</span></span>

## <a name="best-practices-for-query-performance"></a><span data-ttu-id="c4372-172">Aanbevolen procedures voor prestaties van query 's</span><span class="sxs-lookup"><span data-stu-id="c4372-172">Best practices for query performance</span></span>
<span data-ttu-id="c4372-173">Hieronder vindt u de meest voorkomende factoren die van invloed op prestaties van Azure DB die Cosmos-query's.</span><span class="sxs-lookup"><span data-stu-id="c4372-173">The following are the most common factors that impact Azure Cosmos DB query performance.</span></span> <span data-ttu-id="c4372-174">We verdiepen in elk van deze onderwerpen in dit artikel.</span><span class="sxs-lookup"><span data-stu-id="c4372-174">We dig deeper into each of these topics in this article.</span></span>

| <span data-ttu-id="c4372-175">Factor</span><span class="sxs-lookup"><span data-stu-id="c4372-175">Factor</span></span> | <span data-ttu-id="c4372-176">Tip</span><span class="sxs-lookup"><span data-stu-id="c4372-176">Tip</span></span> | 
| ------ | -----| 
| <span data-ttu-id="c4372-177">Ingerichte doorvoer</span><span class="sxs-lookup"><span data-stu-id="c4372-177">Provisioned throughput</span></span> | <span data-ttu-id="c4372-178">Meet RU per query en zorg ervoor dat u de vereiste ingerichte doorvoer voor uw query's.</span><span class="sxs-lookup"><span data-stu-id="c4372-178">Measure RU per query, and ensure that you have the required provisioned throughput for your queries.</span></span> | 
| <span data-ttu-id="c4372-179">Partitionering en partitiesleutels</span><span class="sxs-lookup"><span data-stu-id="c4372-179">Partitioning and partition keys</span></span> | <span data-ttu-id="c4372-180">Voorkeur voor query's met de waarde voor de partitiesleutel in de filtercomponent voor lage latentie.</span><span class="sxs-lookup"><span data-stu-id="c4372-180">Favor queries with the partition key value in the filter clause for low latency.</span></span> |
| <span data-ttu-id="c4372-181">SDK en query-opties</span><span class="sxs-lookup"><span data-stu-id="c4372-181">SDK and query options</span></span> | <span data-ttu-id="c4372-182">Volg de aanbevolen procedures van de SDK zoals directe verbinding en clientzijde uitvoering queryopties afstemmen.</span><span class="sxs-lookup"><span data-stu-id="c4372-182">Follow SDK best practices like direct connectivity, and tune client-side query execution options.</span></span> |
| <span data-ttu-id="c4372-183">Netwerklatentie</span><span class="sxs-lookup"><span data-stu-id="c4372-183">Network latency</span></span> | <span data-ttu-id="c4372-184">Account voor netwerk overhead in meting en multihoming API's gebruiken om te lezen uit de dichtstbijzijnde regio.</span><span class="sxs-lookup"><span data-stu-id="c4372-184">Account for network overhead in measurement, and use multi-homing APIs to read from the nearest region.</span></span> |
| <span data-ttu-id="c4372-185">Indexeringsbeleid</span><span class="sxs-lookup"><span data-stu-id="c4372-185">Indexing Policy</span></span> | <span data-ttu-id="c4372-186">Zorg ervoor dat u de vereiste paden/indexeringsbeleid voor de query.</span><span class="sxs-lookup"><span data-stu-id="c4372-186">Ensure that you have the required indexing paths/policy for the query.</span></span> |
| <span data-ttu-id="c4372-187">Query-uitvoering metrische gegevens</span><span class="sxs-lookup"><span data-stu-id="c4372-187">Query execution metrics</span></span> | <span data-ttu-id="c4372-188">Analyseer de query-uitvoering metrische gegevens om te identificeren mogelijke regeneraties van query's en vormen.</span><span class="sxs-lookup"><span data-stu-id="c4372-188">Analyze the query execution metrics to identify potential rewrites of query and data shapes.</span></span>  |

### <a name="provisioned-throughput"></a><span data-ttu-id="c4372-189">Ingerichte doorvoer</span><span class="sxs-lookup"><span data-stu-id="c4372-189">Provisioned throughput</span></span>
<span data-ttu-id="c4372-190">In de Cosmos-DB maakt u containers voor gegevens, elk met gereserveerde doorvoer, uitgedrukt in de aanvraag-eenheden (RU) per de seconde.</span><span class="sxs-lookup"><span data-stu-id="c4372-190">In Cosmos DB, you create containers of data, each with reserved throughput expressed in request units (RU) per-second.</span></span> <span data-ttu-id="c4372-191">Het lezen van een document van 1 KB is 1 RU en elke bewerking (met inbegrip van query's) op een vast aantal RUs op basis van de complexiteit is genormaliseerd.</span><span class="sxs-lookup"><span data-stu-id="c4372-191">A read of a 1-KB document is 1 RU, and every operation (including queries) is normalized to a fixed number of RUs based on its complexity.</span></span> <span data-ttu-id="c4372-192">Bijvoorbeeld, als er 1000 RU/s ingericht voor de container en u hebt een query zoals `SELECT * FROM c WHERE c.city = 'Seattle'` die 5 RUs verbruikt en vervolgens kunt u uitvoeren (1000 RU/s) / (5 RU/query) = 200 query/s dergelijke query's per seconde.</span><span class="sxs-lookup"><span data-stu-id="c4372-192">For example, if you have 1000 RU/s provisioned for your container, and you have a query like `SELECT * FROM c WHERE c.city = 'Seattle'` that consumes 5 RUs, then you can perform (1000 RU/s) / (5 RU/query) = 200 query/s such queries per second.</span></span> 

<span data-ttu-id="c4372-193">Als u meer dan 200 query's per seconde indient, start de service binnenkomende aanvragen frequentiebeperkende hierboven 200/s.</span><span class="sxs-lookup"><span data-stu-id="c4372-193">If you submit more than 200 queries/sec, the service starts rate-limiting incoming requests above 200/s.</span></span> <span data-ttu-id="c4372-194">In dit geval de SDK's automatisch verwerkt door het uitvoeren van een backoff/nieuwe poging, dus u wellicht opgevallen dat een hogere latentie voor deze query's.</span><span class="sxs-lookup"><span data-stu-id="c4372-194">The SDKs automatically handle this case by performing a backoff/retry, therefore you might notice a higher latency for these queries.</span></span> <span data-ttu-id="c4372-195">De ingerichte doorvoer voor de vereiste waarde verhogen verbetert uw Querylatentie en de doorvoer.</span><span class="sxs-lookup"><span data-stu-id="c4372-195">Increasing the provisioned throughput to the required value improves your query latency and throughput.</span></span> 

<span data-ttu-id="c4372-196">Zie voor meer informatie over aanvraageenheden, [Aanvraageenheden](request-units.md).</span><span class="sxs-lookup"><span data-stu-id="c4372-196">To learn more about request units, see [Request units](request-units.md).</span></span>

### <a name="partitioning-and-partition-keys"></a><span data-ttu-id="c4372-197">Partitionering en partitiesleutels</span><span class="sxs-lookup"><span data-stu-id="c4372-197">Partitioning and partition keys</span></span>
<span data-ttu-id="c4372-198">Met Azure Cosmos DB doorgaans uitvoeren query's in de volgende volgorde van de snelste/meest efficiënte naar tragere/minder efficiënt.</span><span class="sxs-lookup"><span data-stu-id="c4372-198">With Azure Cosmos DB, typically queries perform in the following order from fastest/most efficient to slower/less efficient.</span></span> 

* <span data-ttu-id="c4372-199">Op een enkele partitie en item sleutel ophalen</span><span class="sxs-lookup"><span data-stu-id="c4372-199">GET on a single partition key and item key</span></span>
* <span data-ttu-id="c4372-200">Query's uitvoeren met een filter-component op een enkele partitiesleutel</span><span class="sxs-lookup"><span data-stu-id="c4372-200">Query with a filter clause on a single partition key</span></span>
* <span data-ttu-id="c4372-201">Query uitvoeren zonder dat een gelijkheid of bereik filter-component op een eigenschap</span><span class="sxs-lookup"><span data-stu-id="c4372-201">Query without an equality or range filter clause on any property</span></span>
* <span data-ttu-id="c4372-202">Een query uitvoeren zonder filters</span><span class="sxs-lookup"><span data-stu-id="c4372-202">Query without filters</span></span>

<span data-ttu-id="c4372-203">Query's die u moeten alle partities Raadpleeg moeten hogere latentie, en hogere RUs kunnen gebruiken.</span><span class="sxs-lookup"><span data-stu-id="c4372-203">Queries that need to consult all partitions need higher latency, and can consume higher RUs.</span></span> <span data-ttu-id="c4372-204">Aangezien elke partitie automatisch indexeren tegen alle eigenschappen heeft, kan de query worden geleverd efficiënt vanaf de index in dit geval.</span><span class="sxs-lookup"><span data-stu-id="c4372-204">Since each partition has automatic indexing against all properties, the query can be served efficiently from the index in this case.</span></span> <span data-ttu-id="c4372-205">U kunt query's die partities sneller omvatten met behulp van de opties voor parallelle uitvoering.</span><span class="sxs-lookup"><span data-stu-id="c4372-205">You can make queries that span partitions faster by using the parallelism options.</span></span>

<span data-ttu-id="c4372-206">Zie voor meer informatie over partitioneren en partitiesleutels, [partitioneren in Azure Cosmos DB](partition-data.md).</span><span class="sxs-lookup"><span data-stu-id="c4372-206">To learn more about partitioning and partition keys, see [Partitioning in Azure Cosmos DB](partition-data.md).</span></span>

### <a name="sdk-and-query-options"></a><span data-ttu-id="c4372-207">SDK en query-opties</span><span class="sxs-lookup"><span data-stu-id="c4372-207">SDK and query options</span></span>
<span data-ttu-id="c4372-208">Zie [Tips voor betere prestaties](performance-tips.md) en [prestatietests](performance-testing.md) voor het ophalen van de beste prestaties voor de clientzijde van Azure Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="c4372-208">See [Performance Tips](performance-tips.md) and [Performance testing](performance-testing.md) for how to get the best client-side performance from Azure Cosmos DB.</span></span> <span data-ttu-id="c4372-209">Dit omvat met de nieuwste SDK's, platform-specifieke netwerkconfiguraties als standaardaantal verbindingen, frequentie van garbagecollection, configureren en lightweight connectiviteitsopties zoals Direct/TCP.</span><span class="sxs-lookup"><span data-stu-id="c4372-209">This includes using the latest SDKs, configuring platform-specific configurations like default number of connections, frequency of garbage collection, and using lightweight connectivity options like Direct/TCP.</span></span> 


#### <a name="max-item-count"></a><span data-ttu-id="c4372-210">Aantal items max</span><span class="sxs-lookup"><span data-stu-id="c4372-210">Max Item Count</span></span>
<span data-ttu-id="c4372-211">Voor query's, de waarde van `MaxItemCount` kan een aanzienlijke invloed hebben op het moment dat de end-to-end-query.</span><span class="sxs-lookup"><span data-stu-id="c4372-211">For queries, the value of `MaxItemCount` can have a significant impact on end-to-end query time.</span></span> <span data-ttu-id="c4372-212">Elke retouren naar de server resulteert niet vaker dan het aantal items in `MaxItemCount` (standaard van 100 objecten).</span><span class="sxs-lookup"><span data-stu-id="c4372-212">Each round trip to the server will return no more than the number of items in `MaxItemCount` (Default of 100 items).</span></span> <span data-ttu-id="c4372-213">Als u dit op een hogere waarde (-1 is maximum- en aanbevolen) worden uw totale duur van de query verbeteren door het aantal retouren tussen server en client, met name voor query's met grote resultatensets te beperken.</span><span class="sxs-lookup"><span data-stu-id="c4372-213">Setting this to a higher value (-1 is maximum, and recommended) will improve your query duration overall by limiting the number of round trips between server and client, especially for queries with large result sets.</span></span>

```cs
IDocumentQuery<dynamic> query = client.CreateDocumentQuery(
    UriFactory.CreateDocumentCollectionUri(DatabaseName, CollectionName), 
    "SELECT * FROM c WHERE c.city = 'Seattle'", 
    new FeedOptions 
    { 
        MaxItemCount = -1, 
    }).AsDocumentQuery();
```

#### <a name="max-degree-of-parallelism"></a><span data-ttu-id="c4372-214">Maximale mate van parallelle uitvoering</span><span class="sxs-lookup"><span data-stu-id="c4372-214">Max Degree of Parallelism</span></span>
<span data-ttu-id="c4372-215">Stemmen voor query's, de `MaxDegreeOfParallelism` voor het identificeren van de aanbevolen configuraties voor uw toepassing, met name als u cross-partitie query's (zonder een filter op de partitie-sleutelwaarde) uitvoeren.</span><span class="sxs-lookup"><span data-stu-id="c4372-215">For queries, tune the `MaxDegreeOfParallelism` to identify the best configurations for your application, especially if you perform cross-partition queries (without a filter on the partition-key value).</span></span> <span data-ttu-id="c4372-216">`MaxDegreeOfParallelism`Hiermee bepaalt u het maximum aantal parallelle taken, dat wil zeggen, het maximum van partities parallel wordt bezocht.</span><span class="sxs-lookup"><span data-stu-id="c4372-216">`MaxDegreeOfParallelism`  controls the maximum number of parallel tasks, i.e., the maximum of partitions to be visited in parallel.</span></span> 

```cs
IDocumentQuery<dynamic> query = client.CreateDocumentQuery(
    UriFactory.CreateDocumentCollectionUri(DatabaseName, CollectionName), 
    "SELECT * FROM c WHERE c.city = 'Seattle'", 
    new FeedOptions 
    { 
        MaxDegreeOfParallelism = -1, 
        EnableCrossPartitionQuery = true 
    }).AsDocumentQuery();
```

<span data-ttu-id="c4372-217">Stel dat</span><span class="sxs-lookup"><span data-stu-id="c4372-217">Let’s assume that</span></span>
* <span data-ttu-id="c4372-218">D = standaard maximale aantal parallelle taken (= totaal aantal processor in de client-computer)</span><span class="sxs-lookup"><span data-stu-id="c4372-218">D = Default Maximum number of parallel tasks (= total number of processor in the client machine)</span></span>
* <span data-ttu-id="c4372-219">P = gebruiker opgegeven maximale aantal parallelle taken</span><span class="sxs-lookup"><span data-stu-id="c4372-219">P = User-specified maximum number of parallel tasks</span></span>
* <span data-ttu-id="c4372-220">N het aantal partities die behoeften voor het beantwoorden van een query wordt bezocht =</span><span class="sxs-lookup"><span data-stu-id="c4372-220">N = Number of partitions that needs  to be visited for answering a query</span></span>

<span data-ttu-id="c4372-221">Hieronder vindt u de implicaties van hoe de parallelle query's voor verschillende waarden van P. zou werken</span><span class="sxs-lookup"><span data-stu-id="c4372-221">Following are implications of how the parallel queries would behave for different values of P.</span></span>
* <span data-ttu-id="c4372-222">(P == 0) = > seriële modus</span><span class="sxs-lookup"><span data-stu-id="c4372-222">(P == 0) => Serial Mode</span></span>
* <span data-ttu-id="c4372-223">(P == 1) = > maximaal één taak</span><span class="sxs-lookup"><span data-stu-id="c4372-223">(P == 1) => Maximum of one task</span></span>
* <span data-ttu-id="c4372-224">(P > 1) = > parallelle taken Min (P, N)</span><span class="sxs-lookup"><span data-stu-id="c4372-224">(P > 1) => Min (P, N) parallel tasks</span></span> 
* <span data-ttu-id="c4372-225">(P < 1) = > parallelle taken Min (N, D)</span><span class="sxs-lookup"><span data-stu-id="c4372-225">(P < 1) => Min (N, D) parallel tasks</span></span>

<span data-ttu-id="c4372-226">Voor SDK-releaseopmerkingen en Zie voor meer informatie over geïmplementeerde klassen en methoden [DocumentDB SDK's](documentdb-sdk-dotnet.md)</span><span class="sxs-lookup"><span data-stu-id="c4372-226">For SDK release notes, and details on implemented classes and methods see [DocumentDB SDKs](documentdb-sdk-dotnet.md)</span></span>

### <a name="network-latency"></a><span data-ttu-id="c4372-227">Netwerklatentie</span><span class="sxs-lookup"><span data-stu-id="c4372-227">Network latency</span></span>
<span data-ttu-id="c4372-228">Zie [Azure Cosmos DB globale distributie](tutorial-global-distribution-documentdb.md) voor het instellen van de algemene distributie en verbinding maken met de dichtstbijzijnde regio.</span><span class="sxs-lookup"><span data-stu-id="c4372-228">See [Azure Cosmos DB global distribution](tutorial-global-distribution-documentdb.md) for how to set up global distribution, and connect to the closest region.</span></span> <span data-ttu-id="c4372-229">Netwerklatentie heeft een aanzienlijke invloed op prestaties van query's als u wilt meerdere retouren maken of een grote resultatenset van de query worden opgehaald.</span><span class="sxs-lookup"><span data-stu-id="c4372-229">Network latency has a significant impact on query performance when you need to make multiple round-trips or retrieve a large result set from the query.</span></span> 

<span data-ttu-id="c4372-230">De sectie over metrische gegevens query-uitvoering wordt uitgelegd hoe u de tijd van de server uitvoeren van query's niet ophalen ( `totalExecutionTimeInMs`), zodat u tijd besteed aan het uitvoeren van de query en -tijd besteed aan het netwerk onderweg kunt onderscheiden.</span><span class="sxs-lookup"><span data-stu-id="c4372-230">The section on query execution metrics explains how to retrieve the server execution time of queries ( `totalExecutionTimeInMs`), so that you can differentiate between time spent in query execution and time spent in network transit.</span></span>

### <a name="indexing-policy"></a><span data-ttu-id="c4372-231">Indexeringsbeleid</span><span class="sxs-lookup"><span data-stu-id="c4372-231">Indexing policy</span></span>
<span data-ttu-id="c4372-232">Zie [indexeringsbeleid configureren](indexing-policies.md) voor indexeren paden, soorten, en modi en invloed op uitvoering van de query.</span><span class="sxs-lookup"><span data-stu-id="c4372-232">See [Configuring indexing policy](indexing-policies.md) for indexing paths, kinds, and modes, and how they impact query execution.</span></span> <span data-ttu-id="c4372-233">Het indexeringsbeleid gebruikt standaard hash-indexering voor tekenreeksen, die geldt voor gelijkheid query's, maar niet voor query's bereik/order by-query's.</span><span class="sxs-lookup"><span data-stu-id="c4372-233">By default, the indexing policy uses Hash indexing for strings, which is effective for equality queries, but not for range queries/order by queries.</span></span> <span data-ttu-id="c4372-234">Als u een bereik query's nodig voor tekenreeksen, wordt u aangeraden het indextype bereik voor alle tekenreeksen geven.</span><span class="sxs-lookup"><span data-stu-id="c4372-234">If you need range queries for strings, we recommend specifying the Range index type for all strings.</span></span> 

## <a name="query-execution-metrics"></a><span data-ttu-id="c4372-235">Query-uitvoering metrische gegevens</span><span class="sxs-lookup"><span data-stu-id="c4372-235">Query execution metrics</span></span>
<span data-ttu-id="c4372-236">U kunt gedetailleerde metrische gegevens op de uitvoering van de query verkrijgen door door te geven in de optionele `x-ms-documentdb-populatequerymetrics` header (`FeedOptions.PopulateQueryMetrics` in de .NET SDK).</span><span class="sxs-lookup"><span data-stu-id="c4372-236">You can obtain detailed metrics on query execution by passing in the optional `x-ms-documentdb-populatequerymetrics` header (`FeedOptions.PopulateQueryMetrics` in the .NET SDK).</span></span> <span data-ttu-id="c4372-237">De waarde die in `x-ms-documentdb-query-metrics` heeft de volgende sleutel-waardeparen bedoeld voor geavanceerde probleemoplossing van de uitvoering van de query.</span><span class="sxs-lookup"><span data-stu-id="c4372-237">The value returned in `x-ms-documentdb-query-metrics` has the following key-value pairs meant for advanced troubleshooting of query execution.</span></span> 

```cs
IDocumentQuery<dynamic> query = client.CreateDocumentQuery(
    UriFactory.CreateDocumentCollectionUri(DatabaseName, CollectionName), 
    "SELECT * FROM c WHERE c.city = 'Seattle'", 
    new FeedOptions 
    { 
        PopulateQueryMetrics = true, 
    }).AsDocumentQuery();

FeedResponse<dynamic> result = await query.ExecuteNextAsync();

// Returns metrics by partition key range Id
IReadOnlyDictionary<string, QueryMetrics> metrics = result.QueryMetrics;

```

| <span data-ttu-id="c4372-238">Gegevens</span><span class="sxs-lookup"><span data-stu-id="c4372-238">Metric</span></span> | <span data-ttu-id="c4372-239">Eenheid</span><span class="sxs-lookup"><span data-stu-id="c4372-239">Unit</span></span> | <span data-ttu-id="c4372-240">Beschrijving</span><span class="sxs-lookup"><span data-stu-id="c4372-240">Description</span></span> | 
| ------ | -----| ----------- |
| `totalExecutionTimeInMs` | <span data-ttu-id="c4372-241">milliseconden</span><span class="sxs-lookup"><span data-stu-id="c4372-241">milliseconds</span></span> | <span data-ttu-id="c4372-242">Uitvoeringstijd van de query</span><span class="sxs-lookup"><span data-stu-id="c4372-242">Query execution time</span></span> | 
| `queryCompileTimeInMs` | <span data-ttu-id="c4372-243">milliseconden</span><span class="sxs-lookup"><span data-stu-id="c4372-243">milliseconds</span></span> | <span data-ttu-id="c4372-244">Query-compilatie</span><span class="sxs-lookup"><span data-stu-id="c4372-244">Query compile time</span></span>  | 
| `queryLogicalPlanBuildTimeInMs` | <span data-ttu-id="c4372-245">milliseconden</span><span class="sxs-lookup"><span data-stu-id="c4372-245">milliseconds</span></span> | <span data-ttu-id="c4372-246">Tijd voor het bouwen van logische queryplan</span><span class="sxs-lookup"><span data-stu-id="c4372-246">Time to build logical query plan</span></span> | 
| `queryPhysicalPlanBuildTimeInMs` | <span data-ttu-id="c4372-247">milliseconden</span><span class="sxs-lookup"><span data-stu-id="c4372-247">milliseconds</span></span> | <span data-ttu-id="c4372-248">Tijd voor het bouwen van fysieke queryplan</span><span class="sxs-lookup"><span data-stu-id="c4372-248">Time to build physical query plan</span></span> | 
| `queryOptimizationTimeInMs` | <span data-ttu-id="c4372-249">milliseconden</span><span class="sxs-lookup"><span data-stu-id="c4372-249">milliseconds</span></span> | <span data-ttu-id="c4372-250">Tijd besteed aan de query te optimaliseren</span><span class="sxs-lookup"><span data-stu-id="c4372-250">Time spent in optimizing query</span></span> | 
| `VMExecutionTimeInMs` | <span data-ttu-id="c4372-251">milliseconden</span><span class="sxs-lookup"><span data-stu-id="c4372-251">milliseconds</span></span> | <span data-ttu-id="c4372-252">Tijd besteed aan de query-runtime</span><span class="sxs-lookup"><span data-stu-id="c4372-252">Time spent in query runtime</span></span> | 
| `indexLookupTimeInMs` | <span data-ttu-id="c4372-253">milliseconden</span><span class="sxs-lookup"><span data-stu-id="c4372-253">milliseconds</span></span> | <span data-ttu-id="c4372-254">Tijd besteed aan fysieke index laag</span><span class="sxs-lookup"><span data-stu-id="c4372-254">Time spent in physical index layer</span></span> | 
| `documentLoadTimeInMs` | <span data-ttu-id="c4372-255">milliseconden</span><span class="sxs-lookup"><span data-stu-id="c4372-255">milliseconds</span></span> | <span data-ttu-id="c4372-256">Tijd besteed aan het laden van documenten</span><span class="sxs-lookup"><span data-stu-id="c4372-256">Time spent in loading documents</span></span>  | 
| `systemFunctionExecuteTimeInMs` | <span data-ttu-id="c4372-257">milliseconden</span><span class="sxs-lookup"><span data-stu-id="c4372-257">milliseconds</span></span> | <span data-ttu-id="c4372-258">Totale tijd besteed aan het uitvoerende system (ingebouwde) functies in milliseconden</span><span class="sxs-lookup"><span data-stu-id="c4372-258">Total time spent executing system (built-in) functions in milliseconds</span></span>  | 
| `userFunctionExecuteTimeInMs` | <span data-ttu-id="c4372-259">milliseconden</span><span class="sxs-lookup"><span data-stu-id="c4372-259">milliseconds</span></span> | <span data-ttu-id="c4372-260">Totale tijd besteed worden uitgevoerd door de gebruiker gedefinieerde functies in milliseconden</span><span class="sxs-lookup"><span data-stu-id="c4372-260">Total time spent executing user-defined functions in milliseconds</span></span> | 
| `retrievedDocumentCount` | <span data-ttu-id="c4372-261">milliseconden</span><span class="sxs-lookup"><span data-stu-id="c4372-261">milliseconds</span></span> | <span data-ttu-id="c4372-262">Totaal aantal opgehaalde documenten</span><span class="sxs-lookup"><span data-stu-id="c4372-262">Total number of retrieved documents</span></span>  | 
| `retrievedDocumentSize` | <span data-ttu-id="c4372-263">Bytes</span><span class="sxs-lookup"><span data-stu-id="c4372-263">bytes</span></span> | <span data-ttu-id="c4372-264">Totale grootte van de opgehaalde documenten in bytes</span><span class="sxs-lookup"><span data-stu-id="c4372-264">Total size of retrieved documents in bytes</span></span>  | 
| `outputDocumentCount` | <span data-ttu-id="c4372-265">Aantal</span><span class="sxs-lookup"><span data-stu-id="c4372-265">count</span></span> | <span data-ttu-id="c4372-266">Het aantal uitvoerdocumenten</span><span class="sxs-lookup"><span data-stu-id="c4372-266">Number of output documents</span></span> | 
| `writeOutputTimeInMs` | <span data-ttu-id="c4372-267">milliseconden</span><span class="sxs-lookup"><span data-stu-id="c4372-267">milliseconds</span></span> | <span data-ttu-id="c4372-268">Uitvoeringstijd van de query in milliseconden</span><span class="sxs-lookup"><span data-stu-id="c4372-268">Query execution time in milliseconds</span></span> | 
| `indexUtilizationRatio` | <span data-ttu-id="c4372-269">verhouding (< = 1)</span><span class="sxs-lookup"><span data-stu-id="c4372-269">ratio (<=1)</span></span> | <span data-ttu-id="c4372-270">Verhouding tussen aantal documenten dat overeenkomt met het filter aan het aantal documenten die worden geladen</span><span class="sxs-lookup"><span data-stu-id="c4372-270">Ratio of number of documents matched by the filter to the number of documents loaded</span></span>  | 

<span data-ttu-id="c4372-271">De client-SDK's kunnen meerdere querybewerkingen voor het uitvoeren van de query binnen elke partitie intern stellen.</span><span class="sxs-lookup"><span data-stu-id="c4372-271">The client SDKs may internally make multiple query operations to serve the query within each partition.</span></span> <span data-ttu-id="c4372-272">Maakt de client meer dan één aanroep per partitie als de totale resultaten overschrijdt `x-ms-max-item-count`, als de query de ingerichte doorvoer voor de partitie overschrijdt als de nettolading van de query de maximale grootte per pagina bereikt of als de query het systeem die zijn toegewezen bereikt time-outlimiet.</span><span class="sxs-lookup"><span data-stu-id="c4372-272">The client makes more than one call per-partition if the total results exceed `x-ms-max-item-count`, if the query exceeds the provisioned throughput for the partition, or if the query payload reaches the maximum size per page, or if the query reaches the system allocated timeout limit.</span></span> <span data-ttu-id="c4372-273">Elke gedeeltelijke queryuitvoering retourneert een `x-ms-documentdb-query-metrics` voor die pagina.</span><span class="sxs-lookup"><span data-stu-id="c4372-273">Each partial query execution returns a `x-ms-documentdb-query-metrics` for that page.</span></span> 

<span data-ttu-id="c4372-274">Hier volgen enkele voorbeeldquery's en het interpreteren van de metrische gegevens die door uitvoering van de query zijn geretourneerd:</span><span class="sxs-lookup"><span data-stu-id="c4372-274">Here are some sample queries, and how to interpret some of the metrics returned from query execution:</span></span> 

| <span data-ttu-id="c4372-275">Query’s uitvoeren</span><span class="sxs-lookup"><span data-stu-id="c4372-275">Query</span></span> | <span data-ttu-id="c4372-276">Voorbeeld metrische gegevens</span><span class="sxs-lookup"><span data-stu-id="c4372-276">Sample Metric</span></span> | <span data-ttu-id="c4372-277">Beschrijving</span><span class="sxs-lookup"><span data-stu-id="c4372-277">Description</span></span> | 
| ------ | -----| ----------- |
| `SELECT TOP 100 * FROM c` | `"RetrievedDocumentCount": 101` | <span data-ttu-id="c4372-278">Het aantal documenten opgehaald is 100 + 1 overeenkomen met de TOP-component.</span><span class="sxs-lookup"><span data-stu-id="c4372-278">The number of documents retrieved is 100+1 to match the TOP clause.</span></span> <span data-ttu-id="c4372-279">Querytijd voornamelijk die is doorgebracht in `WriteOutputTime` en `DocumentLoadTime` omdat het een scan.</span><span class="sxs-lookup"><span data-stu-id="c4372-279">Query time is mostly spent in `WriteOutputTime` and `DocumentLoadTime` since it is a scan.</span></span> | 
| `SELECT TOP 500 * FROM c` | `"RetrievedDocumentCount": 501` | <span data-ttu-id="c4372-280">RetrievedDocumentCount is nu hogere (500 + 1 overeenkomen met de TOP-component).</span><span class="sxs-lookup"><span data-stu-id="c4372-280">RetrievedDocumentCount is now higher (500+1 to match the TOP clause).</span></span> | 
| `SELECT * FROM c WHERE c.N = 55` | `"IndexLookupTime": "00:00:00.0009500"` | <span data-ttu-id="c4372-281">Ongeveer 0,9 ms is besteed aan IndexLookupTime voor een sleutel-lookup, omdat deze het opzoeken van een index op `/N/?`.</span><span class="sxs-lookup"><span data-stu-id="c4372-281">About 0.9 ms is spent in IndexLookupTime for a key lookup, because it's an index lookup on `/N/?`.</span></span> | 
| `SELECT * FROM c WHERE c.N > 55` | `"IndexLookupTime": "00:00:00.0017700"` | <span data-ttu-id="c4372-282">Iets meer tijd (1,7 ms) die is doorgebracht in IndexLookupTime via een scan bereik omdat dit het opzoeken van een index op `/N/?`.</span><span class="sxs-lookup"><span data-stu-id="c4372-282">Slightly more time (1.7 ms) spent in IndexLookupTime over a range scan, because it's an index lookup on `/N/?`.</span></span> | 
| `SELECT TOP 500 c.N FROM c` | `"IndexLookupTime": "00:00:00.0017700"` | <span data-ttu-id="c4372-283">Dezelfde tijd besteed aan `DocumentLoadTime` als de voorgaande query's, maar lagere `WriteOutputTime` omdat we bij het projecteren van slechts één eigenschap.</span><span class="sxs-lookup"><span data-stu-id="c4372-283">Same time spent on `DocumentLoadTime` as previous queries, but lower `WriteOutputTime` because we're projecting only one property.</span></span> | 
| `SELECT TOP 500 udf.toPercent(c.N) FROM c` | `"UserDefinedFunctionExecutionTime": "00:00:00.2136500"` | <span data-ttu-id="c4372-284">Punt 213 ms is die is doorgebracht in `UserDefinedFunctionExecutionTime` de UDF worden uitgevoerd op elke waarde van `c.N`.</span><span class="sxs-lookup"><span data-stu-id="c4372-284">About 213 ms is spent in `UserDefinedFunctionExecutionTime` executing the UDF on each value of `c.N`.</span></span> |
| `SELECT TOP 500 c.Name FROM c WHERE STARTSWITH(c.Name, 'Den')` | `"IndexLookupTime": "00:00:00.0006400", "SystemFunctionExecutionTime": "00:00:00.0074100"` | <span data-ttu-id="c4372-285">Er is ongeveer 0,6 ms gespendeerd aan het `IndexLookupTime` op `/Name/?`.</span><span class="sxs-lookup"><span data-stu-id="c4372-285">About 0.6 ms is spent in `IndexLookupTime` on `/Name/?`.</span></span> <span data-ttu-id="c4372-286">Van de query uitvoeringstijd (ms ~ 7) in de meeste `SystemFunctionExecutionTime`.</span><span class="sxs-lookup"><span data-stu-id="c4372-286">Most of the query execution time (~7 ms) in `SystemFunctionExecutionTime`.</span></span> |
| `SELECT TOP 500 c.Name FROM c WHERE STARTSWITH(LOWER(c.Name), 'den')` | `"IndexLookupTime": "00:00:00", "RetrievedDocumentCount": 2491,  "OutputDocumentCount": 500` | <span data-ttu-id="c4372-287">Query als een scan wordt uitgevoerd, omdat deze gebruikmaakt van `LOWER`, en 500 buiten 2491 opgehaalde documenten worden geretourneerd.</span><span class="sxs-lookup"><span data-stu-id="c4372-287">Query is performed as a scan because it uses `LOWER`, and 500 out of 2491 retrieved documents are returned.</span></span> |


## <a name="next-steps"></a><span data-ttu-id="c4372-288">Volgende stappen</span><span class="sxs-lookup"><span data-stu-id="c4372-288">Next steps</span></span>
* <span data-ttu-id="c4372-289">Zie voor meer informatie over de ondersteunde SQL-query's en trefwoorden, [SQL-query](documentdb-sql-query.md).</span><span class="sxs-lookup"><span data-stu-id="c4372-289">To learn about the supported SQL query operators and keywords, see [SQL query](documentdb-sql-query.md).</span></span> 
* <span data-ttu-id="c4372-290">Zie voor meer informatie over aanvraageenheden, [aanvraageenheden](request-units.md).</span><span class="sxs-lookup"><span data-stu-id="c4372-290">To learn about request units, see [request units](request-units.md).</span></span>
* <span data-ttu-id="c4372-291">Zie voor meer informatie over indexeringsbeleid, [indexeren van beleid](indexing-policies.md)</span><span class="sxs-lookup"><span data-stu-id="c4372-291">To learn about indexing policy, see [indexing policy](indexing-policies.md)</span></span> 


