---
title: Beveiligingsoverwegingen voor Azure AD-toepassingsproxy | Microsoft Docs
description: Bevat informatie over de beveiligingsoverwegingen voor het gebruik van Azure AD-toepassingsproxy
services: active-directory
documentationcenter: 
author: kgremban
manager: femila
ms.assetid: 
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 08/03/2017
ms.author: kgremban
ms.reviewer: harshja
ms.custom: it-pro
ms.openlocfilehash: c6ead651133eb17fd55f7567cdb14dc3bcd64245
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 08/18/2017
---
# <a name="security-considerations-for-accessing-apps-remotely-with-azure-ad-application-proxy"></a><span data-ttu-id="9e350-103">Beveiligingsoverwegingen voor toegang tot apps op afstand met Azure AD-toepassingsproxy</span><span class="sxs-lookup"><span data-stu-id="9e350-103">Security considerations for accessing apps remotely with Azure AD Application Proxy</span></span>

<span data-ttu-id="9e350-104">Dit artikel wordt uitgelegd hoe Azure Active Directory-toepassingsproxy voorziet in een beveiligde service voor het publiceren en externe toegang tot uw toepassingen.</span><span class="sxs-lookup"><span data-stu-id="9e350-104">This article explains how Azure Active Directory Application Proxy provides a secure service for publishing and accessing your applications remotely.</span></span>

<span data-ttu-id="9e350-105">Het volgende diagram laat zien hoe Azure AD kunt veilige externe toegang tot uw on-premises toepassingen.</span><span class="sxs-lookup"><span data-stu-id="9e350-105">The following diagram shows how Azure AD enables secure remote access to your on-premises applications.</span></span>

 ![Diagram van veilige externe toegang via Azure AD-toepassingsproxy](./media/application-proxy-security-considerations/secure-remote-access.png)

## <a name="security-benefits"></a><span data-ttu-id="9e350-107">De voordelen van beveiliging</span><span class="sxs-lookup"><span data-stu-id="9e350-107">Security benefits</span></span>

<span data-ttu-id="9e350-108">Azure AD-toepassingsproxy biedt de voordelen van de volgende beveiliging:</span><span class="sxs-lookup"><span data-stu-id="9e350-108">Azure AD Application Proxy offers the following security benefits:</span></span>

### <a name="authenticated-access"></a><span data-ttu-id="9e350-109">Geverifieerde toegang</span><span class="sxs-lookup"><span data-stu-id="9e350-109">Authenticated access</span></span> 

<span data-ttu-id="9e350-110">Als u gebruikmaken van Azure Active Directory vooraf-verificatie wilt, klikt u vervolgens alleen geverifieerde verbindingen toegang tot uw netwerk.</span><span class="sxs-lookup"><span data-stu-id="9e350-110">If you choose to use Azure Active Directory preauthentication, then only authenticated connections can access your network.</span></span>

<span data-ttu-id="9e350-111">Azure AD-toepassingsproxy is afhankelijk van de Azure AD beveiligingstokenservice (STS) voor alle verificatie.</span><span class="sxs-lookup"><span data-stu-id="9e350-111">Azure AD Application Proxy relies on the Azure AD security token service (STS) for all authentication.</span></span>  <span data-ttu-id="9e350-112">Vooraf-verificatie, blokkeert door de aard een groot aantal anonieme aanvallen, omdat alleen geauthenticeerde identiteiten toegang heeft tot de back-end-toepassing.</span><span class="sxs-lookup"><span data-stu-id="9e350-112">Preauthentication, by its very nature, blocks a significant number of anonymous attacks, because only authenticated identities can access the back-end application.</span></span>

<span data-ttu-id="9e350-113">Als u Passthrough als uw methode voor verificatie vooraf kiest, kunt u voordeel niet ophalen.</span><span class="sxs-lookup"><span data-stu-id="9e350-113">If you choose Passthrough as your preauthentication method, you don't get this benefit.</span></span> 

### <a name="conditional-access"></a><span data-ttu-id="9e350-114">Voorwaardelijke toegang</span><span class="sxs-lookup"><span data-stu-id="9e350-114">Conditional access</span></span>

<span data-ttu-id="9e350-115">Besturingselementen voor uitgebreidere beleid van toepassing voordat verbindingen met uw netwerk tot stand worden gebracht.</span><span class="sxs-lookup"><span data-stu-id="9e350-115">Apply richer policy controls before connections to your network are established.</span></span>

<span data-ttu-id="9e350-116">Met [voorwaardelijke toegang](active-directory-conditional-access-azuread-connected-apps.md), kunt u beperkingen op welk verkeer is toegestaan voor toegang tot uw back-end-toepassingen.</span><span class="sxs-lookup"><span data-stu-id="9e350-116">With [conditional access](active-directory-conditional-access-azuread-connected-apps.md), you can define restrictions on what traffic is allowed to access your back-end applications.</span></span> <span data-ttu-id="9e350-117">Kunt u beleidsregels die aanmeldingen op basis van locatie, sterkte van verificatie en gebruikersprofiel risico beperken.</span><span class="sxs-lookup"><span data-stu-id="9e350-117">You can create policies that restrict sign-ins based on location, strength of authentication, and user risk profile.</span></span>

<span data-ttu-id="9e350-118">U kunt ook voorwaardelijke toegang gebruiken voor het configureren van multi-factor Authentication-beleid, nog een beveiligingslaag toe te voegen aan uw gebruikersverificaties.</span><span class="sxs-lookup"><span data-stu-id="9e350-118">You can also use conditional access to configure Multi-Factor Authentication policies, adding another layer of security to your user authentications.</span></span> 

### <a name="traffic-termination"></a><span data-ttu-id="9e350-119">Beëindiging van verkeer</span><span class="sxs-lookup"><span data-stu-id="9e350-119">Traffic termination</span></span>

<span data-ttu-id="9e350-120">Al het verkeer wordt beëindigd in de cloud.</span><span class="sxs-lookup"><span data-stu-id="9e350-120">All traffic is terminated in the cloud.</span></span>

<span data-ttu-id="9e350-121">Omdat Azure AD-toepassingsproxy een reverse proxy is, wordt al het verkeer naar de back-end-toepassingen wordt beëindigd bij de service.</span><span class="sxs-lookup"><span data-stu-id="9e350-121">Because Azure AD Application Proxy is a reverse-proxy, all traffic to back-end applications is terminated at the service.</span></span> <span data-ttu-id="9e350-122">De sessie kan ophalen opnieuw tot stand gebracht alleen met de back-end-server, wat betekent dat uw back-endservers niet worden blootgesteld aan direct HTTP-verkeer.</span><span class="sxs-lookup"><span data-stu-id="9e350-122">The session can get reestablished only with the back-end server, which means that your back-end servers are not exposed to direct HTTP traffic.</span></span> <span data-ttu-id="9e350-123">Deze configuratie betekent dat u beter beschermd zijn tegen gerichte aanvallen.</span><span class="sxs-lookup"><span data-stu-id="9e350-123">This configuration means that you are better protected from targeted attacks.</span></span>

### <a name="all-access-is-outbound"></a><span data-ttu-id="9e350-124">Alle gebruikers de toegang is uitgaand</span><span class="sxs-lookup"><span data-stu-id="9e350-124">All access is outbound</span></span> 

<span data-ttu-id="9e350-125">U hoeft niet te openen van binnenkomende verbindingen met het bedrijfsnetwerk.</span><span class="sxs-lookup"><span data-stu-id="9e350-125">You don't need to open inbound connections to the corporate network.</span></span>

<span data-ttu-id="9e350-126">Application Proxy connectors alleen uitgaande verbindingen naar de service Azure AD-toepassingsproxy, wat betekent dat niet hoeft te openen, firewall-poorten voor binnenkomende verbindingen gebruiken.</span><span class="sxs-lookup"><span data-stu-id="9e350-126">Application Proxy connectors only use outbound connections to the Azure AD Application Proxy service, which means that there is no need to open firewall ports for incoming connections.</span></span> <span data-ttu-id="9e350-127">Traditionele proxy's vereist een perimeternetwerk (ook wel bekend als *DMZ*, *gedemilitariseerde zone*, of *gescreend subnet*) en toegang hebben tot niet-geverifieerde verbindingen aan de rand van het netwerk.</span><span class="sxs-lookup"><span data-stu-id="9e350-127">Traditional proxies required a perimeter network (also known as *DMZ*, *demilitarized zone*, or *screened subnet*) and allowed access to unauthenticated connections at the network edge.</span></span> <span data-ttu-id="9e350-128">Dit scenario vereist veel aanvullende investeringen in web application firewallproducten te analyseren van verkeer en beveiliging toevoegen aan de omgeving te bieden.</span><span class="sxs-lookup"><span data-stu-id="9e350-128">This scenario required many additional investments in web application firewall products to analyze traffic and offer addition protections to the environment.</span></span> <span data-ttu-id="9e350-129">Met toepassingsproxy hoeft u niet een perimeternetwerk omdat alle verbindingen uitgaande zijn en plaats via een beveiligd kanaal vindt.</span><span class="sxs-lookup"><span data-stu-id="9e350-129">With Application Proxy, you don't need a perimeter network because all connections are outbound and take place over a secure channel.</span></span>

<span data-ttu-id="9e350-130">Zie voor meer informatie over connectors [inzicht in Azure AD-toepassingsproxy connectors](application-proxy-understand-connectors.md).</span><span class="sxs-lookup"><span data-stu-id="9e350-130">For more information about connectors, see [Understand Azure AD Application Proxy connectors](application-proxy-understand-connectors.md).</span></span>

### <a name="cloud-scale-analytics-and-machine-learning"></a><span data-ttu-id="9e350-131">Cloud-scale analytics en machine learning</span><span class="sxs-lookup"><span data-stu-id="9e350-131">Cloud-scale analytics and machine learning</span></span> 

<span data-ttu-id="9e350-132">Geavanceerde beveiliging worden opgehaald.</span><span class="sxs-lookup"><span data-stu-id="9e350-132">Get cutting-edge security protection.</span></span>

<span data-ttu-id="9e350-133">Omdat deze deel uitmaakt van Azure Active Directory, kunnen gebruikmaken van toepassingsproxy [Azure AD Identity Protection](active-directory-identityprotection.md)met machine learning gebaseerde intelligence en gegevens van de Microsoft Security Response Center en de Digital Crimes Unit.</span><span class="sxs-lookup"><span data-stu-id="9e350-133">Because it's part of Azure Active Directory, Application Proxy can leverage [Azure AD Identity Protection](active-directory-identityprotection.md), with machine learning-driven intelligence and data from the Microsoft Security Response Center and Digital Crimes Unit.</span></span> <span data-ttu-id="9e350-134">Samen we proactief identificeren waarmee is geknoeid en bieden real-timebeveiliging van aanmeldingen met een hoog risico. We rekening gehouden met meerdere factoren, zoals toegang vanaf geïnfecteerde apparaten, via anonymizing netwerken, en vanaf locaties ongebruikelijk zijn en onwaarschijnlijk.</span><span class="sxs-lookup"><span data-stu-id="9e350-134">Together we proactively identify compromised accounts and offer real-time protection from high-risk sign-ins. We take into account numerous factors, such as access from infected devices, through anonymizing networks, and from atypical and unlikely locations.</span></span>

<span data-ttu-id="9e350-135">Veel van deze rapporten en gebeurtenissen zijn al beschikbaar via een API voor de integratie met uw security information en event management (SIEM)-systemen.</span><span class="sxs-lookup"><span data-stu-id="9e350-135">Many of these reports and events are already available through an API for integration with your security information and event management (SIEM) systems.</span></span>

### <a name="remote-access-as-a-service"></a><span data-ttu-id="9e350-136">Externe toegang als een service</span><span class="sxs-lookup"><span data-stu-id="9e350-136">Remote access as a service</span></span>

<span data-ttu-id="9e350-137">U hoeft niet te hoeven maken over het onderhouden en patchen lokale servers.</span><span class="sxs-lookup"><span data-stu-id="9e350-137">You don’t have to worry about maintaining and patching on-premises servers.</span></span>

<span data-ttu-id="9e350-138">Niet-gepatchte software nog steeds accounts voor een groot aantal aanvallen.</span><span class="sxs-lookup"><span data-stu-id="9e350-138">Unpatched software still accounts for a large number of attacks.</span></span> <span data-ttu-id="9e350-139">Azure AD-toepassingsproxy is een Internet-scale-service die Microsoft eigenaar is, zodat u altijd de meest recente beveiligingspatches en upgrades.</span><span class="sxs-lookup"><span data-stu-id="9e350-139">Azure AD Application Proxy is an Internet-scale service that Microsoft owns, so you always get the latest security patches and upgrades.</span></span>

<span data-ttu-id="9e350-140">Ter verbetering van de beveiliging van toepassingen die zijn gepubliceerd door Azure AD-toepassingsproxy blokkeren we web crawler robots indexeren en uw toepassingen wilt archiveren.</span><span class="sxs-lookup"><span data-stu-id="9e350-140">To improve the security of applications published by Azure AD Application Proxy, we block web crawler robots from indexing and archiving your applications.</span></span> <span data-ttu-id="9e350-141">Elke keer web crawler robot probeert op te halen van de robot-instellingen voor een gepubliceerde app toepassingsproxy geantwoord met een robots.txt-bestand met `User-agent: * Disallow: /`.</span><span class="sxs-lookup"><span data-stu-id="9e350-141">Each time a web crawler robot tries to retrieve the robot's settings for a published app, Application Proxy replies with a robots.txt file that includes `User-agent: * Disallow: /`.</span></span>

## <a name="under-the-hood"></a><span data-ttu-id="9e350-142">Onderhuids</span><span class="sxs-lookup"><span data-stu-id="9e350-142">Under the hood</span></span>

<span data-ttu-id="9e350-143">Azure AD-toepassingsproxy bestaat uit twee delen:</span><span class="sxs-lookup"><span data-stu-id="9e350-143">Azure AD Application Proxy consists of two parts:</span></span>

* <span data-ttu-id="9e350-144">De cloudservice: deze service wordt uitgevoerd in Azure, en is waar de verbindingen van de externe client/gebruiker zijn gemaakt.</span><span class="sxs-lookup"><span data-stu-id="9e350-144">The cloud-based service: This service runs in Azure, and is where the external client/user connections are made.</span></span>
* <span data-ttu-id="9e350-145">[De on-premises connector](application-proxy-understand-connectors.md): een onderdeel van de lokale de connector luistert naar aanvragen van de Azure AD-toepassingsproxy-service en -ingangen verbindingen naar de interne toepassingen.</span><span class="sxs-lookup"><span data-stu-id="9e350-145">[The on-premises connector](application-proxy-understand-connectors.md): An on-premises component, the connector listens for requests from the Azure AD Application Proxy service and handles connections to the internal applications.</span></span> 

<span data-ttu-id="9e350-146">Een stroom tussen de connector en de service-toepassingsproxy tot stand wordt gebracht wanneer:</span><span class="sxs-lookup"><span data-stu-id="9e350-146">A flow between the connector and the Application Proxy service is established when:</span></span>

* <span data-ttu-id="9e350-147">De connector is eerst instellen.</span><span class="sxs-lookup"><span data-stu-id="9e350-147">The connector is first set up.</span></span>
* <span data-ttu-id="9e350-148">De connector haalt de configuratie-informatie van de service-toepassingsproxy.</span><span class="sxs-lookup"><span data-stu-id="9e350-148">The connector pulls configuration information from the Application Proxy service.</span></span>
* <span data-ttu-id="9e350-149">Een gebruiker toegang krijgt tot een gepubliceerde toepassing.</span><span class="sxs-lookup"><span data-stu-id="9e350-149">A user accesses a published application.</span></span>

>[!NOTE]
><span data-ttu-id="9e350-150">Alle communicatie vindt plaats via SSL en ze altijd afkomstig van de connector met de service-toepassingsproxy.</span><span class="sxs-lookup"><span data-stu-id="9e350-150">All communications occur over SSL, and they always originate at the connector to the Application Proxy service.</span></span> <span data-ttu-id="9e350-151">De service is alleen uitgaand.</span><span class="sxs-lookup"><span data-stu-id="9e350-151">The service is outbound only.</span></span>

<span data-ttu-id="9e350-152">De connector gebruikt een certificaat voor verificatie bij de service-toepassingsproxy voor bijna alle aanroepen.</span><span class="sxs-lookup"><span data-stu-id="9e350-152">The connector uses a client certificate to authenticate to the Application Proxy service for nearly all calls.</span></span> <span data-ttu-id="9e350-153">De enige uitzondering op dit proces is de initiële installatie stap, waarbij het clientcertificaat tot stand is gebracht.</span><span class="sxs-lookup"><span data-stu-id="9e350-153">The only exception to this process is the initial setup step, where the client certificate is established.</span></span>

### <a name="installing-the-connector"></a><span data-ttu-id="9e350-154">De connector installeren</span><span class="sxs-lookup"><span data-stu-id="9e350-154">Installing the connector</span></span>

<span data-ttu-id="9e350-155">Wanneer de connector eerst instelt is, wordt de volgende stroom gebeurtenissen plaatsvinden:</span><span class="sxs-lookup"><span data-stu-id="9e350-155">When the connector is first set up, the following flow events take place:</span></span>

1. <span data-ttu-id="9e350-156">De registratie van de connector met de service wordt uitgevoerd als onderdeel van de installatie van de connector.</span><span class="sxs-lookup"><span data-stu-id="9e350-156">The connector registration to the service happens as part of the installation of the connector.</span></span> <span data-ttu-id="9e350-157">Gebruikers gevraagd hun Azure AD-referenties invoeren.</span><span class="sxs-lookup"><span data-stu-id="9e350-157">Users are prompted to enter their Azure AD admin credentials.</span></span> <span data-ttu-id="9e350-158">Het token dat is verkregen van deze verificatie wordt vervolgens gepresenteerd aan de service Azure AD-toepassingsproxy.</span><span class="sxs-lookup"><span data-stu-id="9e350-158">The token acquired from this authentication is then presented to the Azure AD Application Proxy service.</span></span>
2. <span data-ttu-id="9e350-159">De service voor toepassingsproxy evalueert het token.</span><span class="sxs-lookup"><span data-stu-id="9e350-159">The Application Proxy service evaluates the token.</span></span> <span data-ttu-id="9e350-160">Dit zorgt ervoor dat de gebruiker in de tenant die het token is uitgegeven voor de beheerder is.</span><span class="sxs-lookup"><span data-stu-id="9e350-160">It ensures that the user is a company administrator within the tenant that the token was issued for.</span></span> <span data-ttu-id="9e350-161">Als de gebruiker geen beheerder is, wordt het proces beëindigd.</span><span class="sxs-lookup"><span data-stu-id="9e350-161">If the user is not an administrator, the process is terminated.</span></span>
3. <span data-ttu-id="9e350-162">De connector genereert een certificaataanvraag van de client en wordt doorgegeven, samen met het token, met de service-toepassingsproxy.</span><span class="sxs-lookup"><span data-stu-id="9e350-162">The connector generates a client certificate request and passes it, along with the token, to the Application Proxy service.</span></span> <span data-ttu-id="9e350-163">De service het token heeft geverifieerd op zijn beurt en de clientaanvraag certificaat ondertekent.</span><span class="sxs-lookup"><span data-stu-id="9e350-163">The service in turn verifies the token and signs the client certificate request.</span></span>
4. <span data-ttu-id="9e350-164">De connector gebruikt het clientcertificaat voor toekomstige communicatie met de service-toepassingsproxy.</span><span class="sxs-lookup"><span data-stu-id="9e350-164">The connector uses the client certificate for future communication with the Application Proxy service.</span></span>
5. <span data-ttu-id="9e350-165">De connector voert een initiële pull van het systeem-configuratiegegevens van de service met behulp van het clientcertificaat en het is nu klaar om aanvragen te.</span><span class="sxs-lookup"><span data-stu-id="9e350-165">The connector performs an initial pull of the system configuration data from the service using its client certificate, and it is now ready to take requests.</span></span>

### <a name="updating-the-configuration-settings"></a><span data-ttu-id="9e350-166">Bijwerken van de configuratieinstellingen</span><span class="sxs-lookup"><span data-stu-id="9e350-166">Updating the configuration settings</span></span>

<span data-ttu-id="9e350-167">Wanneer de service Application Proxy-updates voor de configuratie-instellingen, worden de volgende stroom gebeurtenissen plaatsvinden:</span><span class="sxs-lookup"><span data-stu-id="9e350-167">Whenever the Application Proxy service updates the configuration settings, the following flow events take place:</span></span>

1. <span data-ttu-id="9e350-168">De connector maakt verbinding met het eindpunt van de configuratie in de service voor toepassingsproxy met behulp van het clientcertificaat.</span><span class="sxs-lookup"><span data-stu-id="9e350-168">The connector connects to the configuration endpoint within the Application Proxy service by using its client certificate.</span></span>
2. <span data-ttu-id="9e350-169">Nadat het clientcertificaat is gevalideerd, stuurt de service-toepassingsproxy configuratiegegevens naar de connector (bijvoorbeeld de connector groep die de connector deel uitmaken van moeten).</span><span class="sxs-lookup"><span data-stu-id="9e350-169">After the client certificate has been validated, the Application Proxy service returns configuration data to the connector (for example, the connector group that the connector should be part of).</span></span>
3. <span data-ttu-id="9e350-170">Als het huidige certificaat meer dan 180 dagen is, genereert de connector een nieuwe certificaataanvraag waarmee het clientcertificaat effectief per 180 dagen bijgewerkt.</span><span class="sxs-lookup"><span data-stu-id="9e350-170">If the current certificate is more than 180 days old, the connector generates a new certificate request, which effectively updates the client certificate every 180 days.</span></span>

### <a name="accessing-published-applications"></a><span data-ttu-id="9e350-171">Toegang tot gepubliceerde toepassingen</span><span class="sxs-lookup"><span data-stu-id="9e350-171">Accessing published applications</span></span>

<span data-ttu-id="9e350-172">Als gebruikers toegang hebben tot een gepubliceerde toepassing, plaatsvinden de volgende gebeurtenissen tussen de toepassingsproxy-service en de Application Proxy connector:</span><span class="sxs-lookup"><span data-stu-id="9e350-172">When users access a published application, the following events take place between the Application Proxy service and the Application Proxy connector:</span></span>

1. [<span data-ttu-id="9e350-173">De service verifieert de gebruiker voor de app</span><span class="sxs-lookup"><span data-stu-id="9e350-173">The service authenticates the user for the app</span></span>](#the-service-checks-the-configuration-settings-for-the-app)
2. [<span data-ttu-id="9e350-174">De service plaatst een aanvraag in de connectorwachtrij</span><span class="sxs-lookup"><span data-stu-id="9e350-174">The service places a request in the connector queue</span></span>](#The-service-places-a-request-in-the-connector-queue)
3. [<span data-ttu-id="9e350-175">De aanvraag uit de wachtrij wordt verwerkt door een connector</span><span class="sxs-lookup"><span data-stu-id="9e350-175">A connector processes the request from the queue</span></span>](#the-connector-receives-the-request-from-the-queue)
4. [<span data-ttu-id="9e350-176">De connector wordt gewacht op een reactie</span><span class="sxs-lookup"><span data-stu-id="9e350-176">The connector waits for a response</span></span>](#the-connector-waits-for-a-response)
5. [<span data-ttu-id="9e350-177">De service streams gegevens naar de gebruiker</span><span class="sxs-lookup"><span data-stu-id="9e350-177">The service streams data to the user</span></span>](#the-service-streams-data-to-the-user)

<span data-ttu-id="9e350-178">Houd lezen voor meer informatie over wat in elk van deze stappen plaatsvindt.</span><span class="sxs-lookup"><span data-stu-id="9e350-178">To learn more about what takes place in each of these steps, keep reading.</span></span>


#### <a name="1-the-service-authenticates-the-user-for-the-app"></a><span data-ttu-id="9e350-179">1. De service verifieert de gebruiker voor de app</span><span class="sxs-lookup"><span data-stu-id="9e350-179">1. The service authenticates the user for the app</span></span>

<span data-ttu-id="9e350-180">Als u de app om Passthrough gebruiken als de methode voor verificatie vooraf geconfigureerd, worden de stappen in deze sectie worden overgeslagen.</span><span class="sxs-lookup"><span data-stu-id="9e350-180">If you configured the app to use Passthrough as its preauthentication method, the steps in this section are skipped.</span></span>

<span data-ttu-id="9e350-181">Als u de app met Azure AD worden geconfigureerd, worden gebruikers omgeleid naar de Azure AD-STS om te verifiëren en de volgende stappen worden uitgevoerd:</span><span class="sxs-lookup"><span data-stu-id="9e350-181">If you configured the app to preauthenticate with Azure AD, users are redirected to the Azure AD STS to authenticate, and the following steps take place:</span></span>

1. <span data-ttu-id="9e350-182">Toepassingsproxy controleert u alle vereisten voor het beleid van voorwaardelijke toegang voor de specifieke toepassing.</span><span class="sxs-lookup"><span data-stu-id="9e350-182">Application Proxy checks for any conditional access policy requirements for the specific application.</span></span> <span data-ttu-id="9e350-183">Deze stap zorgt ervoor dat de gebruiker is toegewezen aan de toepassing.</span><span class="sxs-lookup"><span data-stu-id="9e350-183">This step ensures that the user has been assigned to the application.</span></span> <span data-ttu-id="9e350-184">Als verificatie in twee stappen vereist is, vraagt de verificatiemethode die de gebruiker om een tweede methode voor verificatie.</span><span class="sxs-lookup"><span data-stu-id="9e350-184">If two-step verification is required, the authentication sequence prompts the user for a second authentication method.</span></span>

2. <span data-ttu-id="9e350-185">Nadat alle controles zijn verstreken, wordt de Azure AD STS een ondertekende token voor de toepassing en wordt de gebruiker omgeleid naar de service-toepassingsproxy.</span><span class="sxs-lookup"><span data-stu-id="9e350-185">After all checks have passed, the Azure AD STS issues a signed token for the application and redirects the user back to the Application Proxy service.</span></span>

3. <span data-ttu-id="9e350-186">Toepassingsproxy controleert of het token is uitgegeven voor het corrigeren van de toepassing.</span><span class="sxs-lookup"><span data-stu-id="9e350-186">Application Proxy verifies that the token was issued to correct the application.</span></span> <span data-ttu-id="9e350-187">Het andere controles ook, zoals ervoor te zorgen dat het token is ondertekend door Azure AD en is nog steeds binnen het geldige venster uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="9e350-187">It performs other checks also, such as ensuring that the token was signed by Azure AD, and that it is still within the valid window.</span></span>

4. <span data-ttu-id="9e350-188">Application Proxy sets een gecodeerde verificatiecookie om aan te geven dat de verificatie bij de toepassing heeft plaatsgevonden.</span><span class="sxs-lookup"><span data-stu-id="9e350-188">Application Proxy sets an encrypted authentication cookie to indicate that authentication to the application has occurred.</span></span> <span data-ttu-id="9e350-189">De cookie bevat de tijdstempel van een vervaldatum die gebaseerd op het token van Azure AD en andere gegevens, zoals de naam van de gebruiker die de verificatie is gebaseerd op.</span><span class="sxs-lookup"><span data-stu-id="9e350-189">The cookie includes an expiration timestamp that's based on the token from Azure AD and other data, such as the user name that the authentication is based on.</span></span> <span data-ttu-id="9e350-190">De cookie wordt versleuteld met een persoonlijke sleutel die alleen bekend is bij de service-toepassingsproxy.</span><span class="sxs-lookup"><span data-stu-id="9e350-190">The cookie is encrypted with a private key known only to the Application Proxy service.</span></span>

5. <span data-ttu-id="9e350-191">Toepassingsproxy leidt de gebruiker terug naar de oorspronkelijk aangevraagde URL.</span><span class="sxs-lookup"><span data-stu-id="9e350-191">Application Proxy redirects the user back to the originally requested URL.</span></span>

<span data-ttu-id="9e350-192">Als een deel van de stappen die vooraf-verificatie is mislukt, wordt van de gebruiker de aanvraag is geweigerd en wordt de gebruiker een bericht met de bron van het probleem wordt weergegeven.</span><span class="sxs-lookup"><span data-stu-id="9e350-192">If any part of the preauthentication steps fails, the user’s request is denied, and the user is shown a message indicating the source of the problem.</span></span>


#### <a name="2-the-service-places-a-request-in-the-connector-queue"></a><span data-ttu-id="9e350-193">2. De service plaatst een aanvraag in de connectorwachtrij</span><span class="sxs-lookup"><span data-stu-id="9e350-193">2. The service places a request in the connector queue</span></span>

<span data-ttu-id="9e350-194">Connectors openhouden die een uitgaande verbinding met de service-toepassingsproxy.</span><span class="sxs-lookup"><span data-stu-id="9e350-194">Connectors keep an outbound connection open to the Application Proxy service.</span></span> <span data-ttu-id="9e350-195">Als een aanvraag binnenkomt, wordt de service wachtrijen van de aanvraag op een van de geopende verbindingen voor de connector om op te halen.</span><span class="sxs-lookup"><span data-stu-id="9e350-195">When a request comes in, the service queues up the request on one of the open connections for the connector to pick up.</span></span>

<span data-ttu-id="9e350-196">De aanvraag bevat de items uit de toepassing, zoals de aanvraagheaders gegevens uit de gecodeerde cookie, de gebruiker de aanvraag en/of de aanvraag-ID.</span><span class="sxs-lookup"><span data-stu-id="9e350-196">The request includes items from the application, such as the request headers, data from the encrypted cookie, the user making the request, and the request ID.</span></span> <span data-ttu-id="9e350-197">Hoewel de gegevens van de versleutelde cookie aan de aanvraag is verzonden, is de verificatiecookie zelf niet.</span><span class="sxs-lookup"><span data-stu-id="9e350-197">Although data from the encrypted cookie is sent with the request, the authentication cookie itself is not.</span></span>

#### <a name="3-the-connector-processes-the-request-from-the-queue"></a><span data-ttu-id="9e350-198">3. De aanvraag uit de wachtrij wordt verwerkt door de connector.</span><span class="sxs-lookup"><span data-stu-id="9e350-198">3. The connector processes the request from the queue.</span></span> 

<span data-ttu-id="9e350-199">Toepassingsproxy voert op basis van de aanvraag, een van de volgende acties:</span><span class="sxs-lookup"><span data-stu-id="9e350-199">Based on the request, Application Proxy performs one of the following actions:</span></span>

* <span data-ttu-id="9e350-200">Als de aanvraag een eenvoudige operatie is (bijvoorbeeld: Er zijn geen gegevens in de hoofdtekst is met een RESTful *ophalen* aanvraag), de connector maakt verbinding met de interne doel-resource en vervolgens wordt gewacht op een antwoord.</span><span class="sxs-lookup"><span data-stu-id="9e350-200">If the request is a simple operation (for example, there is no data within the body as is with a RESTful *GET* request), the connector makes a connection to the target internal resource and then waits for a response.</span></span>

* <span data-ttu-id="9e350-201">Als de aanvraag bevat de gegevens die zijn gekoppeld in de hoofdtekst (bijvoorbeeld een RESTful *POST* bewerking), de connector een uitgaande verbinding maakt met behulp van het clientcertificaat met het exemplaar van de toepassingsproxy.</span><span class="sxs-lookup"><span data-stu-id="9e350-201">If the request has data associated with it in the body (for example, a RESTful *POST* operation), the connector makes an outbound connection by using the client certificate to the Application Proxy instance.</span></span> <span data-ttu-id="9e350-202">Dit maakt deze verbinding met het aanvragen van de gegevens en een verbinding met de interne resource openen.</span><span class="sxs-lookup"><span data-stu-id="9e350-202">It makes this connection to request the data and open a connection to the internal resource.</span></span> <span data-ttu-id="9e350-203">Nadat deze de aanvraag van de connector is ontvangen, wordt de service voor toepassingsproxy begint met het accepteren van de inhoud van de gebruiker en stuurt gegevens naar de connector.</span><span class="sxs-lookup"><span data-stu-id="9e350-203">After it receives the request from the connector, the Application Proxy service begins accepting content from the user and forwards data to the connector.</span></span> <span data-ttu-id="9e350-204">De connector stuurt op zijn beurt de gegevens naar de interne resource.</span><span class="sxs-lookup"><span data-stu-id="9e350-204">The connector, in turn, forwards the data to the internal resource.</span></span>

#### <a name="4-the-connector-waits-for-a-response"></a><span data-ttu-id="9e350-205">4. De connector wacht een antwoord.</span><span class="sxs-lookup"><span data-stu-id="9e350-205">4. The connector waits for a response.</span></span>

<span data-ttu-id="9e350-206">Nadat de aanvraag en de overdracht van alle inhoud naar de back-end is voltooid, wordt de connector wordt gewacht op een antwoord.</span><span class="sxs-lookup"><span data-stu-id="9e350-206">After the request and transmission of all content to the back end is complete, the connector waits for a response.</span></span>

<span data-ttu-id="9e350-207">Nadat hij een antwoord ontvangt, de connector een uitgaande verbinding maakt met de service-toepassingsproxy, om te retourneren van de details van de header en beginnen met het streamen van de geretourneerde gegevens.</span><span class="sxs-lookup"><span data-stu-id="9e350-207">After it receives a response, the connector makes an outbound connection to the Application Proxy service, to return the header details and begin streaming the return data.</span></span>

#### <a name="5-the-service-streams-data-to-the-user"></a><span data-ttu-id="9e350-208">5. De service streams gegevens naar de gebruiker.</span><span class="sxs-lookup"><span data-stu-id="9e350-208">5. The service streams data to the user.</span></span> 

<span data-ttu-id="9e350-209">Sommige verwerking van de toepassing optreden hier.</span><span class="sxs-lookup"><span data-stu-id="9e350-209">Some processing of the application may occur here.</span></span> <span data-ttu-id="9e350-210">Als u toepassingsproxy headers omzetten of URL's in uw toepassing hebt geconfigureerd, gebeurt dat verwerking zo nodig tijdens deze stap.</span><span class="sxs-lookup"><span data-stu-id="9e350-210">If you configured Application Proxy to translate headers or URLs in your application, that processing happens as needed during this step.</span></span>


## <a name="next-steps"></a><span data-ttu-id="9e350-211">Volgende stappen</span><span class="sxs-lookup"><span data-stu-id="9e350-211">Next steps</span></span>

[<span data-ttu-id="9e350-212">Netwerk topologie overwegingen bij het gebruik van Azure AD-toepassingsproxy</span><span class="sxs-lookup"><span data-stu-id="9e350-212">Network topology considerations when using Azure AD Application Proxy</span></span>](application-proxy-network-topology-considerations.md)

[<span data-ttu-id="9e350-213">Azure AD-toepassingsproxy connectors begrijpen</span><span class="sxs-lookup"><span data-stu-id="9e350-213">Understand Azure AD Application Proxy connectors</span></span>](application-proxy-understand-connectors.md)
