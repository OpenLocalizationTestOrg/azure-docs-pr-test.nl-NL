---
title: 'Azure AD Connect: Hoe toorecover van 10GB LocalDB beperken probleem | Microsoft Docs'
description: Dit onderwerp wordt beschreven hoe toorecover Azure AD Connect-synchronisatie Service zodra het LocalDB 10GB probleem beperken.
services: active-directory
documentationcenter: 
author: cychua
manager: femila
editor: 
ms.assetid: 41d081af-ed89-4e17-be34-14f7e80ae358
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/17/2017
ms.author: billmath
ms.openlocfilehash: 7b8ce6e19b68837639017bb0315eda4b924d525a
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 10/06/2017
---
# <a name="azure-ad-connect-how-toorecover-from-localdb-10-gb-limit"></a><span data-ttu-id="ce560-103">Azure AD Connect: Hoe toorecover van 10 GB-limiet LocalDB</span><span class="sxs-lookup"><span data-stu-id="ce560-103">Azure AD Connect: How toorecover from LocalDB 10-GB limit</span></span>
<span data-ttu-id="ce560-104">Azure AD Connect vereist een SQL Server-database toostore identity-gegevens.</span><span class="sxs-lookup"><span data-stu-id="ce560-104">Azure AD Connect requires a SQL Server database toostore identity data.</span></span> <span data-ttu-id="ce560-105">Hallo-standaard die SQL Server 2012 Express LocalDB met Azure AD Connect geïnstalleerd of uw eigen volledig SQL gebruiken.</span><span class="sxs-lookup"><span data-stu-id="ce560-105">You can either use hello default SQL Server 2012 Express LocalDB installed with Azure AD Connect or use your own full SQL.</span></span> <span data-ttu-id="ce560-106">Voor SQL Server Express geldt een limiet van 10 GB.</span><span class="sxs-lookup"><span data-stu-id="ce560-106">SQL Server Express imposes a 10-GB size limit.</span></span> <span data-ttu-id="ce560-107">Wanneer u LocalDB gebruikt en deze limiet is bereikt, kan de Azure AD Connect-synchronisatieservice niet langer starten of goed synchroniseren.</span><span class="sxs-lookup"><span data-stu-id="ce560-107">When using LocalDB and this limit is reached, Azure AD Connect Synchronization Service can no longer start or synchronize properly.</span></span> <span data-ttu-id="ce560-108">In dit artikel biedt herstelstappen Hallo.</span><span class="sxs-lookup"><span data-stu-id="ce560-108">This article provides hello recovery steps.</span></span>

## <a name="symptoms"></a><span data-ttu-id="ce560-109">Symptomen</span><span class="sxs-lookup"><span data-stu-id="ce560-109">Symptoms</span></span>
<span data-ttu-id="ce560-110">Er zijn twee algemene symptomen:</span><span class="sxs-lookup"><span data-stu-id="ce560-110">There are two common symptoms:</span></span>

* <span data-ttu-id="ce560-111">Azure AD Connect-synchronisatieservice **wordt uitgevoerd** maar mislukt toosynchronize met *'gestopt-database-schijf-volledig'* fout.</span><span class="sxs-lookup"><span data-stu-id="ce560-111">Azure AD Connect Synchronization Service **is running** but fails toosynchronize with *“stopped-database-disk-full”* error.</span></span>

* <span data-ttu-id="ce560-112">Azure AD Connect-synchronisatieservice **niet kan toostart is**.</span><span class="sxs-lookup"><span data-stu-id="ce560-112">Azure AD Connect Synchronization Service **is unable toostart**.</span></span> <span data-ttu-id="ce560-113">Wanneer u toostart Hallo service probeert, mislukt met de gebeurtenis 6323 en foutbericht *"Hallo-server een fout opgetreden omdat SQL Server geen schijfruimte meer heeft."*</span><span class="sxs-lookup"><span data-stu-id="ce560-113">When you attempt toostart hello service, it fails with event 6323 and error message *"hello server encountered an error because SQL Server is out of disk space."*</span></span>

## <a name="short-term-recovery-steps"></a><span data-ttu-id="ce560-114">Korte termijn herstelstappen</span><span class="sxs-lookup"><span data-stu-id="ce560-114">Short-term recovery steps</span></span>
<span data-ttu-id="ce560-115">Deze sectie bevat Hallo stappen tooreclaim DB ruimte nodig voor Azure AD Connect-synchronisatieservice tooresume bewerking.</span><span class="sxs-lookup"><span data-stu-id="ce560-115">This section provides hello steps tooreclaim DB space required for Azure AD Connect Synchronization Service tooresume operation.</span></span> <span data-ttu-id="ce560-116">Hallo stappen omvatten:</span><span class="sxs-lookup"><span data-stu-id="ce560-116">hello steps include:</span></span>
1. [<span data-ttu-id="ce560-117">Hallo-synchronisatieservice status bepalen</span><span class="sxs-lookup"><span data-stu-id="ce560-117">Determine hello Synchronization Service status</span></span>](#determine-the-synchronization-service-status)
2. [<span data-ttu-id="ce560-118">Hallo database verkleinen</span><span class="sxs-lookup"><span data-stu-id="ce560-118">Shrink hello database</span></span>](#shrink-the-database)
3. [<span data-ttu-id="ce560-119">Uitvoeren van de gegevens van geschiedenis verwijderen</span><span class="sxs-lookup"><span data-stu-id="ce560-119">Delete run history data</span></span>](#delete-run-history-data)
4. [<span data-ttu-id="ce560-120">Geef een kortere bewaarperiode voor gegevens van de geschiedenis uitvoeren</span><span class="sxs-lookup"><span data-stu-id="ce560-120">Shorten retention period for run history data</span></span>](#shorten-retention-period-for-run-history-data)

### <a name="determine-hello-synchronization-service-status"></a><span data-ttu-id="ce560-121">Hallo-synchronisatieservice status bepalen</span><span class="sxs-lookup"><span data-stu-id="ce560-121">Determine hello Synchronization Service status</span></span>
<span data-ttu-id="ce560-122">Bepaal eerst of er nog steeds Hallo Synchronization Service wordt uitgevoerd of niet:</span><span class="sxs-lookup"><span data-stu-id="ce560-122">First, determine whether hello Synchronization Service is still running or not:</span></span>

1. <span data-ttu-id="ce560-123">Aanmelden tooyour Azure AD Connect-server als beheerder.</span><span class="sxs-lookup"><span data-stu-id="ce560-123">Log in tooyour Azure AD Connect server as administrator.</span></span>

2. <span data-ttu-id="ce560-124">Ga te**Service Control Manager**.</span><span class="sxs-lookup"><span data-stu-id="ce560-124">Go too**Service Control Manager**.</span></span>

3. <span data-ttu-id="ce560-125">Controleer de status van Hallo **Microsoft Azure AD Sync**.</span><span class="sxs-lookup"><span data-stu-id="ce560-125">Check hello status of **Microsoft Azure AD Sync**.</span></span>


4. <span data-ttu-id="ce560-126">Als deze wordt uitgevoerd, geen stoppen of Hallo-service opnieuw starten.</span><span class="sxs-lookup"><span data-stu-id="ce560-126">If it is running, do not stop or restart hello service.</span></span> <span data-ttu-id="ce560-127">Overslaan [verkleinen Hallo database](#shrink-the-database) stap en ga te[verwijderen uitvoeren geschiedenisgegevens](#delete-run-history-data) stap.</span><span class="sxs-lookup"><span data-stu-id="ce560-127">Skip [Shrink hello database](#shrink-the-database) step and go too[Delete run history data](#delete-run-history-data) step.</span></span>

5. <span data-ttu-id="ce560-128">Als deze niet wordt uitgevoerd, probeert u toostart Hallo-service.</span><span class="sxs-lookup"><span data-stu-id="ce560-128">If it is not running, try toostart hello service.</span></span> <span data-ttu-id="ce560-129">Als het Hallo-service is gestart, gaat u verder [verkleinen Hallo database](#shrink-the-database) stap en ga te[verwijderen uitvoeren geschiedenisgegevens](#delete-run-history-data) stap.</span><span class="sxs-lookup"><span data-stu-id="ce560-129">If hello service starts successfully, skip [Shrink hello database](#shrink-the-database) step and go too[Delete run history data](#delete-run-history-data) step.</span></span> <span data-ttu-id="ce560-130">Ga anders verder met [verkleinen Hallo database](#shrink-the-database) stap.</span><span class="sxs-lookup"><span data-stu-id="ce560-130">Otherwise, continue with [Shrink hello database](#shrink-the-database) step.</span></span>

### <a name="shrink-hello-database"></a><span data-ttu-id="ce560-131">Hallo database verkleinen</span><span class="sxs-lookup"><span data-stu-id="ce560-131">Shrink hello database</span></span>
<span data-ttu-id="ce560-132">Hallo verkleinen bewerking toofree up voldoende DB ruimte toostart Hallo Synchronization Service gebruiken.</span><span class="sxs-lookup"><span data-stu-id="ce560-132">Use hello Shrink operation toofree up enough DB space toostart hello Synchronization Service.</span></span> <span data-ttu-id="ce560-133">Het vrijgemaakt DB-ruimte door het verwijderen van spaties in Hallo-database.</span><span class="sxs-lookup"><span data-stu-id="ce560-133">It frees up DB space by removing whitespaces in hello database.</span></span> <span data-ttu-id="ce560-134">Deze stap is best-effort als is er geen garantie dat u altijd ruimte kunt herstellen.</span><span class="sxs-lookup"><span data-stu-id="ce560-134">This step is best-effort as it is not guaranteed that you can always recover space.</span></span> <span data-ttu-id="ce560-135">toolearn meer informatie over de verkleiningsbewerking, Lees dit artikel [verkleinen van een database](https://msdn.microsoft.com/library/ms189035.aspx).</span><span class="sxs-lookup"><span data-stu-id="ce560-135">toolearn more about Shrink operation, read this article [Shrink a database](https://msdn.microsoft.com/library/ms189035.aspx).</span></span>

> [!IMPORTANT]
> <span data-ttu-id="ce560-136">Deze stap overslaan als u Hallo synchronisatieservice toorun krijgt.</span><span class="sxs-lookup"><span data-stu-id="ce560-136">Skip this step if you can get hello Synchronization Service toorun.</span></span> <span data-ttu-id="ce560-137">Het is tooshrink Hallo SQL-database niet aanbevolen omdat dit ertoe toopoor upprestaties vanwege tooincreased fragmentatie leiden kan.</span><span class="sxs-lookup"><span data-stu-id="ce560-137">It is not recommended tooshrink hello SQL DB as it can lead toopoor performance due tooincreased fragmentation.</span></span>

<span data-ttu-id="ce560-138">Hallo-naam van het Hallo-database gemaakt voor Azure AD Connect is **ADSync**.</span><span class="sxs-lookup"><span data-stu-id="ce560-138">hello name of hello database created for Azure AD Connect is **ADSync**.</span></span> <span data-ttu-id="ce560-139">een verkleiningsbewerking tooperform, u moet zich aanmelden als Hallo sysadmin of de DBO van Hallo-database.</span><span class="sxs-lookup"><span data-stu-id="ce560-139">tooperform a Shrink operation, you must log in either as hello sysadmin or DBO of hello database.</span></span> <span data-ttu-id="ce560-140">Tijdens de installatie van Azure AD Connect Hallo na accounts sysadmin-rechten krijgen:</span><span class="sxs-lookup"><span data-stu-id="ce560-140">During Azure AD Connect installation, hello following accounts are granted sysadmin rights:</span></span>
* <span data-ttu-id="ce560-141">Lokale beheerders</span><span class="sxs-lookup"><span data-stu-id="ce560-141">Local Administrators</span></span>
* <span data-ttu-id="ce560-142">Hallo-gebruikersaccount dat gebruikt toorun Azure AD Connect-installatie is.</span><span class="sxs-lookup"><span data-stu-id="ce560-142">hello user account that was used toorun Azure AD Connect installation.</span></span>
* <span data-ttu-id="ce560-143">Hallo Sync-serviceaccount die wordt gebruikt als Hallo context van Azure AD Connect-synchronisatieservice besturingssysteem.</span><span class="sxs-lookup"><span data-stu-id="ce560-143">hello Sync Service account that is used as hello operating context of Azure AD Connect Synchronization Service.</span></span>
* <span data-ttu-id="ce560-144">Hallo lokale groep ADSyncAdmins die is gemaakt tijdens de installatie.</span><span class="sxs-lookup"><span data-stu-id="ce560-144">hello local group ADSyncAdmins that was created during installation.</span></span>

1. <span data-ttu-id="ce560-145">Maak een back-up van database door te kopiëren Hallo **ADSync.mdf** en **ADSync_log.ldf** bestanden onder `%ProgramFiles%\program files\Microsoft Azure AD Sync\Data` tooa veilige locatie.</span><span class="sxs-lookup"><span data-stu-id="ce560-145">Back up hello database by copying **ADSync.mdf** and **ADSync_log.ldf** files located under `%ProgramFiles%\program files\Microsoft Azure AD Sync\Data` tooa safe location.</span></span>

2. <span data-ttu-id="ce560-146">Start een nieuwe PowerShell-sessie.</span><span class="sxs-lookup"><span data-stu-id="ce560-146">Start a new PowerShell session.</span></span>

3. <span data-ttu-id="ce560-147">Navigeer toofolder `%ProgramFiles%\Program Files\Microsoft SQL Server\110\Tools\Binn`.</span><span class="sxs-lookup"><span data-stu-id="ce560-147">Navigate toofolder `%ProgramFiles%\Program Files\Microsoft SQL Server\110\Tools\Binn`.</span></span>

4. <span data-ttu-id="ce560-148">Start **sqlcmd** hulpprogramma met Hallo opdracht `./SQLCMD.EXE -S “(localdb)\.\ADSync” -U <Username> -P <Password>`, met behulp van Hallo referentie van een sysadmin of Hallo database DBO.</span><span class="sxs-lookup"><span data-stu-id="ce560-148">Start **sqlcmd** utility by running hello command `./SQLCMD.EXE -S “(localdb)\.\ADSync” -U <Username> -P <Password>`, using hello credential of a sysadmin or hello database DBO.</span></span>

5. <span data-ttu-id="ce560-149">tooshrink Hallo-database, op Hallo sqlcmd-opdrachtprompt (1 >), voer `DBCC Shrinkdatabase(ADSync,1);`, gevolgd door `GO` in de volgende regel Hallo.</span><span class="sxs-lookup"><span data-stu-id="ce560-149">tooshrink hello database, at hello sqlcmd prompt (1>), enter `DBCC Shrinkdatabase(ADSync,1);`, followed by `GO` in hello next line.</span></span>

6. <span data-ttu-id="ce560-150">Als het Hallo-bewerking is voltooid, probeer het opnieuw toostart Hallo-synchronisatieservice.</span><span class="sxs-lookup"><span data-stu-id="ce560-150">If hello operation is successful, try toostart hello Synchronization Service again.</span></span> <span data-ttu-id="ce560-151">Als u Hallo-synchronisatieservice starten kunt, gaat u verder te[verwijderen uitvoeren geschiedenisgegevens](#delete-run-history-data) stap.</span><span class="sxs-lookup"><span data-stu-id="ce560-151">If you can start hello Synchronization Service, go too[Delete run history data](#delete-run-history-data) step.</span></span> <span data-ttu-id="ce560-152">Als dat niet het geval is, moet u contact op met ondersteuning.</span><span class="sxs-lookup"><span data-stu-id="ce560-152">If not, contact Support.</span></span>

### <a name="delete-run-history-data"></a><span data-ttu-id="ce560-153">Uitvoeren van de gegevens van geschiedenis verwijderen</span><span class="sxs-lookup"><span data-stu-id="ce560-153">Delete run history data</span></span>
<span data-ttu-id="ce560-154">Standaard behoudt Azure AD Connect up tooseven dagen van de uitvoeringsgeschiedenis gegevens.</span><span class="sxs-lookup"><span data-stu-id="ce560-154">By default, Azure AD Connect retains up tooseven days’ worth of run history data.</span></span> <span data-ttu-id="ce560-155">In deze stap verwijderen we Hallo geschiedenis tooreclaim DB gegevensruimte uitvoeren zodat Azure AD Connect-synchronisatieservice synchroniseren opnieuw kunt starten.</span><span class="sxs-lookup"><span data-stu-id="ce560-155">In this step, we delete hello run history data tooreclaim DB space so that Azure AD Connect Synchronization Service can start syncing again.</span></span>

1.  <span data-ttu-id="ce560-156">Start **Synchronization Service Manager** door te gaan tooSTART → Synchronization-Service.</span><span class="sxs-lookup"><span data-stu-id="ce560-156">Start **Synchronization Service Manager** by going tooSTART → Synchronization Service.</span></span>

2.  <span data-ttu-id="ce560-157">Ga toohello **Operations** tabblad.</span><span class="sxs-lookup"><span data-stu-id="ce560-157">Go toohello **Operations** tab.</span></span>

3.  <span data-ttu-id="ce560-158">Onder **acties**, selecteer **wissen wordt uitgevoerd**...</span><span class="sxs-lookup"><span data-stu-id="ce560-158">Under **Actions**, select **Clear Runs**…</span></span>

4.  <span data-ttu-id="ce560-159">U kunt kiezen **wissen van alle sessies** of **wissen wordt uitgevoerd voordat er... <date>**  optie.</span><span class="sxs-lookup"><span data-stu-id="ce560-159">You can either choose **Clear all runs** or **Clear runs before… <date>** option.</span></span> <span data-ttu-id="ce560-160">Het wordt aanbevolen dat u start door het wissen van gegevens van geschiedenis die ouder dan twee dagen zijn worden uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="ce560-160">It is recommended that you start by clearing run history data that are older than two days.</span></span> <span data-ttu-id="ce560-161">Als u toorun in DB grootte probleem doorgaat, en kies vervolgens Hallo **wissen van alle sessies** optie.</span><span class="sxs-lookup"><span data-stu-id="ce560-161">If you continue toorun into DB size issue, then choose hello **Clear all runs** option.</span></span>

### <a name="shorten-retention-period-for-run-history-data"></a><span data-ttu-id="ce560-162">Geef een kortere bewaarperiode voor gegevens van de geschiedenis uitvoeren</span><span class="sxs-lookup"><span data-stu-id="ce560-162">Shorten retention period for run history data</span></span>
<span data-ttu-id="ce560-163">Deze stap is de kans op tooreduce Hallo na meerdere synchronisatiecycli die worden uitgevoerd in Hallo limiet van 10 GB probleem.</span><span class="sxs-lookup"><span data-stu-id="ce560-163">This step is tooreduce hello likelihood of running into hello 10-GB limit issue after multiple sync cycles.</span></span>

1. <span data-ttu-id="ce560-164">Open een nieuw PowerShell-sessie.</span><span class="sxs-lookup"><span data-stu-id="ce560-164">Open a new PowerShell session.</span></span>

2. <span data-ttu-id="ce560-165">Voer `Get-ADSyncScheduler` en noteer Hallo PurgeRunHistoryInterval eigenschap, waarmee de huidige bewaarperiode Hallo.</span><span class="sxs-lookup"><span data-stu-id="ce560-165">Run `Get-ADSyncScheduler` and take note of hello PurgeRunHistoryInterval property, which specifies hello current retention period.</span></span>

3. <span data-ttu-id="ce560-166">Voer `Set-ADSyncScheduler -PurgeRunHistoryInterval 2.00:00:00` tooset Hallo bewaren periode tootwo dagen.</span><span class="sxs-lookup"><span data-stu-id="ce560-166">Run `Set-ADSyncScheduler -PurgeRunHistoryInterval 2.00:00:00` tooset hello retention period tootwo days.</span></span> <span data-ttu-id="ce560-167">Pas de bewaarperiode Hallo naar gelang van toepassing.</span><span class="sxs-lookup"><span data-stu-id="ce560-167">Adjust hello retention period as appropriate.</span></span>

## <a name="long-term-solution--migrate-toofull-sql"></a><span data-ttu-id="ce560-168">Op lange termijn oplossing: migreren toofull SQL</span><span class="sxs-lookup"><span data-stu-id="ce560-168">Long-term solution – Migrate toofull SQL</span></span>
<span data-ttu-id="ce560-169">In het algemeen Hallo probleem indicatief 10 GB-databasegrootte is niet meer voldoende voor Azure AD Connect toosynchronize is uw lokale Active Directory tooAzure AD.</span><span class="sxs-lookup"><span data-stu-id="ce560-169">In general, hello issue is indicative that 10-GB database size is no longer sufficient for Azure AD Connect toosynchronize your on-premises Active Directory tooAzure AD.</span></span> <span data-ttu-id="ce560-170">Het is raadzaam dat u overschakelt naar toousing Hallo volledige versie van SQL server.</span><span class="sxs-lookup"><span data-stu-id="ce560-170">It is recommended that you switch toousing hello full version of SQL server.</span></span> <span data-ttu-id="ce560-171">U vervangen niet rechtstreeks Hallo LocalDB van een bestaande implementatie van Azure AD Connect door Hallo Hallo volledige versie van SQL database.</span><span class="sxs-lookup"><span data-stu-id="ce560-171">You cannot directly replace hello LocalDB of an existing Azure AD Connect deployment with hello database of hello full version of SQL.</span></span> <span data-ttu-id="ce560-172">In plaats daarvan moet u een nieuwe Azure AD Connect-server met volledige versie van SQL Hallo implementeren.</span><span class="sxs-lookup"><span data-stu-id="ce560-172">Instead, you must deploy a new Azure AD Connect server with hello full version of SQL.</span></span> <span data-ttu-id="ce560-173">Het is raadzaam dat u een swing migratie uitvoeren waarbij Hallo nieuwe Azure AD Connect-server (met SQL database) wordt geïmplementeerd als een testserver, volgende toohello bestaande Azure AD Connect-server (met LocalDB).</span><span class="sxs-lookup"><span data-stu-id="ce560-173">It is recommended that you do a swing migration where hello new Azure AD Connect server (with SQL DB) is deployed as a staging server, next toohello existing Azure AD Connect server (with LocalDB).</span></span> 
* <span data-ttu-id="ce560-174">Voor instructies over hoe tooconfigure externe SQL met Azure AD Connect verwijzen tooarticle [aangepaste installatie van Azure AD Connect](https://docs.microsoft.com/azure/active-directory/connect/active-directory-aadconnect-get-started-custom).</span><span class="sxs-lookup"><span data-stu-id="ce560-174">For instruction on how tooconfigure remote SQL with Azure AD Connect, refer tooarticle [Custom installation of Azure AD Connect](https://docs.microsoft.com/azure/active-directory/connect/active-directory-aadconnect-get-started-custom).</span></span>
* <span data-ttu-id="ce560-175">Raadpleeg voor instructies voor migratie voor een upgrade voor Azure AD Connect swing tooarticle [Azure AD Connect: upgraden van een vorige versie-toohello recente](https://docs.microsoft.com/azure/active-directory/connect/active-directory-aadconnect-upgrade-previous-version#swing-migration).</span><span class="sxs-lookup"><span data-stu-id="ce560-175">For instructions on swing migration for Azure AD Connect upgrade, refer tooarticle [Azure AD Connect: Upgrade from a previous version toohello latest](https://docs.microsoft.com/azure/active-directory/connect/active-directory-aadconnect-upgrade-previous-version#swing-migration).</span></span>

## <a name="next-steps"></a><span data-ttu-id="ce560-176">Volgende stappen</span><span class="sxs-lookup"><span data-stu-id="ce560-176">Next steps</span></span>
<span data-ttu-id="ce560-177">Lees meer over het [integreren van uw on-premises identiteiten met Azure Active Directory](active-directory-aadconnect.md).</span><span class="sxs-lookup"><span data-stu-id="ce560-177">Learn more about [Integrating your on-premises identities with Azure Active Directory](active-directory-aadconnect.md).</span></span>
