---
title: aaaDefragmentation van metrische gegevens in Azure Service Fabric | Microsoft Docs
description: Een overzicht van defragmentatie gebruiken of als een strategie voor metrische gegevens in Service Fabric verpakken
services: service-fabric
documentationcenter: .net
author: masnider
manager: timlt
editor: 
ms.assetid: e5ebfae5-c8f7-4d6c-9173-3e22a9730552
ms.service: Service-Fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 08/18/2017
ms.author: masnider
ms.openlocfilehash: d09045a6cf196d2771f1a0794637f4579d3eb96b
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 10/06/2017
---
# <a name="defragmentation-of-metrics-and-load-in-service-fabric"></a><span data-ttu-id="23994-103">Defragmentatie van metrische gegevens en de belasting in Service Fabric</span><span class="sxs-lookup"><span data-stu-id="23994-103">Defragmentation of metrics and load in Service Fabric</span></span>
<span data-ttu-id="23994-104">Hallo Service Fabric Cluster Resource Manager standaard strategie voor het beheren van metrische gegevens laden in het Hallo-cluster is de toodistribute Hallo belasting.</span><span class="sxs-lookup"><span data-stu-id="23994-104">hello Service Fabric Cluster Resource Manager's default strategy for managing load metrics in hello cluster is toodistribute hello load.</span></span> <span data-ttu-id="23994-105">Ervoor te zorgen dat de knooppunten gelijkmatig worden gebruikt, voorkomt warme en koude plaatsen die tooboth conflicten en verspilde bronnen leiden.</span><span class="sxs-lookup"><span data-stu-id="23994-105">Ensuring that nodes are evenly utilized avoids hot and cold spots that lead tooboth contention and wasted resources.</span></span> <span data-ttu-id="23994-106">Distributie van werkbelastingen in Hallo-cluster is ook Hallo veiligste in termen van functionerende fouten omdat Hiermee zorgt u ervoor dat een fout wordt pas uit een groot percentage van een bepaalde werkbelasting.</span><span class="sxs-lookup"><span data-stu-id="23994-106">Distributing workloads in hello cluster is also hello safest in terms of surviving failures since it ensures that a failure doesn’t take out a large percentage of a given workload.</span></span> 

<span data-ttu-id="23994-107">Hallo Service Fabric-Cluster Resource Manager biedt ondersteuning voor een andere strategie voor het beheren van belasting, namelijk defragmentatie.</span><span class="sxs-lookup"><span data-stu-id="23994-107">hello Service Fabric Cluster Resource Manager does support a different strategy for managing load, which is defragmentation.</span></span> <span data-ttu-id="23994-108">Defragmentatie betekent dat in plaats van toodistribute Hallo gebruik van een metriek probeert over Hallo-cluster, het geconsolideerd.</span><span class="sxs-lookup"><span data-stu-id="23994-108">Defragmentation means that instead of trying toodistribute hello utilization of a metric across hello cluster, it is consolidated.</span></span> <span data-ttu-id="23994-109">Consolidatie is slechts een omkering van Hallo standaard strategie – in plaats van voor het minimaliseren van gemiddelde standaardafwijking Hallo van metrische load balancing, Hallo Cluster Resource Manager probeert tooincrease deze.</span><span class="sxs-lookup"><span data-stu-id="23994-109">Consolidation is just an inversion of hello default balancing strategy – instead of minimizing hello average standard deviation of metric load, hello Cluster Resource Manager tries tooincrease it.</span></span>

## <a name="when-toouse-defragmentation"></a><span data-ttu-id="23994-110">Wanneer de defragmentatie toouse</span><span class="sxs-lookup"><span data-stu-id="23994-110">When toouse defragmentation</span></span>
<span data-ttu-id="23994-111">Laden in het cluster Hallo distribueren verbruikt aantal Hallo bronnen op elk knooppunt.</span><span class="sxs-lookup"><span data-stu-id="23994-111">Distributing load in hello cluster consumes some of hello resources on each node.</span></span> <span data-ttu-id="23994-112">Sommige werkbelastingen maken van services die uitzonderlijk groot en gebruiken van de meeste of alle van een knooppunt.</span><span class="sxs-lookup"><span data-stu-id="23994-112">Some workloads create services that are exceptionally large and consume most or all of a node.</span></span> <span data-ttu-id="23994-113">In deze gevallen is het mogelijk dat wanneer er grote werkbelastingen ophalen gemaakt die er niet genoeg ruimte vrij op elk knooppunt toorun ze.</span><span class="sxs-lookup"><span data-stu-id="23994-113">In these cases, it's possible that when there are large workloads getting created that there isn't enough space on any node toorun them.</span></span> <span data-ttu-id="23994-114">Grote werkbelastingen zijn niet van een probleem in Service Fabric; in deze gevallen Hallo bepaalt Cluster Resource Manager dat het moet tooreorganize Hallo cluster toomake ruimte voor deze grote werkbelasting.</span><span class="sxs-lookup"><span data-stu-id="23994-114">Large workloads aren't a problem in Service Fabric; in these cases hello Cluster Resource Manager determines that it needs tooreorganize hello cluster toomake room for this large workload.</span></span> <span data-ttu-id="23994-115">In Hallo tussentijd heeft werkbelasting echter toowait toobe gepland in Hallo-cluster.</span><span class="sxs-lookup"><span data-stu-id="23994-115">However, in hello meantime that workload has toowait toobe scheduled in hello cluster.</span></span>

<span data-ttu-id="23994-116">Als er veel services en status toomove rond, kan klikt u vervolgens het lang duren voor Hallo grote werkbelasting toobe in Hallo cluster geplaatst.</span><span class="sxs-lookup"><span data-stu-id="23994-116">If there are many services and state toomove around, then it could take a long time for hello large workload toobe placed in hello cluster.</span></span> <span data-ttu-id="23994-117">Dit is het waarschijnlijker als andere werkbelastingen in Hallo cluster ook grote zijn en dus tooreorganize langer duren.</span><span class="sxs-lookup"><span data-stu-id="23994-117">This is more likely if other workloads in hello cluster are also large and so take longer tooreorganize.</span></span> <span data-ttu-id="23994-118">Hallo Service Fabric-team gemeten maken keer simulaties van dit scenario.</span><span class="sxs-lookup"><span data-stu-id="23994-118">hello Service Fabric team measured creation times in simulations of this scenario.</span></span> <span data-ttu-id="23994-119">We vinden dat grote services maken veel langer duurde zodra clustergebruik kreeg hierboven tussen 30 en 50%.</span><span class="sxs-lookup"><span data-stu-id="23994-119">We found that creating large services took much longer as soon as cluster utilization got above between 30% and 50%.</span></span> <span data-ttu-id="23994-120">toohandle dit scenario wordt er defragmentatie als een strategie voor taakverdeling zijn geïntroduceerd.</span><span class="sxs-lookup"><span data-stu-id="23994-120">toohandle this scenario, we introduced defragmentation as a balancing strategy.</span></span> <span data-ttu-id="23994-121">We vinden dat voor grote werkbelastingen, met name zijn waarop Aanmaaktijd belangrijk is, defragmentatie echt geholpen bij deze nieuwe werkbelastingen ophalen gepland in Hallo-cluster.</span><span class="sxs-lookup"><span data-stu-id="23994-121">We found that for large workloads, especially ones where creation time was important, defragmentation really helped those new workloads get scheduled in hello cluster.</span></span>

<span data-ttu-id="23994-122">U kunt Defragmentatie metrische gegevens toohave Hallo Cluster Resource Manager tooproactively probeer toocondense Hallo belasting van Hallo services configureren in minder knooppunten.</span><span class="sxs-lookup"><span data-stu-id="23994-122">You can configure defragmentation metrics toohave hello Cluster Resource Manager tooproactively try toocondense hello load of hello services into fewer nodes.</span></span> <span data-ttu-id="23994-123">Dit zorgt ervoor dat er is bijna altijd ruimte voor grote services zonder te ordenen Hallo cluster.</span><span class="sxs-lookup"><span data-stu-id="23994-123">This helps ensure that there is almost always room for large services without reorganizing hello cluster.</span></span> <span data-ttu-id="23994-124">Niet met tooreorganize Hallo cluster, kunt snel grote werkbelastingen maken.</span><span class="sxs-lookup"><span data-stu-id="23994-124">Not having tooreorganize hello cluster allows creating large workloads quickly.</span></span>

<span data-ttu-id="23994-125">De meeste mensen hoeft niet defragmentatie.</span><span class="sxs-lookup"><span data-stu-id="23994-125">Most people don’t need defragmentation.</span></span> <span data-ttu-id="23994-126">Services zijn meestal worden klein, dus niet harde toofind ruimte voor hen in Hallo-cluster.</span><span class="sxs-lookup"><span data-stu-id="23994-126">Services are usually be small, so it’s not hard toofind room for them in hello cluster.</span></span> <span data-ttu-id="23994-127">Wanneer de reorganisatie mogelijk is, gaat snel, omdat de meeste services klein zijn en snel en parallel kunnen worden verplaatst.</span><span class="sxs-lookup"><span data-stu-id="23994-127">When reorganization is possible, it goes quickly, again because most services are small and can be moved quickly and in parallel.</span></span> <span data-ttu-id="23994-128">Als u grote services hebt en ze snel gemaakt moet en Hallo is defragmentatie strategie voor u.</span><span class="sxs-lookup"><span data-stu-id="23994-128">However, if you have large services and need them created quickly then hello defragmentation strategy is for you.</span></span> <span data-ttu-id="23994-129">We bespreken Hallo-en nadelen van het gebruik van defragmentatie vervolgens.</span><span class="sxs-lookup"><span data-stu-id="23994-129">We'll discuss hello tradeoffs of using defragmentation next.</span></span> 

## <a name="defragmentation-tradeoffs"></a><span data-ttu-id="23994-130">Defragmentatie-en nadelen</span><span class="sxs-lookup"><span data-stu-id="23994-130">Defragmentation tradeoffs</span></span>
<span data-ttu-id="23994-131">Defragmentatie kunt impactfulness van fouten, verhogen omdat meer services die worden uitgevoerd op knooppunten die niet voldoen aan.</span><span class="sxs-lookup"><span data-stu-id="23994-131">Defragmentation can increase impactfulness of failures, since more services are running on nodes that fail.</span></span> <span data-ttu-id="23994-132">Defragmentatie kan ook kosten, verhogen omdat bronnen in Hallo cluster deel van reserve uitmaken moeten, wachten op Hallo maken van een grote werkbelastingen.</span><span class="sxs-lookup"><span data-stu-id="23994-132">Defragmentation can also increase costs, since resources in hello cluster must be held in reserve, waiting for hello creation of large workloads.</span></span>

<span data-ttu-id="23994-133">Hallo biedt volgende diagram een visuele representatie van twee clusters, één dat wordt gedefragmenteerd en één die niet.</span><span class="sxs-lookup"><span data-stu-id="23994-133">hello following diagram gives a visual representation of two clusters, one that is defragmented and one that is not.</span></span> 

<span data-ttu-id="23994-134"><center>
![Vergelijken met gelijke taakverdeling en gedefragmenteerd Clusters][Image1]
</center></span><span class="sxs-lookup"><span data-stu-id="23994-134"><center>
![Comparing Balanced and Defragmented Clusters][Image1]
</center></span></span>

<span data-ttu-id="23994-135">Overweeg het aantal verplaatsingen van het type die nodig zijn tooplace een van de grootste serviceobjecten Hallo Hallo in geval van Hallo met gelijke taakverdeling.</span><span class="sxs-lookup"><span data-stu-id="23994-135">In hello balanced case, consider hello number of movements that would be necessary tooplace one of hello largest service objects.</span></span> <span data-ttu-id="23994-136">In Hallo gedefragmenteerde cluster kan Hallo grote werkbelasting worden geplaatst op knooppunten vier of vijf zonder toowait voor alle andere services toomove.</span><span class="sxs-lookup"><span data-stu-id="23994-136">In hello defragmented cluster, hello large workload could be placed on nodes four or five without having toowait for any other services toomove.</span></span>

## <a name="defragmentation-pros-and-cons"></a><span data-ttu-id="23994-137">Defragmentatie voor- en nadelen</span><span class="sxs-lookup"><span data-stu-id="23994-137">Defragmentation pros and cons</span></span>
<span data-ttu-id="23994-138">Wat zijn zodat deze conceptuele optimalisatie?</span><span class="sxs-lookup"><span data-stu-id="23994-138">So what are those other conceptual tradeoffs?</span></span> <span data-ttu-id="23994-139">Dit is een snelle tabel met dingen toothink over:</span><span class="sxs-lookup"><span data-stu-id="23994-139">Here’s a quick table of things toothink about:</span></span>

| <span data-ttu-id="23994-140">Defragmentatie-professionals</span><span class="sxs-lookup"><span data-stu-id="23994-140">Defragmentation Pros</span></span> | <span data-ttu-id="23994-141">Defragmentatie nadelen</span><span class="sxs-lookup"><span data-stu-id="23994-141">Defragmentation Cons</span></span> |
| --- | --- |
| <span data-ttu-id="23994-142">Hiermee kunt sneller maken van grote services</span><span class="sxs-lookup"><span data-stu-id="23994-142">Allows faster creation of large services</span></span> |<span data-ttu-id="23994-143">Concentraten op minder knooppunten, verhogen conflicten laden</span><span class="sxs-lookup"><span data-stu-id="23994-143">Concentrates load onto fewer nodes, increasing contention</span></span> |
| <span data-ttu-id="23994-144">Hiermee verlagen verplaatsing van gegevens tijdens het maken van</span><span class="sxs-lookup"><span data-stu-id="23994-144">Enables lower data movement during creation</span></span> |<span data-ttu-id="23994-145">Fouten kunnen invloed meer services en meer verloop veroorzaken</span><span class="sxs-lookup"><span data-stu-id="23994-145">Failures can impact more services and cause more churn</span></span> |
| <span data-ttu-id="23994-146">Hiermee maakt u uitgebreide beschrijving van de vereisten en het vrijmaken van ruimte</span><span class="sxs-lookup"><span data-stu-id="23994-146">Allows rich description of requirements and reclamation of space</span></span> |<span data-ttu-id="23994-147">Complexere algehele Resource Management-configuratie</span><span class="sxs-lookup"><span data-stu-id="23994-147">More complex overall Resource Management configuration</span></span> |

<span data-ttu-id="23994-148">U kunt combineren gedefragmenteerde en normale metrische gegevens in hetzelfde cluster Hallo.</span><span class="sxs-lookup"><span data-stu-id="23994-148">You can mix defragmented and normal metrics in hello same cluster.</span></span> <span data-ttu-id="23994-149">Hallo Cluster Resource Manager probeert tooconsolidate Hallo defragmentatie metrische gegevens zo veel mogelijk bij het uitleggen Hallo anderen.</span><span class="sxs-lookup"><span data-stu-id="23994-149">hello Cluster Resource Manager tries tooconsolidate hello defragmentation metrics as much as possible while spreading out hello others.</span></span> <span data-ttu-id="23994-150">Hallo resultaten van de combinatie van defragmentatie en netwerktaakverdeling strategieën, is afhankelijk van verschillende factoren, waaronder:</span><span class="sxs-lookup"><span data-stu-id="23994-150">hello results of mixing defragmentation and balancing strategies depends on several factors, including:</span></span>
  - <span data-ttu-id="23994-151">Hallo aantal balancing metrische gegevens versus Hallo aantal defragmentatie metrische gegevens</span><span class="sxs-lookup"><span data-stu-id="23994-151">hello number of balancing metrics vs. hello number of defragmentation metrics</span></span>
  - <span data-ttu-id="23994-152">Hiermee wordt aangegeven of alle services maakt gebruik van beide typen metrische gegevens</span><span class="sxs-lookup"><span data-stu-id="23994-152">Whether any service uses both types of metrics</span></span> 
  - <span data-ttu-id="23994-153">Hallo metrische gewichten</span><span class="sxs-lookup"><span data-stu-id="23994-153">hello metric weights</span></span>
  - <span data-ttu-id="23994-154">huidige metrische gegevens worden geladen</span><span class="sxs-lookup"><span data-stu-id="23994-154">current metric loads</span></span>
  
<span data-ttu-id="23994-155">Experimenteren is vereist toodetermine Hallo exacte configuratie nodig.</span><span class="sxs-lookup"><span data-stu-id="23994-155">Experimentation is required toodetermine hello exact configuration necessary.</span></span> <span data-ttu-id="23994-156">Het is raadzaam grondige meting van de werkbelasting van uw voordat u Defragmentatie metrische gegevens in de productieomgeving inschakelen.</span><span class="sxs-lookup"><span data-stu-id="23994-156">We recommend thorough measurement of your workloads before you enable defragmentation metrics in production.</span></span> <span data-ttu-id="23994-157">Dit geldt met name wanneer de combinatie van defragmentatie en taakverdeling metrische gegevens binnen Hallo dezelfde service.</span><span class="sxs-lookup"><span data-stu-id="23994-157">This is especially true when mixing defragmentation and balanced metrics within hello same service.</span></span> 

## <a name="configuring-defragmentation-metrics"></a><span data-ttu-id="23994-158">Defragmentatie metrische gegevens configureren</span><span class="sxs-lookup"><span data-stu-id="23994-158">Configuring defragmentation metrics</span></span>
<span data-ttu-id="23994-159">Een globale beslissing in Hallo cluster configureren defragmentatie metrische gegevens is en afzonderlijke metrische gegevens voor defragmentatie kan worden geselecteerd.</span><span class="sxs-lookup"><span data-stu-id="23994-159">Configuring defragmentation metrics is a global decision in hello cluster, and individual metrics can be selected for defragmentation.</span></span> <span data-ttu-id="23994-160">Hallo na config codefragmenten laten zien hoe tooconfigure metrische gegevens voor defragmentatie.</span><span class="sxs-lookup"><span data-stu-id="23994-160">hello following config snippets show how tooconfigure metrics for defragmentation.</span></span> <span data-ttu-id="23994-161">In dit geval 'Metric1' geconfigureerd als een metriek defragmentatie 'Metric2' wordt verder toobe normaal gesproken met gelijke taakverdeling.</span><span class="sxs-lookup"><span data-stu-id="23994-161">In this case, "Metric1" is configured as a defragmentation metric, while "Metric2" will continue toobe balanced normally.</span></span> 

<span data-ttu-id="23994-162">ClusterManifest.xml:</span><span class="sxs-lookup"><span data-stu-id="23994-162">ClusterManifest.xml:</span></span>

```xml
<Section Name="DefragmentationMetrics">
    <Parameter Name="Metric1" Value="true" />
    <Parameter Name="Metric2" Value="false" />
</Section>
```

<span data-ttu-id="23994-163">gehoste clusters via ClusterConfig.json voor zelfstandige implementaties of Template.json voor Azure:</span><span class="sxs-lookup"><span data-stu-id="23994-163">via ClusterConfig.json for Standalone deployments or Template.json for Azure hosted clusters:</span></span>

```json
"fabricSettings": [
  {
    "name": "DefragmentationMetrics",
    "parameters": [
      {
          "name": "Metric1",
          "value": "true"
      },
      {
          "name": "Metric2",
          "value": "false"
      }
    ]
  }
]
```


## <a name="next-steps"></a><span data-ttu-id="23994-164">Volgende stappen</span><span class="sxs-lookup"><span data-stu-id="23994-164">Next steps</span></span>
- <span data-ttu-id="23994-165">Hallo Cluster Resource Manager heeft man-opties voor het beschrijven van Hallo-cluster.</span><span class="sxs-lookup"><span data-stu-id="23994-165">hello Cluster Resource Manager has man options for describing hello cluster.</span></span> <span data-ttu-id="23994-166">toofind voor meer informatie over deze Raadpleeg dit artikel op [met een beschrijving van een Service Fabric-cluster](service-fabric-cluster-resource-manager-cluster-description.md)</span><span class="sxs-lookup"><span data-stu-id="23994-166">toofind out more about them, check out this article on [describing a Service Fabric cluster](service-fabric-cluster-resource-manager-cluster-description.md)</span></span>
- <span data-ttu-id="23994-167">Metrische gegevens zijn hoe Hallo Service Fabric-Cluster Resource Manager beheert gebruiks- en capaciteit in Hallo-cluster.</span><span class="sxs-lookup"><span data-stu-id="23994-167">Metrics are how hello Service Fabric Cluster Resource Manger manages consumption and capacity in hello cluster.</span></span> <span data-ttu-id="23994-168">meer informatie over metrische gegevens toolearn en hoe tooconfigure, Bekijk [in dit artikel](service-fabric-cluster-resource-manager-metrics.md)</span><span class="sxs-lookup"><span data-stu-id="23994-168">toolearn more about metrics and how tooconfigure them, check out [this article](service-fabric-cluster-resource-manager-metrics.md)</span></span>

[Image1]:./media/service-fabric-cluster-resource-manager-defragmentation-metrics/balancing-defrag-compared.png
