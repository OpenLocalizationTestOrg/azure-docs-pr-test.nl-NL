---
title: Azure Service Fabric-noodherstel | Microsoft Docs
description: Azure Service Fabric biedt de mogelijkheden die nodig zijn om te gaan met alle soorten noodsituaties. Dit artikel wordt beschreven welke soorten noodsituaties die zich kunnen voordoen en hoe u omgaat met hen.
services: service-fabric
documentationcenter: .net
author: masnider
manager: timlt
editor: 
ms.assetid: ab49c4b9-74a8-4907-b75b-8d2ee84c6d90
ms.service: service-fabric
ms.devlang: dotNet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 08/18/2017
ms.author: masnider
ms.openlocfilehash: c44d276e26e363d7e32f42859ea66d0bcf2029ac
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 08/18/2017
---
# <a name="disaster-recovery-in-azure-service-fabric"></a><span data-ttu-id="5e664-104">Herstel na noodgevallen in Azure Service Fabric</span><span class="sxs-lookup"><span data-stu-id="5e664-104">Disaster recovery in Azure Service Fabric</span></span>
<span data-ttu-id="5e664-105">Een belangrijk onderdeel van het leveren van hoge beschikbaarheid is ervoor te zorgen dat alle soorten fouten meer services kunnen doorstaan.</span><span class="sxs-lookup"><span data-stu-id="5e664-105">A critical part of delivering high-availability is ensuring that services can survive all different types of failures.</span></span> <span data-ttu-id="5e664-106">Dit is vooral belangrijk voor fouten die niet-geplande zijn en buiten uw beheer.</span><span class="sxs-lookup"><span data-stu-id="5e664-106">This is especially important for failures that are unplanned and outside of your control.</span></span> <span data-ttu-id="5e664-107">Dit artikel worden enkele algemene fout modi die mogelijk noodsituaties als dat niet het gemodelleerd en correct worden beheerd.</span><span class="sxs-lookup"><span data-stu-id="5e664-107">This article describes some common failure modes that could be disasters if not modeled and managed correctly.</span></span> <span data-ttu-id="5e664-108">Bespreek ook oplossingen en acties moet uitvoeren als er een ramp toch opgetreden.</span><span class="sxs-lookup"><span data-stu-id="5e664-108">It also discuss mitigations and actions to take if a disaster happened anyway.</span></span> <span data-ttu-id="5e664-109">Het doel is te beperken of voorkomen van uitvaltijd of gegevensverlies wanneer ze, fouten optreden, gepland of anders optreden.</span><span class="sxs-lookup"><span data-stu-id="5e664-109">The goal is to limit or eliminate the risk of downtime or data loss when they occur failures, planned or otherwise, occur.</span></span>

## <a name="avoiding-disaster"></a><span data-ttu-id="5e664-110">Noodherstel voorkomen</span><span class="sxs-lookup"><span data-stu-id="5e664-110">Avoiding disaster</span></span>
<span data-ttu-id="5e664-111">Het voornaamste doel van de service Fabric is om te helpen u zowel uw omgeving en uw services zodanig dat algemene fout typen niet noodsituaties zijn model.</span><span class="sxs-lookup"><span data-stu-id="5e664-111">Service Fabric's primary goal is to help you model both your environment and your services in such a way that common failure types are not disasters.</span></span> 

<span data-ttu-id="5e664-112">In het algemeen zijn er twee soorten na noodgevallen/mislukte scenario's:</span><span class="sxs-lookup"><span data-stu-id="5e664-112">In general there are two types of disaster/failure scenarios:</span></span>

1. <span data-ttu-id="5e664-113">Hardware of software-fouten</span><span class="sxs-lookup"><span data-stu-id="5e664-113">Hardware or software faults</span></span>
2. <span data-ttu-id="5e664-114">Operationele fouten</span><span class="sxs-lookup"><span data-stu-id="5e664-114">Operational faults</span></span>

### <a name="hardware-and-software-faults"></a><span data-ttu-id="5e664-115">Hardware en software-fouten</span><span class="sxs-lookup"><span data-stu-id="5e664-115">Hardware and software faults</span></span>
<span data-ttu-id="5e664-116">Hardware en software fouten zijn onvoorspelbaar.</span><span class="sxs-lookup"><span data-stu-id="5e664-116">Hardware and software faults are unpredictable.</span></span> <span data-ttu-id="5e664-117">De eenvoudigste manier om te blijven functioneren fouten kan meer exemplaren van de service omspannen buiten de grenzen van de fout hardware of software wordt uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="5e664-117">The easiest way to survive faults is running more copies of the service  spanned across hardware or software fault boundaries.</span></span> <span data-ttu-id="5e664-118">Bijvoorbeeld, als uw service wordt uitgevoerd op een bepaalde computer, is mislukt of er één machine een noodgeval voor de service.</span><span class="sxs-lookup"><span data-stu-id="5e664-118">For example, if your service is running only on one particular machine, then the failure of that one machine is a disaster for that service.</span></span> <span data-ttu-id="5e664-119">Er is een eenvoudige manier om te voorkomen dat deze na noodgevallen om ervoor te zorgen dat de service daadwerkelijk wordt uitgevoerd op meerdere machines.</span><span class="sxs-lookup"><span data-stu-id="5e664-119">The simple way to avoid this disaster is to ensure that the service is actually running on multiple machines.</span></span> <span data-ttu-id="5e664-120">Testen is ook nodig om te controleren of dat het uitvallen van één machine de service niet wordt verstoord.</span><span class="sxs-lookup"><span data-stu-id="5e664-120">Testing is also necessary to ensure the failure of one machine doesn't disrupt the running service.</span></span> <span data-ttu-id="5e664-121">Plannen van capaciteit zorgt ervoor dat het exemplaar van een vervanging kan worden gemaakt elders en dat vermindering van de capaciteit van de resterende services niet overbelasting.</span><span class="sxs-lookup"><span data-stu-id="5e664-121">Capacity planning ensures a replacement instance can be created elsewhere and that reduction in capacity doesn't overload the remaining services.</span></span> <span data-ttu-id="5e664-122">Hetzelfde patroon werkt ongeacht wat u probeert om te voorkomen dat het uitvallen van.</span><span class="sxs-lookup"><span data-stu-id="5e664-122">The same pattern works regardless of what you're trying to avoid the failure of.</span></span> <span data-ttu-id="5e664-123">Bijvoorbeeld.</span><span class="sxs-lookup"><span data-stu-id="5e664-123">For example.</span></span> <span data-ttu-id="5e664-124">Als u zich zorgen over het mislukken van een SAN maakt, voert u via meerdere SAN's.</span><span class="sxs-lookup"><span data-stu-id="5e664-124">if you're concerned about the failure of a SAN, you run across multiple SANs.</span></span> <span data-ttu-id="5e664-125">Als u zich zorgen over het verlies van een rek met servers maakt, voert u via meerdere rekken.</span><span class="sxs-lookup"><span data-stu-id="5e664-125">If you're concerned about the loss of a rack of servers, you run across multiple racks.</span></span> <span data-ttu-id="5e664-126">Als u bang over het verlies van datacenters, moet uw service worden uitgevoerd op meerdere Azure-regio's of datacenters.</span><span class="sxs-lookup"><span data-stu-id="5e664-126">If you're worried about the loss of datacenters, your service should run across multiple Azure regions or datacenters.</span></span> 

<span data-ttu-id="5e664-127">Wanneer in deze modus wordt uitgevoerd, u kunt nog steeds onderworpen aan bepaalde typen gelijktijdige fouten, maar één en zelfs meerdere fouten van een bepaald type (bijvoorbeeld: een enkele virtuele machine of netwerk koppeling mislukken) automatisch worden verwerkt (en dus niet langer een 'noodgeval').</span><span class="sxs-lookup"><span data-stu-id="5e664-127">When running in this type of spanned mode, you're still subject to some types of simultaneous failures, but single and even multiple failures of a particular type (ex: a single VM or network link failing) are automatically handled (and so no longer a "disaster").</span></span> <span data-ttu-id="5e664-128">Service Fabric bevat veel mechanismen voor het uitbreiden van het cluster en ingangen meebrengen mislukte knooppunten en services weer.</span><span class="sxs-lookup"><span data-stu-id="5e664-128">Service Fabric provides many mechanisms for expanding the cluster and handles bringing failed nodes and services back.</span></span> <span data-ttu-id="5e664-129">Service Fabric kunnen ook veel exemplaren van uw services en waarop om te voorkomen dat deze niet-geplande storingen uit te schakelen in echte noodsituaties typen.</span><span class="sxs-lookup"><span data-stu-id="5e664-129">Service Fabric also allows running many instances of your services in order to avoid these types of unplanned failures from turning into real disasters.</span></span>

<span data-ttu-id="5e664-130">Mogelijk zijn er redenen waarom een implementatie die groot genoeg zijn om fouten beslaan uitgevoerd, niet haalbaar is.</span><span class="sxs-lookup"><span data-stu-id="5e664-130">There may be reasons why running a deployment large enough to span over failures is not feasible.</span></span> <span data-ttu-id="5e664-131">Het kan bijvoorbeeld meer hardwarebronnen dan je niet bereid te betalen voor ten opzichte van de kans op mislukte duren.</span><span class="sxs-lookup"><span data-stu-id="5e664-131">For example, it may take more hardware resources than you're not willing to pay for relative to the chance of failure.</span></span> <span data-ttu-id="5e664-132">Tijdens het afhandelen van gedistribueerde toepassingen, kan het zijn dat aanvullende communicatie hops of status replicatie over geografische afstanden oorzaken onaanvaardbaar latentie kost.</span><span class="sxs-lookup"><span data-stu-id="5e664-132">When dealing with distributed applications, it could be that additional communication hops or state replication costs across geographic distances causes unacceptable latency.</span></span> <span data-ttu-id="5e664-133">Waar deze regel wordt getekend verschilt voor elke toepassing.</span><span class="sxs-lookup"><span data-stu-id="5e664-133">Where this line is drawn differs for each application.</span></span> <span data-ttu-id="5e664-134">Softwarefouten in het bijzonder kan de fout zich in de service die u probeert te schalen.</span><span class="sxs-lookup"><span data-stu-id="5e664-134">For software faults specifically, the fault could be in the service that you are trying to scale.</span></span> <span data-ttu-id="5e664-135">In dit geval voorkomen niet meer exemplaren de noodherstel, omdat de voorwaarde is mislukt, wordt gecorreleerd in alle exemplaren.</span><span class="sxs-lookup"><span data-stu-id="5e664-135">In this case more copies don't prevent the disaster, since the failure condition is correlated across all the instances.</span></span>

### <a name="operational-faults"></a><span data-ttu-id="5e664-136">Operationele fouten</span><span class="sxs-lookup"><span data-stu-id="5e664-136">Operational faults</span></span>
<span data-ttu-id="5e664-137">Zelfs als de service overal ter wereld met veel redundantie omspannen is, kan deze nog steeds rampzalig zijn gebeurtenissen optreden.</span><span class="sxs-lookup"><span data-stu-id="5e664-137">Even if your service is spanned across the globe with many redundancies, it can still experience disastrous events.</span></span> <span data-ttu-id="5e664-138">Bijvoorbeeld als iemand per ongeluk configureert de DNS-naam voor de service opnieuw of deze rechtstreekse wordt verwijderd.</span><span class="sxs-lookup"><span data-stu-id="5e664-138">For example, if someone accidentally reconfigures the dns name for the service, or deletes it outright.</span></span> <span data-ttu-id="5e664-139">Stel bijvoorbeeld moest u een stateful Service Fabric-service en iemand die service per ongeluk hebt verwijderd.</span><span class="sxs-lookup"><span data-stu-id="5e664-139">As an example, let's say you had a stateful Service Fabric service, and someone deleted that service accidentally.</span></span> <span data-ttu-id="5e664-140">Tenzij er een aantal andere risicobeperking, of de service en alle van de status had is nu voltooid.</span><span class="sxs-lookup"><span data-stu-id="5e664-140">Unless there's some other mitigation, that service and all of the state it had is now gone.</span></span> <span data-ttu-id="5e664-141">Dit type operationele noodsituaties vereist ('Oeps') verschillende oplossingen en stappen voor herstel dan gewone niet-geplande storingen.</span><span class="sxs-lookup"><span data-stu-id="5e664-141">These types of operational disasters ("oops") require different mitigations and steps for recovery than regular unplanned failures.</span></span> 

<span data-ttu-id="5e664-142">De beste manieren om te voorkomen dat deze typen operationele storingen zijn aan</span><span class="sxs-lookup"><span data-stu-id="5e664-142">The best ways to avoid these types of operational faults are to</span></span>
1. <span data-ttu-id="5e664-143">operationele toegang tot de omgeving beperken</span><span class="sxs-lookup"><span data-stu-id="5e664-143">restrict operational access to the environment</span></span>
2. <span data-ttu-id="5e664-144">strikt gevaarlijke bewerkingen controleren</span><span class="sxs-lookup"><span data-stu-id="5e664-144">strictly audit dangerous operations</span></span>
3. <span data-ttu-id="5e664-145">automation leggen, te voorkomen dat handmatige of buiten band wijzigingen en specifieke wijzigingen tegen de werkelijke omgeving valideren voordat ze vast te stellen</span><span class="sxs-lookup"><span data-stu-id="5e664-145">impose automation, prevent manual or out of band changes, and validate specific changes against the actual environment before enacting them</span></span>
4. <span data-ttu-id="5e664-146">Zorg ervoor dat destructieve operations 'soft'.</span><span class="sxs-lookup"><span data-stu-id="5e664-146">ensure that destructive operations are "soft".</span></span> <span data-ttu-id="5e664-147">Voorlopig bewerkingen onmiddellijk van kracht niet of kunnen in sommige tijdvenster ongedaan worden gemaakt</span><span class="sxs-lookup"><span data-stu-id="5e664-147">Soft operations don't take effect immediately or can be undone within some time window</span></span>

<span data-ttu-id="5e664-148">Service Fabric bevat enkele mechanismen om te voorkomen dat operationele fouten, zoals bieden [op basis van rollen](service-fabric-cluster-security-roles.md) toegangsbeheer voor bewerkingen voor een cluster.</span><span class="sxs-lookup"><span data-stu-id="5e664-148">Service Fabric provides some mechanisms to prevent operational faults, such as providing [role-based](service-fabric-cluster-security-roles.md) access control for cluster operations.</span></span> <span data-ttu-id="5e664-149">De meeste van deze operationele storingen vereisen echter organisatie inspanningen en andere systemen.</span><span class="sxs-lookup"><span data-stu-id="5e664-149">However, most of these operational faults require organizational efforts and other systems.</span></span> <span data-ttu-id="5e664-150">Service Fabric bieden een mechanisme voor functionerende operationele fouten, met name back-up en herstel voor stateful services.</span><span class="sxs-lookup"><span data-stu-id="5e664-150">Service Fabric does provide some mechanism for surviving operational faults, most notably backup and restore for stateful services.</span></span>

## <a name="managing-failures"></a><span data-ttu-id="5e664-151">Het beheren van fouten</span><span class="sxs-lookup"><span data-stu-id="5e664-151">Managing failures</span></span>
<span data-ttu-id="5e664-152">Het doel van de Service Fabric is bijna altijd automatisch beheer van fouten.</span><span class="sxs-lookup"><span data-stu-id="5e664-152">The goal of Service Fabric is almost always automatic management of failures.</span></span> <span data-ttu-id="5e664-153">Verwerken van bepaalde typen fouten een services echter aanvullende code.</span><span class="sxs-lookup"><span data-stu-id="5e664-153">However, in order to handle some types of failures, services must have additional code.</span></span> <span data-ttu-id="5e664-154">Andere typen van fouten moeten _niet_ worden automatisch opgelost redenen veiligheid en zakelijke continuïteit.</span><span class="sxs-lookup"><span data-stu-id="5e664-154">Other types of failures should _not_ be automatically addressed because of safety and business continuity reasons.</span></span> 

### <a name="handling-single-failures"></a><span data-ttu-id="5e664-155">Afhandeling van één fouten</span><span class="sxs-lookup"><span data-stu-id="5e664-155">Handling single failures</span></span>
<span data-ttu-id="5e664-156">Meerdere computers kunnen om allerlei redenen mislukken.</span><span class="sxs-lookup"><span data-stu-id="5e664-156">Single machines can fail for all sorts of reasons.</span></span> <span data-ttu-id="5e664-157">Sommige van deze zijn oorzaken van hardware, zoals voedingen en netwerken hardwarefouten.</span><span class="sxs-lookup"><span data-stu-id="5e664-157">Some of these are hardware causes, like power supplies and networking hardware failures.</span></span> <span data-ttu-id="5e664-158">Andere fouten zijn in software.</span><span class="sxs-lookup"><span data-stu-id="5e664-158">Other failures are in software.</span></span> <span data-ttu-id="5e664-159">Het gaat hierbij om fouten van het besturingssysteem en de service zelf.</span><span class="sxs-lookup"><span data-stu-id="5e664-159">These include failures of the actual operating system and the service itself.</span></span> <span data-ttu-id="5e664-160">Service Fabric detecteert automatisch dergelijke fouten, met inbegrip van gevallen waarin de machine geïsoleerd van andere machines vanwege netwerkproblemen wordt.</span><span class="sxs-lookup"><span data-stu-id="5e664-160">Service Fabric automatically detects these types of failures, including cases where the machine becomes isolated from other machines due to network issues.</span></span>

<span data-ttu-id="5e664-161">Ongeacht het type van de service uitgevoerd één exemplaar resultaten uitvaltijd voor de service als dat één exemplaar van de code voor een of andere reden mislukt.</span><span class="sxs-lookup"><span data-stu-id="5e664-161">Regardless of the type of service, running a single instance results in downtime for that service if that single copy of the code fails for any reason.</span></span> 

<span data-ttu-id="5e664-162">Om te kunnen verwerken op één enkele storing, is het eenvoudigste wat dat u kunt doen om ervoor te zorgen dat uw services worden uitgevoerd op meer dan één knooppunt standaard.</span><span class="sxs-lookup"><span data-stu-id="5e664-162">In order to handle any single failure, the simplest thing you can do is to ensure that your services run on more than one node by default.</span></span> <span data-ttu-id="5e664-163">Voor stateless services, kan dit worden bereikt door een `InstanceCount` groter is dan 1.</span><span class="sxs-lookup"><span data-stu-id="5e664-163">For stateless services, this can be accomplished by having an `InstanceCount` greater than 1.</span></span> <span data-ttu-id="5e664-164">Voor stateful services, is de minimale aanbeveling altijd een `TargetReplicaSetSize` en `MinReplicaSetSize` van ten minste 3.</span><span class="sxs-lookup"><span data-stu-id="5e664-164">For stateful services, the minimum recommendation is always a `TargetReplicaSetSize` and `MinReplicaSetSize` of at least 3.</span></span> <span data-ttu-id="5e664-165">Meer kopieën van uw servicecode wordt uitgevoerd, zorgt u ervoor dat uw service automatisch één enkele storing kan verwerken.</span><span class="sxs-lookup"><span data-stu-id="5e664-165">Running more copies of your service code ensures that your service can handle any single failure automatically.</span></span> 

### <a name="handling-coordinated-failures"></a><span data-ttu-id="5e664-166">Verwerking gecoördineerd fouten</span><span class="sxs-lookup"><span data-stu-id="5e664-166">Handling coordinated failures</span></span>
<span data-ttu-id="5e664-167">Gecoördineerde fouten kunnen gebeuren in een cluster vanwege geplande of niet-geplande infrastructuur fouten en wijzigingen of wijzigingen in de geplande software.</span><span class="sxs-lookup"><span data-stu-id="5e664-167">Coordinated failures can happen in a cluster due to either planned or unplanned infrastructure failures and changes, or planned software changes.</span></span> <span data-ttu-id="5e664-168">Service Fabric modellen infrastructuur-zones die gecoördineerde fouten als domeinen met fouten optreden.</span><span class="sxs-lookup"><span data-stu-id="5e664-168">Service Fabric models infrastructure zones that experience coordinated failures as Fault Domains.</span></span> <span data-ttu-id="5e664-169">Gebieden die gecoördineerde softwarewijzigingen merken zijn gemodelleerd als domeinen upgraden.</span><span class="sxs-lookup"><span data-stu-id="5e664-169">Areas that will experience coordinated software changes are modeled as Upgrade Domains.</span></span> <span data-ttu-id="5e664-170">Meer informatie over probleem- en upgrade domeinen zich in [dit document](service-fabric-cluster-resource-manager-cluster-description.md) die beschrijft clustertopologie en definitie.</span><span class="sxs-lookup"><span data-stu-id="5e664-170">More information about fault and upgrade domains is in [this document](service-fabric-cluster-resource-manager-cluster-description.md) that describes cluster topology and definition.</span></span>

<span data-ttu-id="5e664-171">Standaard beschouwt Service Fabric-fout- en upgrade-domeinen bij het plannen waar uw services moeten worden uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="5e664-171">By default Service Fabric considers fault and upgrade domains when planning where your services should run.</span></span> <span data-ttu-id="5e664-172">Standaard probeert de Service Fabric om ervoor te zorgen dat uw services worden uitgevoerd in verschillende domeinen voor probleem- en dus als gepland of ongepland wijzigingen per ongeluk uw services beschikbaar blijven.</span><span class="sxs-lookup"><span data-stu-id="5e664-172">By default, Service Fabric tries to ensure that your services run across several fault and upgrade domains so if planned or unplanned changes happen your services remain available.</span></span> 

<span data-ttu-id="5e664-173">Stel dat falen van een stroombron zorgt ervoor dat een rack van machines tegelijkertijd mislukken.</span><span class="sxs-lookup"><span data-stu-id="5e664-173">For example, let's say that failure of a power source causes a rack of machines to fail simultaneously.</span></span> <span data-ttu-id="5e664-174">Hiermee schakelt u in een ander voorbeeld van een storing voor een bepaalde service met meerdere exemplaren van de service wordt uitgevoerd het verlies van veel computers in een domein-fout veroorzaakt.</span><span class="sxs-lookup"><span data-stu-id="5e664-174">With multiple copies of the service running the loss of many machines in fault domain failure turns into just another example of single failure for a given service.</span></span> <span data-ttu-id="5e664-175">Dit is het beheren van domeinen met fouten essentieel is voor hoge beschikbaarheid van uw services.</span><span class="sxs-lookup"><span data-stu-id="5e664-175">This is why managing fault domains is critical to ensuring high availability of your services.</span></span> <span data-ttu-id="5e664-176">Wanneer het Service Fabric in Azure wordt uitgevoerd, worden foutdomeinen automatisch beheerd.</span><span class="sxs-lookup"><span data-stu-id="5e664-176">When running Service Fabric in Azure, fault domains are managed automatically.</span></span> <span data-ttu-id="5e664-177">In andere omgevingen ze mogelijk niet.</span><span class="sxs-lookup"><span data-stu-id="5e664-177">In other environments they may not be.</span></span> <span data-ttu-id="5e664-178">Als u uw eigen clusters on-premises maakt, moet u toewijzen en uw domein veroorzaakt indeling onjuist plant.</span><span class="sxs-lookup"><span data-stu-id="5e664-178">If you're building your own clusters on premises, be sure to map and plan your fault domain layout correctly.</span></span>

<span data-ttu-id="5e664-179">Upgradedomeinen zijn nuttig voor het modelleren van gebieden waarop software is vereist, op hetzelfde moment worden bijgewerkt.</span><span class="sxs-lookup"><span data-stu-id="5e664-179">Upgrade Domains are useful for modeling areas where software is going to be upgraded at the same time.</span></span> <span data-ttu-id="5e664-180">Als gevolg hiervan domeinen upgraden ook vaak de grenzen te definiëren waar software wordt offline gezet tijdens geplande upgrades.</span><span class="sxs-lookup"><span data-stu-id="5e664-180">Because of this, Upgrade Domains also often define the boundaries where software is taken down during planned upgrades.</span></span> <span data-ttu-id="5e664-181">Upgrades van zowel Service Fabric en uw services volgen hetzelfde model.</span><span class="sxs-lookup"><span data-stu-id="5e664-181">Upgrades of both Service Fabric and your services follow the same model.</span></span> <span data-ttu-id="5e664-182">Zie voor meer informatie over upgrades, upgradedomeinen en het Service Fabric-statusmodel die voorkomt dat onbedoelde wijzigingen die invloed hebben op het cluster en uw service rolling deze documenten:</span><span class="sxs-lookup"><span data-stu-id="5e664-182">For more on rolling upgrades, upgrade domains, and the Service Fabric health model that helps prevent unintended changes from impacting the cluster and your service, see these documents:</span></span>

 - [<span data-ttu-id="5e664-183">Upgrade van de toepassing</span><span class="sxs-lookup"><span data-stu-id="5e664-183">Application Upgrade</span></span>](service-fabric-application-upgrade.md)
 - [<span data-ttu-id="5e664-184">Zelfstudie over Upgrade</span><span class="sxs-lookup"><span data-stu-id="5e664-184">Application Upgrade Tutorial</span></span>](service-fabric-application-upgrade-tutorial.md)
 - [<span data-ttu-id="5e664-185">Service Fabric-statusmodel</span><span class="sxs-lookup"><span data-stu-id="5e664-185">Service Fabric Health Model</span></span>](service-fabric-health-introduction.md)

<span data-ttu-id="5e664-186">U kunt de indeling van het cluster met behulp van de opgegeven in de clustertoewijzing visualiseren [Service Fabric Explorer](service-fabric-visualizing-your-cluster.md):</span><span class="sxs-lookup"><span data-stu-id="5e664-186">You can visualize the layout of your cluster using the cluster map provided in [Service Fabric Explorer](service-fabric-visualizing-your-cluster.md):</span></span>

<span data-ttu-id="5e664-187"><center>
![Knooppunten die zijn verdeeld over de domeinen met fouten in Service Fabric Explorer][sfx-cluster-map]
</center></span><span class="sxs-lookup"><span data-stu-id="5e664-187"><center>
![Nodes spread across fault domains in Service Fabric Explorer][sfx-cluster-map]
</center></span></span>

> [!NOTE]
> <span data-ttu-id="5e664-188">Modeling gebieden mislukt, rolling upgrades met veel exemplaren van uw servicecode en status, plaatsingsregels om te controleren of uw services uitvoeren in domeinen met fouten en upgrade, en de ingebouwde statuscontrole NET **sommige** van de functies die Service Fabric bevat om de normale operationele problemen en fouten voorkomen in te schakelen in noodsituaties.</span><span class="sxs-lookup"><span data-stu-id="5e664-188">Modeling areas of failure, rolling upgrades, running many instances of your service code and state, placement rules to ensure your services run across fault and upgrade domains, and built-in health monitoring are just **some** of the features that Service Fabric provides in order to keep normal operational issues and failures from turning into disasters.</span></span> 
>

### <a name="handling-simultaneous-hardware-or-software-failures"></a><span data-ttu-id="5e664-189">Verwerking van gelijktijdige hardware of software-fouten</span><span class="sxs-lookup"><span data-stu-id="5e664-189">Handling simultaneous hardware or software failures</span></span>
<span data-ttu-id="5e664-190">Hierboven besproken we enkele fouten.</span><span class="sxs-lookup"><span data-stu-id="5e664-190">Above we talked about single failures.</span></span> <span data-ttu-id="5e664-191">Zoals u ziet, zijn gemakkelijk te verwerken voor zowel stateless als stateful services alleen doordat meer exemplaren van de code (en de status) uitvoert via domeinen met fouten en upgradedomeinen.</span><span class="sxs-lookup"><span data-stu-id="5e664-191">As you can see, are easy to handle for both stateless and stateful services just by keeping more copies of the code (and state) running across fault and upgrade domains.</span></span> <span data-ttu-id="5e664-192">Meerdere gelijktijdige willekeurige fouten kunnen ook gebeuren.</span><span class="sxs-lookup"><span data-stu-id="5e664-192">Multiple simultaneous random failures can also happen.</span></span> <span data-ttu-id="5e664-193">Dit zijn vaker leiden tot een werkelijke na noodgevallen.</span><span class="sxs-lookup"><span data-stu-id="5e664-193">These are more likely to lead to an actual disaster.</span></span>


### <a name="random-failures-leading-to-service-failures"></a><span data-ttu-id="5e664-194">Willekeurige fouten, wat leidt tot servicefouten</span><span class="sxs-lookup"><span data-stu-id="5e664-194">Random failures leading to service failures</span></span>
<span data-ttu-id="5e664-195">Stel dat de service heeft een `InstanceCount` van 5 en verschillende knooppunten op hetzelfde moment actieve die alle exemplaren mislukt.</span><span class="sxs-lookup"><span data-stu-id="5e664-195">Let's say that the service had an `InstanceCount` of 5, and several nodes running those instances all failed at the same time.</span></span> <span data-ttu-id="5e664-196">Service Fabric reageert automatisch vervangen door exemplaren te maken op andere knooppunten.</span><span class="sxs-lookup"><span data-stu-id="5e664-196">Service Fabric responds by automatically creating replacement instances on other nodes.</span></span> <span data-ttu-id="5e664-197">Vervangingen maken totdat de service terug naar het aantal gewenste exemplaren is wordt voortgezet.</span><span class="sxs-lookup"><span data-stu-id="5e664-197">It will continue creating replacements until the service is back to its desired instance count.</span></span> <span data-ttu-id="5e664-198">Een ander voorbeeld: Stel dat er is een staatloze service met een `InstanceCount`van -1, wat betekent dat deze wordt uitgevoerd op alle geldige knooppunten in het cluster.</span><span class="sxs-lookup"><span data-stu-id="5e664-198">As another example, let's say there was a stateless service with an `InstanceCount`of -1, meaning it runs on all valid nodes in the cluster.</span></span> <span data-ttu-id="5e664-199">Stel dat een aantal van deze exemplaren waren mislukken.</span><span class="sxs-lookup"><span data-stu-id="5e664-199">Let's say that some of those instances were to fail.</span></span> <span data-ttu-id="5e664-200">In dit geval merkt Service Fabric dat de service niet in de gewenste status is en probeert te maken van de exemplaren op de knooppunten waar ze ontbreekt zijn.</span><span class="sxs-lookup"><span data-stu-id="5e664-200">In this case, Service Fabric notices that the service is not in its desired state, and tries to create the instances on the nodes where they are missing.</span></span> 

<span data-ttu-id="5e664-201">Voor stateful services de situatie is afhankelijk van of de service heeft gehandhaafd status of niet.</span><span class="sxs-lookup"><span data-stu-id="5e664-201">For stateful services the situation depends on whether the service has persisted state or not.</span></span> <span data-ttu-id="5e664-202">Ook afhankelijk van hoe groot aantal replica's die de service heeft en hoeveel is mislukt.</span><span class="sxs-lookup"><span data-stu-id="5e664-202">It also depends on how many replicas the service had and how many failed.</span></span> <span data-ttu-id="5e664-203">Bepalen of een noodgeval is opgetreden voor een stateful service bevat en het beheren van deze drie fasen:</span><span class="sxs-lookup"><span data-stu-id="5e664-203">Determining whether a disaster occurred for a stateful service and managing it follows three stages:</span></span>

1. <span data-ttu-id="5e664-204">Bepalen of er quorumverlies of niet is</span><span class="sxs-lookup"><span data-stu-id="5e664-204">Determining if there has been quorum loss or not</span></span>
 - <span data-ttu-id="5e664-205">Een quorumverlies is elk gewenst moment een meerderheid van de replica's van een stateful service niet beschikbaar zijn op hetzelfde moment, met inbegrip van de primaire.</span><span class="sxs-lookup"><span data-stu-id="5e664-205">A quorum loss is any time a majority of the replicas of a stateful service are down at the same time, including the Primary.</span></span>
2. <span data-ttu-id="5e664-206">Bepalen of de quorumverlies permanente of niet is</span><span class="sxs-lookup"><span data-stu-id="5e664-206">Determining if the quorum loss is permanent or not</span></span>
 - <span data-ttu-id="5e664-207">De meeste gevallen, fouten, zijn tijdelijke.</span><span class="sxs-lookup"><span data-stu-id="5e664-207">Most of the time, failures are transient.</span></span> <span data-ttu-id="5e664-208">Processen opnieuw zijn opgestart, opnieuw worden opgestart, virtuele machines zijn uitgebracht, retoucheren netwerkpartities.</span><span class="sxs-lookup"><span data-stu-id="5e664-208">Processes are restarted, nodes are restarted, VMs are relaunched, network partitions heal.</span></span> <span data-ttu-id="5e664-209">Fouten zijn soms echter permanent.</span><span class="sxs-lookup"><span data-stu-id="5e664-209">Sometimes though, failures are permanent.</span></span> 
    - <span data-ttu-id="5e664-210">Voor services zonder permanente status, een storing van een quorum of meer van de resultaten van de replica's _onmiddellijk_ permanente quorum verloren gaan.</span><span class="sxs-lookup"><span data-stu-id="5e664-210">For services without persisted state, a failure of a quorum or more of replicas results _immediately_ in permanent quorum loss.</span></span> <span data-ttu-id="5e664-211">Wanneer het Service Fabric quorumverlies in een stateful service voor niet-permanente detecteert, loopt onmiddellijk hij naar stap 3 (mogelijke) dataloss declareert.</span><span class="sxs-lookup"><span data-stu-id="5e664-211">When Service Fabric detects quorum loss in a stateful non-persistent service, it immediately proceeds to step 3 by declaring (potential) dataloss.</span></span> <span data-ttu-id="5e664-212">U overgaat tot dataloss zin omdat Service Fabric weet dat er geen punt in het wachten op de replica's terugkeren, omdat zelfs als ze zijn hersteld, deze leeg zijn zou.</span><span class="sxs-lookup"><span data-stu-id="5e664-212">Proceeding to dataloss makes sense because Service Fabric knows that there's no point in waiting for the replicas to come back, because even if they were recovered they would be empty.</span></span>
    - <span data-ttu-id="5e664-213">Een storing van een quorum of meer van de replica's voor permanente stateful services zorgt ervoor dat Service Fabric om te wachten op de replica's keert u terug en herstellen van quorum starten.</span><span class="sxs-lookup"><span data-stu-id="5e664-213">For stateful persistent services, a failure of a quorum or more of replicas causes Service Fabric to start waiting for the replicas to come back and restore quorum.</span></span> <span data-ttu-id="5e664-214">Dit resulteert in een onderbreking van deze service voor een _schrijft_ naar de betreffende partitie (of 'replicaset') van de service.</span><span class="sxs-lookup"><span data-stu-id="5e664-214">This results in a service outage for any _writes_ to the affected partition (or "replica set") of the service.</span></span> <span data-ttu-id="5e664-215">Leesbewerkingen kunnen echter nog wel worden mogelijk met verminderde consistentie wordt gegarandeerd.</span><span class="sxs-lookup"><span data-stu-id="5e664-215">However, reads may still be possible with reduced consistency guarantees.</span></span> <span data-ttu-id="5e664-216">De hoeveelheid tijd dat het Service Fabric wacht quorum worden hersteld is oneindig, omdat u doorgaat een (mogelijke) dataloss gebeurtenis en andere risico's uitvoert.</span><span class="sxs-lookup"><span data-stu-id="5e664-216">The default amount of time that Service Fabric waits for quorum to be restored is infinite, since proceeding is a (potential) dataloss event and carries other risks.</span></span> <span data-ttu-id="5e664-217">De standaardwaarde onderdrukken `QuorumLossWaitDuration` waarde is mogelijk, maar wordt niet aanbevolen.</span><span class="sxs-lookup"><span data-stu-id="5e664-217">Overriding the default `QuorumLossWaitDuration` value is possible but is not recommended.</span></span> <span data-ttu-id="5e664-218">Op dit moment moeten alle pogingen in plaats daarvan worden aangebracht om te herstellen van de omlaag replica's.</span><span class="sxs-lookup"><span data-stu-id="5e664-218">Instead at this time, all efforts should be made to restore the down replicas.</span></span> <span data-ttu-id="5e664-219">Hiervoor moet de knooppunten die niet beschikbaar back-up zijn, en ervoor te zorgen dat ze de stations waar ze de lokale permanente status opgeslagen opnieuw kunnen koppelen.</span><span class="sxs-lookup"><span data-stu-id="5e664-219">This requires bringing the nodes that are down back up, and ensuring that they can remount the drives where they stored the local persistent state.</span></span> <span data-ttu-id="5e664-220">Als de quorumverlies wordt veroorzaakt door een fout, probeert het Service Fabric automatisch opnieuw maken van de processen en opnieuw starten van de replica's in deze.</span><span class="sxs-lookup"><span data-stu-id="5e664-220">If the quorum loss is caused by process failure, Service Fabric automatically tries to recreate the processes and restart the replicas inside them.</span></span> <span data-ttu-id="5e664-221">Als dit mislukt, wordt in Service Fabric health fouten rapporteert.</span><span class="sxs-lookup"><span data-stu-id="5e664-221">If this fails, Service Fabric reports health errors.</span></span> <span data-ttu-id="5e664-222">Als deze omgezet worden kunnen vervolgens terugkeren de replica's gewoonlijk.</span><span class="sxs-lookup"><span data-stu-id="5e664-222">If these can be resolved then the replicas usually come back.</span></span> <span data-ttu-id="5e664-223">Soms moet echter niet kunnen de replica's worden teruggebracht.</span><span class="sxs-lookup"><span data-stu-id="5e664-223">Sometimes, though, the replicas can't be brought back.</span></span> <span data-ttu-id="5e664-224">Bijvoorbeeld, de stations mogelijk alle is mislukt of de machines fysiek vernietigd enigszins.</span><span class="sxs-lookup"><span data-stu-id="5e664-224">For example, the drives may all have failed, or the machines physically destroyed somehow.</span></span> <span data-ttu-id="5e664-225">In dergelijke gevallen hebben we nu een permanente quorum verlies-gebeurtenis.</span><span class="sxs-lookup"><span data-stu-id="5e664-225">In these cases, we now have a permanent quorum loss event.</span></span> <span data-ttu-id="5e664-226">Om te laten Service Fabric om te wachten op de omlaag replica's terugkeren stoppen, Clusterbeheerder welke partities die services worden beïnvloed en roept u moet bepalen de `Repair-ServiceFabricPartition -PartitionId` of ` System.Fabric.FabricClient.ClusterManagementClient.RecoverPartitionAsync(Guid partitionId)` API.</span><span class="sxs-lookup"><span data-stu-id="5e664-226">To tell Service Fabric to stop waiting for the down replicas to come back, a cluster administrator must determine which partitions of which services are affected and call the `Repair-ServiceFabricPartition -PartitionId` or ` System.Fabric.FabricClient.ClusterManagementClient.RecoverPartitionAsync(Guid partitionId)` API.</span></span>  <span data-ttu-id="5e664-227">Deze API kunt u opgeven die de ID van de partitie worden verplaatst buiten QuorumLoss en potentiële dataloss.</span><span class="sxs-lookup"><span data-stu-id="5e664-227">This API allows specifying the ID of the partition to move out of QuorumLoss and into potential dataloss.</span></span>

> [!NOTE]
> <span data-ttu-id="5e664-228">Het is _nooit_ veilig voor het gebruik van deze API anders dan in een bepaalde manier tegen specifieke partities.</span><span class="sxs-lookup"><span data-stu-id="5e664-228">It is _never_ safe to use this API other than in a targeted way against specific partitions.</span></span> 
>

3. <span data-ttu-id="5e664-229">Bepalen of er sprake is van feitelijke gegevens verloren gaan en het terugzetten van back-ups</span><span class="sxs-lookup"><span data-stu-id="5e664-229">Determining if there has been actual data loss, and restoring from backups</span></span>
  - <span data-ttu-id="5e664-230">Wanneer het Service Fabric roept de `OnDataLossAsync` methode altijd omdat is _vermoed_ dataloss.</span><span class="sxs-lookup"><span data-stu-id="5e664-230">When Service Fabric calls the `OnDataLossAsync` method it is always because of _suspected_ dataloss.</span></span> <span data-ttu-id="5e664-231">Service Fabric zorgt ervoor dat deze aanroep is geleverd aan de _aanbevolen_ resterende replica.</span><span class="sxs-lookup"><span data-stu-id="5e664-231">Service Fabric ensures that this call is delivered to the _best_ remaining replica.</span></span> <span data-ttu-id="5e664-232">Dit is de meeste voortgang heeft gemaakt, worden de replica.</span><span class="sxs-lookup"><span data-stu-id="5e664-232">This is whichever replica has made the most progress.</span></span> <span data-ttu-id="5e664-233">De reden we altijd spreken _vermoed_ dataloss is dat het is mogelijk dat de resterende replica alle dezelfde staat daadwerkelijk heeft als de primaire was voordat deze werd afgesloten.</span><span class="sxs-lookup"><span data-stu-id="5e664-233">The reason we always say _suspected_ dataloss is that it is possible that the remaining replica actually has all same state as the Primary did when it went down.</span></span> <span data-ttu-id="5e664-234">Echter, zonder die status om te vergelijken, er is geen goede manier voor Service Fabric of operators zeker weten.</span><span class="sxs-lookup"><span data-stu-id="5e664-234">However, without that state to compare it to, there's no good way for Service Fabric or operators to know for sure.</span></span> <span data-ttu-id="5e664-235">Op dit moment kent Service Fabric ook dat de andere replica's zijn niet terugkomen.</span><span class="sxs-lookup"><span data-stu-id="5e664-235">At this point, Service Fabric also knows the other replicas are not coming back.</span></span> <span data-ttu-id="5e664-236">Dat was de beslissing bij het wachten op de quorumverlies om op te lossen zelf is gestopt.</span><span class="sxs-lookup"><span data-stu-id="5e664-236">That was the decision made when we stopped waiting for the quorum loss to resolve itself.</span></span> <span data-ttu-id="5e664-237">De beste loop van de actie voor de service is meestal om te blokkeren en wacht tot specifieke interventie van een beheerder.</span><span class="sxs-lookup"><span data-stu-id="5e664-237">The best course of action for the service is usually to freeze and wait for specific administrative intervention.</span></span> <span data-ttu-id="5e664-238">Dus de betekenis van een typische implementatie van de `OnDataLossAsync` methode doen?</span><span class="sxs-lookup"><span data-stu-id="5e664-238">So what does a typical implementation of the `OnDataLossAsync` method do?</span></span>
  - <span data-ttu-id="5e664-239">Meld u eerst die `OnDataLossAsync` is geactiveerd en eventuele benodigde beheerdersrechten waarschuwingen starten.</span><span class="sxs-lookup"><span data-stu-id="5e664-239">First, log that `OnDataLossAsync` has been triggered, and fire off any necessary administrative alerts.</span></span>
   - <span data-ttu-id="5e664-240">Meestal op dit punt wacht op invoer voor verdere beslissingen en handmatige acties worden ondernomen.</span><span class="sxs-lookup"><span data-stu-id="5e664-240">Usually at this point, to pause and wait for further decisions and manual actions to be taken.</span></span> <span data-ttu-id="5e664-241">Dit is omdat zelfs als back-ups beschikbaar zijn ze mogelijk moeten worden voorbereid.</span><span class="sxs-lookup"><span data-stu-id="5e664-241">This is because even if backups are available they may need to be prepared.</span></span> <span data-ttu-id="5e664-242">Bijvoorbeeld, als twee verschillende services informatie te coördineren, deze back-ups mogelijk moet worden gewijzigd om ervoor te zorgen dat nadat het herstel die gebeurt de informatie die twee services voorzichtig over consistent is.</span><span class="sxs-lookup"><span data-stu-id="5e664-242">For example, if two different services coordinate information, those backups may need to be modified in order to ensure that once the restore happens that the information those two services care about is consistent.</span></span> 
  - <span data-ttu-id="5e664-243">Vaak is ook andere telemetrie of uitlaatgas van de service.</span><span class="sxs-lookup"><span data-stu-id="5e664-243">Often there is also some other telemetry or exhaust from the service.</span></span> <span data-ttu-id="5e664-244">Deze metagegevens kan zijn opgenomen in de andere services of in Logboeken.</span><span class="sxs-lookup"><span data-stu-id="5e664-244">This metadata may be contained in other services or in logs.</span></span> <span data-ttu-id="5e664-245">Deze informatie kan worden gebruikt die nodig zijn om te bepalen of er zijn aanroepen ontvangen en verwerkt op de primaire die zijn niet aanwezig in de back-up of gerepliceerd naar deze bepaalde replica.</span><span class="sxs-lookup"><span data-stu-id="5e664-245">This information can be used needed to determine if there were any calls received and processed at the primary that were not present in the backup or replicated to this particular replica.</span></span> <span data-ttu-id="5e664-246">Deze moeten worden cookies of toegevoegd aan de back-up voordat de herstelbewerking haalbaar is.</span><span class="sxs-lookup"><span data-stu-id="5e664-246">These may need to be replayed or added to the backup before restoration is feasible.</span></span>  
   - <span data-ttu-id="5e664-247">Vergelijking van de status van de resterende replica in die deel uitmaakt van een back-ups die beschikbaar zijn.</span><span class="sxs-lookup"><span data-stu-id="5e664-247">Comparisons of the remaining replica's state to that contained in any backups that are available.</span></span> <span data-ttu-id="5e664-248">Als de betrouwbare Service Fabric-verzamelingen worden er hulpprogramma's voor databaseontwikkeling en beschikbaar verwerkt om te doen, dat wordt beschreven in [in dit artikel](service-fabric-reliable-services-backup-restore.md).</span><span class="sxs-lookup"><span data-stu-id="5e664-248">If using the Service Fabric reliable collections then there are tools and processes available for doing so, described in [this article](service-fabric-reliable-services-backup-restore.md).</span></span> <span data-ttu-id="5e664-249">Het doel is om te zien als de status in de replica voldoende is of ook wat de back-up ontbreekt mogelijk.</span><span class="sxs-lookup"><span data-stu-id="5e664-249">The goal is to see if the state within the replica is sufficient, or also what the backup may be missing.</span></span>
  - <span data-ttu-id="5e664-250">Als de vergelijking is voltooid, en als het nodig de herstelbewerking is voltooid, de code als resultaat moet true als er wijzigingen zijn aangebracht.</span><span class="sxs-lookup"><span data-stu-id="5e664-250">Once the comparison is done, and if necessary the restore completed, the service code should return true if any state changes were made.</span></span> <span data-ttu-id="5e664-251">Retourneert onwaar als de replica wordt vastgesteld dat het de beste kopie van de status is en er zijn geen wijzigingen hebt aangebracht.</span><span class="sxs-lookup"><span data-stu-id="5e664-251">If the replica determined that it was the best available copy of the state and made no changes, then return false.</span></span> <span data-ttu-id="5e664-252">Waar geeft aan dat elke _andere_ resterende replica's nu mogelijk niet door deze gegevensset.</span><span class="sxs-lookup"><span data-stu-id="5e664-252">True indicates that any _other_ remaining replicas may now be inconsistent with this one.</span></span> <span data-ttu-id="5e664-253">Ze zullen worden verwijderd en opnieuw opgebouwd uit deze replica.</span><span class="sxs-lookup"><span data-stu-id="5e664-253">They will be dropped and rebuilt from this replica.</span></span> <span data-ttu-id="5e664-254">Drempelwaarde.ONWAAR geeft aan dat er geen wijzigingen zijn aangebracht, zodat de andere replica's kunnen houden wat ze hebben.</span><span class="sxs-lookup"><span data-stu-id="5e664-254">False indicates that no state changes were made, so the other replicas can keep what they have.</span></span> 

<span data-ttu-id="5e664-255">Het is zeer belangrijk dat service auteurs potentiële dataloss en scenario's fouten oefenen voordat services ooit worden geïmplementeerd in de productieomgeving.</span><span class="sxs-lookup"><span data-stu-id="5e664-255">It is critically important that service authors practice potential dataloss and failure scenarios before services are ever deployed in production.</span></span> <span data-ttu-id="5e664-256">Ter bescherming tegen de mogelijkheid van dataloss, is het belangrijk om periodiek [back-up van de status van de](service-fabric-reliable-services-backup-restore.md) van elk van uw stateful services naar een geografisch redundante opslag.</span><span class="sxs-lookup"><span data-stu-id="5e664-256">To protect against the possibility of dataloss, it is important to periodically [back up the state](service-fabric-reliable-services-backup-restore.md) of any of your stateful services to a geo-redundant store.</span></span> <span data-ttu-id="5e664-257">U moet er ook voor zorgen dat u hebt de mogelijkheid om het te herstellen.</span><span class="sxs-lookup"><span data-stu-id="5e664-257">You must also ensure that you have the ability to restore it.</span></span> <span data-ttu-id="5e664-258">Sinds de back-ups van veel verschillende services worden uitgevoerd op verschillende tijdstippen, moet u ervoor zorgen dat de uw services na een herstelbewerking een consistente weergave van elkaar hebben.</span><span class="sxs-lookup"><span data-stu-id="5e664-258">Since backups of many different services are taken at different times, you need to ensure that after a restore your services have a consistent view of each other.</span></span> <span data-ttu-id="5e664-259">Neem bijvoorbeeld een situatie waarin een service een aantal genereert en opgeslagen en vervolgens verzendt het naar een andere service waarmee gegevens worden ook opgeslagen.</span><span class="sxs-lookup"><span data-stu-id="5e664-259">For example, consider a situation where one service generates a number and stores it, then sends it to another service that also stores it.</span></span> <span data-ttu-id="5e664-260">Na een herstelbewerking mogelijk ontdekt u dat de tweede-service het aantal heeft opnemen, maar het eerste bestaat niet, omdat het back-up niet die voor deze bewerking.</span><span class="sxs-lookup"><span data-stu-id="5e664-260">After a restore, you might discover that the second service has the number but the first does not, because it's backup didn't include that operation.</span></span>

<span data-ttu-id="5e664-261">Als u ontdekken dat de resterende replica's onvoldoende om door te gaan zijn uit in een scenario dataloss en u kan geen servicestatus van telemetrie of uitlaatgas Reconstrueer, bepaalt de frequentie van uw back-ups de best mogelijke beoogd herstelpunt (RPO).</span><span class="sxs-lookup"><span data-stu-id="5e664-261">If you find out that the remaining replicas are insufficient to continue from in a dataloss scenario, and you can't reconstruct service state from telemetry or exhaust, the frequency of your backups determines your best possible recovery point objective (RPO).</span></span> <span data-ttu-id="5e664-262">Service Fabric bevat veel hulpprogramma's voor het testen van verschillende scenario's voor mislukt, met inbegrip van permanente quorum en dataloss herstel vanaf een back-up vereisen.</span><span class="sxs-lookup"><span data-stu-id="5e664-262">Service Fabric provides many tools for testing various failure scenarios, including permanent quorum and dataloss requiring restoration from a backup.</span></span> <span data-ttu-id="5e664-263">Deze scenario's zijn opgenomen als onderdeel van de Service Fabric testbaarheid-hulpprogramma's worden beheerd door de fout Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="5e664-263">These scenarios are included as a part of Service Fabric's testability tools, managed by the Fault Analysis Service.</span></span> <span data-ttu-id="5e664-264">Meer informatie over deze hulpprogramma's en patronen [hier](service-fabric-testability-overview.md).</span><span class="sxs-lookup"><span data-stu-id="5e664-264">More info on those tools and patterns is available [here](service-fabric-testability-overview.md).</span></span> 

> [!NOTE]
> <span data-ttu-id="5e664-265">Systeemservices kunnen ook quorum verloren zijn gegaan, met de impact die specifiek zijn voor de betrokken service worden afnemen.</span><span class="sxs-lookup"><span data-stu-id="5e664-265">System services can also suffer quorum loss, with the impact being specific to the service in question.</span></span> <span data-ttu-id="5e664-266">Bijvoorbeeld: quorumverlies in de naamgevingsservice heeft gevolgen voor naamomzetting dat quorumverlies in de failover manager service maken van nieuwe services en failovers geblokkeerd.</span><span class="sxs-lookup"><span data-stu-id="5e664-266">For instance, quorum loss in the naming service impacts name resolution, whereas quorum loss in the failover manager service blocks new service creation and failovers.</span></span> <span data-ttu-id="5e664-267">Terwijl de Service Fabric-systeemservices hetzelfde patroon als uw services voor het statusbeheer van volgen, wordt niet aanbevolen dat u proberen moet te verplaatsen uit Quorumverlies en in het potentieel dataloss.</span><span class="sxs-lookup"><span data-stu-id="5e664-267">While the Service Fabric system services follow the same pattern as your services for state management, it is not recommended that you should attempt to move them out of Quorum Loss and into potential dataloss.</span></span> <span data-ttu-id="5e664-268">De aanbeveling is in plaats daarvan het [ondersteuning zoeken](service-fabric-support.md) om te bepalen van een oplossing die bestemd is voor uw specifieke situatie.</span><span class="sxs-lookup"><span data-stu-id="5e664-268">The recommendation is instead to [seek support](service-fabric-support.md) to determine a solution that is targeted to your specific situation.</span></span>  <span data-ttu-id="5e664-269">Meestal is het raadzaam om te wachten tot de omlaag replica's weer.</span><span class="sxs-lookup"><span data-stu-id="5e664-269">Usually it is preferable to simply wait until the down replicas return.</span></span>
>

## <a name="availability-of-the-service-fabric-cluster"></a><span data-ttu-id="5e664-270">Beschikbaarheid van het Service Fabric-cluster</span><span class="sxs-lookup"><span data-stu-id="5e664-270">Availability of the Service Fabric cluster</span></span>
<span data-ttu-id="5e664-271">Het Service Fabric-cluster zelf is over het algemeen een sterk gedistribueerde omgeving met geen enkele storingspunten.</span><span class="sxs-lookup"><span data-stu-id="5e664-271">Generally speaking, the Service Fabric cluster itself is a highly distributed environment with no single points of failure.</span></span> <span data-ttu-id="5e664-272">Een storing van een willekeurig knooppunt leidt niet tot de beschikbaarheid of betrouwbaarheidsproblemen voor het cluster, voornamelijk omdat de Service Fabric-systeemservices Volg dezelfde richtlijnen die eerder is verkregen: ze worden altijd uitgevoerd met drie of meer replica's standaard en deze systeem Services die staatloze zijn worden uitgevoerd op alle knooppunten.</span><span class="sxs-lookup"><span data-stu-id="5e664-272">A failure of any one node will not cause availability or reliability issues for the cluster, primarily because the Service Fabric system services follow the same guidelines provided earlier: they always run with three or more replicas by default, and those system services that are stateless run on all nodes.</span></span> <span data-ttu-id="5e664-273">De onderliggende Service Fabric netwerk- en detectie lagen worden volledig gedistribueerd.</span><span class="sxs-lookup"><span data-stu-id="5e664-273">The underlying Service Fabric networking and failure detection layers are fully distributed.</span></span> <span data-ttu-id="5e664-274">De meeste systeemservices van metagegevens in het cluster kunnen worden gemaakt of weten hoe opnieuw synchroniseren van hun status vanuit andere locaties.</span><span class="sxs-lookup"><span data-stu-id="5e664-274">Most system services can be rebuilt from metadata in the cluster, or know how to resynchronize their state from other places.</span></span> <span data-ttu-id="5e664-275">De beschikbaarheid van het cluster kan niet meer betrouwbaar als systeemservices quorum verlies situaties zoals deze beschreven bovenstaande krijgen.</span><span class="sxs-lookup"><span data-stu-id="5e664-275">The availability of the cluster can become compromised if system services get into quorum loss situations like those described above.</span></span> <span data-ttu-id="5e664-276">In dergelijke gevallen niet mogelijk bepaalde bewerkingen op het cluster zoals begint met een upgrade of implementeren van nieuwe services kan uitvoeren, maar het cluster zelf nog steeds actief is.</span><span class="sxs-lookup"><span data-stu-id="5e664-276">In these cases you may not be able to perform certain operations on the cluster like starting an upgrade or deploying new services, but the cluster itself is still up.</span></span> <span data-ttu-id="5e664-277">Services op het al wordt uitgevoerd blijft actief in deze voorwaarden, tenzij ze nodig schrijfbewerkingen naar de systeemservices hebben blijft werken.</span><span class="sxs-lookup"><span data-stu-id="5e664-277">Services on already running will remain running in these conditions unless they require writes to the system services to continue functioning.</span></span> <span data-ttu-id="5e664-278">Bijvoorbeeld, als de Failover Manager is sprake van quorumverlies alle services worden uitgevoerd, maar kunnen de services die niet kan niet worden automatisch opnieuw wordt gestart, omdat dit de betrokkenheid van de Failover Manager vereist.</span><span class="sxs-lookup"><span data-stu-id="5e664-278">For example, if the Failover Manager is in quorum loss all services will continue to run, but any services that fail will not be able to automatically restart, since this requires the involvement of the Failover Manager.</span></span> 

### <a name="failures-of-a-datacenter-or-azure-region"></a><span data-ttu-id="5e664-279">Fouten van een datacenter of een Azure-regio</span><span class="sxs-lookup"><span data-stu-id="5e664-279">Failures of a datacenter or Azure region</span></span>
<span data-ttu-id="5e664-280">In zeldzame gevallen zijn een fysieke Datacenter tijdelijk niet beschikbaar vanwege verlies van power of netwerkverbinding.</span><span class="sxs-lookup"><span data-stu-id="5e664-280">In rare cases, a physical data center can become temporarily unavailable due to loss of power or network connectivity.</span></span> <span data-ttu-id="5e664-281">In deze gevallen is is de Service Fabric-clusters en -services in het desbetreffende datacenter of een Azure-regio niet beschikbaar.</span><span class="sxs-lookup"><span data-stu-id="5e664-281">In these cases, your Service Fabric clusters and services in that datacenter or Azure region will be unavailable.</span></span> <span data-ttu-id="5e664-282">Echter, _uw gegevens behouden blijven_.</span><span class="sxs-lookup"><span data-stu-id="5e664-282">However, _your data is preserved_.</span></span> <span data-ttu-id="5e664-283">Voor clusters worden uitgevoerd in Azure, kunt u updates op storingen bekijken op de [pagina Azure status][azure-status-dashboard].</span><span class="sxs-lookup"><span data-stu-id="5e664-283">For clusters running in Azure, you can view updates on outages on the [Azure status page][azure-status-dashboard].</span></span> <span data-ttu-id="5e664-284">In de gebeurtenis zeer onwaarschijnlijk dat een fysieke Datacenter wordt volledig of gedeeltelijk vernietigd, alle Service Fabric-clusters die er worden gehost of de services in deze verloren kunnen gaan.</span><span class="sxs-lookup"><span data-stu-id="5e664-284">In the highly unlikely event that a physical data center is partially or fully destroyed, any Service Fabric clusters hosted there or the services inside them could be lost.</span></span> <span data-ttu-id="5e664-285">Dit omvat geen status die niet een back-up buiten het datacenter of de regio.</span><span class="sxs-lookup"><span data-stu-id="5e664-285">This includes any state not backed up outside of that datacenter or region.</span></span>

<span data-ttu-id="5e664-286">Er is twee verschillende strategieën voor functionerende permanente of volgehouden storing in een enkel datacenter of regio.</span><span class="sxs-lookup"><span data-stu-id="5e664-286">There's two different strategies for surviving the permanent or sustained failure of a single datacenter or region.</span></span> 

1. <span data-ttu-id="5e664-287">Afzonderlijke Service Fabric-clusters worden uitgevoerd in meerdere dergelijke regio's en gebruikmaken van een mechanisme voor failover en failback tussen deze omgevingen.</span><span class="sxs-lookup"><span data-stu-id="5e664-287">Run separate Service Fabric clusters in multiple such regions, and utilize some mechanism for failover and fail-back between these environments.</span></span> <span data-ttu-id="5e664-288">De sortering van meerdere actief-actief of actief / passief clustermodel vereist aanvullende code voor beheer van en bewerkingen.</span><span class="sxs-lookup"><span data-stu-id="5e664-288">This sort of multi-cluster active-active or active-passive model requires additional management and operations code.</span></span> <span data-ttu-id="5e664-289">Dit is ook vereist coördinatie van de back-ups van de services in een datacenter of regio zodat ze beschikbaar zijn in andere datacenters of de regio's wanneer een mislukt.</span><span class="sxs-lookup"><span data-stu-id="5e664-289">This also requires coordination of backups from the services in one datacenter or region so that they are available in other datacenters or regions when one fails.</span></span> 
2. <span data-ttu-id="5e664-290">Voer één Service Fabric-cluster die meerdere datacenters of regio's omvat.</span><span class="sxs-lookup"><span data-stu-id="5e664-290">Run a single Service Fabric cluster that spans multiple datacenters or regions.</span></span> <span data-ttu-id="5e664-291">De minimale ondersteunde configuratie voor deze is drie datacenters of regio's.</span><span class="sxs-lookup"><span data-stu-id="5e664-291">The minimum supported configuration for this is three datacenters or regions.</span></span> <span data-ttu-id="5e664-292">Het aanbevolen aantal gebieden of datacenters is vijf.</span><span class="sxs-lookup"><span data-stu-id="5e664-292">The recommended number of regions or datacenters is five.</span></span> <span data-ttu-id="5e664-293">Hiervoor moet een complexere clustertopologie.</span><span class="sxs-lookup"><span data-stu-id="5e664-293">This requires a more complex cluster topology.</span></span> <span data-ttu-id="5e664-294">Het voordeel van dit model is echter dat falen van een datacenter of regio na een noodgeval is geconverteerd naar een normale fout.</span><span class="sxs-lookup"><span data-stu-id="5e664-294">However, the benefit of this model is that failure of one datacenter or region is converted from a disaster into a normal failure.</span></span> <span data-ttu-id="5e664-295">Deze fouten kunnen worden verwerkt door de mechanismen die werken voor clusters binnen één regio.</span><span class="sxs-lookup"><span data-stu-id="5e664-295">These failures can be handled by the mechanisms that work for clusters within a single region.</span></span> <span data-ttu-id="5e664-296">Zorg ervoor werkbelastingen worden gedistribueerd, zodat ze normaal fouten tolereren domeinen met fouten en upgradedomeinen regels voor de plaatsing van de Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="5e664-296">Fault domains, upgrade domains, and Service Fabric's placement rules ensure workloads are distributed so that they tolerate normal failures.</span></span> <span data-ttu-id="5e664-297">Voor meer informatie over beleidsregels die kunnen helpen bij het gebruiken van services in dit type cluster Lees informatie over [plaatsingsbeleid](service-fabric-cluster-resource-manager-advanced-placement-rules-placement-policies.md)</span><span class="sxs-lookup"><span data-stu-id="5e664-297">For more information on policies that can help operate services in this type of cluster, read up on [placement policies](service-fabric-cluster-resource-manager-advanced-placement-rules-placement-policies.md)</span></span>

### <a name="random-failures-leading-to-cluster-failures"></a><span data-ttu-id="5e664-298">Willekeurige fouten voorloopspaties van clusters</span><span class="sxs-lookup"><span data-stu-id="5e664-298">Random failures leading to cluster failures</span></span>
<span data-ttu-id="5e664-299">Service Fabric heeft het concept van Seed-knooppunten.</span><span class="sxs-lookup"><span data-stu-id="5e664-299">Service Fabric has the concept of Seed Nodes.</span></span> <span data-ttu-id="5e664-300">Dit zijn de knooppunten die de beschikbaarheid van de onderliggende cluster onderhouden.</span><span class="sxs-lookup"><span data-stu-id="5e664-300">These are nodes that maintain the availability of the underlying cluster.</span></span> <span data-ttu-id="5e664-301">Deze knooppunten helpen om te controleren of dat het cluster blijft door tot stand brengen van leases met andere knooppunten en fungeren als tiebreakers tijdens bepaalde soorten netwerkfouten.</span><span class="sxs-lookup"><span data-stu-id="5e664-301">These nodes help to ensure the cluster remains up by establishing leases with other nodes and serving as tiebreakers during certain kinds of network failures.</span></span> <span data-ttu-id="5e664-302">Als willekeurige fouten een meerderheid van de seed-knooppunten in het cluster verwijderen en ze niet worden toegevoegd, het cluster automatisch afgesloten.</span><span class="sxs-lookup"><span data-stu-id="5e664-302">If random failures remove a majority of the seed nodes in the cluster and they are not brought back, the cluster automatically shuts down.</span></span> <span data-ttu-id="5e664-303">In Azure, Seed-knooppunten automatisch worden beheerd: ze worden verdeeld over de beschikbare domeinen met fouten en upgradedomeinen en als een enkel seed-knooppunt wordt verwijderd uit het cluster een andere naam in plaats daarvan wordt gemaakt.</span><span class="sxs-lookup"><span data-stu-id="5e664-303">In Azure, Seed Nodes are automatically managed: they are distributed over the available fault and upgrade domains, and if a single seed node is removed from the cluster another one will be created in its place.</span></span> 

<span data-ttu-id="5e664-304">'Primaire knooppunttype' is in zelfstandige Service Fabric-clusters en Azure die de zaden wordt uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="5e664-304">In both standalone Service Fabric clusters and Azure, the "Primary Node Type" is the one that runs the seeds.</span></span> <span data-ttu-id="5e664-305">Bij het definiëren van een primaire knooppunttype Service Fabric, automatisch profiteren van het aantal knooppunten dat is geleverd door het maken van maximaal 9 seed-knooppunten en 9 replica's van elk van de systeemservices.</span><span class="sxs-lookup"><span data-stu-id="5e664-305">When defining a primary node type, Service Fabric will automatically take advantage of the number of nodes provided by creating up to 9 seed nodes and 9 replicas of each of the system services.</span></span> <span data-ttu-id="5e664-306">Als een set van willekeurige fouten tegelijkertijd uit een meerderheid van die replica van de service system duurt, voer de systeemservices quorum verloren zijn gegaan, zoals hierboven is beschreven.</span><span class="sxs-lookup"><span data-stu-id="5e664-306">If a set of random failures takes out a majority of those system service replicas simultaneously, the system services will enter quorum loss, as we described above.</span></span> <span data-ttu-id="5e664-307">Als een meerderheid van de seed-knooppunten verloren gaan, wordt het cluster zich snel na afgesloten.</span><span class="sxs-lookup"><span data-stu-id="5e664-307">If a majority of the seed nodes are lost, the cluster will shut down soon after.</span></span>

## <a name="next-steps"></a><span data-ttu-id="5e664-308">Volgende stappen</span><span class="sxs-lookup"><span data-stu-id="5e664-308">Next steps</span></span>
- <span data-ttu-id="5e664-309">Meer informatie over het simuleren van diverse fouten met de [testbaarheid framework](service-fabric-testability-overview.md)</span><span class="sxs-lookup"><span data-stu-id="5e664-309">Learn how to simulate various failures using the [testability framework](service-fabric-testability-overview.md)</span></span>
- <span data-ttu-id="5e664-310">Lezen van andere bronnen voor herstel na noodgevallen en hoge beschikbaarheid.</span><span class="sxs-lookup"><span data-stu-id="5e664-310">Read other disaster-recovery and high-availability resources.</span></span> <span data-ttu-id="5e664-311">Microsoft heeft een grote hoeveelheid informatie over deze onderwerpen worden gepubliceerd.</span><span class="sxs-lookup"><span data-stu-id="5e664-311">Microsoft has published a large amount of guidance on these topics.</span></span> <span data-ttu-id="5e664-312">Hoewel sommige van deze documenten naar specifieke technieken voor gebruik in andere producten verwijzen, bevatten ze veel algemene aanbevolen procedures die u in de Service Fabric-context toepassen kunt:</span><span class="sxs-lookup"><span data-stu-id="5e664-312">While some of these documents refer to specific techniques for use in other products, they contain many general best practices you can apply in the Service Fabric context as well:</span></span>
  - [<span data-ttu-id="5e664-313">Beschikbaarheidscontrolelijst</span><span class="sxs-lookup"><span data-stu-id="5e664-313">Availability checklist</span></span>](../best-practices-availability-checklist.md)
  - [<span data-ttu-id="5e664-314">Uitvoeren van een herstel na noodgevallen detailanalyse</span><span class="sxs-lookup"><span data-stu-id="5e664-314">Performing a disaster recovery drill</span></span>](../sql-database/sql-database-disaster-recovery-drills.md)
  - <span data-ttu-id="5e664-315">[Herstel na noodgevallen en hoge beschikbaarheid voor Azure-toepassingen][dr-ha-guide]</span><span class="sxs-lookup"><span data-stu-id="5e664-315">[Disaster recovery and high availability for Azure applications][dr-ha-guide]</span></span>
- <span data-ttu-id="5e664-316">Meer informatie over [ondersteuningsopties voor Service Fabric](service-fabric-support.md)</span><span class="sxs-lookup"><span data-stu-id="5e664-316">Learn about [Service Fabric support options](service-fabric-support.md)</span></span>

<!-- External links -->

[repair-partition-ps]: https://msdn.microsoft.com/library/mt163522.aspx
[azure-status-dashboard]:https://azure.microsoft.com/status/
[azure-regions]: https://azure.microsoft.com/regions/
[dr-ha-guide]: https://msdn.microsoft.com/library/azure/dn251004.aspx


<!-- Images -->

[sfx-cluster-map]: ./media/service-fabric-disaster-recovery/sfx-clustermap.png
