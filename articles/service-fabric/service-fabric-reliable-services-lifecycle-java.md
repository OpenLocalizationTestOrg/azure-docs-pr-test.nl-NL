---
title: aaaOverview van Hallo levenscyclus van Azure Service Fabric Reliable Services | Microsoft Docs
description: Meer informatie over Hallo levenscyclus van andere gebeurtenissen in betrouwbare Service Fabric-services
services: Service-Fabric
documentationcenter: java
author: PavanKunapareddyMSFT
manager: timlt
ms.assetid: 
ms.service: Service-Fabric
ms.devlang: java
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 06/30/2017
ms.author: pakunapa;
ms.openlocfilehash: 6d48c217d12bc5248c2da57b544aac747cecd872
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 10/06/2017
---
# <a name="reliable-services-lifecycle-overview"></a><span data-ttu-id="37440-103">Overzicht van de levenscyclus van betrouwbare services</span><span class="sxs-lookup"><span data-stu-id="37440-103">Reliable services lifecycle overview</span></span>
> [!div class="op_single_selector"]
> * [<span data-ttu-id="37440-104">C# op Windows</span><span class="sxs-lookup"><span data-stu-id="37440-104">C# on Windows</span></span>](service-fabric-reliable-services-lifecycle.md)
> * [<span data-ttu-id="37440-105">Java op Linux</span><span class="sxs-lookup"><span data-stu-id="37440-105">Java on Linux</span></span>](service-fabric-reliable-services-lifecycle-java.md)
>
>

<span data-ttu-id="37440-106">Wanneer u nadenkt over Hallo levenscycli van Reliable Services, zijn Hallo basisprincipes van de levenscyclus van Hallo Hallo belangrijkste.</span><span class="sxs-lookup"><span data-stu-id="37440-106">When thinking about hello lifecycles of Reliable Services, hello basics of hello lifecycle are hello most important.</span></span> <span data-ttu-id="37440-107">In het algemeen:</span><span class="sxs-lookup"><span data-stu-id="37440-107">In general:</span></span>

* <span data-ttu-id="37440-108">Tijdens het opstarten</span><span class="sxs-lookup"><span data-stu-id="37440-108">During Startup</span></span>
  * <span data-ttu-id="37440-109">Services zijn gebouwd</span><span class="sxs-lookup"><span data-stu-id="37440-109">Services are constructed</span></span>
  * <span data-ttu-id="37440-110">Ze hebben een kans tooconstruct en nul of meer listeners retourneren</span><span class="sxs-lookup"><span data-stu-id="37440-110">They have an opportunity tooconstruct and return zero or more listeners</span></span>
  * <span data-ttu-id="37440-111">Elke geretourneerde luisteraars worden geopend, zodat de communicatie met de Hallo-service</span><span class="sxs-lookup"><span data-stu-id="37440-111">Any returned listeners are opened, allowing communication with hello service</span></span>
  * <span data-ttu-id="37440-112">Hallo-Service runAsync-methode wordt aangeroepen, toe te staan Hallo service toodo langlopende of werk op de achtergrond</span><span class="sxs-lookup"><span data-stu-id="37440-112">hello Service's runAsync method is called, allowing hello service toodo long running or background work</span></span>
* <span data-ttu-id="37440-113">Tijdens het afsluiten</span><span class="sxs-lookup"><span data-stu-id="37440-113">During shutdown</span></span>
  * <span data-ttu-id="37440-114">Hallo annulering token doorgegeven toorunAsync wordt geannuleerd en Hallo-listeners zijn gesloten</span><span class="sxs-lookup"><span data-stu-id="37440-114">hello cancellation token passed toorunAsync is canceled, and hello listeners are closed</span></span>
  * <span data-ttu-id="37440-115">Eenmaal is voltooid, wordt Hallo serviceobject zelf destructed</span><span class="sxs-lookup"><span data-stu-id="37440-115">Once that is complete, hello service object itself is destructed</span></span>

<span data-ttu-id="37440-116">Er zijn details rond Hallo exacte ordening van deze gebeurtenissen.</span><span class="sxs-lookup"><span data-stu-id="37440-116">There are details around hello exact ordering of these events.</span></span> <span data-ttu-id="37440-117">Hallo-volgorde van gebeurtenissen mogelijk in het bijzonder enigszins, afhankelijk van Hallo betrouwbare Service Stateless of Stateful wijzigen.</span><span class="sxs-lookup"><span data-stu-id="37440-117">In particular, hello order of events may change slightly depending on whether hello Reliable Service is Stateless or Stateful.</span></span> <span data-ttu-id="37440-118">Daarnaast hebben we voor stateful services toodeal met Hallo primaire wisselen scenario.</span><span class="sxs-lookup"><span data-stu-id="37440-118">In addition, for stateful services, we have toodeal with hello Primary swap scenario.</span></span> <span data-ttu-id="37440-119">Tijdens deze reeks Hallo-functie van primaire replica is overgedragen tooanother (of terugkomt) zonder Hallo-service is afgesloten.</span><span class="sxs-lookup"><span data-stu-id="37440-119">During this sequence, hello role of Primary is transferred tooanother replica (or comes back) without hello service shutting down.</span></span> <span data-ttu-id="37440-120">Ten slotte hebben we toothink over fout of storing voorwaarden.</span><span class="sxs-lookup"><span data-stu-id="37440-120">Finally, we have toothink about error or failure conditions.</span></span>

## <a name="stateless-service-startup"></a><span data-ttu-id="37440-121">Staatloze service is gestart</span><span class="sxs-lookup"><span data-stu-id="37440-121">Stateless service startup</span></span>
<span data-ttu-id="37440-122">levenscyclus van een staatloze service Hallo is zeer eenvoudig.</span><span class="sxs-lookup"><span data-stu-id="37440-122">hello lifecycle of a stateless service is fairly straightforward.</span></span> <span data-ttu-id="37440-123">Hier volgt Hallo volgorde van gebeurtenissen:</span><span class="sxs-lookup"><span data-stu-id="37440-123">Here's hello order of events:</span></span>

1. <span data-ttu-id="37440-124">Hallo wordt Service samengesteld</span><span class="sxs-lookup"><span data-stu-id="37440-124">hello Service is constructed</span></span>
2. <span data-ttu-id="37440-125">Klik in de parallelle twee dingen gebeuren:</span><span class="sxs-lookup"><span data-stu-id="37440-125">Then, in parallel two things happen:</span></span>
    - <span data-ttu-id="37440-126">`StatelessService.createServiceInstanceListeners()`wordt aangeroepen en elke geretourneerde luisteraars worden geopend (`CommunicationListener.openAsync()` is aangeroepen voor elke listener)</span><span class="sxs-lookup"><span data-stu-id="37440-126">`StatelessService.createServiceInstanceListeners()` is invoked and any returned listeners are Opened (`CommunicationListener.openAsync()` is called on each listener)</span></span>
    - <span data-ttu-id="37440-127">Hallo van service runAsync-methode (`StatelessService.runAsync()`) wordt genoemd</span><span class="sxs-lookup"><span data-stu-id="37440-127">hello service's runAsync method (`StatelessService.runAsync()`) is called</span></span>
3. <span data-ttu-id="37440-128">Indien aanwezig, Hallo van service onOpenAsync methode is aangeroepen (in het bijzonder `StatelessService.onOpenAsync()` wordt aangeroepen.</span><span class="sxs-lookup"><span data-stu-id="37440-128">If present, hello service's own onOpenAsync method is called (Specifically, `StatelessService.onOpenAsync()` is called.</span></span> <span data-ttu-id="37440-129">Dit is een onderdrukking ongewoon maar deze beschikbaar is).</span><span class="sxs-lookup"><span data-stu-id="37440-129">This is an uncommon override but it is available).</span></span>

<span data-ttu-id="37440-130">Het is belangrijk toonote of er is geen ordening tussen Hallo aanroepen toocreate en open Hallo listeners en runAsync.</span><span class="sxs-lookup"><span data-stu-id="37440-130">It is important toonote that there is no ordering between hello calls toocreate and open hello listeners and runAsync.</span></span> <span data-ttu-id="37440-131">Hallo-listeners geopend voordat runAsync wordt gestart.</span><span class="sxs-lookup"><span data-stu-id="37440-131">hello listeners may open before runAsync is started.</span></span> <span data-ttu-id="37440-132">Op deze manier runAsync mogelijk uiteindelijk aangeroepen voordat de communicatielisteners Hallo geopend zijn of zelfs is samengesteld.</span><span class="sxs-lookup"><span data-stu-id="37440-132">Similarly, runAsync may end up invoked before hello communication listeners are open or have even been constructed.</span></span> <span data-ttu-id="37440-133">Als geen synchronisatie vereist is, is het een oefening toohello implementeerder gehandhaafd.</span><span class="sxs-lookup"><span data-stu-id="37440-133">If any synchronization is required, it is left as an exercise toohello implementer.</span></span> <span data-ttu-id="37440-134">Algemene oplossingen:</span><span class="sxs-lookup"><span data-stu-id="37440-134">Common solutions:</span></span>

* <span data-ttu-id="37440-135">Soms werkt listeners alleen als andere informatie is gemaakt of gewerkte.</span><span class="sxs-lookup"><span data-stu-id="37440-135">Sometimes listeners can't function until some other information is created or work done.</span></span> <span data-ttu-id="37440-136">Voor stateless services die werk meestal kan worden uitgevoerd in de constructor Hallo-service tijdens het Hallo `createServiceInstanceListeners()` aanroepen, of als onderdeel van het Hallo-constructie van Hallo-listener zelf.</span><span class="sxs-lookup"><span data-stu-id="37440-136">For stateless services that work can usually be done in hello service's constructor, during hello `createServiceInstanceListeners()` call, or as a part of hello construction of hello listener itself.</span></span>
* <span data-ttu-id="37440-137">Soms wil hello code in runAsync niet toostart totdat het Hallo-listeners zijn geopend.</span><span class="sxs-lookup"><span data-stu-id="37440-137">Sometimes hello code in runAsync does not want toostart until hello listeners are open.</span></span> <span data-ttu-id="37440-138">In dit geval is aanvullende coördinatie nodig.</span><span class="sxs-lookup"><span data-stu-id="37440-138">In this case additional coordination is necessary.</span></span> <span data-ttu-id="37440-139">Een veelgebruikte oplossing is een aantal markering binnen Hallo-listeners die aangeeft wanneer ze hebt voltooid, die wordt gecontroleerd in runAsync voordat u doorgaat tooactual werk.</span><span class="sxs-lookup"><span data-stu-id="37440-139">One common solution is some flag within hello listeners indicating when they have completed, which is checked in runAsync before continuing tooactual work.</span></span>

## <a name="stateless-service-shutdown"></a><span data-ttu-id="37440-140">Afsluiten van de staatloze service</span><span class="sxs-lookup"><span data-stu-id="37440-140">Stateless service shutdown</span></span>
<span data-ttu-id="37440-141">Wanneer een stateless service wordt afgesloten, wordt hello hetzelfde patroon gevolgd, alleen in omgekeerde volgorde:</span><span class="sxs-lookup"><span data-stu-id="37440-141">When shutting down a stateless service, hello same pattern is followed, just in reverse:</span></span>

1. <span data-ttu-id="37440-142">Parallel</span><span class="sxs-lookup"><span data-stu-id="37440-142">In parallel</span></span>
    - <span data-ttu-id="37440-143">Alle open listeners zijn gesloten (`CommunicationListener.closeAsync()` is aangeroepen voor elke listener)</span><span class="sxs-lookup"><span data-stu-id="37440-143">Any open listeners are Closed (`CommunicationListener.closeAsync()` is called on each listener)</span></span>
    - <span data-ttu-id="37440-144">Hallo annulering token doorgegeven te`runAsync()` is geannuleerd (Hallo annulering token controleren `isCancelled` eigenschap true retourneert, en als het Hallo-token aangeroepen `throwIfCancellationRequested` methode er wordt een `CancellationException`)</span><span class="sxs-lookup"><span data-stu-id="37440-144">hello cancellation token passed too`runAsync()` is canceled (checking hello cancellation token's `isCancelled` property returns true, and if called hello token's `throwIfCancellationRequested` method throws a `CancellationException`)</span></span>
2. <span data-ttu-id="37440-145">Eenmaal `closeAsync()` is voltooid op elke listener en `runAsync()` ook is voltooid, Hallo-service `StatelessService.onCloseAsync()` methode wordt aangeroepen, indien aanwezig (opnieuw dit is een ongewoon onderdrukking).</span><span class="sxs-lookup"><span data-stu-id="37440-145">Once `closeAsync()` completes on each listener and `runAsync()` also completes, hello service's `StatelessService.onCloseAsync()` method is called, if present (again this is an uncommon override).</span></span>
3. <span data-ttu-id="37440-146">Na `StatelessService.onCloseAsync()` is voltooid, Hallo serviceobject wordt destructed</span><span class="sxs-lookup"><span data-stu-id="37440-146">After `StatelessService.onCloseAsync()` completes, hello service object is destructed</span></span>

## <a name="notes-on-service-lifecycle"></a><span data-ttu-id="37440-147">Opmerkingen bij de levenscyclus van de service</span><span class="sxs-lookup"><span data-stu-id="37440-147">Notes on service lifecycle</span></span>
* <span data-ttu-id="37440-148">Beide Hallo `runAsync()` methode en Hallo `createServiceInstanceListeners` aanroepen zijn optioneel.</span><span class="sxs-lookup"><span data-stu-id="37440-148">Both hello `runAsync()` method and hello `createServiceInstanceListeners` calls are optional.</span></span> <span data-ttu-id="37440-149">Een service kan één van deze beide of geen van beide hebben.</span><span class="sxs-lookup"><span data-stu-id="37440-149">A service may have one of them, both, or neither.</span></span> <span data-ttu-id="37440-150">Bijvoorbeeld, als het Hallo-service alle zijn werk in het antwoord toouser aanroepen doet, hoeft niet voor tooimplement `runAsync()`.</span><span class="sxs-lookup"><span data-stu-id="37440-150">For example, if hello service does all its work in response toouser calls, there is no need for it tooimplement `runAsync()`.</span></span> <span data-ttu-id="37440-151">Alleen Hallo communicatielisteners en hun bijbehorende code zijn nodig.</span><span class="sxs-lookup"><span data-stu-id="37440-151">Only hello communication listeners and their associated code are necessary.</span></span> <span data-ttu-id="37440-152">Op deze manier maken communicatielisteners retourneren is optioneel, want het Hallo-service mogelijk alleen de achtergrond toodo werken en hoeft dus alleen tooimplement`runAsync()`</span><span class="sxs-lookup"><span data-stu-id="37440-152">Similarly, creating and returning communication listeners is optional, as hello service may have only background work toodo, and so only needs tooimplement `runAsync()`</span></span>
* <span data-ttu-id="37440-153">Is geldig voor een service-toocomplete `runAsync()` is en dat het resultaat van deze.</span><span class="sxs-lookup"><span data-stu-id="37440-153">It is valid for a service toocomplete `runAsync()` successfully and return from it.</span></span> <span data-ttu-id="37440-154">Dit wordt niet beschouwd als een voorwaarde is mislukt en zou vertegenwoordigen achtergrondwerk Hallo Hallo service om te voltooien.</span><span class="sxs-lookup"><span data-stu-id="37440-154">This is not considered a failure condition and would represent hello background work of hello service completing.</span></span> <span data-ttu-id="37440-155">Voor stateful betrouwbare services `runAsync()` opnieuw zou worden aangeroepen als Hallo service werden gedegradeerd van primaire en vervolgens back tooprimary gepromoveerd.</span><span class="sxs-lookup"><span data-stu-id="37440-155">For stateful reliable services `runAsync()` would be called again if hello service were demoted from primary and then promoted back tooprimary.</span></span>
* <span data-ttu-id="37440-156">Als een service afsluit `runAsync()` door er een onverwachte uitzondering is opgetreden, dit is een fout en Hallo serviceobject wordt afgesloten en een statusfout gemeld.</span><span class="sxs-lookup"><span data-stu-id="37440-156">If a service exits from `runAsync()` by throwing some unexpected exception, this is a failure and hello service object is shut down and a health error reported.</span></span>
* <span data-ttu-id="37440-157">Hoewel er geen tijdslimiet bij het retourneren van deze methoden, kunt u onmiddellijk verliezen Hallo mogelijkheid toowrite en daarom echte werk niet voltooien.</span><span class="sxs-lookup"><span data-stu-id="37440-157">While there is no time limit on returning from these methods, you immediately lose hello ability toowrite and therefore cannot complete any real work.</span></span> <span data-ttu-id="37440-158">Het is raadzaam dat u zo snel mogelijk na ontvangst van de annuleringsaanvraag Hallo terugkeren.</span><span class="sxs-lookup"><span data-stu-id="37440-158">It is recommended that you return as quickly as possible upon receiving hello cancellation request.</span></span> <span data-ttu-id="37440-159">Als uw service toothese API-aanroepen niet reageert binnen een redelijk tijdsbestek die service Fabric mogelijk geforceerd uw service beëindigen.</span><span class="sxs-lookup"><span data-stu-id="37440-159">If your service does not respond toothese API calls in a reasonable amount of time Service Fabric may forcibly terminate your service.</span></span> <span data-ttu-id="37440-160">Meestal gebeurt dit alleen tijdens toepassingsupgrades of wanneer een service wordt verwijderd.</span><span class="sxs-lookup"><span data-stu-id="37440-160">Usually this only happens during application upgrades or when a service is being deleted.</span></span> <span data-ttu-id="37440-161">Deze time-out is 15 minuten standaard.</span><span class="sxs-lookup"><span data-stu-id="37440-161">This timeout is 15 minutes by default.</span></span>
* <span data-ttu-id="37440-162">Fouten in Hallo `onCloseAsync()` pad leiden tot een `onAbort()` wordt aangeroepen dit is een kans van de laatste kans best-effort voor Hallo tooclean up service en laat alle bronnen die ze hebben aangevraagd.</span><span class="sxs-lookup"><span data-stu-id="37440-162">Failures in hello `onCloseAsync()` path result in `onAbort()` being called which is a last-chance best-effort opportunity for hello service tooclean up and release any resources that they have claimed.</span></span>

> [!NOTE]
> <span data-ttu-id="37440-163">Stateful betrouwbare services worden nog niet ondersteund in java.</span><span class="sxs-lookup"><span data-stu-id="37440-163">Stateful reliable services are not supported in java yet.</span></span>
>
>

## <a name="next-steps"></a><span data-ttu-id="37440-164">Volgende stappen</span><span class="sxs-lookup"><span data-stu-id="37440-164">Next steps</span></span>
* [<span data-ttu-id="37440-165">Inleiding tooReliable Services</span><span class="sxs-lookup"><span data-stu-id="37440-165">Introduction tooReliable Services</span></span>](service-fabric-reliable-services-introduction.md)
* [<span data-ttu-id="37440-166">Betrouwbare Services snel starten</span><span class="sxs-lookup"><span data-stu-id="37440-166">Reliable Services quick start</span></span>](service-fabric-reliable-services-quick-start.md)
* [<span data-ttu-id="37440-167">Reliable Services geavanceerde gebruik</span><span class="sxs-lookup"><span data-stu-id="37440-167">Reliable Services advanced usage</span></span>](service-fabric-reliable-services-advanced-usage.md)
