---
title: Richtlijnen en aanbevelingen voor betrouwbare verzamelingen in Azure Service Fabric | Microsoft Docs
description: Richtlijnen en aanbevelingen voor het gebruik van betrouwbare Service Fabric-verzamelingen
services: service-fabric
documentationcenter: .net
author: mcoskun
manager: timlt
editor: masnider,rajak
ms.assetid: 62857523-604b-434e-bd1c-2141ea4b00d1
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: required
ms.date: 5/3/2017
ms.author: mcoskun
ms.openlocfilehash: 053a7bca76362035e428fc11806b3e4f83d00946
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 07/11/2017
---
# <a name="guidelines-and-recommendations-for-reliable-collections-in-azure-service-fabric"></a><span data-ttu-id="969c4-103">Richtlijnen en aanbevelingen voor betrouwbare verzamelingen in Azure Service Fabric</span><span class="sxs-lookup"><span data-stu-id="969c4-103">Guidelines and recommendations for Reliable Collections in Azure Service Fabric</span></span>
<span data-ttu-id="969c4-104">Deze sectie bevat richtlijnen voor het gebruik van betrouwbare statusbeheer en betrouwbare verzamelingen.</span><span class="sxs-lookup"><span data-stu-id="969c4-104">This section provides guidelines for using Reliable State Manager and Reliable Collections.</span></span> <span data-ttu-id="969c4-105">Het doel is om gebruikers niet voor verrassingen.</span><span class="sxs-lookup"><span data-stu-id="969c4-105">The goal is to help users avoid common pitfalls.</span></span>

<span data-ttu-id="969c4-106">De richtlijnen zijn ingedeeld als eenvoudige aanbevelingen die worden voorafgegaan door de voorwaarden *doen*, *Overweeg*, *Vermijd* en *niet*.</span><span class="sxs-lookup"><span data-stu-id="969c4-106">The guidelines are organized as simple recommendations prefixed with the terms *Do*, *Consider*, *Avoid* and *Do not*.</span></span>

* <span data-ttu-id="969c4-107">Een object van het aangepaste type dat wordt geretourneerd door leesbewerkingen mag niet worden gewijzigd (bijvoorbeeld `TryPeekAsync` of `TryGetValueAsync`).</span><span class="sxs-lookup"><span data-stu-id="969c4-107">Do not modify an object of custom type returned by read operations (for example, `TryPeekAsync` or `TryGetValueAsync`).</span></span> <span data-ttu-id="969c4-108">Betrouwbare verzamelingen, net als bij gelijktijdige verzamelingen, een verwijzing retourneren naar de objecten en geen kopie.</span><span class="sxs-lookup"><span data-stu-id="969c4-108">Reliable Collections, just like Concurrent Collections, return a reference to the objects and not a copy.</span></span>
* <span data-ttu-id="969c4-109">Doen diepe kopie het geretourneerde object van een aangepast type voordat u deze wijzigt.</span><span class="sxs-lookup"><span data-stu-id="969c4-109">Do deep copy the returned object of a custom type before modifying it.</span></span> <span data-ttu-id="969c4-110">Aangezien structs en ingebouwde typen pass-by-value, hoeft u niet een diepe kopie op te doen.</span><span class="sxs-lookup"><span data-stu-id="969c4-110">Since structs and built-in types are pass-by-value, you do not need to do a deep copy on them.</span></span>
* <span data-ttu-id="969c4-111">Gebruik geen `TimeSpan.MaxValue` voor time-outs.</span><span class="sxs-lookup"><span data-stu-id="969c4-111">Do not use `TimeSpan.MaxValue` for time-outs.</span></span> <span data-ttu-id="969c4-112">Time-outs moeten worden gebruikt voor het detecteren van impassen.</span><span class="sxs-lookup"><span data-stu-id="969c4-112">Time-outs should be used to detect deadlocks.</span></span>
* <span data-ttu-id="969c4-113">Gebruik een transactie niet nadat deze is toegewezen, is afgebroken, of verwijderd.</span><span class="sxs-lookup"><span data-stu-id="969c4-113">Do not use a transaction after it has been committed, aborted, or disposed.</span></span>
* <span data-ttu-id="969c4-114">Gebruik een opsomming niet buiten het transactiebereik dat is gemaakt in.</span><span class="sxs-lookup"><span data-stu-id="969c4-114">Do not use an enumeration outside of the transaction scope it was created in.</span></span>
* <span data-ttu-id="969c4-115">Maak een transactie in een andere transactie geen `using` instructie omdat dit ertoe leiden impassen dat kan.</span><span class="sxs-lookup"><span data-stu-id="969c4-115">Do not create a transaction within another transaction’s `using` statement because it can cause deadlocks.</span></span>
* <span data-ttu-id="969c4-116">Kan ervoor zorgen dat uw `IComparable<TKey>` implementatie juist is.</span><span class="sxs-lookup"><span data-stu-id="969c4-116">Do ensure that your `IComparable<TKey>` implementation is correct.</span></span> <span data-ttu-id="969c4-117">Het systeem neemt afhankelijkheid `IComparable<TKey>` voor het samenvoegen van controlepunten en rijen.</span><span class="sxs-lookup"><span data-stu-id="969c4-117">The system takes dependency on `IComparable<TKey>` for merging checkpoints and rows.</span></span>
* <span data-ttu-id="969c4-118">Gebruik vergrendeling tijdens bijwerken bij het lezen van een item met een doel om bij te werken om te voorkomen dat een bepaalde klasse impassen.</span><span class="sxs-lookup"><span data-stu-id="969c4-118">Do use Update lock when reading an item with an intention to update it to prevent a certain class of deadlocks.</span></span>
* <span data-ttu-id="969c4-119">Overweeg te houden van uw objecten (bijvoorbeeld TKey + TValue voor betrouwbare woordenlijst) lager dan 80 kB: kleiner hoe beter.</span><span class="sxs-lookup"><span data-stu-id="969c4-119">Consider keeping your items (for example, TKey + TValue for Reliable Dictionary) below 80 KBytes: smaller the better.</span></span> <span data-ttu-id="969c4-120">Dit reduceert de hoeveelheid Heap voor grote objecten gebruik, evenals de schijf en netwerk i/o-vereisten.</span><span class="sxs-lookup"><span data-stu-id="969c4-120">This reduces the amount of Large Object Heap usage as well as disk and network IO requirements.</span></span> <span data-ttu-id="969c4-121">Vaak vermindert dubbele gegevens repliceren wanneer er slechts één klein onderdeel van de waarde wordt bijgewerkt.</span><span class="sxs-lookup"><span data-stu-id="969c4-121">Often, it reduces replicating duplicate data when only one small part of the value is being updated.</span></span> <span data-ttu-id="969c4-122">Veelgebruikte manier om dit te bereiken in betrouwbare woordenlijst is uw rijen te breken op meerdere rijen.</span><span class="sxs-lookup"><span data-stu-id="969c4-122">Common way to achieve this in Reliable Dictionary, is to break your rows in to multiple rows.</span></span>
* <span data-ttu-id="969c4-123">Overweeg het gebruik van back-up en herstel functionaliteit om het herstel na noodgevallen hebben.</span><span class="sxs-lookup"><span data-stu-id="969c4-123">Consider using backup and restore functionality to have disaster recovery.</span></span>
* <span data-ttu-id="969c4-124">Voorkomen dat de combinatie van één entiteit operations en bewerkingen voor meerdere entiteiten (bijvoorbeeld `GetCountAsync`, `CreateEnumerableAsync`) in dezelfde transactie vanwege de verschillende isolatieniveaus.</span><span class="sxs-lookup"><span data-stu-id="969c4-124">Avoid mixing single entity operations and multi-entity operations (e.g `GetCountAsync`, `CreateEnumerableAsync`) in the same transaction due to the different isolation levels.</span></span>
* <span data-ttu-id="969c4-125">InvalidOperationException worden verwerkt.</span><span class="sxs-lookup"><span data-stu-id="969c4-125">Do handle InvalidOperationException.</span></span> <span data-ttu-id="969c4-126">Door het systeem om verschillende redenen kunnen gebruikerstransacties worden afgebroken.</span><span class="sxs-lookup"><span data-stu-id="969c4-126">User transactions can be aborted by the system for variety of reasons.</span></span> <span data-ttu-id="969c4-127">Bijvoorbeeld, is wanneer de betrouwbare status Manager de rol buiten-primaire wordt gewijzigd of wanneer een transactie langlopende het afkappen van het logboek voor transactionele blokkeert.</span><span class="sxs-lookup"><span data-stu-id="969c4-127">For example, when the Reliable State Manager is changing its role out of Primary or when a long-running transaction is blocking truncation of the transactional log.</span></span> <span data-ttu-id="969c4-128">In dergelijke gevallen ontvangt gebruiker InvalidOperationException die aangeeft dat de transactie al is beëindigd.</span><span class="sxs-lookup"><span data-stu-id="969c4-128">In such cases, user may receive InvalidOperationException indicating that their transaction has already been terminated.</span></span> <span data-ttu-id="969c4-129">Ervan uitgaande dat, de beëindiging van de transactie is niet aangevraagd door de gebruiker aanbevolen manier voor het verwerken van deze uitzondering is bij het verwijderen van de transactie, Controleer of het token annulering zijn gesignaleerd (of de rol van de replica is gewijzigd), en als dat niet Maak een nieuwe transactie en probeer het opnieuw.</span><span class="sxs-lookup"><span data-stu-id="969c4-129">Assuming, the termination of the transaction was not requested by the user, best way to handle this exception is to dispose the transaction, check if the cancellation token has been signaled (or the role of the replica has been changed), and if not create a new transaction and retry.</span></span>  

<span data-ttu-id="969c4-130">Hier volgen een aantal zaken rekening moet houden:</span><span class="sxs-lookup"><span data-stu-id="969c4-130">Here are some things to keep in mind:</span></span>

* <span data-ttu-id="969c4-131">De standaardtime-out is vier seconden voor alle betrouwbare verzameling API's.</span><span class="sxs-lookup"><span data-stu-id="969c4-131">The default time-out is four seconds for all the Reliable Collection APIs.</span></span> <span data-ttu-id="969c4-132">De meeste gebruikers moeten de standaardtime-out gebruiken.</span><span class="sxs-lookup"><span data-stu-id="969c4-132">Most users should use the default time-out.</span></span>
* <span data-ttu-id="969c4-133">Het token van de annulering standaard `CancellationToken.None` in alle betrouwbare verzamelingen-API's.</span><span class="sxs-lookup"><span data-stu-id="969c4-133">The default cancellation token is `CancellationToken.None` in all Reliable Collections APIs.</span></span>
* <span data-ttu-id="969c4-134">De parameter sleuteltype (*TKey*) voor een betrouwbare woordenlijst correct moet implementeren `GetHashCode()` en `Equals()`.</span><span class="sxs-lookup"><span data-stu-id="969c4-134">The key type parameter (*TKey*) for a Reliable Dictionary must correctly implement `GetHashCode()` and `Equals()`.</span></span> <span data-ttu-id="969c4-135">Sleutels moeten niet-wijzigbaar.</span><span class="sxs-lookup"><span data-stu-id="969c4-135">Keys must be immutable.</span></span>
* <span data-ttu-id="969c4-136">Om te zorgen voor hoge beschikbaarheid voor de betrouwbare verzamelingen, moet elke service ten minste een doel en de minimale grootte van 3 replicaset hebben.</span><span class="sxs-lookup"><span data-stu-id="969c4-136">To achieve high availability for the Reliable Collections, each service should have at least a target and minimum replica set size of 3.</span></span>
* <span data-ttu-id="969c4-137">Leesbewerkingen op de secundaire versies die niet doorgevoerd quorum zijn mag worden gelezen.</span><span class="sxs-lookup"><span data-stu-id="969c4-137">Read operations on the secondary may read versions that are not quorum committed.</span></span>
  <span data-ttu-id="969c4-138">Dit betekent dat een versie van de gegevens die worden gelezen van een enkel secundaire ONWAAR kan worden gevorderd.</span><span class="sxs-lookup"><span data-stu-id="969c4-138">This means that a version of data that is read from a single secondary might be false progressed.</span></span>
  <span data-ttu-id="969c4-139">Leesbewerkingen van primaire zijn altijd stabiele: kan nooit worden false gevorderd.</span><span class="sxs-lookup"><span data-stu-id="969c4-139">Reads from Primary are always stable: can never be false progressed.</span></span>

### <a name="next-steps"></a><span data-ttu-id="969c4-140">Volgende stappen</span><span class="sxs-lookup"><span data-stu-id="969c4-140">Next steps</span></span>
* [<span data-ttu-id="969c4-141">Werken met betrouwbare verzamelingen</span><span class="sxs-lookup"><span data-stu-id="969c4-141">Working with Reliable Collections</span></span>](service-fabric-work-with-reliable-collections.md)
* [<span data-ttu-id="969c4-142">Transacties en vergrendelingen</span><span class="sxs-lookup"><span data-stu-id="969c4-142">Transactions and Locks</span></span>](service-fabric-reliable-services-reliable-collections-transactions-locks.md)
* [<span data-ttu-id="969c4-143">Betrouwbare status Manager en interne werking van verzameling</span><span class="sxs-lookup"><span data-stu-id="969c4-143">Reliable State Manager and Collection Internals</span></span>](service-fabric-reliable-services-reliable-collections-internals.md)
* <span data-ttu-id="969c4-144">Het beheren van gegevens</span><span class="sxs-lookup"><span data-stu-id="969c4-144">Managing Data</span></span>
  * [<span data-ttu-id="969c4-145">Back-up en herstel</span><span class="sxs-lookup"><span data-stu-id="969c4-145">Backup and Restore</span></span>](service-fabric-reliable-services-backup-restore.md)
  * [<span data-ttu-id="969c4-146">Meldingen</span><span class="sxs-lookup"><span data-stu-id="969c4-146">Notifications</span></span>](service-fabric-reliable-services-notifications.md)
  * [<span data-ttu-id="969c4-147">Serialisatie en Upgrade</span><span class="sxs-lookup"><span data-stu-id="969c4-147">Serialization and Upgrade</span></span>](service-fabric-application-upgrade-data-serialization.md)
  * [<span data-ttu-id="969c4-148">Betrouwbaar status Manager-configuratie</span><span class="sxs-lookup"><span data-stu-id="969c4-148">Reliable State Manager configuration</span></span>](service-fabric-reliable-services-configuration.md)
* <span data-ttu-id="969c4-149">Andere</span><span class="sxs-lookup"><span data-stu-id="969c4-149">Others</span></span>
  * [<span data-ttu-id="969c4-150">Betrouwbare Services snel starten</span><span class="sxs-lookup"><span data-stu-id="969c4-150">Reliable Services quick start</span></span>](service-fabric-reliable-services-quick-start.md)
  * [<span data-ttu-id="969c4-151">Referentie voor ontwikkelaars voor betrouwbare verzamelingen</span><span class="sxs-lookup"><span data-stu-id="969c4-151">Developer reference for Reliable Collections</span></span>](https://msdn.microsoft.com/library/azure/microsoft.servicefabric.data.collections.aspx)
