---
title: 'Testbaarheid: Service communicatie | Microsoft Docs'
description: Service to service-communicatie is een kritieke integratie van een Service Fabric-toepassing. Dit artikel worden de overwegingen bij het ontwerpen en testen technieken.
services: service-fabric
documentationcenter: .net
author: vturecek
manager: timlt
editor: 
ms.assetid: 017557df-fb59-4e4a-a65d-2732f29255b8
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 06/29/2017
ms.author: vturecek
ms.openlocfilehash: 4a8f941c1e8e641384a9ee3a1149dabaaf9983cc
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 10/06/2017
---
# <a name="service-fabric-testability-scenarios-service-communication"></a><span data-ttu-id="7c5eb-104">Service Fabric-testbaarheid scenario's: Service-communicatie</span><span class="sxs-lookup"><span data-stu-id="7c5eb-104">Service Fabric testability scenarios: Service communication</span></span>
<span data-ttu-id="7c5eb-105">Microservices en architectuur stijlen service oriented vlak natuurlijk in Azure Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="7c5eb-105">Microservices and service-oriented architectural styles surface naturally in Azure Service Fabric.</span></span> <span data-ttu-id="7c5eb-106">In deze soorten architecturen voor gedistribueerde, samengestelde microservice toepassingen doorgaans bestaan uit meerdere services die tootalk tooeach andere moeten.</span><span class="sxs-lookup"><span data-stu-id="7c5eb-106">In these types of distributed architectures, componentized microservice applications are typically composed of multiple services that need tootalk tooeach other.</span></span> <span data-ttu-id="7c5eb-107">In het eenvoudigste gevallen zelfs hello, in het algemeen hebt u ten minste een stateless webservice en een stateful data storage-service die toocommunicate nodig.</span><span class="sxs-lookup"><span data-stu-id="7c5eb-107">In even hello simplest cases, you generally have at least a stateless web service and a stateful data storage service that need toocommunicate.</span></span>

<span data-ttu-id="7c5eb-108">Service to service-communicatie is een kritieke integratie van een toepassing, omdat elke service een API-services voor externe tooother beschrijft.</span><span class="sxs-lookup"><span data-stu-id="7c5eb-108">Service-to-service communication is a critical integration point of an application, because each service exposes a remote API tooother services.</span></span> <span data-ttu-id="7c5eb-109">Werken met een reeks API grenzen waarbij i/o over het algemeen moet zorgvuldig te werk gaan, met een goede hoeveelheid testen en valideren.</span><span class="sxs-lookup"><span data-stu-id="7c5eb-109">Working with a set of API boundaries that involves I/O generally requires some care, with a good amount of testing and validation.</span></span>

<span data-ttu-id="7c5eb-110">Er zijn talrijke overwegingen toomake wanneer deze servicegrenzen samen in een gedistribueerde systeem zijn bekabelde:</span><span class="sxs-lookup"><span data-stu-id="7c5eb-110">There are numerous considerations toomake when these service boundaries are wired together in a distributed system:</span></span>

* <span data-ttu-id="7c5eb-111">*Transportprotocol*.</span><span class="sxs-lookup"><span data-stu-id="7c5eb-111">*Transport protocol*.</span></span> <span data-ttu-id="7c5eb-112">Wilt u HTTP voor verbeterde interoperabiliteit of een aangepaste binaire protocol gebruiken voor maximale doorvoer?</span><span class="sxs-lookup"><span data-stu-id="7c5eb-112">Will you use HTTP for increased interoperability, or a custom binary protocol for maximum throughput?</span></span>
* <span data-ttu-id="7c5eb-113">*Foutafhandeling*.</span><span class="sxs-lookup"><span data-stu-id="7c5eb-113">*Error handling*.</span></span> <span data-ttu-id="7c5eb-114">Hoe wordt permanent en tijdelijke fouten worden verwerkt?</span><span class="sxs-lookup"><span data-stu-id="7c5eb-114">How will permanent and transient errors be handled?</span></span> <span data-ttu-id="7c5eb-115">Wat er gebeurt als een service tooa ander knooppunt verplaatst?</span><span class="sxs-lookup"><span data-stu-id="7c5eb-115">What will happen when a service moves tooa different node?</span></span>
* <span data-ttu-id="7c5eb-116">*Time-outs en latentie*.</span><span class="sxs-lookup"><span data-stu-id="7c5eb-116">*Timeouts and latency*.</span></span> <span data-ttu-id="7c5eb-117">In een toepassingen, hoe elke servicelaag omgaan latentie via Hallo-netwerkstack en toohello gebruiker?</span><span class="sxs-lookup"><span data-stu-id="7c5eb-117">In multitiered applications, how will each service layer handle latency through hello stack and toohello user?</span></span>

<span data-ttu-id="7c5eb-118">Of u een communicatie-onderdelen voor Hallo ingebouwde service is geleverd door de Service Fabric gebruiken of u uw eigen bouwt, is testen van Hallo interacties tussen uw services kritieke tooensuring tolerantie in uw toepassing.</span><span class="sxs-lookup"><span data-stu-id="7c5eb-118">Whether you use one of hello built-in service communication components provided by Service Fabric or you build your own, testing hello interactions between your services is critical tooensuring resiliency in your application.</span></span>

## <a name="prepare-for-services-toomove"></a><span data-ttu-id="7c5eb-119">Voorbereiden op services toomove</span><span class="sxs-lookup"><span data-stu-id="7c5eb-119">Prepare for services toomove</span></span>
<span data-ttu-id="7c5eb-120">Service-exemplaren kunnen navigeren gedurende een bepaalde periode.</span><span class="sxs-lookup"><span data-stu-id="7c5eb-120">Service instances may move around over time.</span></span> <span data-ttu-id="7c5eb-121">Dit geldt met name wanneer ze zijn geconfigureerd met metrische gegevens load balancing optimale resource aangepaste afgestemd.</span><span class="sxs-lookup"><span data-stu-id="7c5eb-121">This is especially true when they are configured with load metrics for custom-tailored optimal resource balancing.</span></span> <span data-ttu-id="7c5eb-122">Service Fabric verplaatst uw service-exemplaren toomaximize hun beschikbaarheid zelfs tijdens upgrades, failovers, scale-out en andere situaties die zich tijdens Hallo levensduur van een gedistribueerde systeem voordoen.</span><span class="sxs-lookup"><span data-stu-id="7c5eb-122">Service Fabric moves your service instances toomaximize their availability even during upgrades, failovers, scale-out, and other situations that occur over hello lifetime of a distributed system.</span></span>

<span data-ttu-id="7c5eb-123">Als services Hallo-cluster navigeren, uw clients en andere services worden voorbereid toohandle twee scenario's wanneer ze tooa service communiceren:</span><span class="sxs-lookup"><span data-stu-id="7c5eb-123">As services move around in hello cluster, your clients and other services should be prepared toohandle two scenarios when they talk tooa service:</span></span>

* <span data-ttu-id="7c5eb-124">Hallo-service-exemplaar of partitie replica is sinds de laatste keer dat er tooit is besproken Hallo verplaatst.</span><span class="sxs-lookup"><span data-stu-id="7c5eb-124">hello service instance or partition replica has moved since hello last time you talked tooit.</span></span> <span data-ttu-id="7c5eb-125">Dit is een normaal onderdeel van de levensduur van een service en het verwachte toohappen moet tijdens de levensduur van uw toepassing hello.</span><span class="sxs-lookup"><span data-stu-id="7c5eb-125">This is a normal part of a service lifecycle, and it should be expected toohappen during hello lifetime of your application.</span></span>
* <span data-ttu-id="7c5eb-126">Hallo-service-exemplaar of partitie replica wordt Hallo-proces voor de upgrade.</span><span class="sxs-lookup"><span data-stu-id="7c5eb-126">hello service instance or partition replica is in hello process of moving.</span></span> <span data-ttu-id="7c5eb-127">Hoewel de failover van een service vanuit één knooppunt tooanother wordt zeer snel in Service Fabric mogelijk zijn er een vertraging in de beschikbaarheid als onderdeel van de Hallo communicatie van uw service toostart traag is.</span><span class="sxs-lookup"><span data-stu-id="7c5eb-127">Although failover of a service from one node tooanother occurs very quickly in Service Fabric, there may be a delay in availability if hello communication component of your service is slow toostart.</span></span>

<span data-ttu-id="7c5eb-128">Afhandeling van deze scenario's zonder problemen is belangrijk voor een systeem vloeiend worden uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="7c5eb-128">Handling these scenarios gracefully is important for a smooth-running system.</span></span> <span data-ttu-id="7c5eb-129">toodo, houd er rekening mee dat:</span><span class="sxs-lookup"><span data-stu-id="7c5eb-129">toodo so, keep in mind that:</span></span>

* <span data-ttu-id="7c5eb-130">Alle services die verbonden toohas worden kan een *adres* die deze luistert op (bijvoorbeeld HTTP of WebSockets).</span><span class="sxs-lookup"><span data-stu-id="7c5eb-130">Every service that can be connected toohas an *address* that it listens on (for example, HTTP or WebSockets).</span></span> <span data-ttu-id="7c5eb-131">Als u een service-exemplaar of de partitie worden verplaatst, verandert de adres-eindpunt.</span><span class="sxs-lookup"><span data-stu-id="7c5eb-131">When a service instance or partition moves, its address endpoint changes.</span></span> <span data-ttu-id="7c5eb-132">(Deze verplaatst tooa ander knooppunt met een ander IP-adres). Als u Hallo ingebouwde communicatie-onderdelen, worden ze opnieuw het omzetten van adressen van de service voor u verwerken.</span><span class="sxs-lookup"><span data-stu-id="7c5eb-132">(It moves tooa different node with a different IP address.) If you're using hello built-in communication components, they will handle re-resolving service addresses for you.</span></span>
* <span data-ttu-id="7c5eb-133">Er is mogelijk een tijdelijke toename in latentie van de service als Hallo het starten van service-exemplaar van de listener opnieuw.</span><span class="sxs-lookup"><span data-stu-id="7c5eb-133">There may be a temporary increase in service latency as hello service instance starts up its listener again.</span></span> <span data-ttu-id="7c5eb-134">Dit is afhankelijk van hoe snel Hallo service Hallo-listener opent nadat Hallo service-exemplaar is verplaatst.</span><span class="sxs-lookup"><span data-stu-id="7c5eb-134">This depends on how quickly hello service opens hello listener after hello service instance is moved.</span></span>
* <span data-ttu-id="7c5eb-135">De bestaande verbindingen moeten toobe gesloten en heropend nadat het Hallo-service op een nieuw knooppunt wordt geopend.</span><span class="sxs-lookup"><span data-stu-id="7c5eb-135">Any existing connections need toobe closed and reopened after hello service opens on a new node.</span></span> <span data-ttu-id="7c5eb-136">Kan de tijd voor bestaande verbindingen toobe afsluiten een correcte knooppunt afsluiten of opnieuw opstarten.</span><span class="sxs-lookup"><span data-stu-id="7c5eb-136">A graceful node shutdown or restart allows time for existing connections toobe shut down gracefully.</span></span>

### <a name="test-it-move-service-instances"></a><span data-ttu-id="7c5eb-137">Het testen: service-exemplaren verplaatsen</span><span class="sxs-lookup"><span data-stu-id="7c5eb-137">Test it: Move service instances</span></span>
<span data-ttu-id="7c5eb-138">Met behulp van Service Fabric-testbaarheid hulpprogramma's, kunt u schrijven een test scenario tootest deze situaties op verschillende manieren:</span><span class="sxs-lookup"><span data-stu-id="7c5eb-138">By using Service Fabric's testability tools, you can author a test scenario tootest these situations in different ways:</span></span>

1. <span data-ttu-id="7c5eb-139">Verplaats de primaire replica van een stateful service.</span><span class="sxs-lookup"><span data-stu-id="7c5eb-139">Move a stateful service's primary replica.</span></span>
   
    <span data-ttu-id="7c5eb-140">Hallo kan primaire replica van een partitie stateful service worden verplaatst voor een aantal redenen.</span><span class="sxs-lookup"><span data-stu-id="7c5eb-140">hello primary replica of a stateful service partition can be moved for any number of reasons.</span></span> <span data-ttu-id="7c5eb-141">Gebruik deze tootarget Hallo primaire replica van een specifieke partitie toosee hoe uw toohello van services reageren op een zeer gecontroleerde manier verplaatsen.</span><span class="sxs-lookup"><span data-stu-id="7c5eb-141">Use this tootarget hello primary replica of a specific partition toosee how your services react toohello move in a very controlled manner.</span></span>
   
    ```powershell
   
    PS > Move-ServiceFabricPrimaryReplica -PartitionId 6faa4ffa-521a-44e9-8351-dfca0f7e0466 -ServiceName fabric:/MyApplication/MyService
   
    ```
2. <span data-ttu-id="7c5eb-142">Een knooppunt stoppen.</span><span class="sxs-lookup"><span data-stu-id="7c5eb-142">Stop a node.</span></span>
   
    <span data-ttu-id="7c5eb-143">Wanneer een knooppunt is gestopt, Hallo Service Fabric-verplaatst alle Hallo service-exemplaren of partities die zich op dat knooppunt tooone van andere beschikbare knooppunten in cluster Hallo.</span><span class="sxs-lookup"><span data-stu-id="7c5eb-143">When a node is stopped, Service Fabric moves all of hello service instances or partitions that were on that node tooone of hello other available nodes in hello cluster.</span></span> <span data-ttu-id="7c5eb-144">Gebruik deze tootest een situatie waarbij een knooppunt van het cluster verloren en alle Hallo service-exemplaren en replica's op dat knooppunt toomove zijn.</span><span class="sxs-lookup"><span data-stu-id="7c5eb-144">Use this tootest a situation where a node is lost from your cluster and all of hello service instances and replicas on that node have toomove.</span></span>
   
    <span data-ttu-id="7c5eb-145">U kunt een knooppunt met behulp van PowerShell Hallo stoppen **Stop ServiceFabricNode** cmdlet:</span><span class="sxs-lookup"><span data-stu-id="7c5eb-145">You can stop a node by using hello PowerShell **Stop-ServiceFabricNode** cmdlet:</span></span>
   
    ```powershell
   
    PS > Restart-ServiceFabricNode -NodeName Node_1
   
    ```

## <a name="maintain-service-availability"></a><span data-ttu-id="7c5eb-146">Beschikbaarheid van Services onderhouden</span><span class="sxs-lookup"><span data-stu-id="7c5eb-146">Maintain service availability</span></span>
<span data-ttu-id="7c5eb-147">Als een platform is Service Fabric ontworpen tooprovide hoge beschikbaarheid van uw services.</span><span class="sxs-lookup"><span data-stu-id="7c5eb-147">As a platform, Service Fabric is designed tooprovide high availability of your services.</span></span> <span data-ttu-id="7c5eb-148">Maar in uitzonderlijke gevallen onderliggende infrastructuurproblemen kunnen nog steeds niet beschikbaar zijn.</span><span class="sxs-lookup"><span data-stu-id="7c5eb-148">But in extreme cases, underlying infrastructure problems can still cause unavailability.</span></span> <span data-ttu-id="7c5eb-149">Het is belangrijk tootest voor deze scenario's te.</span><span class="sxs-lookup"><span data-stu-id="7c5eb-149">It is important tootest for these scenarios, too.</span></span>

<span data-ttu-id="7c5eb-150">De status van een quorum-systeem tooreplicate stateful services gebruiken voor hoge beschikbaarheid.</span><span class="sxs-lookup"><span data-stu-id="7c5eb-150">Stateful services use a quorum-based system tooreplicate state for high availability.</span></span> <span data-ttu-id="7c5eb-151">Dit betekent dat een quorum van replica's toobe beschikbaar tooperform schrijfbewerkingen moet.</span><span class="sxs-lookup"><span data-stu-id="7c5eb-151">This means that a quorum of replicas needs toobe available tooperform write operations.</span></span> <span data-ttu-id="7c5eb-152">In zeldzame gevallen, zoals een wijdverbreid hardwarefout een quorum van replica's mogelijk niet beschikbaar.</span><span class="sxs-lookup"><span data-stu-id="7c5eb-152">In rare cases, such as a widespread hardware failure, a quorum of replicas may not be available.</span></span> <span data-ttu-id="7c5eb-153">In dergelijke gevallen kunnen tooperform schrijfbewerkingen u niet meer worden, maar u zich nog steeds kunnen tooperform leesbewerkingen.</span><span class="sxs-lookup"><span data-stu-id="7c5eb-153">In these cases, you will not be able tooperform write operations, but you will still be able tooperform read operations.</span></span>

### <a name="test-it-write-operation-unavailability"></a><span data-ttu-id="7c5eb-154">Het testen: bewerking onbeschikbaarheid schrijven</span><span class="sxs-lookup"><span data-stu-id="7c5eb-154">Test it: Write operation unavailability</span></span>
<span data-ttu-id="7c5eb-155">Met Hallo testbaarheid hulpprogramma's in Service Fabric, kunt u een fout die quorumverlies als test induceert invoeren.</span><span class="sxs-lookup"><span data-stu-id="7c5eb-155">By using hello testability tools in Service Fabric, you can inject a fault that induces quorum loss as a test.</span></span> <span data-ttu-id="7c5eb-156">Hoewel dit scenario zeldzame, is het belangrijk dat clients en -services die afhankelijk van een stateful service zijn toohandle situaties waar ze geen aanbrengen aanvragen tooit schrijven worden voorbereid.</span><span class="sxs-lookup"><span data-stu-id="7c5eb-156">Although such a scenario is rare, it is important that clients and services that depend on a stateful service are prepared toohandle situations where they cannot make write requests tooit.</span></span> <span data-ttu-id="7c5eb-157">Het is ook belangrijk dat Hallo stateful service zelf op de hoogte van deze mogelijkheid is en probleemloos toocallers communiceren kan.</span><span class="sxs-lookup"><span data-stu-id="7c5eb-157">It is also important that hello stateful service itself is aware of this possibility and can gracefully communicate it toocallers.</span></span>

<span data-ttu-id="7c5eb-158">U kunt quorumverlies veroorzaken met behulp van PowerShell Hallo **Invoke-ServiceFabricPartitionQuorumLoss** cmdlet:</span><span class="sxs-lookup"><span data-stu-id="7c5eb-158">You can induce quorum loss by using hello PowerShell **Invoke-ServiceFabricPartitionQuorumLoss** cmdlet:</span></span>

```powershell

PS > Invoke-ServiceFabricPartitionQuorumLoss -ServiceName fabric:/Myapplication/MyService -QuorumLossMode QuorumReplicas -QuorumLossDurationInSeconds 20

```

<span data-ttu-id="7c5eb-159">In dit voorbeeld wordt ingesteld `QuorumLossMode` te`QuorumReplicas` tooindicate die we tooinduce quorumverlies willen zonder omlaag alle replica's.</span><span class="sxs-lookup"><span data-stu-id="7c5eb-159">In this example, we set `QuorumLossMode` too`QuorumReplicas` tooindicate that we want tooinduce quorum loss without taking down all replicas.</span></span> <span data-ttu-id="7c5eb-160">Op deze manier leesbewerkingen zijn nog steeds mogelijk.</span><span class="sxs-lookup"><span data-stu-id="7c5eb-160">This way, read operations are still possible.</span></span> <span data-ttu-id="7c5eb-161">tootest een scenario waarbij een volledige partitie niet beschikbaar is, u kunt deze schakeloptie te instellen`AllReplicas`.</span><span class="sxs-lookup"><span data-stu-id="7c5eb-161">tootest a scenario where an entire partition is unavailable, you can set this switch too`AllReplicas`.</span></span>

## <a name="next-steps"></a><span data-ttu-id="7c5eb-162">Volgende stappen</span><span class="sxs-lookup"><span data-stu-id="7c5eb-162">Next steps</span></span>
[<span data-ttu-id="7c5eb-163">Meer informatie over testbaarheid acties</span><span class="sxs-lookup"><span data-stu-id="7c5eb-163">Learn more about testability actions</span></span>](service-fabric-testability-actions.md)

[<span data-ttu-id="7c5eb-164">Meer informatie over testbaarheid scenario 's</span><span class="sxs-lookup"><span data-stu-id="7c5eb-164">Learn more about testability scenarios</span></span>](service-fabric-testability-scenarios.md)

