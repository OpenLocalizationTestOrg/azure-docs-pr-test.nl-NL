---
title: aangepaste Service Fabric-statusrapporten aaaAdd | Microsoft Docs
description: Hierin wordt beschreven hoe toosend aangepaste systeemstatusrapporten tooAzure Service Fabric health entiteiten. Geeft aanbevelingen voor het ontwerpen en implementeren van statusrapporten kwaliteit.
services: service-fabric
documentationcenter: .net
author: oanapl
manager: timlt
editor: 
ms.assetid: 0a00a7d2-510e-47d0-8aa8-24c851ea847f
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 07/19/2017
ms.author: oanapl
ms.openlocfilehash: 12c9f664e2a457b4e1e8f340873ca60ebcefb097
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 10/06/2017
---
# <a name="add-custom-service-fabric-health-reports"></a><span data-ttu-id="fd3fe-104">Aangepaste statusrapporten van Service Fabric toevoegen</span><span class="sxs-lookup"><span data-stu-id="fd3fe-104">Add custom Service Fabric health reports</span></span>
<span data-ttu-id="fd3fe-105">Azure Service Fabric introduceert een [statusmodel](service-fabric-health-introduction.md) ontworpen tooflag slecht cluster en de voorwaarden van toepassing op specifieke entiteiten.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-105">Azure Service Fabric introduces a [health model](service-fabric-health-introduction.md) designed tooflag unhealthy cluster and application conditions on specific entities.</span></span> <span data-ttu-id="fd3fe-106">Hallo-statusmodel gebruikt **health rapporteurs** (onderdelen van het systeem en watchdogs).</span><span class="sxs-lookup"><span data-stu-id="fd3fe-106">hello health model uses **health reporters** (system components and watchdogs).</span></span> <span data-ttu-id="fd3fe-107">Hallo-doel is snel en gemakkelijk diagnose en herstel.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-107">hello goal is easy and fast diagnosis and repair.</span></span> <span data-ttu-id="fd3fe-108">Schrijvers van de service moeten toothink tevoren over status.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-108">Service writers need toothink upfront about health.</span></span> <span data-ttu-id="fd3fe-109">Een voorwaarde die van invloed kan status moet worden gerapporteerd, vooral als vlag problemen sluiten toohello root kunt u.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-109">Any condition that can impact health should be reported on, especially if it can help flag problems close toohello root.</span></span> <span data-ttu-id="fd3fe-110">Hallo statusgegevens kunt tijd en moeite besparen op onderzoek naar en het opsporen van fouten.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-110">hello health information can save time and effort on debugging and investigation.</span></span> <span data-ttu-id="fd3fe-111">Hallo nut vooral duidelijk is wanneer het Hallo-service actief is op de gewenste schaal in de cloud Hallo (particulier of Azure).</span><span class="sxs-lookup"><span data-stu-id="fd3fe-111">hello usefulness is especially clear once hello service is up and running at scale in hello cloud (private or Azure).</span></span>

<span data-ttu-id="fd3fe-112">Hallo Service Fabric-rapporteurs monitor geïdentificeerd voorwaarden van belang.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-112">hello Service Fabric reporters monitor identified conditions of interest.</span></span> <span data-ttu-id="fd3fe-113">Ze een rapport over deze voorwaarden op basis van hun lokale weergave.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-113">They report on those conditions based on their local view.</span></span> <span data-ttu-id="fd3fe-114">Hallo [health store](service-fabric-health-introduction.md#health-store) aggregeert statusgegevens verzonden door alle rapporteurs toodetermine of entiteiten globaal in orde zijn.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-114">hello [health store](service-fabric-health-introduction.md#health-store) aggregates health data sent by all reporters toodetermine whether entities are globally healthy.</span></span> <span data-ttu-id="fd3fe-115">Hallo-model is beoogde toobe uitgebreide, flexibele en eenvoudige toouse.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-115">hello model is intended toobe rich, flexible, and easy toouse.</span></span> <span data-ttu-id="fd3fe-116">Hallo kwaliteit van statusrapporten Hallo bepaalt Hallo nauwkeurig Hallo health weergave van Hallo-cluster.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-116">hello quality of hello health reports determines hello accuracy of hello health view of hello cluster.</span></span> <span data-ttu-id="fd3fe-117">Fout-positieven waarin ten onrechte slecht problemen weergegeven kunnen nadelig upgrades of andere services die gebruikmaken van statusgegevens.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-117">False positives that wrongly show unhealthy issues can negatively impact upgrades or other services that use health data.</span></span> <span data-ttu-id="fd3fe-118">Voorbeelden van dergelijke services zijn reparatie en waarschuwen mechanismen.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-118">Examples of such services are repair services and alerting mechanisms.</span></span> <span data-ttu-id="fd3fe-119">Voorzichtig is daarom benodigde tooprovide rapporten die voorwaarden van interesse in Hallo vastleggen best mogelijke manier.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-119">Therefore, some thought is needed tooprovide reports that capture conditions of interest in hello best possible way.</span></span>

<span data-ttu-id="fd3fe-120">toodesign en implementeer health reporting, watchdogs en systeemonderdelen moeten:</span><span class="sxs-lookup"><span data-stu-id="fd3fe-120">toodesign and implement health reporting, watchdogs and system components must:</span></span>

* <span data-ttu-id="fd3fe-121">Hallo-voorwaarde die in kwestie definiëren, Hallo manier waarop die deze wordt bewaakt en Hallo van invloed op Hallo cluster- of -functionaliteit.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-121">Define hello condition they are interested in, hello way it is monitored, and hello impact on hello cluster or application functionality.</span></span> <span data-ttu-id="fd3fe-122">Bepaal op basis van deze informatie, op Hallo rapport eigenschap en health status.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-122">Based on this information, decide on hello health report property and health state.</span></span>
* <span data-ttu-id="fd3fe-123">Hallo bepalen [entiteit](service-fabric-health-introduction.md#health-entities-and-hierarchy) Hallo rapport is van toepassing op.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-123">Determine hello [entity](service-fabric-health-introduction.md#health-entities-and-hierarchy) that hello report applies to.</span></span>
* <span data-ttu-id="fd3fe-124">Bepalen waar Hallo rapportage gebeurt, Hallo vanuit de service of van een interne of externe watchdog.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-124">Determine where hello reporting is done, from within hello service or from an internal or external watchdog.</span></span>
* <span data-ttu-id="fd3fe-125">Een bron gebruikt tooidentify hello Rapportagefout definiëren.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-125">Define a source used tooidentify hello reporter.</span></span>
* <span data-ttu-id="fd3fe-126">Kies een reporting strategie periodiek of op overgangen.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-126">Choose a reporting strategy, either periodically or on transitions.</span></span> <span data-ttu-id="fd3fe-127">Hallo aanbevolen manier is periodiek, omdat deze eenvoudiger code vereist en minder gevoelig tooerrors is.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-127">hello recommended way is periodically, as it requires simpler code and is less prone tooerrors.</span></span>
* <span data-ttu-id="fd3fe-128">Bepalen hoe lang Hallo-rapport voor slechte voorwaarden in Hallo health store blijven moeten en hoe moet worden gewist.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-128">Determine how long hello report for unhealthy conditions should stay in hello health store and how it should be cleared.</span></span> <span data-ttu-id="fd3fe-129">Met deze informatie kunt bepalen van het rapport Hallo time toolive en verwijderen op vervaldatum gedrag.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-129">Using this information, decide hello report's time toolive and remove-on-expiration behavior.</span></span>

<span data-ttu-id="fd3fe-130">Zoals gezegd, rapportage kunt u doen vanaf:</span><span class="sxs-lookup"><span data-stu-id="fd3fe-130">As mentioned, reporting can be done from:</span></span>

* <span data-ttu-id="fd3fe-131">Hallo bewaakt replica voor Service Fabric-service.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-131">hello monitored Service Fabric service replica.</span></span>
* <span data-ttu-id="fd3fe-132">Interne watchdogs geïmplementeerd als een Service Fabric-service (bijvoorbeeld een Service Fabric staatloze service dat wordt bewaakt voorwaarden en rapporten).</span><span class="sxs-lookup"><span data-stu-id="fd3fe-132">Internal watchdogs deployed as a Service Fabric service (for example, a Service Fabric stateless service that monitors conditions and issues reports).</span></span> <span data-ttu-id="fd3fe-133">Hallo watchdogs kunnen worden geïmplementeerd een alle knooppunten of stelt toohello bewaakte service kan zijn.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-133">hello watchdogs can be deployed an all nodes or can be affinitized toohello monitored service.</span></span>
* <span data-ttu-id="fd3fe-134">Interne watchdogs die worden uitgevoerd op Hallo Service Fabric-knooppunten maar *niet* geïmplementeerd als een Service Fabric-services.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-134">Internal watchdogs that run on hello Service Fabric nodes but are *not* implemented as Service Fabric services.</span></span>
* <span data-ttu-id="fd3fe-135">Externe watchdogs die resource test Hallo van *buiten* Hallo Service Fabric-cluster (bijvoorbeeld bewaking service zoals Gomez).</span><span class="sxs-lookup"><span data-stu-id="fd3fe-135">External watchdogs that probe hello resource from *outside* hello Service Fabric cluster (for example, monitoring service like Gomez).</span></span>

> [!NOTE]
> <span data-ttu-id="fd3fe-136">Hallo-cluster is out of box hello gevuld met statusrapporten dat is verzonden door de onderdelen van het systeem Hallo.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-136">Out of hello box, hello cluster is populated with health reports sent by hello system components.</span></span> <span data-ttu-id="fd3fe-137">Meer informatie op [rapporten system health gebruiken voor het oplossen van](service-fabric-understand-and-troubleshoot-with-system-health-reports.md).</span><span class="sxs-lookup"><span data-stu-id="fd3fe-137">Read more at [Using system health reports for troubleshooting](service-fabric-understand-and-troubleshoot-with-system-health-reports.md).</span></span> <span data-ttu-id="fd3fe-138">Hallo Gebruikersrapporten moeten worden verzonden op [de statusentiteiten](service-fabric-health-introduction.md#health-entities-and-hierarchy) die al zijn gemaakt door Hallo-systeem.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-138">hello user reports must be sent on [health entities](service-fabric-health-introduction.md#health-entities-and-hierarchy) that have already been created by hello system.</span></span>
> 
> 

<span data-ttu-id="fd3fe-139">Eenmaal hello health reporting ontwerp is duidelijk, statusrapporten eenvoudig kunnen worden verzonden.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-139">Once hello health reporting design is clear, health reports can be sent easily.</span></span> <span data-ttu-id="fd3fe-140">U kunt [FabricClient](https://docs.microsoft.com/dotnet/api/system.fabric.fabricclient) tooreport health als Hallo-cluster niet is [beveiligde](service-fabric-cluster-security.md) of als Hallo fabric-client beheerdersbevoegdheden heeft.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-140">You can use [FabricClient](https://docs.microsoft.com/dotnet/api/system.fabric.fabricclient) tooreport health if hello cluster is not [secure](service-fabric-cluster-security.md) or if hello fabric client has admin privileges.</span></span> <span data-ttu-id="fd3fe-141">Rapportage kan worden uitgevoerd via Hallo API door met [FabricClient.HealthManager.ReportHealth](https://docs.microsoft.com/dotnet/api/system.fabric.fabricclient.healthclient.reporthealth), via PowerShell of via REST.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-141">Reporting can be done through hello API by using [FabricClient.HealthManager.ReportHealth](https://docs.microsoft.com/dotnet/api/system.fabric.fabricclient.healthclient.reporthealth), through PowerShell, or through REST.</span></span> <span data-ttu-id="fd3fe-142">Configuratie knoppen batch-rapporten voor betere prestaties.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-142">Configuration knobs batch reports for improved performance.</span></span>

> [!NOTE]
> <span data-ttu-id="fd3fe-143">De status van het rapport is synchrone en het Hallo validatie werkt alleen op de client Hallo vertegenwoordigt.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-143">Report health is synchronous, and it represents only hello validation work on hello client side.</span></span> <span data-ttu-id="fd3fe-144">Hallo wordt dat rapport Hallo geaccepteerd door Hallo health client of Hallo `Partition` of `CodePackageActivationContext` objecten betekent niet dat in de winkel hello wordt toegepast.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-144">hello fact that hello report is accepted by hello health client or hello `Partition` or `CodePackageActivationContext` objects doesn't mean that it is applied in hello store.</span></span> <span data-ttu-id="fd3fe-145">Het is asynchroon worden verzonden en mogelijk met andere rapporten batch verwerkt.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-145">It is sent asynchronously and possibly batched with other reports.</span></span> <span data-ttu-id="fd3fe-146">Hallo verwerking op de server Hallo mogelijk nog steeds: Hallo volgnummer is mogelijk verlopen, Hallo-entiteit op welke Hallo rapport moet worden toegepast is verwijderd, enzovoort.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-146">hello processing on hello server may still fail: hello sequence number could be stale, hello entity on which hello report must be applied has been deleted, etc.</span></span>
> 
> 

## <a name="health-client"></a><span data-ttu-id="fd3fe-147">Health-client</span><span class="sxs-lookup"><span data-stu-id="fd3fe-147">Health client</span></span>
<span data-ttu-id="fd3fe-148">Hallo statusrapporten worden toohello health store via een health-client, die zich in de fabric-client Hallo verzonden.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-148">hello health reports are sent toohello health store through a health client, which lives inside hello fabric client.</span></span> <span data-ttu-id="fd3fe-149">Hallo health client kan worden geconfigureerd met Hallo volgende instellingen:</span><span class="sxs-lookup"><span data-stu-id="fd3fe-149">hello health client can be configured with hello following settings:</span></span>

* <span data-ttu-id="fd3fe-150">**HealthReportSendInterval**: Hallo vertraging tussen Hallo tijd Hallo rapport is toegevoegd toohello client en Hallo tijd deze toohello health store wordt verzonden.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-150">**HealthReportSendInterval**: hello delay between hello time hello report is added toohello client and hello time it is sent toohello health store.</span></span> <span data-ttu-id="fd3fe-151">Gebruikte toobatch rapporten in een enkel bericht, in plaats van verzenden een bericht voor elk rapport.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-151">Used toobatch reports into a single message, rather than sending one message for each report.</span></span> <span data-ttu-id="fd3fe-152">Hallo batchverwerking verbetert de prestaties.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-152">hello batching improves performance.</span></span> <span data-ttu-id="fd3fe-153">Standaardwaarde: 30 seconden.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-153">Default: 30 seconds.</span></span>
* <span data-ttu-id="fd3fe-154">**HealthReportRetrySendInterval**: hello-interval opnieuw op welke Hallo Samengevoegde health verzendt de client health rapporten toohello health store.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-154">**HealthReportRetrySendInterval**: hello interval at which hello health client resends accumulated health reports toohello health store.</span></span> <span data-ttu-id="fd3fe-155">Standaardwaarde: 30 seconden.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-155">Default: 30 seconds.</span></span>
* <span data-ttu-id="fd3fe-156">**HealthOperationTimeout**: Hallo time-outperiode voor een rapportbericht verzonden toohello health store.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-156">**HealthOperationTimeout**: hello timeout period for a report message sent toohello health store.</span></span> <span data-ttu-id="fd3fe-157">Als er is een time-out opgetreden voor een bericht, opnieuw Hallo health client het totdat Hallo health store bevestigt dat Hallo rapport is verwerkt.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-157">If a message times out, hello health client retries it until hello health store confirms that hello report has been processed.</span></span> <span data-ttu-id="fd3fe-158">Standaardwaarde: twee minuten.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-158">Default: two minutes.</span></span>

> [!NOTE]
> <span data-ttu-id="fd3fe-159">Wanneer het Hallo-rapporten in batch worden opgenomen, Hallo fabric-client moet worden behouden voor ten minste Hallo HealthReportSendInterval tooensure dat ze worden verzonden.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-159">When hello reports are batched, hello fabric client must be kept alive for at least hello HealthReportSendInterval tooensure that they are sent.</span></span> <span data-ttu-id="fd3fe-160">Als het Hallo-bericht verloren gegaan is of Hallo health store niet vanwege tootransient fouten toepassen, Hallo fabric-client moet worden bewaard alive langer toogive er een kans tooretry.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-160">If hello message is lost or hello health store cannot apply them due tootransient errors, hello fabric client must be kept alive longer toogive it a chance tooretry.</span></span>
> 
> 

<span data-ttu-id="fd3fe-161">Hallo buffer op Hallo client neemt Hallo Uniekheid van Hallo rapporten in aanmerking.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-161">hello buffering on hello client takes hello uniqueness of hello reports into consideration.</span></span> <span data-ttu-id="fd3fe-162">Bijvoorbeeld, als een bepaalde slechte Rapportagefout 100 rapport is rapporten per seconde op Hallo dezelfde eigenschap Hallo Hallo rapporten zijn vervangen door de laatste versie Hallo dezelfde entiteit.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-162">For example, if a particular bad reporter is reporting 100 reports per second on hello same property of hello same entity, hello reports are replaced with hello last version.</span></span> <span data-ttu-id="fd3fe-163">Maximaal één zo'n rapport bestaat in Hallo client wachtrij.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-163">At most one such report exists in hello client queue.</span></span> <span data-ttu-id="fd3fe-164">Als batchverwerking is geconfigureerd, verzonden hello aantal rapporten toohello health store is slechts een interval dat verzenden.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-164">If batching is configured, hello number of reports sent toohello health store is just one per send interval.</span></span> <span data-ttu-id="fd3fe-165">Dit rapport is Hallo laatste toegevoegde rapport, dat overeenkomt met de meest actuele status Hallo van Hallo entiteit.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-165">This report is hello last added report, which reflects hello most current state of hello entity.</span></span>
<span data-ttu-id="fd3fe-166">Geef configuratieparameters wanneer `FabricClient` wordt gemaakt door het doorgeven van [FabricClientSettings](https://docs.microsoft.com/dotnet/api/system.fabric.fabricclientsettings) Hello de gewenste waarden voor de health-gerelateerde vermeldingen.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-166">Specify configuration parameters when `FabricClient` is created by passing [FabricClientSettings](https://docs.microsoft.com/dotnet/api/system.fabric.fabricclientsettings) with hello desired values for health-related entries.</span></span>

<span data-ttu-id="fd3fe-167">Hallo volgende voorbeeld wordt een fabric-client en geeft aan dat Hallo rapporten moeten worden verzonden wanneer ze worden toegevoegd.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-167">hello following example creates a fabric client and specifies that hello reports should be sent when they are added.</span></span> <span data-ttu-id="fd3fe-168">Nieuwe pogingen gebeuren voor time-outs en fouten die kunnen opnieuw worden geprobeerd, elke 40 seconden.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-168">On timeouts and errors that can be retried, retries happen every 40 seconds.</span></span>

```csharp
var clientSettings = new FabricClientSettings()
{
    HealthOperationTimeout = TimeSpan.FromSeconds(120),
    HealthReportSendInterval = TimeSpan.FromSeconds(0),
    HealthReportRetrySendInterval = TimeSpan.FromSeconds(40),
};
var fabricClient = new FabricClient(clientSettings);
```

<span data-ttu-id="fd3fe-169">We raden u Hallo standaard fabric-clientinstellingen, die ingesteld `HealthReportSendInterval` too30 seconden.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-169">We recommend keeping hello default fabric client settings, which set `HealthReportSendInterval` too30 seconds.</span></span> <span data-ttu-id="fd3fe-170">Deze instelling zorgt u voor optimale prestaties vanwege toobatching.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-170">This setting ensures optimal performance due toobatching.</span></span> <span data-ttu-id="fd3fe-171">Gebruik voor kritieke rapporten die zo snel mogelijk moeten worden verzonden, `HealthReportSendOptions` met direct `true` in [FabricClient.HealthClient.ReportHealth](https://docs.microsoft.com/dotnet/api/system.fabric.fabricclient.healthclient.reporthealth) API.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-171">For critical reports that must be sent as soon as possible, use `HealthReportSendOptions` with Immediate `true` in [FabricClient.HealthClient.ReportHealth](https://docs.microsoft.com/dotnet/api/system.fabric.fabricclient.healthclient.reporthealth) API.</span></span> <span data-ttu-id="fd3fe-172">Onmiddellijke rapporten overslaan Hallo batchverwerking interval.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-172">Immediate reports bypass hello batching interval.</span></span> <span data-ttu-id="fd3fe-173">Gebruik deze vlag zorgvuldig; We willen tootake profiteren van Hallo health client batchverwerking indien mogelijk.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-173">Use this flag with care; we want tootake advantage of hello health client batching whenever possible.</span></span> <span data-ttu-id="fd3fe-174">Onmiddellijke verzenden is ook nuttig bij het afsluiten van Hallo fabric-client (bijvoorbeeld Hallo proces heeft ongeldige status vastgesteld en moet tooshut omlaag tooprevent bijwerkingen).</span><span class="sxs-lookup"><span data-stu-id="fd3fe-174">Immediate send is also useful when hello fabric client is closing (for example, hello process has determined invalid state and needs tooshut down tooprevent side effects).</span></span> <span data-ttu-id="fd3fe-175">Hiermee zorgt u ervoor een best-effort verzenden van rapporten Hallo verzameld.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-175">It ensures a best-effort send of hello accumulated reports.</span></span> <span data-ttu-id="fd3fe-176">Wanneer een rapport met onmiddellijke vlag wordt toegevoegd, batches Hallo health client alle Hallo cumulatieve rapporten sinds de laatste verzenden.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-176">When one report is added with Immediate flag, hello health client batches all hello accumulated reports since last send.</span></span>

<span data-ttu-id="fd3fe-177">Dezelfde parameters kunnen worden opgegeven wanneer een verbinding tooa cluster wordt gemaakt via PowerShell.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-177">Same parameters can be specified when a connection tooa cluster is created through PowerShell.</span></span> <span data-ttu-id="fd3fe-178">Hallo volgende voorbeeld wordt een verbinding tooa lokaal cluster gestart:</span><span class="sxs-lookup"><span data-stu-id="fd3fe-178">hello following example starts a connection tooa local cluster:</span></span>

```powershell
PS C:\> Connect-ServiceFabricCluster -HealthOperationTimeoutInSec 120 -HealthReportSendIntervalInSec 0 -HealthReportRetrySendIntervalInSec 40
True

ConnectionEndpoint   :
FabricClientSettings : {
                       ClientFriendlyName                   : PowerShell-1944858a-4c6d-465f-89c7-9021c12ac0bb
                       PartitionLocationCacheLimit          : 100000
                       PartitionLocationCacheBucketCount    : 1024
                       ServiceChangePollInterval            : 00:02:00
                       ConnectionInitializationTimeout      : 00:00:02
                       KeepAliveInterval                    : 00:00:20
                       HealthOperationTimeout               : 00:02:00
                       HealthReportSendInterval             : 00:00:00
                       HealthReportRetrySendInterval        : 00:00:40
                       NotificationGatewayConnectionTimeout : 00:00:00
                       NotificationCacheUpdateTimeout       : 00:00:00
                       }
GatewayInformation   : {
                       NodeAddress                          : localhost:19000
                       NodeId                               : 1880ec88a3187766a6da323399721f53
                       NodeInstanceId                       : 130729063464981219
                       NodeName                             : Node.1
                       }
```

<span data-ttu-id="fd3fe-179">Op dezelfde manier tooAPI, rapporten kunnen worden verzonden met behulp van `-Immediate` toobe onmiddellijk verzonden ongeacht Hallo overschakelen `HealthReportSendInterval` waarde.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-179">Similarly tooAPI, reports can be sent using `-Immediate` switch toobe sent immediately, regardless of hello `HealthReportSendInterval` value.</span></span>

<span data-ttu-id="fd3fe-180">Hallo-rapporten worden voor REST, toohello Service Fabric-gateway een interne fabric-client is worden verzonden.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-180">For REST, hello reports are sent toohello Service Fabric gateway, which has an internal fabric client.</span></span> <span data-ttu-id="fd3fe-181">Standaard is deze client geconfigureerde toosend rapporten batch verwerkt elke 30 seconden.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-181">By default, this client is configured toosend reports batched every 30 seconds.</span></span> <span data-ttu-id="fd3fe-182">U kunt hello batch-interval wijzigen met Hallo cluster configuratie-instelling `HttpGatewayHealthReportSendInterval` op `HttpGateway`.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-182">You can change hello batch interval with hello cluster configuration setting `HttpGatewayHealthReportSendInterval` on `HttpGateway`.</span></span> <span data-ttu-id="fd3fe-183">Zoals gezegd, een betere optie toosend Hallo rapporten met is `Immediate` true.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-183">As mentioned, a better option is toosend hello reports with `Immediate` true.</span></span> 

> [!NOTE]
> <span data-ttu-id="fd3fe-184">tooensure dat services onbevoegde kan niet rapporteren health configureren tegen Hallo entiteiten in de cluster hello, Hallo serveraanvragen tooaccept alleen van beveiligde clients.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-184">tooensure that unauthorized services can't report health against hello entities in hello cluster, configure hello server tooaccept requests only from secured clients.</span></span> <span data-ttu-id="fd3fe-185">Hallo `FabricClient` gebruikt voor het melden van de beveiliging is ingeschakeld kunnen toocommunicate toobe met Hallo-cluster (bijvoorbeeld met Kerberos of certificaten verificatie).</span><span class="sxs-lookup"><span data-stu-id="fd3fe-185">hello `FabricClient` used for reporting must have security enabled toobe able toocommunicate with hello cluster (for example, with Kerberos or certificate authentication).</span></span> <span data-ttu-id="fd3fe-186">Lees meer over [beveiliging cluster](service-fabric-cluster-security.md).</span><span class="sxs-lookup"><span data-stu-id="fd3fe-186">Read more about [cluster security](service-fabric-cluster-security.md).</span></span>
> 
> 

## <a name="report-from-within-low-privilege-services"></a><span data-ttu-id="fd3fe-187">Rapport van binnen services met beperkte bevoegdheden</span><span class="sxs-lookup"><span data-stu-id="fd3fe-187">Report from within low privilege services</span></span>
<span data-ttu-id="fd3fe-188">Als de Service Fabric-services geen beheerder toegang toohello cluster hebt, kunt u health rapporteren op entiteiten van de huidige context Hallo via `Partition` of `CodePackageActivationContext`.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-188">If Service Fabric services do not have admin access toohello cluster, you can report health on entities from hello current context through `Partition` or `CodePackageActivationContext`.</span></span>

* <span data-ttu-id="fd3fe-189">Gebruik voor stateless services [IStatelessServicePartition.ReportInstanceHealth](https://docs.microsoft.com/dotnet/api/system.fabric.istatelessservicepartition.reportinstancehealth) tooreport op Hallo huidige service-exemplaar.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-189">For stateless services, use [IStatelessServicePartition.ReportInstanceHealth](https://docs.microsoft.com/dotnet/api/system.fabric.istatelessservicepartition.reportinstancehealth) tooreport on hello current service instance.</span></span>
* <span data-ttu-id="fd3fe-190">Gebruik voor stateful services [IStatefulServicePartition.ReportReplicaHealth](https://docs.microsoft.com/dotnet/api/system.fabric.istatefulservicepartition.reportreplicahealth) tooreport voor de huidige replica.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-190">For stateful services, use [IStatefulServicePartition.ReportReplicaHealth](https://docs.microsoft.com/dotnet/api/system.fabric.istatefulservicepartition.reportreplicahealth) tooreport on current replica.</span></span>
* <span data-ttu-id="fd3fe-191">Gebruik [IServicePartition.ReportPartitionHealth](https://docs.microsoft.com/dotnet/api/system.fabric.iservicepartition.reportpartitionhealth) tooreport op Hallo huidige partitie entiteit.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-191">Use [IServicePartition.ReportPartitionHealth](https://docs.microsoft.com/dotnet/api/system.fabric.iservicepartition.reportpartitionhealth) tooreport on hello current partition entity.</span></span>
* <span data-ttu-id="fd3fe-192">Gebruik [CodePackageActivationContext.ReportApplicationHealth](https://docs.microsoft.com/dotnet/api/system.fabric.codepackageactivationcontext.reportapplicationhealth) tooreport op de huidige toepassing.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-192">Use [CodePackageActivationContext.ReportApplicationHealth](https://docs.microsoft.com/dotnet/api/system.fabric.codepackageactivationcontext.reportapplicationhealth) tooreport on current application.</span></span>
* <span data-ttu-id="fd3fe-193">Gebruik [CodePackageActivationContext.ReportDeployedApplicationHealth](https://docs.microsoft.com/dotnet/api/system.fabric.codepackageactivationcontext.reportdeployedapplicationhealth) tooreport op Hallo van de huidige toepassing geïmplementeerd op het huidige knooppunt Hallo.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-193">Use [CodePackageActivationContext.ReportDeployedApplicationHealth](https://docs.microsoft.com/dotnet/api/system.fabric.codepackageactivationcontext.reportdeployedapplicationhealth) tooreport on hello current application deployed on hello current node.</span></span>
* <span data-ttu-id="fd3fe-194">Gebruik [CodePackageActivationContext.ReportDeployedServicePackageHealth](https://docs.microsoft.com/dotnet/api/system.fabric.codepackageactivationcontext.reportdeployedservicepackagehealth) tooreport op een servicepakket voor geïmplementeerd op het huidige knooppunt Hallo Hallo-toepassing.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-194">Use [CodePackageActivationContext.ReportDeployedServicePackageHealth](https://docs.microsoft.com/dotnet/api/system.fabric.codepackageactivationcontext.reportdeployedservicepackagehealth) tooreport on a service package for hello application deployed on hello current node.</span></span>

> [!NOTE]
> <span data-ttu-id="fd3fe-195">Intern Hallo `Partition` en Hallo `CodePackageActivationContext` houdt een health-client met standaardinstellingen geconfigureerd.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-195">Internally, hello `Partition` and hello `CodePackageActivationContext` hold a health client configured with default settings.</span></span> <span data-ttu-id="fd3fe-196">Zoals uitgelegd voor Hallo [health client](service-fabric-report-health.md#health-client), rapporten zijn batch verwerkt en verzonden via een timer.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-196">As explained for hello [health client](service-fabric-report-health.md#health-client), reports are batched and sent on a timer.</span></span> <span data-ttu-id="fd3fe-197">Hallo-objecten moeten worden bewaard alive toohave een kans toosend Hallo-rapport.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-197">hello objects should be kept alive toohave a chance toosend hello report.</span></span>
> 
> 

<span data-ttu-id="fd3fe-198">U kunt opgeven `HealthReportSendOptions` bij het verzenden van rapporten via `Partition` en `CodePackageActivationContext` health API's.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-198">You can specify `HealthReportSendOptions` when sending reports through `Partition` and `CodePackageActivationContext` health APIs.</span></span> <span data-ttu-id="fd3fe-199">Als er kritieke rapporten die zo snel mogelijk moeten worden verzonden, gebruikt u `HealthReportSendOptions` met direct `true`.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-199">If you have critical reports that must be sent as soon as possible, use `HealthReportSendOptions` with Immediate `true`.</span></span> <span data-ttu-id="fd3fe-200">Onmiddellijke rapporten overslaan Hallo batchverwerking interval van Hallo interne health client.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-200">Immediate reports bypass hello batching interval of hello internal health client.</span></span> <span data-ttu-id="fd3fe-201">Zoals al eerder vermeld, gebruikt u deze vlag zorgvuldig; We willen tootake profiteren van Hallo health client batchverwerking indien mogelijk.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-201">As mentioned before, use this flag with care; we want tootake advantage of hello health client batching whenever possible.</span></span>

## <a name="design-health-reporting"></a><span data-ttu-id="fd3fe-202">Health reporting ontwerpen</span><span class="sxs-lookup"><span data-stu-id="fd3fe-202">Design health reporting</span></span>
<span data-ttu-id="fd3fe-203">Hallo wordt eerste stap bij het genereren van rapporten van hoge kwaliteit identificeren Hallo voorwaarden die invloed op Hallo status van Hallo-service hebben kunnen.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-203">hello first step in generating high-quality reports is identifying hello conditions that can impact hello health of hello service.</span></span> <span data-ttu-id="fd3fe-204">Elke voorwaarde kunt vlag problemen bij het Hallo-service of het cluster wanneer deze wordt-- of zelfs beter voordat er een probleem voordoet--kan mogelijk miljarden bedragen opslaan.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-204">Any condition that can help flag problems in hello service or cluster when it starts--or even better, before a problem happens--can potentially save billions of dollars.</span></span> <span data-ttu-id="fd3fe-205">Hallo voordelen zijn minder uitvaltijd, uren minder 's nachts besteed aan het onderzoeken en oplossen van problemen en hogere klanttevredenheid.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-205">hello benefits include less down time, fewer night hours spent investigating and repairing issues, and higher customer satisfaction.</span></span>

<span data-ttu-id="fd3fe-206">Nadat Hallo voorwaarden worden geïdentificeerd, moeten watchdog schrijvers toofigure uit Hallo aanbevolen manier toomonitor ze voor balans tussen overhead en bruikbaarheid.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-206">Once hello conditions are identified, watchdog writers need toofigure out hello best way toomonitor them for balance between overhead and usefulness.</span></span> <span data-ttu-id="fd3fe-207">Neem bijvoorbeeld een service die complexe berekeningen die gebruikmaken van een aantal tijdelijke bestanden op een share heeft.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-207">For example, consider a service that does complex calculations that use some temporary files on a share.</span></span> <span data-ttu-id="fd3fe-208">Hallo share tooensure dat voldoende ruimte beschikbaar is, kan een watchdog controleren.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-208">A watchdog could monitor hello share tooensure that enough space is available.</span></span> <span data-ttu-id="fd3fe-209">Het kan luisteren voor meldingen van bestand of map wijzigingen.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-209">It could listen for notifications of file or directory changes.</span></span> <span data-ttu-id="fd3fe-210">Dit kan een waarschuwing worden gerapporteerd als een vooraf drempelwaarde is bereikt en een fout gemeld als Hallo share vol is.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-210">It could report a warning if an upfront threshold is reached, and report an error if hello share is full.</span></span> <span data-ttu-id="fd3fe-211">Op een waarschuwing kan een reparatie-systeem gestart opschonen van oudere bestanden op Hallo share.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-211">On a warning, a repair system could start cleaning up older files on hello share.</span></span> <span data-ttu-id="fd3fe-212">Op een fout optreedt, kan een systeem herstellen Hallo service replica tooanother knooppunt verplaatsen.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-212">On an error, a repair system could move hello service replica tooanother node.</span></span> <span data-ttu-id="fd3fe-213">Houd er rekening mee hoe Hallo voorwaarde statussen worden beschreven in termen van health: Hallo status van Hallo voorwaarde die kan worden overwogen in orde (ok) of slecht (waarschuwing of fout).</span><span class="sxs-lookup"><span data-stu-id="fd3fe-213">Note how hello condition states are described in terms of health: hello state of hello condition that can be considered healthy (ok) or unhealthy (warning or error).</span></span>

<span data-ttu-id="fd3fe-214">Zodra Hallo bewaking details zijn ingesteld, moet een schrijver watchdog toofigure uit hoe tooimplement watchdog Hallo.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-214">Once hello monitoring details are set, a watchdog writer needs toofigure out how tooimplement hello watchdog.</span></span> <span data-ttu-id="fd3fe-215">Als Hallo voorwaarden kunnen worden bepaald uit in de service hello, kan Hallo watchdog deel uitmaken van Hallo bewaakt service zelf.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-215">If hello conditions can be determined from within hello service, hello watchdog can be part of hello monitored service itself.</span></span> <span data-ttu-id="fd3fe-216">Hallo-servicecode kan bijvoorbeeld Controleer Hallo share gebruik en vervolgens rapporteren telkens wanneer wordt geprobeerd een bestand toowrite.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-216">For example, hello service code can check hello share usage, and then report every time it tries toowrite a file.</span></span> <span data-ttu-id="fd3fe-217">Hallo voordeel van deze benadering is dat reporting eenvoudig is.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-217">hello advantage of this approach is that reporting is simple.</span></span> <span data-ttu-id="fd3fe-218">Wees voorzichtig tooprevent watchdog bugs Hallo service functionaliteit beïnvloeden.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-218">Care must be taken tooprevent watchdog bugs from impacting hello service functionality.</span></span>

<span data-ttu-id="fd3fe-219">Rapportage van binnen Hallo bewaakt service is niet altijd een optie.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-219">Reporting from within hello monitored service is not always an option.</span></span> <span data-ttu-id="fd3fe-220">Een watchdog binnen Hallo-service mogelijk niet kunnen toodetect Hallo voorwaarden.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-220">A watchdog within hello service may not be able toodetect hello conditions.</span></span> <span data-ttu-id="fd3fe-221">Het mag geen Hallo logica of gegevens toomake Hallo bepaling hebben.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-221">It may not have hello logic or data toomake hello determination.</span></span> <span data-ttu-id="fd3fe-222">Hallo-overhead van bewaking Hallo voorwaarden mogelijk te hoog.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-222">hello overhead of monitoring hello conditions may be high.</span></span> <span data-ttu-id="fd3fe-223">Hallo voorwaarden kunnen ook niet worden specifieke tooa service, maar in plaats daarvan invloed hebben op de interacties tussen services.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-223">hello conditions also may not be specific tooa service, but instead affect interactions between services.</span></span> <span data-ttu-id="fd3fe-224">Een andere optie is toohave watchdogs in Hallo cluster als afzonderlijke processen.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-224">Another option is toohave watchdogs in hello cluster as separate processes.</span></span> <span data-ttu-id="fd3fe-225">Hallo watchdogs bewaken Hallo voorwaarden en rapport zonder Hallo belangrijkste services op een manier.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-225">hello watchdogs monitor hello conditions and report, without affecting hello main services in any way.</span></span> <span data-ttu-id="fd3fe-226">Deze watchdogs kunnen bijvoorbeeld worden geïmplementeerd als stateless services in Hallo dezelfde toepassing geïmplementeerd op alle knooppunten of op Hallo dezelfde knooppunten als Hallo-service.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-226">For example, these watchdogs could be implemented as stateless services in hello same application, deployed on all nodes or on hello same nodes as hello service.</span></span>

<span data-ttu-id="fd3fe-227">Soms is een watchdog in Hallo cluster wordt uitgevoerd geen optie ofwel.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-227">Sometimes, a watchdog running in hello cluster is not an option either.</span></span> <span data-ttu-id="fd3fe-228">Als Hallo bewaakt voorwaarde is Hallo beschikbaarheid of functionaliteit van Hallo-service, zoals gebruikers deze zien, is het aanbevolen toohave hello watchdogs in Hallo dezelfde als Hallo gebruiker clients plaatsen.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-228">If hello monitored condition is hello availability or functionality of hello service as users see it, it's best toohave hello watchdogs in hello same place as hello user clients.</span></span> <span data-ttu-id="fd3fe-229">Daar ze Hallo bewerkingen kunnen testen in Hallo dezelfde manier waarop gebruikers ze aanroept.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-229">There, they can test hello operations in hello same way users call them.</span></span> <span data-ttu-id="fd3fe-230">U kunt bijvoorbeeld een watchdog die woont buiten Hallo-cluster, aanvragen toohello service uitgeeft en controleert Hallo latentie en de juistheid van Hallo resultaat hebben.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-230">For example, you can have a watchdog that lives outside hello cluster, issues requests toohello service, and checks hello latency and correctness of hello result.</span></span> <span data-ttu-id="fd3fe-231">(Voor een service Rekenmachine bijvoorbeeld 2 + 2 retourneert 4 binnen redelijke tijd?)</span><span class="sxs-lookup"><span data-stu-id="fd3fe-231">(For a calculator service, for example, does 2+2 return 4 in a reasonable amount of time?)</span></span>

<span data-ttu-id="fd3fe-232">Zodra het Hallo watchdog details hebt is voltooid, moet u bepalen van een bron-ID die uniek wordt geïdentificeerd.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-232">Once hello watchdog details have been finalized, you should decide on a source ID that uniquely identifies it.</span></span> <span data-ttu-id="fd3fe-233">Als meerdere watchdogs van hetzelfde type zijn dat in Hallo hello cluster, moeten ze rapporteren over verschillende entiteiten of, als ze een rapport over Hallo dezelfde entiteit, gebruik verschillende bron-ID of eigenschap.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-233">If multiple watchdogs of hello same type are living in hello cluster, they must report on different entities, or, if they report on hello same entity, use different source ID or property.</span></span> <span data-ttu-id="fd3fe-234">Op deze manier hun rapporten kunnen worden gecombineerd.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-234">This way, their reports can coexist.</span></span> <span data-ttu-id="fd3fe-235">Hallo-eigenschap van het statusrapport Hallo moet Hallo bewaakt voorwaarde vastleggen.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-235">hello property of hello health report should capture hello monitored condition.</span></span> <span data-ttu-id="fd3fe-236">(Bijvoorbeeld Hallo bovenstaande Hallo-eigenschap kan worden **ShareSize**.) Als meerdere rapporten toohello toepast dezelfde voorwaarde hello eigenschap moet een aantal dynamische informatie waarmee u rapporten toocoexist bevatten.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-236">(For hello example above, hello property could be **ShareSize**.) If multiple reports apply toohello same condition, hello property should contain some dynamic information that allows reports toocoexist.</span></span> <span data-ttu-id="fd3fe-237">Bijvoorbeeld, als meerdere shares toobe bewaakt moeten, Hallo eigenschapsnaam mag **ShareSize sharename**.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-237">For example, if multiple shares need toobe monitored, hello property name can be **ShareSize-sharename**.</span></span>

> [!NOTE]
> <span data-ttu-id="fd3fe-238">Voer *niet* gebruik Hallo health store tookeep-statusinformatie.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-238">Do *not* use hello health store tookeep status information.</span></span> <span data-ttu-id="fd3fe-239">Alleen door de health-gerelateerde informatie moet worden gerapporteerd als health als deze informatie effecten Hallo health evaluatie van een entiteit.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-239">Only health-related information should be reported as health, as this information impacts hello health evaluation of an entity.</span></span> <span data-ttu-id="fd3fe-240">Hallo health store is niet ontworpen als een algemene archief.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-240">hello health store was not designed as a general-purpose store.</span></span> <span data-ttu-id="fd3fe-241">Wordt gebruikt health evaluatie logica tooaggregate alle gegevens in het Hallo-status.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-241">It uses health evaluation logic tooaggregate all data into hello health state.</span></span> <span data-ttu-id="fd3fe-242">Verzenden gegevens niet-verwante toohealth (zoals rapportage over de status met een status van OK) heeft geen invloed op Hallo samengevoegd status, maar het Hallo-prestaties van Hallo health store negatief kan beïnvloeden.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-242">Sending information unrelated toohealth (like reporting status with a health state of OK) doesn't impact hello aggregated health state, but it can negatively affect hello performance of hello health store.</span></span>
> 
> 

<span data-ttu-id="fd3fe-243">de volgende beslissingspunt Hallo is welke tooreport entiteit op.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-243">hello next decision point is which entity tooreport on.</span></span> <span data-ttu-id="fd3fe-244">Meestal Hallo Hallo voorwaarde duidelijk Hallo idetifies entiteit.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-244">Most of hello time, hello condition clearly idetifies hello entity.</span></span> <span data-ttu-id="fd3fe-245">Hallo-entiteit met best mogelijke granulatie kiezen.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-245">Choose hello entity with best possible granularity.</span></span> <span data-ttu-id="fd3fe-246">Als een voorwaarde heeft gevolgen voor alle replica's in een partitie, een rapport over Hallo-partitie, niet op Hallo-service.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-246">If a condition impacts all replicas in a partition, report on hello partition, not on hello service.</span></span> <span data-ttu-id="fd3fe-247">Er zijn hoek gevallen waar meer gedachte is vereist, hoewel.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-247">There are corner cases where more thought is needed, though.</span></span> <span data-ttu-id="fd3fe-248">Als Hallo voorwaarde geldt voor een entiteit, zoals een replica, maar Hallo desire toohave Hallo voorwaarde gemarkeerd voor meer dan Hallo duur van de replica-levensduur en vervolgens op Hallo partitie moet worden gemeld.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-248">If hello condition impacts an entity, such as a replica, but hello desire is toohave hello condition flagged for more than hello duration of replica life, then it should be reported on hello partition.</span></span> <span data-ttu-id="fd3fe-249">Anders wanneer Hallo replica wordt verwijderd, ruimt Hallo health store de rapporten ervan.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-249">Otherwise, when hello replica is deleted, hello health store cleans up all its reports.</span></span> <span data-ttu-id="fd3fe-250">Watchdog schrijvers moeten Denk na over Hallo levensduur van Hallo entiteit en Hallo-rapport.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-250">Watchdog writers must think about hello lifetimes of hello entity and hello report.</span></span> <span data-ttu-id="fd3fe-251">Het moet wissen wanneer een rapport moet worden opgeruimd in een store (bijvoorbeeld wanneer een fout gerapporteerd voor een entiteit wordt niet langer van toepassing).</span><span class="sxs-lookup"><span data-stu-id="fd3fe-251">It must be clear when a report should be cleaned up from a store (for example, when an error reported on an entity no longer applies).</span></span>

<span data-ttu-id="fd3fe-252">Bekijk een voorbeeld waarin plaatst samen Hallo punten die ik beschreven.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-252">Let's look at an example that puts together hello points I described.</span></span> <span data-ttu-id="fd3fe-253">U kunt dat een Service Fabric-toepassing bestaat uit een stateful permanente service master en secundaire stateless services die zijn geïmplementeerd op alle knooppunten (één secundaire servicetype voor elk type taak).</span><span class="sxs-lookup"><span data-stu-id="fd3fe-253">Consider a Service Fabric application composed of a master stateful persistent service and secondary stateless services deployed on all nodes (one secondary service type for each type of task).</span></span> <span data-ttu-id="fd3fe-254">Hallo-master heeft een wachtrij voor verwerking die opdrachten toobe uitgevoerd door de secundaire replica's bevat.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-254">hello master has a processing queue that contains commands toobe executed by secondaries.</span></span> <span data-ttu-id="fd3fe-255">Hallo secundaire replica's uitvoeren Hallo inkomende aanvragen en signalen back bevestiging verzenden.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-255">hello secondaries execute hello incoming requests and send back acknowledgement signals.</span></span> <span data-ttu-id="fd3fe-256">Een voorwaarde die kan worden bewaakt is Hallo lengte van master Hallo-verwerkingswachtrij.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-256">One condition that could be monitored is hello length of hello master processing queue.</span></span> <span data-ttu-id="fd3fe-257">Als de master wachtrijlengte Hallo een drempel bereikt, wordt een waarschuwing wordt gerapporteerd.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-257">If hello master queue length reaches a threshold, a warning is reported.</span></span> <span data-ttu-id="fd3fe-258">Hallo waarschuwing geeft aan dat secundaire replica's Hallo Hallo werklast kunnen verwerken.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-258">hello warning indicates that hello secondaries can't handle hello load.</span></span> <span data-ttu-id="fd3fe-259">Als Hallo wachtrij bereikt Hallo maximumlengte en opdrachten worden verwijderd, wordt een fout gerapporteerd, als Hallo service kan niet worden hersteld.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-259">If hello queue reaches hello maximum length and commands are dropped, an error is reported, as hello service can't recover.</span></span> <span data-ttu-id="fd3fe-260">Hallo kunnen rapporten worden op Hallo eigenschap **QueueStatus**.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-260">hello reports can be on hello property **QueueStatus**.</span></span> <span data-ttu-id="fd3fe-261">Hallo watchdog woont binnen Hallo-service en deze regelmatig op Hallo master primaire replica wordt verzonden.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-261">hello watchdog lives inside hello service, and it's sent periodically on hello master primary replica.</span></span> <span data-ttu-id="fd3fe-262">Hallo tijd toolive is twee minuten en periodiek elke 30 seconden verzonden.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-262">hello time toolive is two minutes, and it's sent periodically every 30 seconds.</span></span> <span data-ttu-id="fd3fe-263">Als primaire Hallo uitvalt, wordt Hallo rapport automatisch opgeschoond vanuit de store.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-263">If hello primary goes down, hello report is cleaned up automatically from store.</span></span> <span data-ttu-id="fd3fe-264">Als Hallo service replica actief is, maar dit is een impasse of er andere problemen Hallo verloopt rapport Hallo health store.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-264">If hello service replica is up, but it is deadlocked or having other issues, hello report expires in hello health store.</span></span> <span data-ttu-id="fd3fe-265">In dit geval wordt Hallo entiteit geëvalueerd op fout.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-265">In this case, hello entity is evaluated at error.</span></span>

<span data-ttu-id="fd3fe-266">Nog een voorwaarde die kan worden gecontroleerd is uitvoeringstijd van de taak.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-266">Another condition that can be monitored is task execution time.</span></span> <span data-ttu-id="fd3fe-267">Hallo master distribueert taken toohello secundaire replica's op basis van het taaktype Hallo.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-267">hello master distributes tasks toohello secondaries based on hello task type.</span></span> <span data-ttu-id="fd3fe-268">Afhankelijk van het ontwerp voor Hallo kan Hallo master Hallo secundaire replica's voor de taakstatus pollen.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-268">Depending on hello design, hello master could poll hello secondaries for task status.</span></span> <span data-ttu-id="fd3fe-269">Het kan ook wachten voor secundaire replica's toosend back bevestiging opgeven wanneer ze klaar bent.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-269">It could also wait for secondaries toosend back acknowledgement signals when they are done.</span></span> <span data-ttu-id="fd3fe-270">In het tweede geval Hallo moet nauwkeurig toodetect situaties waarbij secundaire replica's die of berichten gaan verloren.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-270">In hello second case, care must be taken toodetect situations where secondaries die or messages are lost.</span></span> <span data-ttu-id="fd3fe-271">Een optie is voor Hallo master toosend een ping-aanvraag toohello dezelfde secundaire, waarmee de status ervan terug wordt verzonden.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-271">One option is for hello master toosend a ping request toohello same secondary, which sends back its status.</span></span> <span data-ttu-id="fd3fe-272">Als geen status wordt ontvangen, een storing acht Hallo hoofd- en Hallo taak opnieuw gepland.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-272">If no status is received, hello master considers it a failure and reschedules hello task.</span></span> <span data-ttu-id="fd3fe-273">Dit gedrag wordt ervan uitgegaan dat Hallo taken idempotent zijn.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-273">This behavior assumes that hello tasks are idempotent.</span></span>

<span data-ttu-id="fd3fe-274">Hallo bewaakt voorwaarde kan worden omgezet als een waarschuwing als het Hallo-taak is niet uitgevoerd in een bepaalde tijd (**t1**, bijvoorbeeld 10 minuten).</span><span class="sxs-lookup"><span data-stu-id="fd3fe-274">hello monitored condition can be translated as a warning if hello task is not done in a certain time (**t1**, for example 10 minutes).</span></span> <span data-ttu-id="fd3fe-275">Als Hallo-taak is niet voltooid in de tijd (**t2**, bijvoorbeeld 20 minuten), Hallo bewaakt voorwaarde als fout kan worden omgezet.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-275">If hello task is not completed in time (**t2**, for example 20 minutes), hello monitored condition can be translated as Error.</span></span> <span data-ttu-id="fd3fe-276">Deze rapportage kunt op verschillende manieren doen:</span><span class="sxs-lookup"><span data-stu-id="fd3fe-276">This reporting can be done in multiple ways:</span></span>

* <span data-ttu-id="fd3fe-277">Hallo master primaire replica rapporten periodiek op zichzelf.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-277">hello master primary replica reports on itself periodically.</span></span> <span data-ttu-id="fd3fe-278">U kunt één eigenschap voor alle in behandeling zijnde taken in de wachtrij Hallo hebben.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-278">You can have one property for all pending tasks in hello queue.</span></span> <span data-ttu-id="fd3fe-279">Als ten minste één taak duurt langer, Hallo rapportstatus op Hallo eigenschap **PendingTasks** een waarschuwing of fout naar gelang van toepassing is.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-279">If at least one task takes longer, hello report status on hello property **PendingTasks** is a warning or error, as appropriate.</span></span> <span data-ttu-id="fd3fe-280">Als er geen taken in behandeling zijn of heeft de uitvoering van alle taken gestart, is Hallo rapportstatus in orde.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-280">If there are no pending tasks or all tasks started execution, hello report status is OK.</span></span> <span data-ttu-id="fd3fe-281">Hallo-taken zijn permanent.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-281">hello tasks are persistent.</span></span> <span data-ttu-id="fd3fe-282">Als primaire Hallo uitvalt, verder Hallo zojuist gepromoveerd primaire tooreport goed.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-282">If hello primary goes down, hello newly promoted primary can continue tooreport properly.</span></span>
* <span data-ttu-id="fd3fe-283">Een ander watchdog proces (in Hallo cloud of extern) controleert taken hello (van buiten, op basis van gewenst Hallo Taakresultaat) toosee als ze zijn voltooid.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-283">Another watchdog process (in hello cloud or external) checks hello tasks (from outside, based on hello desired task result) toosee if they are completed.</span></span> <span data-ttu-id="fd3fe-284">Als ze bieden geen ondersteuning voor Hallo drempelwaarden, wordt een rapport op Hallo hoofd-service verzonden.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-284">If they do not respect hello thresholds, a report is sent on hello master service.</span></span> <span data-ttu-id="fd3fe-285">Een rapport wordt ook op elke taak met taak-id op Hallo, zoals verzonden **PendingTask + taskId**.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-285">A report is also sent on each task that includes hello task identifier, like **PendingTask+taskId**.</span></span> <span data-ttu-id="fd3fe-286">Rapporten moeten alleen op slecht statussen worden verzonden.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-286">Reports should be sent only on unhealthy states.</span></span> <span data-ttu-id="fd3fe-287">Stel toolive tooa tijd enkele minuten en Hallo rapporten toobe verwijderd wanneer deze tooensure Schijfopruiming verlopen markeren.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-287">Set time toolive tooa few minutes, and mark hello reports toobe removed when they expire tooensure cleanup.</span></span>
* <span data-ttu-id="fd3fe-288">Hallo secundaire dat een taak wordt uitgevoerd rapporten wanneer het duurt langer dan verwacht toorun deze.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-288">hello secondary that is executing a task reports when it takes longer than expected toorun it.</span></span> <span data-ttu-id="fd3fe-289">Bevat informatie over service-exemplaar op Hallo eigenschap Hallo **PendingTasks**.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-289">It reports on hello service instance on hello property **PendingTasks**.</span></span> <span data-ttu-id="fd3fe-290">Hallo rapport lokaliseert Hallo service-exemplaar die problemen heeft, maar het Hallo situatie waarbij Hallo exemplaar matrijzen niet vastleggen.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-290">hello report pinpoints hello service instance that has issues, but it doesn't capture hello situation where hello instance dies.</span></span> <span data-ttu-id="fd3fe-291">Hallo rapporten worden vervolgens opgeschoond.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-291">hello reports are cleaned up then.</span></span> <span data-ttu-id="fd3fe-292">Dit kan een rapport over Hallo secundaire service.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-292">It could report on hello secondary service.</span></span> <span data-ttu-id="fd3fe-293">Als secundaire Hallo Hallo taken is voltooid, wist secundaire exemplaar Hallo Hallo rapport uit Hallo store.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-293">If hello secondary completes hello task, hello secondary instance clears hello report from hello store.</span></span> <span data-ttu-id="fd3fe-294">Hallo-rapport vastleggen niet Hallo situatie waarin bevestiging het Hallo-bericht is verloren gegaan en Hallo-taak niet uit het oogpunt van Hallo model is beëindigd.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-294">hello report doesn't capture hello situation where hello acknowledgement message is lost and hello task is not finished from hello master's point of view.</span></span>

<span data-ttu-id="fd3fe-295">Maar Hallo rapportage gebeurt in Hallo gevallen die hierboven worden beschreven, worden rapporten Hallo vastgelegd in toepassingsstatus health wordt geëvalueerd.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-295">However hello reporting is done in hello cases described above, hello reports are captured in application health when health is evaluated.</span></span>

## <a name="report-periodically-vs-on-transition"></a><span data-ttu-id="fd3fe-296">Rapport regelmatig versus op overgang</span><span class="sxs-lookup"><span data-stu-id="fd3fe-296">Report periodically vs. on transition</span></span>
<span data-ttu-id="fd3fe-297">Met behulp van Hallo health model reporting kunt watchdogs periodiek of overgangen rapporten verzenden.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-297">By using hello health reporting model, watchdogs can send reports periodically or on transitions.</span></span> <span data-ttu-id="fd3fe-298">Hallo aanbevolen watchdog reporting wordt regelmatig omdat Hallo code veel eenvoudiger en minder gevoelig tooerrors is.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-298">hello recommended way for watchdog reporting is periodically, because hello code is much simpler and less prone tooerrors.</span></span> <span data-ttu-id="fd3fe-299">Hallo watchdogs moeten streven ernaar toobe zo eenvoudig mogelijk tooavoid bugs die onjuiste rapporten activeren.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-299">hello watchdogs must strive toobe as simple as possible tooavoid bugs that trigger incorrect reports.</span></span> <span data-ttu-id="fd3fe-300">Onjuiste *slecht* rapporten gevolgen hebben voor health-beoordelingen en scenario's op basis van status, met inbegrip van upgrades.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-300">Incorrect *unhealthy* reports impact health evaluations and scenarios based on health, including upgrades.</span></span> <span data-ttu-id="fd3fe-301">Onjuiste *orde* rapporten problemen in Hallo-cluster niet verbergen.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-301">Incorrect *healthy* reports hide issues in hello cluster, which is not desired.</span></span>

<span data-ttu-id="fd3fe-302">Voor periodieke rapportage kan Hallo watchdog worden geïmplementeerd met een timer.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-302">For periodic reporting, hello watchdog can be implemented with a timer.</span></span> <span data-ttu-id="fd3fe-303">Op een retouraanroep timer Hallo watchdog Hallo status controleren en een rapport op basis van de huidige status Hallo verzenden.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-303">On a timer callback, hello watchdog can check hello state and send a report based on hello current state.</span></span> <span data-ttu-id="fd3fe-304">Er is geen noodzaak toosee welke rapport eerder is verzonden of maken van alle optimalisaties in termen van berichten.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-304">There is no need toosee which report was sent previously or make any optimizations in terms of messaging.</span></span> <span data-ttu-id="fd3fe-305">Hallo health client heeft batchverwerking logica toohelp met prestaties.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-305">hello health client has batching logic toohelp with performance.</span></span> <span data-ttu-id="fd3fe-306">Tijdens het Hallo-health-client wordt gehouden actief is, het opnieuw probeert intern totdat Hallo rapport is bevestigd door Hallo health store of Hallo watchdog een nieuwere rapport met Hallo genereert dezelfde entiteit, eigenschap en bron.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-306">While hello health client is kept alive, it retries internally until hello report is acknowledged by hello health store or hello watchdog generates a newer report with hello same entity, property, and source.</span></span>

<span data-ttu-id="fd3fe-307">Rapportage over overgangen vereist zorgvuldige verwerking van de status.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-307">Reporting on transitions requires careful handling of state.</span></span> <span data-ttu-id="fd3fe-308">Hallo watchdog bewaakt een aantal voorwaarden en rapporten alleen als Hallo voorwaarden wijzigen.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-308">hello watchdog monitors some conditions and reports only when hello conditions change.</span></span> <span data-ttu-id="fd3fe-309">Hallo opwaartse van deze benadering is dat er minder rapporten nodig zijn.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-309">hello upside of this approach is that fewer reports are needed.</span></span> <span data-ttu-id="fd3fe-310">Hallo nadeel is dat Hallo logica van Hallo watchdog complexe.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-310">hello downside is that hello logic of hello watchdog is complex.</span></span> <span data-ttu-id="fd3fe-311">Hallo watchdog moet onderhouden Hallo voorwaarden of Hallo rapporten, zodat ze domeinen toodetermine statuswijzigingen worden kunnen.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-311">hello watchdog must maintain hello conditions or hello reports, so that they can be inspected toodetermine state changes.</span></span> <span data-ttu-id="fd3fe-312">Failover, Wees voorzichtig met rapporten is toegevoegd, maar nog niet verzonden toohello health store.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-312">On failover, care must be taken with reports added, but not yet sent toohello health store.</span></span> <span data-ttu-id="fd3fe-313">Hallo volgnummer moet steeds groter wordende.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-313">hello sequence number must be ever-increasing.</span></span> <span data-ttu-id="fd3fe-314">Als dat niet het geval is, Hallo rapporten als verlopen worden afgewezen.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-314">If not, hello reports are rejected as stale.</span></span> <span data-ttu-id="fd3fe-315">In Hallo zeldzame gevallen waarin het verlies van gegevens is gemaakt, zijn mogelijk tussen Hallo status van Hallo Rapportagefout en status van Hallo health store Hallo synchronisatie vereist.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-315">In hello rare cases where data loss is incurred, synchronization may be needed between hello state of hello reporter and hello state of hello health store.</span></span>

<span data-ttu-id="fd3fe-316">Rapportage over overgangen zinvol is voor services die worden gerapporteerd met betrekking tot zelf, via `Partition` of `CodePackageActivationContext`.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-316">Reporting on transitions makes sense for services reporting on themselves, through `Partition` or `CodePackageActivationContext`.</span></span> <span data-ttu-id="fd3fe-317">Wanneer Hallo lokaal object (replica of geïmplementeerd servicepakket / toepassing is geïmplementeerd) is verwijderd, worden de rapporten ervan ook verwijderd.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-317">When hello local object (replica or deployed service package / deployed application) is removed, all its reports are also removed.</span></span> <span data-ttu-id="fd3fe-318">Deze automatisch opschonen worden Hallo nodig voor de synchronisatie tussen Rapportagefout en health store.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-318">This automatic cleanup relaxes hello need for synchronization between reporter and health store.</span></span> <span data-ttu-id="fd3fe-319">Als Hallo rapport voor de bovenliggende partitie of de bovenliggende toepassing, moet nauwkeurig in failover tooavoid verlopen rapporten op Hallo health store.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-319">If hello report is for parent partition or parent application, care must be taken on failover tooavoid stale reports in hello health store.</span></span> <span data-ttu-id="fd3fe-320">Logica moet worden toegevoegd toomaintain Hallo juiste status en wissen Hallo rapport uit de store wanneer het niet meer nodig hebt.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-320">Logic must be added toomaintain hello correct state and clear hello report from store when not needed anymore.</span></span>

## <a name="implement-health-reporting"></a><span data-ttu-id="fd3fe-321">Health reporting implementeren</span><span class="sxs-lookup"><span data-stu-id="fd3fe-321">Implement health reporting</span></span>
<span data-ttu-id="fd3fe-322">Als de entiteit en in het rapport details zijn hello wissen, kan statusrapporten verzenden worden gedaan via Hallo API, PowerShell of REST.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-322">Once hello entity and report details are clear, sending health reports can be done through hello API, PowerShell, or REST.</span></span>

### <a name="api"></a><span data-ttu-id="fd3fe-323">API</span><span class="sxs-lookup"><span data-stu-id="fd3fe-323">API</span></span>
<span data-ttu-id="fd3fe-324">tooreport via Hallo API, moet u toocreate een health specifieke toohello entiteit rapporttype hij of zij wil tooreport op.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-324">tooreport through hello API, you need toocreate a health report specific toohello entity type they want tooreport on.</span></span> <span data-ttu-id="fd3fe-325">Geeft Hallo rapport tooa health client.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-325">Give hello report tooa health client.</span></span> <span data-ttu-id="fd3fe-326">U kunt ook een statusgegevens maken en geef dit toocorrect rapportagemethoden op `Partition` of `CodePackageActivationContext` tooreport op huidige entiteiten.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-326">Alternatively, create a health information and pass it toocorrect reporting methods on `Partition` or `CodePackageActivationContext` tooreport on current entities.</span></span>

<span data-ttu-id="fd3fe-327">Hallo ziet volgende voorbeeld periodieke rapportage vanuit een watchdog binnen Hallo-cluster.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-327">hello following example shows periodic reporting from a watchdog within hello cluster.</span></span> <span data-ttu-id="fd3fe-328">Hallo watchdog controleert of een externe resource vanuit een knooppunt kan worden benaderd.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-328">hello watchdog checks whether an external resource can be accessed from within a node.</span></span> <span data-ttu-id="fd3fe-329">Hallo resource nodig is voor een servicemanifest in Hallo-toepassing.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-329">hello resource is needed by a service manifest within hello application.</span></span> <span data-ttu-id="fd3fe-330">Als het Hallo-bron niet beschikbaar is, hello andere services binnen de toepassing hello kunnen nog steeds naar behoren.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-330">If hello resource is unavailable, hello other services within hello application can still function properly.</span></span> <span data-ttu-id="fd3fe-331">Daarom Hallo rapport wordt verzonden op Hallo geïmplementeerd service pakket entiteit elke 30 seconden.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-331">Therefore, hello report is sent on hello deployed service package entity every 30 seconds.</span></span>

```csharp
private static Uri ApplicationName = new Uri("fabric:/WordCount");
private static string ServiceManifestName = "WordCount.Service";
private static string NodeName = FabricRuntime.GetNodeContext().NodeName;
private static Timer ReportTimer = new Timer(new TimerCallback(SendReport), null, 30 * 1000, 30 * 1000);
private static FabricClient Client = new FabricClient(new FabricClientSettings() { HealthReportSendInterval = TimeSpan.FromSeconds(0) });

public static void SendReport(object obj)
{
    // Test whether hello resource can be accessed from hello node
    HealthState healthState = this.TestConnectivityToExternalResource();

    // Send report on deployed service package, as hello connectivity is needed by hello specific service manifest
    // and can be different on different nodes
    var deployedServicePackageHealthReport = new DeployedServicePackageHealthReport(
        ApplicationName,
        ServiceManifestName,
        NodeName,
        new HealthInformation("ExternalSourceWatcher", "Connectivity", healthState));

    // TODO: handle exception. Code omitted for snippet brevity.
    // Possible exceptions: FabricException with error codes
    // FabricHealthStaleReport (non-retryable, hello report is already queued on hello health client),
    // FabricHealthMaxReportsReached (retryable; user should retry with exponential delay until hello report is accepted).
    Client.HealthManager.ReportHealth(deployedServicePackageHealthReport);
}
```

### <a name="powershell"></a><span data-ttu-id="fd3fe-332">PowerShell</span><span class="sxs-lookup"><span data-stu-id="fd3fe-332">PowerShell</span></span>
<span data-ttu-id="fd3fe-333">Verzenden van statusrapporten met  **verzenden ServiceFabric*EntityType*HealthReport **.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-333">Send health reports with **Send-ServiceFabric*EntityType*HealthReport**.</span></span>

<span data-ttu-id="fd3fe-334">Hallo ziet volgende voorbeeld periodieke rapportage over CPU-waarden op een knooppunt.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-334">hello following example shows periodic reporting on CPU values on a node.</span></span> <span data-ttu-id="fd3fe-335">Hallo rapporten elke 30 seconden moeten worden verzonden en een periode van twee minuten toolive hebben.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-335">hello reports should be sent every 30 seconds, and they have a time toolive of two minutes.</span></span> <span data-ttu-id="fd3fe-336">Als ze zijn verlopen, heeft Hallo Rapportagefout problemen, zodat het Hallo-knooppunt wordt geëvalueerd op fout.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-336">If they expire, hello reporter has issues, so hello node is evaluated at error.</span></span> <span data-ttu-id="fd3fe-337">Wanneer Hallo CPU hoger dan een drempelwaarde is, heeft Hallo rapport een status van de waarschuwing.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-337">When hello CPU is above a threshold, hello report has a health state of warning.</span></span> <span data-ttu-id="fd3fe-338">Wanneer Hallo CPU boven een drempelwaarde komt meer dan de tijd Hallo geconfigureerd blijft, wordt als een fout gerapporteerd.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-338">When hello CPU remains above a threshold for more than hello configured time, it's reported as an error.</span></span> <span data-ttu-id="fd3fe-339">Anders verzendt Hallo Rapportagefout een status OK.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-339">Otherwise, hello reporter sends a health state of OK.</span></span>

```powershell
PS C:\> Send-ServiceFabricNodeHealthReport -NodeName Node.1 -HealthState Warning -SourceId PowershellWatcher -HealthProperty CPU -Description "CPU is above 80% threshold" -TimeToLiveSec 120

PS C:\> Get-ServiceFabricNodeHealth -NodeName Node.1
NodeName              : Node.1
AggregatedHealthState : Warning
UnhealthyEvaluations  :
                        Unhealthy event: SourceId='PowershellWatcher', Property='CPU', HealthState='Warning', ConsiderWarningAsError=false.

HealthEvents          :
                        SourceId              : System.FM
                        Property              : State
                        HealthState           : Ok
                        SequenceNumber        : 5
                        SentAt                : 4/21/2015 8:01:17 AM
                        ReceivedAt            : 4/21/2015 8:02:12 AM
                        TTL                   : Infinite
                        Description           : Fabric node is up.
                        RemoveWhenExpired     : False
                        IsExpired             : False
                        Transitions           : ->Ok = 4/21/2015 8:02:12 AM

                        SourceId              : PowershellWatcher
                        Property              : CPU
                        HealthState           : Warning
                        SequenceNumber        : 130741236814913394
                        SentAt                : 4/21/2015 9:01:21 PM
                        ReceivedAt            : 4/21/2015 9:01:21 PM
                        TTL                   : 00:02:00
                        Description           : CPU is above 80% threshold
                        RemoveWhenExpired     : False
                        IsExpired             : False
                        Transitions           : ->Warning = 4/21/2015 9:01:21 PM
```

<span data-ttu-id="fd3fe-340">Hallo volgende voorbeeld wordt een tijdelijke waarschuwing op een replica.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-340">hello following example reports a transient warning on a replica.</span></span> <span data-ttu-id="fd3fe-341">Het eerst opgehaald Hallo partitie-ID en vervolgens Hallo replica-ID voor deze is geïnteresseerd in Hallo-service.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-341">It first gets hello partition ID and then hello replica ID for hello service it is interested in.</span></span> <span data-ttu-id="fd3fe-342">Verzendt vervolgens een rapport van **PowershellWatcher** op Hallo eigenschap **ResourceDependency**.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-342">It then sends a report from **PowershellWatcher** on hello property **ResourceDependency**.</span></span> <span data-ttu-id="fd3fe-343">Hallo-rapport is van belang zijn voor slechts twee minuten en wordt deze verwijderd uit de store Hallo automatisch.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-343">hello report is of interest for only two minutes, and it is removed from hello store automatically.</span></span>

```powershell
PS C:\> $partitionId = (Get-ServiceFabricPartition -ServiceName fabric:/WordCount/WordCount.Service).PartitionId

PS C:\> $replicaId = (Get-ServiceFabricReplica -PartitionId $partitionId | where {$_.ReplicaRole -eq "Primary"}).ReplicaId

PS C:\> Send-ServiceFabricReplicaHealthReport -PartitionId $partitionId -ReplicaId $replicaId -HealthState Warning -SourceId PowershellWatcher -HealthProperty ResourceDependency -Description "hello external resource that hello primary is using has been rebooted at 4/21/2015 9:01:21 PM. Expect processing delays for a few minutes." -TimeToLiveSec 120 -RemoveWhenExpired

PS C:\> Get-ServiceFabricReplicaHealth  -PartitionId $partitionId -ReplicaOrInstanceId $replicaId


PartitionId           : 8f82daff-eb68-4fd9-b631-7a37629e08c0
ReplicaId             : 130740415594605869
AggregatedHealthState : Warning
UnhealthyEvaluations  :
                        Unhealthy event: SourceId='PowershellWatcher', Property='ResourceDependency', HealthState='Warning', ConsiderWarningAsError=false.

HealthEvents          :
                        SourceId              : System.RA
                        Property              : State
                        HealthState           : Ok
                        SequenceNumber        : 130740768777734943
                        SentAt                : 4/21/2015 8:01:17 AM
                        ReceivedAt            : 4/21/2015 8:02:12 AM
                        TTL                   : Infinite
                        Description           : Replica has been created.
                        RemoveWhenExpired     : False
                        IsExpired             : False
                        Transitions           : ->Ok = 4/21/2015 8:02:12 AM

                        SourceId              : PowershellWatcher
                        Property              : ResourceDependency
                        HealthState           : Warning
                        SequenceNumber        : 130741243777723555
                        SentAt                : 4/21/2015 9:12:57 PM
                        ReceivedAt            : 4/21/2015 9:12:57 PM
                        TTL                   : 00:02:00
                        Description           : hello external resource that hello primary is using has been rebooted at 4/21/2015 9:01:21 PM. Expect processing delays for a few minutes.
                        RemoveWhenExpired     : True
                        IsExpired             : False
                        Transitions           : ->Warning = 4/21/2015 9:12:32 PM
```

### <a name="rest"></a><span data-ttu-id="fd3fe-344">REST</span><span class="sxs-lookup"><span data-stu-id="fd3fe-344">REST</span></span>
<span data-ttu-id="fd3fe-345">Statusrapporten met REST met POST-aanvragen die gaat u toohello gewenst entiteit en in Hallo hoofdtekst Hallo health Rapportbeschrijving verzenden.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-345">Send health reports using REST with POST requests that go toohello desired entity and have in hello body hello health report description.</span></span> <span data-ttu-id="fd3fe-346">Zie bijvoorbeeld hoe REST-toosend [cluster statusrapporten](https://docs.microsoft.com/rest/api/servicefabric/report-the-health-of-a-cluster) of [service statusrapporten](https://docs.microsoft.com/rest/api/servicefabric/report-the-health-of-a-service).</span><span class="sxs-lookup"><span data-stu-id="fd3fe-346">For example, see how toosend REST [cluster health reports](https://docs.microsoft.com/rest/api/servicefabric/report-the-health-of-a-cluster) or [service health reports](https://docs.microsoft.com/rest/api/servicefabric/report-the-health-of-a-service).</span></span> <span data-ttu-id="fd3fe-347">Alle entiteiten worden ondersteund.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-347">All entities are supported.</span></span>

## <a name="next-steps"></a><span data-ttu-id="fd3fe-348">Volgende stappen</span><span class="sxs-lookup"><span data-stu-id="fd3fe-348">Next steps</span></span>
<span data-ttu-id="fd3fe-349">Op basis van de statusgegevens hello, kunnen schrijvers van de service en cluster/toepassing beheerders van manieren tooconsume Hallo informatie zien.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-349">Based on hello health data, service writers and cluster/application administrators can think of ways tooconsume hello information.</span></span> <span data-ttu-id="fd3fe-350">Ze kunnen bijvoorbeeld waarschuwingen op basis van status status toocatch ernstige problemen voordat ze leiden uitval tot instellen.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-350">For example, they can set up alerts based on health status toocatch severe issues before they provoke outages.</span></span> <span data-ttu-id="fd3fe-351">Beheerders kunnen ook reparatie systemen toofix problemen automatisch ingesteld.</span><span class="sxs-lookup"><span data-stu-id="fd3fe-351">Administrators can also set up repair systems toofix issues automatically.</span></span>

[<span data-ttu-id="fd3fe-352">Inleiding tooService Fabric health Monitoring</span><span class="sxs-lookup"><span data-stu-id="fd3fe-352">Introduction tooService Fabric health Monitoring</span></span>](service-fabric-health-introduction.md)

[<span data-ttu-id="fd3fe-353">Service Fabric-statusrapporten weergeven</span><span class="sxs-lookup"><span data-stu-id="fd3fe-353">View Service Fabric health reports</span></span>](service-fabric-view-entities-aggregated-health.md)

[<span data-ttu-id="fd3fe-354">Hoe tooreport en controleer health service</span><span class="sxs-lookup"><span data-stu-id="fd3fe-354">How tooreport and check service health</span></span>](service-fabric-diagnostics-how-to-report-and-check-service-health.md)

[<span data-ttu-id="fd3fe-355">Systeemstatusrapporten gebruiken voor het oplossen van problemen</span><span class="sxs-lookup"><span data-stu-id="fd3fe-355">Use system health reports for troubleshooting</span></span>](service-fabric-understand-and-troubleshoot-with-system-health-reports.md)

[<span data-ttu-id="fd3fe-356">Controle en diagnose van lokaal services</span><span class="sxs-lookup"><span data-stu-id="fd3fe-356">Monitor and diagnose services locally</span></span>](service-fabric-diagnostics-how-to-monitor-and-diagnose-services-locally.md)

[<span data-ttu-id="fd3fe-357">Upgrade van de service Fabric-toepassing</span><span class="sxs-lookup"><span data-stu-id="fd3fe-357">Service Fabric application upgrade</span></span>](service-fabric-application-upgrade.md)

