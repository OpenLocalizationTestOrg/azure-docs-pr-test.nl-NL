---
title: 'Upgrade van de toepassing: serialisatie van gegevens | Microsoft Docs'
description: Aanbevolen procedures voor serialisatie van gegevens en de mogelijke gevolgen voor rollende toepassingsupgrades.
services: service-fabric
documentationcenter: .net
author: vturecek
manager: timlt
editor: 
ms.assetid: a5f36366-a2ab-4ae3-bb08-bc2f9533bc5a
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 06/29/2017
ms.author: vturecek
ms.openlocfilehash: 6aa3ac7842df4657fca7f6b4264e1c6fe52dc0c6
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 07/11/2017
---
# <a name="how-data-serialization-affects-an-application-upgrade"></a><span data-ttu-id="482b1-103">De invloed van serialisatie van gegevens op een upgrade van de toepassing</span><span class="sxs-lookup"><span data-stu-id="482b1-103">How data serialization affects an application upgrade</span></span>
<span data-ttu-id="482b1-104">In een [rolling upgrade van de toepassing](service-fabric-application-upgrade.md), de upgrade wordt toegepast op een deelverzameling met knooppunten, één upgradedomein tegelijk.</span><span class="sxs-lookup"><span data-stu-id="482b1-104">In a [rolling application upgrade](service-fabric-application-upgrade.md), the upgrade is applied to a subset of nodes, one upgrade domain at a time.</span></span> <span data-ttu-id="482b1-105">Tijdens dit proces een aantal upgradedomeinen zijn op de nieuwere versie van uw toepassing en een aantal upgradedomeinen zijn op de oudere versie van uw toepassing.</span><span class="sxs-lookup"><span data-stu-id="482b1-105">During this process, some upgrade domains are on the newer version of your application, and some upgrade domains are on the older version of your application.</span></span> <span data-ttu-id="482b1-106">De nieuwe versie van uw toepassing moet kunnen lezen van de oude versie van uw gegevens tijdens de implementatie en de oude versie van uw toepassing moet kunnen lezen van de nieuwe versie van uw gegevens.</span><span class="sxs-lookup"><span data-stu-id="482b1-106">During the rollout, the new version of your application must be able to read the old version of your data, and the old version of your application must be able to read the new version of your data.</span></span> <span data-ttu-id="482b1-107">Als de gegevensindeling niet voorwaarts en achterwaarts compatibel is, wordt de upgrade mislukken of slechter, gegevens mogelijk verloren gegaan of beschadigd.</span><span class="sxs-lookup"><span data-stu-id="482b1-107">If the data format is not forward and backward compatible, the upgrade may fail, or worse, data may be lost or corrupted.</span></span> <span data-ttu-id="482b1-108">Dit artikel wordt beschreven wat wordt verstaan onder de indeling van uw gegevens en biedt de aanbevolen procedures om ervoor te zorgen dat uw gegevens voorwaarts en achterwaarts zijn compatibel.</span><span class="sxs-lookup"><span data-stu-id="482b1-108">This article discusses what constitutes your data format and offers best practices for ensuring that your data is forward and backward compatible.</span></span>

## <a name="what-makes-up-your-data-format"></a><span data-ttu-id="482b1-109">Wat is de indeling van uw gegevens?</span><span class="sxs-lookup"><span data-stu-id="482b1-109">What makes up your data format?</span></span>
<span data-ttu-id="482b1-110">In de Azure Service Fabric, worden de gegevens die is opgeslagen en gerepliceerd afkomstig van uw C#-klassen.</span><span class="sxs-lookup"><span data-stu-id="482b1-110">In Azure Service Fabric, the data that is persisted and replicated comes from your C# classes.</span></span> <span data-ttu-id="482b1-111">Voor toepassingen die gebruikmaken van [betrouwbare verzamelingen](service-fabric-reliable-services-reliable-collections.md), dat gegevens de objecten in de betrouwbare woordenlijsten en wachtrijen worden.</span><span class="sxs-lookup"><span data-stu-id="482b1-111">For applications that use [Reliable Collections](service-fabric-reliable-services-reliable-collections.md), that data is the objects in the reliable dictionaries and queues.</span></span> <span data-ttu-id="482b1-112">Voor toepassingen die gebruikmaken van [Reliable Actors](service-fabric-reliable-actors-introduction.md), die de status van back-ups maken voor de actor.</span><span class="sxs-lookup"><span data-stu-id="482b1-112">For applications that use [Reliable Actors](service-fabric-reliable-actors-introduction.md), that is the backing state for the actor.</span></span> <span data-ttu-id="482b1-113">Deze C#-klassen moeten serialiseerbaar zijn opgeslagen en gerepliceerd.</span><span class="sxs-lookup"><span data-stu-id="482b1-113">These C# classes must be serializable to be persisted and replicated.</span></span> <span data-ttu-id="482b1-114">Daarom wordt de gegevensindeling gedefinieerd door de velden en eigenschappen die zijn geserialiseerd, evenals hoe ze worden geserialiseerd.</span><span class="sxs-lookup"><span data-stu-id="482b1-114">Therefore, the data format is defined by the fields and properties that are serialized, as well as how they are serialized.</span></span> <span data-ttu-id="482b1-115">Bijvoorbeeld in een `IReliableDictionary<int, MyClass>` de gegevens is een geserialiseerde `int` en een geserialiseerde `MyClass`.</span><span class="sxs-lookup"><span data-stu-id="482b1-115">For example, in an `IReliableDictionary<int, MyClass>` the data is a serialized `int` and a serialized `MyClass`.</span></span>

### <a name="code-changes-that-result-in-a-data-format-change"></a><span data-ttu-id="482b1-116">Code wijzigt die resulteren in een wijziging van de indeling gegevens</span><span class="sxs-lookup"><span data-stu-id="482b1-116">Code changes that result in a data format change</span></span>
<span data-ttu-id="482b1-117">Aangezien de gegevensindeling wordt bepaald door de C#-klassen, mogelijk wijzigingen aan de klassen indeling gewijzigde gegevens.</span><span class="sxs-lookup"><span data-stu-id="482b1-117">Since the data format is determined by C# classes, changes to the classes may cause a data format change.</span></span> <span data-ttu-id="482b1-118">Moet nauwkeurig om ervoor te zorgen dat de wijziging van de indeling gegevens kan omgaan met een uitrollende upgrade.</span><span class="sxs-lookup"><span data-stu-id="482b1-118">Care must be taken to ensure that a rolling upgrade can handle the data format change.</span></span> <span data-ttu-id="482b1-119">Voorbeelden kunnen leiden tot gegevenswijzigingen van de indeling:</span><span class="sxs-lookup"><span data-stu-id="482b1-119">Examples that may cause data format changes:</span></span>

* <span data-ttu-id="482b1-120">Het toevoegen of verwijderen van velden of eigenschappen</span><span class="sxs-lookup"><span data-stu-id="482b1-120">Adding or removing fields or properties</span></span>
* <span data-ttu-id="482b1-121">Naamswijzigingen velden of eigenschappen</span><span class="sxs-lookup"><span data-stu-id="482b1-121">Renaming fields or properties</span></span>
* <span data-ttu-id="482b1-122">De typen van velden of eigenschappen wijzigen</span><span class="sxs-lookup"><span data-stu-id="482b1-122">Changing the types of fields or properties</span></span>
* <span data-ttu-id="482b1-123">Wijzigen van de naam van klasse of naamruimte</span><span class="sxs-lookup"><span data-stu-id="482b1-123">Changing the class name or namespace</span></span>

### <a name="data-contract-as-the-default-serializer"></a><span data-ttu-id="482b1-124">Gegevenscontract als de serialisatiefunctie standaard</span><span class="sxs-lookup"><span data-stu-id="482b1-124">Data Contract as the default serializer</span></span>
<span data-ttu-id="482b1-125">De serialisatiefunctie is doorgaans verantwoordelijk voor het lezen van de gegevens en bij het deserialiseren van het in de huidige versie, zelfs als de gegevens in een oudere of *nieuwere* versie.</span><span class="sxs-lookup"><span data-stu-id="482b1-125">The serializer is generally responsible for reading the data and deserializing it into the current version, even if the data is in an older or *newer* version.</span></span> <span data-ttu-id="482b1-126">De serialisatiefunctie standaard is de [gegevenscontract serialisatiefunctie](https://msdn.microsoft.com/library/ms733127.aspx), die goed gedefinieerde versieregels heeft.</span><span class="sxs-lookup"><span data-stu-id="482b1-126">The default serializer is the [Data Contract serializer](https://msdn.microsoft.com/library/ms733127.aspx), which has well-defined versioning rules.</span></span> <span data-ttu-id="482b1-127">Betrouwbare verzamelingen kunnen de serialisatiefunctie moet worden overschreven, maar Reliable Actors momenteel niet.</span><span class="sxs-lookup"><span data-stu-id="482b1-127">Reliable Collections allow the serializer to be overridden, but Reliable Actors currently do not.</span></span> <span data-ttu-id="482b1-128">De serialisatiefunctie gegevens speelt een belangrijke rol bij het inschakelen van rollende upgrades.</span><span class="sxs-lookup"><span data-stu-id="482b1-128">The data serializer plays an important role in enabling rolling upgrades.</span></span> <span data-ttu-id="482b1-129">De serialisatiefunctie gegevenscontract is de serialisatiefunctie die we voor Service Fabric-toepassingen aanbevelen.</span><span class="sxs-lookup"><span data-stu-id="482b1-129">The Data Contract serializer is the serializer that we recommend for Service Fabric applications.</span></span>

## <a name="how-the-data-format-affects-a-rolling-upgrade"></a><span data-ttu-id="482b1-130">De invloed van de indeling van de gegevens op een uitrollende upgrade</span><span class="sxs-lookup"><span data-stu-id="482b1-130">How the data format affects a rolling upgrade</span></span>
<span data-ttu-id="482b1-131">Tijdens een rolling upgrade er zijn twee hoofdscenario's waar de serialisatiefunctie een oudere ondervinden of *nieuwere* versie van uw gegevens:</span><span class="sxs-lookup"><span data-stu-id="482b1-131">During a rolling upgrade, there are two main scenarios where the serializer may encounter an older or *newer* version of your data:</span></span>

1. <span data-ttu-id="482b1-132">Nadat een knooppunt is bijgewerkt en wordt een back-up wordt gestart, de serializer van de nieuwe laden van de gegevens die is opgeslagen op schijf door de oude versie.</span><span class="sxs-lookup"><span data-stu-id="482b1-132">After a node is upgraded and starts back up, the new serializer will load the data that was persisted to disk by the old version.</span></span>
2. <span data-ttu-id="482b1-133">Tijdens de upgrade rolling bevat het cluster een combinatie van de oude en nieuwe versies van uw code.</span><span class="sxs-lookup"><span data-stu-id="482b1-133">During the rolling upgrade, the cluster will contain a mix of the old and new versions of your code.</span></span> <span data-ttu-id="482b1-134">Omdat replica's kunnen worden geplaatst in verschillende domeinen van de upgrade en replica's verzenden van gegevens met elkaar, kan de nieuwe en/of de oude versie van uw gegevens door de nieuwe en/of de oude versie van de serializer worden aangetroffen.</span><span class="sxs-lookup"><span data-stu-id="482b1-134">Since replicas may be placed in different upgrade domains, and replicas send data to each other, the new and/or old version of your data may be encountered by the new and/or old version of your serializer.</span></span>

> [!NOTE]
> <span data-ttu-id="482b1-135">De ' nieuwe ' en 'oude versie' hier verwijzen naar de versie van uw code die wordt uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="482b1-135">The "new version" and "old version" here refer to the version of your code that is running.</span></span> <span data-ttu-id="482b1-136">De 'nieuwe serializer"verwijst naar de serialisatiefunctie-code die wordt uitgevoerd in de nieuwe versie van uw toepassing.</span><span class="sxs-lookup"><span data-stu-id="482b1-136">The "new serializer" refers to the serializer code that is executing in the new version of your application.</span></span> <span data-ttu-id="482b1-137">De 'nieuwe gegevens"verwijst naar de geserialiseerde C#-klasse van de nieuwe versie van uw toepassing.</span><span class="sxs-lookup"><span data-stu-id="482b1-137">The "new data" refers to the serialized C# class from the new version of your application.</span></span>
> 
> 

<span data-ttu-id="482b1-138">De twee versies van code en gegevens indeling moet voorwaarts en achterwaarts compatibel.</span><span class="sxs-lookup"><span data-stu-id="482b1-138">The two versions of code and data format must be both forward and backward compatible.</span></span> <span data-ttu-id="482b1-139">Als ze niet compatibel is, de rolling upgrade mislukken of gegevens zijn mogelijk verloren gegaan.</span><span class="sxs-lookup"><span data-stu-id="482b1-139">If they are not compatible, the rolling upgrade may fail or data may be lost.</span></span> <span data-ttu-id="482b1-140">De rolling upgrade mislukken omdat de code of serialisatiefunctie veroorzaken kan uitzonderingen of een storing wanneer de andere versie is aangetroffen.</span><span class="sxs-lookup"><span data-stu-id="482b1-140">The rolling upgrade may fail because the code or serializer may throw exceptions or a fault when it encounters the other version.</span></span> <span data-ttu-id="482b1-141">Gegevens zijn mogelijk verloren als er bijvoorbeeld een nieuwe eigenschap is toegevoegd, maar de serializer van de oude verwijdert alle tijdens de deserialisatie.</span><span class="sxs-lookup"><span data-stu-id="482b1-141">Data may be lost if, for example, a new property was added but the old serializer discards it during deserialization.</span></span>

<span data-ttu-id="482b1-142">Gegevenscontract is de aanbevolen oplossing om ervoor te zorgen dat uw gegevens compatibel is.</span><span class="sxs-lookup"><span data-stu-id="482b1-142">Data Contract is the recommended solution for ensuring that your data is compatible.</span></span> <span data-ttu-id="482b1-143">Goed gedefinieerde versieregels voor toevoegen, verwijderen en wijzigen van velden heeft.</span><span class="sxs-lookup"><span data-stu-id="482b1-143">It has well-defined versioning rules for adding, removing, and changing fields.</span></span> <span data-ttu-id="482b1-144">Er wordt ook ondersteuning voor het omgaan met onbekende velden en omgaan met klassenovername vereist in het proces voor serialisatie en deserialisatie.</span><span class="sxs-lookup"><span data-stu-id="482b1-144">It also has support for dealing with unknown fields, hooking into the serialization and deserialization process, and dealing with class inheritance.</span></span> <span data-ttu-id="482b1-145">Zie voor meer informatie [gegevenscontract met behulp van](https://msdn.microsoft.com/library/ms733127.aspx).</span><span class="sxs-lookup"><span data-stu-id="482b1-145">For more information, see [Using Data Contract](https://msdn.microsoft.com/library/ms733127.aspx).</span></span>

## <a name="next-steps"></a><span data-ttu-id="482b1-146">Volgende stappen</span><span class="sxs-lookup"><span data-stu-id="482b1-146">Next steps</span></span>
<span data-ttu-id="482b1-147">[Een upgrade van uw toepassing met behulp van Visual Studio](service-fabric-application-upgrade-tutorial.md) begeleidt u bij een upgrade van de toepassing met Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="482b1-147">[Upgrading your Application Using Visual Studio](service-fabric-application-upgrade-tutorial.md) walks you through an application upgrade using Visual Studio.</span></span>

<span data-ttu-id="482b1-148">[Een upgrade van uw toepassing met behulp van Powershell](service-fabric-application-upgrade-tutorial-powershell.md) begeleidt u bij een upgrade van de toepassing met behulp van PowerShell.</span><span class="sxs-lookup"><span data-stu-id="482b1-148">[Upgrading your Application Using Powershell](service-fabric-application-upgrade-tutorial-powershell.md) walks you through an application upgrade using PowerShell.</span></span>

<span data-ttu-id="482b1-149">Bepalen hoe uw toepassing wordt bijgewerkt met behulp van [Parameters Upgrade](service-fabric-application-upgrade-parameters.md).</span><span class="sxs-lookup"><span data-stu-id="482b1-149">Control how your application upgrades by using [Upgrade Parameters](service-fabric-application-upgrade-parameters.md).</span></span>

<span data-ttu-id="482b1-150">Informatie over het gebruik van geavanceerde functionaliteit tijdens het bijwerken van uw toepassing door te verwijzen naar [geavanceerde onderwerpen](service-fabric-application-upgrade-advanced.md).</span><span class="sxs-lookup"><span data-stu-id="482b1-150">Learn how to use advanced functionality while upgrading your application by referring to [Advanced Topics](service-fabric-application-upgrade-advanced.md).</span></span>

<span data-ttu-id="482b1-151">Veelvoorkomende problemen oplossen in toepassingsupgrades door te verwijzen naar de stappen in [toepassingsupgrades probleemoplossing ](service-fabric-application-upgrade-troubleshooting.md).</span><span class="sxs-lookup"><span data-stu-id="482b1-151">Fix common problems in application upgrades by referring to the steps in [Troubleshooting Application Upgrades ](service-fabric-application-upgrade-troubleshooting.md).</span></span>

