---
title: Beschrijving van de cluster Resource Manager-Cluster | Microsoft Docs
description: Met een beschrijving van een Service Fabric-cluster door te geven voor domeinen met fouten, domeinen upgraden, eigenschappen van het knooppunt en capaciteit van knooppunt voor het Cluster Resource Manager.
services: service-fabric
documentationcenter: .net
author: masnider
manager: timlt
editor: 
ms.assetid: 55f8ab37-9399-4c9a-9e6c-d2d859de6766
ms.service: Service-Fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 08/18/2017
ms.author: masnider
ms.openlocfilehash: e517eda4d3ff7ad81998003688c3cca78f76e179
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 08/29/2017
---
# <a name="describing-a-service-fabric-cluster"></a><span data-ttu-id="45d49-103">Met een beschrijving van een service fabric-cluster</span><span class="sxs-lookup"><span data-stu-id="45d49-103">Describing a service fabric cluster</span></span>
<span data-ttu-id="45d49-104">De Service Fabric Cluster Resource Manager biedt verschillende mechanismen voor het beschrijven van een cluster.</span><span class="sxs-lookup"><span data-stu-id="45d49-104">The Service Fabric Cluster Resource Manager provides several mechanisms for describing a cluster.</span></span> <span data-ttu-id="45d49-105">De Cluster Resource Manager gebruikt tijdens runtime, deze informatie om te controleren of de hoge beschikbaarheid van de services die in het cluster wordt uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="45d49-105">During runtime, the Cluster Resource Manager uses this information to ensure high availability of the services running in the cluster.</span></span> <span data-ttu-id="45d49-106">Bij het afdwingen van deze belangrijke regels ook probeert te optimaliseren het brongebruik binnen het cluster.</span><span class="sxs-lookup"><span data-stu-id="45d49-106">While enforcing these important rules, it also attempts to optimize the resource consumption within the cluster.</span></span>

## <a name="key-concepts"></a><span data-ttu-id="45d49-107">Belangrijkste concepten</span><span class="sxs-lookup"><span data-stu-id="45d49-107">Key concepts</span></span>
<span data-ttu-id="45d49-108">De Cluster Resource Manager ondersteunt verschillende functies die worden beschreven van een cluster:</span><span class="sxs-lookup"><span data-stu-id="45d49-108">The Cluster Resource Manager supports several features that describe a cluster:</span></span>

* <span data-ttu-id="45d49-109">Domeinen met fouten</span><span class="sxs-lookup"><span data-stu-id="45d49-109">Fault Domains</span></span>
* <span data-ttu-id="45d49-110">Upgradedomeinen</span><span class="sxs-lookup"><span data-stu-id="45d49-110">Upgrade Domains</span></span>
* <span data-ttu-id="45d49-111">Knooppunteigenschappen</span><span class="sxs-lookup"><span data-stu-id="45d49-111">Node Properties</span></span>
* <span data-ttu-id="45d49-112">Capaciteit van knooppunt</span><span class="sxs-lookup"><span data-stu-id="45d49-112">Node Capacities</span></span>

## <a name="fault-domains"></a><span data-ttu-id="45d49-113">Foutdomeinen</span><span class="sxs-lookup"><span data-stu-id="45d49-113">Fault domains</span></span>
<span data-ttu-id="45d49-114">Een domein met fouten is een gebied van gecoördineerde is mislukt.</span><span class="sxs-lookup"><span data-stu-id="45d49-114">A Fault Domain is any area of coordinated failure.</span></span> <span data-ttu-id="45d49-115">Een enkele computer is een Foutdomein (omdat deze niet kan op een eigen voor verschillende oorzaken hebben, van levering stroomstoringen op fouten van schijf naar een ongeldige NIC firmware).</span><span class="sxs-lookup"><span data-stu-id="45d49-115">A single machine is a Fault Domain (since it can fail on its own for various reasons, from power supply failures to drive failures to bad NIC firmware).</span></span> <span data-ttu-id="45d49-116">Computers die zijn verbonden met dezelfde Ethernet-switch zijn in hetzelfde Foutdomein, zoals machines delen één bron stroomstoring of op één locatie.</span><span class="sxs-lookup"><span data-stu-id="45d49-116">Machines connected to the same Ethernet switch are in the same Fault Domain, as are machines sharing a single source of power or in a single location.</span></span> <span data-ttu-id="45d49-117">Aangezien het natuurlijke voor hardwarefouten overlappen, worden Foutdomeinen inherent hiërarchische zijn en worden weergegeven als URI's in Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="45d49-117">Since it's natural for hardware faults to overlap, Fault Domains are inherently hierarchal and are represented as URIs in Service Fabric.</span></span>

<span data-ttu-id="45d49-118">Het is belangrijk dat Foutdomeinen correct zijn ingesteld sinds de Service Fabric gebruikt deze gegevens veilig services plaatsen.</span><span class="sxs-lookup"><span data-stu-id="45d49-118">It is important that Fault Domains are set up correctly since Service Fabric uses this information to safely place services.</span></span> <span data-ttu-id="45d49-119">Service Fabric wilt niet services plaatsen zodat het verlies van een domein met fouten (veroorzaakt door het uitvallen van een onderdeel) zorgt ervoor een service dat omlaag gaan.</span><span class="sxs-lookup"><span data-stu-id="45d49-119">Service Fabric doesn't want to place services such that the loss of a Fault Domain (caused by the failure of some component) causes a service to go down.</span></span> <span data-ttu-id="45d49-120">In de Azure Service Fabric-omgeving de Foutdomein informatie van de omgeving gebruikt correct configureren van de knooppunten in het cluster namens jou.</span><span class="sxs-lookup"><span data-stu-id="45d49-120">In the Azure environment Service Fabric uses the Fault Domain information provided by the environment to correctly configure the nodes in the cluster on your behalf.</span></span> <span data-ttu-id="45d49-121">Voor Service Fabric zelfstandig worden domeinen met fouten gedefinieerd op het moment dat het cluster is ingesteld</span><span class="sxs-lookup"><span data-stu-id="45d49-121">For Service Fabric Standalone, Fault Domains are defined at the time that the cluster is set up</span></span> 

> [!WARNING]
> <span data-ttu-id="45d49-122">Het is belangrijk dat de geleverde Service Fabric Foutdomein gegevens nauwkeurig is.</span><span class="sxs-lookup"><span data-stu-id="45d49-122">It is important that the Fault Domain information provided to Service Fabric is accurate.</span></span> <span data-ttu-id="45d49-123">Stel dat dat uw Service Fabric-cluster knooppunten binnen 10 virtuele machines, op vijf fysieke hosts worden uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="45d49-123">For example, let's say that your Service Fabric cluster's nodes are running inside 10 virtual machines, running on five physical hosts.</span></span> <span data-ttu-id="45d49-124">In dit geval wordt er 10 virtuele machines, maar er is slechts 5 verschillende (hoogste niveau) fault-domeinen.</span><span class="sxs-lookup"><span data-stu-id="45d49-124">In this case, even though there are 10 virtual machines, there's only 5 different (top level) fault domains.</span></span> <span data-ttu-id="45d49-125">Delen dezelfde fysieke host zorgt ervoor dat de virtuele machines te delen de dezelfde hoofddomein veroorzaakt omdat de virtuele machines gecoördineerde fout optreden als de fysieke host mislukt.</span><span class="sxs-lookup"><span data-stu-id="45d49-125">Sharing the same physical host causes VMs to share the same root fault domain, since the VMs experience coordinated failure if their physical host fails.</span></span>  
>
> <span data-ttu-id="45d49-126">Omdat Service Fabric het Foutdomein van een knooppunt niet te wijzigen verwacht.</span><span class="sxs-lookup"><span data-stu-id="45d49-126">Since Service Fabric expects the Fault Domain of a node not to change.</span></span> <span data-ttu-id="45d49-127">Andere mechanismen voor hoge beschikbaarheid van de virtuele machines, zoals gezorgd [HA virtuele machines](https://technet.microsoft.com/en-us/library/cc967323.aspx), transparante migratie van virtuele machines van de ene host naar een andere gebruiken.</span><span class="sxs-lookup"><span data-stu-id="45d49-127">Other mechanisms of ensuring high availability of the VMs, such as [HA-VMs](https://technet.microsoft.com/en-us/library/cc967323.aspx), use transparent migration of VMs from one host to another.</span></span> <span data-ttu-id="45d49-128">Deze mechanismen niet opnieuw te configureren en kennis van de code in de virtuele machine is uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="45d49-128">These mechanisms do not reconfigure or notify the running code inside the VM.</span></span> <span data-ttu-id="45d49-129">Als zodanig zijn **niet ondersteund** als omgevingen voor het uitvoeren van Service Fabric-clusters.</span><span class="sxs-lookup"><span data-stu-id="45d49-129">As such, they are **not supported** as environments for running Service Fabric clusters.</span></span> <span data-ttu-id="45d49-130">Service Fabric moet de gebruikte beveiligingstechnologieën alleen hoge beschikbaarheid.</span><span class="sxs-lookup"><span data-stu-id="45d49-130">Service Fabric should be the only high-availability technology employed.</span></span> <span data-ttu-id="45d49-131">Mechanismen zoals VM livemigratie, SAN's, of andere gebruikers zijn niet nodig.</span><span class="sxs-lookup"><span data-stu-id="45d49-131">Mechanisms like live VM migration, SANs, or others are not necessary.</span></span> <span data-ttu-id="45d49-132">Als u gebruikt in combinatie met Service Fabric, deze mechanismen _verminderen_ toepassing beschikbaarheid en betrouwbaarheid omdat ze extra complexiteit veroorzaken gecentraliseerde bronnen van de fout toevoegen en gebruiken van betrouwbaarheid en beschikbaarheidsstrategieën die met die in Service Fabric conflicteren.</span><span class="sxs-lookup"><span data-stu-id="45d49-132">If used in conjunction with Service Fabric, these mechanisms _reduce_ application availability and reliability because they introduce additional complexity, add centralized sources of failure, and utilize reliability and availability strategies that conflict with those in Service Fabric.</span></span> 
>
>

<span data-ttu-id="45d49-133">We kleur die de entiteiten die bijdragen aan domeinen met fouten en lijst van alle de verschillende domeinen met fouten die resulteren in de onderstaande afbeelding.</span><span class="sxs-lookup"><span data-stu-id="45d49-133">In the graphic below we color all the entities that contribute to Fault Domains and list all the different Fault Domains that result.</span></span> <span data-ttu-id="45d49-134">In dit voorbeeld hebben we datacenters ('DC'), rekken ('R') en blades ("B").</span><span class="sxs-lookup"><span data-stu-id="45d49-134">In this example, we have datacenters ("DC"), racks ("R"), and blades ("B").</span></span> <span data-ttu-id="45d49-135">Stelen, als elke blade meer dan één virtuele machine bevat, kan er een andere laag in de hiërarchie van het domein met fouten.</span><span class="sxs-lookup"><span data-stu-id="45d49-135">Conceivably, if each blade holds more than one virtual machine, there could be another layer in the Fault Domain hierarchy.</span></span>

<span data-ttu-id="45d49-136"><center>
![Knooppunten ingedeeld via domeinen met fouten][Image1]
</center></span><span class="sxs-lookup"><span data-stu-id="45d49-136"><center>
![Nodes organized via Fault Domains][Image1]
</center></span></span>

<span data-ttu-id="45d49-137">Tijdens runtime, de Service Fabric Cluster Resource Manager beschouwt de domeinen met fouten in het cluster en indelingen plannen.</span><span class="sxs-lookup"><span data-stu-id="45d49-137">During runtime, the Service Fabric Cluster Resource Manager considers the Fault Domains in the cluster and plans layouts.</span></span> <span data-ttu-id="45d49-138">De stateful replica's of stateless exemplaren voor een bepaalde service worden gedistribueerd, zodat ze in afzonderlijke domeinen met fouten.</span><span class="sxs-lookup"><span data-stu-id="45d49-138">The stateful replicas or stateless instances for a given service are distributed so they are in separate Fault Domains.</span></span> <span data-ttu-id="45d49-139">De service over domeinen met fouten worden verdeeld, zorgt ervoor dat de beschikbaarheid van de service niet is geknoeid als een Foutdomein op elk niveau van de hiërarchie is mislukt.</span><span class="sxs-lookup"><span data-stu-id="45d49-139">Distributing the service across fault domains ensures the availability of the service is not compromised when a Fault Domain fails at any level of the hierarchy.</span></span>

<span data-ttu-id="45d49-140">Van service Fabric-Cluster Resource Manager niet van belang hoeveel lagen die zich in de hiërarchie van het domein met fouten.</span><span class="sxs-lookup"><span data-stu-id="45d49-140">Service Fabric’s Cluster Resource Manager doesn’t care how many layers there are in the Fault Domain hierarchy.</span></span> <span data-ttu-id="45d49-141">Echter, wordt geprobeerd om ervoor te zorgen dat het verlies van elk een deel van de hiërarchie heeft geen invloed op services die erin worden uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="45d49-141">However, it tries to ensure that the loss of any one portion of the hierarchy doesn’t impact services running in it.</span></span> 

<span data-ttu-id="45d49-142">Het is raadzaam als er hetzelfde aantal knooppunten op elk niveau van diepte in de hiërarchie van het domein met fouten.</span><span class="sxs-lookup"><span data-stu-id="45d49-142">It is best if there are the same number of nodes at each level of depth in the Fault Domain hierarchy.</span></span> <span data-ttu-id="45d49-143">Als de 'boomstructuur' foutdomeinen onbalans in het cluster is, maakt het moeilijker voor het Cluster Resource Manager om de beste toewijzing van services te achterhalen.</span><span class="sxs-lookup"><span data-stu-id="45d49-143">If the “tree” of Fault Domains is unbalanced in your cluster, it makes it harder for the Cluster Resource Manager to figure out the best allocation of services.</span></span> <span data-ttu-id="45d49-144">Imbalanced Foutdomeinen indelingen betekenen dat het verlies van de impact van bepaalde domeinen de beschikbaarheid van services die meer dan andere domeinen.</span><span class="sxs-lookup"><span data-stu-id="45d49-144">Imbalanced Fault Domains layouts mean that the loss of some domains impact the availability of services more than other domains.</span></span> <span data-ttu-id="45d49-145">Als gevolg hiervan de Cluster Resource Manager is verwijderd tussen twee doelen: wil de computers in het domein 'dikke' door het plaatsen van services op deze gebruiken en deze wil services in andere domeinen te plaatsen zodat het verlies van een domein geen problemen veroorzaken.</span><span class="sxs-lookup"><span data-stu-id="45d49-145">As a result, the Cluster Resource Manager is torn between two goals: It wants to use the machines in that “heavy” domain by placing services on them, and it wants to place services in other domains so that the loss of a domain doesn’t cause problems.</span></span> 

<span data-ttu-id="45d49-146">Wat imbalanced domeinen eruit?</span><span class="sxs-lookup"><span data-stu-id="45d49-146">What do imbalanced domains look like?</span></span> <span data-ttu-id="45d49-147">In het onderstaande diagram weergeven we twee verschillende cluster indelingen.</span><span class="sxs-lookup"><span data-stu-id="45d49-147">In the diagram below, we show two different cluster layouts.</span></span> <span data-ttu-id="45d49-148">In het eerste voorbeeld worden de knooppunten gelijkmatig verdeeld over de domeinen met fouten.</span><span class="sxs-lookup"><span data-stu-id="45d49-148">In the first example, the nodes are distributed evenly across the Fault Domains.</span></span> <span data-ttu-id="45d49-149">In het tweede voorbeeld heeft één Foutdomein veel meer knooppunten dan de andere domeinen met fouten.</span><span class="sxs-lookup"><span data-stu-id="45d49-149">In the second example, one Fault Domain has many more nodes than the other Fault Domains.</span></span> 

<span data-ttu-id="45d49-150"><center>
![Twee verschillende cluster indelingen][Image2]
</center></span><span class="sxs-lookup"><span data-stu-id="45d49-150"><center>
![Two different cluster layouts][Image2]
</center></span></span>

<span data-ttu-id="45d49-151">In Azure, wordt voor u de keuze van dat domein met fouten een knooppunt bevat beheerd.</span><span class="sxs-lookup"><span data-stu-id="45d49-151">In Azure, the choice of which Fault Domain contains a node is managed for you.</span></span> <span data-ttu-id="45d49-152">Echter, afhankelijk van het aantal knooppunten die u inricht u kunt nog steeds uiteindelijk domeinen met fouten met meer knooppunten bevat dan andere.</span><span class="sxs-lookup"><span data-stu-id="45d49-152">However, depending on the number of nodes that you provision you can still end up with Fault Domains with more nodes in them than others.</span></span> <span data-ttu-id="45d49-153">Stel dat u hebt vijf domeinen met fouten in het cluster, maar zeven knooppunten inrichten voor een gegeven NodeType.</span><span class="sxs-lookup"><span data-stu-id="45d49-153">For example, say you have five Fault Domains in the cluster but provision seven nodes for a given NodeType.</span></span> <span data-ttu-id="45d49-154">In dit geval wordt eindigen de eerste twee domeinen met fouten met meer knooppunten.</span><span class="sxs-lookup"><span data-stu-id="45d49-154">In this case, the first two Fault Domains end up with more nodes.</span></span> <span data-ttu-id="45d49-155">Als u nog meer NodeTypes met slechts enkele exemplaren implementeert, wordt het probleem slechter opgehaald.</span><span class="sxs-lookup"><span data-stu-id="45d49-155">If you continue to deploy more NodeTypes with only a couple instances, the problem gets worse.</span></span> <span data-ttu-id="45d49-156">Type is daarom die het is raadzaam dat het aantal knooppunten in elk knooppunt een veelvoud van het aantal Foutdomeinen.</span><span class="sxs-lookup"><span data-stu-id="45d49-156">For this reason it's recommended that the number of nodes in each node type is a multiple of the number of Fault Domains.</span></span>

## <a name="upgrade-domains"></a><span data-ttu-id="45d49-157">Upgradedomeinen</span><span class="sxs-lookup"><span data-stu-id="45d49-157">Upgrade domains</span></span>
<span data-ttu-id="45d49-158">Upgradedomeinen zijn een andere functie waarmee de Service Fabric Cluster Resource Manager inzicht in de indeling van het cluster.</span><span class="sxs-lookup"><span data-stu-id="45d49-158">Upgrade Domains are another feature that helps the Service Fabric Cluster Resource Manager understand the layout of the cluster.</span></span> <span data-ttu-id="45d49-159">Upgradedomeinen definiëren sets met knooppunten die zijn bijgewerkt op hetzelfde moment.</span><span class="sxs-lookup"><span data-stu-id="45d49-159">Upgrade Domains define sets of nodes that are upgraded at the same time.</span></span> <span data-ttu-id="45d49-160">Upgradedomeinen helpen bij het Cluster Resource Manager begrijpen en te organiseren beheerbewerkingen zoals upgrades.</span><span class="sxs-lookup"><span data-stu-id="45d49-160">Upgrade Domains help the Cluster Resource Manager understand and orchestrate management operations like upgrades.</span></span>

<span data-ttu-id="45d49-161">Upgradedomeinen zijn veel zoals domeinen met fouten, maar met enkele belangrijke verschillen.</span><span class="sxs-lookup"><span data-stu-id="45d49-161">Upgrade Domains are a lot like Fault Domains, but with a couple key differences.</span></span> <span data-ttu-id="45d49-162">Eerst definiëren gebieden van gecoördineerde hardwarefouten domeinen met fouten.</span><span class="sxs-lookup"><span data-stu-id="45d49-162">First, areas of coordinated hardware failures define Fault Domains.</span></span> <span data-ttu-id="45d49-163">Upgradedomeinen, aan de andere kant zijn gedefinieerd door het beleid.</span><span class="sxs-lookup"><span data-stu-id="45d49-163">Upgrade Domains, on the other hand, are defined by policy.</span></span> <span data-ttu-id="45d49-164">Krijgt u te bepalen hoeveel u, in plaats van dit wordt bepaald door de omgeving.</span><span class="sxs-lookup"><span data-stu-id="45d49-164">You get to decide how many you want, rather than it being dictated by the environment.</span></span> <span data-ttu-id="45d49-165">U kunt zoveel Upgrade-domeinen als knooppunten hebben.</span><span class="sxs-lookup"><span data-stu-id="45d49-165">You could have as many Upgrade Domains as you do nodes.</span></span> <span data-ttu-id="45d49-166">Een ander verschil tussen domeinen met fouten en -domeinen upgraden is dat er geen Upgrade domeinen hiërarchische.</span><span class="sxs-lookup"><span data-stu-id="45d49-166">Another difference between Fault Domains and Upgrade Domains is that Upgrade Domains are not hierarchical.</span></span> <span data-ttu-id="45d49-167">In plaats daarvan lijken ze meer op een eenvoudige label.</span><span class="sxs-lookup"><span data-stu-id="45d49-167">Instead, they are more like a simple tag.</span></span> 

<span data-ttu-id="45d49-168">Het volgende diagram toont de dat drie domeinen upgraden worden striped verdeeld over drie domeinen met fouten.</span><span class="sxs-lookup"><span data-stu-id="45d49-168">The following diagram shows three Upgrade Domains are striped across three Fault Domains.</span></span> <span data-ttu-id="45d49-169">U ziet ook een mogelijke plaatsing voor drie verschillende replica's van een stateful service, waar elke in verschillende domeinen met fouten en domeinen upgraden eindigt.</span><span class="sxs-lookup"><span data-stu-id="45d49-169">It also shows one possible placement for three different replicas of a stateful service, where each ends up in different Fault and Upgrade Domains.</span></span> <span data-ttu-id="45d49-170">Deze plaatsing kunt het verlies van een domein met fouten tijdens het in het midden van een service-upgrade en nog steeds een kopie van de code en gegevens.</span><span class="sxs-lookup"><span data-stu-id="45d49-170">This placement allows the loss of a Fault Domain while in the middle of a service upgrade and still have one copy of the code and data.</span></span>  

<span data-ttu-id="45d49-171"><center>
![Plaatsing met fouten en Upgradedomeinen][Image3]
</center></span><span class="sxs-lookup"><span data-stu-id="45d49-171"><center>
![Placement With Fault and Upgrade Domains][Image3]
</center></span></span>

<span data-ttu-id="45d49-172">Er zijn voor- en nadelen tot het instellen van grote aantallen domeinen upgraden.</span><span class="sxs-lookup"><span data-stu-id="45d49-172">There are pros and cons to having large numbers of Upgrade Domains.</span></span> <span data-ttu-id="45d49-173">Meer domeinen upgraden betekent elke stap van de upgrade is een meer gedetailleerd en daarom is van invloed op een kleiner aantal knooppunten of services.</span><span class="sxs-lookup"><span data-stu-id="45d49-173">More Upgrade Domains means each step of the upgrade is more granular and therefore affects a smaller number of nodes or services.</span></span> <span data-ttu-id="45d49-174">Als gevolg hiervan minder services hebben om te gaan op een tijdstip minder verloop Inleiding in het systeem.</span><span class="sxs-lookup"><span data-stu-id="45d49-174">As a result, fewer services have to move at a time, introducing less churn into the system.</span></span> <span data-ttu-id="45d49-175">Dit heeft vaak de betrouwbaarheid, omdat minder van de service wordt beïnvloed door een probleem tijdens de upgrade is geïntroduceerd.</span><span class="sxs-lookup"><span data-stu-id="45d49-175">This tends to improve reliability, since less of the service is impacted by any issue introduced during the upgrade.</span></span> <span data-ttu-id="45d49-176">Meer domeinen upgraden betekent ook dat u minder beschikbare buffer op andere knooppunten moet voor het afhandelen van de impact van de upgrade.</span><span class="sxs-lookup"><span data-stu-id="45d49-176">More Upgrade Domains also means that you need less available buffer on other nodes to handle the impact of the upgrade.</span></span> <span data-ttu-id="45d49-177">Bijvoorbeeld, als u vijf upgraden domeinen hebt, afhandelt de knooppunten in elk ongeveer 20% van uw verkeer.</span><span class="sxs-lookup"><span data-stu-id="45d49-177">For example, if you have five Upgrade Domains, the nodes in each are handling roughly 20% of your traffic.</span></span> <span data-ttu-id="45d49-178">Als u buiten werking stellen dat domein bijwerken voor een upgrade moet, moet waarbij deze belasting meestal gaat u een locatie.</span><span class="sxs-lookup"><span data-stu-id="45d49-178">If you need to take down that Upgrade Domain for an upgrade, that load usually needs to go somewhere.</span></span> <span data-ttu-id="45d49-179">Aangezien u vier resterende upgraden domeinen hebt, moet elk voldoende ruimte voor ongeveer 5% van al het verkeer.</span><span class="sxs-lookup"><span data-stu-id="45d49-179">Since you have four remaining Upgrade Domains, each must have room for about 5% of the total traffic.</span></span> <span data-ttu-id="45d49-180">Meer domeinen upgraden betekent dat u minder buffer op de knooppunten in het cluster nodig.</span><span class="sxs-lookup"><span data-stu-id="45d49-180">More Upgrade Domains means you need less buffer on the nodes in the cluster.</span></span> <span data-ttu-id="45d49-181">Denk bijvoorbeeld als er 10 domeinen upgraden in plaats daarvan.</span><span class="sxs-lookup"><span data-stu-id="45d49-181">For example, consider if you had 10 Upgrade Domains instead.</span></span> <span data-ttu-id="45d49-182">In dat geval zouden elke UD alleen worden verwerkt ongeveer 10% van het totale verkeer.</span><span class="sxs-lookup"><span data-stu-id="45d49-182">In that case, each UD would only be handling about 10% of the total traffic.</span></span> <span data-ttu-id="45d49-183">Wanneer een Upgradestappen via het cluster, zou alleen elk domein moet voldoende ruimte voor ongeveer 1.1% van het totale verkeer.</span><span class="sxs-lookup"><span data-stu-id="45d49-183">When an upgrade steps through the cluster, each domain would only need to have room for about 1.1% of the total traffic.</span></span> <span data-ttu-id="45d49-184">Meer upgraden domeinen in het algemeen kunt u uw knooppunten uitgevoerd op een hoger gebruik, omdat u minder gereserveerde capaciteit nodig.</span><span class="sxs-lookup"><span data-stu-id="45d49-184">More Upgrade Domains generally allow you to run your nodes at higher utilization, since you need less reserved capacity.</span></span> <span data-ttu-id="45d49-185">Hetzelfde geldt voor domeinen met fouten.</span><span class="sxs-lookup"><span data-stu-id="45d49-185">The same is true for Fault Domains.</span></span>  

<span data-ttu-id="45d49-186">Het nadeel dat veel domeinen upgraden is dat upgrades vaak langer duren.</span><span class="sxs-lookup"><span data-stu-id="45d49-186">The downside of having many Upgrade Domains is that upgrades tend to take longer.</span></span> <span data-ttu-id="45d49-187">Service Fabric wacht een korte periode na een Upgrade-domein is voltooid en controleert voordat u begint met de upgrade voor de volgende.</span><span class="sxs-lookup"><span data-stu-id="45d49-187">Service Fabric waits a short period of time after an Upgrade Domain is completed and performs checks before starting to upgrade the next one.</span></span> <span data-ttu-id="45d49-188">Deze vertragingen inschakelen detecteren problemen die zijn geïntroduceerd door de upgrade voordat de upgrade wordt uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="45d49-188">These delays enable detecting issues introduced by the upgrade before the upgrade proceeds.</span></span> <span data-ttu-id="45d49-189">Afweging is acceptabel omdat deze onjuiste wijzigingen voorkomt dat van invloed zijn op te veel van de service op een tijdstip.</span><span class="sxs-lookup"><span data-stu-id="45d49-189">The tradeoff is acceptable because it prevents bad changes from affecting too much of the service at a time.</span></span>

<span data-ttu-id="45d49-190">Te weinig upgraden domeinen heeft veel negatieve neveneffecten – terwijl elke afzonderlijke upgraden domein niet actief is en een groot deel van een upgrade wordt uitgevoerd de algehele capaciteit is niet beschikbaar.</span><span class="sxs-lookup"><span data-stu-id="45d49-190">Too few Upgrade Domains has many negative side effects – while each individual Upgrade Domain is down and being upgraded a large portion of your overall capacity is unavailable.</span></span> <span data-ttu-id="45d49-191">Bijvoorbeeld, als u slechts drie domeinen upgraden hebt duurt u omlaag ongeveer 1/3 van uw algehele service of het cluster capaciteit tegelijk.</span><span class="sxs-lookup"><span data-stu-id="45d49-191">For example, if you only have three Upgrade Domains you are taking down about 1/3 of your overall service or cluster capacity at a time.</span></span> <span data-ttu-id="45d49-192">Met zoveel van uw service niet actief in één keer niet gewenst omdat u moet voldoende capaciteit hebben in de rest van het cluster voor het afhandelen van de werkbelasting.</span><span class="sxs-lookup"><span data-stu-id="45d49-192">Having so much of your service down at once isn’t desirable since you have to have enough capacity in the rest of your cluster to handle the workload.</span></span> <span data-ttu-id="45d49-193">Onderhoud van deze buffer houdt in dat tijdens de normale werking die knooppunten kleiner dan ze anders zou zijn geladen.</span><span class="sxs-lookup"><span data-stu-id="45d49-193">Maintaining that buffer means that during normal operation those nodes are less loaded than they would be otherwise.</span></span> <span data-ttu-id="45d49-194">Dit verhoogt de kosten van het uitvoeren van uw service.</span><span class="sxs-lookup"><span data-stu-id="45d49-194">This increases the cost of running your service.</span></span>

<span data-ttu-id="45d49-195">Er is geen echte limiet voor het totale aantal fouten of domeinen upgraden in een omgeving, of de beperkingen van hoe ze elkaar overlappen.</span><span class="sxs-lookup"><span data-stu-id="45d49-195">There’s no real limit to the total number of fault or Upgrade Domains in an environment, or constraints on how they overlap.</span></span> <span data-ttu-id="45d49-196">Die gezegd, er zijn enkele algemene patronen zijn:</span><span class="sxs-lookup"><span data-stu-id="45d49-196">That said, there are several common patterns:</span></span>

- <span data-ttu-id="45d49-197">Domeinen met fouten en -domeinen upgraden toegewezen 1:1</span><span class="sxs-lookup"><span data-stu-id="45d49-197">Fault Domains and Upgrade Domains mapped 1:1</span></span>
- <span data-ttu-id="45d49-198">Een Upgrade Domain per knooppunt (fysieke of virtuele OS exemplaar)</span><span class="sxs-lookup"><span data-stu-id="45d49-198">One Upgrade Domain per Node (physical or virtual OS instance)</span></span>
- <span data-ttu-id="45d49-199">Een 'striped' of 'matrix' model waarbij de domeinen met fouten en -domeinen upgraden vormen een matrix met machines meestal onder de diagonaal</span><span class="sxs-lookup"><span data-stu-id="45d49-199">A “striped” or “matrix” model where the Fault Domains and Upgrade Domains form a matrix with machines usually running down the diagonals</span></span>

<span data-ttu-id="45d49-200"><center>
![Probleem- en Upgradedomein indelingen][Image4]
</center></span><span class="sxs-lookup"><span data-stu-id="45d49-200"><center>
![Fault and Upgrade Domain Layouts][Image4]
</center></span></span>

<span data-ttu-id="45d49-201">Er is dat geen best beantwoordt welke indeling u moet kiezen, elk heeft een aantal voordelen en nadelen.</span><span class="sxs-lookup"><span data-stu-id="45d49-201">There’s no best answer which layout to choose, each has some pros and cons.</span></span> <span data-ttu-id="45d49-202">Het model 1FD:1UD is bijvoorbeeld heel eenvoudig te installeren.</span><span class="sxs-lookup"><span data-stu-id="45d49-202">For example, the 1FD:1UD model is simple to set up.</span></span> <span data-ttu-id="45d49-203">De 1 domein upgraden per knooppunt model zoals welke mensen worden gebruikt voor de meeste is.</span><span class="sxs-lookup"><span data-stu-id="45d49-203">The 1 Upgrade Domain per Node model is most like what people are used to.</span></span> <span data-ttu-id="45d49-204">Elk knooppunt is tijdens upgrades onafhankelijk bijgewerkt.</span><span class="sxs-lookup"><span data-stu-id="45d49-204">During upgrades each node is updated independently.</span></span> <span data-ttu-id="45d49-205">Dit is vergelijkbaar met hoe kleine sets machines handmatig zijn bijgewerkt in het verleden.</span><span class="sxs-lookup"><span data-stu-id="45d49-205">This is similar to how small sets of machines were upgraded manually in the past.</span></span> 

<span data-ttu-id="45d49-206">Het meest voorkomende model is de matrix FD/UD, waarbij de FDs en UDs een tabel vormen en knooppunten worden geplaatst langs de diagonaal wordt gestart.</span><span class="sxs-lookup"><span data-stu-id="45d49-206">The most common model is the FD/UD matrix, where the FDs and UDs form a table and nodes are placed starting along the diagonal.</span></span> <span data-ttu-id="45d49-207">Dit is de standaard gebruikt in Service Fabric-clusters in Azure.</span><span class="sxs-lookup"><span data-stu-id="45d49-207">This is the model used by default in Service Fabric clusters in Azure.</span></span> <span data-ttu-id="45d49-208">Voor clusters met knooppunten die veel belandt alles wat u ziet eruit als het bovenstaande compacte matrix-patroon.</span><span class="sxs-lookup"><span data-stu-id="45d49-208">For clusters with many nodes everything ends up looking like the dense matrix pattern above.</span></span>

## <a name="fault-and-upgrade-domain-constraints-and-resulting-behavior"></a><span data-ttu-id="45d49-209">Beperkingen voor fouttolerantie en het upgraden van domein en het resulterende gedrag</span><span class="sxs-lookup"><span data-stu-id="45d49-209">Fault and Upgrade Domain constraints and resulting behavior</span></span>
<span data-ttu-id="45d49-210">De Cluster Resource Manager beschouwt behoefte aan een service verdeeld zijn over de fout en -domeinen upgraden als een beperking behouden.</span><span class="sxs-lookup"><span data-stu-id="45d49-210">The Cluster Resource Manager treats the desire to keep a service balanced across fault and Upgrade Domains as a constraint.</span></span> <span data-ttu-id="45d49-211">U vindt meer informatie over de beperkingen in [in dit artikel](service-fabric-cluster-resource-manager-management-integration.md).</span><span class="sxs-lookup"><span data-stu-id="45d49-211">You can find out more about constraints in [this article](service-fabric-cluster-resource-manager-management-integration.md).</span></span> <span data-ttu-id="45d49-212">De status van de beperkingen voor probleem- en het upgraden van domein: ' voor een bepaalde service partitie moet nooit er een verschil *meer dan één* in het aantal serviceobjecten tussen (stateless service-exemplaren of stateful service replica's) twee domeinen."</span><span class="sxs-lookup"><span data-stu-id="45d49-212">The Fault and Upgrade Domain constraints state: "For a given service partition there should never be a difference *greater than one* in the number of service objects (stateless service instances or stateful service replicas) between two domains."</span></span> <span data-ttu-id="45d49-213">Dit voorkomt dat bepaalde verplaatst of regelingen die strijdig zijn met deze beperking.</span><span class="sxs-lookup"><span data-stu-id="45d49-213">This prevents certain moves or arrangements that violate this constraint.</span></span>

<span data-ttu-id="45d49-214">Bekijk een voorbeeld.</span><span class="sxs-lookup"><span data-stu-id="45d49-214">Let's look at one example.</span></span> <span data-ttu-id="45d49-215">Stel dat we een cluster met zes knooppunten zijn geconfigureerd met vijf domeinen met fouten en vijf domeinen upgraden hebben.</span><span class="sxs-lookup"><span data-stu-id="45d49-215">Let's say that we have a cluster with six nodes, configured with five Fault Domains and five Upgrade Domains.</span></span>

|  | <span data-ttu-id="45d49-216">FD0</span><span class="sxs-lookup"><span data-stu-id="45d49-216">FD0</span></span> | <span data-ttu-id="45d49-217">FD1</span><span class="sxs-lookup"><span data-stu-id="45d49-217">FD1</span></span> | <span data-ttu-id="45d49-218">FD2</span><span class="sxs-lookup"><span data-stu-id="45d49-218">FD2</span></span> | <span data-ttu-id="45d49-219">FD3</span><span class="sxs-lookup"><span data-stu-id="45d49-219">FD3</span></span> | <span data-ttu-id="45d49-220">FD4</span><span class="sxs-lookup"><span data-stu-id="45d49-220">FD4</span></span> |
| --- |:---:|:---:|:---:|:---:|:---:|
| <span data-ttu-id="45d49-221">**UD0**</span><span class="sxs-lookup"><span data-stu-id="45d49-221">**UD0**</span></span> |<span data-ttu-id="45d49-222">N1</span><span class="sxs-lookup"><span data-stu-id="45d49-222">N1</span></span> | | | | |
| <span data-ttu-id="45d49-223">**UD1**</span><span class="sxs-lookup"><span data-stu-id="45d49-223">**UD1**</span></span> |<span data-ttu-id="45d49-224">N6</span><span class="sxs-lookup"><span data-stu-id="45d49-224">N6</span></span> |<span data-ttu-id="45d49-225">N2</span><span class="sxs-lookup"><span data-stu-id="45d49-225">N2</span></span> | | | |
| <span data-ttu-id="45d49-226">**UD2**</span><span class="sxs-lookup"><span data-stu-id="45d49-226">**UD2**</span></span> | | |<span data-ttu-id="45d49-227">N3</span><span class="sxs-lookup"><span data-stu-id="45d49-227">N3</span></span> | | |
| <span data-ttu-id="45d49-228">**UD3**</span><span class="sxs-lookup"><span data-stu-id="45d49-228">**UD3**</span></span> | | | |<span data-ttu-id="45d49-229">N4</span><span class="sxs-lookup"><span data-stu-id="45d49-229">N4</span></span> | |
| <span data-ttu-id="45d49-230">**UD4**</span><span class="sxs-lookup"><span data-stu-id="45d49-230">**UD4**</span></span> | | | | |<span data-ttu-id="45d49-231">N5</span><span class="sxs-lookup"><span data-stu-id="45d49-231">N5</span></span> |

<span data-ttu-id="45d49-232">Nu gaan we spreken maken we een service met een TargetReplicaSetSize (of voor een stateless service een InstanceCount) van vijf.</span><span class="sxs-lookup"><span data-stu-id="45d49-232">Now let's say that we create a service with a TargetReplicaSetSize (or, for a stateless service an InstanceCount) of five.</span></span> <span data-ttu-id="45d49-233">De replica's neerzetten op N1 N5.</span><span class="sxs-lookup"><span data-stu-id="45d49-233">The replicas land on N1-N5.</span></span> <span data-ttu-id="45d49-234">In feite is nooit N6 gebruikt ongeacht hoeveel services zoals deze die u maakt.</span><span class="sxs-lookup"><span data-stu-id="45d49-234">In fact, N6 is never used no matter how many services like this you create.</span></span> <span data-ttu-id="45d49-235">Maar waarom?</span><span class="sxs-lookup"><span data-stu-id="45d49-235">But why?</span></span> <span data-ttu-id="45d49-236">Bekijk het verschil tussen de huidige indeling en wat er gebeurt als N6 is gekozen.</span><span class="sxs-lookup"><span data-stu-id="45d49-236">Let's look at the difference between the current layout and what would happen if N6 is chosen.</span></span>

<span data-ttu-id="45d49-237">Dit is de indeling die wij en het totale aantal replica's per fouttolerantie en het upgraden van domein:</span><span class="sxs-lookup"><span data-stu-id="45d49-237">Here's the layout we got and the total number of replicas per Fault and Upgrade Domain:</span></span>

|  | <span data-ttu-id="45d49-238">FD0</span><span class="sxs-lookup"><span data-stu-id="45d49-238">FD0</span></span> | <span data-ttu-id="45d49-239">FD1</span><span class="sxs-lookup"><span data-stu-id="45d49-239">FD1</span></span> | <span data-ttu-id="45d49-240">FD2</span><span class="sxs-lookup"><span data-stu-id="45d49-240">FD2</span></span> | <span data-ttu-id="45d49-241">FD3</span><span class="sxs-lookup"><span data-stu-id="45d49-241">FD3</span></span> | <span data-ttu-id="45d49-242">FD4</span><span class="sxs-lookup"><span data-stu-id="45d49-242">FD4</span></span> | <span data-ttu-id="45d49-243">UDTotal</span><span class="sxs-lookup"><span data-stu-id="45d49-243">UDTotal</span></span> |
| --- |:---:|:---:|:---:|:---:|:---:|:---:|
| <span data-ttu-id="45d49-244">**UD0**</span><span class="sxs-lookup"><span data-stu-id="45d49-244">**UD0**</span></span> |<span data-ttu-id="45d49-245">R1</span><span class="sxs-lookup"><span data-stu-id="45d49-245">R1</span></span> | | | | |<span data-ttu-id="45d49-246">1</span><span class="sxs-lookup"><span data-stu-id="45d49-246">1</span></span> |
| <span data-ttu-id="45d49-247">**UD1**</span><span class="sxs-lookup"><span data-stu-id="45d49-247">**UD1**</span></span> | |<span data-ttu-id="45d49-248">R2</span><span class="sxs-lookup"><span data-stu-id="45d49-248">R2</span></span> | | | |<span data-ttu-id="45d49-249">1</span><span class="sxs-lookup"><span data-stu-id="45d49-249">1</span></span> |
| <span data-ttu-id="45d49-250">**UD2**</span><span class="sxs-lookup"><span data-stu-id="45d49-250">**UD2**</span></span> | | |<span data-ttu-id="45d49-251">R3</span><span class="sxs-lookup"><span data-stu-id="45d49-251">R3</span></span> | | |<span data-ttu-id="45d49-252">1</span><span class="sxs-lookup"><span data-stu-id="45d49-252">1</span></span> |
| <span data-ttu-id="45d49-253">**UD3**</span><span class="sxs-lookup"><span data-stu-id="45d49-253">**UD3**</span></span> | | | |<span data-ttu-id="45d49-254">R4</span><span class="sxs-lookup"><span data-stu-id="45d49-254">R4</span></span> | |<span data-ttu-id="45d49-255">1</span><span class="sxs-lookup"><span data-stu-id="45d49-255">1</span></span> |
| <span data-ttu-id="45d49-256">**UD4**</span><span class="sxs-lookup"><span data-stu-id="45d49-256">**UD4**</span></span> | | | | |<span data-ttu-id="45d49-257">R5</span><span class="sxs-lookup"><span data-stu-id="45d49-257">R5</span></span> |<span data-ttu-id="45d49-258">1</span><span class="sxs-lookup"><span data-stu-id="45d49-258">1</span></span> |
| <span data-ttu-id="45d49-259">**FDTotal**</span><span class="sxs-lookup"><span data-stu-id="45d49-259">**FDTotal**</span></span> |<span data-ttu-id="45d49-260">1</span><span class="sxs-lookup"><span data-stu-id="45d49-260">1</span></span> |<span data-ttu-id="45d49-261">1</span><span class="sxs-lookup"><span data-stu-id="45d49-261">1</span></span> |<span data-ttu-id="45d49-262">1</span><span class="sxs-lookup"><span data-stu-id="45d49-262">1</span></span> |<span data-ttu-id="45d49-263">1</span><span class="sxs-lookup"><span data-stu-id="45d49-263">1</span></span> |<span data-ttu-id="45d49-264">1</span><span class="sxs-lookup"><span data-stu-id="45d49-264">1</span></span> |- |

<span data-ttu-id="45d49-265">Deze indeling wordt verdeeld in termen van knooppunten per domein met fouten en het upgraden van domein.</span><span class="sxs-lookup"><span data-stu-id="45d49-265">This layout is balanced in terms of nodes per Fault Domain and Upgrade Domain.</span></span> <span data-ttu-id="45d49-266">Het is ook taakverdeling in termen van het aantal replica's per probleem- en Upgrade-domein.</span><span class="sxs-lookup"><span data-stu-id="45d49-266">It is also balanced in terms of the number of replicas per Fault and Upgrade Domain.</span></span> <span data-ttu-id="45d49-267">Elk domein heeft hetzelfde aantal knooppunten en hetzelfde aantal replica's.</span><span class="sxs-lookup"><span data-stu-id="45d49-267">Each domain has the same number of nodes and the same number of replicas.</span></span>

<span data-ttu-id="45d49-268">Nu gaan we kijken wat gebeurt er als er N6 in plaats van N2 gebruikt waren.</span><span class="sxs-lookup"><span data-stu-id="45d49-268">Now, let's look at what would happen if we'd used N6 instead of N2.</span></span> <span data-ttu-id="45d49-269">Hoe wordt de replica's worden gedistribueerd vervolgens?</span><span class="sxs-lookup"><span data-stu-id="45d49-269">How would the replicas be distributed then?</span></span>

|  | <span data-ttu-id="45d49-270">FD0</span><span class="sxs-lookup"><span data-stu-id="45d49-270">FD0</span></span> | <span data-ttu-id="45d49-271">FD1</span><span class="sxs-lookup"><span data-stu-id="45d49-271">FD1</span></span> | <span data-ttu-id="45d49-272">FD2</span><span class="sxs-lookup"><span data-stu-id="45d49-272">FD2</span></span> | <span data-ttu-id="45d49-273">FD3</span><span class="sxs-lookup"><span data-stu-id="45d49-273">FD3</span></span> | <span data-ttu-id="45d49-274">FD4</span><span class="sxs-lookup"><span data-stu-id="45d49-274">FD4</span></span> | <span data-ttu-id="45d49-275">UDTotal</span><span class="sxs-lookup"><span data-stu-id="45d49-275">UDTotal</span></span> |
| --- |:---:|:---:|:---:|:---:|:---:|:---:|
| <span data-ttu-id="45d49-276">**UD0**</span><span class="sxs-lookup"><span data-stu-id="45d49-276">**UD0**</span></span> |<span data-ttu-id="45d49-277">R1</span><span class="sxs-lookup"><span data-stu-id="45d49-277">R1</span></span> | | | | |<span data-ttu-id="45d49-278">1</span><span class="sxs-lookup"><span data-stu-id="45d49-278">1</span></span> |
| <span data-ttu-id="45d49-279">**UD1**</span><span class="sxs-lookup"><span data-stu-id="45d49-279">**UD1**</span></span> |<span data-ttu-id="45d49-280">R5</span><span class="sxs-lookup"><span data-stu-id="45d49-280">R5</span></span> | | | | |<span data-ttu-id="45d49-281">1</span><span class="sxs-lookup"><span data-stu-id="45d49-281">1</span></span> |
| <span data-ttu-id="45d49-282">**UD2**</span><span class="sxs-lookup"><span data-stu-id="45d49-282">**UD2**</span></span> | | |<span data-ttu-id="45d49-283">R2</span><span class="sxs-lookup"><span data-stu-id="45d49-283">R2</span></span> | | |<span data-ttu-id="45d49-284">1</span><span class="sxs-lookup"><span data-stu-id="45d49-284">1</span></span> |
| <span data-ttu-id="45d49-285">**UD3**</span><span class="sxs-lookup"><span data-stu-id="45d49-285">**UD3**</span></span> | | | |<span data-ttu-id="45d49-286">R3</span><span class="sxs-lookup"><span data-stu-id="45d49-286">R3</span></span> | |<span data-ttu-id="45d49-287">1</span><span class="sxs-lookup"><span data-stu-id="45d49-287">1</span></span> |
| <span data-ttu-id="45d49-288">**UD4**</span><span class="sxs-lookup"><span data-stu-id="45d49-288">**UD4**</span></span> | | | | |<span data-ttu-id="45d49-289">R4</span><span class="sxs-lookup"><span data-stu-id="45d49-289">R4</span></span> |<span data-ttu-id="45d49-290">1</span><span class="sxs-lookup"><span data-stu-id="45d49-290">1</span></span> |
| <span data-ttu-id="45d49-291">**FDTotal**</span><span class="sxs-lookup"><span data-stu-id="45d49-291">**FDTotal**</span></span> |<span data-ttu-id="45d49-292">2</span><span class="sxs-lookup"><span data-stu-id="45d49-292">2</span></span> |<span data-ttu-id="45d49-293">0</span><span class="sxs-lookup"><span data-stu-id="45d49-293">0</span></span> |<span data-ttu-id="45d49-294">1</span><span class="sxs-lookup"><span data-stu-id="45d49-294">1</span></span> |<span data-ttu-id="45d49-295">1</span><span class="sxs-lookup"><span data-stu-id="45d49-295">1</span></span> |<span data-ttu-id="45d49-296">1</span><span class="sxs-lookup"><span data-stu-id="45d49-296">1</span></span> |- |

<span data-ttu-id="45d49-297">Deze lay-out is in strijd met onze definitie voor de beperking van het domein met fouten.</span><span class="sxs-lookup"><span data-stu-id="45d49-297">This layout violates our definition for the Fault Domain constraint.</span></span> <span data-ttu-id="45d49-298">FD0 heeft twee replica's, terwijl FD1 nul heeft, waardoor het verschil tussen FD0 en FD1 een totaal van twee.</span><span class="sxs-lookup"><span data-stu-id="45d49-298">FD0 has two replicas, while FD1 has zero, making the difference between FD0 and FD1 a total of two.</span></span> <span data-ttu-id="45d49-299">De Cluster Resource Manager is niet toegestaan voor deze benadering.</span><span class="sxs-lookup"><span data-stu-id="45d49-299">The Cluster Resource Manager does not allow this arrangement.</span></span> <span data-ttu-id="45d49-300">Op dezelfde manier als we N2 en N6 (in plaats van N1 en N2 gekozen) dat we zouden krijgen:</span><span class="sxs-lookup"><span data-stu-id="45d49-300">Similarly if we picked N2 and N6 (instead of N1 and N2) we'd get:</span></span>

|  | <span data-ttu-id="45d49-301">FD0</span><span class="sxs-lookup"><span data-stu-id="45d49-301">FD0</span></span> | <span data-ttu-id="45d49-302">FD1</span><span class="sxs-lookup"><span data-stu-id="45d49-302">FD1</span></span> | <span data-ttu-id="45d49-303">FD2</span><span class="sxs-lookup"><span data-stu-id="45d49-303">FD2</span></span> | <span data-ttu-id="45d49-304">FD3</span><span class="sxs-lookup"><span data-stu-id="45d49-304">FD3</span></span> | <span data-ttu-id="45d49-305">FD4</span><span class="sxs-lookup"><span data-stu-id="45d49-305">FD4</span></span> | <span data-ttu-id="45d49-306">UDTotal</span><span class="sxs-lookup"><span data-stu-id="45d49-306">UDTotal</span></span> |
| --- |:---:|:---:|:---:|:---:|:---:|:---:|
| <span data-ttu-id="45d49-307">**UD0**</span><span class="sxs-lookup"><span data-stu-id="45d49-307">**UD0**</span></span> | | | | | |<span data-ttu-id="45d49-308">0</span><span class="sxs-lookup"><span data-stu-id="45d49-308">0</span></span> |
| <span data-ttu-id="45d49-309">**UD1**</span><span class="sxs-lookup"><span data-stu-id="45d49-309">**UD1**</span></span> |<span data-ttu-id="45d49-310">R5</span><span class="sxs-lookup"><span data-stu-id="45d49-310">R5</span></span> |<span data-ttu-id="45d49-311">R1</span><span class="sxs-lookup"><span data-stu-id="45d49-311">R1</span></span> | | | |<span data-ttu-id="45d49-312">2</span><span class="sxs-lookup"><span data-stu-id="45d49-312">2</span></span> |
| <span data-ttu-id="45d49-313">**UD2**</span><span class="sxs-lookup"><span data-stu-id="45d49-313">**UD2**</span></span> | | |<span data-ttu-id="45d49-314">R2</span><span class="sxs-lookup"><span data-stu-id="45d49-314">R2</span></span> | | |<span data-ttu-id="45d49-315">1</span><span class="sxs-lookup"><span data-stu-id="45d49-315">1</span></span> |
| <span data-ttu-id="45d49-316">**UD3**</span><span class="sxs-lookup"><span data-stu-id="45d49-316">**UD3**</span></span> | | | |<span data-ttu-id="45d49-317">R3</span><span class="sxs-lookup"><span data-stu-id="45d49-317">R3</span></span> | |<span data-ttu-id="45d49-318">1</span><span class="sxs-lookup"><span data-stu-id="45d49-318">1</span></span> |
| <span data-ttu-id="45d49-319">**UD4**</span><span class="sxs-lookup"><span data-stu-id="45d49-319">**UD4**</span></span> | | | | |<span data-ttu-id="45d49-320">R4</span><span class="sxs-lookup"><span data-stu-id="45d49-320">R4</span></span> |<span data-ttu-id="45d49-321">1</span><span class="sxs-lookup"><span data-stu-id="45d49-321">1</span></span> |
| <span data-ttu-id="45d49-322">**FDTotal**</span><span class="sxs-lookup"><span data-stu-id="45d49-322">**FDTotal**</span></span> |<span data-ttu-id="45d49-323">1</span><span class="sxs-lookup"><span data-stu-id="45d49-323">1</span></span> |<span data-ttu-id="45d49-324">1</span><span class="sxs-lookup"><span data-stu-id="45d49-324">1</span></span> |<span data-ttu-id="45d49-325">1</span><span class="sxs-lookup"><span data-stu-id="45d49-325">1</span></span> |<span data-ttu-id="45d49-326">1</span><span class="sxs-lookup"><span data-stu-id="45d49-326">1</span></span> |<span data-ttu-id="45d49-327">1</span><span class="sxs-lookup"><span data-stu-id="45d49-327">1</span></span> |- |

<span data-ttu-id="45d49-328">Deze indeling wordt verdeeld in termen van domeinen met fouten.</span><span class="sxs-lookup"><span data-stu-id="45d49-328">This layout is balanced in terms of Fault Domains.</span></span> <span data-ttu-id="45d49-329">Echter, nu deze wordt overtreden van de beperking voor het upgraden van domein.</span><span class="sxs-lookup"><span data-stu-id="45d49-329">However, now it's violating the Upgrade Domain constraint.</span></span> <span data-ttu-id="45d49-330">Dit is omdat UD0 nul replica's heeft terwijl UD1 twee heeft.</span><span class="sxs-lookup"><span data-stu-id="45d49-330">This is because UD0 has zero replicas while UD1 has two.</span></span> <span data-ttu-id="45d49-331">Daarom wordt deze lay-out ook is ongeldig en won't worden verzameld door de Cluster Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="45d49-331">Therefore, this layout is also invalid and won't be picked by the Cluster Resource Manager.</span></span> 

## <a name="configuring-fault-and-upgrade-domains"></a><span data-ttu-id="45d49-332">Configureren van de fout en domeinen upgraden</span><span class="sxs-lookup"><span data-stu-id="45d49-332">Configuring fault and Upgrade Domains</span></span>
<span data-ttu-id="45d49-333">Domeinen met fouten en -domeinen upgraden definiëren gebeurt automatisch in Azure gehoste Service Fabric-implementaties.</span><span class="sxs-lookup"><span data-stu-id="45d49-333">Defining Fault Domains and Upgrade Domains is done automatically in Azure hosted Service Fabric deployments.</span></span> <span data-ttu-id="45d49-334">Service Fabric opgehaald en worden de gegevens van de omgeving van Azure gebruikt.</span><span class="sxs-lookup"><span data-stu-id="45d49-334">Service Fabric picks up and uses the environment information from Azure.</span></span>

<span data-ttu-id="45d49-335">Als u uw eigen-cluster maakt (of wilt uitvoeren van een bepaalde topologie in ontwikkeling), kunt u de informatie over domein met fouten en het upgraden van domein zelf opgeven.</span><span class="sxs-lookup"><span data-stu-id="45d49-335">If you’re creating your own cluster (or want to run a particular topology in development), you can provide the Fault Domain and Upgrade Domain information yourself.</span></span> <span data-ttu-id="45d49-336">In dit voorbeeld definiëren we een lokaal ontwikkelcluster van negen knooppunt die drie 'datacenters' (elk met drie rekken omvat).</span><span class="sxs-lookup"><span data-stu-id="45d49-336">In this example, we define a nine node local development cluster that spans three “datacenters” (each with three racks).</span></span> <span data-ttu-id="45d49-337">Dit cluster heeft ook drie upgraden domeinen striped verdeeld over de drie datacenters.</span><span class="sxs-lookup"><span data-stu-id="45d49-337">This cluster also has three Upgrade Domains striped across those three datacenters.</span></span> <span data-ttu-id="45d49-338">Een voorbeeld van de configuratie is lager dan:</span><span class="sxs-lookup"><span data-stu-id="45d49-338">An example of the configuration is below:</span></span> 

<span data-ttu-id="45d49-339">ClusterManifest.xml</span><span class="sxs-lookup"><span data-stu-id="45d49-339">ClusterManifest.xml</span></span>

```xml
  <Infrastructure>
    <!-- IsScaleMin indicates that this cluster runs on one-box /one single server -->
    <WindowsServer IsScaleMin="true">
      <NodeList>
        <Node NodeName="Node01" IPAddressOrFQDN="localhost" NodeTypeRef="NodeType01" FaultDomain="fd:/DC01/Rack01" UpgradeDomain="UpgradeDomain1" IsSeedNode="true" />
        <Node NodeName="Node02" IPAddressOrFQDN="localhost" NodeTypeRef="NodeType02" FaultDomain="fd:/DC01/Rack02" UpgradeDomain="UpgradeDomain2" IsSeedNode="true" />
        <Node NodeName="Node03" IPAddressOrFQDN="localhost" NodeTypeRef="NodeType03" FaultDomain="fd:/DC01/Rack03" UpgradeDomain="UpgradeDomain3" IsSeedNode="true" />
        <Node NodeName="Node04" IPAddressOrFQDN="localhost" NodeTypeRef="NodeType04" FaultDomain="fd:/DC02/Rack01" UpgradeDomain="UpgradeDomain1" IsSeedNode="true" />
        <Node NodeName="Node05" IPAddressOrFQDN="localhost" NodeTypeRef="NodeType05" FaultDomain="fd:/DC02/Rack02" UpgradeDomain="UpgradeDomain2" IsSeedNode="true" />
        <Node NodeName="Node06" IPAddressOrFQDN="localhost" NodeTypeRef="NodeType06" FaultDomain="fd:/DC02/Rack03" UpgradeDomain="UpgradeDomain3" IsSeedNode="true" />
        <Node NodeName="Node07" IPAddressOrFQDN="localhost" NodeTypeRef="NodeType07" FaultDomain="fd:/DC03/Rack01" UpgradeDomain="UpgradeDomain1" IsSeedNode="true" />
        <Node NodeName="Node08" IPAddressOrFQDN="localhost" NodeTypeRef="NodeType08" FaultDomain="fd:/DC03/Rack02" UpgradeDomain="UpgradeDomain2" IsSeedNode="true" />
        <Node NodeName="Node09" IPAddressOrFQDN="localhost" NodeTypeRef="NodeType09" FaultDomain="fd:/DC03/Rack03" UpgradeDomain="UpgradeDomain3" IsSeedNode="true" />
      </NodeList>
    </WindowsServer>
  </Infrastructure>
```

<span data-ttu-id="45d49-340">via ClusterConfig.json voor zelfstandige implementaties</span><span class="sxs-lookup"><span data-stu-id="45d49-340">via ClusterConfig.json for Standalone deployments</span></span>

```json
"nodes": [
  {
    "nodeName": "vm1",
    "iPAddress": "localhost",
    "nodeTypeRef": "NodeType0",
    "faultDomain": "fd:/dc1/r0",
    "upgradeDomain": "UD1"
  },
  {
    "nodeName": "vm2",
    "iPAddress": "localhost",
    "nodeTypeRef": "NodeType0",
    "faultDomain": "fd:/dc1/r0",
    "upgradeDomain": "UD2"
  },
  {
    "nodeName": "vm3",
    "iPAddress": "localhost",
    "nodeTypeRef": "NodeType0",
    "faultDomain": "fd:/dc1/r0",
    "upgradeDomain": "UD3"
  },
  {
    "nodeName": "vm4",
    "iPAddress": "localhost",
    "nodeTypeRef": "NodeType0",
    "faultDomain": "fd:/dc2/r0",
    "upgradeDomain": "UD1"
  },
  {
    "nodeName": "vm5",
    "iPAddress": "localhost",
    "nodeTypeRef": "NodeType0",
    "faultDomain": "fd:/dc2/r0",
    "upgradeDomain": "UD2"
  },
  {
    "nodeName": "vm6",
    "iPAddress": "localhost",
    "nodeTypeRef": "NodeType0",
    "faultDomain": "fd:/dc2/r0",
    "upgradeDomain": "UD3"
  },
  {
    "nodeName": "vm7",
    "iPAddress": "localhost",
    "nodeTypeRef": "NodeType0",
    "faultDomain": "fd:/dc3/r0",
    "upgradeDomain": "UD1"
  },
  {
    "nodeName": "vm8",
    "iPAddress": "localhost",
    "nodeTypeRef": "NodeType0",
    "faultDomain": "fd:/dc3/r0",
    "upgradeDomain": "UD2"
  },
  {
    "nodeName": "vm9",
    "iPAddress": "localhost",
    "nodeTypeRef": "NodeType0",
    "faultDomain": "fd:/dc3/r0",
    "upgradeDomain": "UD3"
  }
],
```

> [!NOTE]
> <span data-ttu-id="45d49-341">Bij het definiëren van clusters via Azure Resource Manager, worden Foutdomeinen en -domeinen upgraden door Azure worden toegewezen.</span><span class="sxs-lookup"><span data-stu-id="45d49-341">When defining clusters via Azure Resource Manager, Fault Domains and Upgrade Domains are assigned by Azure.</span></span> <span data-ttu-id="45d49-342">De definitie van uw knooppunttypen en virtuele-Machineschaalsets in uw Azure Resource Manager-sjabloon bevat daarom geen Foutdomein of domeingegevens upgraden.</span><span class="sxs-lookup"><span data-stu-id="45d49-342">Therefore, the definition of your Node Types and Virtual Machine Scale Sets in your Azure Resource Manager template does not include Fault Domain or Upgrade Domain information.</span></span>
>

## <a name="node-properties-and-placement-constraints"></a><span data-ttu-id="45d49-343">Eigenschappen van het knooppunt en plaatsingsbeperkingen</span><span class="sxs-lookup"><span data-stu-id="45d49-343">Node properties and placement constraints</span></span>
<span data-ttu-id="45d49-344">Soms (in feite de meeste gevallen) gaat u ervoor wilt zorgen dat bepaalde werkbelastingen alleen op bepaalde soorten knooppunten in het cluster worden uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="45d49-344">Sometimes (in fact, most of the time) you’re going to want to ensure that certain workloads run only on certain types of nodes in the cluster.</span></span> <span data-ttu-id="45d49-345">Voor kan sommige werkbelasting bijvoorbeeld vereisen GPU's of SSD's en andere niet.</span><span class="sxs-lookup"><span data-stu-id="45d49-345">For example, some workload may require GPUs or SSDs while others may not.</span></span> <span data-ttu-id="45d49-346">Een goed voorbeeld van doelen van hardware aan bepaalde werkbelastingen is er bijna alle lagen-architectuur.</span><span class="sxs-lookup"><span data-stu-id="45d49-346">A great example of targeting hardware to particular workloads is almost every n-tier architecture out there.</span></span> <span data-ttu-id="45d49-347">Bepaalde computers fungeren als de front-end- of -API voor de kant van de toepassing en worden blootgesteld aan de clients of via internet.</span><span class="sxs-lookup"><span data-stu-id="45d49-347">Certain machines serve as the front end or API serving side of the application and are exposed to the clients or the internet.</span></span> <span data-ttu-id="45d49-348">Andere machines, vaak met verschillende hardware-bronnen, verwerkt de werkzaamheden van de lagen compute of opslag.</span><span class="sxs-lookup"><span data-stu-id="45d49-348">Different machines, often with different hardware resources, handle the work of the compute or storage layers.</span></span> <span data-ttu-id="45d49-349">Dit zijn meestal _niet_ rechtstreeks blootgesteld aan clients of via internet.</span><span class="sxs-lookup"><span data-stu-id="45d49-349">These are usually _not_ directly exposed to clients or the internet.</span></span> <span data-ttu-id="45d49-350">Service Fabric verwacht dat er gevallen waarin bepaalde werkbelastingen moeten worden uitgevoerd op specifieke hardwareconfiguraties.</span><span class="sxs-lookup"><span data-stu-id="45d49-350">Service Fabric expects that there are cases where particular workloads need to run on particular hardware configurations.</span></span> <span data-ttu-id="45d49-351">Bijvoorbeeld:</span><span class="sxs-lookup"><span data-stu-id="45d49-351">For example:</span></span>

* <span data-ttu-id="45d49-352">een bestaande n-tier-toepassing is 'opgeheven en verplaatst' in een Service Fabric-omgeving</span><span class="sxs-lookup"><span data-stu-id="45d49-352">an existing n-tier application has been “lifted and shifted” into a Service Fabric environment</span></span>
* <span data-ttu-id="45d49-353">een werklast wil uitvoeren op specifieke hardware voor prestaties of schaal veiligheidsredenen isolatie</span><span class="sxs-lookup"><span data-stu-id="45d49-353">a workload wants to run on specific hardware for performance, scale, or security isolation reasons</span></span>
* <span data-ttu-id="45d49-354">Een werklast worden geïsoleerd van andere werkbelastingen omwille van beleid of de resource-verbruik</span><span class="sxs-lookup"><span data-stu-id="45d49-354">A workload should be isolated from other workloads for policy or resource consumption reasons</span></span>

<span data-ttu-id="45d49-355">Service Fabric heeft ter ondersteuning van dit soort configuraties, een eerste-klas begrip van de labels die kunnen worden toegepast op de knooppunten.</span><span class="sxs-lookup"><span data-stu-id="45d49-355">To support these sorts of configurations, Service Fabric has a first class notion of tags that can be applied to nodes.</span></span> <span data-ttu-id="45d49-356">Deze tags worden genoemd **knooppunteigenschappen**.</span><span class="sxs-lookup"><span data-stu-id="45d49-356">These tags are called **node properties**.</span></span> <span data-ttu-id="45d49-357">**Plaatsingsbeperkingen** worden de instructies die zijn gekoppeld aan afzonderlijke services die voor een of meer eigenschappen van het knooppunt selecteren.</span><span class="sxs-lookup"><span data-stu-id="45d49-357">**Placement constraints** are the statements attached to individual services that select for one or more node properties.</span></span> <span data-ttu-id="45d49-358">Plaatsingsbeperkingen definiëren waar services moeten worden uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="45d49-358">Placement constraints define where services should run.</span></span> <span data-ttu-id="45d49-359">De set van beperkingen is extensible - een sleutel-waardepaar kunt werken.</span><span class="sxs-lookup"><span data-stu-id="45d49-359">The set of constraints is extensible - any key/value pair can work.</span></span> 

<span data-ttu-id="45d49-360"><center>
![Cluster-indeling verschillende werkbelastingen][Image5]
</center></span><span class="sxs-lookup"><span data-stu-id="45d49-360"><center>
![Cluster Layout Different Workloads][Image5]
</center></span></span>

### <a name="built-in-node-properties"></a><span data-ttu-id="45d49-361">Ingebouwd in de eigenschappen van knooppunt</span><span class="sxs-lookup"><span data-stu-id="45d49-361">Built in node properties</span></span>
<span data-ttu-id="45d49-362">Service Fabric definieert een aantal standaardeigenschappen knooppunt die automatisch kunnen worden gebruikt zonder dat de gebruiker om deze te bepalen.</span><span class="sxs-lookup"><span data-stu-id="45d49-362">Service Fabric defines some default node properties that can be used automatically without the user having to define them.</span></span> <span data-ttu-id="45d49-363">De standaard-eigenschappen gedefinieerd op elk knooppunt zijn de **NodeType** en de **NodeName**.</span><span class="sxs-lookup"><span data-stu-id="45d49-363">The default properties defined at each node are the **NodeType** and the **NodeName**.</span></span> <span data-ttu-id="45d49-364">U kunt dus bijvoorbeeld een beperking voor plaatsing als schrijven `"(NodeType == NodeType03)"`.</span><span class="sxs-lookup"><span data-stu-id="45d49-364">So for example you could write a placement constraint as `"(NodeType == NodeType03)"`.</span></span> <span data-ttu-id="45d49-365">We hebben doorgaans gevonden NodeType moet een van de meest vaak gebruikte eigenschappen.</span><span class="sxs-lookup"><span data-stu-id="45d49-365">Generally we have found NodeType to be one of the most commonly used properties.</span></span> <span data-ttu-id="45d49-366">Het is nuttig omdat deze 1:1 met een type van een machine overeenkomt.</span><span class="sxs-lookup"><span data-stu-id="45d49-366">It is useful since it corresponds 1:1 with a type of a machine.</span></span> <span data-ttu-id="45d49-367">Elk type van de machine overeenkomt met een type werkbelasting in een traditionele n-tier-toepassing.</span><span class="sxs-lookup"><span data-stu-id="45d49-367">Each type of machine corresponds to a type of workload in a traditional n-tier application.</span></span>

<span data-ttu-id="45d49-368"><center>
![Plaatsingsbeperkingen en eigenschappen van knooppunt][Image6]
</center></span><span class="sxs-lookup"><span data-stu-id="45d49-368"><center>
![Placement Constraints and Node Properties][Image6]
</center></span></span>

## <a name="placement-constraint-and-node-property-syntax"></a><span data-ttu-id="45d49-369">Plaatsing van de beperkingen en de syntaxis van de eigenschap knooppunt</span><span class="sxs-lookup"><span data-stu-id="45d49-369">Placement Constraint and Node Property Syntax</span></span> 
<span data-ttu-id="45d49-370">De opgegeven waarde in de eigenschap van het knooppunt kan string, bool, of lang ondertekend.</span><span class="sxs-lookup"><span data-stu-id="45d49-370">The value specified in the node property can be a string, bool, or signed long.</span></span> <span data-ttu-id="45d49-371">De instructie op de service een plaatsing wordt aangeroepen *beperking* omdat beperkt waar de service kan worden uitgevoerd in het cluster.</span><span class="sxs-lookup"><span data-stu-id="45d49-371">The statement at the service is called a placement *constraint* since it constrains where the service can run in the cluster.</span></span> <span data-ttu-id="45d49-372">De beperking kan een Boolean-instructie die is van invloed op de eigenschappen van het andere knooppunt in het cluster zijn.</span><span class="sxs-lookup"><span data-stu-id="45d49-372">The constraint can be any Boolean statement that operates on the different node properties in the cluster.</span></span> <span data-ttu-id="45d49-373">De geldige selectoren in deze instructies Boolean-waarde zijn:</span><span class="sxs-lookup"><span data-stu-id="45d49-373">The valid selectors in these boolean statements are:</span></span>

1) <span data-ttu-id="45d49-374">voorwaardelijke controles voor het maken van bepaalde instructies</span><span class="sxs-lookup"><span data-stu-id="45d49-374">conditional checks for creating particular statements</span></span>

| <span data-ttu-id="45d49-375">Instructie</span><span class="sxs-lookup"><span data-stu-id="45d49-375">Statement</span></span> | <span data-ttu-id="45d49-376">Syntaxis</span><span class="sxs-lookup"><span data-stu-id="45d49-376">Syntax</span></span> |
| --- |:---:|
| <span data-ttu-id="45d49-377">'gelijk zijn aan'</span><span class="sxs-lookup"><span data-stu-id="45d49-377">"equal to"</span></span> | <span data-ttu-id="45d49-378">"=="</span><span class="sxs-lookup"><span data-stu-id="45d49-378">"=="</span></span> |
| <span data-ttu-id="45d49-379">'is niet gelijk aan'</span><span class="sxs-lookup"><span data-stu-id="45d49-379">"not equal to"</span></span> | <span data-ttu-id="45d49-380">"!="</span><span class="sxs-lookup"><span data-stu-id="45d49-380">"!="</span></span> |
| <span data-ttu-id="45d49-381">'die groter is dan'</span><span class="sxs-lookup"><span data-stu-id="45d49-381">"greater than"</span></span> | <span data-ttu-id="45d49-382">">"</span><span class="sxs-lookup"><span data-stu-id="45d49-382">">"</span></span> |
| <span data-ttu-id="45d49-383">'groter dan of gelijk zijn aan'</span><span class="sxs-lookup"><span data-stu-id="45d49-383">"greater than or equal to"</span></span> | <span data-ttu-id="45d49-384">">="</span><span class="sxs-lookup"><span data-stu-id="45d49-384">">="</span></span> |
| <span data-ttu-id="45d49-385">'kleiner dan'</span><span class="sxs-lookup"><span data-stu-id="45d49-385">"less than"</span></span> | <span data-ttu-id="45d49-386">"<"</span><span class="sxs-lookup"><span data-stu-id="45d49-386">"<"</span></span> |
| <span data-ttu-id="45d49-387">'kleiner dan of gelijk aan'</span><span class="sxs-lookup"><span data-stu-id="45d49-387">"less than or equal to"</span></span> | <span data-ttu-id="45d49-388">"<="</span><span class="sxs-lookup"><span data-stu-id="45d49-388">"<="</span></span> |

2) <span data-ttu-id="45d49-389">Boole-instructies voor groepering en logische bewerkingen</span><span class="sxs-lookup"><span data-stu-id="45d49-389">boolean statements for grouping and logical operations</span></span>

| <span data-ttu-id="45d49-390">Instructie</span><span class="sxs-lookup"><span data-stu-id="45d49-390">Statement</span></span> | <span data-ttu-id="45d49-391">Syntaxis</span><span class="sxs-lookup"><span data-stu-id="45d49-391">Syntax</span></span> |
| --- |:---:|
| <span data-ttu-id="45d49-392">'en'</span><span class="sxs-lookup"><span data-stu-id="45d49-392">"and"</span></span> | <span data-ttu-id="45d49-393">"&&"</span><span class="sxs-lookup"><span data-stu-id="45d49-393">"&&"</span></span> |
| <span data-ttu-id="45d49-394">"of"</span><span class="sxs-lookup"><span data-stu-id="45d49-394">"or"</span></span> | <span data-ttu-id="45d49-395">"&#124;&#124;"</span><span class="sxs-lookup"><span data-stu-id="45d49-395">"&#124;&#124;"</span></span> |
| <span data-ttu-id="45d49-396">"niet"</span><span class="sxs-lookup"><span data-stu-id="45d49-396">"not"</span></span> | <span data-ttu-id="45d49-397">"!"</span><span class="sxs-lookup"><span data-stu-id="45d49-397">"!"</span></span> |
| <span data-ttu-id="45d49-398">'als één instructie een groep'</span><span class="sxs-lookup"><span data-stu-id="45d49-398">"group as single statement"</span></span> | <span data-ttu-id="45d49-399">"()"</span><span class="sxs-lookup"><span data-stu-id="45d49-399">"()"</span></span> |

<span data-ttu-id="45d49-400">Hier volgen enkele voorbeelden van basisbeperking instructies.</span><span class="sxs-lookup"><span data-stu-id="45d49-400">Here are some examples of basic constraint statements.</span></span>

  * `"Value >= 5"`
  * `"NodeColor != green"`
  * `"((OneProperty < 100) || ((AnotherProperty == false) && (OneProperty >= 100)))"`

<span data-ttu-id="45d49-401">Alleen knooppunten waar de algehele plaatsing beperking-instructie wordt geëvalueerd als 'True' kunnen de service op deze geplaatst hebben.</span><span class="sxs-lookup"><span data-stu-id="45d49-401">Only nodes where the overall placement constraint statement evaluates to “True” can have the service placed on it.</span></span> <span data-ttu-id="45d49-402">Knooppunten waarvoor geen een eigenschap worden gedefinieerd, komen niet overeen met de plaatsing beperkingen met die eigenschap.</span><span class="sxs-lookup"><span data-stu-id="45d49-402">Nodes that do not have a property defined do not match any placement constraint containing that property.</span></span>

<span data-ttu-id="45d49-403">Stel dat de volgende eigenschappen van het knooppunt zijn gedefinieerd voor een bepaald knooppunt-type:</span><span class="sxs-lookup"><span data-stu-id="45d49-403">Let’s say that the following node properties were defined for a given node type:</span></span>

<span data-ttu-id="45d49-404">ClusterManifest.xml</span><span class="sxs-lookup"><span data-stu-id="45d49-404">ClusterManifest.xml</span></span>

```xml
    <NodeType Name="NodeType01">
      <PlacementProperties>
        <Property Name="HasSSD" Value="true"/>
        <Property Name="NodeColor" Value="green"/>
        <Property Name="SomeProperty" Value="5"/>
      </PlacementProperties>
    </NodeType>
```

<span data-ttu-id="45d49-405">gehoste clusters via ClusterConfig.json voor zelfstandige implementaties of Template.json voor Azure.</span><span class="sxs-lookup"><span data-stu-id="45d49-405">via ClusterConfig.json for Standalone deployments or Template.json for Azure hosted clusters.</span></span> 

> [!NOTE]
> <span data-ttu-id="45d49-406">Het knooppunttype in uw Azure Resource Manager-sjabloon meestal parameters wordt gebruikt.</span><span class="sxs-lookup"><span data-stu-id="45d49-406">In your Azure Resource Manager template the node type is usually parameterized.</span></span> <span data-ttu-id="45d49-407">Deze eruit als '[parameters('vmNodeType1Name')]' in plaats van 'NodeType01'.</span><span class="sxs-lookup"><span data-stu-id="45d49-407">It would look like "[parameters('vmNodeType1Name')]" rather than "NodeType01".</span></span>
>

```json
"nodeTypes": [
    {
        "name": "NodeType01",
        "placementProperties": {
            "HasSSD": "true",
            "NodeColor": "green",
            "SomeProperty": "5"
        },
    }
],
```

<span data-ttu-id="45d49-408">U kunt de plaatsing van de service maken *beperkingen* voor een service, zoals als volgt:</span><span class="sxs-lookup"><span data-stu-id="45d49-408">You can create service placement *constraints* for a service like as follows:</span></span>

<span data-ttu-id="45d49-409">C#</span><span class="sxs-lookup"><span data-stu-id="45d49-409">C#</span></span>

```csharp
FabricClient fabricClient = new FabricClient();
StatefulServiceDescription serviceDescription = new StatefulServiceDescription();
serviceDescription.PlacementConstraints = "(HasSSD == true && SomeProperty >= 4)";
// add other required servicedescription fields
//...
await fabricClient.ServiceManager.CreateServiceAsync(serviceDescription);
```

<span data-ttu-id="45d49-410">PowerShell:</span><span class="sxs-lookup"><span data-stu-id="45d49-410">Powershell:</span></span>

```posh
New-ServiceFabricService -ApplicationName $applicationName -ServiceName $serviceName -ServiceTypeName $serviceType -Stateful -MinReplicaSetSize 3 -TargetReplicaSetSize 3 -PartitionSchemeSingleton -PlacementConstraint "HasSSD == true && SomeProperty >= 4"
```

<span data-ttu-id="45d49-411">Als alle knooppunten van NodeType01 geldig zijn, kunt u ook dat knooppunttype met de beperking selecteren "(NodeType == NodeType01) '.</span><span class="sxs-lookup"><span data-stu-id="45d49-411">If all nodes of NodeType01 are valid, you can also select that node type with the constraint "(NodeType == NodeType01)".</span></span>

<span data-ttu-id="45d49-412">Een van de cool dingen over een service plaatsingsbeperkingen is dat ze kunnen dynamisch worden bijgewerkt tijdens runtime.</span><span class="sxs-lookup"><span data-stu-id="45d49-412">One of the cool things about a service’s placement constraints is that they can be updated dynamically during runtime.</span></span> <span data-ttu-id="45d49-413">Dus als u wilt, kunt u een service in het cluster verplaatsen, toevoegen en verwijderen vereisten, enzovoort. Service Fabric zorgt om ervoor te zorgen dat de service up-to-date en beschikbaar blijven zelfs wanneer deze typen wijzigingen worden aangebracht.</span><span class="sxs-lookup"><span data-stu-id="45d49-413">So if you need to, you can move a service around in the cluster, add and remove requirements, etc. Service Fabric takes care of ensuring that the service stays up and available even when these types of changes are made.</span></span>

<span data-ttu-id="45d49-414">C#:</span><span class="sxs-lookup"><span data-stu-id="45d49-414">C#:</span></span>

```csharp
StatefulServiceUpdateDescription updateDescription = new StatefulServiceUpdateDescription();
updateDescription.PlacementConstraints = "NodeType == NodeType01";
await fabricClient.ServiceManager.UpdateServiceAsync(new Uri("fabric:/app/service"), updateDescription);
```

<span data-ttu-id="45d49-415">PowerShell:</span><span class="sxs-lookup"><span data-stu-id="45d49-415">Powershell:</span></span>

```posh
Update-ServiceFabricService -Stateful -ServiceName $serviceName -PlacementConstraints "NodeType == NodeType01"
```

<span data-ttu-id="45d49-416">Plaatsingsbeperkingen zijn opgegeven voor elke andere benoemde service-exemplaar.</span><span class="sxs-lookup"><span data-stu-id="45d49-416">Placement constraints are specified for every different named service instance.</span></span> <span data-ttu-id="45d49-417">Altijd ter vervanging van updates (overschrijven) wat eerder is opgegeven.</span><span class="sxs-lookup"><span data-stu-id="45d49-417">Updates always take the place of (overwrite) what was previously specified.</span></span>

<span data-ttu-id="45d49-418">De definitie van de cluster definieert de eigenschappen op een knooppunt.</span><span class="sxs-lookup"><span data-stu-id="45d49-418">The cluster definition defines the properties on a node.</span></span> <span data-ttu-id="45d49-419">Kan de eigenschappen van een knooppunt is de upgrade van een cluster configuratie vereist.</span><span class="sxs-lookup"><span data-stu-id="45d49-419">Changing a node's properties requires a cluster configuration upgrade.</span></span> <span data-ttu-id="45d49-420">Eigenschappen van een knooppunt upgraden vereist elk betrokken knooppunt opnieuw op te starten om de eigenschappen van nieuwe melden.</span><span class="sxs-lookup"><span data-stu-id="45d49-420">Upgrading a node's properties requires each affected node to restart to report its new properties.</span></span> <span data-ttu-id="45d49-421">Deze rolling upgrades worden beheerd door Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="45d49-421">These rolling upgrades are managed by Service Fabric.</span></span>

## <a name="describing-and-managing-cluster-resources"></a><span data-ttu-id="45d49-422">Beschrijven en de clusterbronnen beheren</span><span class="sxs-lookup"><span data-stu-id="45d49-422">Describing and Managing Cluster Resources</span></span>
<span data-ttu-id="45d49-423">Een van de belangrijkste taken van een orchestrator is voor het beheer van brongebruik in het cluster.</span><span class="sxs-lookup"><span data-stu-id="45d49-423">One of the most important jobs of any orchestrator is to help manage resource consumption in the cluster.</span></span> <span data-ttu-id="45d49-424">Het beheren van clusterbronnen kan leiden tot een aantal verschillende dingen.</span><span class="sxs-lookup"><span data-stu-id="45d49-424">Managing cluster resources can mean a couple of different things.</span></span> <span data-ttu-id="45d49-425">Eerst, er ervoor zorgen dat machines zijn niet overbelast.</span><span class="sxs-lookup"><span data-stu-id="45d49-425">First, there's ensuring that machines are not overloaded.</span></span> <span data-ttu-id="45d49-426">Dit betekent om ervoor te zorgen dat machines meer services die deze kunnen verwerken worden niet uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="45d49-426">This means making sure that machines aren't running more services than they can handle.</span></span> <span data-ttu-id="45d49-427">Er is ten tweede taakverdeling en optimalisatie wat van essentieel belang voor het uitvoeren van services efficiënt.</span><span class="sxs-lookup"><span data-stu-id="45d49-427">Second, there's balancing and optimization which is critical to running services efficiently.</span></span> <span data-ttu-id="45d49-428">Sommige knooppunten moet hot, terwijl andere koude mag geen kosten effectieve of prestaties gevoelige-serviceaanbod.</span><span class="sxs-lookup"><span data-stu-id="45d49-428">Cost effective or performance sensitive service offerings can't allow some nodes to be hot while others are cold.</span></span> <span data-ttu-id="45d49-429">Hot knooppunten leiden tot slechte prestaties en bronconflicten en koude knooppunten vertegenwoordigen verspilde resources en hogere kosten.</span><span class="sxs-lookup"><span data-stu-id="45d49-429">Hot nodes lead to resource contention and poor performance, and cold nodes represent wasted resources and increased costs.</span></span> 

<span data-ttu-id="45d49-430">Service Fabric vertegenwoordigt resources als `Metrics`.</span><span class="sxs-lookup"><span data-stu-id="45d49-430">Service Fabric represents resources as `Metrics`.</span></span> <span data-ttu-id="45d49-431">Metrische gegevens zijn logische of fysieke resource die u wilt beschrijven naar Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="45d49-431">Metrics are any logical or physical resource that you want to describe to Service Fabric.</span></span> <span data-ttu-id="45d49-432">Voorbeelden van metrische gegevens zijn bijvoorbeeld 'WorkQueueDepth' of 'MemoryInMb'.</span><span class="sxs-lookup"><span data-stu-id="45d49-432">Examples of metrics are things like “WorkQueueDepth” or “MemoryInMb”.</span></span> <span data-ttu-id="45d49-433">Zie voor meer informatie over de fysieke resources die Service Fabric kunnen van toepassing op knooppunten [resource governance](service-fabric-resource-governance.md).</span><span class="sxs-lookup"><span data-stu-id="45d49-433">For information about the physical resources that Service Fabric can govern on nodes, see [resource governance](service-fabric-resource-governance.md).</span></span> <span data-ttu-id="45d49-434">Zie voor meer informatie over het configureren van aangepaste metrische gegevens en het gebruik [in dit artikel](service-fabric-cluster-resource-manager-metrics.md)</span><span class="sxs-lookup"><span data-stu-id="45d49-434">For information on configuring custom metrics and their uses, see [this article](service-fabric-cluster-resource-manager-metrics.md)</span></span>

<span data-ttu-id="45d49-435">Metrische gegevens zijn anders dan plaatsingen beperkingen en eigenschappen van het knooppunt.</span><span class="sxs-lookup"><span data-stu-id="45d49-435">Metrics are different from placements constraints and node properties.</span></span> <span data-ttu-id="45d49-436">Eigenschappen van het knooppunt zijn statisch descriptors van de knooppunten zelf.</span><span class="sxs-lookup"><span data-stu-id="45d49-436">Node properties are static descriptors of the nodes themselves.</span></span> <span data-ttu-id="45d49-437">Metrische gegevens worden de resources die knooppunten hebben en dat services gebruiken wanneer ze worden uitgevoerd op een knooppunt beschreven.</span><span class="sxs-lookup"><span data-stu-id="45d49-437">Metrics describe resources that nodes have and that services consume when they are run on a node.</span></span> <span data-ttu-id="45d49-438">De eigenschap van een knooppunt kan 'HasSSD' en kan worden ingesteld op waar of ONWAAR.</span><span class="sxs-lookup"><span data-stu-id="45d49-438">A node property could be "HasSSD" and could be set to true or false.</span></span> <span data-ttu-id="45d49-439">De hoeveelheid beschikbare ruimte op die SSD en hoeveel is verbruikt door services zou een metriek zoals 'DriveSpaceInMb' zijn.</span><span class="sxs-lookup"><span data-stu-id="45d49-439">The amount of space available on that SSD and how much is consumed by services would be a metric like “DriveSpaceInMb”.</span></span> 

<span data-ttu-id="45d49-440">Het is belangrijk te weten dat net als voor plaatsingsbeperkingen en eigenschappen van het knooppunt de resourcebeheer voor Service Fabric-Cluster niet begrijpt wat de namen van de metrische gegevens aan de hand.</span><span class="sxs-lookup"><span data-stu-id="45d49-440">It is important to note that just like for placement constraints and node properties, the Service Fabric Cluster Resource Manager doesn't understand what the names of the metrics mean.</span></span> <span data-ttu-id="45d49-441">De namen van de metrische gegevens zijn alleen tekenreeksen.</span><span class="sxs-lookup"><span data-stu-id="45d49-441">Metric names are just strings.</span></span> <span data-ttu-id="45d49-442">Het is raadzaam eenheden als onderdeel van de metrische namen die u maakt wanneer deze is mogelijk niet-eenduidige declareren.</span><span class="sxs-lookup"><span data-stu-id="45d49-442">It is a good practice to declare units as a part of the metric names that you create when it could be ambiguous.</span></span>

## <a name="capacity"></a><span data-ttu-id="45d49-443">Capaciteit</span><span class="sxs-lookup"><span data-stu-id="45d49-443">Capacity</span></span>
<span data-ttu-id="45d49-444">Als u alle resource uitgeschakeld *balancing*, Service-Fabric-Cluster Resource Manager zou nog ervoor te zorgen dat geen knooppunt uiteindelijk via de capaciteit.</span><span class="sxs-lookup"><span data-stu-id="45d49-444">If you turned off all resource *balancing*, Service Fabric’s Cluster Resource Manager would still ensure that no node ended up over its capacity.</span></span> <span data-ttu-id="45d49-445">Capaciteit overschrijdingen beheren is mogelijk, tenzij het cluster vol is of de werkbelasting groter dan een willekeurig knooppunt is.</span><span class="sxs-lookup"><span data-stu-id="45d49-445">Managing capacity overruns is possible unless the cluster is too full or the workload is larger than any node.</span></span> <span data-ttu-id="45d49-446">Capaciteit is een andere *beperking* dat de Cluster Resource Manager gebruikt om te weten welk deel van een bron op een knooppunt heeft.</span><span class="sxs-lookup"><span data-stu-id="45d49-446">Capacity is another *constraint* that the Cluster Resource Manager uses to understand how much of a resource a node has.</span></span> <span data-ttu-id="45d49-447">Resterende capaciteit wordt ook bijgehouden voor het cluster als geheel.</span><span class="sxs-lookup"><span data-stu-id="45d49-447">Remaining capacity is also tracked for the cluster as a whole.</span></span> <span data-ttu-id="45d49-448">Zowel de capaciteit en het verbruik op het serviceniveau worden uitgedrukt in termen van metrische gegevens.</span><span class="sxs-lookup"><span data-stu-id="45d49-448">Both the capacity and the consumption at the service level are expressed in terms of metrics.</span></span> <span data-ttu-id="45d49-449">Dus bijvoorbeeld, de metriek mogelijk 'ClientConnections' en een bepaald knooppunt heeft misschien een capaciteit voor 'ClientConnections' van 32768.</span><span class="sxs-lookup"><span data-stu-id="45d49-449">So for example, the metric might be "ClientConnections" and a given Node may have a capacity for "ClientConnections" of 32768.</span></span> <span data-ttu-id="45d49-450">Andere knooppunten kunnen andere limieten deel van de service uitgevoerd op knooppunt kunnen zeggen het momenteel verbruikt 32256 van de metrische gegevens 'ClientConnections' hebben.</span><span class="sxs-lookup"><span data-stu-id="45d49-450">Other nodes can have other limits Some service running on that node can say it is currently consuming 32256 of the metric "ClientConnections".</span></span>

<span data-ttu-id="45d49-451">Tijdens runtime houdt de Cluster Resource Manager resterende capaciteit in het cluster en op knooppunten.</span><span class="sxs-lookup"><span data-stu-id="45d49-451">During runtime, the Cluster Resource Manager tracks remaining capacity in the cluster and on nodes.</span></span> <span data-ttu-id="45d49-452">De Cluster Resource Manager aftrekken te houden van de capaciteit van elke service informatie over het gebruik van de capaciteit van het knooppunt waar de service wordt uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="45d49-452">In order to track capacity the Cluster Resource Manager subtracts each service's usage from node's capacity where the service runs.</span></span> <span data-ttu-id="45d49-453">Met deze gegevens worden de Service Fabric Cluster Resource Manager kunt achterhalen waar te plaatsen of verplaatsen van replica's zodat de knooppunten niet Bespreek de capaciteit.</span><span class="sxs-lookup"><span data-stu-id="45d49-453">With this information, the Service Fabric Cluster Resource Manager can figure out where to place or move replicas so that nodes don’t go over capacity.</span></span>

<span data-ttu-id="45d49-454"><center>
![Clusterknooppunten en capaciteit][Image7]
</center></span><span class="sxs-lookup"><span data-stu-id="45d49-454"><center>
![Cluster nodes and capacity][Image7]
</center></span></span>

<span data-ttu-id="45d49-455">C#:</span><span class="sxs-lookup"><span data-stu-id="45d49-455">C#:</span></span>

```csharp
StatefulServiceDescription serviceDescription = new StatefulServiceDescription();
ServiceLoadMetricDescription metric = new ServiceLoadMetricDescription();
metric.Name = "ClientConnections";
metric.PrimaryDefaultLoad = 1024;
metric.SecondaryDefaultLoad = 0;
metric.Weight = ServiceLoadMetricWeight.High;
serviceDescription.Metrics.Add(metric);
await fabricClient.ServiceManager.CreateServiceAsync(serviceDescription);
```

<span data-ttu-id="45d49-456">PowerShell:</span><span class="sxs-lookup"><span data-stu-id="45d49-456">Powershell:</span></span>

```posh
New-ServiceFabricService -ApplicationName $applicationName -ServiceName $serviceName -ServiceTypeName $serviceTypeName –Stateful -MinReplicaSetSize 3 -TargetReplicaSetSize 3 -PartitionSchemeSingleton –Metric @("ClientConnections,High,1024,0)
```

<span data-ttu-id="45d49-457">Hier ziet u capaciteit die zijn gedefinieerd in het clustermanifest:</span><span class="sxs-lookup"><span data-stu-id="45d49-457">You can see capacities defined in the cluster manifest:</span></span>

<span data-ttu-id="45d49-458">ClusterManifest.xml</span><span class="sxs-lookup"><span data-stu-id="45d49-458">ClusterManifest.xml</span></span>

```xml
    <NodeType Name="NodeType03">
      <Capacities>
        <Capacity Name="ClientConnections" Value="65536"/>
      </Capacities>
    </NodeType>
```

<span data-ttu-id="45d49-459">gehoste clusters via ClusterConfig.json voor zelfstandige implementaties of Template.json voor Azure.</span><span class="sxs-lookup"><span data-stu-id="45d49-459">via ClusterConfig.json for Standalone deployments or Template.json for Azure hosted clusters.</span></span> 

```json
"nodeTypes": [
    {
        "name": "NodeType03",
        "capacities": {
            "ClientConnections": "65536",
        }
    }
],
```

<span data-ttu-id="45d49-460">Meestal laden een service wijzigingen dynamisch.</span><span class="sxs-lookup"><span data-stu-id="45d49-460">Commonly a service’s load changes dynamically.</span></span> <span data-ttu-id="45d49-461">Stel dat load van 'ClientConnections' een replica gewijzigd van 1024 in 2048, maar het knooppunt dat deze werd uitgevoerd op vervolgens alleen 512 resterende voor deze metriek capaciteit heeft.</span><span class="sxs-lookup"><span data-stu-id="45d49-461">Say that a replica's load of "ClientConnections" changed from 1024 to 2048, but the node it was running on then only had 512 capacity remaining for that metric.</span></span> <span data-ttu-id="45d49-462">Nu die replica of de plaatsing van het exemplaar is ongeldig, omdat er niet genoeg ruimte op het knooppunt.</span><span class="sxs-lookup"><span data-stu-id="45d49-462">Now that replica or instance's placement is invalid, since there's not enough room on that node.</span></span> <span data-ttu-id="45d49-463">De Cluster Resource Manager heeft te starten het knooppunt terug hieronder capaciteit ophalen.</span><span class="sxs-lookup"><span data-stu-id="45d49-463">The Cluster Resource Manager has to kick in and get the node back below capacity.</span></span> <span data-ttu-id="45d49-464">Belasting op het knooppunt dat door een of meer van de replica's of exemplaren van dat knooppunt verplaatst naar andere knooppunten via capaciteit vermindert.</span><span class="sxs-lookup"><span data-stu-id="45d49-464">It reduces load on the node that is over capacity by moving one or more of the replicas or instances from that node to other nodes.</span></span> <span data-ttu-id="45d49-465">Bij het verplaatsen van replica's, wordt de Cluster Resource Manager probeert te minimaliseren, de kosten van deze verplaatsingen van het type.</span><span class="sxs-lookup"><span data-stu-id="45d49-465">When moving replicas, the Cluster Resource Manager tries to minimize the cost of those movements.</span></span> <span data-ttu-id="45d49-466">Verplaatsingkosten wordt besproken in [in dit artikel](service-fabric-cluster-resource-manager-movement-cost.md) en de informatie over het Cluster Resource Manager strategieën herverdeling en regels beschreven [hier](service-fabric-cluster-resource-manager-metrics.md).</span><span class="sxs-lookup"><span data-stu-id="45d49-466">Movement cost is discussed in [this article](service-fabric-cluster-resource-manager-movement-cost.md) and more about the Cluster Resource Manager's rebalancing strategies and rules is described [here](service-fabric-cluster-resource-manager-metrics.md).</span></span>

## <a name="cluster-capacity"></a><span data-ttu-id="45d49-467">Cluster-capaciteit</span><span class="sxs-lookup"><span data-stu-id="45d49-467">Cluster capacity</span></span>
<span data-ttu-id="45d49-468">Hoe de Service Fabric Cluster Resource Manager het hele cluster vol wordt behouden?</span><span class="sxs-lookup"><span data-stu-id="45d49-468">So how does the Service Fabric Cluster Resource Manager keep the overall cluster from being too full?</span></span> <span data-ttu-id="45d49-469">Ook met de dynamische belasting bij er veel niet is kunt het doen.</span><span class="sxs-lookup"><span data-stu-id="45d49-469">Well, with dynamic load there’s not a lot it can do.</span></span> <span data-ttu-id="45d49-470">Services kunnen hun piek load onafhankelijk van de acties die worden uitgevoerd door de Cluster Resource Manager hebben.</span><span class="sxs-lookup"><span data-stu-id="45d49-470">Services can have their load spike independently of actions taken by the Cluster Resource Manager.</span></span> <span data-ttu-id="45d49-471">Uw cluster met genoeg ruimte vandaag is mogelijk als gevolg hiervan underpowered als u morgen opnieuw stelen.</span><span class="sxs-lookup"><span data-stu-id="45d49-471">As a result, your cluster with plenty of headroom today may be underpowered when you become famous tomorrow.</span></span> <span data-ttu-id="45d49-472">Die reactie van: Er zijn een aantal besturingselementen die standaard zijn uitbreidbaar in om problemen te voorkomen.</span><span class="sxs-lookup"><span data-stu-id="45d49-472">That said, there are some controls that are baked in to prevent problems.</span></span> <span data-ttu-id="45d49-473">Het eerste wat dat wij kunnen nu is het maken van nieuwe werkbelastingen die het cluster vol raakt, zou voorkomen.</span><span class="sxs-lookup"><span data-stu-id="45d49-473">The first thing we can do is prevent the creation of new workloads that would cause the cluster to become full.</span></span>

<span data-ttu-id="45d49-474">Stel dat u een stateless service maakt en of hieraan sommige load gekoppeld.</span><span class="sxs-lookup"><span data-stu-id="45d49-474">Say that you create a stateless service and it has some load associated with it.</span></span> <span data-ttu-id="45d49-475">Stel dat de service de metriek 'DiskSpaceInMb' hecht.</span><span class="sxs-lookup"><span data-stu-id="45d49-475">Let’s say that the service cares about the "DiskSpaceInMb" metric.</span></span> <span data-ttu-id="45d49-476">Stel nu dat deze wil verbruiken vijf eenheden van 'DiskSpaceInMb' voor elk exemplaar van de service.</span><span class="sxs-lookup"><span data-stu-id="45d49-476">Let's also say that it is going to consume five units of "DiskSpaceInMb" for every instance of the service.</span></span> <span data-ttu-id="45d49-477">U wilt maken van drie exemplaren van de service.</span><span class="sxs-lookup"><span data-stu-id="45d49-477">You want to create three instances of the service.</span></span> <span data-ttu-id="45d49-478">Goed gedaan.</span><span class="sxs-lookup"><span data-stu-id="45d49-478">Great!</span></span> <span data-ttu-id="45d49-479">Dat betekent dat 15 eenheden van 'DiskSpaceInMb' moet aanwezig zijn in het cluster zodat we zelfs moet worden dus kunnen maken van deze service-exemplaren.</span><span class="sxs-lookup"><span data-stu-id="45d49-479">So that means that we need 15 units of "DiskSpaceInMb" to be present in the cluster in order for us to even be able to create these service instances.</span></span> <span data-ttu-id="45d49-480">De Cluster Resource Manager berekent voortdurend de capaciteit en het verbruik van elke metriek zodat deze de resterende capaciteit in het cluster kan bepalen.</span><span class="sxs-lookup"><span data-stu-id="45d49-480">The Cluster Resource Manager continually calculates the capacity and consumption of each metric so it can determine the remaining capacity in the cluster.</span></span> <span data-ttu-id="45d49-481">Als er niet voldoende ruimte, verwerpt de Cluster Resource Manager de aanroep van de service maken.</span><span class="sxs-lookup"><span data-stu-id="45d49-481">If there isn't enough space, the Cluster Resource Manager rejects the create service call.</span></span>

<span data-ttu-id="45d49-482">Omdat de vereiste maar wel dat er 15 eenheden beschikbaar zijn, kan deze ruimte veel verschillende manieren worden toegewezen.</span><span class="sxs-lookup"><span data-stu-id="45d49-482">Since the requirement is only that there be 15 units available, this space could be allocated many different ways.</span></span> <span data-ttu-id="45d49-483">Bijvoorbeeld, kan er één resterende eenheid van de capaciteit op 15 verschillende knooppunten of drie resterende eenheden van de capaciteit van vijf verschillende knooppunten.</span><span class="sxs-lookup"><span data-stu-id="45d49-483">For example, there could be one remaining unit of capacity on 15 different nodes, or three remaining units of capacity on five different nodes.</span></span> <span data-ttu-id="45d49-484">Als de Cluster Resource Manager dingen rangschikken kunt zodat er vijf eenheden beschikbaar is op drie knooppunten, wordt de service.</span><span class="sxs-lookup"><span data-stu-id="45d49-484">If the Cluster Resource Manager can rearrange things so there's five units available on three nodes, it places the service.</span></span> <span data-ttu-id="45d49-485">Het cluster opnieuw rangschikken is meestal mogelijk, tenzij het cluster bijna vol is of de bestaande services kunnen niet worden gecombineerd om een bepaalde reden.</span><span class="sxs-lookup"><span data-stu-id="45d49-485">Rearranging the cluster is usually possible unless the cluster is almost full or the existing services can't be consolidated for some reason.</span></span>

## <a name="buffered-capacity"></a><span data-ttu-id="45d49-486">Buffer capaciteit</span><span class="sxs-lookup"><span data-stu-id="45d49-486">Buffered Capacity</span></span>
<span data-ttu-id="45d49-487">De capaciteit van de buffer is een andere functie van de Cluster Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="45d49-487">Buffered capacity is another feature of the Cluster Resource Manager.</span></span> <span data-ttu-id="45d49-488">Hiermee kunt de reservering van een gedeelte van de totale knooppunt.</span><span class="sxs-lookup"><span data-stu-id="45d49-488">It allows reservation of some portion of the overall node capacity.</span></span> <span data-ttu-id="45d49-489">Deze buffer capaciteit wordt alleen gebruikt om services tijdens upgrades en knooppuntfouten.</span><span class="sxs-lookup"><span data-stu-id="45d49-489">This capacity buffer is only used to place services during upgrades and node failures.</span></span> <span data-ttu-id="45d49-490">De capaciteit van de buffer is globaal opgegeven per metrische gegevens voor alle knooppunten.</span><span class="sxs-lookup"><span data-stu-id="45d49-490">Buffered Capacity is specified globally per metric for all nodes.</span></span> <span data-ttu-id="45d49-491">De waarde die u voor de gereserveerde capaciteit kiest is een functie van het aantal fout- en Upgrade domeinen hebt u in het cluster.</span><span class="sxs-lookup"><span data-stu-id="45d49-491">The value you pick for the reserved capacity is a function of the number of Fault and Upgrade Domains you have in the cluster.</span></span> <span data-ttu-id="45d49-492">Meer fouttolerantie en -domeinen upgraden betekent dat u een lager getal kunt kiezen voor de capaciteit van de buffer.</span><span class="sxs-lookup"><span data-stu-id="45d49-492">More Fault and Upgrade Domains means that you can pick a lower number for your buffered capacity.</span></span> <span data-ttu-id="45d49-493">Als u meer domeinen hebt, kunt u verwachten kleinere hoeveelheden van het cluster niet beschikbaar tijdens upgrades en fouten.</span><span class="sxs-lookup"><span data-stu-id="45d49-493">If you have more domains, you can expect smaller amounts of your cluster to be unavailable during upgrades and failures.</span></span> <span data-ttu-id="45d49-494">Capaciteit gebufferd geven alleen zinvol als u ook de capaciteit van het knooppunt voor een waarde hebt opgegeven.</span><span class="sxs-lookup"><span data-stu-id="45d49-494">Specifying Buffered Capacity only makes sense if you have also specified the node capacity for a metric.</span></span>

<span data-ttu-id="45d49-495">Hier volgt een voorbeeld van het buffer capaciteit opgeven:</span><span class="sxs-lookup"><span data-stu-id="45d49-495">Here's an example of how to specify buffered capacity:</span></span>

<span data-ttu-id="45d49-496">ClusterManifest.xml</span><span class="sxs-lookup"><span data-stu-id="45d49-496">ClusterManifest.xml</span></span>

```xml
        <Section Name="NodeBufferPercentage">
            <Parameter Name="SomeMetric" Value="0.15" />
            <Parameter Name="SomeOtherMetric" Value="0.20" />
        </Section>
```

<span data-ttu-id="45d49-497">gehoste clusters via ClusterConfig.json voor zelfstandige implementaties of Template.json voor Azure:</span><span class="sxs-lookup"><span data-stu-id="45d49-497">via ClusterConfig.json for Standalone deployments or Template.json for Azure hosted clusters:</span></span>

```json
"fabricSettings": [
  {
    "name": "NodeBufferPercentage",
    "parameters": [
      {
          "name": "SomeMetric",
          "value": "0.15"
      },
      {
          "name": "SomeOtherMetric",
          "value": "0.20"
      }
    ]
  }
]
```

<span data-ttu-id="45d49-498">Het maken van nieuwe services mislukt wanneer het cluster niet gebufferd capaciteit voor een metriek.</span><span class="sxs-lookup"><span data-stu-id="45d49-498">The creation of new services fails when the cluster is out of buffered capacity for a metric.</span></span> <span data-ttu-id="45d49-499">Zo wordt voorkomen dat het maken van nieuwe services te behouden van de buffer zorgt ervoor dat upgrades en fouten knooppunten om te gaan via capaciteit geen veroorzaken.</span><span class="sxs-lookup"><span data-stu-id="45d49-499">Preventing the creation of new services to preserve the buffer ensures that upgrades and failures don’t cause nodes to go over capacity.</span></span> <span data-ttu-id="45d49-500">De capaciteit van de buffer is optioneel, maar wordt aanbevolen in een cluster dat een capaciteit voor een metriek definieert.</span><span class="sxs-lookup"><span data-stu-id="45d49-500">Buffered capacity is optional but is recommended in any cluster that defines a capacity for a metric.</span></span>

<span data-ttu-id="45d49-501">De Cluster Resource Manager, wordt deze informatie laden.</span><span class="sxs-lookup"><span data-stu-id="45d49-501">The Cluster Resource Manager exposes this load information.</span></span> <span data-ttu-id="45d49-502">Voor elke metriek omvat deze informatie:</span><span class="sxs-lookup"><span data-stu-id="45d49-502">For each metric, this information includes:</span></span> 
  - <span data-ttu-id="45d49-503">de buffer capaciteitsinstellingen</span><span class="sxs-lookup"><span data-stu-id="45d49-503">the buffered capacity settings</span></span>
  - <span data-ttu-id="45d49-504">de totale capaciteit</span><span class="sxs-lookup"><span data-stu-id="45d49-504">the total capacity</span></span>
  - <span data-ttu-id="45d49-505">het huidige verbruik</span><span class="sxs-lookup"><span data-stu-id="45d49-505">the current consumption</span></span>
  - <span data-ttu-id="45d49-506">Hiermee wordt aangegeven of elke metriek wordt beschouwd als met gelijke taakverdeling of niet</span><span class="sxs-lookup"><span data-stu-id="45d49-506">whether each metric is considered balanced or not</span></span>
  - <span data-ttu-id="45d49-507">statistieken over de standaarddeviatie</span><span class="sxs-lookup"><span data-stu-id="45d49-507">statistics about the standard deviation</span></span>
  - <span data-ttu-id="45d49-508">de knooppunten die de meeste hebben en minimaal laden</span><span class="sxs-lookup"><span data-stu-id="45d49-508">the nodes which have the most and least load</span></span>  
  
<span data-ttu-id="45d49-509">Hieronder ziet u een voorbeeld van deze uitvoer:</span><span class="sxs-lookup"><span data-stu-id="45d49-509">Below we see an example of that output:</span></span>

```posh
PS C:\Users\user> Get-ServiceFabricClusterLoadInformation
LastBalancingStartTimeUtc : 9/1/2016 12:54:59 AM
LastBalancingEndTimeUtc   : 9/1/2016 12:54:59 AM
LoadMetricInformation     :
                            LoadMetricName        : Metric1
                            IsBalancedBefore      : False
                            IsBalancedAfter       : False
                            DeviationBefore       : 0.192450089729875
                            DeviationAfter        : 0.192450089729875
                            BalancingThreshold    : 1
                            Action                : NoActionNeeded
                            ActivityThreshold     : 0
                            ClusterCapacity       : 189
                            ClusterLoad           : 45
                            ClusterRemainingCapacity : 144
                            NodeBufferPercentage  : 10
                            ClusterBufferedCapacity : 170
                            ClusterRemainingBufferedCapacity : 125
                            ClusterCapacityViolation : False
                            MinNodeLoadValue      : 0
                            MinNodeLoadNodeId     : 3ea71e8e01f4b0999b121abcbf27d74d
                            MaxNodeLoadValue      : 15
                            MaxNodeLoadNodeId     : 2cc648b6770be1bc9824fa995d5b68b1
```

## <a name="next-steps"></a><span data-ttu-id="45d49-510">Volgende stappen</span><span class="sxs-lookup"><span data-stu-id="45d49-510">Next steps</span></span>
* <span data-ttu-id="45d49-511">Bekijk voor meer informatie over de architectuur en de informatiestroom binnen het Cluster Resource Manager, [in dit artikel](service-fabric-cluster-resource-manager-architecture.md)</span><span class="sxs-lookup"><span data-stu-id="45d49-511">For information on the architecture and information flow within the Cluster Resource Manager, check out [this article ](service-fabric-cluster-resource-manager-architecture.md)</span></span>
* <span data-ttu-id="45d49-512">Defragmentatie metrische gegevens definiëren, is een manier om te consolideren belasting van de knooppunten in plaats van af te spreiden. Raadpleeg voor meer informatie over het configureren van defragmentatie, [in dit artikel](service-fabric-cluster-resource-manager-defragmentation-metrics.md)</span><span class="sxs-lookup"><span data-stu-id="45d49-512">Defining Defragmentation Metrics is one way to consolidate load on nodes instead of spreading it out. To learn how to configure defragmentation, refer to [this article](service-fabric-cluster-resource-manager-defragmentation-metrics.md)</span></span>
* <span data-ttu-id="45d49-513">Vanaf het begin starten en [Maak kennis met de Service Fabric Cluster Resource Manager](service-fabric-cluster-resource-manager-introduction.md)</span><span class="sxs-lookup"><span data-stu-id="45d49-513">Start from the beginning and [get an Introduction to the Service Fabric Cluster Resource Manager](service-fabric-cluster-resource-manager-introduction.md)</span></span>
* <span data-ttu-id="45d49-514">Als u wilt weten over hoe de Cluster Resource Manager beheert en een compromis tussen de werklast van het cluster, Raadpleeg het artikel op [load balancing](service-fabric-cluster-resource-manager-balancing.md)</span><span class="sxs-lookup"><span data-stu-id="45d49-514">To find out about how the Cluster Resource Manager manages and balances load in the cluster, check out the article on [balancing load](service-fabric-cluster-resource-manager-balancing.md)</span></span>

[Image1]:./media/service-fabric-cluster-resource-manager-cluster-description/cluster-fault-domains.png
[Image2]:./media/service-fabric-cluster-resource-manager-cluster-description/cluster-uneven-fault-domain-layout.png
[Image3]:./media/service-fabric-cluster-resource-manager-cluster-description/cluster-fault-and-upgrade-domains-with-placement.png
[Image4]:./media/service-fabric-cluster-resource-manager-cluster-description/cluster-fault-and-upgrade-domain-layout-strategies.png
[Image5]:./media/service-fabric-cluster-resource-manager-cluster-description/cluster-layout-different-workloads.png
[Image6]:./media/service-fabric-cluster-resource-manager-cluster-description/cluster-placement-constraints-node-properties.png
[Image7]:./media/service-fabric-cluster-resource-manager-cluster-description/cluster-nodes-and-capacity.png
