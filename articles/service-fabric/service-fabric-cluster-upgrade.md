---
title: een Azure Service Fabric-cluster aaaUpgrade | Microsoft Docs
description: Upgrade Hallo Service Fabric-code en/of de configuratie die wordt uitgevoerd van een Service Fabric-cluster, inclusief het instellen van de cluster-updatemodus, certificaten, toe te voegen toepassing poorten, OS patches doen upgraden enzovoort. Wat kunt u verwachten wanneer Hallo upgrades worden uitgevoerd?
services: service-fabric
documentationcenter: .net
author: ChackDan
manager: timlt
editor: 
ms.assetid: 15190ace-31ed-491f-a54b-b5ff61e718db
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 8/10/2017
ms.author: chackdan
ms.openlocfilehash: 94ac3833ec0810f79de06ecb50f254028fa90408
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 10/06/2017
---
# <a name="upgrade-an-azure-service-fabric-cluster"></a><span data-ttu-id="6f254-104">Upgrade van een Azure Service Fabric-cluster</span><span class="sxs-lookup"><span data-stu-id="6f254-104">Upgrade an Azure Service Fabric cluster</span></span>
> [!div class="op_single_selector"]
> * [<span data-ttu-id="6f254-105">Azure-Cluster</span><span class="sxs-lookup"><span data-stu-id="6f254-105">Azure Cluster</span></span>](service-fabric-cluster-upgrade.md)
> * [<span data-ttu-id="6f254-106">Zelfstandige Cluster</span><span class="sxs-lookup"><span data-stu-id="6f254-106">Standalone Cluster</span></span>](service-fabric-cluster-upgrade-windows-server.md)
> 
> 

<span data-ttu-id="6f254-107">Voor elk moderne systeem is ontwerpen voor kunnen succes op lange termijn voor belangrijke tooachieving van het product.</span><span class="sxs-lookup"><span data-stu-id="6f254-107">For any modern system, designing for upgradability is key tooachieving long-term success of your product.</span></span> <span data-ttu-id="6f254-108">Een Azure Service Fabric-cluster is een resource die u bezit, maar gedeeltelijk wordt beheerd door Microsoft.</span><span class="sxs-lookup"><span data-stu-id="6f254-108">An Azure Service Fabric cluster is a resource that you own, but is partly managed by Microsoft.</span></span> <span data-ttu-id="6f254-109">Dit artikel wordt beschreven wat automatisch wordt beheerd en wat u kunt zelf configureren.</span><span class="sxs-lookup"><span data-stu-id="6f254-109">This article describes what is managed automatically and what you can configure yourself.</span></span>

## <a name="controlling-hello-fabric-version-that-runs-on-your-cluster"></a><span data-ttu-id="6f254-110">Hallo fabric-versie die wordt uitgevoerd op het Cluster beheren</span><span class="sxs-lookup"><span data-stu-id="6f254-110">Controlling hello fabric version that runs on your Cluster</span></span>
<span data-ttu-id="6f254-111">U kunt uw cluster tooreceive automatische fabric upgrades instellen als ze door Microsoft worden uitgegeven of kunt u een ondersteunde fabric-versie die u wilt dat uw cluster toobe op.</span><span class="sxs-lookup"><span data-stu-id="6f254-111">You can set your cluster tooreceive automatic fabric upgrades as they are released by Microsoft or you can select a supported fabric version you want your cluster toobe on.</span></span>

<span data-ttu-id="6f254-112">Dit doet u door de instelling Hallo 'upgradeMode' clusterconfiguratie op Hallo portal of met behulp van Resource Manager op Hallo moment gemaakt of later in een live cluster</span><span class="sxs-lookup"><span data-stu-id="6f254-112">You do this by setting hello "upgradeMode" cluster configuration on hello portal or using Resource Manager at hello time of creation or later on a live cluster</span></span> 

> [!NOTE]
> <span data-ttu-id="6f254-113">Zorg ervoor dat tookeep uw cluster een ondersteunde fabric-versie altijd uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="6f254-113">Make sure tookeep your cluster running a supported fabric version always.</span></span> <span data-ttu-id="6f254-114">Als en dat we Hallo-release van een nieuwe versie van het service fabric aankondigen, is voor einde van de ondersteuningsperiode Hallo vorige versie gemarkeerd na een minimum van 60 dagen na die datum.</span><span class="sxs-lookup"><span data-stu-id="6f254-114">As and when we announce hello release of a new version of service fabric, hello previous version is marked for end of support after a minimum of 60 days from that date.</span></span> <span data-ttu-id="6f254-115">Hallo Hallo nieuwe releases worden aangekondigd [op Hallo service fabric-teamblog](https://blogs.msdn.microsoft.com/azureservicefabric/).</span><span class="sxs-lookup"><span data-stu-id="6f254-115">hello  hello new releases are announced [on hello service fabric team blog](https://blogs.msdn.microsoft.com/azureservicefabric/).</span></span> <span data-ttu-id="6f254-116">Hallo nieuwe release is vervolgens beschikbaar toochoose.</span><span class="sxs-lookup"><span data-stu-id="6f254-116">hello new release is available toochoose then.</span></span> 
> 
> 

<span data-ttu-id="6f254-117">14 dagen voorafgaande toohello verloopdatum van Hallo release uw cluster wordt uitgevoerd, wordt een statusgebeurtenis gegenereerd die het cluster in een waarschuwingsstatus wordt geplaatst.</span><span class="sxs-lookup"><span data-stu-id="6f254-117">14 days prior toohello expiry of hello release your cluster is running, a health event is generated that puts your cluster into a warning health state.</span></span> <span data-ttu-id="6f254-118">Hallo cluster blijft met een waarschuwingsstatus totdat u een upgrade uitvoert van tooa ondersteunde fabric-versie.</span><span class="sxs-lookup"><span data-stu-id="6f254-118">hello cluster remains in a warning state until you upgrade tooa supported fabric version.</span></span>

### <a name="setting-hello-upgrade-mode-via-portal"></a><span data-ttu-id="6f254-119">Hallo upgrademodus via de portal instellen</span><span class="sxs-lookup"><span data-stu-id="6f254-119">Setting hello upgrade mode via portal</span></span>
<span data-ttu-id="6f254-120">U kunt tijdens het maken van de cluster Hallo Hallo cluster tooautomatic of handmatig instellen.</span><span class="sxs-lookup"><span data-stu-id="6f254-120">You can set hello cluster tooautomatic or manual when you are creating hello cluster.</span></span>

![Create_Manualmode][Create_Manualmode]

<span data-ttu-id="6f254-122">U kunt Hallo cluster tooautomatic instellen of handmatige wanneer op een live cluster, met behulp van Hallo ervaring beheren.</span><span class="sxs-lookup"><span data-stu-id="6f254-122">You can set hello cluster tooautomatic or manual when on a live cluster, using hello manage experience.</span></span> 

#### <a name="upgrading-tooa-new-version-on-a-cluster-that-is-set-toomanual-mode-via-portal"></a><span data-ttu-id="6f254-123">Upgraden van de nieuwe versie tooa op een cluster dat tooManual modus via de portal is ingesteld.</span><span class="sxs-lookup"><span data-stu-id="6f254-123">Upgrading tooa new version on a cluster that is set tooManual mode via portal.</span></span>
<span data-ttu-id="6f254-124">tooupgrade tooa is nieuwe versie, hoeft u toodo Hallo beschikbare versie uit de vervolgkeuzelijst Hallo selecteert en slaat u.</span><span class="sxs-lookup"><span data-stu-id="6f254-124">tooupgrade tooa new version, all you need toodo is select hello available version from hello dropdown and save.</span></span> <span data-ttu-id="6f254-125">Hallo Fabric-upgrade wordt automatisch gestart.</span><span class="sxs-lookup"><span data-stu-id="6f254-125">hello Fabric upgrade gets kicked off automatically.</span></span> <span data-ttu-id="6f254-126">Hallo statusbeleid cluster (een combinatie van het knooppunt status en alle toepassingen die worden uitgevoerd in de cluster Hallo HALLO hallo-status) zijn gehouden tooduring Hallo upgrade.</span><span class="sxs-lookup"><span data-stu-id="6f254-126">hello cluster health policies (a combination of node health and hello health all hello applications running in hello cluster) are adhered tooduring hello upgrade.</span></span>

<span data-ttu-id="6f254-127">Als het statusbeleid Hallo-cluster niet wordt voldaan, is Hallo-upgrade teruggedraaid.</span><span class="sxs-lookup"><span data-stu-id="6f254-127">If hello cluster health policies are not met, hello upgrade is rolled back.</span></span> <span data-ttu-id="6f254-128">Schuif omlaag in dit document tooread meer informatie over hoe tooset die aangepaste statusbeleid.</span><span class="sxs-lookup"><span data-stu-id="6f254-128">Scroll down this document tooread more on how tooset those custom health policies.</span></span> 

<span data-ttu-id="6f254-129">Als u problemen met de Hallo dat heeft geresulteerd in Hallo terugdraaien hebt opgelost, moet u tooinitiate Hallo upgrade opnieuw door de volgende Hallo dezelfde als voorheen stappen.</span><span class="sxs-lookup"><span data-stu-id="6f254-129">Once you have fixed hello issues that resulted in hello rollback, you need tooinitiate hello upgrade again, by following hello same steps as before.</span></span>

![Manage_Automaticmode][Manage_Automaticmode]

### <a name="setting-hello-upgrade-mode-via-a-resource-manager-template"></a><span data-ttu-id="6f254-131">Hallo upgrademodus via Resource Manager-sjabloon instellen</span><span class="sxs-lookup"><span data-stu-id="6f254-131">Setting hello upgrade mode via a Resource Manager template</span></span>
<span data-ttu-id="6f254-132">Hallo 'upgradeMode' toohello Microsoft.ServiceFabric/clusters resource configuratiedefinitie en set Hallo 'clusterCodeVersion' tooone Hallo fabric-versies ondersteund zoals hieronder wordt weergegeven en vervolgens implementeert Hallo sjabloon toevoegen.</span><span class="sxs-lookup"><span data-stu-id="6f254-132">Add hello "upgradeMode" configuration toohello Microsoft.ServiceFabric/clusters resource definition and set hello "clusterCodeVersion" tooone of hello supported fabric versions as shown below and then deploy hello template.</span></span> <span data-ttu-id="6f254-133">geldige waarden voor 'upgradeMode' Hallo zijn 'Handmatig' of 'Automatisch'</span><span class="sxs-lookup"><span data-stu-id="6f254-133">hello valid values for "upgradeMode" are "Manual" or "Automatic"</span></span>

![ARMUpgradeMode][ARMUpgradeMode]

#### <a name="upgrading-tooa-new-version-on-a-cluster-that-is-set-toomanual-mode-via-a-resource-manager-template"></a><span data-ttu-id="6f254-135">Upgraden van de nieuwe versie tooa op een cluster dat tooManual modus via Resource Manager-sjabloon is ingesteld.</span><span class="sxs-lookup"><span data-stu-id="6f254-135">Upgrading tooa new version on a cluster that is set tooManual mode via a Resource Manager template.</span></span>
<span data-ttu-id="6f254-136">Wanneer Hallo-cluster in de handmatige modus, tooupgrade tooa nieuwe versie, ondersteunde versie van Hallo 'clusterCodeVersion' tooa wijzigen en deze implementeren.</span><span class="sxs-lookup"><span data-stu-id="6f254-136">When hello cluster is in Manual mode, tooupgrade tooa new version, change hello "clusterCodeVersion" tooa supported version and deploy it.</span></span> <span data-ttu-id="6f254-137">Hallo-implementatie van sjabloon hello, gang van Fabric-upgrade Hallo opgehaald gestarte automatisch.</span><span class="sxs-lookup"><span data-stu-id="6f254-137">hello deployment of hello template, kicks of hello Fabric upgrade gets kicked off automatically.</span></span> <span data-ttu-id="6f254-138">Hallo statusbeleid cluster (een combinatie van het knooppunt status en alle toepassingen die worden uitgevoerd in de cluster Hallo HALLO hallo-status) zijn gehouden tooduring Hallo upgrade.</span><span class="sxs-lookup"><span data-stu-id="6f254-138">hello cluster health policies (a combination of node health and hello health all hello applications running in hello cluster) are adhered tooduring hello upgrade.</span></span>

<span data-ttu-id="6f254-139">Als het statusbeleid Hallo-cluster niet wordt voldaan, is Hallo-upgrade teruggedraaid.</span><span class="sxs-lookup"><span data-stu-id="6f254-139">If hello cluster health policies are not met, hello upgrade is rolled back.</span></span> <span data-ttu-id="6f254-140">Schuif omlaag in dit document tooread meer informatie over hoe tooset die aangepaste statusbeleid.</span><span class="sxs-lookup"><span data-stu-id="6f254-140">Scroll down this document tooread more on how tooset those custom health policies.</span></span> 

<span data-ttu-id="6f254-141">Als u problemen met de Hallo dat heeft geresulteerd in Hallo terugdraaien hebt opgelost, moet u tooinitiate Hallo upgrade opnieuw door de volgende Hallo dezelfde als voorheen stappen.</span><span class="sxs-lookup"><span data-stu-id="6f254-141">Once you have fixed hello issues that resulted in hello rollback, you need tooinitiate hello upgrade again, by following hello same steps as before.</span></span>

### <a name="get-list-of-all-available-version-for-all-environments-for-a-given-subscription"></a><span data-ttu-id="6f254-142">Lijst met alle beschikbare versie ophalen voor alle omgevingen voor een bepaald abonnement</span><span class="sxs-lookup"><span data-stu-id="6f254-142">Get list of all available version for all environments for a given subscription</span></span>
<span data-ttu-id="6f254-143">Voer Hallo van de volgende opdracht en krijgt u een vergelijkbare toothis uitvoer.</span><span class="sxs-lookup"><span data-stu-id="6f254-143">Run hello following command, and you should get an output similar toothis.</span></span>

<span data-ttu-id="6f254-144">'supportExpiryUtc' vertelt uw wanneer een bepaalde versie is verlopen of is verlopen.</span><span class="sxs-lookup"><span data-stu-id="6f254-144">"supportExpiryUtc" tells your when a given release is expiring or has expired.</span></span> <span data-ttu-id="6f254-145">Hallo meest recente versie beschikt niet over een geldige datum - deze heeft een waarde van ' 9999-12-31T23:59:59.9999999 ', wat betekent dat de vervaldatum Hallo nog niet wordt ingesteld.</span><span class="sxs-lookup"><span data-stu-id="6f254-145">hello latest release does not have a valid date - it has a value of "9999-12-31T23:59:59.9999999", which just means that hello expiry date is not yet set.</span></span>

```REST
GET https://<endpoint>/subscriptions/{{subscriptionId}}/providers/Microsoft.ServiceFabric/locations/{{location}}/clusterVersions?api-version=2016-09-01

Example: https://management.azure.com/subscriptions/1857f442-3bce-4b96-ad95-627f76437a67/providers/Microsoft.ServiceFabric/locations/eastus/clusterVersions?api-version=2016-09-01

Output:
{
                  "value": [
                    {
                      "id": "subscriptions/35349203-a0b3-405e-8a23-9f1450984307/providers/Microsoft.ServiceFabric/environments/Windows/clusterVersions/5.0.1427.9490",
                      "name": "5.0.1427.9490",
                      "type": "Microsoft.ServiceFabric/environments/clusterVersions",
                      "properties": {
                        "codeVersion": "5.0.1427.9490",
                        "supportExpiryUtc": "2016-11-26T23:59:59.9999999",
                        "environment": "Windows"
                      }
                    },
                    {
                      "id": "subscriptions/35349203-a0b3-405e-8a23-9f1450984307/providers/Microsoft.ServiceFabric/environments/Windows/clusterVersions/4.0.1427.9490",
                      "name": "5.1.1427.9490",
                      "type": " Microsoft.ServiceFabric/environments/clusterVersions",
                      "properties": {
                        "codeVersion": "5.1.1427.9490",
                        "supportExpiryUtc": "9999-12-31T23:59:59.9999999",
                        "environment": "Windows"
                      }
                    },
                    {
                      "id": "subscriptions/35349203-a0b3-405e-8a23-9f1450984307/providers/Microsoft.ServiceFabric/environments/Windows/clusterVersions/4.4.1427.9490",
                      "name": "4.4.1427.9490",
                      "type": " Microsoft.ServiceFabric/environments/clusterVersions",
                      "properties": {
                        "codeVersion": "4.4.1427.9490",
                        "supportExpiryUtc": "9999-12-31T23:59:59.9999999",
                        "environment": "Linux"
                      }
                    }
                  ]
                }


```

## <a name="fabric-upgrade-behavior-when-hello-cluster-upgrade-mode-is-automatic"></a><span data-ttu-id="6f254-146">Fabric upgrade gedrag wanneer Hallo cluster de modus bijwerken automatisch is</span><span class="sxs-lookup"><span data-stu-id="6f254-146">Fabric upgrade behavior when hello cluster Upgrade Mode is Automatic</span></span>
<span data-ttu-id="6f254-147">Microsoft onderhoudt Hallo fabric code en configuratie die in een Azure-cluster wordt uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="6f254-147">Microsoft maintains hello fabric code and configuration that runs in an Azure cluster.</span></span> <span data-ttu-id="6f254-148">We uitvoeren automatische gecontroleerde upgrades toohello software op een als dat nodig is.</span><span class="sxs-lookup"><span data-stu-id="6f254-148">We perform automatic monitored upgrades toohello software on an as-needed basis.</span></span> <span data-ttu-id="6f254-149">Deze upgrades mogelijk code en/of de configuratie.</span><span class="sxs-lookup"><span data-stu-id="6f254-149">These upgrades could be code, configuration, or both.</span></span> <span data-ttu-id="6f254-150">toomake ervoor dat uw toepassing te lijden heeft onder geen gevolgen of minimale gevolgen vanwege toothese upgrades, we Hallo upgrades uitvoeren in de volgende fasen Hallo:</span><span class="sxs-lookup"><span data-stu-id="6f254-150">toomake sure that your application suffers no impact or minimal impact due toothese upgrades, we perform hello upgrades in hello following phases:</span></span>

### <a name="phase-1-an-upgrade-is-performed-by-using-all-cluster-health-policies"></a><span data-ttu-id="6f254-151">Fase 1: Een upgrade wordt uitgevoerd met behulp van alle cluster statusbeleid</span><span class="sxs-lookup"><span data-stu-id="6f254-151">Phase 1: An upgrade is performed by using all cluster health policies</span></span>
<span data-ttu-id="6f254-152">Tijdens deze fase Hallo upgrades één upgradedomein tegelijk gaan en Hallo-toepassingen die zijn uitgevoerd in de cluster Hallo blijven toorun zonder uitvaltijd.</span><span class="sxs-lookup"><span data-stu-id="6f254-152">During this phase, hello upgrades proceed one upgrade domain at a time, and hello applications that were running in hello cluster continue toorun without any downtime.</span></span> <span data-ttu-id="6f254-153">Hallo statusbeleid cluster (een combinatie van het knooppunt status en alle toepassingen die worden uitgevoerd in de cluster Hallo HALLO hallo-status) zijn gehouden tooduring Hallo upgrade.</span><span class="sxs-lookup"><span data-stu-id="6f254-153">hello cluster health policies (a combination of node health and hello health all hello applications running in hello cluster) are adhered tooduring hello upgrade.</span></span>

<span data-ttu-id="6f254-154">Als het statusbeleid Hallo-cluster niet wordt voldaan, is Hallo-upgrade teruggedraaid.</span><span class="sxs-lookup"><span data-stu-id="6f254-154">If hello cluster health policies are not met, hello upgrade is rolled back.</span></span> <span data-ttu-id="6f254-155">Een e-mailbericht verzonden vervolgens toohello eigenaar van het Hallo-abonnement.</span><span class="sxs-lookup"><span data-stu-id="6f254-155">Then an email is sent toohello owner of hello subscription.</span></span> <span data-ttu-id="6f254-156">Hallo e-mailbericht bevat Hallo volgende informatie:</span><span class="sxs-lookup"><span data-stu-id="6f254-156">hello email contains hello following information:</span></span>

* <span data-ttu-id="6f254-157">Melding dat we tooroll weer een upgrade van het cluster hadden.</span><span class="sxs-lookup"><span data-stu-id="6f254-157">Notification that we had tooroll back a cluster upgrade.</span></span>
* <span data-ttu-id="6f254-158">Voorgestelde corrigerende acties, indien van toepassing.</span><span class="sxs-lookup"><span data-stu-id="6f254-158">Suggested remedial actions, if any.</span></span>
* <span data-ttu-id="6f254-159">Hallo aantal dagen (n) totdat we fase 2 uitvoeren.</span><span class="sxs-lookup"><span data-stu-id="6f254-159">hello number of days (n) until we execute Phase 2.</span></span>

<span data-ttu-id="6f254-160">We proberen tooexecute Hallo die dezelfde een paar keer upgrade geval eventuele upgrades is mislukt door redenen infrastructuur.</span><span class="sxs-lookup"><span data-stu-id="6f254-160">We try tooexecute hello same upgrade a few more times in case any upgrades failed for infrastructure reasons.</span></span> <span data-ttu-id="6f254-161">Na Hallo n dagen vanaf Hallo datum Hallo e-mail is verzonden, wordt we gaan tooPhase 2.</span><span class="sxs-lookup"><span data-stu-id="6f254-161">After hello n days from hello date hello email was sent, we proceed tooPhase 2.</span></span>

<span data-ttu-id="6f254-162">Hallo cluster statusbeleid wordt voldaan, is Hallo-upgrade beschouwd als geslaagd als voltooid gemarkeerd.</span><span class="sxs-lookup"><span data-stu-id="6f254-162">If hello cluster health policies are met, hello upgrade is considered successful and marked complete.</span></span> <span data-ttu-id="6f254-163">Dit kan gebeuren tijdens de eerste upgrade hello of een van de upgrade herhalingen Hallo in deze fase.</span><span class="sxs-lookup"><span data-stu-id="6f254-163">This can happen during hello initial upgrade or any of hello upgrade reruns in this phase.</span></span> <span data-ttu-id="6f254-164">Er is geen e-mailbevestiging van een geslaagde uitvoering.</span><span class="sxs-lookup"><span data-stu-id="6f254-164">There is no email confirmation of a successful run.</span></span> <span data-ttu-id="6f254-165">Dit is tooavoid u te veel e-mails--ontvangt een e-mailbericht moet worden beschouwd als een uitzondering toonormal verzenden.</span><span class="sxs-lookup"><span data-stu-id="6f254-165">This is tooavoid sending you too many emails--receiving an email should be seen as an exception toonormal.</span></span> <span data-ttu-id="6f254-166">De meeste Hallo cluster upgrades toosucceed verwachten we zonder enige impact op de beschikbaarheid van uw toepassing.</span><span class="sxs-lookup"><span data-stu-id="6f254-166">We expect most of hello cluster upgrades toosucceed without impacting your application availability.</span></span>

### <a name="phase-2-an-upgrade-is-performed-by-using-default-health-policies-only"></a><span data-ttu-id="6f254-167">Fase 2: Een upgrade wordt uitgevoerd met behulp van standaard statusbeleid alleen</span><span class="sxs-lookup"><span data-stu-id="6f254-167">Phase 2: An upgrade is performed by using default health policies only</span></span>
<span data-ttu-id="6f254-168">Hallo statusbeleid in deze fase worden ingesteld op zodanige wijze dat aantal toepassingen die in orde aan Hallo begin van de upgrade Hallo zijn Hallo Hallo identiek zijn voor de duur van het upgradeproces Hallo Hallo blijft.</span><span class="sxs-lookup"><span data-stu-id="6f254-168">hello health policies in this phase are set in such a way that hello number of applications that were healthy at hello beginning of hello upgrade remains hello same for hello duration of hello upgrade process.</span></span> <span data-ttu-id="6f254-169">Net zoals in de fase 1 Hallo fase 2-upgrades één upgradedomein tegelijk gaan en Hallo-toepassingen die zijn uitgevoerd in de cluster Hallo blijven toorun zonder uitvaltijd.</span><span class="sxs-lookup"><span data-stu-id="6f254-169">As in Phase 1, hello Phase 2 upgrades proceed one upgrade domain at a time, and hello applications that were running in hello cluster continue toorun without any downtime.</span></span> <span data-ttu-id="6f254-170">statusbeleid Hallo-cluster (een combinatie van het knooppunt status en alle toepassingen die worden uitgevoerd in de cluster Hallo HALLO hallo-status) zijn zelfklevend toofor Hallo duur van Hallo upgrade.</span><span class="sxs-lookup"><span data-stu-id="6f254-170">hello cluster health policies (a combination of node health and hello health all hello applications running in hello cluster) are adhered toofor hello duration of hello upgrade.</span></span>

<span data-ttu-id="6f254-171">Als Hallo cluster statusbeleid wordt van kracht niet voldaan, is Hallo-upgrade teruggedraaid.</span><span class="sxs-lookup"><span data-stu-id="6f254-171">If hello cluster health policies in effect are not met, hello upgrade is rolled back.</span></span> <span data-ttu-id="6f254-172">Een e-mailbericht verzonden vervolgens toohello eigenaar van het Hallo-abonnement.</span><span class="sxs-lookup"><span data-stu-id="6f254-172">Then an email is sent toohello owner of hello subscription.</span></span> <span data-ttu-id="6f254-173">Hallo e-mailbericht bevat Hallo volgende informatie:</span><span class="sxs-lookup"><span data-stu-id="6f254-173">hello email contains hello following information:</span></span>

* <span data-ttu-id="6f254-174">Melding dat we tooroll weer een upgrade van het cluster hadden.</span><span class="sxs-lookup"><span data-stu-id="6f254-174">Notification that we had tooroll back a cluster upgrade.</span></span>
* <span data-ttu-id="6f254-175">Voorgestelde corrigerende acties, indien van toepassing.</span><span class="sxs-lookup"><span data-stu-id="6f254-175">Suggested remedial actions, if any.</span></span>
* <span data-ttu-id="6f254-176">Hallo aantal dagen (n) totdat we fase 3 uitvoeren.</span><span class="sxs-lookup"><span data-stu-id="6f254-176">hello number of days (n) until we execute Phase 3.</span></span>

<span data-ttu-id="6f254-177">We proberen tooexecute Hallo die dezelfde een paar keer upgrade geval eventuele upgrades is mislukt door redenen infrastructuur.</span><span class="sxs-lookup"><span data-stu-id="6f254-177">We try tooexecute hello same upgrade a few more times in case any upgrades failed for infrastructure reasons.</span></span> <span data-ttu-id="6f254-178">Een herinnering is verzonden een paar dagen voordat n dagen actief zijn.</span><span class="sxs-lookup"><span data-stu-id="6f254-178">A reminder email is sent a couple of days before n days are up.</span></span> <span data-ttu-id="6f254-179">Na Hallo n dagen vanaf Hallo datum Hallo e-mail is verzonden, wordt we gaan tooPhase 3.</span><span class="sxs-lookup"><span data-stu-id="6f254-179">After hello n days from hello date hello email was sent, we proceed tooPhase 3.</span></span> <span data-ttu-id="6f254-180">Hallo e-mailberichten we u in de fase 2 sturen ernstig moeten worden gehaald en corrigerende acties moeten worden genomen.</span><span class="sxs-lookup"><span data-stu-id="6f254-180">hello emails we send you in Phase 2 must be taken seriously and remedial actions must be taken.</span></span>

<span data-ttu-id="6f254-181">Hallo cluster statusbeleid wordt voldaan, is Hallo-upgrade beschouwd als geslaagd als voltooid gemarkeerd.</span><span class="sxs-lookup"><span data-stu-id="6f254-181">If hello cluster health policies are met, hello upgrade is considered successful and marked complete.</span></span> <span data-ttu-id="6f254-182">Dit kan gebeuren tijdens de eerste upgrade hello of een van de upgrade herhalingen Hallo in deze fase.</span><span class="sxs-lookup"><span data-stu-id="6f254-182">This can happen during hello initial upgrade or any of hello upgrade reruns in this phase.</span></span> <span data-ttu-id="6f254-183">Er is geen e-mailbevestiging van een geslaagde uitvoering.</span><span class="sxs-lookup"><span data-stu-id="6f254-183">There is no email confirmation of a successful run.</span></span>

### <a name="phase-3-an-upgrade-is-performed-by-using-aggressive-health-policies"></a><span data-ttu-id="6f254-184">Fase 3: Een upgrade wordt uitgevoerd met behulp van agressieve statusbeleid</span><span class="sxs-lookup"><span data-stu-id="6f254-184">Phase 3: An upgrade is performed by using aggressive health policies</span></span>
<span data-ttu-id="6f254-185">Deze statusbeleid in deze fase zijn gericht op het Hallo-upgrade is voltooid in plaats van Hallo status van Hallo-toepassingen.</span><span class="sxs-lookup"><span data-stu-id="6f254-185">These health policies in this phase are geared towards completion of hello upgrade rather than hello health of hello applications.</span></span> <span data-ttu-id="6f254-186">In deze fase eindigen heel weinig cluster-upgrades.</span><span class="sxs-lookup"><span data-stu-id="6f254-186">Very few cluster upgrades end up in this phase.</span></span> <span data-ttu-id="6f254-187">Als uw cluster opgehaald toothis fase, is er een goede kans dat uw toepassing slecht functioneert en/of beschikbaarheid verliezen.</span><span class="sxs-lookup"><span data-stu-id="6f254-187">If your cluster gets toothis phase, there is a good chance that your application becomes unhealthy and/or lose availability.</span></span>

<span data-ttu-id="6f254-188">Vergelijkbare toohello andere twee fasen, upgrades voor fase 3, gaat u verder één upgradedomein tegelijk.</span><span class="sxs-lookup"><span data-stu-id="6f254-188">Similar toohello other two phases, Phase 3 upgrades proceed one upgrade domain at a time.</span></span>

<span data-ttu-id="6f254-189">Als het statusbeleid Hallo-cluster niet wordt voldaan, is Hallo-upgrade teruggedraaid.</span><span class="sxs-lookup"><span data-stu-id="6f254-189">If hello cluster health policies are not met, hello upgrade is rolled back.</span></span> <span data-ttu-id="6f254-190">We proberen tooexecute Hallo die dezelfde een paar keer upgrade geval eventuele upgrades is mislukt door redenen infrastructuur.</span><span class="sxs-lookup"><span data-stu-id="6f254-190">We try tooexecute hello same upgrade a few more times in case any upgrades failed for infrastructure reasons.</span></span> <span data-ttu-id="6f254-191">Hallo-cluster is hierna is vastgemaakt, zodat deze niet langer ondersteuning en/of upgrades ontvangt.</span><span class="sxs-lookup"><span data-stu-id="6f254-191">After that, hello cluster is pinned, so that it will no longer receive support and/or upgrades.</span></span>

<span data-ttu-id="6f254-192">Een e-mailbericht met deze informatie wordt verzonden toohello abonnement eigenaar, samen met de Hallo corrigerende acties.</span><span class="sxs-lookup"><span data-stu-id="6f254-192">An email with this information is sent toohello subscription owner, along with hello remedial actions.</span></span> <span data-ttu-id="6f254-193">We niet van plan bent een tooget clusters in een status waarbij de fase 3 is mislukt.</span><span class="sxs-lookup"><span data-stu-id="6f254-193">We do not expect any clusters tooget into a state where Phase 3 has failed.</span></span>

<span data-ttu-id="6f254-194">Hallo cluster statusbeleid wordt voldaan, is Hallo-upgrade beschouwd als geslaagd als voltooid gemarkeerd.</span><span class="sxs-lookup"><span data-stu-id="6f254-194">If hello cluster health policies are met, hello upgrade is considered successful and marked complete.</span></span> <span data-ttu-id="6f254-195">Dit kan gebeuren tijdens de eerste upgrade hello of een van de upgrade herhalingen Hallo in deze fase.</span><span class="sxs-lookup"><span data-stu-id="6f254-195">This can happen during hello initial upgrade or any of hello upgrade reruns in this phase.</span></span> <span data-ttu-id="6f254-196">Er is geen e-mailbevestiging van een geslaagde uitvoering.</span><span class="sxs-lookup"><span data-stu-id="6f254-196">There is no email confirmation of a successful run.</span></span>

## <a name="cluster-configurations-that-you-control"></a><span data-ttu-id="6f254-197">Clusterconfiguraties die u beheert</span><span class="sxs-lookup"><span data-stu-id="6f254-197">Cluster configurations that you control</span></span>
<span data-ttu-id="6f254-198">Bovendien toohello mogelijkheid tooset Hallo cluster upgrademodus, hier zijn Hallo-configuraties die u in een live cluster wijzigen kunt.</span><span class="sxs-lookup"><span data-stu-id="6f254-198">In addition toohello ability tooset hello cluster upgrade mode, Here are hello configurations that you can change on a live cluster.</span></span>

### <a name="certificates"></a><span data-ttu-id="6f254-199">Certificaten</span><span class="sxs-lookup"><span data-stu-id="6f254-199">Certificates</span></span>
<span data-ttu-id="6f254-200">U kunt nieuwe toevoegen of verwijderen van certificaten voor Hallo-cluster en de client via de portal Hallo eenvoudig.</span><span class="sxs-lookup"><span data-stu-id="6f254-200">You can add new or delete certificates for hello cluster and client via hello portal easily.</span></span> <span data-ttu-id="6f254-201">Raadpleeg te[dit document voor gedetailleerde instructies](service-fabric-cluster-security-update-certs-azure.md)</span><span class="sxs-lookup"><span data-stu-id="6f254-201">Refer too[this document for detailed instructions](service-fabric-cluster-security-update-certs-azure.md)</span></span>

![Schermafbeelding van certificaatvingerafdrukken in hello Azure-portal.][CertificateUpgrade]

### <a name="application-ports"></a><span data-ttu-id="6f254-203">Poorten van de toepassing</span><span class="sxs-lookup"><span data-stu-id="6f254-203">Application ports</span></span>
<span data-ttu-id="6f254-204">U kunt toepassing poorten wijzigen door Hallo Load Balancer resource-eigenschappen die gekoppeld aan het knooppunttype hello zijn te wijzigen.</span><span class="sxs-lookup"><span data-stu-id="6f254-204">You can change application ports by changing hello Load Balancer resource properties that are associated with hello node type.</span></span> <span data-ttu-id="6f254-205">U kunt Hallo portal gebruiken of kunt u rechtstreeks Resource Manager PowerShell gebruiken.</span><span class="sxs-lookup"><span data-stu-id="6f254-205">You can use hello portal, or you can use Resource Manager PowerShell directly.</span></span>

<span data-ttu-id="6f254-206">een nieuwe poort op alle virtuele machines in een knooppunttype tooopen Hallo te volgen:</span><span class="sxs-lookup"><span data-stu-id="6f254-206">tooopen a new port on all VMs in a node type, do hello following:</span></span>

1. <span data-ttu-id="6f254-207">Voeg een nieuwe test toohello geschikte load balancer.</span><span class="sxs-lookup"><span data-stu-id="6f254-207">Add a new probe toohello appropriate load balancer.</span></span>
   
    <span data-ttu-id="6f254-208">Als u uw cluster hebt geïmplementeerd met behulp van de portal hello, Hallo load balancers zijn met de naam ' LB van Hallo Resource group-NodeTypename ', één voor elk knooppunttype.</span><span class="sxs-lookup"><span data-stu-id="6f254-208">If you deployed your cluster by using hello portal, hello load balancers are named "LB-name of hello Resource group-NodeTypename", one for each node type.</span></span> <span data-ttu-id="6f254-209">Aangezien Hallo load balancer namen uniek alleen binnen een resourcegroep zijn, wordt het aanbevolen als u naar deze onder een bepaalde resourcegroep zoekt.</span><span class="sxs-lookup"><span data-stu-id="6f254-209">Since hello load balancer names are unique only within a resource group, it is best if you search for them under a specific resource group.</span></span>
   
    ![Schermafbeelding van het toevoegen van een tooa test de load balancer in Hallo-portal.][AddingProbes]
2. <span data-ttu-id="6f254-211">Voeg een nieuwe regel toohello load balancer.</span><span class="sxs-lookup"><span data-stu-id="6f254-211">Add a new rule toohello load balancer.</span></span>
   
    <span data-ttu-id="6f254-212">Een nieuwe regel toohello dezelfde de load balancer met behulp van Hallo-test die u hebt gemaakt in de vorige stap Hallo toevoegen.</span><span class="sxs-lookup"><span data-stu-id="6f254-212">Add a new rule toohello same load balancer by using hello probe that you created in hello previous step.</span></span>
   
    ![Toevoegen van een nieuwe regel tooa load balancer in Hallo-portal.][AddingLBRules]

### <a name="placement-properties"></a><span data-ttu-id="6f254-214">Plaatsingseigenschappen</span><span class="sxs-lookup"><span data-stu-id="6f254-214">Placement properties</span></span>
<span data-ttu-id="6f254-215">U kunt aangepaste plaatsingseigenschappen gewenste toouse in uw toepassingen toevoegen voor elk van de knooppunttypen Hallo.</span><span class="sxs-lookup"><span data-stu-id="6f254-215">For each of hello node types, you can add custom placement properties that you want toouse in your applications.</span></span> <span data-ttu-id="6f254-216">NodeType is een standaardeigenschap die u gebruiken kunt zonder deze expliciet toe te voegen.</span><span class="sxs-lookup"><span data-stu-id="6f254-216">NodeType is a default property that you can use without adding it explicitly.</span></span>

> [!NOTE]
> <span data-ttu-id="6f254-217">Voor meer informatie over Hallo gebruik van plaatsingsbeperkingen, knooppunteigenschappen, en hoe toodefine, verwijzen toohello sectie 'Plaatsing beperkingen en eigenschappen van knooppunt' hello Service Fabric Cluster Resource Manager-Document op [met een beschrijving van uw Cluster ](service-fabric-cluster-resource-manager-cluster-description.md).</span><span class="sxs-lookup"><span data-stu-id="6f254-217">For details on hello use of placement constraints, node properties, and how toodefine them, refer toohello section "Placement Constraints and Node Properties" in hello Service Fabric Cluster Resource Manager Document on [Describing Your Cluster](service-fabric-cluster-resource-manager-cluster-description.md).</span></span>
> 
> 

### <a name="capacity-metrics"></a><span data-ttu-id="6f254-218">Capaciteit metrische gegevens</span><span class="sxs-lookup"><span data-stu-id="6f254-218">Capacity metrics</span></span>
<span data-ttu-id="6f254-219">Voor elk van de knooppunttypen hello, kunt u aangepaste capaciteitsmetrieken dat u in uw toepassingen tooreport load toouse wilt toevoegen.</span><span class="sxs-lookup"><span data-stu-id="6f254-219">For each of hello node types, you can add custom capacity metrics that you want toouse in your applications tooreport load.</span></span> <span data-ttu-id="6f254-220">Raadpleeg voor meer informatie over Hallo gebruik van capaciteit metrische gegevens tooreport load toohello Service Fabric-Cluster Resource Manager-documenten op [met een beschrijving van uw Cluster](service-fabric-cluster-resource-manager-cluster-description.md) en [metrische gegevens en de belasting](service-fabric-cluster-resource-manager-metrics.md).</span><span class="sxs-lookup"><span data-stu-id="6f254-220">For details on hello use of capacity metrics tooreport load, refer toohello Service Fabric Cluster Resource Manager Documents on [Describing Your Cluster](service-fabric-cluster-resource-manager-cluster-description.md) and [Metrics and Load](service-fabric-cluster-resource-manager-metrics.md).</span></span>

### <a name="fabric-upgrade-settings---health-polices"></a><span data-ttu-id="6f254-221">Instellingen voor fabric-upgrade - Health-beleid</span><span class="sxs-lookup"><span data-stu-id="6f254-221">Fabric upgrade settings - Health polices</span></span>
<span data-ttu-id="6f254-222">U kunt opgeven om de gezondheid van aangepaste beleidsregels voor fabric-upgrade.</span><span class="sxs-lookup"><span data-stu-id="6f254-222">You can specify custom health polices for fabric upgrade.</span></span> <span data-ttu-id="6f254-223">Als u hebt uw cluster tooAutomatic fabric-upgrades ingesteld, krijgen deze beleidsregels toegepaste toohello fase 1 van Hallo automatische fabric-upgrades.</span><span class="sxs-lookup"><span data-stu-id="6f254-223">If you have set your cluster tooAutomatic fabric upgrades, then these policies get applied toohello Phase-1 of hello automatic fabric upgrades.</span></span>
<span data-ttu-id="6f254-224">Als u hebt ingesteld uw cluster voor handmatige fabric-upgrades en vervolgens deze beleidsregels telkens wanneer toegepast u een nieuwe versie activerende Hallo system tookick uitschakelen Hallo fabric-upgrade in uw cluster.</span><span class="sxs-lookup"><span data-stu-id="6f254-224">If you have set your cluster for Manual fabric upgrades, then these policies get applied each time you select a new version triggering hello system tookick off hello fabric upgrade in your cluster.</span></span> <span data-ttu-id="6f254-225">Als u Hallo beleidsregels niet overschrijven, Hallo standaardinstellingen gebruikt.</span><span class="sxs-lookup"><span data-stu-id="6f254-225">If you do not override hello policies, hello defaults are used.</span></span>

<span data-ttu-id="6f254-226">U kunt de aangepaste statusbeleid Hallo opgeven of bekijken voor de huidige instellingen Hallo onder Hallo 'fabric-upgrade' blade te selecteren Hallo geavanceerde instellingen voor de upgrade.</span><span class="sxs-lookup"><span data-stu-id="6f254-226">You can specify hello custom health policies or review hello current settings under hello "fabric upgrade" blade, by selecting hello advanced upgrade settings.</span></span> <span data-ttu-id="6f254-227">Hallo volgende afbeelding voor het bekijken.</span><span class="sxs-lookup"><span data-stu-id="6f254-227">Review hello following picture on how to.</span></span> 

![Aangepaste statusbeleid beheren][HealthPolices]

### <a name="customize-fabric-settings-for-your-cluster"></a><span data-ttu-id="6f254-229">Fabric-instellingen voor uw cluster aanpassen</span><span class="sxs-lookup"><span data-stu-id="6f254-229">Customize Fabric settings for your cluster</span></span>
<span data-ttu-id="6f254-230">Raadpleeg te[service fabric-clusterinstellingen fabric](service-fabric-cluster-fabric-settings.md) op wat en hoe u ze kunt aanpassen.</span><span class="sxs-lookup"><span data-stu-id="6f254-230">Refer too[service fabric cluster fabric settings](service-fabric-cluster-fabric-settings.md) on what and how you can customize them.</span></span>

### <a name="os-patches-on-hello-vms-that-make-up-hello-cluster"></a><span data-ttu-id="6f254-231">OS patches op Hallo van virtuele machines die gezamenlijk Hallo-cluster</span><span class="sxs-lookup"><span data-stu-id="6f254-231">OS patches on hello VMs that make up hello cluster</span></span>
<span data-ttu-id="6f254-232">Raadpleeg te[Patch Orchestration toepassing](service-fabric-patch-orchestration-application.md) die kan worden geïmplementeerd in uw cluster tooinstall patches via Windows Update op Hallo services beschikbaar houden alle Hallo tijd geregiseerde wijze.</span><span class="sxs-lookup"><span data-stu-id="6f254-232">Refer too[Patch Orchestration Application](service-fabric-patch-orchestration-application.md) which can be deployed on your cluster tooinstall patches from Windows Update in an orchestrated manner, keeping hello services available all hello time.</span></span> 

### <a name="os-upgrades-on-hello-vms-that-make-up-hello-cluster"></a><span data-ttu-id="6f254-233">Upgrades voor het besturingssysteem op virtuele machines die gezamenlijk Hallo cluster Hallo</span><span class="sxs-lookup"><span data-stu-id="6f254-233">OS upgrades on hello VMs that make up hello cluster</span></span>
<span data-ttu-id="6f254-234">Als u de installatiekopie van het besturingssysteem op Hallo virtuele machines van de cluster Hallo Hallo bijwerkt moet, moet u dit één VM doen op een tijdstip.</span><span class="sxs-lookup"><span data-stu-id="6f254-234">If you must upgrade hello OS image on hello virtual machines of hello cluster, you must do it one VM at a time.</span></span> <span data-ttu-id="6f254-235">U bent zelf verantwoordelijk voor deze upgrade--er is momenteel geen automation voor deze.</span><span class="sxs-lookup"><span data-stu-id="6f254-235">You are responsible for this upgrade--there is currently no automation for this.</span></span>

## <a name="next-steps"></a><span data-ttu-id="6f254-236">Volgende stappen</span><span class="sxs-lookup"><span data-stu-id="6f254-236">Next steps</span></span>
* <span data-ttu-id="6f254-237">Meer informatie over hoe toocustomize aantal Hallo [service fabric-clusterinstellingen fabric](service-fabric-cluster-fabric-settings.md)</span><span class="sxs-lookup"><span data-stu-id="6f254-237">Learn how toocustomize some of hello [service fabric cluster fabric settings](service-fabric-cluster-fabric-settings.md)</span></span>
* <span data-ttu-id="6f254-238">Meer informatie over hoe te[in en uit het cluster schalen](service-fabric-cluster-scale-up-down.md)</span><span class="sxs-lookup"><span data-stu-id="6f254-238">Learn how too[scale your cluster in and out](service-fabric-cluster-scale-up-down.md)</span></span>
* <span data-ttu-id="6f254-239">Meer informatie over [toepassingsupgrades](service-fabric-application-upgrade.md)</span><span class="sxs-lookup"><span data-stu-id="6f254-239">Learn about [application upgrades](service-fabric-application-upgrade.md)</span></span>

<!--Image references-->
[CertificateUpgrade]: ./media/service-fabric-cluster-upgrade/CertificateUpgrade2.png
[AddingProbes]: ./media/service-fabric-cluster-upgrade/addingProbes2.PNG
[AddingLBRules]: ./media/service-fabric-cluster-upgrade/addingLBRules.png
[HealthPolices]: ./media/service-fabric-cluster-upgrade/Manage_AutomodeWadvSettings.PNG
[ARMUpgradeMode]: ./media/service-fabric-cluster-upgrade/ARMUpgradeMode.PNG
[Create_Manualmode]: ./media/service-fabric-cluster-upgrade/Create_Manualmode.PNG
[Manage_Automaticmode]: ./media/service-fabric-cluster-upgrade/Manage_Automaticmode.PNG
