---
title: aaaTransactions en modi in Azure Service Fabric betrouwbare verzamelingen | Microsoft Docs
description: Azure Service Fabric betrouwbare status Manager en betrouwbare verzamelingen transacties en vergrendelen.
services: service-fabric
documentationcenter: .net
author: mcoskun
manager: timlt
editor: masnider,rajak
ms.assetid: 62857523-604b-434e-bd1c-2141ea4b00d1
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: required
ms.date: 5/1/2017
ms.author: mcoskun
ms.openlocfilehash: 340e029aa98f43ad6e46b48f687dad01f9d96f69
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 10/06/2017
---
# <a name="transactions-and-lock-modes-in-azure-service-fabric-reliable-collections"></a><span data-ttu-id="8ed0c-103">Transacties en -modi in Azure Service Fabric betrouwbare verzamelingen</span><span class="sxs-lookup"><span data-stu-id="8ed0c-103">Transactions and lock modes in Azure Service Fabric Reliable Collections</span></span>

## <a name="transaction"></a><span data-ttu-id="8ed0c-104">Transactie</span><span class="sxs-lookup"><span data-stu-id="8ed0c-104">Transaction</span></span>
<span data-ttu-id="8ed0c-105">Een transactie is een reeks bewerkingen die worden uitgevoerd als één logische eenheid van het werk.</span><span class="sxs-lookup"><span data-stu-id="8ed0c-105">A transaction is a sequence of operations performed as a single logical unit of work.</span></span>
<span data-ttu-id="8ed0c-106">Een transactie moet vertonen Hallo ACID-eigenschappen te volgen.</span><span class="sxs-lookup"><span data-stu-id="8ed0c-106">A transaction must exhibit hello following ACID properties.</span></span> <span data-ttu-id="8ed0c-107">(Zie: https://technet.microsoft.com/en-us/library/ms190612)</span><span class="sxs-lookup"><span data-stu-id="8ed0c-107">(see: https://technet.microsoft.com/en-us/library/ms190612)</span></span>
* <span data-ttu-id="8ed0c-108">**Atomisch**: een transactie moet een atomic-eenheid van het werk.</span><span class="sxs-lookup"><span data-stu-id="8ed0c-108">**Atomicity**: A transaction must be an atomic unit of work.</span></span> <span data-ttu-id="8ed0c-109">Met andere woorden, de gegevenswijzigingen worden uitgevoerd of geen van beide wordt uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="8ed0c-109">In other words, either all its data modifications are performed, or none of them is performed.</span></span>
* <span data-ttu-id="8ed0c-110">**Consistentie**: wanneer voltooid, een transactie moet laten staan alle gegevens in een consistente status.</span><span class="sxs-lookup"><span data-stu-id="8ed0c-110">**Consistency**: When completed, a transaction must leave all data in a consistent state.</span></span> <span data-ttu-id="8ed0c-111">Alle interne gegevensstructuren moet juist achter Hallo Hallo transactie.</span><span class="sxs-lookup"><span data-stu-id="8ed0c-111">All internal data structures must be correct at hello end of hello transaction.</span></span>
* <span data-ttu-id="8ed0c-112">**Isolatie**: wijzigingen aangebracht door gelijktijdige transacties worden geïsoleerd van Hallo-wijzigingen die zijn aangebracht door andere gelijktijdige transacties.</span><span class="sxs-lookup"><span data-stu-id="8ed0c-112">**Isolation**: Modifications made by concurrent transactions must be isolated from hello modifications made by any other concurrent transactions.</span></span> <span data-ttu-id="8ed0c-113">Hallo-isolatieniveau gebruikt voor een bewerking binnen een ITransaction wordt bepaald door Hallo IReliableState presterende Hallo-bewerking.</span><span class="sxs-lookup"><span data-stu-id="8ed0c-113">hello isolation level used for an operation within an ITransaction is determined by hello IReliableState performing hello operation.</span></span>
* <span data-ttu-id="8ed0c-114">**Duurzaamheid**: nadat een transactie is voltooid, de gevolgen ervan permanent aanwezig zijn in Hallo-systeem.</span><span class="sxs-lookup"><span data-stu-id="8ed0c-114">**Durability**: After a transaction has completed, its effects are permanently in place in hello system.</span></span> <span data-ttu-id="8ed0c-115">Hallo wijzigingen behouden blijven zelfs in geval van een systeemfout Hallo.</span><span class="sxs-lookup"><span data-stu-id="8ed0c-115">hello modifications persist even in hello event of a system failure.</span></span>

### <a name="isolation-levels"></a><span data-ttu-id="8ed0c-116">Isolatieniveaus</span><span class="sxs-lookup"><span data-stu-id="8ed0c-116">Isolation levels</span></span>
<span data-ttu-id="8ed0c-117">Isolatieniveau definieert Hallo mate toowhich Hallo transactie worden geïsoleerd van wijzigingen aangebracht door andere transacties.</span><span class="sxs-lookup"><span data-stu-id="8ed0c-117">Isolation level defines hello degree toowhich hello transaction must be isolated from modifications made by other transactions.</span></span>
<span data-ttu-id="8ed0c-118">Er zijn twee isolatieniveaus die worden ondersteund in betrouwbare verzamelingen:</span><span class="sxs-lookup"><span data-stu-id="8ed0c-118">There are two isolation levels that are supported in Reliable Collections:</span></span>

* <span data-ttu-id="8ed0c-119">**Herhaalbare leesbewerking**: Hiermee geeft u de instructies kunnen gegevens die zijn gewijzigd, maar nog niet zijn doorgevoerd door andere transacties worden gelezen en dat er geen andere transacties gegevens die is gelezen door de huidige transactie Hallo totdat de huidige Hallo kunnen wijzigen transactie is voltooid.</span><span class="sxs-lookup"><span data-stu-id="8ed0c-119">**Repeatable Read**: Specifies that statements cannot read data that has been modified but not yet committed by other transactions and that no other transactions can modify data that has been read by hello current transaction until hello current transaction finishes.</span></span> <span data-ttu-id="8ed0c-120">Zie voor meer informatie [https://msdn.microsoft.com/library/ms173763.aspx](https://msdn.microsoft.com/library/ms173763.aspx).</span><span class="sxs-lookup"><span data-stu-id="8ed0c-120">For more details, see [https://msdn.microsoft.com/library/ms173763.aspx](https://msdn.microsoft.com/library/ms173763.aspx).</span></span>
* <span data-ttu-id="8ed0c-121">**Momentopname**: geeft aan dat gegevens gelezen door een instructie in een transactie Hallo transactioneel consistent versie van Hallo-gegevens die beschikbaar op Hallo Hallo transactie is gestart waren.</span><span class="sxs-lookup"><span data-stu-id="8ed0c-121">**Snapshot**: Specifies that data read by any statement in a transaction is hello transactionally consistent version of hello data that existed at hello start of hello transaction.</span></span>
  <span data-ttu-id="8ed0c-122">Hallo transactie herkent alleen gegevenswijzigingen die zijn toegewezen voordat Hallo Hallo transactie is gestart.</span><span class="sxs-lookup"><span data-stu-id="8ed0c-122">hello transaction can recognize only data modifications that were committed before hello start of hello transaction.</span></span>
  <span data-ttu-id="8ed0c-123">Gegevenswijzigingen na Hallo starten van de huidige transactie Hallo aangebracht door andere transacties zijn niet zichtbaar toostatements wordt uitgevoerd in de huidige transactie Hallo.</span><span class="sxs-lookup"><span data-stu-id="8ed0c-123">Data modifications made by other transactions after hello start of hello current transaction are not visible toostatements executing in hello current transaction.</span></span>
  <span data-ttu-id="8ed0c-124">Hallo effect is als Hallo-instructies in een transactie ophalen van een momentopname van Hallo doorgevoerd gegevens zoals deze bestond op Hallo Hallo transactie is gestart.</span><span class="sxs-lookup"><span data-stu-id="8ed0c-124">hello effect is as if hello statements in a transaction get a snapshot of hello committed data as it existed at hello start of hello transaction.</span></span>
  <span data-ttu-id="8ed0c-125">Momentopnamen zijn consistent in betrouwbare verzamelingen.</span><span class="sxs-lookup"><span data-stu-id="8ed0c-125">Snapshots are consistent across Reliable Collections.</span></span>
  <span data-ttu-id="8ed0c-126">Zie voor meer informatie [https://msdn.microsoft.com/library/ms173763.aspx](https://msdn.microsoft.com/library/ms173763.aspx).</span><span class="sxs-lookup"><span data-stu-id="8ed0c-126">For more details, see [https://msdn.microsoft.com/library/ms173763.aspx](https://msdn.microsoft.com/library/ms173763.aspx).</span></span>

<span data-ttu-id="8ed0c-127">Betrouwbare verzamelingen kiezen automatisch Hallo isolatie niveau toouse voor een bepaalde leesbewerking afhankelijk van Hallo bewerking en Hallo-rol van Hallo replica Hallo gelijktijdig met het maken van de transactie.</span><span class="sxs-lookup"><span data-stu-id="8ed0c-127">Reliable Collections automatically choose hello isolation level toouse for a given read operation depending on hello operation and hello role of hello replica at hello time of transaction's creation.</span></span>
<span data-ttu-id="8ed0c-128">Hieronder volgt Hallo tabel ziet u standaardwaarden op siteniveau isolatie voor betrouwbare woordenlijst en wachtrij-bewerkingen.</span><span class="sxs-lookup"><span data-stu-id="8ed0c-128">Following is hello table that depicts isolation level defaults for Reliable Dictionary and Queue operations.</span></span>

| <span data-ttu-id="8ed0c-129">Bewerking \ rol</span><span class="sxs-lookup"><span data-stu-id="8ed0c-129">Operation \ Role</span></span> | <span data-ttu-id="8ed0c-130">Primair</span><span class="sxs-lookup"><span data-stu-id="8ed0c-130">Primary</span></span> | <span data-ttu-id="8ed0c-131">Secundair</span><span class="sxs-lookup"><span data-stu-id="8ed0c-131">Secondary</span></span> |
| --- |:--- |:--- |
| <span data-ttu-id="8ed0c-132">Één entiteit lezen</span><span class="sxs-lookup"><span data-stu-id="8ed0c-132">Single Entity Read</span></span> |<span data-ttu-id="8ed0c-133">Herhaalbare lezen</span><span class="sxs-lookup"><span data-stu-id="8ed0c-133">Repeatable Read</span></span> |<span data-ttu-id="8ed0c-134">Momentopname</span><span class="sxs-lookup"><span data-stu-id="8ed0c-134">Snapshot</span></span> |
| <span data-ttu-id="8ed0c-135">Opsomming, aantal</span><span class="sxs-lookup"><span data-stu-id="8ed0c-135">Enumeration, Count</span></span> |<span data-ttu-id="8ed0c-136">Momentopname</span><span class="sxs-lookup"><span data-stu-id="8ed0c-136">Snapshot</span></span> |<span data-ttu-id="8ed0c-137">Momentopname</span><span class="sxs-lookup"><span data-stu-id="8ed0c-137">Snapshot</span></span> |

> [!NOTE]
> <span data-ttu-id="8ed0c-138">Algemene voorbeelden voor één entiteit bewerkingen zijn `IReliableDictionary.TryGetValueAsync`, `IReliableQueue.TryPeekAsync`.</span><span class="sxs-lookup"><span data-stu-id="8ed0c-138">Common examples for Single Entity Operations are `IReliableDictionary.TryGetValueAsync`, `IReliableQueue.TryPeekAsync`.</span></span>
> 

<span data-ttu-id="8ed0c-139">Hallo betrouwbare woordenlijst zowel Hallo betrouwbare wachtrij ondersteuning voor lezen uw schrijft.</span><span class="sxs-lookup"><span data-stu-id="8ed0c-139">Both hello Reliable Dictionary and hello Reliable Queue support Read Your Writes.</span></span>
<span data-ttu-id="8ed0c-140">Met andere woorden, een schrijven binnen een transactie worden zichtbaar tooa volgende gelezen die toohello behoort dezelfde transactie.</span><span class="sxs-lookup"><span data-stu-id="8ed0c-140">In other words, any write within a transaction will be visible tooa following read that belongs toohello same transaction.</span></span>

## <a name="locks"></a><span data-ttu-id="8ed0c-141">Vergrendelingen</span><span class="sxs-lookup"><span data-stu-id="8ed0c-141">Locks</span></span>
<span data-ttu-id="8ed0c-142">In betrouwbare verzamelingen alle transacties implementeren strengere twee fase vergrendelen: een transactie komt niet vergrendelingen Hallo deze totdat Hallo transactie wordt beëindigd met een afbreking of een doorvoer heeft verkregen.</span><span class="sxs-lookup"><span data-stu-id="8ed0c-142">In Reliable Collections, all transactions implement rigorous two phase locking: a transaction does not release hello locks it has acquired until hello transaction terminates with either an abort or a commit.</span></span>

<span data-ttu-id="8ed0c-143">Betrouwbare woordenlijst gebruikt rijniveau vergrendelen voor alle bewerkingen van één entiteit.</span><span class="sxs-lookup"><span data-stu-id="8ed0c-143">Reliable Dictionary uses row level locking for all single entity operations.</span></span>
<span data-ttu-id="8ed0c-144">Betrouwbare wachtrij, ruilt gelijktijdigheid van taken voor strikte transactionele FIFO-eigenschap.</span><span class="sxs-lookup"><span data-stu-id="8ed0c-144">Reliable Queue trades off concurrency for strict transactional FIFO property.</span></span>
<span data-ttu-id="8ed0c-145">Betrouwbare wachtrij maakt gebruik van bewerking niveau vergrendelingen zodat één transactie met `TryPeekAsync` en/of `TryDequeueAsync` en één transactie met `EnqueueAsync` tegelijk.</span><span class="sxs-lookup"><span data-stu-id="8ed0c-145">Reliable Queue uses operation level locks allowing one transaction with `TryPeekAsync` and/or `TryDequeueAsync` and one transaction with `EnqueueAsync` at a time.</span></span>
<span data-ttu-id="8ed0c-146">Houd er rekening mee dat toopreserve FIFO, als een `TryPeekAsync` of `TryDequeueAsync` ooit toetsenbordinvoer dat Hallo betrouwbare wachtrij leeg is, wordt ook vergrendeld `EnqueueAsync`.</span><span class="sxs-lookup"><span data-stu-id="8ed0c-146">Note that toopreserve FIFO, if a `TryPeekAsync` or `TryDequeueAsync` ever observes that hello Reliable Queue is empty, they will also lock `EnqueueAsync`.</span></span>

<span data-ttu-id="8ed0c-147">Schrijven operations altijd exclusieve vergrendelingen overnemen.</span><span class="sxs-lookup"><span data-stu-id="8ed0c-147">Write operations always take Exclusive locks.</span></span>
<span data-ttu-id="8ed0c-148">Voor leesbewerkingen afhankelijk Hallo vergrendelen van een aantal factoren.</span><span class="sxs-lookup"><span data-stu-id="8ed0c-148">For read operations, hello locking depends on a couple of factors.</span></span>
<span data-ttu-id="8ed0c-149">Een leesbewerking uitgevoerd met behulp van Snapshot-isolatie is vergrendelingsvrije.</span><span class="sxs-lookup"><span data-stu-id="8ed0c-149">Any read operation done using Snapshot isolation is lock free.</span></span>
<span data-ttu-id="8ed0c-150">Een herhaalbare leesbewerking standaard duurt gedeelde vergrendelingen.</span><span class="sxs-lookup"><span data-stu-id="8ed0c-150">Any Repeatable Read operation by default takes Shared locks.</span></span>
<span data-ttu-id="8ed0c-151">Voor een leesbewerking die ondersteuning biedt voor herhaalbare leesbewerking wordt de gebruiker Hallo kunt vragen voor een vergrendeling Update in plaats van Hallo gedeelde vergrendeling.</span><span class="sxs-lookup"><span data-stu-id="8ed0c-151">However, for any read operation that supports Repeatable Read, hello user can ask for an Update lock instead of hello Shared lock.</span></span>
<span data-ttu-id="8ed0c-152">Een Update-vergrendeling is dat een asymmetrische vergrendeling gebruikt tooprevent een gemeenschappelijk model impasse dat zich voordoet wanneer meerdere transacties resources voor mogelijke updates op een later tijdstip vergrendelen.</span><span class="sxs-lookup"><span data-stu-id="8ed0c-152">An Update lock is an asymmetric lock used tooprevent a common form of deadlock that occurs when multiple transactions lock resources for potential updates at a later time.</span></span>

<span data-ttu-id="8ed0c-153">Hallo vergrendeling compatibiliteit matrix vindt u in de volgende tabel Hallo:</span><span class="sxs-lookup"><span data-stu-id="8ed0c-153">hello lock compatibility matrix can be found in hello following table:</span></span>

| <span data-ttu-id="8ed0c-154">Aanvragen \ verleend</span><span class="sxs-lookup"><span data-stu-id="8ed0c-154">Request \ Granted</span></span> | <span data-ttu-id="8ed0c-155">Geen</span><span class="sxs-lookup"><span data-stu-id="8ed0c-155">None</span></span> | <span data-ttu-id="8ed0c-156">Gedeeld</span><span class="sxs-lookup"><span data-stu-id="8ed0c-156">Shared</span></span> | <span data-ttu-id="8ed0c-157">Update</span><span class="sxs-lookup"><span data-stu-id="8ed0c-157">Update</span></span> | <span data-ttu-id="8ed0c-158">Exclusieve</span><span class="sxs-lookup"><span data-stu-id="8ed0c-158">Exclusive</span></span> |
| --- |:--- |:--- |:--- |:--- |
| <span data-ttu-id="8ed0c-159">Gedeeld</span><span class="sxs-lookup"><span data-stu-id="8ed0c-159">Shared</span></span> |<span data-ttu-id="8ed0c-160">Er is geen conflict</span><span class="sxs-lookup"><span data-stu-id="8ed0c-160">No conflict</span></span> |<span data-ttu-id="8ed0c-161">Er is geen conflict</span><span class="sxs-lookup"><span data-stu-id="8ed0c-161">No conflict</span></span> |<span data-ttu-id="8ed0c-162">Conflict</span><span class="sxs-lookup"><span data-stu-id="8ed0c-162">Conflict</span></span> |<span data-ttu-id="8ed0c-163">Conflict</span><span class="sxs-lookup"><span data-stu-id="8ed0c-163">Conflict</span></span> |
| <span data-ttu-id="8ed0c-164">Update</span><span class="sxs-lookup"><span data-stu-id="8ed0c-164">Update</span></span> |<span data-ttu-id="8ed0c-165">Er is geen conflict</span><span class="sxs-lookup"><span data-stu-id="8ed0c-165">No conflict</span></span> |<span data-ttu-id="8ed0c-166">Er is geen conflict</span><span class="sxs-lookup"><span data-stu-id="8ed0c-166">No conflict</span></span> |<span data-ttu-id="8ed0c-167">Conflict</span><span class="sxs-lookup"><span data-stu-id="8ed0c-167">Conflict</span></span> |<span data-ttu-id="8ed0c-168">Conflict</span><span class="sxs-lookup"><span data-stu-id="8ed0c-168">Conflict</span></span> |
| <span data-ttu-id="8ed0c-169">Exclusieve</span><span class="sxs-lookup"><span data-stu-id="8ed0c-169">Exclusive</span></span> |<span data-ttu-id="8ed0c-170">Er is geen conflict</span><span class="sxs-lookup"><span data-stu-id="8ed0c-170">No conflict</span></span> |<span data-ttu-id="8ed0c-171">Conflict</span><span class="sxs-lookup"><span data-stu-id="8ed0c-171">Conflict</span></span> |<span data-ttu-id="8ed0c-172">Conflict</span><span class="sxs-lookup"><span data-stu-id="8ed0c-172">Conflict</span></span> |<span data-ttu-id="8ed0c-173">Conflict</span><span class="sxs-lookup"><span data-stu-id="8ed0c-173">Conflict</span></span> |

<span data-ttu-id="8ed0c-174">Time-argument in Hallo betrouwbare verzamelingen-API's wordt gebruikt voor deadlock-detectie.</span><span class="sxs-lookup"><span data-stu-id="8ed0c-174">Time-out argument in hello Reliable Collections APIs is used for deadlock detection.</span></span>
<span data-ttu-id="8ed0c-175">Bijvoorbeeld twee transacties (T1 en T2) probeert tooread en K1 bijwerken.</span><span class="sxs-lookup"><span data-stu-id="8ed0c-175">For example, two transactions (T1 and T2) are trying tooread and update K1.</span></span>
<span data-ttu-id="8ed0c-176">Het is mogelijk dat zij toodeadlock, omdat ze beide vergrendeling Hallo hebben gedeeld.</span><span class="sxs-lookup"><span data-stu-id="8ed0c-176">It is possible for them toodeadlock, because they both end up having hello Shared lock.</span></span>
<span data-ttu-id="8ed0c-177">In dit geval wordt een of beide Hallo operations time-out.</span><span class="sxs-lookup"><span data-stu-id="8ed0c-177">In this case, one or both of hello operations will time out.</span></span>

<span data-ttu-id="8ed0c-178">Dit scenario impasse is een goed voorbeeld van hoe een vergrendeling Update impassen kunt voorkomen.</span><span class="sxs-lookup"><span data-stu-id="8ed0c-178">This deadlock scenario is a great example of how an Update lock can prevent deadlocks.</span></span>

## <a name="next-steps"></a><span data-ttu-id="8ed0c-179">Volgende stappen</span><span class="sxs-lookup"><span data-stu-id="8ed0c-179">Next steps</span></span>
* [<span data-ttu-id="8ed0c-180">Werken met betrouwbare verzamelingen</span><span class="sxs-lookup"><span data-stu-id="8ed0c-180">Working with Reliable Collections</span></span>](service-fabric-work-with-reliable-collections.md)
* [<span data-ttu-id="8ed0c-181">Betrouwbare Services meldingen</span><span class="sxs-lookup"><span data-stu-id="8ed0c-181">Reliable Services notifications</span></span>](service-fabric-reliable-services-notifications.md)
* [<span data-ttu-id="8ed0c-182">Betrouwbare Services back-up en herstel (herstel na noodgevallen)</span><span class="sxs-lookup"><span data-stu-id="8ed0c-182">Reliable Services backup and restore (disaster recovery)</span></span>](service-fabric-reliable-services-backup-restore.md)
* [<span data-ttu-id="8ed0c-183">Betrouwbaar status Manager-configuratie</span><span class="sxs-lookup"><span data-stu-id="8ed0c-183">Reliable State Manager configuration</span></span>](service-fabric-reliable-services-configuration.md)
* [<span data-ttu-id="8ed0c-184">Referentie voor ontwikkelaars voor betrouwbare verzamelingen</span><span class="sxs-lookup"><span data-stu-id="8ed0c-184">Developer reference for Reliable Collections</span></span>](https://msdn.microsoft.com/library/azure/microsoft.servicefabric.data.collections.aspx)

