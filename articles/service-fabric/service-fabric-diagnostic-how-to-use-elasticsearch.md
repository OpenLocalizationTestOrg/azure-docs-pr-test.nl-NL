---
title: aaaUsing Elasticsearch als een Service Fabric-toepassingsarchief trace | Microsoft Docs
description: Beschrijft hoe Service Fabric-toepassingen kunnen gebruiken Elasticsearch en Kibana toostore, index en zoekmogelijkheid via toepassingstraceringen (Logboeken)
services: service-fabric
documentationcenter: .net
author: karolz-ms
manager: adegeo
editor: 
ms.assetid: e59b0c39-e468-4d9e-b453-d5f2a8ad20d8
ms.service: service-fabric
ms.devlang: dotNet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 04/07/2017
ms.author: karolz@microsoft.com
redirect_url: /azure/service-fabric/service-fabric-diagnostics-event-aggregation-eventflow
ms.openlocfilehash: b5977c54e69319e3caa376e44a02f971b66a3254
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 10/06/2017
---
# <a name="use-elasticsearch-as-a-service-fabric-application-trace-store"></a><span data-ttu-id="c2dbc-103">Gebruik Elasticsearch als een tracering van de Service Fabric-toepassing opslaan</span><span class="sxs-lookup"><span data-stu-id="c2dbc-103">Use Elasticsearch as a Service Fabric application trace store</span></span>
## <a name="introduction"></a><span data-ttu-id="c2dbc-104">Inleiding</span><span class="sxs-lookup"><span data-stu-id="c2dbc-104">Introduction</span></span>
<span data-ttu-id="c2dbc-105">Dit artikel wordt beschreven hoe [Azure Service Fabric](https://azure.microsoft.com/documentation/services/service-fabric/) toepassingen kunnen gebruikmaken van **Elasticsearch** en **Kibana** voor opslag voor servertoepassingen trace indexeren en zoeken.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-105">This article describes how [Azure Service Fabric](https://azure.microsoft.com/documentation/services/service-fabric/) applications can use **Elasticsearch** and **Kibana** for application trace storage, indexing, and search.</span></span> <span data-ttu-id="c2dbc-106">[Elasticsearch](https://www.elastic.co/guide/index.html) is een open source, gedistribueerde en schaalbare realtime zoekresultaten en analyse-engine die geschikt zijn voor deze taak.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-106">[Elasticsearch](https://www.elastic.co/guide/index.html) is an open-source, distributed, and scalable real-time search and analytics engine that is well-suited for this task.</span></span> <span data-ttu-id="c2dbc-107">Deze kan worden geïnstalleerd op Windows- en Linux virtuele machines in Microsoft Azure wordt uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-107">It can be installed on Windows and Linux virtual machines running in Microsoft Azure.</span></span> <span data-ttu-id="c2dbc-108">Elasticsearch kan efficiënt verwerken *gestructureerde* traceringen geproduceerd met behulp van technologieën zoals **Event Tracing voor Windows (ETW)**.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-108">Elasticsearch can efficiently process *structured* traces produced using technologies such as **Event Tracing for Windows (ETW)**.</span></span>

<span data-ttu-id="c2dbc-109">ETW wordt gebruikt door de Service Fabric-runtime toosource diagnostische gegevens (traceringen).</span><span class="sxs-lookup"><span data-stu-id="c2dbc-109">ETW is used by Service Fabric runtime toosource diagnostic information (traces).</span></span> <span data-ttu-id="c2dbc-110">Is Hallo aanbevolen methode voor het Service Fabric-toepassingen toosource hun diagnostische gegevens te.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-110">It is hello recommended method for Service Fabric applications toosource their diagnostic information, too.</span></span> <span data-ttu-id="c2dbc-111">Met behulp van hetzelfde mechanisme voor correlatie tussen runtime verstrekt en toepassing opgegeven traceringen, en wordt probleemoplossing eenvoudiger kunt Hallo.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-111">Using hello same mechanism allows for correlation between runtime-supplied and application-supplied traces and makes troubleshooting easier.</span></span> <span data-ttu-id="c2dbc-112">Sjablonen voor service Fabric-project in Visual Studio een logboekregistratie API opnemen (op basis van Hallo .NET **EventSource** klasse) die ETW traceringen standaard verzendt.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-112">Service Fabric project templates in Visual Studio include a logging API (based on hello .NET **EventSource** class) that emits ETW traces by default.</span></span> <span data-ttu-id="c2dbc-113">Voor een algemeen overzicht van Service Fabric-toepassing voor het traceren met behulp van ETW, Zie [controle en diagnose van services in de instellingen voor een lokale computer ontwikkeling](service-fabric-diagnostics-how-to-monitor-and-diagnose-services-locally.md).</span><span class="sxs-lookup"><span data-stu-id="c2dbc-113">For a general overview of Service Fabric application tracing using ETW, see [Monitoring and diagnosing services in a local machine development setup](service-fabric-diagnostics-how-to-monitor-and-diagnose-services-locally.md).</span></span>

<span data-ttu-id="c2dbc-114">Voor Hallo traceringen tooshow omhoog in Elasticsearch moeten ze toobe vastgelegd op Hallo Service Fabric clusterknooppunten in realtime (tijdens het Hallo-toepassing wordt uitgevoerd) en tooan Elasticsearch eindpunt verzonden.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-114">For hello traces tooshow up in Elasticsearch, they need toobe captured at hello Service Fabric cluster nodes in real time (while hello application is running) and sent tooan Elasticsearch endpoint.</span></span> <span data-ttu-id="c2dbc-115">Er zijn twee belangrijke opties voor het vastleggen van trace:</span><span class="sxs-lookup"><span data-stu-id="c2dbc-115">There are two major options for trace capturing:</span></span>

* <span data-ttu-id="c2dbc-116">**Proces trace vastleggen**</span><span class="sxs-lookup"><span data-stu-id="c2dbc-116">**In-process trace capturing**</span></span>  
  <span data-ttu-id="c2dbc-117">Hallo toepassings- of preciezer, serviceproces is verantwoordelijk voor het verzenden van Hallo diagnostische gegevens toohello trace store (Elasticsearch).</span><span class="sxs-lookup"><span data-stu-id="c2dbc-117">hello application, or more precisely, service process, is responsible for sending out hello diagnostic data toohello trace store (Elasticsearch).</span></span>
* <span data-ttu-id="c2dbc-118">**Out of process-trace vastleggen**</span><span class="sxs-lookup"><span data-stu-id="c2dbc-118">**Out-of-process trace capturing**</span></span>  
  <span data-ttu-id="c2dbc-119">Een afzonderlijke agent is het vastleggen van traces van serviceproces Hallo of processen en ze toohello trace store te sturen.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-119">A separate agent is capturing traces from hello service process or processes and sending them toohello trace store.</span></span>

<span data-ttu-id="c2dbc-120">Hierna beschreven hoe tooset up Elasticsearch in Azure, bespreken Hallo-professionals en nadelen voor beide opties vastleggen en wordt uitgelegd hoe een Service Fabric tooconfigure toosend gegevens tooElasticsearch service.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-120">Below, we describe how tooset up Elasticsearch on Azure, discuss hello pros and cons for both capture options, and explain how tooconfigure a Service Fabric service toosend data tooElasticsearch.</span></span>

## <a name="set-up-elasticsearch-on-azure"></a><span data-ttu-id="c2dbc-121">Instellen van Elasticsearch op Azure</span><span class="sxs-lookup"><span data-stu-id="c2dbc-121">Set up Elasticsearch on Azure</span></span>
<span data-ttu-id="c2dbc-122">Hallo meest directe manier tooset hello Elasticsearch service in Azure is via [ **Azure Resource Manager-sjablonen**](../azure-resource-manager/resource-group-overview.md).</span><span class="sxs-lookup"><span data-stu-id="c2dbc-122">hello most straightforward way tooset up hello Elasticsearch service on Azure is through [**Azure Resource Manager templates**](../azure-resource-manager/resource-group-overview.md).</span></span> <span data-ttu-id="c2dbc-123">Een uitgebreide [Quick Start Azure Resource Manager-sjabloon voor Elasticsearch](https://github.com/Azure/azure-quickstart-templates/tree/master/elasticsearch) is beschikbaar via de Azure Quickstart-opslagplaats voor sjablonen.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-123">A comprehensive [Quickstart Azure Resource Manager template for Elasticsearch](https://github.com/Azure/azure-quickstart-templates/tree/master/elasticsearch) is available from Azure Quickstart templates repository.</span></span> <span data-ttu-id="c2dbc-124">Deze sjabloon maakt gebruik van afzonderlijke storage-accounts voor schaaleenheden (groepen van knooppunten).</span><span class="sxs-lookup"><span data-stu-id="c2dbc-124">This template uses separate storage accounts for scale units (groups of nodes).</span></span> <span data-ttu-id="c2dbc-125">Deze kan ook afzonderlijke client en serverknooppunten met verschillende configuraties en verschillende aantallen gegevensschijven gekoppeld inrichten.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-125">It can also provision separate client and server nodes with different configurations and various numbers of data disks attached.</span></span>

<span data-ttu-id="c2dbc-126">Hier, gebruiken we een andere sjabloon, de zogeheten **ES MultiNode** van Hallo [Azure diagnostische hulpprogramma's voor opslagplaats](https://github.com/Azure/azure-diagnostics-tools).</span><span class="sxs-lookup"><span data-stu-id="c2dbc-126">Here, we use another template, called **ES-MultiNode** from hello [Azure diagnostic tools repository](https://github.com/Azure/azure-diagnostics-tools).</span></span> <span data-ttu-id="c2dbc-127">Deze sjabloon is eenvoudiger toouse en een beveiligd door HTTP basisverificatie Elasticsearch-cluster wordt gemaakt.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-127">This template is easier toouse, and it creates an Elasticsearch cluster protected by HTTP basic authentication.</span></span> <span data-ttu-id="c2dbc-128">Voordat u doorgaat, downloaden Hallo opslagplaats GitHub tooyour machine (met de Hallo opslagplaats klonen of downloaden van een zipbestand).</span><span class="sxs-lookup"><span data-stu-id="c2dbc-128">Before you proceed, download hello repository from GitHub tooyour machine (by either cloning hello repository or downloading a zip file).</span></span> <span data-ttu-id="c2dbc-129">Hallo ES MultiNode sjabloon bevindt zich in de map Hallo Hello dezelfde naam.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-129">hello ES-MultiNode template is located in hello folder with hello same name.</span></span>

### <a name="prepare-a-machine-toorun-elasticsearch-installation-scripts"></a><span data-ttu-id="c2dbc-130">Voorbereiden van een machine toorun Elasticsearch installatiescripts</span><span class="sxs-lookup"><span data-stu-id="c2dbc-130">Prepare a machine toorun Elasticsearch installation scripts</span></span>
<span data-ttu-id="c2dbc-131">Hallo gemakkelijkste manier toouse Hallo ES MultiNode sjabloon is via een opgegeven Azure PowerShell-script aangeroepen `CreateElasticSearchCluster`.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-131">hello easiest way toouse hello ES-MultiNode template is through a provided Azure PowerShell script called `CreateElasticSearchCluster`.</span></span> <span data-ttu-id="c2dbc-132">toouse dit script, moet u tooinstall PowerShell-modules en hulpprogramma **openssl**.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-132">toouse this script, you need tooinstall PowerShell modules and a tool called **openssl**.</span></span> <span data-ttu-id="c2dbc-133">Hallo laatstgenoemde is nodig voor het maken van een SSH-sleutel die gebruikt tooadminister worden kan uw cluster Elasticsearch op afstand.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-133">hello latter is needed for creating an SSH key that can be used tooadminister your Elasticsearch cluster remotely.</span></span>

<span data-ttu-id="c2dbc-134">`CreateElasticSearchCluster`script is ontworpen voor gebruiksgemak Hallo ES MultiNode sjabloon van een Windows-machine.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-134">`CreateElasticSearchCluster` script is designed for ease of use with hello ES-MultiNode template from a Windows machine.</span></span> <span data-ttu-id="c2dbc-135">Het is mogelijk toouse Hallo sjabloon op een niet-Windows-machine, maar in dit scenario ligt buiten bereik Hallo van dit artikel.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-135">It is possible toouse hello template on a non-Windows machine, but that scenario is beyond hello scope of this article.</span></span>

1. <span data-ttu-id="c2dbc-136">Als u dit nog niet hebt ze al hebt geïnstalleerd, installeert u [ **Azure PowerShell-modules**](http://aka.ms/webpi-azps).</span><span class="sxs-lookup"><span data-stu-id="c2dbc-136">If you haven't installed them already, install [**Azure PowerShell modules**](http://aka.ms/webpi-azps).</span></span> <span data-ttu-id="c2dbc-137">Wanneer u wordt gevraagd, klikt u op **uitvoeren**, klikt u vervolgens **installeren**.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-137">When prompted, click **Run**, then **Install**.</span></span> <span data-ttu-id="c2dbc-138">Azure PowerShell 1.3 of hoger is vereist.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-138">Azure PowerShell 1.3 or newer is required.</span></span>
2. <span data-ttu-id="c2dbc-139">Hallo **openssl** hulpprogramma is opgenomen in de distributie van Hallo [ **Git voor Windows**](http://www.git-scm.com/downloads).</span><span class="sxs-lookup"><span data-stu-id="c2dbc-139">hello **openssl** tool is included in hello distribution of [**Git for Windows**](http://www.git-scm.com/downloads).</span></span> <span data-ttu-id="c2dbc-140">Als u dit nog niet hebt gedaan, installeert u [Git voor Windows](http://www.git-scm.com/downloads) nu.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-140">If you have not done so already, install [Git for Windows](http://www.git-scm.com/downloads) now.</span></span> <span data-ttu-id="c2dbc-141">(Hallo standaard installatieopties zijn OK).</span><span class="sxs-lookup"><span data-stu-id="c2dbc-141">(hello default installation options are OK.)</span></span>
3. <span data-ttu-id="c2dbc-142">Ervan uitgaande dat Git is geïnstalleerd maar niet zijn opgenomen in het systeempad hello, een Microsoft Azure PowerShell-venster openen en Voer Hallo volgende opdrachten uit:</span><span class="sxs-lookup"><span data-stu-id="c2dbc-142">Assuming that Git has been installed but not included in hello system path, open a Microsoft Azure PowerShell window and run hello following commands:</span></span>
   
    ```powershell
    $ENV:PATH += ";<Git installation folder>\usr\bin"
    $ENV:OPENSSL_CONF = "<Git installation folder>\usr\ssl\openssl.cnf"
    ```
   
    <span data-ttu-id="c2dbc-143">Vervang Hallo `<Git installation folder>` met Git-locatie op uw computer; Hallo Hallo standaardwaarde is **'C:\Program Files\Git'**.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-143">Replace hello `<Git installation folder>` with hello Git location on your machine; hello default is **"C:\Program Files\Git"**.</span></span> <span data-ttu-id="c2dbc-144">Houd er rekening mee Hallo puntkomma aan Hallo begin van de eerste Hallo-pad.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-144">Note hello semicolon character at hello beginning of hello first path.</span></span>
4. <span data-ttu-id="c2dbc-145">Zorg ervoor dat u bent aangemeld op tooAzure (via [ `Add-AzureRmAccount` ](https://msdn.microsoft.com/library/mt619267.aspx) cmdlet) en toocreate uw cluster elastische zoeken die u hebt geselecteerd dat Hallo-abonnement dat moet worden gebruikt.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-145">Ensure that you are logged on tooAzure (via [`Add-AzureRmAccount`](https://msdn.microsoft.com/library/mt619267.aspx) cmdlet) and that you have selected hello subscription that should be used toocreate your Elastic Search cluster.</span></span> <span data-ttu-id="c2dbc-146">U kunt controleren of het juiste abonnement is geselecteerd met `Get-AzureRmContext` en `Get-AzureRmSubscription` cmdlets.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-146">You can verify that correct subscription is selected using `Get-AzureRmContext` and `Get-AzureRmSubscription` cmdlets.</span></span>
5. <span data-ttu-id="c2dbc-147">Als u dit nog niet hebt gedaan, wijzigt u Hallo huidige toohello ES MultiNode map.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-147">If you haven't done so already, change hello current directory toohello ES-MultiNode folder.</span></span>

### <a name="run-hello-createelasticsearchcluster-script"></a><span data-ttu-id="c2dbc-148">Hallo CreateElasticSearchCluster script uitvoeren</span><span class="sxs-lookup"><span data-stu-id="c2dbc-148">Run hello CreateElasticSearchCluster script</span></span>
<span data-ttu-id="c2dbc-149">Voordat u Hallo script uitvoert, open Hallo `azuredeploy-parameters.json` bestand en controleer of geef waarden op voor de scriptparameters Hallo.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-149">Before you run hello script, open hello `azuredeploy-parameters.json` file and verify or provide values for hello script parameters.</span></span> <span data-ttu-id="c2dbc-150">Hallo volgende parameters zijn beschikbaar:</span><span class="sxs-lookup"><span data-stu-id="c2dbc-150">hello following parameters are provided:</span></span>

| <span data-ttu-id="c2dbc-151">Parameternaam</span><span class="sxs-lookup"><span data-stu-id="c2dbc-151">Parameter Name</span></span> | <span data-ttu-id="c2dbc-152">Beschrijving</span><span class="sxs-lookup"><span data-stu-id="c2dbc-152">Description</span></span> |
| --- | --- |
| <span data-ttu-id="c2dbc-153">dnsNameForLoadBalancerIP</span><span class="sxs-lookup"><span data-stu-id="c2dbc-153">dnsNameForLoadBalancerIP</span></span> |<span data-ttu-id="c2dbc-154">Hallo-naam die is gebruikt toocreate Hallo openbaar zichtbaar DNS-naam voor Hallo elastische zoeken cluster (door toe te voegen hello Azure-regio toohello opgegeven domeinnaam).</span><span class="sxs-lookup"><span data-stu-id="c2dbc-154">hello name that is used toocreate hello publicly visible DNS name for hello Elastic Search cluster (by appending hello Azure region domain toohello provided name).</span></span> <span data-ttu-id="c2dbc-155">Als deze parameterwaarde is 'myBigCluster' Hallo gekozen Azure-regio VS-West is, is Hallo resulterende DNS-naam voor de cluster Hallo myBigCluster.westus.cloudapp.azure.com.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-155">For example, if this parameter value is "myBigCluster" and hello chosen Azure region is West US, hello resulting DNS name for hello cluster is myBigCluster.westus.cloudapp.azure.com.</span></span> <br /><br /><span data-ttu-id="c2dbc-156">Deze naam fungeert ook als de naam van een basis voor veel artefacten die zijn gekoppeld aan Hallo elastische zoeken cluster, zoals gegevens knooppuntnamen.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-156">This name also serves as a root name for many artifacts associated with hello Elastic Search cluster, such as data node names.</span></span> |
| <span data-ttu-id="c2dbc-157">adminUsername</span><span class="sxs-lookup"><span data-stu-id="c2dbc-157">adminUsername</span></span> |<span data-ttu-id="c2dbc-158">Hallo-naam van Hallo administrator-account voor het beheren van Hallo elastische zoeken cluster (bijbehorende SSH-sleutels worden automatisch gegenereerd).</span><span class="sxs-lookup"><span data-stu-id="c2dbc-158">hello name of hello administrator account for managing hello Elastic Search cluster (corresponding SSH keys are generated automatically).</span></span> |
| <span data-ttu-id="c2dbc-159">dataNodeCount</span><span class="sxs-lookup"><span data-stu-id="c2dbc-159">dataNodeCount</span></span> |<span data-ttu-id="c2dbc-160">Hallo aantal knooppunten in cluster van Hallo elastische zoeken.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-160">hello number of nodes in hello Elastic Search cluster.</span></span> <span data-ttu-id="c2dbc-161">huidige versie van script Hallo Hallo maakt geen onderscheid tussen knooppunten, gegevens en de query. alle knooppunten afspelen beide rollen.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-161">hello current version of hello script does not distinguish between data and query nodes; all nodes play both roles.</span></span> <span data-ttu-id="c2dbc-162">Standaardwaarden too3 knooppunten.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-162">Defaults too3 nodes.</span></span> |
| <span data-ttu-id="c2dbc-163">dataDiskSize</span><span class="sxs-lookup"><span data-stu-id="c2dbc-163">dataDiskSize</span></span> |<span data-ttu-id="c2dbc-164">Hallo grootte van gegevensschijven (in GB) die voor elk gegevensknooppunt is toegewezen.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-164">hello size of data disks (in GB) that is allocated for each data node.</span></span> <span data-ttu-id="c2dbc-165">Elk knooppunt ontvangt 4 gegevensschijven, exclusief toegewezen tooElastic Search-service.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-165">Each node receives 4 data disks, exclusively dedicated tooElastic Search service.</span></span> |
| <span data-ttu-id="c2dbc-166">Regio</span><span class="sxs-lookup"><span data-stu-id="c2dbc-166">region</span></span> |<span data-ttu-id="c2dbc-167">Hallo-naam van de Azure-regio waar Hallo elastische zoeken cluster moet zich bevinden.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-167">hello name of Azure region where hello Elastic Search cluster should be located.</span></span> |
| <span data-ttu-id="c2dbc-168">esUserName</span><span class="sxs-lookup"><span data-stu-id="c2dbc-168">esUserName</span></span> |<span data-ttu-id="c2dbc-169">Hallo gebruikersnaam van Hallo-gebruiker die is geconfigureerd toohave toegang tooES cluster (onderwerp tooHTTP basisverificatie).</span><span class="sxs-lookup"><span data-stu-id="c2dbc-169">hello user name of hello user that is configured toohave access tooES cluster (subject tooHTTP basic authentication).</span></span> <span data-ttu-id="c2dbc-170">Hallo wachtwoord maakt geen deel uit van parameterbestand en moet worden opgegeven wanneer `CreateElasticSearchCluster` script wordt aangeroepen.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-170">hello password is not part of parameters file and must be provided when `CreateElasticSearchCluster` script is invoked.</span></span> |
| <span data-ttu-id="c2dbc-171">vmSizeDataNodes</span><span class="sxs-lookup"><span data-stu-id="c2dbc-171">vmSizeDataNodes</span></span> |<span data-ttu-id="c2dbc-172">Hallo grootte van de virtuele machine van Azure voor de clusterknooppunten elastische zoeken.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-172">hello Azure virtual machine size for Elastic Search cluster nodes.</span></span> <span data-ttu-id="c2dbc-173">Standaardwaarden tooStandard_D2.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-173">Defaults tooStandard_D2.</span></span> |

<span data-ttu-id="c2dbc-174">U bent nu klaar toorun Hallo script.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-174">Now you are ready toorun hello script.</span></span> <span data-ttu-id="c2dbc-175">Probleem Hallo volgende opdracht:</span><span class="sxs-lookup"><span data-stu-id="c2dbc-175">Issue hello following command:</span></span>

```powershell
CreateElasticSearchCluster -ResourceGroupName <es-group-name> -Region <azure-region> -EsPassword <es-password>
```

<span data-ttu-id="c2dbc-176">waar</span><span class="sxs-lookup"><span data-stu-id="c2dbc-176">where</span></span> 

| <span data-ttu-id="c2dbc-177">De parameternaam script</span><span class="sxs-lookup"><span data-stu-id="c2dbc-177">Script Parameter Name</span></span> | <span data-ttu-id="c2dbc-178">Beschrijving</span><span class="sxs-lookup"><span data-stu-id="c2dbc-178">Description</span></span> |
| --- | --- |
| `<es-group-name>` |<span data-ttu-id="c2dbc-179">Hallo-naam van hello Azure-resourcegroep die alle resources van elastische zoeken cluster bevat.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-179">hello name of hello Azure resource group that will contain all Elastic Search cluster resources.</span></span> |
| `<azure-region>` |<span data-ttu-id="c2dbc-180">Hallo-naam van hello Azure-regio waar Hallo elastische zoeken cluster moet worden gemaakt.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-180">hello name of hello Azure region where hello Elastic Search cluster should be created.</span></span> |
| `<es-password>` |<span data-ttu-id="c2dbc-181">Hallo-wachtwoord voor gebruiker Hallo-elastische zoeken.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-181">hello password for hello Elastic Search user.</span></span> |

> [!NOTE]
> <span data-ttu-id="c2dbc-182">Als u een NullReferenceException van de cmdlet Test-AzureResourceGroup hello krijgt, hebt u toolog op tooAzure vergeten (`Add-AzureRmAccount`).</span><span class="sxs-lookup"><span data-stu-id="c2dbc-182">If you get a NullReferenceException from hello Test-AzureResourceGroup cmdlet, you have forgotten toolog on tooAzure (`Add-AzureRmAccount`).</span></span>
> 
> 

<span data-ttu-id="c2dbc-183">Als u een fout krijgt van het Hallo-script wordt uitgevoerd en u bepalen dat Hallo-fout is veroorzaakt door een onjuiste sjabloon parameterwaarde, Hallo parameterbestand corrigeren en Hallo script opnieuw uitgevoerd met een andere Resourcegroepnaam in.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-183">If you get an error from running hello script and you determine that hello error was caused by a wrong template parameter value, correct hello parameter file and run hello script again with a different resource group name.</span></span> <span data-ttu-id="c2dbc-184">U kunt ook opnieuw gebruiken dezelfde Resourcegroepnaam Hallo en Hallo script opschonen Hallo oude hebben door toe te voegen Hallo `-RemoveExistingResourceGroup` parameter toohello script aanroepen.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-184">You can also reuse hello same resource group name and have hello script clean up hello old one by adding hello `-RemoveExistingResourceGroup` parameter toohello script invocation.</span></span>

### <a name="result-of-running-hello-createelasticsearchcluster-script"></a><span data-ttu-id="c2dbc-185">Resultaat van het Hallo CreateElasticSearchCluster script uitvoeren</span><span class="sxs-lookup"><span data-stu-id="c2dbc-185">Result of running hello CreateElasticSearchCluster script</span></span>
<span data-ttu-id="c2dbc-186">Na het uitvoeren van Hallo `CreateElasticSearchCluster` script, volgen de belangrijkste artefacten hello wordt gemaakt.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-186">After you run hello `CreateElasticSearchCluster` script, hello following main artifacts will be created.</span></span> <span data-ttu-id="c2dbc-187">In dit voorbeeld gaan we ervan uit dat u 'myBigCluster' hebt gebruikt als de waarde Hallo Hallo `dnsNameForLoadBalancerIP` parameter en dat Hallo-regio waar u Hallo-cluster gemaakt is VS-West.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-187">For this example we assume that you have used "myBigCluster" as hello value of hello `dnsNameForLoadBalancerIP` parameter and that hello region where you created hello cluster is West US.</span></span>

| <span data-ttu-id="c2dbc-188">Artefacten</span><span class="sxs-lookup"><span data-stu-id="c2dbc-188">Artifact</span></span> | <span data-ttu-id="c2dbc-189">De naam, locatie en opmerkingen</span><span class="sxs-lookup"><span data-stu-id="c2dbc-189">Name, location, and remarks</span></span> |
| --- | --- |
| <span data-ttu-id="c2dbc-190">SSH-sleutel voor extern beheer</span><span class="sxs-lookup"><span data-stu-id="c2dbc-190">SSH key for remote administration</span></span> |<span data-ttu-id="c2dbc-191">myBigCluster.key-bestand (in de map Hallo van welke Hallo CreateElasticSearchCluster wordt uitgevoerd).</span><span class="sxs-lookup"><span data-stu-id="c2dbc-191">myBigCluster.key file (in hello directory from which hello CreateElasticSearchCluster was run).</span></span> <br /><br /><span data-ttu-id="c2dbc-192">Bestand met deze sleutel kan worden gebruikt tooconnect toohello admin knooppunt en (via Hallo beheerder knooppunt) toodata knooppunten in Hallo-cluster.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-192">This key file can be used tooconnect toohello admin node and (through hello admin node) toodata nodes in hello cluster.</span></span> |
| <span data-ttu-id="c2dbc-193">Admin-knooppunt</span><span class="sxs-lookup"><span data-stu-id="c2dbc-193">Admin node</span></span> |<span data-ttu-id="c2dbc-194">myBigCluster admin.westus.cloudapp.azure.com</span><span class="sxs-lookup"><span data-stu-id="c2dbc-194">myBigCluster-admin.westus.cloudapp.azure.com</span></span> <br /><br /><span data-ttu-id="c2dbc-195">Een speciale virtuele machine voor extern beheer van het cluster voor Elasticsearch--Hallo slechts één waarmee externe SSH-verbindingen.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-195">A dedicated VM for remote Elasticsearch cluster administration--hello only one that allows external SSH connections.</span></span> <span data-ttu-id="c2dbc-196">Deze wordt uitgevoerd op Hallo hetzelfde virtuele netwerk als alle clusterknooppunten van Hallo Elasticsearch, maar biedt niet alle Elasticsearch-services worden uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-196">It runs on hello same virtual network as all hello Elasticsearch cluster nodes, but it does not run any Elasticsearch services.</span></span> |
| <span data-ttu-id="c2dbc-197">Gegevensknooppunten</span><span class="sxs-lookup"><span data-stu-id="c2dbc-197">Data nodes</span></span> |<span data-ttu-id="c2dbc-198">myBigCluster1...</span><span class="sxs-lookup"><span data-stu-id="c2dbc-198">myBigCluster1 …</span></span> <span data-ttu-id="c2dbc-199">myBigCluster*N*</span><span class="sxs-lookup"><span data-stu-id="c2dbc-199">myBigCluster*N*</span></span> <br /><br /><span data-ttu-id="c2dbc-200">Van gegevensknooppunten die fungeren als Elasticsearch en Kibana services worden uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-200">Data nodes that are running Elasticsearch and Kibana services.</span></span> <span data-ttu-id="c2dbc-201">U kunt verbinding maken via SSH tooeach knooppunt, maar alleen via Hallo beheerder knooppunt.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-201">You can connect via SSH tooeach node, but only via hello admin node.</span></span> |
| <span data-ttu-id="c2dbc-202">Elasticsearch cluster</span><span class="sxs-lookup"><span data-stu-id="c2dbc-202">Elasticsearch cluster</span></span> |<span data-ttu-id="c2dbc-203">http://myBigCluster.westus.cloudapp.Azure.com/ES/</span><span class="sxs-lookup"><span data-stu-id="c2dbc-203">http://myBigCluster.westus.cloudapp.azure.com/es/</span></span> <br /><br /><span data-ttu-id="c2dbc-204">Hallo primaire eindpunt voor Hallo Elasticsearch cluster (Opmerking Hallo /es achtervoegsel).</span><span class="sxs-lookup"><span data-stu-id="c2dbc-204">hello primary endpoint for hello Elasticsearch cluster (note hello /es suffix).</span></span> <span data-ttu-id="c2dbc-205">Het is beveiligd met een eenvoudige HTTP-verificatie (Hallo referenties werden Hallo esUserName/esPassword parameters van de sjabloon Hallo ES MultiNode opgegeven).</span><span class="sxs-lookup"><span data-stu-id="c2dbc-205">It is protected by basic HTTP authentication (hello credentials were hello specified esUserName/esPassword parameters of hello ES-MultiNode template).</span></span> <span data-ttu-id="c2dbc-206">Hallo-cluster heeft ook Hallo head invoegtoepassing geïnstalleerd (http://myBigCluster.westus.cloudapp.azure.com/es/_plugin/head) voor het beheer van basiscluster.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-206">hello cluster has also hello head plug-in installed (http://myBigCluster.westus.cloudapp.azure.com/es/_plugin/head) for basic cluster administration.</span></span> |
| <span data-ttu-id="c2dbc-207">Kibana-service</span><span class="sxs-lookup"><span data-stu-id="c2dbc-207">Kibana service</span></span> |<span data-ttu-id="c2dbc-208">http://myBigCluster.westus.cloudapp.Azure.com</span><span class="sxs-lookup"><span data-stu-id="c2dbc-208">http://myBigCluster.westus.cloudapp.azure.com</span></span> <br /><br /><span data-ttu-id="c2dbc-209">Hallo Kibana-service is tooshow gegevens instellen van Hallo Elasticsearch cluster hebt gemaakt.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-209">hello Kibana service is set up tooshow data from hello created Elasticsearch cluster.</span></span> <span data-ttu-id="c2dbc-210">Deze wordt beveiligd door Hallo dezelfde verificatiereferenties als Hallo cluster zelf.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-210">It is protected by hello same authentication credentials as hello cluster itself.</span></span> |

## <a name="in-process-versus-out-of-process-trace-capturing"></a><span data-ttu-id="c2dbc-211">In-process versus out of process-trace vastleggen</span><span class="sxs-lookup"><span data-stu-id="c2dbc-211">In-process versus out-of-process trace capturing</span></span>
<span data-ttu-id="c2dbc-212">In het Hallo-inleiding gezegd twee manieren om diagnostische gegevens te verzamelen: in-process- en out-of-process.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-212">In hello introduction, we mentioned two fundamental ways of collecting diagnostic data: in-process and out-of-process.</span></span> <span data-ttu-id="c2dbc-213">Elk heeft sterke en zwakke punten.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-213">Each has strengths and weaknesses.</span></span>

<span data-ttu-id="c2dbc-214">Voordelen van Hallo **proces trace vastleggen** omvatten:</span><span class="sxs-lookup"><span data-stu-id="c2dbc-214">Advantages of hello **in-process trace capturing** include:</span></span>

1. <span data-ttu-id="c2dbc-215">*Eenvoudige configuratie en implementatie*</span><span class="sxs-lookup"><span data-stu-id="c2dbc-215">*Easy configuration and deployment*</span></span>
   
   * <span data-ttu-id="c2dbc-216">Hallo-configuratie van verzamelen van diagnostische gegevens net is onderdeel van de configuratie van de toepassing hello.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-216">hello configuration of diagnostic data collection is just part of hello application configuration.</span></span> <span data-ttu-id="c2dbc-217">Het is gemakkelijk tooalways Houd deze 'synchroon' Hello rest van de toepassing hello.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-217">It is easy tooalways keep it "in sync" with hello rest of hello application.</span></span>
   * <span data-ttu-id="c2dbc-218">Configuratie van per toepassing of per-service is eenvoudig haalbare.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-218">Per-application or per-service configuration is easily achievable.</span></span>
   * <span data-ttu-id="c2dbc-219">Out of process-trace vastleggen moet meestal een afzonderlijke implementatie en configuratie van Hallo diagnostische agent, die een extra beheertaak en een mogelijke oorzaak van fouten is.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-219">Out-of-process trace capturing usually requires a separate deployment and configuration of hello diagnostic agent, which is an extra administrative task and a potential source of errors.</span></span> <span data-ttu-id="c2dbc-220">Hallo bepaalde agent technologie kunnen vaak slechts één exemplaar van de agent Hallo per virtuele machine (knooppunt).</span><span class="sxs-lookup"><span data-stu-id="c2dbc-220">hello particular agent technology often allows only one instance of hello agent per virtual machine (node).</span></span> <span data-ttu-id="c2dbc-221">Dit betekent dat de configuratie voor de verzameling van diagnostische configuratie Hallo Hallo wordt gedeeld door alle toepassingen en services die op dat knooppunt worden uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-221">This means that configuration for hello collection of hello diagnostic configuration is shared among all applications and services running on that node.</span></span>
2. <span data-ttu-id="c2dbc-222">*Flexibiliteit*</span><span class="sxs-lookup"><span data-stu-id="c2dbc-222">*Flexibility*</span></span>
   
   * <span data-ttu-id="c2dbc-223">Hallo-toepassing kunt hello gegevens verzenden waar het toogo, moet, zolang er is een clientbibliotheek die ondersteuning biedt voor systeem voor gegevensopslag Hallo gericht.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-223">hello application can send hello data wherever it needs toogo, as long as there is a client library that supports hello targeted data storage system.</span></span> <span data-ttu-id="c2dbc-224">Nieuwe sinks kunnen worden toegevoegd naar wens.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-224">New sinks can be added as desired.</span></span>
   * <span data-ttu-id="c2dbc-225">Complexe regels voor het vastleggen, filteren en samenvoegen van gegevens kunnen worden geïmplementeerd.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-225">Complex capture, filtering, and data-aggregation rules can be implemented.</span></span>
   * <span data-ttu-id="c2dbc-226">Het vastleggen van een out-of-process trace wordt vaak beperkt door Hallo gegevens put die Hallo agent ondersteunt.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-226">An out-of-process trace capturing is often limited by hello data sinks that hello agent supports.</span></span> <span data-ttu-id="c2dbc-227">Sommige agents worden uitgebreid.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-227">Some agents are extensible.</span></span>
3. <span data-ttu-id="c2dbc-228">*Toegang toointernal toepassingsgegevens en -context*</span><span class="sxs-lookup"><span data-stu-id="c2dbc-228">*Access toointernal application data and context*</span></span>
   
   * <span data-ttu-id="c2dbc-229">Hallo diagnostische subsysteem uitvoering binnen Hallo toepassing/service-proces kan eenvoudig hello traceringen met contextafhankelijke informatie verbeteren.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-229">hello diagnostic subsystem running inside hello application/service process can easily augment hello traces with contextual information.</span></span>
   * <span data-ttu-id="c2dbc-230">In Hallo out of process-methode, moet op Hallo gegevens tooan agent via een mechanisme voor communicatie tussen processen, zoals Event Tracing for Windows worden verzonden.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-230">In hello out-of-process approach, hello data must be sent tooan agent via some inter-process communication mechanism, such as Event Tracing for Windows.</span></span> <span data-ttu-id="c2dbc-231">Dit mechanisme kan aanvullende beperkingen opleggen.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-231">This mechanism could impose additional limitations.</span></span>

<span data-ttu-id="c2dbc-232">Voordelen van Hallo **out of process-tracering vast te leggen** omvatten:</span><span class="sxs-lookup"><span data-stu-id="c2dbc-232">Advantages of hello **out-of-process trace capturing** include:</span></span>

1. <span data-ttu-id="c2dbc-233">*Hallo mogelijkheid toomonitor toepassing hello en crashdumps verzamelen*</span><span class="sxs-lookup"><span data-stu-id="c2dbc-233">*hello ability toomonitor hello application and collect crash dumps*</span></span>
   
   * <span data-ttu-id="c2dbc-234">Tracering in-process vastleggen mogelijk mislukt als de toepassing hello toostart mislukt of is vastgelopen.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-234">In-process trace capturing may be unsuccessful if hello application fails toostart or crashes.</span></span> <span data-ttu-id="c2dbc-235">Een onafhankelijke agent heeft een veel grotere kans van het vastleggen van cruciaal belang voor probleemoplossing.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-235">An independent agent has a much better chance of capturing crucial troubleshooting information.</span></span><br /><br />
2. <span data-ttu-id="c2dbc-236">*Vervaldatum, robuustheid en beproefde prestaties*</span><span class="sxs-lookup"><span data-stu-id="c2dbc-236">*Maturity, robustness, and proven performance*</span></span>
   
   * <span data-ttu-id="c2dbc-237">Een agent die is ontwikkeld door een leverancier platform (zoals Microsoft Azure Diagnostics-agent) is onderwerp toorigorous testen en strijd te beperken.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-237">An agent developed by a platform vendor (such as a Microsoft Azure Diagnostics agent) has been subject toorigorous testing and battle-hardening.</span></span>
   * <span data-ttu-id="c2dbc-238">Met de in proces tracering vast te leggen, moet nauwkeurig tooensure dat Hallo activiteit van het verzenden van diagnostische gegevens van een toepassingsproces niet leiden tot met de belangrijkste taken van de toepassing hello problemen of problemen met timing- of Prestatieweergave veroorzaken.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-238">With in-process trace capturing, care must be taken tooensure that hello activity of sending diagnostic data from an application process does not interfere with hello application's main tasks or introduce timing or performance problems.</span></span> <span data-ttu-id="c2dbc-239">Een agent onafhankelijk uitgevoerd is minder gevoelig toothese problemen en is speciaal ontworpen toolimit het effect op Hallo-systeem.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-239">An independently running agent is less prone toothese issues and is specifically designed toolimit its impact on hello system.</span></span>

<span data-ttu-id="c2dbc-240">Het is mogelijk toocombine en voordelen van beide benaderingen.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-240">It is possible toocombine and benefit from both approaches.</span></span> <span data-ttu-id="c2dbc-241">Inderdaad, mogelijk de beste oplossing Hallo voor veel toepassingen.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-241">Indeed, it might be hello best solution for many applications.</span></span>

<span data-ttu-id="c2dbc-242">Hier, gebruiken we Hallo **Microsoft.Diagnostic.Listeners bibliotheek** en Hallo in-process trace het vastleggen van gegevens uit een cluster Service Fabric-toepassing tooan Elasticsearch toosend.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-242">Here, we use hello **Microsoft.Diagnostic.Listeners library** and hello in-process trace capturing toosend data from a Service Fabric application tooan Elasticsearch cluster.</span></span>

## <a name="use-hello-listeners-library-toosend-diagnostic-data-tooelasticsearch"></a><span data-ttu-id="c2dbc-243">Hallo-Listeners bibliotheek toosend diagnostische gegevens tooElasticsearch gebruiken</span><span class="sxs-lookup"><span data-stu-id="c2dbc-243">Use hello Listeners library toosend diagnostic data tooElasticsearch</span></span>
<span data-ttu-id="c2dbc-244">Hallo Microsoft.Diagnostic.Listeners bibliotheek maakt deel uit van de voorbeeldtoepassing Service Fabric PartyCluster.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-244">hello Microsoft.Diagnostic.Listeners library is part of PartyCluster sample Service Fabric application.</span></span> <span data-ttu-id="c2dbc-245">toouse het:</span><span class="sxs-lookup"><span data-stu-id="c2dbc-245">toouse it:</span></span>

1. <span data-ttu-id="c2dbc-246">Download [hello PartyCluster voorbeeld](https://github.com/Azure-Samples/service-fabric-dotnet-management-party-cluster) vanuit GitHub.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-246">Download [hello PartyCluster sample](https://github.com/Azure-Samples/service-fabric-dotnet-management-party-cluster) from GitHub.</span></span>
2. <span data-ttu-id="c2dbc-247">Hallo Microsoft.Diagnostics.Listeners en Microsoft.Diagnostics.Listeners.Fabric projecten (hele mappen) kopiëren van Hallo PartyCluster voorbeeld toohello oplossingenmap van Hallo-toepassing die toosend Hallo gegevens tooElasticsearch moet .</span><span class="sxs-lookup"><span data-stu-id="c2dbc-247">Copy hello Microsoft.Diagnostics.Listeners and Microsoft.Diagnostics.Listeners.Fabric projects (whole folders) from hello PartyCluster sample directory toohello solution folder of hello application that is supposed toosend hello data tooElasticsearch.</span></span>
3. <span data-ttu-id="c2dbc-248">Open Hallo doel oplossing, met de rechtermuisknop op Hallo oplossing knooppunt in Hallo Solution Explorer en kiest u **bestaand Project toevoegen**.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-248">Open hello target solution, right-click hello solution node in hello Solution Explorer, and choose **Add Existing Project**.</span></span> <span data-ttu-id="c2dbc-249">Hallo Microsoft.Diagnostics.Listeners project toohello oplossing toevoegen.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-249">Add hello Microsoft.Diagnostics.Listeners project toohello solution.</span></span> <span data-ttu-id="c2dbc-250">Herhaal Hallo dezelfde voor Hallo Microsoft.Diagnostics.Listeners.Fabric project.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-250">Repeat hello same for hello Microsoft.Diagnostics.Listeners.Fabric project.</span></span>
4. <span data-ttu-id="c2dbc-251">Voeg een projectverwijzing van uw projecten toohello twee toegevoegde serviceprojecten.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-251">Add a project reference from your service project(s) toohello two added projects.</span></span> <span data-ttu-id="c2dbc-252">(Elke service die toosend gegevens tooElasticsearch moet moet verwijzen naar Microsoft.Diagnostics.EventListeners en Microsoft.Diagnostics.EventListeners.Fabric).</span><span class="sxs-lookup"><span data-stu-id="c2dbc-252">(Each service that is supposed toosend data tooElasticsearch should reference Microsoft.Diagnostics.EventListeners and Microsoft.Diagnostics.EventListeners.Fabric).</span></span>
   
    ![Project verwijst naar tooMicrosoft.Diagnostics.EventListeners en Microsoft.Diagnostics.EventListeners.Fabric bibliotheken][1]

### <a name="service-fabric-general-availability-release-and-microsoftdiagnosticstracing-nuget-package"></a><span data-ttu-id="c2dbc-254">Service Fabric algemene beschikbaarheid release en Microsoft.Diagnostics.Tracing Nuget-pakket</span><span class="sxs-lookup"><span data-stu-id="c2dbc-254">Service Fabric General Availability release and Microsoft.Diagnostics.Tracing Nuget package</span></span>
<span data-ttu-id="c2dbc-255">Toepassingen die zijn gemaakt met de release van Service Fabric algemene beschikbaarheid (2.0.135, en met 31 maart 2016 wordt uitgebracht) doel **.NET Framework 4.5.2**.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-255">Applications built with Service Fabric General Availability release (2.0.135, released March 31, 2016) target **.NET Framework 4.5.2**.</span></span> <span data-ttu-id="c2dbc-256">Deze versie is de hoogste versie Hallo Hallo .NET Framework ondersteund door Azure bij Hallo Hallo GA-release.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-256">This version is hello highest version of hello .NET Framework supported by Azure at hello time of hello GA release.</span></span> <span data-ttu-id="c2dbc-257">Deze versie van framework Hallo helaas beschikt niet over bepaalde EventListener APIs die Hallo Microsoft.Diagnostics.Listeners bibliotheek nodig heeft.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-257">Unfortunately, this version of hello framework lacks certain EventListener APIs that hello Microsoft.Diagnostics.Listeners library needs.</span></span> <span data-ttu-id="c2dbc-258">Omdat nauw EventSource (Hallo-component die Hallo basis vormt van logboekregistratie van API's in de Fabric-toepassingen) en EventListener zijn gekoppeld, moet elk project dat gebruikmaakt van Hallo Microsoft.Diagnostics.Listeners bibliotheek een alternatieve implementatie van gebruiken EventSource.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-258">Because EventSource (hello component that forms hello basis of logging APIs in Fabric applications) and EventListener are tightly coupled, every project that uses hello Microsoft.Diagnostics.Listeners library must use an alternative implementation of EventSource.</span></span> <span data-ttu-id="c2dbc-259">Deze implementatie wordt geleverd door Hallo **Microsoft.Diagnostics.Tracing Nuget-pakket**, opgestelde door Microsoft.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-259">This implementation is provided by hello **Microsoft.Diagnostics.Tracing Nuget package**, authored by Microsoft.</span></span> <span data-ttu-id="c2dbc-260">Hallo-pakket is volledig achterwaarts compatibel met EventSource opgenomen in het Hallo-framework, dus geen codewijzigingen mag alleen waarnaar wordt verwezen naamruimte wijzigingen nodig.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-260">hello package is fully backward-compatible with EventSource included in hello framework, so no code changes should be necessary other than referenced namespace changes.</span></span>

<span data-ttu-id="c2dbc-261">toostart met Hallo Microsoft.Diagnostics.Tracing implementatie van Hallo EventSource klasse, als volgt te werk voor elk serviceproject dat toosend gegevens tooElasticsearch moet:</span><span class="sxs-lookup"><span data-stu-id="c2dbc-261">toostart using hello Microsoft.Diagnostics.Tracing implementation of hello EventSource class, follow these steps for each service project that needs toosend data tooElasticsearch:</span></span>

1. <span data-ttu-id="c2dbc-262">Met de rechtermuisknop op het Hallo-service-project en kies **Nuget-pakketten beheren**.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-262">Right-click on hello service project and choose **Manage Nuget Packages**.</span></span>
2. <span data-ttu-id="c2dbc-263">Overschakelen toohello nuget.org pakketbron (indien deze nog niet is geselecteerd) en zoek naar '**Microsoft.Diagnostics.Tracing**'.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-263">Switch toohello nuget.org package source (if it is not already selected) and search for "**Microsoft.Diagnostics.Tracing**".</span></span>
3. <span data-ttu-id="c2dbc-264">Hallo installeren `Microsoft.Diagnostics.Tracing.EventSource` pakket (en de bijbehorende afhankelijkheden).</span><span class="sxs-lookup"><span data-stu-id="c2dbc-264">Install hello `Microsoft.Diagnostics.Tracing.EventSource` package (and its dependencies).</span></span>
4. <span data-ttu-id="c2dbc-265">Open Hallo **ServiceEventSource.cs** of **ActorEventSource.cs** bestand in uw serviceproject en vervang Hallo `using System.Diagnostics.Tracing` richtlijn boven op het Hallo-bestand met de Hallo `using Microsoft.Diagnostics.Tracing` richtlijn.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-265">Open hello **ServiceEventSource.cs** or **ActorEventSource.cs** file in your service project and replace hello `using System.Diagnostics.Tracing` directive on top of hello file with hello `using Microsoft.Diagnostics.Tracing` directive.</span></span>

<span data-ttu-id="c2dbc-266">Deze stappen worden niet nodig eenmaal Hallo **.NET Framework 4.6** wordt ondersteund door Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-266">These steps will not be necessary once hello **.NET Framework 4.6** is supported by Microsoft Azure.</span></span>

### <a name="elasticsearch-listener-instantiation-and-configuration"></a><span data-ttu-id="c2dbc-267">Elasticsearch listener instantiëring en configuratie</span><span class="sxs-lookup"><span data-stu-id="c2dbc-267">Elasticsearch listener instantiation and configuration</span></span>
<span data-ttu-id="c2dbc-268">Hallo laatste stap voor het verzenden van diagnostische gegevens tooElasticsearch is toocreate een exemplaar van `ElasticSearchListener` en configureer deze met Elasticsearch verbindingsgegevens.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-268">hello final step for sending diagnostic data tooElasticsearch is toocreate an instance of `ElasticSearchListener` and configure it with Elasticsearch connection data.</span></span> <span data-ttu-id="c2dbc-269">Hallo-listener worden automatisch alle gebeurtenissen geregistreerd die zijn gegenereerd via EventSource klassen die zijn gedefinieerd in het Hallo-serviceproject.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-269">hello listener automatically captures all events raised via EventSource classes defined in hello service project.</span></span> <span data-ttu-id="c2dbc-270">Moet toobe actief is tijdens de levensduur Hallo van Hallo-service, zodat Hallo aanbevolen toocreate in Hallo initialisatie servicecode plaatsen.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-270">It needs toobe alive during hello lifetime of hello service, so hello best place toocreate it is in hello service initialization code.</span></span> <span data-ttu-id="c2dbc-271">Hallo initialisatie van de code voor een stateless service kan uitzien na de benodigde wijzigingen hello (toevoegingen die zijn uiteengezet in opmerkingen die beginnen met `****`):</span><span class="sxs-lookup"><span data-stu-id="c2dbc-271">Here is how hello initialization code for a stateless service could look after hello necessary changes (additions pointed out in comments starting with `****`):</span></span>

```csharp
using System;
using System.Diagnostics;
using System.Fabric;
using System.Threading;
using System.Threading.Tasks;
using Microsoft.ServiceFabric.Services.Runtime;

// **** Add hello following directives
using Microsoft.Diagnostics.EventListeners;
using Microsoft.Diagnostics.EventListeners.Fabric;

namespace Stateless1
{
    internal static class Program
    {
        /// <summary>
        /// This is hello entry point of hello service host process.
        /// </summary>        
        private static void Main()
        {
            try
            {
                // **** Instantiate ElasticSearchListener
                var configProvider = new FabricConfigurationProvider("ElasticSearchEventListener");
                ElasticSearchListener esListener = null;
                if (configProvider.HasConfiguration)
                {
                    esListener = new ElasticSearchListener(configProvider, new FabricHealthReporter("ElasticSearchEventListener"));
                }

                // hello ServiceManifest.XML file defines one or more service type names.
                // Registering a service maps a service type name tooa .NET type.
                // When Service Fabric creates an instance of this service type,
                // an instance of hello class is created in this host process.

                ServiceRuntime.RegisterServiceAsync("Stateless1Type", 
                    context => new Stateless1(context)).GetAwaiter().GetResult();

                ServiceEventSource.Current.ServiceTypeRegistered(Process.GetCurrentProcess().Id, typeof(Stateless1).Name);

                // Prevents this host process from terminating so services keep running.
                Thread.Sleep(Timeout.Infinite);

                // **** Ensure that hello ElasticSearchListner instance is not garbage-collected prematurely
                GC.KeepAlive(esListener);
            }
            catch (Exception e)
            {
                ServiceEventSource.Current.ServiceHostInitializationFailed(e);
                throw;
            }
        }
    }
}
```

<span data-ttu-id="c2dbc-272">Elasticsearch verbindingsgegevens moeten worden geplaatst in een aparte sectie in het serviceconfiguratiebestand hello (**PackageRoot\Config\Settings.xml**).</span><span class="sxs-lookup"><span data-stu-id="c2dbc-272">Elasticsearch connection data should be put in a separate section in hello service configuration file (**PackageRoot\Config\Settings.xml**).</span></span> <span data-ttu-id="c2dbc-273">Hallo-naam van de sectie Hallo moet overeenkomen met toohello waarde doorgegeven toohello `FabricConfigurationProvider` -constructor aan, bijvoorbeeld:</span><span class="sxs-lookup"><span data-stu-id="c2dbc-273">hello name of hello section must correspond toohello value passed toohello `FabricConfigurationProvider` constructor, for example:</span></span>

```xml
<Section Name="ElasticSearchEventListener">
  <Parameter Name="serviceUri" Value="http://myBigCluster.westus.cloudapp.azure.com/es/" />
  <Parameter Name="userName" Value="(ES user name)" />
  <Parameter Name="password" Value="(ES user password)" />
  <Parameter Name="indexNamePrefix" Value="myapp" />
</Section>
```
<span data-ttu-id="c2dbc-274">waarden van Hallo `serviceUri`, `userName` en `password` parameters toohello Elasticsearch cluster eindpuntadres Elasticsearch gebruikersnaam en wachtwoord, respectievelijk overeenkomen.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-274">hello values of `serviceUri`, `userName` and `password` parameters correspond toohello Elasticsearch cluster endpoint address, Elasticsearch user name, and password, respectively.</span></span> <span data-ttu-id="c2dbc-275">`indexNamePrefix`Hallo-voorvoegsel voor Elasticsearch indexen; Hallo Microsoft.Diagnostics.Listeners bibliotheek maakt dagelijks een nieuwe index voor de gegevens.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-275">`indexNamePrefix` is hello prefix for Elasticsearch indexes; hello Microsoft.Diagnostics.Listeners library creates a new index for its data daily.</span></span>

### <a name="verification"></a><span data-ttu-id="c2dbc-276">Verificatie</span><span class="sxs-lookup"><span data-stu-id="c2dbc-276">Verification</span></span>
<span data-ttu-id="c2dbc-277">Dat is alles.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-277">That's it!</span></span> <span data-ttu-id="c2dbc-278">Nu wanneer Hallo-service wordt uitgevoerd, begint traceringen toohello Elasticsearch service die is opgegeven in configuratie Hallo verzenden.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-278">Now, whenever hello service is run, it starts sending traces toohello Elasticsearch service specified in hello configuration.</span></span> <span data-ttu-id="c2dbc-279">U kunt dit controleren door openen Hallo die kibana UI Hallo Elasticsearch doelexemplaar gekoppeld.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-279">You can verify this by opening hello Kibana UI associated with hello target Elasticsearch instance.</span></span> <span data-ttu-id="c2dbc-280">In ons voorbeeld is het adres pagina Hallo http://myBigCluster.westus.cloudapp.azure.com/.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-280">In our example, hello page address is http://myBigCluster.westus.cloudapp.azure.com/.</span></span> <span data-ttu-id="c2dbc-281">Controleer of de geïndexeerd met Hallo voorvoegsel voor Hallo gekozen `ElasticSearchListener` exemplaar inderdaad zijn gemaakt en gevuld met gegevens.</span><span class="sxs-lookup"><span data-stu-id="c2dbc-281">Check that indexes with hello name prefix chosen for hello `ElasticSearchListener` instance have indeed been created and populated with data.</span></span>

![Kibana tonen PartyCluster toepassingsgebeurtenissen][2]

## <a name="next-steps"></a><span data-ttu-id="c2dbc-283">Volgende stappen</span><span class="sxs-lookup"><span data-stu-id="c2dbc-283">Next steps</span></span>
* [<span data-ttu-id="c2dbc-284">Meer informatie over het diagnosticeren en controleren van een Service Fabric-service</span><span class="sxs-lookup"><span data-stu-id="c2dbc-284">Learn more about diagnosing and monitoring a Service Fabric service</span></span>](service-fabric-diagnostics-how-to-monitor-and-diagnose-services-locally.md)

<!--Image references-->
[1]: ./media/service-fabric-diagnostics-how-to-use-elasticsearch/listener-lib-references.png
[2]: ./media/service-fabric-diagnostics-how-to-use-elasticsearch/kibana.png
