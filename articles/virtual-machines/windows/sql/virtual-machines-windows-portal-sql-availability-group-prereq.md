---
title: SQL Server-beschikbaarheidsgroepen - virtuele machines in Azure - vereisten | Microsoft Docs
description: Deze zelfstudie laat zien hoe u de vereisten voor het maken van een SQL Server Always On-beschikbaarheidsgroep op Azure Virtual machines configureert.
services: virtual-machines
documentationCenter: na
authors: MikeRayMSFT
manager: jhubbard
editor: monicar
tags: azure-service-management
ms.assetid: c492db4c-3faa-4645-849f-5a1a663be55a
ms.service: virtual-machines-sql
ms.devlang: na
ms.custom: na
ms.topic: article
ms.tgt_pltfrm: vm-windows-sql-server
ms.workload: iaas-sql-server
ms.date: 05/09/2017
ms.author: mikeray
ms.openlocfilehash: 3d508877928e033f24dae62c1042745ea7250033
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 08/29/2017
---
# <a name="complete-the-prerequisites-for-creating-always-on-availability-groups-on-azure-virtual-machines"></a><span data-ttu-id="f667d-103">Voldoen aan de vereisten voor het maken van AlwaysOn-beschikbaarheidsgroepen op virtuele machines in Azure</span><span class="sxs-lookup"><span data-stu-id="f667d-103">Complete the prerequisites for creating Always On availability groups on Azure virtual machines</span></span>

<span data-ttu-id="f667d-104">Deze zelfstudie laat zien hoe u voldoen aan de vereisten voor het maken van een [SQL Server Always On beschikbaarheidsgroep op Azure virtuele machines (VM's)](virtual-machines-windows-portal-sql-availability-group-tutorial.md).</span><span class="sxs-lookup"><span data-stu-id="f667d-104">This tutorial shows how to complete the prerequisites for creating a [SQL Server Always On availability group on Azure virtual machines (VMs)](virtual-machines-windows-portal-sql-availability-group-tutorial.md).</span></span> <span data-ttu-id="f667d-105">Wanneer u klaar bent met de vereisten, hebt u een domeincontroller, twee SQL Server-VM's en een witness-server in één resourcegroep.</span><span class="sxs-lookup"><span data-stu-id="f667d-105">When you've finished the prerequisites, you have a domain controller, two SQL Server VMs, and a witness server in a single resource group.</span></span>

<span data-ttu-id="f667d-106">**Tijd schatting**: het duurt een paar uur om te voldoen aan de vereisten.</span><span class="sxs-lookup"><span data-stu-id="f667d-106">**Time estimate**: It might take a couple of hours to complete the prerequisites.</span></span> <span data-ttu-id="f667d-107">Veel van deze tijd wordt besteed aan het maken van virtuele machines.</span><span class="sxs-lookup"><span data-stu-id="f667d-107">Much of this time is spent creating virtual machines.</span></span>

<span data-ttu-id="f667d-108">Het volgende diagram ziet u wat u in de zelfstudie bouwen.</span><span class="sxs-lookup"><span data-stu-id="f667d-108">The following diagram illustrates what you build in the tutorial.</span></span>

![Beschikbaarheidsgroep](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/00-EndstateSampleNoELB.png)

## <a name="review-availability-group-documentation"></a><span data-ttu-id="f667d-110">Documentatie voor beschikbaarheid van groep lezen</span><span class="sxs-lookup"><span data-stu-id="f667d-110">Review availability group documentation</span></span>

<span data-ttu-id="f667d-111">Deze zelfstudie wordt ervan uitgegaan dat u basiskennis van SQL Server Always On availability groups.</span><span class="sxs-lookup"><span data-stu-id="f667d-111">This tutorial assumes that you have a basic understanding of SQL Server Always On availability groups.</span></span> <span data-ttu-id="f667d-112">Als u niet bekend met deze technologie bent, Zie [overzicht van AlwaysOn-beschikbaarheidsgroepen (SQL Server)](http://msdn.microsoft.com/library/ff877884.aspx).</span><span class="sxs-lookup"><span data-stu-id="f667d-112">If you're not familiar with this technology, see [Overview of Always On Availability Groups (SQL Server)](http://msdn.microsoft.com/library/ff877884.aspx).</span></span>


## <a name="create-an-azure-account"></a><span data-ttu-id="f667d-113">Maak een Azure-account</span><span class="sxs-lookup"><span data-stu-id="f667d-113">Create an Azure account</span></span>
<span data-ttu-id="f667d-114">U hebt een Azure-account nodig.</span><span class="sxs-lookup"><span data-stu-id="f667d-114">You need an Azure account.</span></span> <span data-ttu-id="f667d-115">U kunt [gratis Azure-account openen](/pricing/free-trial/?WT.mc_id=A261C142F) of [voordelen als Visual Studio-abonnee activeren](/pricing/member-offers/msdn-benefits-details/?WT.mc_id=A261C142F).</span><span class="sxs-lookup"><span data-stu-id="f667d-115">You can [open a free Azure account](/pricing/free-trial/?WT.mc_id=A261C142F) or [activate Visual Studio subscriber benefits](/pricing/member-offers/msdn-benefits-details/?WT.mc_id=A261C142F).</span></span>

## <a name="create-a-resource-group"></a><span data-ttu-id="f667d-116">Een resourcegroep maken</span><span class="sxs-lookup"><span data-stu-id="f667d-116">Create a resource group</span></span>
1. <span data-ttu-id="f667d-117">Meld u aan bij [Azure Portal](http://portal.azure.com).</span><span class="sxs-lookup"><span data-stu-id="f667d-117">Sign in to the [Azure portal](http://portal.azure.com).</span></span>
2. <span data-ttu-id="f667d-118">Klik op  **+**  voor het maken van een nieuw object in de portal.</span><span class="sxs-lookup"><span data-stu-id="f667d-118">Click **+** to create a new object in the portal.</span></span>

   ![Nieuw object](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/01-portalplus.png)

3. <span data-ttu-id="f667d-120">Type **resourcegroep** in de **Marketplace** zoekvenster.</span><span class="sxs-lookup"><span data-stu-id="f667d-120">Type **resource group** in the **Marketplace** search window.</span></span>

   ![Resourcegroep](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/01-resourcegroupsymbol.png)
4. <span data-ttu-id="f667d-122">Klik op **resourcegroep**.</span><span class="sxs-lookup"><span data-stu-id="f667d-122">Click **Resource group**.</span></span>
5. <span data-ttu-id="f667d-123">Klik op **Create**.</span><span class="sxs-lookup"><span data-stu-id="f667d-123">Click **Create**.</span></span>
6. <span data-ttu-id="f667d-124">Op de **resourcegroep** blade onder **Resourcegroepnaam**, typ een naam voor de resourcegroep.</span><span class="sxs-lookup"><span data-stu-id="f667d-124">On the **Resource group** blade, under **Resource group name**, type a name for the resource group.</span></span> <span data-ttu-id="f667d-125">Typ bijvoorbeeld **sql-ha-rg**.</span><span class="sxs-lookup"><span data-stu-id="f667d-125">For example, type **sql-ha-rg**.</span></span>
7. <span data-ttu-id="f667d-126">Als u meerdere Azure-abonnementen hebt, controleert u of het abonnement de Azure-abonnement dat u wilt maken van de beschikbaarheidsgroep in.</span><span class="sxs-lookup"><span data-stu-id="f667d-126">If you have multiple Azure subscriptions, verify that the subscription is the Azure subscription that you want to create the availability group in.</span></span>
8. <span data-ttu-id="f667d-127">Selecteer een locatie.</span><span class="sxs-lookup"><span data-stu-id="f667d-127">Select a location.</span></span> <span data-ttu-id="f667d-128">De locatie is de Azure-regio waar u wilt maken van de beschikbaarheidsgroep.</span><span class="sxs-lookup"><span data-stu-id="f667d-128">The location is the Azure region where you want to create the availability group.</span></span> <span data-ttu-id="f667d-129">Voor deze zelfstudie gaan we voor het bouwen van alle resources in een Azure-locatie.</span><span class="sxs-lookup"><span data-stu-id="f667d-129">For this tutorial, we're going to build all resources in one Azure location.</span></span>
9. <span data-ttu-id="f667d-130">Controleer **vastmaken aan dashboard** is ingeschakeld.</span><span class="sxs-lookup"><span data-stu-id="f667d-130">Verify that **Pin to dashboard** is checked.</span></span> <span data-ttu-id="f667d-131">Deze instelling optioneel wordt een snelkoppeling voor de resourcegroep op de Azure-portaldashboard.</span><span class="sxs-lookup"><span data-stu-id="f667d-131">This optional setting places a shortcut for the resource group on the Azure portal dashboard.</span></span>

   ![Resourcegroep](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/01-resourcegroup.png)

10. <span data-ttu-id="f667d-133">Klik op **maken** om de resourcegroep te maken.</span><span class="sxs-lookup"><span data-stu-id="f667d-133">Click **Create** to create the resource group.</span></span>

<span data-ttu-id="f667d-134">Azure maakt de resourcegroep en pincodes een snelkoppeling naar de resourcegroep in de portal.</span><span class="sxs-lookup"><span data-stu-id="f667d-134">Azure creates the resource group and pins a shortcut to the resource group in the portal.</span></span>

## <a name="create-the-network-and-subnets"></a><span data-ttu-id="f667d-135">De netwerk- en subnetten maken</span><span class="sxs-lookup"><span data-stu-id="f667d-135">Create the network and subnets</span></span>
<span data-ttu-id="f667d-136">De volgende stap is het maken van de netwerken en subnetten in de Azure-resourcegroep.</span><span class="sxs-lookup"><span data-stu-id="f667d-136">The next step is to create the networks and subnets in the Azure resource group.</span></span>

<span data-ttu-id="f667d-137">De oplossing maakt gebruik van een virtueel netwerk met twee subnetten.</span><span class="sxs-lookup"><span data-stu-id="f667d-137">The solution uses one virtual network with two subnets.</span></span> <span data-ttu-id="f667d-138">De [Virtual network-overzicht](../../../virtual-network/virtual-networks-overview.md) vindt u meer informatie over netwerken in Azure.</span><span class="sxs-lookup"><span data-stu-id="f667d-138">The [Virtual network overview](../../../virtual-network/virtual-networks-overview.md) provides more information about networks in Azure.</span></span>

<span data-ttu-id="f667d-139">Het virtuele netwerk maken:</span><span class="sxs-lookup"><span data-stu-id="f667d-139">To create the virtual network:</span></span>

1. <span data-ttu-id="f667d-140">Klik in de Azure-portal in de resourcegroep op **+ toevoegen**.</span><span class="sxs-lookup"><span data-stu-id="f667d-140">In the Azure portal, in your resource group, click **+ Add**.</span></span> <span data-ttu-id="f667d-141">Azure wordt geopend de **Alles** blade.</span><span class="sxs-lookup"><span data-stu-id="f667d-141">Azure opens the **Everything** blade.</span></span>

   ![Nieuw item](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/02-newiteminrg.png)
2. <span data-ttu-id="f667d-143">Zoeken naar **virtueel netwerk**.</span><span class="sxs-lookup"><span data-stu-id="f667d-143">Search for **virtual network**.</span></span>

     ![Het virtuele netwerk zoeken](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/04-findvirtualnetwork.png)
3. <span data-ttu-id="f667d-145">Klik op **virtueel netwerk**.</span><span class="sxs-lookup"><span data-stu-id="f667d-145">Click **Virtual network**.</span></span>
4. <span data-ttu-id="f667d-146">Op de **virtueel netwerk** blade, klikt u op de **Resource Manager** implementatiemodel en klik vervolgens op **maken**.</span><span class="sxs-lookup"><span data-stu-id="f667d-146">On the **Virtual network** blade, click the **Resource Manager** deployment model, and then click **Create**.</span></span>

    <span data-ttu-id="f667d-147">De volgende tabel ziet u de instellingen voor het virtuele netwerk:</span><span class="sxs-lookup"><span data-stu-id="f667d-147">The following table shows the settings for the virtual network:</span></span>

   | <span data-ttu-id="f667d-148">**Veld**</span><span class="sxs-lookup"><span data-stu-id="f667d-148">**Field**</span></span> | <span data-ttu-id="f667d-149">Waarde</span><span class="sxs-lookup"><span data-stu-id="f667d-149">Value</span></span> |
   | --- | --- |
   | <span data-ttu-id="f667d-150">**Naam**</span><span class="sxs-lookup"><span data-stu-id="f667d-150">**Name**</span></span> |<span data-ttu-id="f667d-151">autoHAVNET</span><span class="sxs-lookup"><span data-stu-id="f667d-151">autoHAVNET</span></span> |
   | <span data-ttu-id="f667d-152">**Adresruimte**</span><span class="sxs-lookup"><span data-stu-id="f667d-152">**Address space**</span></span> |<span data-ttu-id="f667d-153">10.33.0.0/24</span><span class="sxs-lookup"><span data-stu-id="f667d-153">10.33.0.0/24</span></span> |
   | <span data-ttu-id="f667d-154">**Subnetnaam**</span><span class="sxs-lookup"><span data-stu-id="f667d-154">**Subnet name**</span></span> |<span data-ttu-id="f667d-155">Beheerder</span><span class="sxs-lookup"><span data-stu-id="f667d-155">Admin</span></span> |
   | <span data-ttu-id="f667d-156">**Subnetadresbereik**</span><span class="sxs-lookup"><span data-stu-id="f667d-156">**Subnet address range**</span></span> |<span data-ttu-id="f667d-157">10.33.0.0/29</span><span class="sxs-lookup"><span data-stu-id="f667d-157">10.33.0.0/29</span></span> |
   | <span data-ttu-id="f667d-158">**Abonnement**</span><span class="sxs-lookup"><span data-stu-id="f667d-158">**Subscription**</span></span> |<span data-ttu-id="f667d-159">Geef het abonnement dat u wilt gebruiken.</span><span class="sxs-lookup"><span data-stu-id="f667d-159">Specify the subscription that you intend to use.</span></span> <span data-ttu-id="f667d-160">**Abonnement** is leeg als u slechts één abonnement hebt.</span><span class="sxs-lookup"><span data-stu-id="f667d-160">**Subscription** is blank if you only have one subscription.</span></span> |
   | <span data-ttu-id="f667d-161">**Resourcegroep**</span><span class="sxs-lookup"><span data-stu-id="f667d-161">**Resource group**</span></span> |<span data-ttu-id="f667d-162">Kies **gebruik bestaande** en kies de naam van de resourcegroep.</span><span class="sxs-lookup"><span data-stu-id="f667d-162">Choose **Use existing** and pick the name of the resource group.</span></span> |
   | <span data-ttu-id="f667d-163">**Locatie**</span><span class="sxs-lookup"><span data-stu-id="f667d-163">**Location**</span></span> |<span data-ttu-id="f667d-164">Geef de Azure-locatie.</span><span class="sxs-lookup"><span data-stu-id="f667d-164">Specify the Azure location.</span></span> |

   <span data-ttu-id="f667d-165">Uw adres en het subnet-adresbereik kan afwijken van de tabel.</span><span class="sxs-lookup"><span data-stu-id="f667d-165">Your address space and subnet address range might be different from the table.</span></span> <span data-ttu-id="f667d-166">Afhankelijk van uw abonnement stelt de portal voor een beschikbare adresruimte en de bijbehorende subnet-adresbereik.</span><span class="sxs-lookup"><span data-stu-id="f667d-166">Depending on your subscription, the portal suggests an available address space and corresponding subnet address range.</span></span> <span data-ttu-id="f667d-167">Als er geen voldoende adresruimte beschikbaar is, gebruikt u een ander abonnement.</span><span class="sxs-lookup"><span data-stu-id="f667d-167">If no sufficient address space is available, use a different subscription.</span></span>

   <span data-ttu-id="f667d-168">Het voorbeeld wordt de subnetnaam **Admin**. Dit subnet is voor de domeincontrollers.</span><span class="sxs-lookup"><span data-stu-id="f667d-168">The example uses the subnet name **Admin**. This subnet is for the domain controllers.</span></span>

5. <span data-ttu-id="f667d-169">Klik op **Create**.</span><span class="sxs-lookup"><span data-stu-id="f667d-169">Click **Create**.</span></span>

   ![Het virtuele netwerk configureren](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/06-configurevirtualnetwork.png)

<span data-ttu-id="f667d-171">Azure keert u terug naar het portaldashboard en waarschuwt u als het nieuwe netwerk wordt gemaakt.</span><span class="sxs-lookup"><span data-stu-id="f667d-171">Azure returns you to the portal dashboard and notifies you when the new network is created.</span></span>

### <a name="create-a-second-subnet"></a><span data-ttu-id="f667d-172">Maak een tweede subnet</span><span class="sxs-lookup"><span data-stu-id="f667d-172">Create a second subnet</span></span>
<span data-ttu-id="f667d-173">Het nieuwe virtuele netwerk heeft een subnet, met de naam **Admin**. Dit subnet wordt gebruikt door de domeincontrollers.</span><span class="sxs-lookup"><span data-stu-id="f667d-173">The new virtual network has one subnet, named **Admin**. The domain controllers use this subnet.</span></span> <span data-ttu-id="f667d-174">De VM's van SQL Server gebruikt een tweede subnet met de naam **SQL**.</span><span class="sxs-lookup"><span data-stu-id="f667d-174">The SQL Server VMs use a second subnet named **SQL**.</span></span> <span data-ttu-id="f667d-175">Dit subnet configureren:</span><span class="sxs-lookup"><span data-stu-id="f667d-175">To configure this subnet:</span></span>

1. <span data-ttu-id="f667d-176">Klik op de resourcegroep die u hebt gemaakt, op uw dashboard **SQL-HA-RG**.</span><span class="sxs-lookup"><span data-stu-id="f667d-176">On your dashboard, click the resource group that you created, **SQL-HA-RG**.</span></span> <span data-ttu-id="f667d-177">Het netwerk niet vinden in de resourcegroep onder **Resources**.</span><span class="sxs-lookup"><span data-stu-id="f667d-177">Locate the network in the resource group under **Resources**.</span></span>

    <span data-ttu-id="f667d-178">Als **SQL-HA-RG** niet wordt weergegeven, vinden door te klikken op **resourcegroepen** en filteren op naam van de resourcegroep.</span><span class="sxs-lookup"><span data-stu-id="f667d-178">If **SQL-HA-RG** isn't visible, find it by clicking **Resource Groups** and filtering by the resource group name.</span></span>
2. <span data-ttu-id="f667d-179">Klik op **autoHAVNET** op de lijst met resources.</span><span class="sxs-lookup"><span data-stu-id="f667d-179">Click **autoHAVNET** on the list of resources.</span></span> <span data-ttu-id="f667d-180">Azure opent u de blade van de configuratie van netwerk.</span><span class="sxs-lookup"><span data-stu-id="f667d-180">Azure opens the network configuration blade.</span></span>
3. <span data-ttu-id="f667d-181">Op de **autoHAVNET** blade virtueel netwerk onder **instellingen** , klikt u op **subnetten**.</span><span class="sxs-lookup"><span data-stu-id="f667d-181">On the **autoHAVNET** virtual network blade, under **Settings** , click **Subnets**.</span></span>

    <span data-ttu-id="f667d-182">Let op het subnet dat u al hebt gemaakt.</span><span class="sxs-lookup"><span data-stu-id="f667d-182">Note the subnet that you already created.</span></span>

   ![Het virtuele netwerk configureren](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/07-addsubnet.png)
5. <span data-ttu-id="f667d-184">Maak een tweede subnet.</span><span class="sxs-lookup"><span data-stu-id="f667d-184">Create a second subnet.</span></span> <span data-ttu-id="f667d-185">Klik op **+ Subnet**.</span><span class="sxs-lookup"><span data-stu-id="f667d-185">Click **+ Subnet**.</span></span>
6. <span data-ttu-id="f667d-186">Op de **subnet toevoegen** blade configureren van het subnet met typen **sqlsubnet** onder **naam**.</span><span class="sxs-lookup"><span data-stu-id="f667d-186">On the **Add subnet** blade, configure the subnet by typing **sqlsubnet** under **Name**.</span></span> <span data-ttu-id="f667d-187">Azure automatisch een geldige geeft **-adresbereik**.</span><span class="sxs-lookup"><span data-stu-id="f667d-187">Azure automatically specifies a valid **Address range**.</span></span> <span data-ttu-id="f667d-188">Controleer of dit adresbereik ten minste 10 adressen erin.</span><span class="sxs-lookup"><span data-stu-id="f667d-188">Verify that this address range has at least 10 addresses in it.</span></span> <span data-ttu-id="f667d-189">In een productieomgeving mogelijk meer adressen.</span><span class="sxs-lookup"><span data-stu-id="f667d-189">In a production environment, you might require more addresses.</span></span>
7. <span data-ttu-id="f667d-190">Klik op **OK**.</span><span class="sxs-lookup"><span data-stu-id="f667d-190">Click **OK**.</span></span>

    ![Het virtuele netwerk configureren](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/08-configuresubnet.png)

<span data-ttu-id="f667d-192">De volgende tabel geeft een overzicht van de configuratie-instellingen van het netwerk:</span><span class="sxs-lookup"><span data-stu-id="f667d-192">The following table summarizes the network configuration settings:</span></span>

| <span data-ttu-id="f667d-193">**Veld**</span><span class="sxs-lookup"><span data-stu-id="f667d-193">**Field**</span></span> | <span data-ttu-id="f667d-194">Waarde</span><span class="sxs-lookup"><span data-stu-id="f667d-194">Value</span></span> |
| --- | --- |
| <span data-ttu-id="f667d-195">**Naam**</span><span class="sxs-lookup"><span data-stu-id="f667d-195">**Name**</span></span> |<span data-ttu-id="f667d-196">**autoHAVNET**</span><span class="sxs-lookup"><span data-stu-id="f667d-196">**autoHAVNET**</span></span> |
| <span data-ttu-id="f667d-197">**Adresruimte**</span><span class="sxs-lookup"><span data-stu-id="f667d-197">**Address space**</span></span> |<span data-ttu-id="f667d-198">Deze waarde is afhankelijk van de beschikbare adresruimten in uw abonnement.</span><span class="sxs-lookup"><span data-stu-id="f667d-198">This value depends on the available address spaces in your subscription.</span></span> <span data-ttu-id="f667d-199">Een typische waarde is 10.0.0.0/16.</span><span class="sxs-lookup"><span data-stu-id="f667d-199">A typical value is 10.0.0.0/16.</span></span> |
| <span data-ttu-id="f667d-200">**Subnetnaam**</span><span class="sxs-lookup"><span data-stu-id="f667d-200">**Subnet name**</span></span> |<span data-ttu-id="f667d-201">**beheerder**</span><span class="sxs-lookup"><span data-stu-id="f667d-201">**admin**</span></span> |
| <span data-ttu-id="f667d-202">**Subnetadresbereik**</span><span class="sxs-lookup"><span data-stu-id="f667d-202">**Subnet address range**</span></span> |<span data-ttu-id="f667d-203">Deze waarde is afhankelijk van de beschikbare adresbereiken in uw abonnement.</span><span class="sxs-lookup"><span data-stu-id="f667d-203">This value depends on the available address ranges in your subscription.</span></span> <span data-ttu-id="f667d-204">Een typische waarde is 10.0.0.0/24.</span><span class="sxs-lookup"><span data-stu-id="f667d-204">A typical value is 10.0.0.0/24.</span></span> |
| <span data-ttu-id="f667d-205">**Subnetnaam**</span><span class="sxs-lookup"><span data-stu-id="f667d-205">**Subnet name**</span></span> |<span data-ttu-id="f667d-206">**sqlsubnet**</span><span class="sxs-lookup"><span data-stu-id="f667d-206">**sqlsubnet**</span></span> |
| <span data-ttu-id="f667d-207">**Subnetadresbereik**</span><span class="sxs-lookup"><span data-stu-id="f667d-207">**Subnet address range**</span></span> |<span data-ttu-id="f667d-208">Deze waarde is afhankelijk van de beschikbare adresbereiken in uw abonnement.</span><span class="sxs-lookup"><span data-stu-id="f667d-208">This value depends on the available address ranges in your subscription.</span></span> <span data-ttu-id="f667d-209">Een typische waarde is 10.0.1.0/24.</span><span class="sxs-lookup"><span data-stu-id="f667d-209">A typical value is 10.0.1.0/24.</span></span> |
| <span data-ttu-id="f667d-210">**Abonnement**</span><span class="sxs-lookup"><span data-stu-id="f667d-210">**Subscription**</span></span> |<span data-ttu-id="f667d-211">Geef het abonnement dat u wilt gebruiken.</span><span class="sxs-lookup"><span data-stu-id="f667d-211">Specify the subscription that you intend to use.</span></span> |
| <span data-ttu-id="f667d-212">**Resourcegroep**</span><span class="sxs-lookup"><span data-stu-id="f667d-212">**Resource Group**</span></span> |<span data-ttu-id="f667d-213">**SQL-HA-RG**</span><span class="sxs-lookup"><span data-stu-id="f667d-213">**SQL-HA-RG**</span></span> |
| <span data-ttu-id="f667d-214">**Locatie**</span><span class="sxs-lookup"><span data-stu-id="f667d-214">**Location**</span></span> |<span data-ttu-id="f667d-215">Geef dezelfde locatie die u hebt gekozen voor de resourcegroep.</span><span class="sxs-lookup"><span data-stu-id="f667d-215">Specify the same location that you chose for the resource group.</span></span> |

## <a name="create-availability-sets"></a><span data-ttu-id="f667d-216">Beschikbaarheidssets maken</span><span class="sxs-lookup"><span data-stu-id="f667d-216">Create availability sets</span></span>

<span data-ttu-id="f667d-217">Voordat u virtuele machines maken, moet u beschikbaarheidssets maken.</span><span class="sxs-lookup"><span data-stu-id="f667d-217">Before you create virtual machines, you need to create availability sets.</span></span> <span data-ttu-id="f667d-218">Beschikbaarheidssets Verminder de uitvaltijd van gebeurtenissen voor gepland of ongepland onderhoud.</span><span class="sxs-lookup"><span data-stu-id="f667d-218">Availability sets reduce the downtime for planned or unplanned maintenance events.</span></span> <span data-ttu-id="f667d-219">Een Azure beschikbaarheidsset is een logische groep resources die door Azure wordt geplaatst op fysieke domeinen met fouten en domeinen van de update.</span><span class="sxs-lookup"><span data-stu-id="f667d-219">An Azure availability set is a logical group of resources that Azure places on physical fault domains and update domains.</span></span> <span data-ttu-id="f667d-220">Een foutdomein zorgt ervoor dat de leden van de beschikbaarheidsset afzonderlijke energie- en netwerkbronnen.</span><span class="sxs-lookup"><span data-stu-id="f667d-220">A fault domain ensures that the members of the availability set have separate power and network resources.</span></span> <span data-ttu-id="f667d-221">Een updatedomein zorgt ervoor dat de leden van de beschikbaarheidsset niet worden verbroken voor onderhoud op hetzelfde moment.</span><span class="sxs-lookup"><span data-stu-id="f667d-221">An update domain ensures that members of the availability set aren't brought down for maintenance at the same time.</span></span> <span data-ttu-id="f667d-222">Zie voor meer informatie [de beschikbaarheid van virtuele machines beheren](../manage-availability.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).</span><span class="sxs-lookup"><span data-stu-id="f667d-222">For more information, see [Manage the availability of virtual machines](../manage-availability.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).</span></span>

<span data-ttu-id="f667d-223">U moet twee beschikbaarheidssets.</span><span class="sxs-lookup"><span data-stu-id="f667d-223">You need two availability sets.</span></span> <span data-ttu-id="f667d-224">Een is voor de domeincontrollers.</span><span class="sxs-lookup"><span data-stu-id="f667d-224">One is for the domain controllers.</span></span> <span data-ttu-id="f667d-225">De tweede is voor de VM's van SQL Server.</span><span class="sxs-lookup"><span data-stu-id="f667d-225">The second is for the SQL Server VMs.</span></span>

<span data-ttu-id="f667d-226">Een beschikbaarheidsset maken, gaat u naar de resourcegroep en klik op **toevoegen**.</span><span class="sxs-lookup"><span data-stu-id="f667d-226">To create an availability set, go to the resource group and click **Add**.</span></span> <span data-ttu-id="f667d-227">De resultaten filteren door te typen **beschikbaarheidsset**.</span><span class="sxs-lookup"><span data-stu-id="f667d-227">Filter the results by typing **availability set**.</span></span> <span data-ttu-id="f667d-228">Klik op **Beschikbaarheidsset** in de resultaten en klik vervolgens op **maken**.</span><span class="sxs-lookup"><span data-stu-id="f667d-228">Click **Availability Set** in the results, and then click **Create**.</span></span>

<span data-ttu-id="f667d-229">Configureer twee beschikbaarheidssets overeenkomstig de parameters in de volgende tabel:</span><span class="sxs-lookup"><span data-stu-id="f667d-229">Configure two availability sets according to the parameters in the following table:</span></span>

| <span data-ttu-id="f667d-230">**Veld**</span><span class="sxs-lookup"><span data-stu-id="f667d-230">**Field**</span></span> | <span data-ttu-id="f667d-231">Beschikbaarheidsset domain-controller</span><span class="sxs-lookup"><span data-stu-id="f667d-231">Domain controller availability set</span></span> | <span data-ttu-id="f667d-232">Beschikbaarheidsset voor SQL Server</span><span class="sxs-lookup"><span data-stu-id="f667d-232">SQL Server availability set</span></span> |
| --- | --- | --- |
| <span data-ttu-id="f667d-233">**Naam**</span><span class="sxs-lookup"><span data-stu-id="f667d-233">**Name**</span></span> |<span data-ttu-id="f667d-234">adavailabilityset</span><span class="sxs-lookup"><span data-stu-id="f667d-234">adavailabilityset</span></span> |<span data-ttu-id="f667d-235">sqlavailabilityset</span><span class="sxs-lookup"><span data-stu-id="f667d-235">sqlavailabilityset</span></span> |
| <span data-ttu-id="f667d-236">**Resourcegroep**</span><span class="sxs-lookup"><span data-stu-id="f667d-236">**Resource group**</span></span> |<span data-ttu-id="f667d-237">SQL-HA-RG</span><span class="sxs-lookup"><span data-stu-id="f667d-237">SQL-HA-RG</span></span> |<span data-ttu-id="f667d-238">SQL-HA-RG</span><span class="sxs-lookup"><span data-stu-id="f667d-238">SQL-HA-RG</span></span> |
| <span data-ttu-id="f667d-239">**Domeinen met fouten**</span><span class="sxs-lookup"><span data-stu-id="f667d-239">**Fault domains**</span></span> |<span data-ttu-id="f667d-240">3</span><span class="sxs-lookup"><span data-stu-id="f667d-240">3</span></span> |<span data-ttu-id="f667d-241">3</span><span class="sxs-lookup"><span data-stu-id="f667d-241">3</span></span> |
| <span data-ttu-id="f667d-242">**Domeinen bijwerken**</span><span class="sxs-lookup"><span data-stu-id="f667d-242">**Update domains**</span></span> |<span data-ttu-id="f667d-243">5</span><span class="sxs-lookup"><span data-stu-id="f667d-243">5</span></span> |<span data-ttu-id="f667d-244">3</span><span class="sxs-lookup"><span data-stu-id="f667d-244">3</span></span> |

<span data-ttu-id="f667d-245">Nadat u de beschikbaarheidssets hebt gemaakt, keert u terug naar de resourcegroep in de Azure portal.</span><span class="sxs-lookup"><span data-stu-id="f667d-245">After you create the availability sets, return to the resource group in the Azure portal.</span></span>

## <a name="create-domain-controllers"></a><span data-ttu-id="f667d-246">Maken van domeincontrollers</span><span class="sxs-lookup"><span data-stu-id="f667d-246">Create domain controllers</span></span>
<span data-ttu-id="f667d-247">Wanneer u het netwerk, subnetten, beschikbaarheidssets en een Internet gerichte load balancer hebt gemaakt, bent u klaar om te maken van de virtuele machines voor de domeincontrollers.</span><span class="sxs-lookup"><span data-stu-id="f667d-247">After you've created the network, subnets, availability sets, and an Internet-facing load balancer, you're ready to create the virtual machines for the domain controllers.</span></span>

### <a name="create-virtual-machines-for-the-domain-controllers"></a><span data-ttu-id="f667d-248">Maken van virtuele machines voor de domeincontrollers</span><span class="sxs-lookup"><span data-stu-id="f667d-248">Create virtual machines for the domain controllers</span></span>
<span data-ttu-id="f667d-249">Als u wilt maken en configureren van de domeincontrollers, terug naar de **SQL-HA-RG** resourcegroep.</span><span class="sxs-lookup"><span data-stu-id="f667d-249">To create and configure the domain controllers, return to the **SQL-HA-RG** resource group.</span></span>

1. <span data-ttu-id="f667d-250">Klik op **Add**.</span><span class="sxs-lookup"><span data-stu-id="f667d-250">Click **Add**.</span></span> <span data-ttu-id="f667d-251">De **Alles** blade wordt geopend.</span><span class="sxs-lookup"><span data-stu-id="f667d-251">The **Everything** blade opens.</span></span>
2. <span data-ttu-id="f667d-252">Type **Windows Server 2016 Datacenter**.</span><span class="sxs-lookup"><span data-stu-id="f667d-252">Type **Windows Server 2016 Datacenter**.</span></span>
3. <span data-ttu-id="f667d-253">Klik op **Windows Server 2016 Datacenter**.</span><span class="sxs-lookup"><span data-stu-id="f667d-253">Click **Windows Server 2016 Datacenter**.</span></span> <span data-ttu-id="f667d-254">In de **Windows Server 2016 Datacenter** blade, Controleer of het implementatiemodel **Resource Manager**, en klik vervolgens op **maken**.</span><span class="sxs-lookup"><span data-stu-id="f667d-254">In the **Windows Server 2016 Datacenter** blade, verify that the deployment model is **Resource Manager**, and then click **Create**.</span></span> <span data-ttu-id="f667d-255">Azure wordt geopend de **virtuele machine maken** blade.</span><span class="sxs-lookup"><span data-stu-id="f667d-255">Azure opens the **Create virtual machine** blade.</span></span>

<span data-ttu-id="f667d-256">Herhaal de voorgaande stappen voor het maken van twee virtuele machines.</span><span class="sxs-lookup"><span data-stu-id="f667d-256">Repeat the preceding steps to create two virtual machines.</span></span> <span data-ttu-id="f667d-257">Naam van de twee virtuele machines:</span><span class="sxs-lookup"><span data-stu-id="f667d-257">Name the two virtual machines:</span></span>

* <span data-ttu-id="f667d-258">AD-primaire-dc</span><span class="sxs-lookup"><span data-stu-id="f667d-258">ad-primary-dc</span></span>
* <span data-ttu-id="f667d-259">AD-secundaire-dc</span><span class="sxs-lookup"><span data-stu-id="f667d-259">ad-secondary-dc</span></span>

  > [!NOTE]
  > <span data-ttu-id="f667d-260">De **ad-secundaire-dc** virtuele machine is optioneel, voor hoge beschikbaarheid bieden voor Active Directory Domain Services.</span><span class="sxs-lookup"><span data-stu-id="f667d-260">The **ad-secondary-dc** virtual machine is optional, to provide high availability for Active Directory Domain Services.</span></span>
  >
  >

<span data-ttu-id="f667d-261">De volgende tabel ziet u de instellingen voor deze twee machines:</span><span class="sxs-lookup"><span data-stu-id="f667d-261">The following table shows the settings for these two machines:</span></span>

| <span data-ttu-id="f667d-262">**Veld**</span><span class="sxs-lookup"><span data-stu-id="f667d-262">**Field**</span></span> | <span data-ttu-id="f667d-263">Waarde</span><span class="sxs-lookup"><span data-stu-id="f667d-263">Value</span></span> |
| --- | --- |
| <span data-ttu-id="f667d-264">**Naam**</span><span class="sxs-lookup"><span data-stu-id="f667d-264">**Name**</span></span> |<span data-ttu-id="f667d-265">Eerste domeincontroller: *ad-primaire-dc*.</span><span class="sxs-lookup"><span data-stu-id="f667d-265">First domain controller: *ad-primary-dc*.</span></span></br><span data-ttu-id="f667d-266">Tweede domeincontroller *ad-secundaire-dc*.</span><span class="sxs-lookup"><span data-stu-id="f667d-266">Second domain controller *ad-secondary-dc*.</span></span> |
| <span data-ttu-id="f667d-267">**Type VM-schijf**</span><span class="sxs-lookup"><span data-stu-id="f667d-267">**VM disk type**</span></span> |<span data-ttu-id="f667d-268">SSD</span><span class="sxs-lookup"><span data-stu-id="f667d-268">SSD</span></span> |
| <span data-ttu-id="f667d-269">**Gebruikersnaam**</span><span class="sxs-lookup"><span data-stu-id="f667d-269">**User name**</span></span> |<span data-ttu-id="f667d-270">DomainAdmin</span><span class="sxs-lookup"><span data-stu-id="f667d-270">DomainAdmin</span></span> |
| <span data-ttu-id="f667d-271">**Wachtwoord**</span><span class="sxs-lookup"><span data-stu-id="f667d-271">**Password**</span></span> |<span data-ttu-id="f667d-272">Contoso! 0000</span><span class="sxs-lookup"><span data-stu-id="f667d-272">Contoso!0000</span></span> |
| <span data-ttu-id="f667d-273">**Abonnement**</span><span class="sxs-lookup"><span data-stu-id="f667d-273">**Subscription**</span></span> |<span data-ttu-id="f667d-274">*Uw abonnement*</span><span class="sxs-lookup"><span data-stu-id="f667d-274">*Your subscription*</span></span> |
| <span data-ttu-id="f667d-275">**Resourcegroep**</span><span class="sxs-lookup"><span data-stu-id="f667d-275">**Resource group**</span></span> |<span data-ttu-id="f667d-276">SQL-HA-RG</span><span class="sxs-lookup"><span data-stu-id="f667d-276">SQL-HA-RG</span></span> |
| <span data-ttu-id="f667d-277">**Locatie**</span><span class="sxs-lookup"><span data-stu-id="f667d-277">**Location**</span></span> |<span data-ttu-id="f667d-278">*Uw locatie*</span><span class="sxs-lookup"><span data-stu-id="f667d-278">*Your location*</span></span> |
| <span data-ttu-id="f667d-279">**Grootte**</span><span class="sxs-lookup"><span data-stu-id="f667d-279">**Size**</span></span> |<span data-ttu-id="f667d-280">DS1_V2</span><span class="sxs-lookup"><span data-stu-id="f667d-280">DS1_V2</span></span> |
| <span data-ttu-id="f667d-281">**Storage**</span><span class="sxs-lookup"><span data-stu-id="f667d-281">**Storage**</span></span> | <span data-ttu-id="f667d-282">**Gebruik de schijven van de beheerde** - **Ja**</span><span class="sxs-lookup"><span data-stu-id="f667d-282">**Use managed disks** - **Yes**</span></span> |
| <span data-ttu-id="f667d-283">**Virtueel netwerk**</span><span class="sxs-lookup"><span data-stu-id="f667d-283">**Virtual network**</span></span> |<span data-ttu-id="f667d-284">autoHAVNET</span><span class="sxs-lookup"><span data-stu-id="f667d-284">autoHAVNET</span></span> |
| <span data-ttu-id="f667d-285">**Subnet**</span><span class="sxs-lookup"><span data-stu-id="f667d-285">**Subnet**</span></span> |<span data-ttu-id="f667d-286">Beheerder</span><span class="sxs-lookup"><span data-stu-id="f667d-286">admin</span></span> |
| <span data-ttu-id="f667d-287">**Openbaar IP-adres**</span><span class="sxs-lookup"><span data-stu-id="f667d-287">**Public IP address**</span></span> |<span data-ttu-id="f667d-288">*Dezelfde naam als de virtuele machine*</span><span class="sxs-lookup"><span data-stu-id="f667d-288">*Same name as the VM*</span></span> |
| <span data-ttu-id="f667d-289">**Netwerkbeveiligingsgroep**</span><span class="sxs-lookup"><span data-stu-id="f667d-289">**Network security group**</span></span> |<span data-ttu-id="f667d-290">*Dezelfde naam als de virtuele machine*</span><span class="sxs-lookup"><span data-stu-id="f667d-290">*Same name as the VM*</span></span> |
| <span data-ttu-id="f667d-291">**Beschikbaarheidsset**</span><span class="sxs-lookup"><span data-stu-id="f667d-291">**Availability set**</span></span> |<span data-ttu-id="f667d-292">adavailabilityset</span><span class="sxs-lookup"><span data-stu-id="f667d-292">adavailabilityset</span></span> </br><span data-ttu-id="f667d-293">**Fault-domeinen**: 2</span><span class="sxs-lookup"><span data-stu-id="f667d-293">**Fault domains**:2</span></span></br><span data-ttu-id="f667d-294">**Bijwerken van domeinen**: 2</span><span class="sxs-lookup"><span data-stu-id="f667d-294">**Update domains**:2</span></span>|
| <span data-ttu-id="f667d-295">**Diagnostics**</span><span class="sxs-lookup"><span data-stu-id="f667d-295">**Diagnostics**</span></span> |<span data-ttu-id="f667d-296">Ingeschakeld</span><span class="sxs-lookup"><span data-stu-id="f667d-296">Enabled</span></span> |
| <span data-ttu-id="f667d-297">**Opslagaccount voor diagnostische gegevens**</span><span class="sxs-lookup"><span data-stu-id="f667d-297">**Diagnostics storage account**</span></span> |<span data-ttu-id="f667d-298">*Automatisch gemaakt*</span><span class="sxs-lookup"><span data-stu-id="f667d-298">*Automatically created*</span></span> |

   >[!IMPORTANT]
   ><span data-ttu-id="f667d-299">U kunt alleen een virtuele machine in een beschikbaarheidsset wanneer u deze maakt plaatsen.</span><span class="sxs-lookup"><span data-stu-id="f667d-299">You can only place a VM in an availability set when you create it.</span></span> <span data-ttu-id="f667d-300">U kunt de beschikbaarheid instellen nadat een virtuele machine is gemaakt niet wijzigen.</span><span class="sxs-lookup"><span data-stu-id="f667d-300">You can't change the availability set after a VM is created.</span></span> <span data-ttu-id="f667d-301">Zie [de beschikbaarheid van virtuele machines beheren](../manage-availability.md).</span><span class="sxs-lookup"><span data-stu-id="f667d-301">See [Manage the availability of virtual machines](../manage-availability.md).</span></span>

<span data-ttu-id="f667d-302">Azure maakt de virtuele machines.</span><span class="sxs-lookup"><span data-stu-id="f667d-302">Azure creates the virtual machines.</span></span>

<span data-ttu-id="f667d-303">Nadat de virtuele machines worden gemaakt, configureert u de domeincontroller.</span><span class="sxs-lookup"><span data-stu-id="f667d-303">After the virtual machines are created, configure the domain controller.</span></span>

### <a name="configure-the-domain-controller"></a><span data-ttu-id="f667d-304">De domeincontroller configureren</span><span class="sxs-lookup"><span data-stu-id="f667d-304">Configure the domain controller</span></span>
<span data-ttu-id="f667d-305">In de volgende stappen configureert de **ad-primaire-dc** machines als een domeincontroller voor corp.contoso.com.</span><span class="sxs-lookup"><span data-stu-id="f667d-305">In the following steps, configure the **ad-primary-dc** machine as a domain controller for corp.contoso.com.</span></span>

1. <span data-ttu-id="f667d-306">Open in de portal de **SQL-HA-RG** resource Groepsbeleid en selecteer de **ad-primaire-dc** machine.</span><span class="sxs-lookup"><span data-stu-id="f667d-306">In the portal, open the **SQL-HA-RG** resource group and select the **ad-primary-dc** machine.</span></span> <span data-ttu-id="f667d-307">Op de **ad-primaire-dc** blade, klikt u op **Connect** een RDP-bestand voor toegang tot extern bureaublad te openen.</span><span class="sxs-lookup"><span data-stu-id="f667d-307">On the **ad-primary-dc** blade, click **Connect** to open an RDP file for remote desktop access.</span></span>

    ![Verbinding maken met een virtuele machine](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/20-connectrdp.png)
2. <span data-ttu-id="f667d-309">Meld u aan met uw geconfigureerde beheerdersaccount (**\DomainAdmin**) en het wachtwoord (**Contoso! 0000**).</span><span class="sxs-lookup"><span data-stu-id="f667d-309">Sign in with your configured administrator account (**\DomainAdmin**) and password (**Contoso!0000**).</span></span>
3. <span data-ttu-id="f667d-310">Standaard de **Serverbeheer** dashboard moet worden weergegeven.</span><span class="sxs-lookup"><span data-stu-id="f667d-310">By default, the **Server Manager** dashboard should be displayed.</span></span>
4. <span data-ttu-id="f667d-311">Klik op de **functies en onderdelen toevoegen** koppeling in het dashboard.</span><span class="sxs-lookup"><span data-stu-id="f667d-311">Click the **Add roles and features** link on the dashboard.</span></span>

    ![Server Manager - functies toevoegen](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/22-addfeatures.png)
5. <span data-ttu-id="f667d-313">Selecteer **volgende** totdat u de **serverfuncties** sectie.</span><span class="sxs-lookup"><span data-stu-id="f667d-313">Select **Next** until you get to the **Server Roles** section.</span></span>
6. <span data-ttu-id="f667d-314">Selecteer de **Active Directory Domain Services** en **DNS-Server** rollen.</span><span class="sxs-lookup"><span data-stu-id="f667d-314">Select the **Active Directory Domain Services** and **DNS Server** roles.</span></span> <span data-ttu-id="f667d-315">Wanneer u wordt gevraagd, voeg eventuele aanvullende functies die voor deze rollen vereist zijn.</span><span class="sxs-lookup"><span data-stu-id="f667d-315">When you're prompted, add any additional features that are required by these roles.</span></span>

   > [!NOTE]
   > <span data-ttu-id="f667d-316">Windows waarschuwt u dat er geen statische IP-adres is.</span><span class="sxs-lookup"><span data-stu-id="f667d-316">Windows warns you that there is no static IP address.</span></span> <span data-ttu-id="f667d-317">Als u de configuratie van de test, klikt u op **doorgaan**.</span><span class="sxs-lookup"><span data-stu-id="f667d-317">If you're testing the configuration, click **Continue**.</span></span> <span data-ttu-id="f667d-318">Voor productiescenario's, stelt u het IP-adres naar statisch in de Azure-portal of [PowerShell gebruiken voor het instellen van het statische IP-adres van de domain controller machine](../../../virtual-network/virtual-networks-reserved-private-ip.md).</span><span class="sxs-lookup"><span data-stu-id="f667d-318">For production scenarios, set the IP address to static in the Azure portal, or [use PowerShell to set the static IP address of the domain controller machine](../../../virtual-network/virtual-networks-reserved-private-ip.md).</span></span>
   >
   >

    ![Dialoogvenster rollen toevoegen](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/23-addroles.png)
7. <span data-ttu-id="f667d-320">Klik op **volgende** totdat u de **bevestiging** sectie.</span><span class="sxs-lookup"><span data-stu-id="f667d-320">Click **Next** until you reach the **Confirmation** section.</span></span> <span data-ttu-id="f667d-321">Selecteer de **de doelserver automatisch opnieuw opstarten indien nodig** selectievakje.</span><span class="sxs-lookup"><span data-stu-id="f667d-321">Select the **Restart the destination server automatically if required** check box.</span></span>
8. <span data-ttu-id="f667d-322">Klik op **Install**.</span><span class="sxs-lookup"><span data-stu-id="f667d-322">Click **Install**.</span></span>
9. <span data-ttu-id="f667d-323">Nadat de functies geïnstalleerd hebt, keert u terug naar de **Serverbeheer** dashboard.</span><span class="sxs-lookup"><span data-stu-id="f667d-323">After the features finish installing, return to the **Server Manager** dashboard.</span></span>
10. <span data-ttu-id="f667d-324">Selecteer de nieuwe **AD DS** optie in het linkerdeelvenster.</span><span class="sxs-lookup"><span data-stu-id="f667d-324">Select the new **AD DS** option on the left-hand pane.</span></span>
11. <span data-ttu-id="f667d-325">Klik op de **meer** koppeling op de gele waarschuwing-balk.</span><span class="sxs-lookup"><span data-stu-id="f667d-325">Click the **More** link on the yellow warning bar.</span></span>

    ![Dialoogvenster van de AD DS op de DNS-Server-VM](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/24-addsmore.png)
12. <span data-ttu-id="f667d-327">In de **actie** kolom van de **alle Server-taakdetails** dialoogvenster, klikt u op **deze server verhogen naar een domeincontroller**.</span><span class="sxs-lookup"><span data-stu-id="f667d-327">In the **Action** column of the **All Server Task Details** dialog, click **Promote this server to a domain controller**.</span></span>
13. <span data-ttu-id="f667d-328">In de **Wizard Active Directory Domain Services configureren**, gebruik de volgende waarden:</span><span class="sxs-lookup"><span data-stu-id="f667d-328">In the **Active Directory Domain Services Configuration Wizard**, use the following values:</span></span>

    | <span data-ttu-id="f667d-329">**Pagina**</span><span class="sxs-lookup"><span data-stu-id="f667d-329">**Page**</span></span> | <span data-ttu-id="f667d-330">Instelling</span><span class="sxs-lookup"><span data-stu-id="f667d-330">Setting</span></span> |
    | --- | --- |
    | <span data-ttu-id="f667d-331">**Implementatieconfiguratie**</span><span class="sxs-lookup"><span data-stu-id="f667d-331">**Deployment Configuration**</span></span> |<span data-ttu-id="f667d-332">**Een nieuw forest toevoegen**</span><span class="sxs-lookup"><span data-stu-id="f667d-332">**Add a new forest**</span></span><br/> <span data-ttu-id="f667d-333">**Naam van hoofddomein** corp.contoso.com =</span><span class="sxs-lookup"><span data-stu-id="f667d-333">**Root domain name** = corp.contoso.com</span></span> |
    | <span data-ttu-id="f667d-334">**Opties voor domeincontroller**</span><span class="sxs-lookup"><span data-stu-id="f667d-334">**Domain Controller Options**</span></span> |<span data-ttu-id="f667d-335">**DSRM-wachtwoord** = Contoso! 0000</span><span class="sxs-lookup"><span data-stu-id="f667d-335">**DSRM Password** = Contoso!0000</span></span><br/><span data-ttu-id="f667d-336">**Bevestig het wachtwoord** = Contoso! 0000</span><span class="sxs-lookup"><span data-stu-id="f667d-336">**Confirm Password** = Contoso!0000</span></span> |
14. <span data-ttu-id="f667d-337">Klik op **volgende** te doorlopen van de andere pagina's in de wizard.</span><span class="sxs-lookup"><span data-stu-id="f667d-337">Click **Next** to go through the other pages in the wizard.</span></span> <span data-ttu-id="f667d-338">Op de **controle van vereisten** pagina, controleert u of u het volgende foutbericht weergegeven: **alle controles op vereisten zijn geslaagd**.</span><span class="sxs-lookup"><span data-stu-id="f667d-338">On the **Prerequisites Check** page, verify that you see the following message: **All prerequisite checks passed successfully**.</span></span> <span data-ttu-id="f667d-339">U kunt toepasselijke waarschuwingsberichten bekijken, maar is het mogelijk om door te gaan met de installatie.</span><span class="sxs-lookup"><span data-stu-id="f667d-339">You can review any applicable warning messages, but it's possible to continue with the installation.</span></span>
15. <span data-ttu-id="f667d-340">Klik op **Install**.</span><span class="sxs-lookup"><span data-stu-id="f667d-340">Click **Install**.</span></span> <span data-ttu-id="f667d-341">De **ad-primaire-dc** virtuele machine automatisch opnieuw wordt opgestart.</span><span class="sxs-lookup"><span data-stu-id="f667d-341">The **ad-primary-dc** virtual machine automatically reboots.</span></span>

### <a name="note-the-ip-address-of-the-primary-domain-controller"></a><span data-ttu-id="f667d-342">Noteer de IP-adres van de primaire domeincontroller</span><span class="sxs-lookup"><span data-stu-id="f667d-342">Note the IP address of the primary domain controller</span></span>

<span data-ttu-id="f667d-343">Gebruik de primaire domeincontroller voor DNS.</span><span class="sxs-lookup"><span data-stu-id="f667d-343">Use the primary domain controller for DNS.</span></span> <span data-ttu-id="f667d-344">Let op het primaire domeincontroller IP-adres.</span><span class="sxs-lookup"><span data-stu-id="f667d-344">Note the primary domain controller IP address.</span></span>

<span data-ttu-id="f667d-345">Een manier om op te halen van het primaire domeincontroller IP-adres is via de Azure portal.</span><span class="sxs-lookup"><span data-stu-id="f667d-345">One way to get the primary domain controller IP address is through the Azure portal.</span></span>

1. <span data-ttu-id="f667d-346">Open de resourcegroep op de Azure-portal.</span><span class="sxs-lookup"><span data-stu-id="f667d-346">On the Azure portal, open the resource group.</span></span>

2. <span data-ttu-id="f667d-347">Klik op de primaire domeincontroller.</span><span class="sxs-lookup"><span data-stu-id="f667d-347">Click the primary domain controller.</span></span>

3. <span data-ttu-id="f667d-348">Klik op de blade van de domeincontroller primair domein **netwerkinterfaces**.</span><span class="sxs-lookup"><span data-stu-id="f667d-348">On the primary domain controller blade, click **Network interfaces**.</span></span>

![Netwerkinterfaces](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/25-primarydcip.png)

<span data-ttu-id="f667d-350">Noteer de privé IP-adres voor deze server.</span><span class="sxs-lookup"><span data-stu-id="f667d-350">Note the private IP address for this server.</span></span>

### <a name="configure-the-virtual-network-dns"></a><span data-ttu-id="f667d-351">Het virtuele netwerk DNS configureren</span><span class="sxs-lookup"><span data-stu-id="f667d-351">Configure the virtual network DNS</span></span>
<span data-ttu-id="f667d-352">Na het maken van de eerste domeincontroller en DNS op de eerste server inschakelen, het virtuele netwerk voor het gebruik van deze server voor DNS configureren.</span><span class="sxs-lookup"><span data-stu-id="f667d-352">After you create the first domain controller and enable DNS on the first server, configure the virtual network to use this server for DNS.</span></span>

1. <span data-ttu-id="f667d-353">Klik in de Azure-portal op het virtuele netwerk.</span><span class="sxs-lookup"><span data-stu-id="f667d-353">In the Azure portal, click on the virtual network.</span></span>

2. <span data-ttu-id="f667d-354">Onder **instellingen**, klikt u op **DNS-Server**.</span><span class="sxs-lookup"><span data-stu-id="f667d-354">Under **Settings**, click **DNS Server**.</span></span>

3. <span data-ttu-id="f667d-355">Klik op **aangepaste**, en typt u het privé IP-adres van de primaire domeincontroller.</span><span class="sxs-lookup"><span data-stu-id="f667d-355">Click **Custom**, and type the private IP address of the primary domain controller.</span></span>

4. <span data-ttu-id="f667d-356">Klik op **Opslaan**.</span><span class="sxs-lookup"><span data-stu-id="f667d-356">Click **Save**.</span></span>

### <a name="configure-the-second-domain-controller"></a><span data-ttu-id="f667d-357">De tweede domeincontroller configureren</span><span class="sxs-lookup"><span data-stu-id="f667d-357">Configure the second domain controller</span></span>
<span data-ttu-id="f667d-358">Nadat de primaire domeincontroller opnieuw is opgestart, kunt u de tweede domeincontroller configureren.</span><span class="sxs-lookup"><span data-stu-id="f667d-358">After the primary domain controller reboots, you can configure the second domain controller.</span></span> <span data-ttu-id="f667d-359">Deze stap optioneel is voor hoge beschikbaarheid.</span><span class="sxs-lookup"><span data-stu-id="f667d-359">This optional step is for high availability.</span></span> <span data-ttu-id="f667d-360">Volg deze stappen voor het configureren van de tweede domeincontroller:</span><span class="sxs-lookup"><span data-stu-id="f667d-360">Follow these steps to configure the second domain controller:</span></span>

1. <span data-ttu-id="f667d-361">Open in de portal de **SQL-HA-RG** resource Groepsbeleid en selecteer de **ad-secundaire-dc** machine.</span><span class="sxs-lookup"><span data-stu-id="f667d-361">In the portal, open the **SQL-HA-RG** resource group and select the **ad-secondary-dc** machine.</span></span> <span data-ttu-id="f667d-362">Op de **ad-secundaire-dc** blade, klikt u op **Connect** een RDP-bestand voor toegang tot extern bureaublad te openen.</span><span class="sxs-lookup"><span data-stu-id="f667d-362">On the **ad-secondary-dc** blade, click **Connect** to open an RDP file for remote desktop access.</span></span>
2. <span data-ttu-id="f667d-363">Aanmelden bij de virtuele machine met behulp van uw geconfigureerde beheerdersaccount (**BUILTIN\DomainAdmin**) en het wachtwoord (**Contoso! 0000**).</span><span class="sxs-lookup"><span data-stu-id="f667d-363">Sign in to the VM by using your configured administrator account (**BUILTIN\DomainAdmin**) and password (**Contoso!0000**).</span></span>
3. <span data-ttu-id="f667d-364">Het voorkeurs-DNS-serveradres wijzigen op het adres van de domeincontroller.</span><span class="sxs-lookup"><span data-stu-id="f667d-364">Change the preferred DNS server address to the address of the domain controller.</span></span>
4. <span data-ttu-id="f667d-365">In **Netwerkcentrum**, klikt u op de netwerkinterface.</span><span class="sxs-lookup"><span data-stu-id="f667d-365">In **Network and Sharing Center**, click the network interface.</span></span>
   <span data-ttu-id="f667d-366">![Netwerkinterface](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/26-networkinterface.png)</span><span class="sxs-lookup"><span data-stu-id="f667d-366">![Network interface](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/26-networkinterface.png)</span></span>

5. <span data-ttu-id="f667d-367">Klik op **Eigenschappen**.</span><span class="sxs-lookup"><span data-stu-id="f667d-367">Click **Properties**.</span></span>
6. <span data-ttu-id="f667d-368">Selecteer **Internet Protocol versie 4 (TCP/IPv4)** en klik op **eigenschappen**.</span><span class="sxs-lookup"><span data-stu-id="f667d-368">Select **Internet Protocol Version 4 (TCP/IPv4)** and click **Properties**.</span></span>
7. <span data-ttu-id="f667d-369">Selecteer **de volgende DNS-serveradressen** en geef het adres van de primaire domeincontroller in **voorkeurs-DNS-server**.</span><span class="sxs-lookup"><span data-stu-id="f667d-369">Select **Use the following DNS server addresses** and specify the address of the primary domain controller in **Preferred DNS server**.</span></span>
8. <span data-ttu-id="f667d-370">Klik op **OK**, en vervolgens **sluiten** de wijzigingen doorvoeren.</span><span class="sxs-lookup"><span data-stu-id="f667d-370">Click **OK**, and then **Close** to commit the changes.</span></span> <span data-ttu-id="f667d-371">U bent nu aan de virtuele machine **corp.contoso.com**.</span><span class="sxs-lookup"><span data-stu-id="f667d-371">You are now able to join the VM to **corp.contoso.com**.</span></span>

   >[!IMPORTANT]
   ><span data-ttu-id="f667d-372">Als u de verbinding met uw extern bureaublad na het wijzigen van de DNS-instelling verliest, gaat u naar de Azure-portal en de virtuele machine opnieuw opstarten.</span><span class="sxs-lookup"><span data-stu-id="f667d-372">If you lose the connection to your remote desktop after changing the DNS setting, go to the Azure portal and restart the virtual machine.</span></span>

9. <span data-ttu-id="f667d-373">Open in het externe bureaublad naar de secundaire domeincontroller **Dashboard voor Serverbeheer**.</span><span class="sxs-lookup"><span data-stu-id="f667d-373">From the remote desktop to the secondary domain controller, open **Server Manager Dashboard**.</span></span>
10. <span data-ttu-id="f667d-374">Klik op de **functies en onderdelen toevoegen** koppeling in het dashboard.</span><span class="sxs-lookup"><span data-stu-id="f667d-374">Click the **Add roles and features** link on the dashboard.</span></span>

    ![Server Manager - functies toevoegen](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/22-addfeatures.png)
11. <span data-ttu-id="f667d-376">Selecteer **volgende** totdat u de **serverfuncties** sectie.</span><span class="sxs-lookup"><span data-stu-id="f667d-376">Select **Next** until you get to the **Server Roles** section.</span></span>
12. <span data-ttu-id="f667d-377">Selecteer de **Active Directory Domain Services** en **DNS-Server** rollen.</span><span class="sxs-lookup"><span data-stu-id="f667d-377">Select the **Active Directory Domain Services** and **DNS Server** roles.</span></span> <span data-ttu-id="f667d-378">Wanneer u wordt gevraagd, voeg eventuele aanvullende functies die voor deze rollen vereist zijn.</span><span class="sxs-lookup"><span data-stu-id="f667d-378">When you're prompted, add any additional features that are required by these roles.</span></span>
13. <span data-ttu-id="f667d-379">Nadat de functies geïnstalleerd hebt, keert u terug naar de **Serverbeheer** dashboard.</span><span class="sxs-lookup"><span data-stu-id="f667d-379">After the features finish installing, return to the **Server Manager** dashboard.</span></span>
14. <span data-ttu-id="f667d-380">Selecteer de nieuwe **AD DS** optie in het linkerdeelvenster.</span><span class="sxs-lookup"><span data-stu-id="f667d-380">Select the new **AD DS** option on the left-hand pane.</span></span>
15. <span data-ttu-id="f667d-381">Klik op de **meer** koppeling op de gele waarschuwing-balk.</span><span class="sxs-lookup"><span data-stu-id="f667d-381">Click the **More** link on the yellow warning bar.</span></span>
16. <span data-ttu-id="f667d-382">In de **actie** kolom van de **alle Server-taakdetails** dialoogvenster, klikt u op **deze server verhogen naar een domeincontroller**.</span><span class="sxs-lookup"><span data-stu-id="f667d-382">In the **Action** column of the **All Server Task Details** dialog, click **Promote this server to a domain controller**.</span></span>
17. <span data-ttu-id="f667d-383">Onder **implementatieconfiguratie**, selecteer **een domeincontroller toevoegt aan een bestaand domein**.</span><span class="sxs-lookup"><span data-stu-id="f667d-383">Under **Deployment Configuration**, select **Add a domain controller to an existing domain**.</span></span>
   <span data-ttu-id="f667d-384">![Implementatieconfiguratie](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/28-deploymentconfig.png)</span><span class="sxs-lookup"><span data-stu-id="f667d-384">![Deployment configuration](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/28-deploymentconfig.png)</span></span>
18. <span data-ttu-id="f667d-385">Klik op **Selecteren**.</span><span class="sxs-lookup"><span data-stu-id="f667d-385">Click **Select**.</span></span>
19. <span data-ttu-id="f667d-386">Verbinding maken met behulp van de administrator-account (**CORP. Contoso.COM\domainadmin**) en het wachtwoord (**Contoso! 0000**).</span><span class="sxs-lookup"><span data-stu-id="f667d-386">Connect by using the administrator account (**CORP.CONTOSO.COM\domainadmin**) and password (**Contoso!0000**).</span></span>
20. <span data-ttu-id="f667d-387">In **Selecteer een domein in het forest**, klikt u op uw domein en klik vervolgens op **OK**.</span><span class="sxs-lookup"><span data-stu-id="f667d-387">In **Select a domain from the forest**, click your domain, and then click **OK**.</span></span>
21. <span data-ttu-id="f667d-388">In **opties voor domeincontroller**, gebruikt u de standaardwaarden en een DSRM-wachtwoord instellen.</span><span class="sxs-lookup"><span data-stu-id="f667d-388">In **Domain Controller Options**, use the default values and set a DSRM password.</span></span>

   >[!NOTE]
   ><span data-ttu-id="f667d-389">De **DNS-opties** pagina worden gewaarschuwd dat een overdracht voor deze DNS-server kan niet worden gemaakt.</span><span class="sxs-lookup"><span data-stu-id="f667d-389">The **DNS Options** page might warn you that a delegation for this DNS server can't be created.</span></span> <span data-ttu-id="f667d-390">U kunt deze waarschuwing in niet-productieve omgevingen negeren.</span><span class="sxs-lookup"><span data-stu-id="f667d-390">You can ignore this warning in non-production environments.</span></span>
22. <span data-ttu-id="f667d-391">Klik op **volgende** totdat het dialoogvenster bereikt de **vereisten** controleren.</span><span class="sxs-lookup"><span data-stu-id="f667d-391">Click **Next** until the dialog reaches the **Prerequisites** check.</span></span> <span data-ttu-id="f667d-392">Klik vervolgens op **Installeren**.</span><span class="sxs-lookup"><span data-stu-id="f667d-392">Then click **Install**.</span></span>

<span data-ttu-id="f667d-393">Nadat de server klaar is voor wijzigingen in de configuratie, moet u de server opnieuw opstarten.</span><span class="sxs-lookup"><span data-stu-id="f667d-393">After the server finishes the configuration changes, restart the server.</span></span>

### <a name="add-the-private-ip-address-to-the-second-domain-controller-to-the-vpn-dns-server"></a><span data-ttu-id="f667d-394">Het privé IP-adres toevoegen aan de tweede domeincontroller voor de VPN-DNS-Server</span><span class="sxs-lookup"><span data-stu-id="f667d-394">Add the Private IP Address to the second domain controller to the VPN DNS Server</span></span>

<span data-ttu-id="f667d-395">Wijzig de DNS-Server zodanig dat het IP-adres van de secundaire domeincontroller in de Azure-portal onder virtuele netwerk.</span><span class="sxs-lookup"><span data-stu-id="f667d-395">In the Azure portal, under virtual network, change the DNS Server to include the IP address of the secondary domain controller.</span></span> <span data-ttu-id="f667d-396">Hierdoor kan de DNS-service redundantie.</span><span class="sxs-lookup"><span data-stu-id="f667d-396">This allows the DNS service redundancy.</span></span>

### <span data-ttu-id="f667d-397"><a name=DomainAccounts></a>Configureer de domeinaccounts</span><span class="sxs-lookup"><span data-stu-id="f667d-397"><a name=DomainAccounts></a> Configure the domain accounts</span></span>

<span data-ttu-id="f667d-398">In de volgende stappen configureert u de Active Directory-accounts.</span><span class="sxs-lookup"><span data-stu-id="f667d-398">In the next steps, you configure the Active Directory accounts.</span></span> <span data-ttu-id="f667d-399">De volgende tabel toont de accounts:</span><span class="sxs-lookup"><span data-stu-id="f667d-399">The following table shows the accounts:</span></span>

| |<span data-ttu-id="f667d-400">Installatie-account</span><span class="sxs-lookup"><span data-stu-id="f667d-400">Installation account</span></span><br/> |<span data-ttu-id="f667d-401">SQL Server-0</span><span class="sxs-lookup"><span data-stu-id="f667d-401">sqlserver-0</span></span> <br/><span data-ttu-id="f667d-402">SQL Server en SQL Agent-Service-account</span><span class="sxs-lookup"><span data-stu-id="f667d-402">SQL Server and SQL Agent Service account</span></span> |<span data-ttu-id="f667d-403">SQL Server-1</span><span class="sxs-lookup"><span data-stu-id="f667d-403">sqlserver-1</span></span><br/><span data-ttu-id="f667d-404">SQL Server en SQL Agent-Service-account</span><span class="sxs-lookup"><span data-stu-id="f667d-404">SQL Server and SQL Agent Service account</span></span>
| --- | --- | --- | ---
|<span data-ttu-id="f667d-405">**Voornaam**</span><span class="sxs-lookup"><span data-stu-id="f667d-405">**First Name**</span></span> |<span data-ttu-id="f667d-406">Installeren</span><span class="sxs-lookup"><span data-stu-id="f667d-406">Install</span></span> |<span data-ttu-id="f667d-407">SQLSvc1</span><span class="sxs-lookup"><span data-stu-id="f667d-407">SQLSvc1</span></span> | <span data-ttu-id="f667d-408">SQLSvc2</span><span class="sxs-lookup"><span data-stu-id="f667d-408">SQLSvc2</span></span>
|<span data-ttu-id="f667d-409">**SamAccountName van gebruiker**</span><span class="sxs-lookup"><span data-stu-id="f667d-409">**User SamAccountName**</span></span> |<span data-ttu-id="f667d-410">Installeren</span><span class="sxs-lookup"><span data-stu-id="f667d-410">Install</span></span> |<span data-ttu-id="f667d-411">SQLSvc1</span><span class="sxs-lookup"><span data-stu-id="f667d-411">SQLSvc1</span></span> | <span data-ttu-id="f667d-412">SQLSvc2</span><span class="sxs-lookup"><span data-stu-id="f667d-412">SQLSvc2</span></span>

<span data-ttu-id="f667d-413">Gebruik de volgende stappen om elk account te maken.</span><span class="sxs-lookup"><span data-stu-id="f667d-413">Use the following steps to create each account.</span></span>

1. <span data-ttu-id="f667d-414">Aanmelden bij de **ad-primaire-dc** machine.</span><span class="sxs-lookup"><span data-stu-id="f667d-414">Sign in to the **ad-primary-dc** machine.</span></span>
2. <span data-ttu-id="f667d-415">In **Serverbeheer**, selecteer **extra**, en klik vervolgens op **Active Directory Administrative Center**.</span><span class="sxs-lookup"><span data-stu-id="f667d-415">In **Server Manager**, select **Tools**, and then click **Active Directory Administrative Center**.</span></span>   
3. <span data-ttu-id="f667d-416">Selecteer **corp (lokaal)** in het linkerdeelvenster.</span><span class="sxs-lookup"><span data-stu-id="f667d-416">Select **corp (local)** from the left pane.</span></span>
4. <span data-ttu-id="f667d-417">Aan de rechterkant **taken** deelvenster **nieuw**, en klik vervolgens op **gebruiker**.</span><span class="sxs-lookup"><span data-stu-id="f667d-417">On the right **Tasks** pane, select **New**, and then click **User**.</span></span>
   <span data-ttu-id="f667d-418">![Active Directory-beheercentrum](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/29-addcnewuser.png)</span><span class="sxs-lookup"><span data-stu-id="f667d-418">![Active Directory Administrative Center](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/29-addcnewuser.png)</span></span>

   >[!TIP]
   ><span data-ttu-id="f667d-419">Stel een complex wachtwoord voor elke account.</span><span class="sxs-lookup"><span data-stu-id="f667d-419">Set a complex password for each account.</span></span><br/> <span data-ttu-id="f667d-420">Niet-productieve omgevingen, stel de gebruikersaccount nooit verloopt.</span><span class="sxs-lookup"><span data-stu-id="f667d-420">For non-production environments, set the user account to never expire.</span></span>

5. <span data-ttu-id="f667d-421">Klik op **OK** voor het maken van de gebruiker.</span><span class="sxs-lookup"><span data-stu-id="f667d-421">Click **OK** to create the user.</span></span>
6. <span data-ttu-id="f667d-422">Herhaal de voorgaande stappen voor elk van de drie accounts.</span><span class="sxs-lookup"><span data-stu-id="f667d-422">Repeat the preceding steps for each of the three accounts.</span></span>

### <a name="grant-the-required-permissions-to-the-installation-account"></a><span data-ttu-id="f667d-423">De vereiste machtigingen toewijzen aan het installatie-account</span><span class="sxs-lookup"><span data-stu-id="f667d-423">Grant the required permissions to the installation account</span></span>
1. <span data-ttu-id="f667d-424">In de **Active Directory Administrative Center**, selecteer **corp (lokaal)** in het linkerdeelvenster.</span><span class="sxs-lookup"><span data-stu-id="f667d-424">In the **Active Directory Administrative Center**, select **corp (local)** in the left pane.</span></span> <span data-ttu-id="f667d-425">Klik in de rechterkolom **taken** deelvenster, klikt u op **eigenschappen**.</span><span class="sxs-lookup"><span data-stu-id="f667d-425">Then in the right-hand **Tasks** pane, click **Properties**.</span></span>

    ![Gebruikerseigenschappen CORP](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/31-addcproperties.png)
2. <span data-ttu-id="f667d-427">Selecteer **extensies**, en klik vervolgens op de **Geavanceerd** knop op de **beveiliging** tabblad.</span><span class="sxs-lookup"><span data-stu-id="f667d-427">Select **Extensions**, and then click the **Advanced** button on the **Security** tab.</span></span>
3. <span data-ttu-id="f667d-428">In de **geavanceerde beveiligingsinstellingen voor de corp** dialoogvenster, klikt u op **toevoegen**.</span><span class="sxs-lookup"><span data-stu-id="f667d-428">In the **Advanced Security Settings for corp** dialog, click **Add**.</span></span>
4. <span data-ttu-id="f667d-429">Klik op **een principal selecteren**, zoeken naar **CORP\Install**, en klik vervolgens op **OK**.</span><span class="sxs-lookup"><span data-stu-id="f667d-429">Click **Select a principal**, search for **CORP\Install**, and then click **OK**.</span></span>
5. <span data-ttu-id="f667d-430">Selecteer de **alle eigenschappen lezen** selectievakje.</span><span class="sxs-lookup"><span data-stu-id="f667d-430">Select the **Read all properties** check box.</span></span>

6. <span data-ttu-id="f667d-431">Selecteer de **Computerobjecten maken** selectievakje.</span><span class="sxs-lookup"><span data-stu-id="f667d-431">Select the **Create Computer objects** check box.</span></span>

     ![Gebruikersmachtigingen Corp](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/33-addpermissions.png)
7. <span data-ttu-id="f667d-433">Klik op **OK**, en klik vervolgens op **OK** opnieuw.</span><span class="sxs-lookup"><span data-stu-id="f667d-433">Click **OK**, and then click **OK** again.</span></span> <span data-ttu-id="f667d-434">Sluit de **corp** eigenschappenvenster.</span><span class="sxs-lookup"><span data-stu-id="f667d-434">Close the **corp** properties window.</span></span>

<span data-ttu-id="f667d-435">Nu dat u klaar bent met het configureren van Active Directory en de gebruikersobjecten, twee SQL Server-VM's en de virtuele machine van een witness-server maken.</span><span class="sxs-lookup"><span data-stu-id="f667d-435">Now that you've finished configuring Active Directory and the user objects, create two SQL Server VMs and a witness server VM.</span></span> <span data-ttu-id="f667d-436">Vervolgens worden toegevoegd aan alle drie aan het domein.</span><span class="sxs-lookup"><span data-stu-id="f667d-436">Then join all three to the domain.</span></span>

## <a name="create-sql-server-vms"></a><span data-ttu-id="f667d-437">SQL Server-VM's maken</span><span class="sxs-lookup"><span data-stu-id="f667d-437">Create SQL Server VMs</span></span>

<span data-ttu-id="f667d-438">Drie extra virtuele machines maken.</span><span class="sxs-lookup"><span data-stu-id="f667d-438">Create three additional virtual machines.</span></span> <span data-ttu-id="f667d-439">De oplossing vereist twee virtuele machines met SQL Server-exemplaren.</span><span class="sxs-lookup"><span data-stu-id="f667d-439">The solution requires two virtual machines with SQL Server instances.</span></span> <span data-ttu-id="f667d-440">Een derde virtuele machine fungeert als een witness.</span><span class="sxs-lookup"><span data-stu-id="f667d-440">A third virtual machine will function as a witness.</span></span> <span data-ttu-id="f667d-441">Windows Server 2016 kunt gebruiken een [cloud witness](http://docs.microsoft.com/windows-server/failover-clustering/deploy-cloud-witness), maar voor consistentie met eerdere besturingssystemen in dit document maakt gebruik van een virtuele machine voor een witness.</span><span class="sxs-lookup"><span data-stu-id="f667d-441">Windows Server 2016 can use a [cloud witness](http://docs.microsoft.com/windows-server/failover-clustering/deploy-cloud-witness), however for consistency with previous operating systems this document uses a virtual machine for a witness.</span></span>  

<span data-ttu-id="f667d-442">Houd rekening met de volgende deisign beslissingen voordat u doorgaat.</span><span class="sxs-lookup"><span data-stu-id="f667d-442">Before you proceed consider the following deisign decisions.</span></span>

* <span data-ttu-id="f667d-443">**Opslag - Azure schijven die worden beheerd**</span><span class="sxs-lookup"><span data-stu-id="f667d-443">**Storage - Azure Managed Disks**</span></span>

   <span data-ttu-id="f667d-444">Voor de virtuele-machineopslag Azure beheerd schijven te gebruiken.</span><span class="sxs-lookup"><span data-stu-id="f667d-444">For the virtual machine storage, use Azure Managed Disks.</span></span> <span data-ttu-id="f667d-445">Microsoft raadt beheerd schijven voor virtuele machines van SQL Server.</span><span class="sxs-lookup"><span data-stu-id="f667d-445">Microsoft recommends Managed Disks for SQL Server virtual machines.</span></span> <span data-ttu-id="f667d-446">Managed Disks verwerken de opslag achter de schermen.</span><span class="sxs-lookup"><span data-stu-id="f667d-446">Managed Disks handles storage behind the scenes.</span></span> <span data-ttu-id="f667d-447">Bovendien distribueert Azure de opslagresources zodat voldoende redundantie wordt geboden wanneer virtuele machines met Managed Disks zich in dezelfde beschikbaarheidsset bevinden.</span><span class="sxs-lookup"><span data-stu-id="f667d-447">In addition, when virtual machines with Managed Disks are in the same availability set, Azure distributes the storage resources to provide appropriate redundancy.</span></span> <span data-ttu-id="f667d-448">Zie [Azure Managed Disks overview](../managed-disks-overview.md) (Overzicht van Azure Managed Disks) voor meer informatie.</span><span class="sxs-lookup"><span data-stu-id="f667d-448">For additional information, see [Azure Managed Disks Overview](../managed-disks-overview.md).</span></span> <span data-ttu-id="f667d-449">Zie voor meer details over beheerde schijven in een beschikbaarheidsset [beheerd schijven gebruiken voor virtuele machines in een beschikbaarheidsset](../manage-availability.md#use-managed-disks-for-vms-in-an-availability-set).</span><span class="sxs-lookup"><span data-stu-id="f667d-449">For specifics about managed disks in an availability set, see [Use Managed Disks for VMs in an availability set](../manage-availability.md#use-managed-disks-for-vms-in-an-availability-set).</span></span>

* <span data-ttu-id="f667d-450">**Netwerk - particuliere IP-adressen in productie**</span><span class="sxs-lookup"><span data-stu-id="f667d-450">**Network - Private IP addresses in production**</span></span>

   <span data-ttu-id="f667d-451">Deze zelfstudie maakt gebruik van openbare IP-adressen voor de virtuele machines.</span><span class="sxs-lookup"><span data-stu-id="f667d-451">For the virtual machines, this tutorial uses public IP addresses.</span></span> <span data-ttu-id="f667d-452">Hierdoor kan externe verbinding rechtstreeks naar de virtuele machine via het internet - het configuratiestappen eenvoudiger maakt.</span><span class="sxs-lookup"><span data-stu-id="f667d-452">This enables remote connection directly to the virtual machine over the internet - it makes configuration steps easier.</span></span> <span data-ttu-id="f667d-453">Microsoft raadt alleen privé IP-adressen in een productieomgeving aan om te reduceren de kwetsbaarheidfootprint van het exemplaar van SQL Server VM-resource.</span><span class="sxs-lookup"><span data-stu-id="f667d-453">In production environments, Microsoft recommends only private IP addresses in order to reduce the vulnerability footprint of the SQL Server instance VM resource.</span></span>

### <a name="create-and-configure-the-sql-server-vms"></a><span data-ttu-id="f667d-454">Maken en configureren van de VM's van SQL Server</span><span class="sxs-lookup"><span data-stu-id="f667d-454">Create and configure the SQL Server VMs</span></span>
<span data-ttu-id="f667d-455">Maak vervolgens drie virtuele machines--twee SQL Server-VM's en een VM voor een extra clusterknooppunt.</span><span class="sxs-lookup"><span data-stu-id="f667d-455">Next, create three VMs--two SQL Server VMs and a VM for an additional cluster node.</span></span> <span data-ttu-id="f667d-456">Voor het maken van elk van de VM, gaat u terug naar de **SQL-HA-RG** resourcegroep, klikt u op **toevoegen**, zoeken naar het juiste galerij-item, klikt u op **virtuele Machine**, en klik vervolgens op  **Vanuit galerie**.</span><span class="sxs-lookup"><span data-stu-id="f667d-456">To create each of the VMs, go back to the **SQL-HA-RG** resource group, click **Add**, search for the appropriate gallery item, click **Virtual Machine**, and then click **From Gallery**.</span></span> <span data-ttu-id="f667d-457">Gebruik de informatie in de volgende tabel kunt u de virtuele machines maken:</span><span class="sxs-lookup"><span data-stu-id="f667d-457">Use the information in the following table to help you create the VMs:</span></span>


| <span data-ttu-id="f667d-458">Pagina</span><span class="sxs-lookup"><span data-stu-id="f667d-458">Page</span></span> | <span data-ttu-id="f667d-459">VM1</span><span class="sxs-lookup"><span data-stu-id="f667d-459">VM1</span></span> | <span data-ttu-id="f667d-460">VM2</span><span class="sxs-lookup"><span data-stu-id="f667d-460">VM2</span></span> | <span data-ttu-id="f667d-461">VM3</span><span class="sxs-lookup"><span data-stu-id="f667d-461">VM3</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="f667d-462">Selecteer het juiste galerij-item</span><span class="sxs-lookup"><span data-stu-id="f667d-462">Select the appropriate gallery item</span></span> |<span data-ttu-id="f667d-463">**Windows Server 2016 Datacenter**</span><span class="sxs-lookup"><span data-stu-id="f667d-463">**Windows Server 2016 Datacenter**</span></span> |<span data-ttu-id="f667d-464">**SQL Server 2016 SP1 Enterprise op WindowsServer 2016**</span><span class="sxs-lookup"><span data-stu-id="f667d-464">**SQL Server 2016 SP1 Enterprise on Windows Server 2016**</span></span> |<span data-ttu-id="f667d-465">**SQL Server 2016 SP1 Enterprise op WindowsServer 2016**</span><span class="sxs-lookup"><span data-stu-id="f667d-465">**SQL Server 2016 SP1 Enterprise on Windows Server 2016**</span></span> |
| <span data-ttu-id="f667d-466">Virtuele-machineconfiguratie **basisbeginselen**</span><span class="sxs-lookup"><span data-stu-id="f667d-466">Virtual machine configuration **Basics**</span></span> |<span data-ttu-id="f667d-467">**Naam** cluster fsw =</span><span class="sxs-lookup"><span data-stu-id="f667d-467">**Name** = cluster-fsw</span></span><br/><span data-ttu-id="f667d-468">**Gebruikersnaam** DomainAdmin =</span><span class="sxs-lookup"><span data-stu-id="f667d-468">**User Name** = DomainAdmin</span></span><br/><span data-ttu-id="f667d-469">**Wachtwoord** = Contoso! 0000</span><span class="sxs-lookup"><span data-stu-id="f667d-469">**Password** = Contoso!0000</span></span><br/><span data-ttu-id="f667d-470">**Abonnement** = van uw abonnement</span><span class="sxs-lookup"><span data-stu-id="f667d-470">**Subscription** = Your subscription</span></span><br/><span data-ttu-id="f667d-471">**Resourcegroep** SQL-HA-RG =</span><span class="sxs-lookup"><span data-stu-id="f667d-471">**Resource group** = SQL-HA-RG</span></span><br/><span data-ttu-id="f667d-472">**Locatie** = van uw azure-locatie</span><span class="sxs-lookup"><span data-stu-id="f667d-472">**Location** = Your azure location</span></span> |<span data-ttu-id="f667d-473">**Naam** sqlserver-0 =</span><span class="sxs-lookup"><span data-stu-id="f667d-473">**Name** = sqlserver-0</span></span><br/><span data-ttu-id="f667d-474">**Gebruikersnaam** DomainAdmin =</span><span class="sxs-lookup"><span data-stu-id="f667d-474">**User Name** = DomainAdmin</span></span><br/><span data-ttu-id="f667d-475">**Wachtwoord** = Contoso! 0000</span><span class="sxs-lookup"><span data-stu-id="f667d-475">**Password** = Contoso!0000</span></span><br/><span data-ttu-id="f667d-476">**Abonnement** = van uw abonnement</span><span class="sxs-lookup"><span data-stu-id="f667d-476">**Subscription** = Your subscription</span></span><br/><span data-ttu-id="f667d-477">**Resourcegroep** SQL-HA-RG =</span><span class="sxs-lookup"><span data-stu-id="f667d-477">**Resource group** = SQL-HA-RG</span></span><br/><span data-ttu-id="f667d-478">**Locatie** = van uw azure-locatie</span><span class="sxs-lookup"><span data-stu-id="f667d-478">**Location** = Your azure location</span></span> |<span data-ttu-id="f667d-479">**Naam** sqlserver-1 =</span><span class="sxs-lookup"><span data-stu-id="f667d-479">**Name** = sqlserver-1</span></span><br/><span data-ttu-id="f667d-480">**Gebruikersnaam** DomainAdmin =</span><span class="sxs-lookup"><span data-stu-id="f667d-480">**User Name** = DomainAdmin</span></span><br/><span data-ttu-id="f667d-481">**Wachtwoord** = Contoso! 0000</span><span class="sxs-lookup"><span data-stu-id="f667d-481">**Password** = Contoso!0000</span></span><br/><span data-ttu-id="f667d-482">**Abonnement** = van uw abonnement</span><span class="sxs-lookup"><span data-stu-id="f667d-482">**Subscription** = Your subscription</span></span><br/><span data-ttu-id="f667d-483">**Resourcegroep** SQL-HA-RG =</span><span class="sxs-lookup"><span data-stu-id="f667d-483">**Resource group** = SQL-HA-RG</span></span><br/><span data-ttu-id="f667d-484">**Locatie** = van uw azure-locatie</span><span class="sxs-lookup"><span data-stu-id="f667d-484">**Location** = Your azure location</span></span> |
| <span data-ttu-id="f667d-485">Virtuele-machineconfiguratie **grootte**</span><span class="sxs-lookup"><span data-stu-id="f667d-485">Virtual machine configuration **Size**</span></span> |<span data-ttu-id="f667d-486">**De grootte van** = DS1\_V2 (1 kerngeheugen, 3.5 GB)</span><span class="sxs-lookup"><span data-stu-id="f667d-486">**SIZE** = DS1\_V2 (1 core, 3.5 GB)</span></span> |<span data-ttu-id="f667d-487">**De grootte van** DS2 =\_V2 (2 kernen, 7 GB)</span><span class="sxs-lookup"><span data-stu-id="f667d-487">**SIZE** = DS2\_V2 (2 cores, 7 GB)</span></span></br><span data-ttu-id="f667d-488">De grootte moet ondersteuning bieden voor SSD-opslag (ondersteuning van Premium-schijven.</span><span class="sxs-lookup"><span data-stu-id="f667d-488">The size must support SSD storage (Premium disk support.</span></span> <span data-ttu-id="f667d-489">))</span><span class="sxs-lookup"><span data-stu-id="f667d-489">))</span></span> |<span data-ttu-id="f667d-490">**De grootte van** DS2 =\_V2 (2 kernen, 7 GB)</span><span class="sxs-lookup"><span data-stu-id="f667d-490">**SIZE** = DS2\_V2 (2 cores, 7 GB)</span></span> |
| <span data-ttu-id="f667d-491">Virtuele-machineconfiguratie **instellingen**</span><span class="sxs-lookup"><span data-stu-id="f667d-491">Virtual machine configuration **Settings**</span></span> |<span data-ttu-id="f667d-492">**Opslag**: gebruik schijven die worden beheerd.</span><span class="sxs-lookup"><span data-stu-id="f667d-492">**Storage**: Use managed disks.</span></span><br/><span data-ttu-id="f667d-493">**Virtueel netwerk** autoHAVNET =</span><span class="sxs-lookup"><span data-stu-id="f667d-493">**Virtual network** = autoHAVNET</span></span><br/><span data-ttu-id="f667d-494">**Subnet** sqlsubnet(10.1.1.0/24) =</span><span class="sxs-lookup"><span data-stu-id="f667d-494">**Subnet** = sqlsubnet(10.1.1.0/24)</span></span><br/><span data-ttu-id="f667d-495">**Openbaar IP-adres** automatisch is gegenereerd.</span><span class="sxs-lookup"><span data-stu-id="f667d-495">**Public IP address** automatically generated.</span></span><br/><span data-ttu-id="f667d-496">**Netwerkbeveiligingsgroep** = geen</span><span class="sxs-lookup"><span data-stu-id="f667d-496">**Network security group** = None</span></span><br/><span data-ttu-id="f667d-497">**Bewaking van diagnostische gegevens** = ingeschakeld</span><span class="sxs-lookup"><span data-stu-id="f667d-497">**Monitoring Diagnostics** = Enabled</span></span><br/><span data-ttu-id="f667d-498">**Opslagaccount voor diagnostische gegevens** = gebruik een automatisch gegenereerde storage-account</span><span class="sxs-lookup"><span data-stu-id="f667d-498">**Diagnostics storage account** = Use an automatically generated storage account</span></span><br/><span data-ttu-id="f667d-499">**Beschikbaarheidsset** sqlAvailabilitySet =</span><span class="sxs-lookup"><span data-stu-id="f667d-499">**Availability set** = sqlAvailabilitySet</span></span><br/> |<span data-ttu-id="f667d-500">**Opslag**: gebruik schijven die worden beheerd.</span><span class="sxs-lookup"><span data-stu-id="f667d-500">**Storage**: Use managed disks.</span></span><br/><span data-ttu-id="f667d-501">**Virtueel netwerk** autoHAVNET =</span><span class="sxs-lookup"><span data-stu-id="f667d-501">**Virtual network** = autoHAVNET</span></span><br/><span data-ttu-id="f667d-502">**Subnet** sqlsubnet(10.1.1.0/24) =</span><span class="sxs-lookup"><span data-stu-id="f667d-502">**Subnet** = sqlsubnet(10.1.1.0/24)</span></span><br/><span data-ttu-id="f667d-503">**Openbaar IP-adres** automatisch is gegenereerd.</span><span class="sxs-lookup"><span data-stu-id="f667d-503">**Public IP address** automatically generated.</span></span><br/><span data-ttu-id="f667d-504">**Netwerkbeveiligingsgroep** = geen</span><span class="sxs-lookup"><span data-stu-id="f667d-504">**Network security group** = None</span></span><br/><span data-ttu-id="f667d-505">**Bewaking van diagnostische gegevens** = ingeschakeld</span><span class="sxs-lookup"><span data-stu-id="f667d-505">**Monitoring Diagnostics** = Enabled</span></span><br/><span data-ttu-id="f667d-506">**Opslagaccount voor diagnostische gegevens** = gebruik een automatisch gegenereerde storage-account</span><span class="sxs-lookup"><span data-stu-id="f667d-506">**Diagnostics storage account** = Use an automatically generated storage account</span></span><br/><span data-ttu-id="f667d-507">**Beschikbaarheidsset** sqlAvailabilitySet =</span><span class="sxs-lookup"><span data-stu-id="f667d-507">**Availability set** = sqlAvailabilitySet</span></span><br/> |<span data-ttu-id="f667d-508">**Opslag**: gebruik schijven die worden beheerd.</span><span class="sxs-lookup"><span data-stu-id="f667d-508">**Storage**: Use managed disks.</span></span><br/><span data-ttu-id="f667d-509">**Virtueel netwerk** autoHAVNET =</span><span class="sxs-lookup"><span data-stu-id="f667d-509">**Virtual network** = autoHAVNET</span></span><br/><span data-ttu-id="f667d-510">**Subnet** sqlsubnet(10.1.1.0/24) =</span><span class="sxs-lookup"><span data-stu-id="f667d-510">**Subnet** = sqlsubnet(10.1.1.0/24)</span></span><br/><span data-ttu-id="f667d-511">**Openbaar IP-adres** automatisch is gegenereerd.</span><span class="sxs-lookup"><span data-stu-id="f667d-511">**Public IP address** automatically generated.</span></span><br/><span data-ttu-id="f667d-512">**Netwerkbeveiligingsgroep** = geen</span><span class="sxs-lookup"><span data-stu-id="f667d-512">**Network security group** = None</span></span><br/><span data-ttu-id="f667d-513">**Bewaking van diagnostische gegevens** = ingeschakeld</span><span class="sxs-lookup"><span data-stu-id="f667d-513">**Monitoring Diagnostics** = Enabled</span></span><br/><span data-ttu-id="f667d-514">**Opslagaccount voor diagnostische gegevens** = gebruik een automatisch gegenereerde storage-account</span><span class="sxs-lookup"><span data-stu-id="f667d-514">**Diagnostics storage account** = Use an automatically generated storage account</span></span><br/><span data-ttu-id="f667d-515">**Beschikbaarheidsset** sqlAvailabilitySet =</span><span class="sxs-lookup"><span data-stu-id="f667d-515">**Availability set** = sqlAvailabilitySet</span></span><br/> |
| <span data-ttu-id="f667d-516">Virtuele-machineconfiguratie **SQL Server-instellingen**</span><span class="sxs-lookup"><span data-stu-id="f667d-516">Virtual machine configuration **SQL Server settings**</span></span> |<span data-ttu-id="f667d-517">Niet van toepassing</span><span class="sxs-lookup"><span data-stu-id="f667d-517">Not applicable</span></span> |<span data-ttu-id="f667d-518">**SQL-connectiviteit** = privé (binnen virtueel netwerk)</span><span class="sxs-lookup"><span data-stu-id="f667d-518">**SQL connectivity** = Private (within Virtual Network)</span></span><br/><span data-ttu-id="f667d-519">**Poort** 1433 =</span><span class="sxs-lookup"><span data-stu-id="f667d-519">**Port** = 1433</span></span><br/><span data-ttu-id="f667d-520">**SQL-verificatie** = uitschakelen</span><span class="sxs-lookup"><span data-stu-id="f667d-520">**SQL Authentication** = Disable</span></span><br/><span data-ttu-id="f667d-521">**Opslagconfiguratie** algemene =</span><span class="sxs-lookup"><span data-stu-id="f667d-521">**Storage configuration** = General</span></span><br/><span data-ttu-id="f667d-522">**Automatisch patchen** = zondag om 2:00 uur</span><span class="sxs-lookup"><span data-stu-id="f667d-522">**Automated patching** = Sunday at 2:00</span></span><br/><span data-ttu-id="f667d-523">**Automatische back-up** = uitgeschakeld</span><span class="sxs-lookup"><span data-stu-id="f667d-523">**Automated backup** = Disabled</span></span></br><span data-ttu-id="f667d-524">**Integratie van Azure Sleutelkluis** = uitgeschakeld</span><span class="sxs-lookup"><span data-stu-id="f667d-524">**Azure Key Vault integration** = Disabled</span></span> |<span data-ttu-id="f667d-525">**SQL-connectiviteit** = privé (binnen virtueel netwerk)</span><span class="sxs-lookup"><span data-stu-id="f667d-525">**SQL connectivity** = Private (within Virtual Network)</span></span><br/><span data-ttu-id="f667d-526">**Poort** 1433 =</span><span class="sxs-lookup"><span data-stu-id="f667d-526">**Port** = 1433</span></span><br/><span data-ttu-id="f667d-527">**SQL-verificatie** = uitschakelen</span><span class="sxs-lookup"><span data-stu-id="f667d-527">**SQL Authentication** = Disable</span></span><br/><span data-ttu-id="f667d-528">**Opslagconfiguratie** algemene =</span><span class="sxs-lookup"><span data-stu-id="f667d-528">**Storage configuration** = General</span></span><br/><span data-ttu-id="f667d-529">**Automatisch patchen** = zondag om 2:00 uur</span><span class="sxs-lookup"><span data-stu-id="f667d-529">**Automated patching** = Sunday at 2:00</span></span><br/><span data-ttu-id="f667d-530">**Automatische back-up** = uitgeschakeld</span><span class="sxs-lookup"><span data-stu-id="f667d-530">**Automated backup** = Disabled</span></span></br><span data-ttu-id="f667d-531">**Integratie van Azure Sleutelkluis** = uitgeschakeld</span><span class="sxs-lookup"><span data-stu-id="f667d-531">**Azure Key Vault integration** = Disabled</span></span> |

<br/>

> [!NOTE]
> <span data-ttu-id="f667d-532">De grootte van de machines die hier voorgesteld zijn bedoeld voor het testen van beschikbaarheidsgroepen in Azure Virtual machines.</span><span class="sxs-lookup"><span data-stu-id="f667d-532">The machine sizes suggested here are meant for testing availability groups in Azure VMs.</span></span> <span data-ttu-id="f667d-533">Zie de aanbevelingen voor de grootte van de SQL Server-machines en configuratie-instellingen voor de beste prestaties op productieworkloads [best practices prestaties for SQL Server op Azure virtual machines](virtual-machines-windows-sql-performance.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).</span><span class="sxs-lookup"><span data-stu-id="f667d-533">For the best performance on production workloads, see the recommendations for SQL Server machine sizes and configuration in [Performance best practices for SQL Server in Azure virtual machines](virtual-machines-windows-sql-performance.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).</span></span>
>
>

<span data-ttu-id="f667d-534">Nadat de drie virtuele machines zijn volledig is ingericht, moet u kan toevoegen aan de **corp.contoso.com** domein en verleen CORP\Install beheerrechten op de virtuele machines.</span><span class="sxs-lookup"><span data-stu-id="f667d-534">After the three VMs are fully provisioned, you need to join them to the **corp.contoso.com** domain and grant CORP\Install administrative rights to the machines.</span></span>

### <span data-ttu-id="f667d-535"><a name="joinDomain"></a>De servers toevoegen aan het domein</span><span class="sxs-lookup"><span data-stu-id="f667d-535"><a name="joinDomain"></a>Join the servers to the domain</span></span>

<span data-ttu-id="f667d-536">U kunt nu aan de virtuele machines naar **corp.contoso.com**. Doe het volgende voor de VM's van SQL Server en de bestandsserver van de bestandsshare-witness:</span><span class="sxs-lookup"><span data-stu-id="f667d-536">You're now able to join the VMs to **corp.contoso.com**. Do the following for both the SQL Server VMs and the file share witness server:</span></span>

1. <span data-ttu-id="f667d-537">Extern verbinding maken met de virtuele machine met **BUILTIN\DomainAdmin**.</span><span class="sxs-lookup"><span data-stu-id="f667d-537">Remotely connect to the virtual machine with **BUILTIN\DomainAdmin**.</span></span>
2. <span data-ttu-id="f667d-538">In **Serverbeheer**, klikt u op **lokale Server**.</span><span class="sxs-lookup"><span data-stu-id="f667d-538">In **Server Manager**, click **Local Server**.</span></span>
3. <span data-ttu-id="f667d-539">Klik op de **werkgroep** koppeling.</span><span class="sxs-lookup"><span data-stu-id="f667d-539">Click the **WORKGROUP** link.</span></span>
4. <span data-ttu-id="f667d-540">In de **computernaam** sectie, klikt u op **wijziging**.</span><span class="sxs-lookup"><span data-stu-id="f667d-540">In the **Computer Name** section, click **Change**.</span></span>
5. <span data-ttu-id="f667d-541">Selecteer de **domein** selectievakje in en typ **corp.contoso.com** in het tekstvak.</span><span class="sxs-lookup"><span data-stu-id="f667d-541">Select the **Domain** check box and type **corp.contoso.com** in the text box.</span></span> <span data-ttu-id="f667d-542">Klik op **OK**.</span><span class="sxs-lookup"><span data-stu-id="f667d-542">Click **OK**.</span></span>
6. <span data-ttu-id="f667d-543">In de **Windows-beveiliging** dialoogvenster pop, geef de referenties voor de administrator-account van het standaard (**CORP\DomainAdmin**) en het wachtwoord (**Contoso! 0000**) .</span><span class="sxs-lookup"><span data-stu-id="f667d-543">In the **Windows Security** popup dialog, specify the credentials for the default domain administrator account (**CORP\DomainAdmin**) and the password (**Contoso!0000**).</span></span>
7. <span data-ttu-id="f667d-544">Wanneer u het bericht "Welkom bij het domein corp.contoso.com" ziet, klikt u op **OK**.</span><span class="sxs-lookup"><span data-stu-id="f667d-544">When you see the "Welcome to the corp.contoso.com domain" message, click **OK**.</span></span>
8. <span data-ttu-id="f667d-545">Klik op **sluiten**, en klik vervolgens op **nu opnieuw opstarten** in het dialoogvenster pop-upvenster.</span><span class="sxs-lookup"><span data-stu-id="f667d-545">Click **Close**, and then click **Restart Now** in the popup dialog.</span></span>

### <a name="add-the-corpinstall-user-as-an-administrator-on-each-cluster-vm"></a><span data-ttu-id="f667d-546">De gebruiker Corp\Install toevoegen als beheerder op elke VM-cluster</span><span class="sxs-lookup"><span data-stu-id="f667d-546">Add the Corp\Install user as an administrator on each cluster VM</span></span>

<span data-ttu-id="f667d-547">Nadat u elke virtuele machine opnieuw wordt opgestart als lid van het domein, toevoegen **CORP\Install** als lid van de lokale groep administrators.</span><span class="sxs-lookup"><span data-stu-id="f667d-547">After each virtual machine restarts as a member of the domain, add **CORP\Install** as a member of the local administrators group.</span></span>

1. <span data-ttu-id="f667d-548">Wacht totdat de virtuele machine opnieuw wordt gestart en vervolgens het RDP-bestand van de primaire domeincontroller aan te melden bij opnieuw starten **sqlserver 0** met behulp van de **CORP\DomainAdmin** account.</span><span class="sxs-lookup"><span data-stu-id="f667d-548">Wait until the VM is restarted, then launch the RDP file again from the primary domain controller to sign in to **sqlserver-0** by using the **CORP\DomainAdmin** account.</span></span>
   >[!TIP]
   ><span data-ttu-id="f667d-549">Zorg ervoor dat u zich met het domeinbeheerdersaccount aanmelden.</span><span class="sxs-lookup"><span data-stu-id="f667d-549">Make sure that you sign in with the domain administrator account.</span></span> <span data-ttu-id="f667d-550">In de vorige stappen hebt u het beheerdersaccount IN gebouwd.</span><span class="sxs-lookup"><span data-stu-id="f667d-550">In the previous steps, you were using the BUILT IN administrator account.</span></span> <span data-ttu-id="f667d-551">Nu dat de server zich in het domein, wordt het domeinaccount gebruiken.</span><span class="sxs-lookup"><span data-stu-id="f667d-551">Now that the server is in the domain, use the domain account.</span></span> <span data-ttu-id="f667d-552">Geef in uw RDP-sessie *domein*\\*gebruikersnaam*.</span><span class="sxs-lookup"><span data-stu-id="f667d-552">In your RDP session, specify *DOMAIN*\\*username*.</span></span>

2. <span data-ttu-id="f667d-553">In **Serverbeheer**, selecteer **extra**, en klik vervolgens op **Computerbeheer**.</span><span class="sxs-lookup"><span data-stu-id="f667d-553">In **Server Manager**, select **Tools**, and then click **Computer Management**.</span></span>
3. <span data-ttu-id="f667d-554">In de **Computerbeheer** venster Vouw **lokale gebruikers en groepen**, en selecteer vervolgens **groepen**.</span><span class="sxs-lookup"><span data-stu-id="f667d-554">In the **Computer Management** window, expand **Local Users and Groups**, and then select **Groups**.</span></span>
4. <span data-ttu-id="f667d-555">Dubbelklik op de **beheerders** groep.</span><span class="sxs-lookup"><span data-stu-id="f667d-555">Double-click the **Administrators** group.</span></span>
5. <span data-ttu-id="f667d-556">In de **beheerders eigenschappen** dialoogvenster, klikt u op de **toevoegen** knop.</span><span class="sxs-lookup"><span data-stu-id="f667d-556">In the **Administrators Properties** dialog, click the **Add** button.</span></span>
6. <span data-ttu-id="f667d-557">Voer de gebruiker **CORP\Install**, en klik vervolgens op **OK**.</span><span class="sxs-lookup"><span data-stu-id="f667d-557">Enter the user **CORP\Install**, and then click **OK**.</span></span>
7. <span data-ttu-id="f667d-558">Klik op **OK** sluiten de **beheerder eigenschappen** dialoogvenster.</span><span class="sxs-lookup"><span data-stu-id="f667d-558">Click **OK** to close the **Administrator Properties** dialog.</span></span>
8. <span data-ttu-id="f667d-559">Herhaal de vorige stappen op **sqlserver 1** en **cluster fsw**.</span><span class="sxs-lookup"><span data-stu-id="f667d-559">Repeat the previous steps on **sqlserver-1** and **cluster-fsw**.</span></span>

### <span data-ttu-id="f667d-560"><a name="setServiceAccount"></a>Instellen van de SQL Server-service-accounts</span><span class="sxs-lookup"><span data-stu-id="f667d-560"><a name="setServiceAccount"></a>Set the SQL Server service accounts</span></span>

<span data-ttu-id="f667d-561">Stel de SQL Server-serviceaccount op elke virtuele machine van SQL Server.</span><span class="sxs-lookup"><span data-stu-id="f667d-561">On each SQL Server VM, set the SQL Server service account.</span></span> <span data-ttu-id="f667d-562">Gebruik van de accounts die u hebt gemaakt wanneer u [de domeinaccounts geconfigureerd](#DomainAccounts).</span><span class="sxs-lookup"><span data-stu-id="f667d-562">Use the accounts that you created when you [configured the domain accounts](#DomainAccounts).</span></span>

1. <span data-ttu-id="f667d-563">Open **SQL Server Configuration Manager**.</span><span class="sxs-lookup"><span data-stu-id="f667d-563">Open **SQL Server Configuration Manager**.</span></span>
2. <span data-ttu-id="f667d-564">Met de rechtermuisknop op de SQL Server-service en klik vervolgens op **eigenschappen**.</span><span class="sxs-lookup"><span data-stu-id="f667d-564">Right-click the SQL Server service, and then click **Properties**.</span></span>
3. <span data-ttu-id="f667d-565">Stel de account en wachtwoord.</span><span class="sxs-lookup"><span data-stu-id="f667d-565">Set the account and password.</span></span>
4. <span data-ttu-id="f667d-566">Herhaal deze stappen op de andere SQL Server-VM.</span><span class="sxs-lookup"><span data-stu-id="f667d-566">Repeat these steps on the other SQL Server VM.</span></span>  

<span data-ttu-id="f667d-567">Voor SQL Server-beschikbaarheidsgroepen moet elke virtuele machine van SQL Server worden uitgevoerd als een domeinaccount.</span><span class="sxs-lookup"><span data-stu-id="f667d-567">For SQL Server availability groups, each SQL Server VM needs to run as a domain account.</span></span>

### <a name="create-a-sign-in-on-each-sql-server-vm-for-the-installation-account"></a><span data-ttu-id="f667d-568">Maak een aanmeldingspagina op elke SQL Server-VM voor de installatieaccount</span><span class="sxs-lookup"><span data-stu-id="f667d-568">Create a sign-in on each SQL Server VM for the installation account</span></span>

<span data-ttu-id="f667d-569">De installatieaccount (CORP\install) gebruiken voor het configureren van de beschikbaarheidsgroep.</span><span class="sxs-lookup"><span data-stu-id="f667d-569">Use the installation account (CORP\install) to configure the availability group.</span></span> <span data-ttu-id="f667d-570">Dit account moet lid zijn van de **sysadmin** vaste serverrol op elke virtuele machine van SQL Server.</span><span class="sxs-lookup"><span data-stu-id="f667d-570">This account needs to be a member of the **sysadmin** fixed server role on each SQL Server VM.</span></span> <span data-ttu-id="f667d-571">De volgende stappen maakt u een aanmeldingspagina voor de installatieaccount:</span><span class="sxs-lookup"><span data-stu-id="f667d-571">The following steps create a sign-in for the installation account:</span></span>

1. <span data-ttu-id="f667d-572">Verbinding maken met de server via de Remote Desktop Protocol (RDP) met behulp van de  *\<MachineName\>\DomainAdmin* account.</span><span class="sxs-lookup"><span data-stu-id="f667d-572">Connect to the server through the Remote Desktop Protocol (RDP) by using the *\<MachineName\>\DomainAdmin* account.</span></span>

1. <span data-ttu-id="f667d-573">Open SQL Server Management Studio en maak verbinding met het lokale exemplaar van SQL Server.</span><span class="sxs-lookup"><span data-stu-id="f667d-573">Open SQL Server Management Studio and connect to the local instance of SQL Server.</span></span>

1. <span data-ttu-id="f667d-574">In **Objectverkenner**, klikt u op **beveiliging**.</span><span class="sxs-lookup"><span data-stu-id="f667d-574">In **Object Explorer**, click **Security**.</span></span>

1. <span data-ttu-id="f667d-575">Met de rechtermuisknop op **aanmeldingen**.</span><span class="sxs-lookup"><span data-stu-id="f667d-575">Right-click **Logins**.</span></span> <span data-ttu-id="f667d-576">Klik op **New Login**.</span><span class="sxs-lookup"><span data-stu-id="f667d-576">Click **New Login**.</span></span>

1. <span data-ttu-id="f667d-577">In **Login - nieuwe**, klikt u op **Search**.</span><span class="sxs-lookup"><span data-stu-id="f667d-577">In **Login - New**, click **Search**.</span></span>

1. <span data-ttu-id="f667d-578">Klik op **locaties**.</span><span class="sxs-lookup"><span data-stu-id="f667d-578">Click **Locations**.</span></span>

1. <span data-ttu-id="f667d-579">Voer de netwerkreferenties voor de domeinbeheerder.</span><span class="sxs-lookup"><span data-stu-id="f667d-579">Enter the domain administrator network credentials.</span></span>

1. <span data-ttu-id="f667d-580">De installatieaccount gebruiken.</span><span class="sxs-lookup"><span data-stu-id="f667d-580">Use the installation account.</span></span>

1. <span data-ttu-id="f667d-581">Stel de aanmeldingspagina lid zijn van de **sysadmin** vaste serverrol.</span><span class="sxs-lookup"><span data-stu-id="f667d-581">Set the sign-in to be a member of the **sysadmin** fixed server role.</span></span>

1. <span data-ttu-id="f667d-582">Klik op **OK**.</span><span class="sxs-lookup"><span data-stu-id="f667d-582">Click **OK**.</span></span>

<span data-ttu-id="f667d-583">Herhaal de voorgaande stappen op de andere SQL Server-VM.</span><span class="sxs-lookup"><span data-stu-id="f667d-583">Repeat the preceding steps on the other SQL Server VM.</span></span>

## <a name="add-failover-clustering-features-to-both-sql-server-vms"></a><span data-ttu-id="f667d-584">Functies voor failoverclustering toevoegen aan beide VM's van SQL Server</span><span class="sxs-lookup"><span data-stu-id="f667d-584">Add Failover Clustering features to both SQL Server VMs</span></span>

<span data-ttu-id="f667d-585">Om toe te voegen functies voor failoverclustering, doe het volgende op beide VM's van SQL Server:</span><span class="sxs-lookup"><span data-stu-id="f667d-585">To add Failover Clustering features, do the following on both SQL Server VMs:</span></span>

1. <span data-ttu-id="f667d-586">Verbinding maken met de virtuele machine van SQL Server via de Remote Desktop Protocol (RDP) met behulp van de *CORP\install* account.</span><span class="sxs-lookup"><span data-stu-id="f667d-586">Connect to the SQL Server virtual machine through the Remote Desktop Protocol (RDP) by using the *CORP\install* account.</span></span> <span data-ttu-id="f667d-587">Open **Dashboard voor Serverbeheer**.</span><span class="sxs-lookup"><span data-stu-id="f667d-587">Open **Server Manager Dashboard**.</span></span>
2. <span data-ttu-id="f667d-588">Klik op de **functies en onderdelen toevoegen** koppeling in het dashboard.</span><span class="sxs-lookup"><span data-stu-id="f667d-588">Click the **Add roles and features** link on the dashboard.</span></span>

    ![Server Manager - functies toevoegen](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/22-addfeatures.png)
3. <span data-ttu-id="f667d-590">Selecteer **volgende** totdat u de **serverfuncties** sectie.</span><span class="sxs-lookup"><span data-stu-id="f667d-590">Select **Next** until you get to the **Server Features** section.</span></span>
4. <span data-ttu-id="f667d-591">In **functies**, selecteer **Failoverclustering**.</span><span class="sxs-lookup"><span data-stu-id="f667d-591">In **Features**, select **Failover Clustering**.</span></span>
5. <span data-ttu-id="f667d-592">Voeg eventuele aanvullende vereiste functies.</span><span class="sxs-lookup"><span data-stu-id="f667d-592">Add any additional required features.</span></span>
6. <span data-ttu-id="f667d-593">Klik op **installeren** om toe te voegen van de functies.</span><span class="sxs-lookup"><span data-stu-id="f667d-593">Click **Install** to add the features.</span></span>

<span data-ttu-id="f667d-594">Herhaal de stappen op de andere SQL Server-VM.</span><span class="sxs-lookup"><span data-stu-id="f667d-594">Repeat the steps on the other SQL Server VM.</span></span>

## <a name="a-nameendpoint-firewall-configure-the-firewall-on-each-sql-server-vm"></a><span data-ttu-id="f667d-595"><a name="endpoint-firewall">De firewall configureren op elke SQL Server-VM</span><span class="sxs-lookup"><span data-stu-id="f667d-595"><a name="endpoint-firewall"> Configure the firewall on each SQL Server VM</span></span>

<span data-ttu-id="f667d-596">De oplossing is vereist voor de volgende TCP-poorten open zijn in de firewall:</span><span class="sxs-lookup"><span data-stu-id="f667d-596">The solution requires the following TCP ports to be open in the firewall:</span></span>

- <span data-ttu-id="f667d-597">**SQL Server-machine**:</span><span class="sxs-lookup"><span data-stu-id="f667d-597">**SQL Server VM**:</span></span><br/>
   <span data-ttu-id="f667d-598">Poort 1433 voor een standaardexemplaar van SQL Server.</span><span class="sxs-lookup"><span data-stu-id="f667d-598">Port 1433 for a default instance of SQL Server.</span></span>
- <span data-ttu-id="f667d-599">**Azure load balancer-test:**</span><span class="sxs-lookup"><span data-stu-id="f667d-599">**Azure load balancer probe:**</span></span><br/>
   <span data-ttu-id="f667d-600">Een beschikbare poort.</span><span class="sxs-lookup"><span data-stu-id="f667d-600">Any available port.</span></span> <span data-ttu-id="f667d-601">De voorbeelden gebruiken vaak 59999.</span><span class="sxs-lookup"><span data-stu-id="f667d-601">Examples frequently use 59999.</span></span>
- <span data-ttu-id="f667d-602">**Eindpunt voor databasespiegeling:**</span><span class="sxs-lookup"><span data-stu-id="f667d-602">**Database mirroring endpoint:**</span></span> <br/>
   <span data-ttu-id="f667d-603">Een beschikbare poort.</span><span class="sxs-lookup"><span data-stu-id="f667d-603">Any available port.</span></span> <span data-ttu-id="f667d-604">De voorbeelden gebruiken vaak 5022.</span><span class="sxs-lookup"><span data-stu-id="f667d-604">Examples frequently use 5022.</span></span>

<span data-ttu-id="f667d-605">De firewall-poorten moeten geopend zijn op beide VM's van SQL Server.</span><span class="sxs-lookup"><span data-stu-id="f667d-605">The firewall ports need to be open on both SQL Server VMs.</span></span>

<span data-ttu-id="f667d-606">De methode de poorten te openen, is afhankelijk van de firewalloplossing die u gebruikt.</span><span class="sxs-lookup"><span data-stu-id="f667d-606">The method of opening the ports depends on the firewall solution that you use.</span></span> <span data-ttu-id="f667d-607">De volgende sectie wordt uitgelegd hoe de poorten openen in Windows Firewall.</span><span class="sxs-lookup"><span data-stu-id="f667d-607">The next section explains how to open the ports in Windows Firewall.</span></span> <span data-ttu-id="f667d-608">Open de vereiste poorten op elk van uw SQL Server-VM.</span><span class="sxs-lookup"><span data-stu-id="f667d-608">Open the required ports on each of your SQL Server VMs.</span></span>

### <a name="open-a-tcp-port-in-the-firewall"></a><span data-ttu-id="f667d-609">Open een TCP-poort in de firewall</span><span class="sxs-lookup"><span data-stu-id="f667d-609">Open a TCP port in the firewall</span></span>

1. <span data-ttu-id="f667d-610">Op de eerste SQL-Server **Start** scherm, starten **Windows Firewall met geavanceerde beveiliging**.</span><span class="sxs-lookup"><span data-stu-id="f667d-610">On the first SQL Server **Start** screen, launch **Windows Firewall with Advanced Security**.</span></span>
2. <span data-ttu-id="f667d-611">Selecteer in het linkerdeelvenster **regels voor binnenkomende verbindingen**.</span><span class="sxs-lookup"><span data-stu-id="f667d-611">On the left pane, select **Inbound Rules**.</span></span> <span data-ttu-id="f667d-612">Klik in het rechterdeelvenster op **nieuwe regel**.</span><span class="sxs-lookup"><span data-stu-id="f667d-612">On the right pane, click **New Rule**.</span></span>
3. <span data-ttu-id="f667d-613">Voor **regeltype**, kies **poort**.</span><span class="sxs-lookup"><span data-stu-id="f667d-613">For **Rule Type**, choose **Port**.</span></span>
4. <span data-ttu-id="f667d-614">Geef voor de poort **TCP** en typt u de juiste poortnummers.</span><span class="sxs-lookup"><span data-stu-id="f667d-614">For the port, specify **TCP** and type the appropriate port numbers.</span></span> <span data-ttu-id="f667d-615">Zie het volgende voorbeeld:</span><span class="sxs-lookup"><span data-stu-id="f667d-615">See the following example:</span></span>

   ![SQL-firewall](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/35-tcpports.png)

5. <span data-ttu-id="f667d-617">Klik op **Volgende**.</span><span class="sxs-lookup"><span data-stu-id="f667d-617">Click **Next**.</span></span>
6. <span data-ttu-id="f667d-618">Op de **actie** pagina, houden **de verbinding toestaan** geselecteerd en klik vervolgens op **volgende**.</span><span class="sxs-lookup"><span data-stu-id="f667d-618">On the **Action** page, keep **Allow the connection** selected, and then click **Next**.</span></span>
7. <span data-ttu-id="f667d-619">Op de **profiel** pagina, accepteer de standaardinstellingen en klik vervolgens op **volgende**.</span><span class="sxs-lookup"><span data-stu-id="f667d-619">On the **Profile** page, accept the default settings, and then click **Next**.</span></span>
8. <span data-ttu-id="f667d-620">Op de **naam** pagina, geeft u de regelnaam van een (zoals **Azure LB Probe**) in de **naam** in het tekstvak en klik vervolgens op **voltooien**.</span><span class="sxs-lookup"><span data-stu-id="f667d-620">On the **Name** page, specify a rule name (such as **Azure LB Probe**) in the **Name** text box, and then click **Finish**.</span></span>

<span data-ttu-id="f667d-621">Herhaal deze stappen op de tweede SQL Server-VM.</span><span class="sxs-lookup"><span data-stu-id="f667d-621">Repeat these steps on the second SQL Server VM.</span></span>

## <a name="next-steps"></a><span data-ttu-id="f667d-622">Volgende stappen</span><span class="sxs-lookup"><span data-stu-id="f667d-622">Next steps</span></span>

* [<span data-ttu-id="f667d-623">Een SQL Server Always On-beschikbaarheidsgroep maken op virtuele machines in Azure</span><span class="sxs-lookup"><span data-stu-id="f667d-623">Create a SQL Server Always On availability group on Azure virtual machines</span></span>](virtual-machines-windows-portal-sql-availability-group-tutorial.md)
