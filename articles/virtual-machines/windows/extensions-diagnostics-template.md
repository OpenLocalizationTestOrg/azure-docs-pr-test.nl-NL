---
title: aaaAdd bewaking & diagnostics tooan virtuele Azure-machine | Microsoft Docs
description: Gebruik een Azure resource manager-sjabloon toocreate een nieuwe virtuele machine voor Windows met de extensie Azure diagnostics.
services: virtual-machines-windows
documentationcenter: 
author: sbtron
manager: timlt
editor: 
tags: azure-resource-manager
ms.assetid: 8cde8fe7-977b-43d2-be74-ad46dc946058
ms.service: virtual-machines-windows
ms.workload: infrastructure-services
ms.tgt_pltfrm: vm-windows
ms.devlang: na
ms.topic: article
ms.date: 05/31/2017
ms.author: saurabh
ms.custom: H1Hack27Feb2017
ms.openlocfilehash: d8a831421a0f9d38c09d51cf8c2e6dff913c77ff
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 10/06/2017
---
# <a name="use-monitoring-and-diagnostics-with-a-windows-vm-and-azure-resource-manager-templates"></a><span data-ttu-id="03f12-103">Controle en diagnostische gegevens met een virtuele machine van Windows en Azure Resource Manager-sjablonen gebruiken</span><span class="sxs-lookup"><span data-stu-id="03f12-103">Use monitoring and diagnostics with a Windows VM and Azure Resource Manager templates</span></span>
<span data-ttu-id="03f12-104">Hallo extensie voor diagnostische gegevens van Azure biedt Hallo bewaking en mogelijkheden van diagnostische gegevens op een Windows op basis van virtuele machine van Azure.</span><span class="sxs-lookup"><span data-stu-id="03f12-104">hello Azure Diagnostics Extension provides hello monitoring and diagnostics capabilities on a Windows based Azure virtual machine.</span></span> <span data-ttu-id="03f12-105">U kunt deze mogelijkheden op Hallo virtuele machine inschakelen door uitbreiding Hallo als onderdeel van hello azure resource manager-sjabloon.</span><span class="sxs-lookup"><span data-stu-id="03f12-105">You can enable these capabilities on hello virtual machine by including hello extension as part of hello azure resource manager template.</span></span> <span data-ttu-id="03f12-106">Zie [Azure Resource Manager-sjablonen ontwerpen met VM-extensies](template-description.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json#extensions) voor meer informatie over het toevoegen van elke extensie als onderdeel van een sjabloon voor virtuele machines.</span><span class="sxs-lookup"><span data-stu-id="03f12-106">See [Authoring Azure Resource Manager Templates with VM Extensions](template-description.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json#extensions) for more information on including any extension as part of a virtual machine template.</span></span> <span data-ttu-id="03f12-107">Dit artikel wordt beschreven hoe u hello Azure Diagnostics extensie tooa windows virtuele machine-sjabloon kunt toevoegen.</span><span class="sxs-lookup"><span data-stu-id="03f12-107">This article describes how you can add hello Azure Diagnostics extension tooa windows virtual machine template.</span></span>  

## <a name="add-hello-azure-diagnostics-extension-toohello-vm-resource-definition"></a><span data-ttu-id="03f12-108">Hello Azure Diagnostics toohello VM resource-uitbreidingsdefinitie toevoegen</span><span class="sxs-lookup"><span data-stu-id="03f12-108">Add hello Azure Diagnostics extension toohello VM resource definition</span></span>
<span data-ttu-id="03f12-109">tooenable Hallo-extensie voor diagnostische gegevens op een virtuele Windows-Machine moet u tooadd Hallo extensie als een VM-resource in Hallo Resource manager-sjabloon.</span><span class="sxs-lookup"><span data-stu-id="03f12-109">tooenable hello diagnostics extension on a Windows Virtual Machine you need tooadd hello extension as a VM resource in hello Resource manager template.</span></span>

<span data-ttu-id="03f12-110">Voor een eenvoudige Resource Manager gebaseerde virtuele Machine toevoegen Hallo extensie configuratie toohello *resources* matrix voor Hallo virtuele Machine:</span><span class="sxs-lookup"><span data-stu-id="03f12-110">For a simple Resource Manager based Virtual Machine add hello extension configuration toohello *resources* array for hello Virtual Machine:</span></span> 

    "resources": [
                {
                    "name": "Microsoft.Insights.VMDiagnosticsSettings",
                    "type": "extensions",
                    "location": "[resourceGroup().location]",
                    "apiVersion": "2015-06-15",
                    "dependsOn": [
                        "[concat('Microsoft.Compute/virtualMachines/', variables('vmName'))]"
                    ],
                    "tags": {
                        "displayName": "AzureDiagnostics"
                    },
                    "properties": {
                        "publisher": "Microsoft.Azure.Diagnostics",
                        "type": "IaaSDiagnostics",
                        "typeHandlerVersion": "1.5",
                        "autoUpgradeMinorVersion": true,
                        "settings": {
                            "xmlCfg": "[base64(concat(variables('wadcfgxstart'), variables('wadmetricsresourceid'), variables('vmName'), variables('wadcfgxend')))]",
                            "storageAccount": "[parameters('existingdiagnosticsStorageAccountName')]"
                        },
                        "protectedSettings": {
                            "storageAccountName": "[parameters('existingdiagnosticsStorageAccountName')]",
                            "storageAccountKey": "[listkeys(variables('accountid'), '2015-05-01-preview').key1]",
                            "storageAccountEndPoint": "https://core.windows.net"
                        }
                    }
                }
            ]


<span data-ttu-id="03f12-111">Een andere algemene conventie wordt configuratie van de uitbreiding Hallo op Hallo hoofdknooppunt resources van de sjabloon Hallo in plaats van waarin het is gedefinieerd onder hardwarebronnen Hallo virtuele machine toevoegen.</span><span class="sxs-lookup"><span data-stu-id="03f12-111">Another common convention is add hello extension configuration at hello root resources node of hello template instead of defining it under hello virtual machine's resources node.</span></span> <span data-ttu-id="03f12-112">Met deze aanpak hebt u tooexplicitly opgeven van een hiërarchische relatie tussen Hallo-extensie en Hallo virtuele machine met Hallo *naam* en *type* waarden.</span><span class="sxs-lookup"><span data-stu-id="03f12-112">With this approach you have tooexplicitly specify a hierarchical relation between hello extension and hello virtual machine with hello *name* and *type* values.</span></span> <span data-ttu-id="03f12-113">Bijvoorbeeld:</span><span class="sxs-lookup"><span data-stu-id="03f12-113">For example:</span></span> 

    "name": "[concat(variables('vmName'),'Microsoft.Insights.VMDiagnosticsSettings')]",
    "type": "Microsoft.Compute/virtualMachines/extensions",

<span data-ttu-id="03f12-114">Hallo uitbreiding is altijd Hallo virtuele machine is gekoppeld, kunt u rechtstreeks direct onder het bronknooppunt Hallo virtuele machine definiëren of definiëren op basisniveau Hallo en Hallo hiërarchische naming convention tooassociate gebruiken met virtuele Hallo machine.</span><span class="sxs-lookup"><span data-stu-id="03f12-114">hello extension is always associated with hello virtual machine, you can either directly define it under hello virtual machine's resource node directly or define it at hello base level and use hello hierarchical naming convention tooassociate it with hello virtual machine.</span></span>

<span data-ttu-id="03f12-115">Voor virtuele-Machineschaalsets Hallo uitbreidingen configuratie is opgegeven in Hallo *extensionProfile* eigenschap Hallo *VirtualMachineProfile*.</span><span class="sxs-lookup"><span data-stu-id="03f12-115">For Virtual Machine Scale Sets hello extensions configuration is specified in hello *extensionProfile* property of hello *VirtualMachineProfile*.</span></span>

<span data-ttu-id="03f12-116">Hallo *publisher* eigenschap met de waarde van Hallo **Microsoft.Azure.Diagnostics** en Hallo *type* eigenschap met de waarde van Hallo **IaaSDiagnostics** hello Azure Diagnostics extensie uniek te identificeren.</span><span class="sxs-lookup"><span data-stu-id="03f12-116">hello *publisher* property with hello value of **Microsoft.Azure.Diagnostics** and hello *type* property with hello value of **IaaSDiagnostics** uniquely identify hello Azure Diagnostics extension.</span></span>

<span data-ttu-id="03f12-117">waarde van Hallo Hallo *naam* gebruikte toorefer toohello extensie in de resourcegroep Hallo voor de eigenschap zijn.</span><span class="sxs-lookup"><span data-stu-id="03f12-117">hello value of hello *name* property can be used toorefer toohello extension in hello resource group.</span></span> <span data-ttu-id="03f12-118">Te specifiek instelling**Microsoft.Insights.VMDiagnosticsSettings** toobe gemakkelijk worden geïdentificeerd door hello Azure portal ervoor te zorgen dat Hallo bewaking grafieken weergegeven correct in hello Azure-portal wordt inschakelen.</span><span class="sxs-lookup"><span data-stu-id="03f12-118">Setting it specifically too**Microsoft.Insights.VMDiagnosticsSettings** will enable it toobe easily identified by hello Azure portal ensuring that hello monitoring charts show up correctly in hello Azure portal.</span></span>

<span data-ttu-id="03f12-119">Hallo *typeHandlerVersion* Hallo-versie van de uitbreiding Hallo gewenst toouse.</span><span class="sxs-lookup"><span data-stu-id="03f12-119">hello *typeHandlerVersion* specifies hello version of hello extension you would like toouse.</span></span> <span data-ttu-id="03f12-120">Instelling *autoUpgradeMinorVersion* updateversies te**true** zorgt ervoor dat u krijgt Hallo nieuwste secundaire versie van het Hallo-extensie die beschikbaar is.</span><span class="sxs-lookup"><span data-stu-id="03f12-120">Setting *autoUpgradeMinorVersion* minor version too**true** ensures that you will get hello latest Minor version of hello extension that is available.</span></span> <span data-ttu-id="03f12-121">Het is raadzaam dat u altijd ingesteld *autoUpgradeMinorVersion* tooalways worden **true** zodat u altijd toouse Hallo meest recente beschikbare extensie voor diagnostische gegevens met alle Hallo nieuwe functies en oplossingen ophalen corrigeert.</span><span class="sxs-lookup"><span data-stu-id="03f12-121">It is highly recommended that you always set *autoUpgradeMinorVersion* tooalways be **true** so that you always get toouse hello latest available diagnostics extension with all hello new features and bug fixes.</span></span> 

<span data-ttu-id="03f12-122">Hallo *instellingen* element bevat eigenschappen van de configuraties voor Hallo-extensie die kunnen worden ingesteld en kan worden gelezen door Hallo-extensie (soms waarnaar wordt verwezen tooas openbare configuratie).</span><span class="sxs-lookup"><span data-stu-id="03f12-122">hello *settings* element contains configurations properties for hello extension that can be set and read back from hello extension (sometimes referred tooas public configuration).</span></span> <span data-ttu-id="03f12-123">Hallo *xmlcfg* eigenschap bevat op basis van xml-configuratie voor Hallo diagnostische logboeken prestatiemeteritems enzovoort die worden verzameld door Hallo diagnostics agent.</span><span class="sxs-lookup"><span data-stu-id="03f12-123">hello *xmlcfg* property contains xml based configuration for hello diagnostics logs, performance counters etc that will be collected by hello diagnostics agent.</span></span> <span data-ttu-id="03f12-124">Zie [Diagnostics configuratieschema](https://msdn.microsoft.com/library/azure/dn782207.aspx) voor meer informatie over xml-schema voor Hallo zelf.</span><span class="sxs-lookup"><span data-stu-id="03f12-124">See [Diagnostics Configuration Schema](https://msdn.microsoft.com/library/azure/dn782207.aspx) for more information about hello xml schema itself.</span></span> <span data-ttu-id="03f12-125">Een gebruikelijk is toostore Hallo werkelijke XML-configuratie als een variabele in hello Azure Resource Manager-sjabloon en vervolgens tekst en base64 ze coderen tooset Hallo waarde voor *xmlcfg*.</span><span class="sxs-lookup"><span data-stu-id="03f12-125">A common practice is toostore hello actual xml configuration as a variable in hello Azure Resource Manager template and then concatenate and base64 encode them tooset hello value for *xmlcfg*.</span></span> <span data-ttu-id="03f12-126">Zie de sectie Hallo over [diagnostische gegevens van de variabelen](#diagnostics-configuration-variables) toounderstand meer informatie over hoe toostore Hallo xml in variabelen.</span><span class="sxs-lookup"><span data-stu-id="03f12-126">See hello section on [diagnostics configuration variables](#diagnostics-configuration-variables) toounderstand more about how toostore hello xml in variables.</span></span> <span data-ttu-id="03f12-127">Hallo *storageAccount* -eigenschap geeft u op het Hallo-naam van Hallo storage account toowhich diagnostics-gegevens worden overgebracht.</span><span class="sxs-lookup"><span data-stu-id="03f12-127">hello *storageAccount* property specifies hello name of hello storage account toowhich diagnostics data will be transferred.</span></span> 

<span data-ttu-id="03f12-128">eigenschappen in Hallo *protectedSettings* (soms waarnaar wordt verwezen tooas persoonlijke configuratie) kan worden ingesteld, maar kan niet worden gelezen terug nadat wordt ingesteld.</span><span class="sxs-lookup"><span data-stu-id="03f12-128">hello properties in *protectedSettings* (sometimes referred tooas private configuration) can be set but cannot be read back after being set.</span></span> <span data-ttu-id="03f12-129">alleen-schrijven aard van Hallo *protectedSettings* is daarom geschikt voor het opslaan van geheimen zoals Hallo opslagaccountsleutel waar Hallo diagnostics-gegevens worden geschreven.</span><span class="sxs-lookup"><span data-stu-id="03f12-129">hello write-only nature of *protectedSettings* makes it useful for storing secrets like hello storage account key where hello diagnostics data will be written.</span></span>    

## <a name="specifying-diagnostics-storage-account-as-parameters"></a><span data-ttu-id="03f12-130">Opslagaccount voor diagnostische gegevens als parameters opgeven</span><span class="sxs-lookup"><span data-stu-id="03f12-130">Specifying diagnostics storage account as parameters</span></span>
<span data-ttu-id="03f12-131">Hallo diagnostics extensie json-codefragment hierboven wordt ervan uitgegaan dat de twee parameters *existingdiagnosticsStorageAccountName* en *existingdiagnosticsStorageResourceGroup* toospecify Hallo diagnostische gegevens opslagaccount waarin de diagnostics-gegevens worden opgeslagen.</span><span class="sxs-lookup"><span data-stu-id="03f12-131">hello diagnostics extension json snippet above assumes two parameters *existingdiagnosticsStorageAccountName* and *existingdiagnosticsStorageResourceGroup* toospecify hello diagnostics storage account where diagnostics data will be stored.</span></span> <span data-ttu-id="03f12-132">Opslagaccount voor diagnostische gegevens Hallo opgeven als een parameter het eenvoudig toochange hello opslagaccount voor diagnostische gegevens maakt in verschillende omgevingen zoals u kunt toouse een opslagaccount voor verschillende diagnostische gegevens voor het testen en een andere naam voor uw productie-implementatie.</span><span class="sxs-lookup"><span data-stu-id="03f12-132">Specifying hello diagnostics storage account as a parameter makes it easy toochange hello diagnostics storage account across different environments e.g. you may want toouse a different diagnostics storage account for testing and a different one for your production deployment.</span></span>  

        "existingdiagnosticsStorageAccountName": {
            "type": "string",
            "metadata": {
        "description": "hello name of an existing storage account toowhich diagnostics data will be transfered."
            }        
        },
        "existingdiagnosticsStorageResourceGroup": {
            "type": "string",
            "metadata": {
        "description": "hello resource group for hello storage account specified in existingdiagnosticsStorageAccountName"
              }
        }

<span data-ttu-id="03f12-133">Het is best practice toospecify een opslagaccount voor diagnostische gegevens in een andere resourcegroep dan Hallo resourcegroep voor Hallo virtuele machine.</span><span class="sxs-lookup"><span data-stu-id="03f12-133">It is best practice toospecify a diagnostics storage account in a different resource group than hello resource group for hello virtual machine.</span></span> <span data-ttu-id="03f12-134">Een resourcegroep kan worden beschouwd als een implementatie-eenheid met een eigen levensduur toobe, een virtuele machine kan worden geïmplementeerd en geïmplementeerd wanneer er nieuwe updates van de configuraties worden worden aangebracht tooit, maar u kunt toocontinue Hallo diagnostische gegevens opslaan in Hallo hetzelfde opslagaccount Met deze virtuele machine-implementaties.</span><span class="sxs-lookup"><span data-stu-id="03f12-134">A resource group can be considered toobe a deployment unit with its own lifetime, a virtual machine can be deployed and redeployed as new configurations updates are made it tooit but you may want toocontinue storing hello diagnostics data in hello same storage account across those virtual machine deployments.</span></span> <span data-ttu-id="03f12-135">Hallo storage-account dat in een andere resource schakelt Hallo storage account tooaccept gegevens uit verschillende implementaties van virtuele machines zodat u eenvoudig tootroubleshoot Hallo problemen tussen verschillende versies.</span><span class="sxs-lookup"><span data-stu-id="03f12-135">Having hello storage account in a different resource enables hello storage account tooaccept data from various virtual machine deployments making it easy tootroubleshoot issues across hello various versions.</span></span>

> [!NOTE]
> <span data-ttu-id="03f12-136">Als u een windows-sjabloon voor virtuele machine maakt vanuit Visual Studio Hallo standaardopslagaccount kan worden ingesteld Hallo toouse hetzelfde opslagaccount waar de VHD Hallo virtuele machine wordt geüpload.</span><span class="sxs-lookup"><span data-stu-id="03f12-136">If you create a windows virtual machine template from Visual Studio hello default storage account might be set toouse hello same storage account where hello virtual machine VHD is uploaded.</span></span> <span data-ttu-id="03f12-137">Dit is de eerste installatie toosimplify van Hallo VM.</span><span class="sxs-lookup"><span data-stu-id="03f12-137">This is toosimplify initial setup of hello VM.</span></span> <span data-ttu-id="03f12-138">U dient opnieuw rekening Hallo sjabloon toouse een ander opslagaccount die kan worden doorgegeven als parameter.</span><span class="sxs-lookup"><span data-stu-id="03f12-138">You should re-factor hello template toouse a different storage account that can be passed in as a parameter.</span></span> 
> 
> 

## <a name="diagnostics-configuration-variables"></a><span data-ttu-id="03f12-139">Variabelen voor de configuratie van diagnostische gegevens</span><span class="sxs-lookup"><span data-stu-id="03f12-139">Diagnostics configuration variables</span></span>
<span data-ttu-id="03f12-140">Hallo diagnostics extensie json-codefragment bovenstaande definieert een *accountid* variabele toosimplify Hallo-toegangssleutel voor opslag van Hallo diagnostische gegevens ophalen:</span><span class="sxs-lookup"><span data-stu-id="03f12-140">hello diagnostics extension json snippet above defines an *accountid* variable toosimplify getting hello storage account key for hello diagnostics storage:</span></span>   

    "accountid": "[concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/',parameters('existingdiagnosticsStorageResourceGroup'), '/providers/','Microsoft.Storage/storageAccounts/', parameters('existingdiagnosticsStorageAccountName'))]"


<span data-ttu-id="03f12-141">Hallo *xmlcfg* eigenschap voor Hallo-extensie voor diagnostische gegevens wordt gedefinieerd met meerdere variabelen die worden samengevoegd.</span><span class="sxs-lookup"><span data-stu-id="03f12-141">hello *xmlcfg* property for hello diagnostics extension is defined using multiple variables that are concatenated together.</span></span> <span data-ttu-id="03f12-142">Hallo-waarden van deze variabelen zijn in xml daarom ze toobe correct escape-teken moeten bij het instellen van Hallo json-variabelen.</span><span class="sxs-lookup"><span data-stu-id="03f12-142">hello values of these variables are in xml so they need toobe escaped correctly when setting hello json variables.</span></span>

<span data-ttu-id="03f12-143">Hallo-hieronder wordt beschreven Hallo diagnostics configuratie-xml die standaard niveau systeemprestatiemeteritems samen met enkele windows-gebeurtenislogboeken en diagnostische gegevens infrastructuur logboeken verzamelt.</span><span class="sxs-lookup"><span data-stu-id="03f12-143">hello following describes hello diagnostics configuration xml that collects standard system level performance counters along with some windows event logs and diagnostics infrastructure logs.</span></span> <span data-ttu-id="03f12-144">Het is escape-teken en de juiste indeling zodat hello configuratie kan rechtstreeks worden geplakt in de sectie met sjabloonvariabelen Hallo van uw sjabloon.</span><span class="sxs-lookup"><span data-stu-id="03f12-144">It has been escaped and formatted correctly so that hello configuration can directly be pasted into hello variables section of your template.</span></span> <span data-ttu-id="03f12-145">Zie Hallo [Diagnostics configuratieschema](https://msdn.microsoft.com/library/azure/dn782207.aspx) voor een voorbeeld van een meer menselijke leesbare van Hallo configuratie-xml.</span><span class="sxs-lookup"><span data-stu-id="03f12-145">See hello [Diagnostics Configuration Schema](https://msdn.microsoft.com/library/azure/dn782207.aspx) for a more human readable example of hello configuration xml.</span></span>

        "wadlogs": "<WadCfg> <DiagnosticMonitorConfiguration overallQuotaInMB=\"4096\" xmlns=\"http://schemas.microsoft.com/ServiceHosting/2010/10/DiagnosticsConfiguration\"> <DiagnosticInfrastructureLogs scheduledTransferLogLevelFilter=\"Error\"/> <WindowsEventLog scheduledTransferPeriod=\"PT1M\" > <DataSource name=\"Application!*[System[(Level = 1 or Level = 2)]]\" /> <DataSource name=\"Security!*[System[(Level = 1 or Level = 2)]]\" /> <DataSource name=\"System!*[System[(Level = 1 or Level = 2)]]\" /></WindowsEventLog>",
        "wadperfcounters1": "<PerformanceCounters scheduledTransferPeriod=\"PT1M\"><PerformanceCounterConfiguration counterSpecifier=\"\\Processor(_Total)\\% Processor Time\" sampleRate=\"PT15S\" unit=\"Percent\"><annotation displayName=\"CPU utilization\" locale=\"en-us\"/></PerformanceCounterConfiguration><PerformanceCounterConfiguration counterSpecifier=\"\\Processor(_Total)\\% Privileged Time\" sampleRate=\"PT15S\" unit=\"Percent\"><annotation displayName=\"CPU privileged time\" locale=\"en-us\"/></PerformanceCounterConfiguration><PerformanceCounterConfiguration counterSpecifier=\"\\Processor(_Total)\\% User Time\" sampleRate=\"PT15S\" unit=\"Percent\"><annotation displayName=\"CPU user time\" locale=\"en-us\"/></PerformanceCounterConfiguration><PerformanceCounterConfiguration counterSpecifier=\"\\Processor Information(_Total)\\Processor Frequency\" sampleRate=\"PT15S\" unit=\"Count\"><annotation displayName=\"CPU frequency\" locale=\"en-us\"/></PerformanceCounterConfiguration><PerformanceCounterConfiguration counterSpecifier=\"\\System\\Processes\" sampleRate=\"PT15S\" unit=\"Count\"><annotation displayName=\"Processes\" locale=\"en-us\"/></PerformanceCounterConfiguration><PerformanceCounterConfiguration counterSpecifier=\"\\Process(_Total)\\Thread Count\" sampleRate=\"PT15S\" unit=\"Count\"><annotation displayName=\"Threads\" locale=\"en-us\"/></PerformanceCounterConfiguration><PerformanceCounterConfiguration counterSpecifier=\"\\Process(_Total)\\Handle Count\" sampleRate=\"PT15S\" unit=\"Count\"><annotation displayName=\"Handles\" locale=\"en-us\"/></PerformanceCounterConfiguration><PerformanceCounterConfiguration counterSpecifier=\"\\Memory\\% Committed Bytes In Use\" sampleRate=\"PT15S\" unit=\"Percent\"><annotation displayName=\"Memory usage\" locale=\"en-us\"/></PerformanceCounterConfiguration><PerformanceCounterConfiguration counterSpecifier=\"\\Memory\\Available Bytes\" sampleRate=\"PT15S\" unit=\"Bytes\"><annotation displayName=\"Memory available\" locale=\"en-us\"/></PerformanceCounterConfiguration><PerformanceCounterConfiguration counterSpecifier=\"\\Memory\\Committed Bytes\" sampleRate=\"PT15S\" unit=\"Bytes\"><annotation displayName=\"Memory committed\" locale=\"en-us\"/></PerformanceCounterConfiguration><PerformanceCounterConfiguration counterSpecifier=\"\\Memory\\Commit Limit\" sampleRate=\"PT15S\" unit=\"Bytes\"><annotation displayName=\"Memory commit limit\" locale=\"en-us\"/></PerformanceCounterConfiguration><PerformanceCounterConfiguration counterSpecifier=\"\\PhysicalDisk(_Total)\\% Disk Time\" sampleRate=\"PT15S\" unit=\"Percent\"><annotation displayName=\"Disk active time\" locale=\"en-us\"/></PerformanceCounterConfiguration>",
        "wadperfcounters2": "<PerformanceCounterConfiguration counterSpecifier=\"\\PhysicalDisk(_Total)\\% Disk Read Time\" sampleRate=\"PT15S\" unit=\"Percent\"><annotation displayName=\"Disk active read time\" locale=\"en-us\"/></PerformanceCounterConfiguration><PerformanceCounterConfiguration counterSpecifier=\"\\PhysicalDisk(_Total)\\% Disk Write Time\" sampleRate=\"PT15S\" unit=\"Percent\"><annotation displayName=\"Disk active write time\" locale=\"en-us\"/></PerformanceCounterConfiguration><PerformanceCounterConfiguration counterSpecifier=\"\\PhysicalDisk(_Total)\\Disk Transfers/sec\" sampleRate=\"PT15S\" unit=\"CountPerSecond\"><annotation displayName=\"Disk operations\" locale=\"en-us\"/></PerformanceCounterConfiguration><PerformanceCounterConfiguration counterSpecifier=\"\\PhysicalDisk(_Total)\\Disk Reads/sec\" sampleRate=\"PT15S\" unit=\"CountPerSecond\"><annotation displayName=\"Disk read operations\" locale=\"en-us\"/></PerformanceCounterConfiguration><PerformanceCounterConfiguration counterSpecifier=\"\\PhysicalDisk(_Total)\\Disk Writes/sec\" sampleRate=\"PT15S\" unit=\"CountPerSecond\"><annotation displayName=\"Disk write operations\" locale=\"en-us\"/></PerformanceCounterConfiguration><PerformanceCounterConfiguration counterSpecifier=\"\\PhysicalDisk(_Total)\\Disk Bytes/sec\" sampleRate=\"PT15S\" unit=\"BytesPerSecond\"><annotation displayName=\"Disk speed\" locale=\"en-us\"/></PerformanceCounterConfiguration><PerformanceCounterConfiguration counterSpecifier=\"\\PhysicalDisk(_Total)\\Disk Read Bytes/sec\" sampleRate=\"PT15S\" unit=\"BytesPerSecond\"><annotation displayName=\"Disk read speed\" locale=\"en-us\"/></PerformanceCounterConfiguration><PerformanceCounterConfiguration counterSpecifier=\"\\PhysicalDisk(_Total)\\Disk Write Bytes/sec\" sampleRate=\"PT15S\" unit=\"BytesPerSecond\"><annotation displayName=\"Disk write speed\" locale=\"en-us\"/></PerformanceCounterConfiguration><PerformanceCounterConfiguration counterSpecifier=\"\\LogicalDisk(_Total)\\% Free Space\" sampleRate=\"PT15S\" unit=\"Percent\"><annotation displayName=\"Disk free space (percentage)\" locale=\"en-us\"/></PerformanceCounterConfiguration></PerformanceCounters>",
        "wadcfgxstart": "[concat(variables('wadlogs'), variables('wadperfcounters1'), variables('wadperfcounters2'), '<Metrics resourceId=\"')]",
        "wadmetricsresourceid": "[concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', resourceGroup().name , '/providers/', 'Microsoft.Compute/virtualMachines/')]",
        "wadcfgxend": "\"><MetricAggregation scheduledTransferPeriod=\"PT1H\"/><MetricAggregation scheduledTransferPeriod=\"PT1M\"/></Metrics></DiagnosticMonitorConfiguration></WadCfg>"

<span data-ttu-id="03f12-146">Hallo metrische gegevens definitie XML-knooppunt in Hallo hierboven configuratie is een belangrijke configuratie-element wordt gedefinieerd hoe Hallo prestatiemeteritems die eerder in xml in Hallo gedefinieerd *PerformanceCounter* knooppunt worden samengevoegd en opgeslagen.</span><span class="sxs-lookup"><span data-stu-id="03f12-146">hello Metrics definition xml node in hello above configuration is an important configuration element as it defines how hello performance counters defined earlier in hello xml in *PerformanceCounter* node will be aggregated and stored.</span></span> 

> [!IMPORTANT]
> <span data-ttu-id="03f12-147">Deze metrische gegevens station Hallo bewaking grafieken en waarschuwingen in hello Azure-portal.</span><span class="sxs-lookup"><span data-stu-id="03f12-147">These metrics drive hello monitoring charts and alerts in hello Azure portal.</span></span>  <span data-ttu-id="03f12-148">Hallo **metrische gegevens** knooppunt Hello *resourceID* en **MetricAggregation** moeten worden opgenomen in de configuratie van diagnostische Hallo voor uw virtuele machine als u wilt dat toosee Hallo VM het bewaken van gegevens in hello Azure-portal.</span><span class="sxs-lookup"><span data-stu-id="03f12-148">hello **Metrics** node with hello *resourceID* and **MetricAggregation** must be included in hello diagnostics configuration for your VM if you want toosee hello VM monitoring data in hello Azure portal.</span></span> 
> 
> 

<span data-ttu-id="03f12-149">Hallo Hieronder volgt een voorbeeld van Hallo xml voor definities van de metrische gegevens:</span><span class="sxs-lookup"><span data-stu-id="03f12-149">hello following is an example of hello xml for metrics definitions:</span></span> 

        <Metrics resourceId="/subscriptions/subscription().subscriptionId/resourceGroups/resourceGroup().name/providers/Microsoft.Compute/virtualMachines/vmName">
            <MetricAggregation scheduledTransferPeriod="PT1H"/>
            <MetricAggregation scheduledTransferPeriod="PT1M"/>
        </Metrics>

<span data-ttu-id="03f12-150">Hallo *resourceID* kenmerk uniek wordt geïdentificeerd Hallo virtuele machine in uw abonnement.</span><span class="sxs-lookup"><span data-stu-id="03f12-150">hello *resourceID* attribute uniquely identifies hello virtual machine in your subscription.</span></span> <span data-ttu-id="03f12-151">Zorg ervoor dat toouse hello subscription() en resourceGroup() functies zodat hello sjabloon automatisch bijgewerkt die waarden op basis van Hallo-groep abonnement en die u implementeert.</span><span class="sxs-lookup"><span data-stu-id="03f12-151">Make sure toouse hello subscription() and resourceGroup() functions so that hello template automatically updates those values based on hello subscription and resource group you are deploying to.</span></span>

<span data-ttu-id="03f12-152">Als u meerdere virtuele Machines in een lus maakt hebt u wordt toopopulate hello *resourceID* waarde met een functie copyIndex() toocorrectly onderscheiden elke afzonderlijke virtuele machine.</span><span class="sxs-lookup"><span data-stu-id="03f12-152">If you are creating multiple Virtual Machines in a loop then you will have toopopulate hello *resourceID* value with an copyIndex() function toocorrectly differentiate each individual VM.</span></span> <span data-ttu-id="03f12-153">Hallo *xmlCfg* waarde kan worden bijgewerkt toosupport dit als volgt:</span><span class="sxs-lookup"><span data-stu-id="03f12-153">hello *xmlCfg* value can be updated toosupport this as follows:</span></span>  

    "xmlCfg": "[base64(concat(variables('wadcfgxstart'), variables('wadmetricsresourceid'), concat(parameters('vmNamePrefix'), copyindex()), variables('wadcfgxend')))]", 

<span data-ttu-id="03f12-154">Hallo MetricAggregation waarde van *PT1H* en *PT1M* geven een aggregatie in een minuut en een aggregatie ruim een uur.</span><span class="sxs-lookup"><span data-stu-id="03f12-154">hello MetricAggregation value of *PT1H* and *PT1M* signify an aggregation over a minute and an aggregation over an hour.</span></span>

## <a name="wadmetrics-tables-in-storage"></a><span data-ttu-id="03f12-155">WADMetrics tabellen in de opslag</span><span class="sxs-lookup"><span data-stu-id="03f12-155">WADMetrics tables in storage</span></span>
<span data-ttu-id="03f12-156">Hallo metrische gegevens configuratie bovenstaande wordt tabellen gegenereerd in uw opslagaccount voor diagnostische gegevens met Hallo volgende naamgevingsregels:</span><span class="sxs-lookup"><span data-stu-id="03f12-156">hello Metrics configuration above will generate tables in your diagnostics storage account with hello following naming conventions:</span></span>

* <span data-ttu-id="03f12-157">**WADMetrics** : standaardvoorvoegsel voor alle WADMetrics tabellen</span><span class="sxs-lookup"><span data-stu-id="03f12-157">**WADMetrics** : Standard prefix for all WADMetrics tables</span></span>
* <span data-ttu-id="03f12-158">**PT1H** of **PT1M** : geeft aan dat Hallo-tabel bevat de statistische gegevens meer dan 1 uur of 1 minuut</span><span class="sxs-lookup"><span data-stu-id="03f12-158">**PT1H** or **PT1M** : Signifies that hello table contains aggregate data over 1 hour or 1 minute</span></span>
* <span data-ttu-id="03f12-159">**P10D** : geeft aan dat Hallo tabel gegevens bevat voor 10 dagen vanaf wanneer het verzamelen van gegevens van Hallo tabel wordt gestart</span><span class="sxs-lookup"><span data-stu-id="03f12-159">**P10D** : Signifies hello table will contain data for 10 days from when hello table started collecting data</span></span>
* <span data-ttu-id="03f12-160">**V2S** : tekenreeksconstante</span><span class="sxs-lookup"><span data-stu-id="03f12-160">**V2S** : String constant</span></span>
* <span data-ttu-id="03f12-161">**JJJJMMDD** : Hallo datum welke Hallo tabel gestart verzamelen van gegevens</span><span class="sxs-lookup"><span data-stu-id="03f12-161">**yyyymmdd** : hello date at which hello table started collecting data</span></span>

<span data-ttu-id="03f12-162">Voorbeeld: *WADMetricsPT1HP10DV2S20151108* bevatten metrische gegevens geaggregeerd ruim een uur tien dagen starten op 11-november-2015</span><span class="sxs-lookup"><span data-stu-id="03f12-162">Example: *WADMetricsPT1HP10DV2S20151108* will contain metrics data aggregated over an hour for 10 days starting on 11-Nov-2015</span></span>    

<span data-ttu-id="03f12-163">Elke tabel WADMetrics bevat Hallo kolommen te volgen:</span><span class="sxs-lookup"><span data-stu-id="03f12-163">Each WADMetrics table will contain hello following columns:</span></span>

* <span data-ttu-id="03f12-164">**PartitionKey**: Hallo partitionkey is samengesteld op basis van Hallo *resourceID* waarde toouniquely identificeren Hallo VM-resource.</span><span class="sxs-lookup"><span data-stu-id="03f12-164">**PartitionKey**: hello partitionkey is constructed based on hello *resourceID* value toouniquely identify hello VM resource.</span></span> <span data-ttu-id="03f12-165">voor bijvoorbeeld: 002Fsubscriptions:<subscriptionID>: 002FresourceGroups:002F<ResourceGroupName>: 002Fproviders:002FMicrosoft:002ECompute:002FvirtualMachines:002F<vmName></span><span class="sxs-lookup"><span data-stu-id="03f12-165">for e.g. : 002Fsubscriptions:<subscriptionID>:002FresourceGroups:002F<ResourceGroupName>:002Fproviders:002FMicrosoft:002ECompute:002FvirtualMachines:002F<vmName></span></span>  
* <span data-ttu-id="03f12-166">**RowKey** : volgt Hallo indeling <Descending time tick>:<Performance Counter Name>.</span><span class="sxs-lookup"><span data-stu-id="03f12-166">**RowKey** : Follows hello format <Descending time tick>:<Performance Counter Name>.</span></span> <span data-ttu-id="03f12-167">Hallo aflopende maatstreepjes berekening is maximale tijd ticks min Hallo-tijd van Hallo begin van Hallo aggregatie periode.</span><span class="sxs-lookup"><span data-stu-id="03f12-167">hello descending time tick calculation is max time ticks minus hello time of hello beginning of hello aggregation period.</span></span> <span data-ttu-id="03f12-168">Bijvoorbeeld</span><span class="sxs-lookup"><span data-stu-id="03f12-168">E.g.</span></span> <span data-ttu-id="03f12-169">Als Hallo voorbeeld periode op november-10-2015 gestart en 00:00Hrs UTC vervolgens Hallo berekening zou zijn: DateTime.MaxValue.Ticks - (nieuwe DateTime(2015,11,10,0,0,0,DateTimeKind.Utc). Tikken).</span><span class="sxs-lookup"><span data-stu-id="03f12-169">if hello sample period started on 10-Nov-2015 and 00:00Hrs UTC then hello calculation would be: DateTime.MaxValue.Ticks - (new DateTime(2015,11,10,0,0,0,DateTimeKind.Utc).Ticks).</span></span> <span data-ttu-id="03f12-170">Voor Hallo geheugen beschikbare bytes Hallo rij-sleutel performance teller ziet, zoals: 2519551871999999999__:005CMemory:005CAvailable:0020 Bytes</span><span class="sxs-lookup"><span data-stu-id="03f12-170">For hello memory available bytes performance counter hello row key will look like: 2519551871999999999__:005CMemory:005CAvailable:0020Bytes</span></span>
* <span data-ttu-id="03f12-171">**CounterName** : Hallo naam is van het prestatiemeteritem Hallo.</span><span class="sxs-lookup"><span data-stu-id="03f12-171">**CounterName** : Is hello name of hello performance counter.</span></span> <span data-ttu-id="03f12-172">Dit komt overeen met Hallo *counterSpecifier* gedefinieerd in Hallo XML-configuratie.</span><span class="sxs-lookup"><span data-stu-id="03f12-172">This matches hello *counterSpecifier* defined in hello xml config.</span></span>
* <span data-ttu-id="03f12-173">**Maximale** : maximumwaarde van het prestatiemeteritem Hallo HALLO hallo aggregatie periode.</span><span class="sxs-lookup"><span data-stu-id="03f12-173">**Maximum** : hello maximum value of hello performance counter over hello aggregation period.</span></span>
* <span data-ttu-id="03f12-174">**Minimale** : de minimumwaarde van het prestatiemeteritem Hallo HALLO hallo aggregatie periode.</span><span class="sxs-lookup"><span data-stu-id="03f12-174">**Minimum** : hello minimum value of hello performance counter over hello aggregation period.</span></span>
* <span data-ttu-id="03f12-175">**Totaal aantal** : Hallo som van alle waarden van het prestatiemeteritem Hallo gerapporteerd over Hallo aggregatie periode.</span><span class="sxs-lookup"><span data-stu-id="03f12-175">**Total** : hello sum of all values of hello performance counter reported over hello aggregation period.</span></span>
* <span data-ttu-id="03f12-176">**Aantal** : Hallo kunt u het totale aantal waarden die zijn gerapporteerd voor het prestatiemeteritem Hallo.</span><span class="sxs-lookup"><span data-stu-id="03f12-176">**Count** : hello total number of values reported for hello performance counter.</span></span>
* <span data-ttu-id="03f12-177">**Gemiddelde** : gemiddelde (totaal/aantal)-waarde van het prestatiemeteritem Hallo HALLO hallo aggregatie periode.</span><span class="sxs-lookup"><span data-stu-id="03f12-177">**Average** : hello average (total/count) value of hello performance counter over hello aggregation period.</span></span>

## <a name="next-steps"></a><span data-ttu-id="03f12-178">Volgende stappen</span><span class="sxs-lookup"><span data-stu-id="03f12-178">Next Steps</span></span>
* <span data-ttu-id="03f12-179">Zie voor een compleet codevoorbeeld sjabloon van een virtuele Windows-computer met de extensie voor diagnostische gegevens [201-vm-bewaking--extensie voor diagnostische gegevens](https://github.com/Azure/azure-quickstart-templates/tree/master/201-vm-monitoring-diagnostics-extension)</span><span class="sxs-lookup"><span data-stu-id="03f12-179">For a complete sample template of a Windows virtual machine with diagnostics extension see [201-vm-monitoring-diagnostics-extension](https://github.com/Azure/azure-quickstart-templates/tree/master/201-vm-monitoring-diagnostics-extension)</span></span>   
* <span data-ttu-id="03f12-180">Implementeren met behulp Hallo resource manager sjabloon [Azure PowerShell](ps-template.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json) of [Azure vanaf de opdrachtregel](../linux/create-ssh-secured-vm-from-template.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json)</span><span class="sxs-lookup"><span data-stu-id="03f12-180">Deploy hello resource manager template using [Azure PowerShell](ps-template.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json) or [Azure Command Line](../linux/create-ssh-secured-vm-from-template.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json)</span></span>
* <span data-ttu-id="03f12-181">Meer informatie over [Azure Resource Manager-sjablonen ontwerpen](../../resource-group-authoring-templates.md)</span><span class="sxs-lookup"><span data-stu-id="03f12-181">Learn more about [authoring Azure Resource Manager templates](../../resource-group-authoring-templates.md)</span></span>

