---
title: aaaCreate een Linux-VHD en uploaden in Azure
description: Informatie over toocreate en uploaden van een Azure virtuele harde schijf (VHD) die een Linux-besturingssysteem bevat.
services: virtual-machines-linux
documentationcenter: 
author: szarkos
manager: timlt
editor: tysonn
tags: azure-resource-manager,azure-service-management
ms.assetid: d351396c-95a0-4092-b7bf-c6aae0bbd112
ms.service: virtual-machines-linux
ms.workload: infrastructure-services
ms.tgt_pltfrm: vm-linux
ms.devlang: na
ms.topic: article
ms.date: 02/02/2017
ms.author: szark
ms.openlocfilehash: 208e15c035edb5520fc29ba8e4e71c42b041864d
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 10/06/2017
---
# <a name="information-for-non-endorsed-distributions"></a><span data-ttu-id="421fc-103">Informatie voor niet-aanbevolen distributies</span><span class="sxs-lookup"><span data-stu-id="421fc-103">Information for Non-Endorsed Distributions</span></span>
[!INCLUDE [learn-about-deployment-models](../../../includes/learn-about-deployment-models-both-include.md)]

<span data-ttu-id="421fc-104">Hello Azure-platform SLA van toepassing is toovirtual computers waarop een Linux-besturingssysteem alleen wanneer een Hallo Hallo [goedgekeurde distributies](endorsed-distros.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json) wordt gebruikt.</span><span class="sxs-lookup"><span data-stu-id="421fc-104">hello Azure platform SLA applies toovirtual machines running hello Linux OS only when one of hello [endorsed distributions](endorsed-distros.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json) is used.</span></span> <span data-ttu-id="421fc-105">Alle Linux-distributies die zijn opgegeven in hello Azure installatiekopie galerie zijn goedgekeurde distributies met Hallo vereiste configuratie.</span><span class="sxs-lookup"><span data-stu-id="421fc-105">All Linux distributions that are provided in hello Azure image gallery are endorsed distributions with hello required configuration.</span></span>

* [<span data-ttu-id="421fc-106">Linux op Azure - goedgekeurde distributies</span><span class="sxs-lookup"><span data-stu-id="421fc-106">Linux on Azure - Endorsed Distributions</span></span>](endorsed-distros.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)
* [<span data-ttu-id="421fc-107">Ondersteuning voor Linux-afbeeldingen in Microsoft Azure</span><span class="sxs-lookup"><span data-stu-id="421fc-107">Support for Linux images in Microsoft Azure</span></span>](https://support.microsoft.com/kb/2941892)

<span data-ttu-id="421fc-108">Alle verdelingen uitgevoerd op Azure moet toomeet een aantal vereisten toohave een kans tooproperly op Hallo platform worden uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="421fc-108">All distributions running on Azure will need toomeet a number of prerequisites toohave a chance tooproperly run on hello platform.</span></span>  <span data-ttu-id="421fc-109">In dit artikel is geen uitgebreide omdat elk distributiepunt verschilt; en het is wel mogelijk dat zelfs als u voldoet aan alle Hallo van de onderstaande criteria die u nog steeds toosignificantly uw Linux-systeem tooensure die correct wordt uitgevoerd op Hallo platform aanpassen.</span><span class="sxs-lookup"><span data-stu-id="421fc-109">This article is by no means comprehensive as every distribution is different; and it is quite possible that even if you meet all hello criteria below you will still need toosignificantly tweak your Linux system tooensure that it properly runs on hello platform.</span></span>

<span data-ttu-id="421fc-110">Het is daarom raadzaam dat u met een van begint onze [Linux op Azure goedgekeurde distributies](endorsed-distros.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json) indien mogelijk.</span><span class="sxs-lookup"><span data-stu-id="421fc-110">It is for this reason that we recommend that you start with one of our [Linux on Azure Endorsed Distributions](endorsed-distros.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json) when possible.</span></span> <span data-ttu-id="421fc-111">Hallo volgende artikelen leidt u door hoe tooprepare Hallo verschillende Linux-distributies die worden ondersteund door Azure goedgekeurde:</span><span class="sxs-lookup"><span data-stu-id="421fc-111">hello following articles will guide you through how tooprepare hello various endorsed Linux distributions that are supported on Azure:</span></span>

* <span data-ttu-id="421fc-112">**[Op basis van centOS distributies](create-upload-centos.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)**</span><span class="sxs-lookup"><span data-stu-id="421fc-112">**[CentOS-based Distributions](create-upload-centos.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)**</span></span>
* <span data-ttu-id="421fc-113">**[Debian Linux](debian-create-upload-vhd.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)**</span><span class="sxs-lookup"><span data-stu-id="421fc-113">**[Debian Linux](debian-create-upload-vhd.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)**</span></span>
* <span data-ttu-id="421fc-114">**[Oracle Linux](oracle-create-upload-vhd.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)**</span><span class="sxs-lookup"><span data-stu-id="421fc-114">**[Oracle Linux](oracle-create-upload-vhd.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)**</span></span>
* <span data-ttu-id="421fc-115">**[Red Hat Enterprise Linux](redhat-create-upload-vhd.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)**</span><span class="sxs-lookup"><span data-stu-id="421fc-115">**[Red Hat Enterprise Linux](redhat-create-upload-vhd.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)**</span></span>
* <span data-ttu-id="421fc-116">**[SLES & openSUSE](suse-create-upload-vhd.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)**</span><span class="sxs-lookup"><span data-stu-id="421fc-116">**[SLES & openSUSE](suse-create-upload-vhd.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)**</span></span>
* <span data-ttu-id="421fc-117">**[Ubuntu](create-upload-ubuntu.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)**</span><span class="sxs-lookup"><span data-stu-id="421fc-117">**[Ubuntu](create-upload-ubuntu.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)**</span></span>

<span data-ttu-id="421fc-118">Hallo rest van dit artikel wordt de nadruk gelegd op algemene richtlijnen voor het uitvoeren van uw Linux-distributie op Azure.</span><span class="sxs-lookup"><span data-stu-id="421fc-118">hello rest of this article will focus on general guidance for running your Linux distribution on Azure.</span></span>

## <a name="general-linux-installation-notes"></a><span data-ttu-id="421fc-119">Opmerkingen bij de installatie van de algemene Linux</span><span class="sxs-lookup"><span data-stu-id="421fc-119">General Linux Installation Notes</span></span>
* <span data-ttu-id="421fc-120">Hallo VHDX-indeling wordt niet ondersteund in Azure, alleen **vaste VHD**.</span><span class="sxs-lookup"><span data-stu-id="421fc-120">hello VHDX format is not supported in Azure, only **fixed VHD**.</span></span>  <span data-ttu-id="421fc-121">U kunt converteren Hallo tooVHD schijfindeling met behulp van Hyper-V-beheer of Hallo cmdlet convert-vhd.</span><span class="sxs-lookup"><span data-stu-id="421fc-121">You can convert hello disk tooVHD format using Hyper-V Manager or hello convert-vhd cmdlet.</span></span> <span data-ttu-id="421fc-122">Als u van VirtualBox gebruikmaakt betekent dit dat selecteren **een vaste grootte** als geboden toohello standaard dynamisch toegewezen bij het Hallo-schijf maken.</span><span class="sxs-lookup"><span data-stu-id="421fc-122">If you are using VirtualBox this means selecting **Fixed size** as opposed toohello default dynamically allocated when creating hello disk.</span></span>
* <span data-ttu-id="421fc-123">Azure biedt alleen ondersteuning voor virtuele machines van generatie 1.</span><span class="sxs-lookup"><span data-stu-id="421fc-123">Azure only supports generation 1 virtual machines.</span></span> <span data-ttu-id="421fc-124">U kunt een generatie 1 virtuele machine uit VHDX toohello VHD-bestand-indeling en dynamisch uitbreidbare tooa vaste schijf grootte converteren.</span><span class="sxs-lookup"><span data-stu-id="421fc-124">You can convert a generation 1 virtual machine from VHDX toohello VHD file format and from dynamically expanding tooa fixed sized disk.</span></span> <span data-ttu-id="421fc-125">Maar u een virtuele machine generatie niet wijzigen.</span><span class="sxs-lookup"><span data-stu-id="421fc-125">But you can't change a virtual machine's generation.</span></span> <span data-ttu-id="421fc-126">Zie voor meer informatie [moet ik een virtuele machine van generatie 1 of 2 maken in Hyper-V?](https://technet.microsoft.com/en-us/windows-server-docs/compute/hyper-v/plan/should-i-create-a-generation-1-or-2-virtual-machine-in-hyper-v)</span><span class="sxs-lookup"><span data-stu-id="421fc-126">For more information, see [Should I create a generation 1 or 2 virtual machine in Hyper-V?](https://technet.microsoft.com/en-us/windows-server-docs/compute/hyper-v/plan/should-i-create-a-generation-1-or-2-virtual-machine-in-hyper-v)</span></span>
* <span data-ttu-id="421fc-127">Hallo toegestane maximale lengte voor Hallo dat VHD is 1023 GB.</span><span class="sxs-lookup"><span data-stu-id="421fc-127">hello maximum size allowed for hello VHD is 1,023 GB.</span></span>
* <span data-ttu-id="421fc-128">Bij het installeren van Hallo Linux-systeem is *aanbevolen* dat u standaard partities in plaats van LVM (vaak Hallo standaard voor vele installaties gebruikt).</span><span class="sxs-lookup"><span data-stu-id="421fc-128">When installing hello Linux system it is *recommended* that you use standard partitions rather than LVM (often hello default for many installations).</span></span> <span data-ttu-id="421fc-129">Dit voorkomt LVM naam conflicteert met de gekloonde virtuele machines, met name een besturingssysteemschijf ooit toobe gekoppeld tooanother moet identiek zijn VM voor het oplossen van problemen.</span><span class="sxs-lookup"><span data-stu-id="421fc-129">This will avoid LVM name conflicts with cloned VMs, particularly if an OS disk ever needs toobe attached tooanother identical VM for troubleshooting.</span></span> <span data-ttu-id="421fc-130">[LVM](configure-lvm.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json) of [RAID](configure-raid.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json) mag worden gebruikt voor gegevensschijven.</span><span class="sxs-lookup"><span data-stu-id="421fc-130">[LVM](configure-lvm.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json) or [RAID](configure-raid.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json) may be used on data disks.</span></span>
* <span data-ttu-id="421fc-131">Kernel-ondersteuning voor het koppelen van UDF-bestandssysteem is vereist.</span><span class="sxs-lookup"><span data-stu-id="421fc-131">Kernel support for mounting UDF file systems is required.</span></span> <span data-ttu-id="421fc-132">Op de eerste keer opstarten op Azure Hallo inrichting configuratie toohello Linux VM doorgegeven via UDF-indeling media die is aangesloten toohello Gast.</span><span class="sxs-lookup"><span data-stu-id="421fc-132">At first boot on Azure hello provisioning configuration is passed toohello Linux VM via UDF-formatted media that is attached toohello guest.</span></span> <span data-ttu-id="421fc-133">Hello Azure Linux-agent moet worden kunnen toomount Hallo UDF-bestand system tooread de configuratie en Hallo VM inrichten.</span><span class="sxs-lookup"><span data-stu-id="421fc-133">hello Azure Linux agent must be able toomount hello UDF file system tooread its configuration and provision hello VM.</span></span>
* <span data-ttu-id="421fc-134">Kernel-versies van Linux onder 2.6.37 ondersteunen geen NUMA op Hyper-V met grotere virtuele machine.</span><span class="sxs-lookup"><span data-stu-id="421fc-134">Linux kernel versions below 2.6.37 do not support NUMA on Hyper-V with larger VM sizes.</span></span> <span data-ttu-id="421fc-135">Dit probleem voornamelijk effecten oudere distributies Hallo stroomopwaarts met Red Hat 2.6.32 kernel, en is vastgesteld in RHEL 6.6 (kernel 2.6.32 504).</span><span class="sxs-lookup"><span data-stu-id="421fc-135">This issue primarily impacts older distributions using hello upstream Red Hat 2.6.32 kernel, and was fixed in RHEL 6.6 (kernel-2.6.32-504).</span></span> <span data-ttu-id="421fc-136">Systemen met aangepaste kernels die ouder zijn dan 2.6.37 of op basis van RHEL kernels die ouder zijn dan 2.6.32-504 moet ingesteld Hallo opstarten parameter `numa=off` op Hallo kernel opdrachtregelprogramma in grub.conf.</span><span class="sxs-lookup"><span data-stu-id="421fc-136">Systems running custom kernels older than 2.6.37, or RHEL-based kernels older than 2.6.32-504 must set hello boot parameter `numa=off` on hello kernel command-line in grub.conf.</span></span> <span data-ttu-id="421fc-137">Zie voor meer informatie Red Hat [KB 436883](https://access.redhat.com/solutions/436883).</span><span class="sxs-lookup"><span data-stu-id="421fc-137">For more information see Red Hat [KB 436883](https://access.redhat.com/solutions/436883).</span></span>
* <span data-ttu-id="421fc-138">Configureer een partitie van de wisseling niet op Hallo OS-schijf.</span><span class="sxs-lookup"><span data-stu-id="421fc-138">Do not configure a swap partition on hello OS disk.</span></span> <span data-ttu-id="421fc-139">Hallo Linux-agent kan worden geconfigureerd toocreate een wisselbestand op Hallo tijdelijke schijf.</span><span class="sxs-lookup"><span data-stu-id="421fc-139">hello Linux agent can be configured toocreate a swap file on hello temporary resource disk.</span></span>  <span data-ttu-id="421fc-140">Meer informatie hierover vindt u in onderstaande Hallo stappen.</span><span class="sxs-lookup"><span data-stu-id="421fc-140">More information about this can be found in hello steps below.</span></span>
* <span data-ttu-id="421fc-141">Alle VHD's Hallo moeten grootten die veelvouden van 1 MB hebben.</span><span class="sxs-lookup"><span data-stu-id="421fc-141">All of hello VHDs must have sizes that are multiples of 1 MB.</span></span>

### <a name="installing-kernel-modules-without-hyper-v"></a><span data-ttu-id="421fc-142">Kernelmodules zonder Hyper-V installeren</span><span class="sxs-lookup"><span data-stu-id="421fc-142">Installing kernel modules without Hyper-V</span></span>
<span data-ttu-id="421fc-143">Azure wordt uitgevoerd op Hallo Hyper-V-hypervisor, dus Linux vereist dat bepaalde kernelmodules zijn geïnstalleerd in de volgorde toorun in Azure.</span><span class="sxs-lookup"><span data-stu-id="421fc-143">Azure runs on hello Hyper-V hypervisor, so Linux requires that certain kernel modules are installed in order toorun in Azure.</span></span> <span data-ttu-id="421fc-144">Als u een virtuele machine die is gemaakt buiten de Hyper-V hebt, Hallo Linux-installatieprogramma's kunnen niet Hallo stuurprogramma's voor Hyper-V in opnemen Hallo initiële ramdisk (initrd of initramfs) tenzij er wordt gedetecteerd dat deze wordt uitgevoerd een een Hyper-V-omgeving.</span><span class="sxs-lookup"><span data-stu-id="421fc-144">If you have a VM that was created outside of Hyper-V, hello Linux installers may not include hello drivers for Hyper-V in hello initial ramdisk (initrd or initramfs) unless it detects that it is running an a Hyper-V environment.</span></span> <span data-ttu-id="421fc-145">Wanneer u een andere virtualisatie systeem (dat wil zeggen Virtualbox, KVM, enz.) tooprepare uw Linux-installatiekopie, moet u mogelijk toorebuild hello initrd tooensure ten minste Hallo `hv_vmbus` en `hv_storvsc` kernelmodules zijn beschikbaar op de eerste ramdisk Hallo.</span><span class="sxs-lookup"><span data-stu-id="421fc-145">When using a different virtualization system (i.e. Virtualbox, KVM, etc.) tooprepare your Linux image, you may need toorebuild hello initrd tooensure that at least hello `hv_vmbus` and `hv_storvsc` kernel modules are available on hello initial ramdisk.</span></span>  <span data-ttu-id="421fc-146">Dit is een bekend probleem ten minste op systemen die op basis van Hallo upstream Red Hat distributie.</span><span class="sxs-lookup"><span data-stu-id="421fc-146">This is a known issue at least on systems based on hello upstream Red Hat distribution.</span></span>

<span data-ttu-id="421fc-147">Hallo-mechanisme voor het opnieuw opbouwen Hallo initrd of initramfs-installatiekopie kan variëren afhankelijk van Hallo distributie.</span><span class="sxs-lookup"><span data-stu-id="421fc-147">hello mechanism for rebuilding hello initrd or initramfs image may vary depending on hello distribution.</span></span> <span data-ttu-id="421fc-148">Raadpleeg de documentatie bij uw distributiepunt of ondersteuning voor de juiste procedure Hallo.</span><span class="sxs-lookup"><span data-stu-id="421fc-148">Please consult your distribution's documentation or support for hello proper procedure.</span></span>  <span data-ttu-id="421fc-149">Hier volgt een voorbeeld van hoe toorebuild initrd met Hallo Hallo `mkinitrd` hulpprogramma:</span><span class="sxs-lookup"><span data-stu-id="421fc-149">Here is one example for how toorebuild hello initrd using hello `mkinitrd` utility:</span></span>

<span data-ttu-id="421fc-150">Eerste back-up Hallo bestaande initrd installatiekopie:</span><span class="sxs-lookup"><span data-stu-id="421fc-150">First, back up hello existing initrd image:</span></span>

    # cd /boot
    # sudo cp initrd-`uname -r`.img  initrd-`uname -r`.img.bak

<span data-ttu-id="421fc-151">Vervolgens opnieuw opbouwen Hallo initrd Hello `hv_vmbus` en `hv_storvsc` kernelmodules:</span><span class="sxs-lookup"><span data-stu-id="421fc-151">Next, rebuild hello initrd with hello `hv_vmbus` and `hv_storvsc` kernel modules:</span></span>

    # sudo mkinitrd --preload=hv_storvsc --preload=hv_vmbus -v -f initrd-`uname -r`.img `uname -r`


### <a name="resizing-vhds"></a><span data-ttu-id="421fc-152">VHD's vergroten of verkleinen</span><span class="sxs-lookup"><span data-stu-id="421fc-152">Resizing VHDs</span></span>
<span data-ttu-id="421fc-153">VHD-installatiekopieën in Azure, moeten een virtuele grootte uitgelijnd too1MB hebben.</span><span class="sxs-lookup"><span data-stu-id="421fc-153">VHD images on Azure must have a virtual size aligned too1MB.</span></span>  <span data-ttu-id="421fc-154">VHD's die zijn gemaakt met behulp van Hyper-V moeten normaal gesproken al goed worden uitgelijnd.</span><span class="sxs-lookup"><span data-stu-id="421fc-154">Typically, VHDs created using Hyper-V should already be aligned correctly.</span></span>  <span data-ttu-id="421fc-155">Als Hallo VHD is niet correct wordt uitgelijnd vervolgens er een fout bericht vergelijkbaar toohello volgen verschijnt wanneer u toocreate probeert een *installatiekopie* van uw VHD:</span><span class="sxs-lookup"><span data-stu-id="421fc-155">If hello VHD is not aligned correctly then you may receive an error message similar toohello following when you attempt toocreate an *image* from your VHD:</span></span>

    "hello VHD http://<mystorageaccount>.blob.core.windows.net/vhds/MyLinuxVM.vhd has an unsupported virtual size of 21475270656 bytes. hello size must be a whole number (in MBs).”

<span data-ttu-id="421fc-156">tooremedy dit kunt u de grootte van virtuele machine met behulp van Hallo Hyper-V Manager-console of Hallo Hallo [formaat VHD](http://technet.microsoft.com/library/hh848535.aspx) Powershell-cmdlet.</span><span class="sxs-lookup"><span data-stu-id="421fc-156">tooremedy this you can resize hello VM using either hello Hyper-V Manager console or hello [Resize-VHD](http://technet.microsoft.com/library/hh848535.aspx) Powershell cmdlet.</span></span>  <span data-ttu-id="421fc-157">Als u bent niet wordt uitgevoerd in een Windows-omgeving is het aanbevolen toouse qemu img tooconvert (indien nodig) en formaat Hallo VHD.</span><span class="sxs-lookup"><span data-stu-id="421fc-157">If you are not running in a Windows environment then it is recommended toouse qemu-img tooconvert (if needed) and resize hello VHD.</span></span>

> [!NOTE]
> <span data-ttu-id="421fc-158">Er is een bekend probleem in qemu img versies > = 2.2.1 die in een onjuiste indeling VHD resulteert.</span><span class="sxs-lookup"><span data-stu-id="421fc-158">There is a known bug in qemu-img versions >=2.2.1 that results in an improperly formatted VHD.</span></span> <span data-ttu-id="421fc-159">Hallo-probleem is verholpen in QEMU 2.6.</span><span class="sxs-lookup"><span data-stu-id="421fc-159">hello issue has been fixed in QEMU 2.6.</span></span> <span data-ttu-id="421fc-160">Het verdient aanbeveling toouse qemu-img 2.2.0 of kleine of update too2.6 of hoger.</span><span class="sxs-lookup"><span data-stu-id="421fc-160">It is recommended toouse either qemu-img 2.2.0 or lower, or update too2.6 or higher.</span></span> <span data-ttu-id="421fc-161">Verwijzing: https://bugs.launchpad.net/qemu/+bug/1490611.</span><span class="sxs-lookup"><span data-stu-id="421fc-161">Reference: https://bugs.launchpad.net/qemu/+bug/1490611.</span></span>
> 
> 

1. <span data-ttu-id="421fc-162">VHD rechtstreeks met hulpprogramma's zoals vergroten of verkleinen Hallo `qemu-img` of `vbox-manage` kan leiden tot een opgestart VHD.</span><span class="sxs-lookup"><span data-stu-id="421fc-162">Resizing hello VHD directly using tools such as `qemu-img` or `vbox-manage` may result in an unbootable VHD.</span></span>  <span data-ttu-id="421fc-163">Daarom wordt het aanbevolen toofirst converteren Hallo VHD tooa ONBEWERKTE schijfimage.</span><span class="sxs-lookup"><span data-stu-id="421fc-163">So it is recommended toofirst convert hello VHD tooa RAW disk image.</span></span>  <span data-ttu-id="421fc-164">Als Hallo VM-installatiekopie al als ONBEWERKTE schijfimage (Hallo standaard voor bepaalde Hypervisors zoals KVM gemaakt is) kunt u deze stap overslaan:</span><span class="sxs-lookup"><span data-stu-id="421fc-164">If hello VM image was already created as RAW disk image (hello default for some Hypervisors such as KVM) then you may skip this step:</span></span>
   
       # qemu-img convert -f vpc -O raw MyLinuxVM.vhd MyLinuxVM.raw

2. <span data-ttu-id="421fc-165">Berekenen Hallo vereiste grootte van Hallo schijf installatiekopie tooensure die virtuele grootte Hallo uitgelijnde too1MB is.</span><span class="sxs-lookup"><span data-stu-id="421fc-165">Calculate hello required size of hello disk image tooensure that hello virtual size is aligned too1MB.</span></span>  <span data-ttu-id="421fc-166">Hallo bash-shell-script volgen kan u helpen bij dit.</span><span class="sxs-lookup"><span data-stu-id="421fc-166">hello following bash shell script can assist with this.</span></span>  <span data-ttu-id="421fc-167">Hallo-script gebruikt '`qemu-img info`' toodetermine virtuele grootte van de installatiekopie van een schijf Hallo Hallo en berekent vervolgens Hallo grootte toohello volgende 1 MB:</span><span class="sxs-lookup"><span data-stu-id="421fc-167">hello script uses "`qemu-img info`" toodetermine hello virtual size of hello disk image and then calculates hello size toohello next 1MB:</span></span>
   
       rawdisk="MyLinuxVM.raw"
       vhddisk="MyLinuxVM.vhd"
   
       MB=$((1024*1024))
       size=$(qemu-img info -f raw --output json "$rawdisk" | \
              gawk 'match($0, /"virtual-size": ([0-9]+),/, val) {print val[1]}')
   
       rounded_size=$((($size/$MB + 1)*$MB))
       echo "Rounded Size = $rounded_size"

3. <span data-ttu-id="421fc-168">Grootte van onbewerkte Hallo-schijf met behulp van $rounded_size zoals in Hallo hierboven script wijzigen:</span><span class="sxs-lookup"><span data-stu-id="421fc-168">Resize hello raw disk using $rounded_size as set in hello above script:</span></span>
   
       # qemu-img resize MyLinuxVM.raw $rounded_size

4. <span data-ttu-id="421fc-169">Converteer Hallo ONBEWERKTE schijf back tooa vaste grootte VHD:</span><span class="sxs-lookup"><span data-stu-id="421fc-169">Now, convert hello RAW disk back tooa fixed-size VHD:</span></span>
   
       # qemu-img convert -f raw -o subformat=fixed -O vpc MyLinuxVM.raw MyLinuxVM.vhd

   <span data-ttu-id="421fc-170">Of, met qemu versie **2.6 +** omvatten Hallo `force_size` optie:</span><span class="sxs-lookup"><span data-stu-id="421fc-170">Or, with qemu version **2.6+** include hello `force_size` option:</span></span>

       # qemu-img convert -f raw -o subformat=fixed,force_size -O vpc MyLinuxVM.raw MyLinuxVM.vhd

## <a name="linux-kernel-requirements"></a><span data-ttu-id="421fc-171">Linux-Kernel-vereisten</span><span class="sxs-lookup"><span data-stu-id="421fc-171">Linux Kernel Requirements</span></span>
<span data-ttu-id="421fc-172">Hallo Linux Integration Services (LIS) stuurprogramma's voor Hyper-V en Azure worden aangeleverd rechtstreeks toohello upstream Linux kernel.</span><span class="sxs-lookup"><span data-stu-id="421fc-172">hello Linux Integration Services (LIS) drivers for Hyper-V and Azure are contributed directly toohello upstream Linux kernel.</span></span> <span data-ttu-id="421fc-173">Groot aantal distributies met een recente versie van Linux kernel (dat wil zeggen 3.x) al deze stuurprogramma's beschikbaar zijn, of anders backported versies van deze stuurprogramma's voorzien van hun kernels.</span><span class="sxs-lookup"><span data-stu-id="421fc-173">Many distributions that include a recent Linux kernel version (i.e. 3.x) will have these drivers available already, or otherwise provide backported versions of these drivers with their kernels.</span></span>  <span data-ttu-id="421fc-174">Deze stuurprogramma's worden voortdurend wordt bijgewerkt in Hallo upstream-kernel met nieuwe oplossingen en functies, indien mogelijk het wordt daarom toorun aanbevolen een [distributie goedgekeurde](endorsed-distros.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json) die deze oplossingen en -updates zal bevatten.</span><span class="sxs-lookup"><span data-stu-id="421fc-174">These drivers are constantly being updated in hello upstream kernel with new fixes and features, so when possible it is recommended toorun an [endorsed distribution](endorsed-distros.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json) that will include these fixes and updates.</span></span>

<span data-ttu-id="421fc-175">Als u een variant van de Red Hat Enterprise Linux-versies uitvoert **6.0 6.3**, moet u tooinstall Hallo nieuwste LIS stuurprogramma's voor Hyper-V.</span><span class="sxs-lookup"><span data-stu-id="421fc-175">If you are running a variant of Red Hat Enterprise Linux versions **6.0-6.3**, then you will need tooinstall hello latest LIS drivers for Hyper-V.</span></span> <span data-ttu-id="421fc-176">Hallo-stuurprogramma's kunnen worden gevonden [op deze locatie](http://go.microsoft.com/fwlink/p/?LinkID=254263&clcid=0x409).</span><span class="sxs-lookup"><span data-stu-id="421fc-176">hello drivers can be found [at this location](http://go.microsoft.com/fwlink/p/?LinkID=254263&clcid=0x409).</span></span> <span data-ttu-id="421fc-177">Vanaf RHEL **6.4 +** (en afgeleiden) Hallo LIS stuurprogramma's zijn al opgenomen in de kernel Hallo en dus geen aanvullende installatie-pakketten zijn benodigde toorun deze systemen op Azure.</span><span class="sxs-lookup"><span data-stu-id="421fc-177">As of RHEL **6.4+** (and derivatives) hello LIS drivers are already included with hello kernel and so no additional installation packages are needed toorun those systems on Azure.</span></span>

<span data-ttu-id="421fc-178">Als u een aangepaste kernel is vereist, is het aanbevolen toouse een meer recente kernelversie (dat wil zeggen **3.8 +**).</span><span class="sxs-lookup"><span data-stu-id="421fc-178">If a custom kernel is required, it is recommended toouse a more recent kernel version (i.e. **3.8+**).</span></span> <span data-ttu-id="421fc-179">Voor deze distributies of leveranciers die hun eigen kernel onderhouden, worden sommige inspanning vereist tooregularly backport Hallo LIS stuurprogramma's uit Hallo upstream kernel tooyour aangepaste kernel.</span><span class="sxs-lookup"><span data-stu-id="421fc-179">For those distributions or vendors who maintain their own kernel, some effort will be required tooregularly backport hello LIS drivers from hello upstream kernel tooyour custom kernel.</span></span>  <span data-ttu-id="421fc-180">Zelfs als u al een relatief recente kernelversie wordt uitgevoerd, is het raadzaam tookeep bijhouden van een upstream-correcties in Hallo LIS stuurprogramma's en backport die indien nodig.</span><span class="sxs-lookup"><span data-stu-id="421fc-180">Even if you are already running a relatively recent kernel version, it is highly recommended tookeep track of any upstream fixes in hello LIS drivers and backport those as needed.</span></span> <span data-ttu-id="421fc-181">Hallo-locatie van de bronbestanden van Hallo LIS stuurprogramma is beschikbaar in Hallo [instaan](https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/tree/MAINTAINERS) bestand in Hallo Linux kernel bronstructuur:</span><span class="sxs-lookup"><span data-stu-id="421fc-181">hello location of hello LIS driver source files is available in hello [MAINTAINERS](https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/tree/MAINTAINERS) file in hello Linux kernel source tree:</span></span>

    F:    arch/x86/include/asm/mshyperv.h
    F:    arch/x86/include/uapi/asm/hyperv.h
    F:    arch/x86/kernel/cpu/mshyperv.c
    F:    drivers/hid/hid-hyperv.c
    F:    drivers/hv/
    F:    drivers/input/serio/hyperv-keyboard.c
    F:    drivers/net/hyperv/
    F:    drivers/scsi/storvsc_drv.c
    F:    drivers/video/fbdev/hyperv_fb.c
    F:    include/linux/hyperv.h
    F:    tools/hv/

<span data-ttu-id="421fc-182">Bij een zeer minimale Hallo afwezigheid van de volgende patches Hallo hebben bekend toocause problemen op Azure en zodat deze moeten worden opgenomen in de kernel Hallo.</span><span class="sxs-lookup"><span data-stu-id="421fc-182">At a very minimum, hello absence of hello following patches have been known toocause problems on Azure and so these must be included in hello kernel.</span></span> <span data-ttu-id="421fc-183">Deze lijst is geen volledig of voltooid voor alle verdelingen:</span><span class="sxs-lookup"><span data-stu-id="421fc-183">This list is by no means exhaustive or complete for all distributions:</span></span>

* [<span data-ttu-id="421fc-184">ata_piix: schijven toohello Hyper-V-stuurprogramma's standaard uitgesteld</span><span class="sxs-lookup"><span data-stu-id="421fc-184">ata_piix: defer disks toohello Hyper-V drivers by default</span></span>](https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/drivers/ata/ata_piix.c?id=cd006086fa5d91414d8ff9ff2b78fbb593878e3c)
* [<span data-ttu-id="421fc-185">storvsc: Account voor de pakketten in transit in Hallo opnieuw instellen van pad</span><span class="sxs-lookup"><span data-stu-id="421fc-185">storvsc: Account for in-transit packets in hello RESET path</span></span>](https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/drivers/scsi/storvsc_drv.c?id=5c1b10ab7f93d24f29b5630286e323d1c5802d5c)
* [<span data-ttu-id="421fc-186">storvsc: informatie over het gebruik van WRITE_SAME voorkomen</span><span class="sxs-lookup"><span data-stu-id="421fc-186">storvsc: avoid usage of WRITE_SAME</span></span>](https://git.kernel.org/cgit/linux/kernel/git/next/linux-next.git/commit/drivers/scsi/storvsc_drv.c?id=3e8f4f4065901c8dfc51407e1984495e1748c090)
* [<span data-ttu-id="421fc-187">storvsc: dezelfde schrijven uitschakelen voor RAID en stuurprogramma's voor netwerkadapters virtuele host</span><span class="sxs-lookup"><span data-stu-id="421fc-187">storvsc: Disable WRITE SAME for RAID and virtual host adapter drivers</span></span>](https://git.kernel.org/cgit/linux/kernel/git/next/linux-next.git/commit/drivers/scsi/storvsc_drv.c?id=54b2b50c20a61b51199bedb6e5d2f8ec2568fb43)
* [<span data-ttu-id="421fc-188">storvsc: NULL-aanwijzer fix verwijzing</span><span class="sxs-lookup"><span data-stu-id="421fc-188">storvsc: NULL pointer dereference fix</span></span>](https://git.kernel.org/cgit/linux/kernel/git/next/linux-next.git/commit/drivers/scsi/storvsc_drv.c?id=b12bb60d6c350b348a4e1460cd68f97ccae9822e)
* [<span data-ttu-id="421fc-189">storvsc: ring buffer fouten kunnen leiden tot i/o-blokkeren</span><span class="sxs-lookup"><span data-stu-id="421fc-189">storvsc: ring buffer failures may result in I/O freeze</span></span>](https://git.kernel.org/cgit/linux/kernel/git/next/linux-next.git/commit/drivers/scsi/storvsc_drv.c?id=e86fb5e8ab95f10ec5f2e9430119d5d35020c951)
* [<span data-ttu-id="421fc-190">scsi_sysfs: beschermen tegen een dubbele uitvoering van __scsi_remove_device</span><span class="sxs-lookup"><span data-stu-id="421fc-190">scsi_sysfs: protect against double execution of __scsi_remove_device</span></span>](https://git.kernel.org/cgit/linux/kernel/git/next/linux-next.git/commit/drivers/scsi/scsi_sysfs.c?id=be821fd8e62765de43cc4f0e2db363d0e30a7e9b)

## <a name="hello-azure-linux-agent"></a><span data-ttu-id="421fc-191">Hello Azure Linux Agent</span><span class="sxs-lookup"><span data-stu-id="421fc-191">hello Azure Linux Agent</span></span>
<span data-ttu-id="421fc-192">Hallo [Azure Linux Agent](../windows/agent-user-guide.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json) (waagent) is vereist tooproperly een Linux-machine inrichten in Azure.</span><span class="sxs-lookup"><span data-stu-id="421fc-192">hello [Azure Linux Agent](../windows/agent-user-guide.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json) (waagent) is required tooproperly provision a Linux virtual machine in Azure.</span></span> <span data-ttu-id="421fc-193">U kunt de nieuwste versie hello, problemen met het bestand of pull-aanvragen op Hallo verzenden [Linux Agent GitHub-repo-](https://github.com/Azure/WALinuxAgent).</span><span class="sxs-lookup"><span data-stu-id="421fc-193">You can get hello latest version, file issues or submit pull requests at hello [Linux Agent GitHub repo](https://github.com/Azure/WALinuxAgent).</span></span>

* <span data-ttu-id="421fc-194">Hallo Linux-agent is vrijgegeven onder licentie Hallo Apache 2.0.</span><span class="sxs-lookup"><span data-stu-id="421fc-194">hello Linux agent is released under hello Apache 2.0 license.</span></span> <span data-ttu-id="421fc-195">Groot aantal distributies al Geef RPM of deb pakketten voor Hallo-agent, en dus in sommige gevallen dit kan worden geïnstalleerd en bijgewerkt met weinig moeite.</span><span class="sxs-lookup"><span data-stu-id="421fc-195">Many distributions already provide RPM or deb packages for hello agent, and so in some cases this can be installed and updated with little effort.</span></span>
* <span data-ttu-id="421fc-196">Hello Azure Linux Agent vereist Python v2.6 +.</span><span class="sxs-lookup"><span data-stu-id="421fc-196">hello Azure Linux Agent requires Python v2.6+.</span></span>
* <span data-ttu-id="421fc-197">Hallo-agent ook vereist Hallo python pyasn1 module.</span><span class="sxs-lookup"><span data-stu-id="421fc-197">hello agent also requires hello python-pyasn1 module.</span></span> <span data-ttu-id="421fc-198">De meeste distributies biedt dit als een afzonderlijk pakket dat kan worden geïnstalleerd.</span><span class="sxs-lookup"><span data-stu-id="421fc-198">Most distributions provide this as a separate package that can be installed.</span></span>
* <span data-ttu-id="421fc-199">In sommige gevallen hello Azure Linux Agent mogelijk niet compatibel met NetworkManager.</span><span class="sxs-lookup"><span data-stu-id="421fc-199">In some cases hello Azure Linux Agent may not be compatible with NetworkManager.</span></span> <span data-ttu-id="421fc-200">Veel van Hallo RPM/Deb pakketten geleverd door distributies NetworkManager configureren als een conflict toohello waagent-pakket en dus verwijdert NetworkManager wanneer u Hallo Linux agentpakket installeert.</span><span class="sxs-lookup"><span data-stu-id="421fc-200">Many of hello RPM/Deb packages provided by distributions configure NetworkManager as a conflict toohello waagent package, and thus will uninstall NetworkManager when you install hello Linux agent package.</span></span>

## <a name="general-linux-system-requirements"></a><span data-ttu-id="421fc-201">Linux-systeem voor algemene vereisten</span><span class="sxs-lookup"><span data-stu-id="421fc-201">General Linux System Requirements</span></span>

* <span data-ttu-id="421fc-202">Hallo kernel opstarten regel in GRUB of GRUB2 tooinclude Hallo volgende parameters wijzigen.</span><span class="sxs-lookup"><span data-stu-id="421fc-202">Modify hello kernel boot line in GRUB or GRUB2 tooinclude hello following parameters.</span></span> <span data-ttu-id="421fc-203">Hiermee zorgt u ervoor dat alle consoleberichten toohello eerste seriële poort, die Azure helpen kan worden verzonden ondersteuning bij het opsporen van problemen:</span><span class="sxs-lookup"><span data-stu-id="421fc-203">This will also ensure all console messages are sent toohello first serial port, which can assist Azure support with debugging issues:</span></span>
  
        console=ttyS0,115200n8 earlyprintk=ttyS0,115200 rootdelay=300
  
    <span data-ttu-id="421fc-204">Hiermee zorgt u ervoor dat alle consoleberichten toohello eerste seriële poort, die Azure helpen kan worden verzonden ondersteuning bij het opsporen van problemen.</span><span class="sxs-lookup"><span data-stu-id="421fc-204">This will also ensure all console messages are sent toohello first serial port, which can assist Azure support with debugging issues.</span></span>
  
    <span data-ttu-id="421fc-205">Bovendien toohello hierboven, het is raadzaam te*verwijderen* Hallo volgende parameters als deze bestaan:</span><span class="sxs-lookup"><span data-stu-id="421fc-205">In addition toohello above, it is recommended too*remove* hello following parameters if they exist:</span></span>
  
        rhgb quiet crashkernel=auto
  
    <span data-ttu-id="421fc-206">Grafische en stil opstarten zijn niet handig in een omgeving waar we alle Hallo logboeken toobe verzonden toohello seriële poort.</span><span class="sxs-lookup"><span data-stu-id="421fc-206">Graphical and quiet boot are not useful in a cloud environment where we want all hello logs toobe sent toohello serial port.</span></span> <span data-ttu-id="421fc-207">Hallo `crashkernel` mogelijk links geconfigureerd indien gewenst, maar dat deze parameter verminderen Hallo en de hoeveelheid beschikbaar geheugen in Hallo VM 128 MB of meer, die mogelijk problemen op Hallo kleinere VM opmerking.</span><span class="sxs-lookup"><span data-stu-id="421fc-207">hello `crashkernel` option may be left configured if desired, but note that this parameter will reduce hello amount of available memory in hello VM by 128MB or more, which may be problematic on hello smaller VM sizes.</span></span>

* <span data-ttu-id="421fc-208">Hello Azure Linux Agent installeren</span><span class="sxs-lookup"><span data-stu-id="421fc-208">Installing hello Azure Linux Agent</span></span>
  
    <span data-ttu-id="421fc-209">Hello Azure Linux Agent is vereist voor het inrichten van een Linux-installatiekopie in Azure.</span><span class="sxs-lookup"><span data-stu-id="421fc-209">hello Azure Linux Agent is required for provisioning a Linux image on Azure.</span></span>  <span data-ttu-id="421fc-210">Groot aantal distributies bieden Hallo agent als een pakket RPM of Deb (Hallo pakket heet doorgaans 'WALinuxAgent' of 'walinuxagent').</span><span class="sxs-lookup"><span data-stu-id="421fc-210">Many distributions provide hello agent as an RPM or Deb package (hello package is typically called 'WALinuxAgent' or 'walinuxagent').</span></span>  <span data-ttu-id="421fc-211">Hallo agent kunt ook handmatig worden geïnstalleerd door de stappen te volgen Hallo in Hallo [Linux Agent handleiding](../windows/agent-user-guide.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json).</span><span class="sxs-lookup"><span data-stu-id="421fc-211">hello agent can also be installed manually by following hello steps in hello [Linux Agent Guide](../windows/agent-user-guide.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json).</span></span>

* <span data-ttu-id="421fc-212">Zorg ervoor dat Hallo SSH-server is geïnstalleerd en geconfigureerd toostart tijdens het opstarten.</span><span class="sxs-lookup"><span data-stu-id="421fc-212">Ensure that hello SSH server is installed and configured toostart at boot time.</span></span>  <span data-ttu-id="421fc-213">Dit is meestal Hallo standaard.</span><span class="sxs-lookup"><span data-stu-id="421fc-213">This is usually hello default.</span></span>

* <span data-ttu-id="421fc-214">Maak geen wisselruimte op Hallo besturingssysteemschijf</span><span class="sxs-lookup"><span data-stu-id="421fc-214">Do not create swap space on hello OS disk</span></span>
  
    <span data-ttu-id="421fc-215">Hello Azure Linux Agent kunt wisselruimte Hallo lokale resource schijf die is aangesloten toohello VM na het inrichten op Azure automatisch configureren.</span><span class="sxs-lookup"><span data-stu-id="421fc-215">hello Azure Linux Agent can automatically configure swap space using hello local resource disk that is attached toohello VM after provisioning on Azure.</span></span> <span data-ttu-id="421fc-216">Houd er rekening mee dat lokale resource Hallo schijf is een *tijdelijke* schijfruimte en kan worden leeggemaakt wanneer Hallo VM gemaakt is.</span><span class="sxs-lookup"><span data-stu-id="421fc-216">Note that hello local resource disk is a *temporary* disk, and might be emptied when hello VM is deprovisioned.</span></span> <span data-ttu-id="421fc-217">Na de installatie van hello Azure Linux Agent (Zie de vorige stap), wijzigen Hallo-parameters in /etc/waagent.conf op de juiste wijze te volgen:</span><span class="sxs-lookup"><span data-stu-id="421fc-217">After installing hello Azure Linux Agent (see previous step), modify hello following parameters in /etc/waagent.conf appropriately:</span></span>
  
        ResourceDisk.Format=y
        ResourceDisk.Filesystem=ext4
        ResourceDisk.MountPoint=/mnt/resource
        ResourceDisk.EnableSwap=y
        ResourceDisk.SwapSizeMB=2048    ## NOTE: set this toowhatever you need it toobe.

* <span data-ttu-id="421fc-218">Voer Hallo opdrachten toodeprovision Hallo virtuele machine na een laatste stap:</span><span class="sxs-lookup"><span data-stu-id="421fc-218">As a final step, run hello following commands toodeprovision hello virtual machine:</span></span>
  
        # sudo waagent -force -deprovision
        # export HISTSIZE=0
        # logout
  
  > [!NOTE]
  > <span data-ttu-id="421fc-219">Op Virtualbox mogelijk ziet u volgende fout nadat Hallo ' waagent-force - deprovision': `[Errno 5] Input/output error`.</span><span class="sxs-lookup"><span data-stu-id="421fc-219">On Virtualbox you may see hello following error after running 'waagent -force -deprovision': `[Errno 5] Input/output error`.</span></span> <span data-ttu-id="421fc-220">Dit foutbericht is niet kritiek en kan worden genegeerd.</span><span class="sxs-lookup"><span data-stu-id="421fc-220">This error message is not critical and can be ignored.</span></span>
  > 
  > 

* <span data-ttu-id="421fc-221">U wordt vervolgens tooshut omlaag Hallo virtuele machine nodig hebt en Hallo VHD tooAzure uploaden.</span><span class="sxs-lookup"><span data-stu-id="421fc-221">You will then need tooshut down hello virtual machine and upload hello VHD tooAzure.</span></span>

