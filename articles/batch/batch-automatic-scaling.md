---
title: Automatisch schalen rekenknooppunten in een Azure Batch-pool | Microsoft Docs
description: Schakel automatisch schalen op een cloud-pool dynamisch aanpassen zodat het aantal rekenknooppunten in de pool.
services: batch
documentationcenter: 
author: tamram
manager: timlt
editor: tysonn
ms.assetid: c624cdfc-c5f2-4d13-a7d7-ae080833b779
ms.service: batch
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: vm-windows
ms.workload: multiple
ms.date: 06/20/2017
ms.author: tamram
ms.custom: H1Hack27Feb2017
ms.openlocfilehash: f0e49cd8a64a48c53f5b6104703164a597c797f0
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 07/11/2017
---
# <a name="create-an-automatic-scaling-formula-for-scaling-compute-nodes-in-a-batch-pool"></a><span data-ttu-id="e148e-103">Een automatische schaling formule voor het schalen van rekenknooppunten in een Batch-pool maken</span><span class="sxs-lookup"><span data-stu-id="e148e-103">Create an automatic scaling formula for scaling compute nodes in a Batch pool</span></span>

<span data-ttu-id="e148e-104">Azure Batch kan pools op basis van de parameters die u definieert automatisch schalen.</span><span class="sxs-lookup"><span data-stu-id="e148e-104">Azure Batch can automatically scale pools based on parameters that you define.</span></span> <span data-ttu-id="e148e-105">Met automatisch schalen Batch worden dynamisch knooppunten toegevoegd aan een groep als de taak eisen toename en rekenknooppunten wordt verwijderd als ze afnemen.</span><span class="sxs-lookup"><span data-stu-id="e148e-105">With automatic scaling, Batch dynamically adds nodes to a pool as task demands increase, and removes compute nodes as they decrease.</span></span> <span data-ttu-id="e148e-106">U kunt zowel tijd en geld opslaan door het automatisch aanpassen van het aantal rekenknooppunten gebruikt door de Batch-toepassing.</span><span class="sxs-lookup"><span data-stu-id="e148e-106">You can save both time and money by automatically adjusting the number of compute nodes used by your Batch application.</span></span> 

<span data-ttu-id="e148e-107">Inschakelen van automatisch schalen op een pool van rekenknooppunten door te koppelen aan een *formule voor automatisch schalen* die u definieert.</span><span class="sxs-lookup"><span data-stu-id="e148e-107">You enable automatic scaling on a pool of compute nodes by associating with it an *autoscale formula* that you define.</span></span> <span data-ttu-id="e148e-108">De Batch-service gebruikt de formule voor automatisch schalen om te bepalen het aantal rekenknooppunten die nodig zijn voor het uitvoeren van uw workload.</span><span class="sxs-lookup"><span data-stu-id="e148e-108">The Batch service uses the autoscale formula to determine the number of compute nodes that are needed to execute your workload.</span></span> <span data-ttu-id="e148e-109">Knooppunten kunnen worden toegewezen knooppunten COMPUTE of [prioriteit Laag knooppunten](batch-low-pri-vms.md).</span><span class="sxs-lookup"><span data-stu-id="e148e-109">Compute nodes may be dedicated nodes or [low-priority nodes](batch-low-pri-vms.md).</span></span> <span data-ttu-id="e148e-110">Batch reageert op service metrische gegevens die regelmatig wordt verzameld.</span><span class="sxs-lookup"><span data-stu-id="e148e-110">Batch responds to service metrics data that is collected periodically.</span></span> <span data-ttu-id="e148e-111">Met deze metrische gegevens Batch Hiermee past u het aantal rekenknooppunten in de groep op basis van de formule en met een configureerbare interval.</span><span class="sxs-lookup"><span data-stu-id="e148e-111">Using this metrics data, Batch adjusts the number of compute nodes in the pool based on your formula and at a configurable interval.</span></span>

<span data-ttu-id="e148e-112">U kunt inschakelen automatische schaling tijdens het maken van een groep of op een bestaande toepassingen.</span><span class="sxs-lookup"><span data-stu-id="e148e-112">You can enable automatic scaling either when a pool is created, or on an existing pool.</span></span> <span data-ttu-id="e148e-113">U kunt ook een bestaande formule op een groep die is geconfigureerd voor automatisch schalen wijzigen.</span><span class="sxs-lookup"><span data-stu-id="e148e-113">You can also change an existing formula on a pool that is configured for autoscaling.</span></span> <span data-ttu-id="e148e-114">Batch kunt u kunt uw formules evalueren voordat u eraan toe te wijzen aan groepen en het controleren van de status van automatisch vergroten/verkleinen wordt uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="e148e-114">Batch enables you to evaluate your formulas before assigning them to pools and to monitor the status of automatic scaling runs.</span></span>

<span data-ttu-id="e148e-115">Dit artikel worden de verschillende entiteiten die gezamenlijk uw formules automatisch schalen, met inbegrip van variabelen, operators, bewerkingen en functies.</span><span class="sxs-lookup"><span data-stu-id="e148e-115">This article discusses the various entities that make up your autoscale formulas, including variables, operators, operations, and functions.</span></span> <span data-ttu-id="e148e-116">Het verkrijgen van verschillende compute resource en taak metrische gegevens in Batch besproken.</span><span class="sxs-lookup"><span data-stu-id="e148e-116">We discuss how to obtain various compute resource and task metrics within Batch.</span></span> <span data-ttu-id="e148e-117">Deze metrische gegevens kunt u een aantal van uw pool knooppunten op basis van gebruiks- en resourcestatus aanpassen.</span><span class="sxs-lookup"><span data-stu-id="e148e-117">You can use these metrics to adjust your pool's node count based on resource usage and task status.</span></span> <span data-ttu-id="e148e-118">We vervolgens wordt beschreven hoe een formule maken en inschakelen van automatisch schalen op een groep met de Batch REST en de .NET API's.</span><span class="sxs-lookup"><span data-stu-id="e148e-118">We then describe how to construct a formula and enable automatic scaling on a pool by using both the Batch REST and .NET APIs.</span></span> <span data-ttu-id="e148e-119">Ten slotte voltooien we met een paar voorbeeld formules.</span><span class="sxs-lookup"><span data-stu-id="e148e-119">Finally, we finish up with a few example formulas.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="e148e-120">Wanneer u een Batch-account maakt, kunt u de [accountconfiguratie](batch-api-basics.md#account), waarmee wordt bepaald of groepen in een Batch-service-abonnement (de standaardinstelling) of in uw gebruikerabonnement zijn toegewezen.</span><span class="sxs-lookup"><span data-stu-id="e148e-120">When you create a Batch account, you can specify the [account configuration](batch-api-basics.md#account), which determines whether pools are allocated in a Batch service subscription (the default), or in your user subscription.</span></span> <span data-ttu-id="e148e-121">Als u uw Batch-account hebt gemaakt met de standaardconfiguratie van de Batch-Service, zijn uw account is beperkt tot een maximum aantal kernen die kunnen worden gebruikt voor verwerking.</span><span class="sxs-lookup"><span data-stu-id="e148e-121">If you created your Batch account with the default Batch Service configuration, then your account is limited to a maximum number of cores that can be used for processing.</span></span> <span data-ttu-id="e148e-122">De Batch-service schaalt rekenknooppunten alleen tot die core is bereikt.</span><span class="sxs-lookup"><span data-stu-id="e148e-122">The Batch service scales compute nodes only up to that core limit.</span></span> <span data-ttu-id="e148e-123">Daarom kan de Batch-service niet het doelaantal rekenknooppunten opgegeven met een formule voor automatisch schalen bereikt.</span><span class="sxs-lookup"><span data-stu-id="e148e-123">For this reason, the Batch service may not reach the target number of compute nodes specified by an autoscale formula.</span></span> <span data-ttu-id="e148e-124">Zie [quota en limieten voor de Azure Batch-service](batch-quota-limit.md) voor informatie over het weergeven en uw accountquota verhogen.</span><span class="sxs-lookup"><span data-stu-id="e148e-124">See [Quotas and limits for the Azure Batch service](batch-quota-limit.md) for information on viewing and increasing your account quotas.</span></span>
>
><span data-ttu-id="e148e-125">Als u uw account hebt gemaakt met de configuratie van het abonnement van de gebruiker, klikt u vervolgens deelt uw account in het quotum voor kernen voor het abonnement.</span><span class="sxs-lookup"><span data-stu-id="e148e-125">If you created your account with the User Subscription configuration, then your account shares in the core quota for the subscription.</span></span> <span data-ttu-id="e148e-126">Zie [Virtual Machines limits](../azure-subscription-service-limits.md#virtual-machines-limits) (Limieten voor Virtuele Machines) in [Azure subscription and service limits, quotas, and constraints](../azure-subscription-service-limits.md) (Azure-abonnement en servicelimieten, -quota en -beperkingen) voor meer informatie.</span><span class="sxs-lookup"><span data-stu-id="e148e-126">For more information, see [Virtual Machines limits](../azure-subscription-service-limits.md#virtual-machines-limits) in [Azure subscription and service limits, quotas, and constraints](../azure-subscription-service-limits.md).</span></span>
>
>

## <a name="automatic-scaling-formulas"></a><span data-ttu-id="e148e-127">Automatische schaling formules</span><span class="sxs-lookup"><span data-stu-id="e148e-127">Automatic scaling formulas</span></span>
<span data-ttu-id="e148e-128">Een formule voor automatisch schalen is een string-waarde die u definieert die een of meer instructies bevat.</span><span class="sxs-lookup"><span data-stu-id="e148e-128">An automatic scaling formula is a string value that you define that contains one or more statements.</span></span> <span data-ttu-id="e148e-129">De formule voor automatisch schalen is toegewezen aan een pool [autoScaleFormula] [ rest_autoscaleformula] element (Batch REST) of [CloudPool.AutoScaleFormula] [ net_cloudpool_autoscaleformula] eigenschap (Batch .NET).</span><span class="sxs-lookup"><span data-stu-id="e148e-129">The autoscale formula is assigned to a pool's [autoScaleFormula][rest_autoscaleformula] element (Batch REST) or [CloudPool.AutoScaleFormula][net_cloudpool_autoscaleformula] property (Batch .NET).</span></span> <span data-ttu-id="e148e-130">De Batch-service gebruikt de formule om te bepalen van het doelaantal rekenknooppunten in de groep voor het volgende interval wordt verwerkt.</span><span class="sxs-lookup"><span data-stu-id="e148e-130">The Batch service uses your formula to determine the target number of compute nodes in the pool for the next interval of processing.</span></span> <span data-ttu-id="e148e-131">De formule tekenreeks mag niet meer dan 8 KB, kan maximaal 100 instructies die worden gescheiden door puntkomma's en kunnen regeleinden en -opmerkingen bevatten bevatten.</span><span class="sxs-lookup"><span data-stu-id="e148e-131">The formula string cannot exceed 8 KB, can include up to 100 statements that are separated by semicolons, and can include line breaks and comments.</span></span>

<span data-ttu-id="e148e-132">U kunt automatische schaling formules beschouwen als een Batch automatisch schalen 'taal'.</span><span class="sxs-lookup"><span data-stu-id="e148e-132">You can think of automatic scaling formulas as a Batch autoscale "language."</span></span> <span data-ttu-id="e148e-133">Formule-instructies zijn gratis ingedeelde expressies die zowel de service gedefinieerde variabelen (variabelen die zijn gedefinieerd door de Batch-service) en de gebruiker gedefinieerde variabelen (variabelen die u definieert) kunnen opnemen.</span><span class="sxs-lookup"><span data-stu-id="e148e-133">Formula statements are free-formed expressions that can include both service-defined variables (variables defined by the Batch service) and user-defined variables (variables that you define).</span></span> <span data-ttu-id="e148e-134">Ze kunnen verschillende bewerkingen op deze waarden uitvoeren met behulp van de ingebouwde typen, operators en functies.</span><span class="sxs-lookup"><span data-stu-id="e148e-134">They can perform various operations on these values by using built-in types, operators, and functions.</span></span> <span data-ttu-id="e148e-135">Bijvoorbeeld, een instructie kan duren voordat de volgende notatie:</span><span class="sxs-lookup"><span data-stu-id="e148e-135">For example, a statement might take the following form:</span></span>

```
$myNewVariable = function($ServiceDefinedVariable, $myCustomVariable);
```

<span data-ttu-id="e148e-136">Formules bevatten doorgaans meerdere instructies die bewerkingen uitvoeren op waarden die zijn verkregen in de vorige instructies.</span><span class="sxs-lookup"><span data-stu-id="e148e-136">Formulas generally contain multiple statements that perform operations on values that are obtained in previous statements.</span></span> <span data-ttu-id="e148e-137">Bijvoorbeeld, eerst we een waarde voor aanvragen `variable1`, vervolgens doorgeven aan een functie voor het vullen van `variable2`:</span><span class="sxs-lookup"><span data-stu-id="e148e-137">For example, first we obtain a value for `variable1`, then pass it to a function to populate `variable2`:</span></span>

```
$variable1 = function1($ServiceDefinedVariable);
$variable2 = function2($OtherServiceDefinedVariable, $variable1);
```

<span data-ttu-id="e148e-138">Deze instructies bevatten in de formule voor automatisch schalen die moet worden uitgevoerd op een doel-nummer van rekenknooppunten.</span><span class="sxs-lookup"><span data-stu-id="e148e-138">Include these statements in your autoscale formula to arrive at a target number of compute nodes.</span></span> <span data-ttu-id="e148e-139">Toegewezen knooppunten en knooppunten met lage prioriteit hebben hun eigen doelinstellingen zodat u kunt een doel voor elk type knooppunt definiëren.</span><span class="sxs-lookup"><span data-stu-id="e148e-139">Dedicated nodes and low-priority nodes each have their own target settings, so that you can define a target for each type of node.</span></span> <span data-ttu-id="e148e-140">Een formule voor automatisch schalen kan een doelwaarde voor speciale knooppunten of een doelwaarde voor prioriteit Laag knooppunten bevatten.</span><span class="sxs-lookup"><span data-stu-id="e148e-140">An autoscale formula can include a target value for dedicated nodes, a target value for low-priority nodes, or both.</span></span>

<span data-ttu-id="e148e-141">Het doelaantal knooppunten is mogelijk hoger, kleine of hetzelfde als het huidige aantal knooppunten van dat type in de groep.</span><span class="sxs-lookup"><span data-stu-id="e148e-141">The target number of nodes may be higher, lower, or the same as the current number of nodes of that type in the pool.</span></span> <span data-ttu-id="e148e-142">Batch evalueert formule voor een pool automatisch schalen met een bepaald interval (Zie [automatisch vergroten / verkleinen intervallen](#automatic-scaling-interval)).</span><span class="sxs-lookup"><span data-stu-id="e148e-142">Batch evaluates a pool's autoscale formula at a specific interval (see [automatic scaling intervals](#automatic-scaling-interval)).</span></span> <span data-ttu-id="e148e-143">Batch Hiermee past u het nummer van het doel van elk type knooppunt in de pool aan het getal waarmee de formule voor automatisch schalen op het moment van evaluatie.</span><span class="sxs-lookup"><span data-stu-id="e148e-143">Batch adjusts the target number of each type of node in the pool to the number that your autoscale formula specifies at the time of evaluation.</span></span>

### <a name="sample-autoscale-formula"></a><span data-ttu-id="e148e-144">Formule voor automatisch schalen</span><span class="sxs-lookup"><span data-stu-id="e148e-144">Sample autoscale formula</span></span>

<span data-ttu-id="e148e-145">Hier volgt een voorbeeld van een formule voor automatisch schalen die u voor de meeste scenario's kan worden aangepast.</span><span class="sxs-lookup"><span data-stu-id="e148e-145">Here is an example of an autoscale formula that can be adjusted to work for most scenarios.</span></span> <span data-ttu-id="e148e-146">De variabelen `startingNumberOfVMs` en `maxNumberofVMs` in het voorbeeld formule kan worden aangepast aan uw behoeften.</span><span class="sxs-lookup"><span data-stu-id="e148e-146">The variables `startingNumberOfVMs` and `maxNumberofVMs` in the example formula can be adjusted to your needs.</span></span> <span data-ttu-id="e148e-147">Deze formule schaalt toegewezen knooppunten, maar kan worden gewijzigd om te passen op prioriteit Laag knooppunten ook schaal.</span><span class="sxs-lookup"><span data-stu-id="e148e-147">This formula scales dedicated nodes, but can be modified to apply to scale low-priority nodes as well.</span></span> 

```
startingNumberOfVMs = 1;
maxNumberofVMs = 25;
pendingTaskSamplePercent = $PendingTasks.GetSamplePercent(180 * TimeInterval_Second);
pendingTaskSamples = pendingTaskSamplePercent < 70 ? startingNumberOfVMs : avg($PendingTasks.GetSample(180 * TimeInterval_Second));
$TargetDedicatedNodes=min(maxNumberofVMs, pendingTaskSamples);
```

<span data-ttu-id="e148e-148">Met deze formule voor automatisch schalen is in eerste instantie de toepassingen gemaakt met één VM.</span><span class="sxs-lookup"><span data-stu-id="e148e-148">With this autoscale formula, the pool is initially created with a single VM.</span></span> <span data-ttu-id="e148e-149">De `$PendingTasks` metriek definieert het aantal taken die uitgevoerd of in de wachtrij zijn.</span><span class="sxs-lookup"><span data-stu-id="e148e-149">The `$PendingTasks` metric defines the number of tasks that are running or queued.</span></span> <span data-ttu-id="e148e-150">De formule Hiermee zoekt u het gemiddelde aantal in behandeling zijnde taken in de laatste 180 seconden en wordt de `$TargetDedicatedNodes` variabele dienovereenkomstig.</span><span class="sxs-lookup"><span data-stu-id="e148e-150">The formula finds the average number of pending tasks in the last 180 seconds and sets the `$TargetDedicatedNodes` variable accordingly.</span></span> <span data-ttu-id="e148e-151">De formule zorgt ervoor dat het doelaantal knooppunten toegewezen nooit meer dan 25 virtuele machines.</span><span class="sxs-lookup"><span data-stu-id="e148e-151">The formula ensures that the target number of dedicated nodes never exceeds 25 VMs.</span></span> <span data-ttu-id="e148e-152">Als nieuwe taken worden verzonden, wordt de groep automatisch groeit.</span><span class="sxs-lookup"><span data-stu-id="e148e-152">As new tasks are submitted, the pool automatically grows.</span></span> <span data-ttu-id="e148e-153">Als de taken zijn voltooid, virtuele machines gratis één voor één en worden de formule voor automatisch schalen verkleint de pool.</span><span class="sxs-lookup"><span data-stu-id="e148e-153">As tasks complete, VMs become free one by one and the autoscaling formula shrinks the pool.</span></span>

## <a name="variables"></a><span data-ttu-id="e148e-154">Variabelen</span><span class="sxs-lookup"><span data-stu-id="e148e-154">Variables</span></span>
<span data-ttu-id="e148e-155">U kunt beide **service gedefinieerde** en **gebruiker gedefinieerde** variabelen in formules automatisch schalen.</span><span class="sxs-lookup"><span data-stu-id="e148e-155">You can use both **service-defined** and **user-defined** variables in your autoscale formulas.</span></span> <span data-ttu-id="e148e-156">De service gedefinieerde variabelen zijn ingebouwd in de Batch-service.</span><span class="sxs-lookup"><span data-stu-id="e148e-156">The service-defined variables are built in to the Batch service.</span></span> <span data-ttu-id="e148e-157">Sommige service gedefinieerde variabelen zijn alleen-lezen en sommige alleen-lezen zijn.</span><span class="sxs-lookup"><span data-stu-id="e148e-157">Some service-defined variables are read-write, and some are read-only.</span></span> <span data-ttu-id="e148e-158">Gebruiker gedefinieerde variabelen zijn variabelen die u definieert.</span><span class="sxs-lookup"><span data-stu-id="e148e-158">User-defined variables are variables that you define.</span></span> <span data-ttu-id="e148e-159">In de voorbeeldformule weergegeven in de vorige sectie `$TargetDedicatedNodes` en `$PendingTasks` service gedefinieerde variabelen zijn.</span><span class="sxs-lookup"><span data-stu-id="e148e-159">In the example formula shown in the previous section, `$TargetDedicatedNodes` and `$PendingTasks` are service-defined variables.</span></span> <span data-ttu-id="e148e-160">Variabelen `startingNumberOfVMs` en `maxNumberofVMs` zijn van de gebruiker gedefinieerde variabelen.</span><span class="sxs-lookup"><span data-stu-id="e148e-160">Variables `startingNumberOfVMs` and `maxNumberofVMs` are user-defined variables.</span></span>

> [!NOTE]
> <span data-ttu-id="e148e-161">Service gedefinieerde variabelen worden altijd voorafgegaan door een dollarteken ($).</span><span class="sxs-lookup"><span data-stu-id="e148e-161">Service-defined variables are always preceded by a dollar sign ($).</span></span> <span data-ttu-id="e148e-162">Voor de gebruiker gedefinieerde variabelen is het dollarteken optioneel.</span><span class="sxs-lookup"><span data-stu-id="e148e-162">For user-defined variables, the dollar sign is optional.</span></span>
>
>

<span data-ttu-id="e148e-163">De volgende tabellen geven alleen-lezen en alleen-lezen-variabelen die zijn gedefinieerd door de Batch-service.</span><span class="sxs-lookup"><span data-stu-id="e148e-163">The following tables show both read-write and read-only variables that are defined by the Batch service.</span></span>

<span data-ttu-id="e148e-164">U kunt ophalen en stel de waarden van deze service gedefinieerde variabelen voor het beheren van het aantal rekenknooppunten in een groep:</span><span class="sxs-lookup"><span data-stu-id="e148e-164">You can get and set the values of these service-defined variables to manage the number of compute nodes in a pool:</span></span>

| <span data-ttu-id="e148e-165">Lees-/ service gedefinieerde variabelen</span><span class="sxs-lookup"><span data-stu-id="e148e-165">Read-write service-defined variables</span></span> | <span data-ttu-id="e148e-166">Beschrijving</span><span class="sxs-lookup"><span data-stu-id="e148e-166">Description</span></span> |
| --- | --- |
| <span data-ttu-id="e148e-167">$TargetDedicatedNodes</span><span class="sxs-lookup"><span data-stu-id="e148e-167">$TargetDedicatedNodes</span></span> |<span data-ttu-id="e148e-168">Het doelaantal toegewezen rekenknooppunten voor de pool.</span><span class="sxs-lookup"><span data-stu-id="e148e-168">The target number of dedicated compute nodes for the pool.</span></span> <span data-ttu-id="e148e-169">Het aantal toegewezen knooppunten is opgegeven als een doel omdat het gewenste aantal knooppunten niet altijd door een groep bereiken mogelijk.</span><span class="sxs-lookup"><span data-stu-id="e148e-169">The number of dedicated nodes is specified as a target because a pool may not always achieve the desired number of nodes.</span></span> <span data-ttu-id="e148e-170">Bijvoorbeeld, als het doelaantal toegewezen knooppunten is gewijzigd door een evaluatie met automatisch schalen voordat de groep het eerste doel is bereikt, klikt u vervolgens de groep bereikt mogelijk niet het doel.</span><span class="sxs-lookup"><span data-stu-id="e148e-170">For example, if the target number of dedicated nodes is modified by an autoscale evaluation before the pool has reached the initial target, then the pool may not reach the target.</span></span> <br /><br /> <span data-ttu-id="e148e-171">Een groep in een account dat is gemaakt met de configuratie van de Batch-Service kan het doel niet bereiken als het doel een Batch-account knooppunt of core-quota overschrijdt.</span><span class="sxs-lookup"><span data-stu-id="e148e-171">A pool in an account created with the Batch Service configuration may not achieve its target if the target exceeds a Batch account node or core quota.</span></span> <span data-ttu-id="e148e-172">Een groep in een account dat is gemaakt met de configuratie van het abonnement van de gebruiker kan het doel niet bereiken als het doel het quotum voor gedeelde kernen voor het abonnement overschrijdt.</span><span class="sxs-lookup"><span data-stu-id="e148e-172">A pool in an account created with the User Subscription configuration may not achieve its target if the target exceeds the shared core quota for the subscription.</span></span>|
| <span data-ttu-id="e148e-173">$TargetLowPriorityNodes</span><span class="sxs-lookup"><span data-stu-id="e148e-173">$TargetLowPriorityNodes</span></span> |<span data-ttu-id="e148e-174">Het doelaantal prioriteit Laag rekenknooppunten voor de pool.</span><span class="sxs-lookup"><span data-stu-id="e148e-174">The target number of low-priority compute nodes for the pool.</span></span> <span data-ttu-id="e148e-175">Het aantal knooppunten met lage prioriteit is opgegeven als een doel omdat het gewenste aantal knooppunten niet altijd door een groep bereiken mogelijk.</span><span class="sxs-lookup"><span data-stu-id="e148e-175">The number of low-priority nodes is specified as a target because a pool may not always achieve the desired number of nodes.</span></span> <span data-ttu-id="e148e-176">Bijvoorbeeld, als het doelaantal knooppunten prioriteit laag is gewijzigd door een evaluatie met automatisch schalen voordat de groep het eerste doel is bereikt, klikt u vervolgens de groep bereikt mogelijk niet het doel.</span><span class="sxs-lookup"><span data-stu-id="e148e-176">For example, if the target number of low-priority nodes is modified by an autoscale evaluation before the pool has reached the initial target, then the pool may not reach the target.</span></span> <span data-ttu-id="e148e-177">Een pool kan ook niet het doel bereiken als het doel een Batch-account knooppunt of core-quota overschrijdt.</span><span class="sxs-lookup"><span data-stu-id="e148e-177">A pool may also not achieve its target if the target exceeds a Batch account node or core quota.</span></span> <br /><br /> <span data-ttu-id="e148e-178">Zie voor meer informatie op prioriteit Laag rekenknooppunten [met lage prioriteit virtuele machines, met Batch (Preview)](batch-low-pri-vms.md).</span><span class="sxs-lookup"><span data-stu-id="e148e-178">For more information on low-priority compute nodes, see [Use low-priority VMs with Batch (Preview)](batch-low-pri-vms.md).</span></span> |
| <span data-ttu-id="e148e-179">$NodeDeallocationOption</span><span class="sxs-lookup"><span data-stu-id="e148e-179">$NodeDeallocationOption</span></span> |<span data-ttu-id="e148e-180">De actie die optreedt wanneer de rekenknooppunten worden verwijderd uit een groep.</span><span class="sxs-lookup"><span data-stu-id="e148e-180">The action that occurs when compute nodes are removed from a pool.</span></span> <span data-ttu-id="e148e-181">Mogelijke waarden zijn:</span><span class="sxs-lookup"><span data-stu-id="e148e-181">Possible values are:</span></span><ul><li><span data-ttu-id="e148e-182">**requeue**--taken onmiddellijk beëindigd en weer in de wachtrij plaatst, zodat ze opnieuw worden gepland.</span><span class="sxs-lookup"><span data-stu-id="e148e-182">**requeue**--Terminates tasks immediately and puts them back on the job queue so that they are rescheduled.</span></span><li><span data-ttu-id="e148e-183">**beëindigen**--taken onmiddellijk beëindigd en worden deze verwijderd uit de wachtrij.</span><span class="sxs-lookup"><span data-stu-id="e148e-183">**terminate**--Terminates tasks immediately and removes them from the job queue.</span></span><li><span data-ttu-id="e148e-184">**taskcompletion**--wacht voor momenteel wordt uitgevoerd voor het voltooien van taken en vervolgens verwijdert u het knooppunt uit de groep.</span><span class="sxs-lookup"><span data-stu-id="e148e-184">**taskcompletion**--Waits for currently running tasks to finish and then removes the node from the pool.</span></span><li><span data-ttu-id="e148e-185">**retaineddata**--wordt gewacht op alle lokale taak bewaard gegevens op het knooppunt dat moet worden opgeruimd voordat het knooppunt wordt verwijderd uit de groep.</span><span class="sxs-lookup"><span data-stu-id="e148e-185">**retaineddata**--Waits for all the local task-retained data on the node to be cleaned up before removing the node from the pool.</span></span></ul> |

<span data-ttu-id="e148e-186">U kunt de waarde van deze service gedefinieerde variabelen moet aanbrengen op basis van de metrische gegevens van de Batch-service krijgen:</span><span class="sxs-lookup"><span data-stu-id="e148e-186">You can get the value of these service-defined variables to make adjustments that are based on metrics from the Batch service:</span></span>

| <span data-ttu-id="e148e-187">Alleen-lezen service gedefinieerde variabelen</span><span class="sxs-lookup"><span data-stu-id="e148e-187">Read-only service-defined variables</span></span> | <span data-ttu-id="e148e-188">Beschrijving</span><span class="sxs-lookup"><span data-stu-id="e148e-188">Description</span></span> |
| --- | --- |
| <span data-ttu-id="e148e-189">$CPUPercent</span><span class="sxs-lookup"><span data-stu-id="e148e-189">$CPUPercent</span></span> |<span data-ttu-id="e148e-190">Het gemiddelde percentage van CPU-gebruik.</span><span class="sxs-lookup"><span data-stu-id="e148e-190">The average percentage of CPU usage.</span></span> |
| <span data-ttu-id="e148e-191">$WallClockSeconds</span><span class="sxs-lookup"><span data-stu-id="e148e-191">$WallClockSeconds</span></span> |<span data-ttu-id="e148e-192">Het aantal seconden verbruikt.</span><span class="sxs-lookup"><span data-stu-id="e148e-192">The number of seconds consumed.</span></span> |
| <span data-ttu-id="e148e-193">$MemoryBytes</span><span class="sxs-lookup"><span data-stu-id="e148e-193">$MemoryBytes</span></span> |<span data-ttu-id="e148e-194">Het gemiddelde aantal megabytes gebruikt.</span><span class="sxs-lookup"><span data-stu-id="e148e-194">The average number of megabytes used.</span></span> |
| <span data-ttu-id="e148e-195">$DiskBytes</span><span class="sxs-lookup"><span data-stu-id="e148e-195">$DiskBytes</span></span> |<span data-ttu-id="e148e-196">Het gemiddelde aantal gigabyte gebruikt op de lokale schijven.</span><span class="sxs-lookup"><span data-stu-id="e148e-196">The average number of gigabytes used on the local disks.</span></span> |
| <span data-ttu-id="e148e-197">$DiskReadBytes</span><span class="sxs-lookup"><span data-stu-id="e148e-197">$DiskReadBytes</span></span> |<span data-ttu-id="e148e-198">Het aantal bytes dat is gelezen.</span><span class="sxs-lookup"><span data-stu-id="e148e-198">The number of bytes read.</span></span> |
| <span data-ttu-id="e148e-199">$DiskWriteBytes</span><span class="sxs-lookup"><span data-stu-id="e148e-199">$DiskWriteBytes</span></span> |<span data-ttu-id="e148e-200">Het aantal geschreven bytes.</span><span class="sxs-lookup"><span data-stu-id="e148e-200">The number of bytes written.</span></span> |
| <span data-ttu-id="e148e-201">$DiskReadOps</span><span class="sxs-lookup"><span data-stu-id="e148e-201">$DiskReadOps</span></span> |<span data-ttu-id="e148e-202">Het aantal gelezen schijfbewerkingen die worden uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="e148e-202">The count of read disk operations performed.</span></span> |
| <span data-ttu-id="e148e-203">$DiskWriteOps</span><span class="sxs-lookup"><span data-stu-id="e148e-203">$DiskWriteOps</span></span> |<span data-ttu-id="e148e-204">Het aantal schrijfbewerkingen schijf uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="e148e-204">The count of write disk operations performed.</span></span> |
| <span data-ttu-id="e148e-205">$NetworkInBytes</span><span class="sxs-lookup"><span data-stu-id="e148e-205">$NetworkInBytes</span></span> |<span data-ttu-id="e148e-206">Het aantal inkomende bytes.</span><span class="sxs-lookup"><span data-stu-id="e148e-206">The number of inbound bytes.</span></span> |
| <span data-ttu-id="e148e-207">$NetworkOutBytes</span><span class="sxs-lookup"><span data-stu-id="e148e-207">$NetworkOutBytes</span></span> |<span data-ttu-id="e148e-208">Het aantal uitgaande bytes.</span><span class="sxs-lookup"><span data-stu-id="e148e-208">The number of outbound bytes.</span></span> |
| <span data-ttu-id="e148e-209">$SampleNodeCount</span><span class="sxs-lookup"><span data-stu-id="e148e-209">$SampleNodeCount</span></span> |<span data-ttu-id="e148e-210">Het aantal rekenknooppunten.</span><span class="sxs-lookup"><span data-stu-id="e148e-210">The count of compute nodes.</span></span> |
| <span data-ttu-id="e148e-211">$ActiveTasks</span><span class="sxs-lookup"><span data-stu-id="e148e-211">$ActiveTasks</span></span> |<span data-ttu-id="e148e-212">Het aantal taken die kan worden uitgevoerd, maar nog niet zijn uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="e148e-212">The number of tasks that are ready to execute but are not yet executing.</span></span> <span data-ttu-id="e148e-213">Het aantal $ActiveTasks bevat alle taken die zijn opgenomen in de actieve status heeft en waarvan afhankelijkheden is voldaan.</span><span class="sxs-lookup"><span data-stu-id="e148e-213">The $ActiveTasks count includes all tasks that are in the active state and whose dependencies have been satisfied.</span></span> <span data-ttu-id="e148e-214">Alle taken die zich in de actieve status maar waarvan afhankelijkheden niet is voldaan, worden uitgesloten van het aantal $ActiveTasks.</span><span class="sxs-lookup"><span data-stu-id="e148e-214">Any tasks that are in the active state but whose dependencies have not been satisfied are excluded from the $ActiveTasks count.</span></span>|
| <span data-ttu-id="e148e-215">$RunningTasks</span><span class="sxs-lookup"><span data-stu-id="e148e-215">$RunningTasks</span></span> |<span data-ttu-id="e148e-216">Het aantal taken actief is.</span><span class="sxs-lookup"><span data-stu-id="e148e-216">The number of tasks in a running state.</span></span> |
| <span data-ttu-id="e148e-217">$PendingTasks</span><span class="sxs-lookup"><span data-stu-id="e148e-217">$PendingTasks</span></span> |<span data-ttu-id="e148e-218">De som van $ActiveTasks en $RunningTasks.</span><span class="sxs-lookup"><span data-stu-id="e148e-218">The sum of $ActiveTasks and $RunningTasks.</span></span> |
| <span data-ttu-id="e148e-219">$SucceededTasks</span><span class="sxs-lookup"><span data-stu-id="e148e-219">$SucceededTasks</span></span> |<span data-ttu-id="e148e-220">Het aantal taken die voltooid is.</span><span class="sxs-lookup"><span data-stu-id="e148e-220">The number of tasks that finished successfully.</span></span> |
| <span data-ttu-id="e148e-221">$FailedTasks</span><span class="sxs-lookup"><span data-stu-id="e148e-221">$FailedTasks</span></span> |<span data-ttu-id="e148e-222">Het aantal taken dat is mislukt.</span><span class="sxs-lookup"><span data-stu-id="e148e-222">The number of tasks that failed.</span></span> |
| <span data-ttu-id="e148e-223">$CurrentDedicatedNodes</span><span class="sxs-lookup"><span data-stu-id="e148e-223">$CurrentDedicatedNodes</span></span> |<span data-ttu-id="e148e-224">Het huidige aantal toegewezen rekenknooppunten.</span><span class="sxs-lookup"><span data-stu-id="e148e-224">The current number of dedicated compute nodes.</span></span> |
| <span data-ttu-id="e148e-225">$CurrentLowPriorityNodes</span><span class="sxs-lookup"><span data-stu-id="e148e-225">$CurrentLowPriorityNodes</span></span> |<span data-ttu-id="e148e-226">Het huidige aantal prioriteit Laag rekenknooppunten, met inbegrip van alle knooppunten die verschoven zijn.</span><span class="sxs-lookup"><span data-stu-id="e148e-226">The current number of low-priority compute nodes, including any nodes that have been pre-empted.</span></span> |
| <span data-ttu-id="e148e-227">$PreemptedNodeCount</span><span class="sxs-lookup"><span data-stu-id="e148e-227">$PreemptedNodeCount</span></span> | <span data-ttu-id="e148e-228">Het aantal knooppunten in de groep die zich in een status verschoven.</span><span class="sxs-lookup"><span data-stu-id="e148e-228">The number of nodes in the pool that are in a pre-empted state.</span></span> |

> [!TIP]
> <span data-ttu-id="e148e-229">De alleen-lezen, service gedefinieerde variabelen die worden weergegeven in de vorige tabel zijn *objecten* die verschillende methoden voor toegang tot gegevens die zijn gekoppeld aan elk bieden.</span><span class="sxs-lookup"><span data-stu-id="e148e-229">The read-only, service-defined variables that are shown in the previous table are *objects* that provide various methods to access data associated with each.</span></span> <span data-ttu-id="e148e-230">Zie voor meer informatie [verkrijgen voorbeeldgegevens](#getsampledata) verderop in dit artikel.</span><span class="sxs-lookup"><span data-stu-id="e148e-230">For more information, see [Obtain sample data](#getsampledata) later in this article.</span></span>
>
>

## <a name="types"></a><span data-ttu-id="e148e-231">Typen</span><span class="sxs-lookup"><span data-stu-id="e148e-231">Types</span></span>
<span data-ttu-id="e148e-232">Deze typen worden ondersteund in een formule:</span><span class="sxs-lookup"><span data-stu-id="e148e-232">These types are supported in a formula:</span></span>

* <span data-ttu-id="e148e-233">dubbele</span><span class="sxs-lookup"><span data-stu-id="e148e-233">double</span></span>
* <span data-ttu-id="e148e-234">doubleVec</span><span class="sxs-lookup"><span data-stu-id="e148e-234">doubleVec</span></span>
* <span data-ttu-id="e148e-235">doubleVecList</span><span class="sxs-lookup"><span data-stu-id="e148e-235">doubleVecList</span></span>
* <span data-ttu-id="e148e-236">Tekenreeks</span><span class="sxs-lookup"><span data-stu-id="e148e-236">string</span></span>
* <span data-ttu-id="e148e-237">tijdstempel--tijdstempel is een samengestelde structuur met de volgende leden:</span><span class="sxs-lookup"><span data-stu-id="e148e-237">timestamp--timestamp is a compound structure that contains the following members:</span></span>

  * <span data-ttu-id="e148e-238">jaar</span><span class="sxs-lookup"><span data-stu-id="e148e-238">year</span></span>
  * <span data-ttu-id="e148e-239">maand (1-12)</span><span class="sxs-lookup"><span data-stu-id="e148e-239">month (1-12)</span></span>
  * <span data-ttu-id="e148e-240">dag (1-31)</span><span class="sxs-lookup"><span data-stu-id="e148e-240">day (1-31)</span></span>
  * <span data-ttu-id="e148e-241">werkdag (in de indeling van het nummer; bijvoorbeeld: 1 voor maandag)</span><span class="sxs-lookup"><span data-stu-id="e148e-241">weekday (in the format of number; for example, 1 for Monday)</span></span>
  * <span data-ttu-id="e148e-242">uur (in 24-uurs notatie, bijvoorbeeld: 13 betekent 1 uur)</span><span class="sxs-lookup"><span data-stu-id="e148e-242">hour (in 24-hour number format; for example, 13 means 1 PM)</span></span>
  * <span data-ttu-id="e148e-243">minuten (00-59)</span><span class="sxs-lookup"><span data-stu-id="e148e-243">minute (00-59)</span></span>
  * <span data-ttu-id="e148e-244">tweede (00-59)</span><span class="sxs-lookup"><span data-stu-id="e148e-244">second (00-59)</span></span>
* <span data-ttu-id="e148e-245">TimeInterval</span><span class="sxs-lookup"><span data-stu-id="e148e-245">timeinterval</span></span>

  * <span data-ttu-id="e148e-246">TimeInterval_Zero</span><span class="sxs-lookup"><span data-stu-id="e148e-246">TimeInterval_Zero</span></span>
  * <span data-ttu-id="e148e-247">TimeInterval_100ns</span><span class="sxs-lookup"><span data-stu-id="e148e-247">TimeInterval_100ns</span></span>
  * <span data-ttu-id="e148e-248">TimeInterval_Microsecond</span><span class="sxs-lookup"><span data-stu-id="e148e-248">TimeInterval_Microsecond</span></span>
  * <span data-ttu-id="e148e-249">TimeInterval_Millisecond</span><span class="sxs-lookup"><span data-stu-id="e148e-249">TimeInterval_Millisecond</span></span>
  * <span data-ttu-id="e148e-250">TimeInterval_Second</span><span class="sxs-lookup"><span data-stu-id="e148e-250">TimeInterval_Second</span></span>
  * <span data-ttu-id="e148e-251">TimeInterval_Minute</span><span class="sxs-lookup"><span data-stu-id="e148e-251">TimeInterval_Minute</span></span>
  * <span data-ttu-id="e148e-252">TimeInterval_Hour</span><span class="sxs-lookup"><span data-stu-id="e148e-252">TimeInterval_Hour</span></span>
  * <span data-ttu-id="e148e-253">TimeInterval_Day</span><span class="sxs-lookup"><span data-stu-id="e148e-253">TimeInterval_Day</span></span>
  * <span data-ttu-id="e148e-254">TimeInterval_Week</span><span class="sxs-lookup"><span data-stu-id="e148e-254">TimeInterval_Week</span></span>
  * <span data-ttu-id="e148e-255">TimeInterval_Year</span><span class="sxs-lookup"><span data-stu-id="e148e-255">TimeInterval_Year</span></span>

## <a name="operations"></a><span data-ttu-id="e148e-256">Bewerkingen</span><span class="sxs-lookup"><span data-stu-id="e148e-256">Operations</span></span>
<span data-ttu-id="e148e-257">Deze bewerkingen zijn toegestaan voor de typen die worden vermeld in de vorige sectie.</span><span class="sxs-lookup"><span data-stu-id="e148e-257">These operations are allowed on the types that are listed in the previous section.</span></span>

| <span data-ttu-id="e148e-258">Bewerking</span><span class="sxs-lookup"><span data-stu-id="e148e-258">Operation</span></span> | <span data-ttu-id="e148e-259">Ondersteunde operators</span><span class="sxs-lookup"><span data-stu-id="e148e-259">Supported operators</span></span> | <span data-ttu-id="e148e-260">Resultaattype</span><span class="sxs-lookup"><span data-stu-id="e148e-260">Result type</span></span> |
| --- | --- | --- |
| <span data-ttu-id="e148e-261">dubbele *operator* dubbele</span><span class="sxs-lookup"><span data-stu-id="e148e-261">double *operator* double</span></span> |<span data-ttu-id="e148e-262">+, -, *, /</span><span class="sxs-lookup"><span data-stu-id="e148e-262">+, -, *, /</span></span> |<span data-ttu-id="e148e-263">dubbele</span><span class="sxs-lookup"><span data-stu-id="e148e-263">double</span></span> |
| <span data-ttu-id="e148e-264">dubbele *operator* timeinterval</span><span class="sxs-lookup"><span data-stu-id="e148e-264">double *operator* timeinterval</span></span> |* |<span data-ttu-id="e148e-265">TimeInterval</span><span class="sxs-lookup"><span data-stu-id="e148e-265">timeinterval</span></span> |
| <span data-ttu-id="e148e-266">doubleVec *operator* dubbele</span><span class="sxs-lookup"><span data-stu-id="e148e-266">doubleVec *operator* double</span></span> |<span data-ttu-id="e148e-267">+, -, *, /</span><span class="sxs-lookup"><span data-stu-id="e148e-267">+, -, *, /</span></span> |<span data-ttu-id="e148e-268">doubleVec</span><span class="sxs-lookup"><span data-stu-id="e148e-268">doubleVec</span></span> |
| <span data-ttu-id="e148e-269">doubleVec *operator* doubleVec</span><span class="sxs-lookup"><span data-stu-id="e148e-269">doubleVec *operator* doubleVec</span></span> |<span data-ttu-id="e148e-270">+, -, *, /</span><span class="sxs-lookup"><span data-stu-id="e148e-270">+, -, *, /</span></span> |<span data-ttu-id="e148e-271">doubleVec</span><span class="sxs-lookup"><span data-stu-id="e148e-271">doubleVec</span></span> |
| <span data-ttu-id="e148e-272">TimeInterval *operator* dubbele</span><span class="sxs-lookup"><span data-stu-id="e148e-272">timeinterval *operator* double</span></span> |<span data-ttu-id="e148e-273">*, /</span><span class="sxs-lookup"><span data-stu-id="e148e-273">*, /</span></span> |<span data-ttu-id="e148e-274">TimeInterval</span><span class="sxs-lookup"><span data-stu-id="e148e-274">timeinterval</span></span> |
| <span data-ttu-id="e148e-275">TimeInterval *operator* timeinterval</span><span class="sxs-lookup"><span data-stu-id="e148e-275">timeinterval *operator* timeinterval</span></span> |<span data-ttu-id="e148e-276">+, -</span><span class="sxs-lookup"><span data-stu-id="e148e-276">+, -</span></span> |<span data-ttu-id="e148e-277">TimeInterval</span><span class="sxs-lookup"><span data-stu-id="e148e-277">timeinterval</span></span> |
| <span data-ttu-id="e148e-278">TimeInterval *operator* tijdstempel</span><span class="sxs-lookup"><span data-stu-id="e148e-278">timeinterval *operator* timestamp</span></span> |+ |<span data-ttu-id="e148e-279">tijdstempel</span><span class="sxs-lookup"><span data-stu-id="e148e-279">timestamp</span></span> |
| <span data-ttu-id="e148e-280">tijdstempel *operator* timeinterval</span><span class="sxs-lookup"><span data-stu-id="e148e-280">timestamp *operator* timeinterval</span></span> |+ |<span data-ttu-id="e148e-281">tijdstempel</span><span class="sxs-lookup"><span data-stu-id="e148e-281">timestamp</span></span> |
| <span data-ttu-id="e148e-282">tijdstempel *operator* tijdstempel</span><span class="sxs-lookup"><span data-stu-id="e148e-282">timestamp *operator* timestamp</span></span> |- |<span data-ttu-id="e148e-283">TimeInterval</span><span class="sxs-lookup"><span data-stu-id="e148e-283">timeinterval</span></span> |
| <span data-ttu-id="e148e-284">*operator*dubbele</span><span class="sxs-lookup"><span data-stu-id="e148e-284">*operator*double</span></span> |<span data-ttu-id="e148e-285">-, !</span><span class="sxs-lookup"><span data-stu-id="e148e-285">-, !</span></span> |<span data-ttu-id="e148e-286">dubbele</span><span class="sxs-lookup"><span data-stu-id="e148e-286">double</span></span> |
| <span data-ttu-id="e148e-287">*operator*timeinterval</span><span class="sxs-lookup"><span data-stu-id="e148e-287">*operator*timeinterval</span></span> |- |<span data-ttu-id="e148e-288">TimeInterval</span><span class="sxs-lookup"><span data-stu-id="e148e-288">timeinterval</span></span> |
| <span data-ttu-id="e148e-289">dubbele *operator* dubbele</span><span class="sxs-lookup"><span data-stu-id="e148e-289">double *operator* double</span></span> |<span data-ttu-id="e148e-290"><, <=, ==, >=, >, !=</span><span class="sxs-lookup"><span data-stu-id="e148e-290"><, <=, ==, >=, >, !=</span></span> |<span data-ttu-id="e148e-291">dubbele</span><span class="sxs-lookup"><span data-stu-id="e148e-291">double</span></span> |
| <span data-ttu-id="e148e-292">tekenreeks *operator* tekenreeks</span><span class="sxs-lookup"><span data-stu-id="e148e-292">string *operator* string</span></span> |<span data-ttu-id="e148e-293"><, <=, ==, >=, >, !=</span><span class="sxs-lookup"><span data-stu-id="e148e-293"><, <=, ==, >=, >, !=</span></span> |<span data-ttu-id="e148e-294">dubbele</span><span class="sxs-lookup"><span data-stu-id="e148e-294">double</span></span> |
| <span data-ttu-id="e148e-295">tijdstempel *operator* tijdstempel</span><span class="sxs-lookup"><span data-stu-id="e148e-295">timestamp *operator* timestamp</span></span> |<span data-ttu-id="e148e-296"><, <=, ==, >=, >, !=</span><span class="sxs-lookup"><span data-stu-id="e148e-296"><, <=, ==, >=, >, !=</span></span> |<span data-ttu-id="e148e-297">dubbele</span><span class="sxs-lookup"><span data-stu-id="e148e-297">double</span></span> |
| <span data-ttu-id="e148e-298">TimeInterval *operator* timeinterval</span><span class="sxs-lookup"><span data-stu-id="e148e-298">timeinterval *operator* timeinterval</span></span> |<span data-ttu-id="e148e-299"><, <=, ==, >=, >, !=</span><span class="sxs-lookup"><span data-stu-id="e148e-299"><, <=, ==, >=, >, !=</span></span> |<span data-ttu-id="e148e-300">dubbele</span><span class="sxs-lookup"><span data-stu-id="e148e-300">double</span></span> |
| <span data-ttu-id="e148e-301">dubbele *operator* dubbele</span><span class="sxs-lookup"><span data-stu-id="e148e-301">double *operator* double</span></span> |<span data-ttu-id="e148e-302">&&, &#124;&#124;</span><span class="sxs-lookup"><span data-stu-id="e148e-302">&&, &#124;&#124;</span></span> |<span data-ttu-id="e148e-303">dubbele</span><span class="sxs-lookup"><span data-stu-id="e148e-303">double</span></span> |

<span data-ttu-id="e148e-304">Bij het testen van een Double-waarde met een ternaire operator (`double ? statement1 : statement2`), niet nul is **true**, en nul is **false**.</span><span class="sxs-lookup"><span data-stu-id="e148e-304">When testing a double with a ternary operator (`double ? statement1 : statement2`), nonzero is **true**, and zero is **false**.</span></span>

## <a name="functions"></a><span data-ttu-id="e148e-305">Functies</span><span class="sxs-lookup"><span data-stu-id="e148e-305">Functions</span></span>
<span data-ttu-id="e148e-306">Deze vooraf gedefinieerde **functies** zijn beschikbaar voor gebruik bij het definiëren van een formule voor automatisch schalen.</span><span class="sxs-lookup"><span data-stu-id="e148e-306">These predefined **functions** are available for you to use in defining an automatic scaling formula.</span></span>

| <span data-ttu-id="e148e-307">Functie</span><span class="sxs-lookup"><span data-stu-id="e148e-307">Function</span></span> | <span data-ttu-id="e148e-308">Retourtype</span><span class="sxs-lookup"><span data-stu-id="e148e-308">Return type</span></span> | <span data-ttu-id="e148e-309">Beschrijving</span><span class="sxs-lookup"><span data-stu-id="e148e-309">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="e148e-310">Avg(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="e148e-310">avg(doubleVecList)</span></span> |<span data-ttu-id="e148e-311">dubbele</span><span class="sxs-lookup"><span data-stu-id="e148e-311">double</span></span> |<span data-ttu-id="e148e-312">Retourneert de gemiddelde waarde voor alle waarden in de doubleVecList.</span><span class="sxs-lookup"><span data-stu-id="e148e-312">Returns the average value for all values in the doubleVecList.</span></span> |
| <span data-ttu-id="e148e-313">Len(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="e148e-313">len(doubleVecList)</span></span> |<span data-ttu-id="e148e-314">dubbele</span><span class="sxs-lookup"><span data-stu-id="e148e-314">double</span></span> |<span data-ttu-id="e148e-315">Retourneert de lengte van de vector die wordt gemaakt van de doubleVecList.</span><span class="sxs-lookup"><span data-stu-id="e148e-315">Returns the length of the vector that is created from the doubleVecList.</span></span> |
| <span data-ttu-id="e148e-316">LG(Double)</span><span class="sxs-lookup"><span data-stu-id="e148e-316">lg(double)</span></span> |<span data-ttu-id="e148e-317">dubbele</span><span class="sxs-lookup"><span data-stu-id="e148e-317">double</span></span> |<span data-ttu-id="e148e-318">Retourneert het logboek grondtal 2 van de dubbele waarde.</span><span class="sxs-lookup"><span data-stu-id="e148e-318">Returns the log base 2 of the double.</span></span> |
| <span data-ttu-id="e148e-319">LG(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="e148e-319">lg(doubleVecList)</span></span> |<span data-ttu-id="e148e-320">doubleVec</span><span class="sxs-lookup"><span data-stu-id="e148e-320">doubleVec</span></span> |<span data-ttu-id="e148e-321">Retourneert het component-wise logboek grondtal 2 van de doubleVecList.</span><span class="sxs-lookup"><span data-stu-id="e148e-321">Returns the component-wise log base 2 of the doubleVecList.</span></span> <span data-ttu-id="e148e-322">Een vec(double) moet expliciet voor de parameter worden doorgegeven.</span><span class="sxs-lookup"><span data-stu-id="e148e-322">A vec(double) must be explicitly passed for the parameter.</span></span> <span data-ttu-id="e148e-323">Anders wordt wordt de versie van de dubbele lg(double) verondersteld.</span><span class="sxs-lookup"><span data-stu-id="e148e-323">Otherwise, the double lg(double) version is assumed.</span></span> |
| <span data-ttu-id="e148e-324">ln(Double)</span><span class="sxs-lookup"><span data-stu-id="e148e-324">ln(double)</span></span> |<span data-ttu-id="e148e-325">dubbele</span><span class="sxs-lookup"><span data-stu-id="e148e-325">double</span></span> |<span data-ttu-id="e148e-326">Retourneert het natuurlijke logboek van de dubbele waarde.</span><span class="sxs-lookup"><span data-stu-id="e148e-326">Returns the natural log of the double.</span></span> |
| <span data-ttu-id="e148e-327">ln(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="e148e-327">ln(doubleVecList)</span></span> |<span data-ttu-id="e148e-328">doubleVec</span><span class="sxs-lookup"><span data-stu-id="e148e-328">doubleVec</span></span> |<span data-ttu-id="e148e-329">Retourneert het component-wise logboek grondtal 2 van de doubleVecList.</span><span class="sxs-lookup"><span data-stu-id="e148e-329">Returns the component-wise log base 2 of the doubleVecList.</span></span> <span data-ttu-id="e148e-330">Een vec(double) moet expliciet voor de parameter worden doorgegeven.</span><span class="sxs-lookup"><span data-stu-id="e148e-330">A vec(double) must be explicitly passed for the parameter.</span></span> <span data-ttu-id="e148e-331">Anders wordt wordt de versie van de dubbele lg(double) verondersteld.</span><span class="sxs-lookup"><span data-stu-id="e148e-331">Otherwise, the double lg(double) version is assumed.</span></span> |
| <span data-ttu-id="e148e-332">log(Double)</span><span class="sxs-lookup"><span data-stu-id="e148e-332">log(double)</span></span> |<span data-ttu-id="e148e-333">dubbele</span><span class="sxs-lookup"><span data-stu-id="e148e-333">double</span></span> |<span data-ttu-id="e148e-334">Retourneert het logboek grondtal 10 van de dubbele waarde.</span><span class="sxs-lookup"><span data-stu-id="e148e-334">Returns the log base 10 of the double.</span></span> |
| <span data-ttu-id="e148e-335">log(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="e148e-335">log(doubleVecList)</span></span> |<span data-ttu-id="e148e-336">doubleVec</span><span class="sxs-lookup"><span data-stu-id="e148e-336">doubleVec</span></span> |<span data-ttu-id="e148e-337">Retourneert het component-wise logboek grondtal 10 van de doubleVecList.</span><span class="sxs-lookup"><span data-stu-id="e148e-337">Returns the component-wise log base 10 of the doubleVecList.</span></span> <span data-ttu-id="e148e-338">Een vec(double) moet expliciet voor de één dubbele parameter worden doorgegeven.</span><span class="sxs-lookup"><span data-stu-id="e148e-338">A vec(double) must be explicitly passed for the single double parameter.</span></span> <span data-ttu-id="e148e-339">Anders wordt wordt de versie van de dubbele log(double) verondersteld.</span><span class="sxs-lookup"><span data-stu-id="e148e-339">Otherwise, the double log(double) version is assumed.</span></span> |
| <span data-ttu-id="e148e-340">Max(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="e148e-340">max(doubleVecList)</span></span> |<span data-ttu-id="e148e-341">dubbele</span><span class="sxs-lookup"><span data-stu-id="e148e-341">double</span></span> |<span data-ttu-id="e148e-342">Retourneert de maximumwaarde in de doubleVecList.</span><span class="sxs-lookup"><span data-stu-id="e148e-342">Returns the maximum value in the doubleVecList.</span></span> |
| <span data-ttu-id="e148e-343">min(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="e148e-343">min(doubleVecList)</span></span> |<span data-ttu-id="e148e-344">dubbele</span><span class="sxs-lookup"><span data-stu-id="e148e-344">double</span></span> |<span data-ttu-id="e148e-345">Retourneert de minimumwaarde in het doubleVecList.</span><span class="sxs-lookup"><span data-stu-id="e148e-345">Returns the minimum value in the doubleVecList.</span></span> |
| <span data-ttu-id="e148e-346">norm(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="e148e-346">norm(doubleVecList)</span></span> |<span data-ttu-id="e148e-347">dubbele</span><span class="sxs-lookup"><span data-stu-id="e148e-347">double</span></span> |<span data-ttu-id="e148e-348">Retourneert de twee-norm van de vector die wordt gemaakt van de doubleVecList.</span><span class="sxs-lookup"><span data-stu-id="e148e-348">Returns the two-norm of the vector that is created from the doubleVecList.</span></span> |
| <span data-ttu-id="e148e-349">percentiel (v doubleVec, dubbele p)</span><span class="sxs-lookup"><span data-stu-id="e148e-349">percentile(doubleVec v, double p)</span></span> |<span data-ttu-id="e148e-350">dubbele</span><span class="sxs-lookup"><span data-stu-id="e148e-350">double</span></span> |<span data-ttu-id="e148e-351">Retourneert het percentiel-element van de vector v.</span><span class="sxs-lookup"><span data-stu-id="e148e-351">Returns the percentile element of the vector v.</span></span> |
| <span data-ttu-id="e148e-352">ASELECT()</span><span class="sxs-lookup"><span data-stu-id="e148e-352">rand()</span></span> |<span data-ttu-id="e148e-353">dubbele</span><span class="sxs-lookup"><span data-stu-id="e148e-353">double</span></span> |<span data-ttu-id="e148e-354">Retourneert een willekeurige waarde tussen 0,0 en 1,0 liggen.</span><span class="sxs-lookup"><span data-stu-id="e148e-354">Returns a random value between 0.0 and 1.0.</span></span> |
| <span data-ttu-id="e148e-355">Range(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="e148e-355">range(doubleVecList)</span></span> |<span data-ttu-id="e148e-356">dubbele</span><span class="sxs-lookup"><span data-stu-id="e148e-356">double</span></span> |<span data-ttu-id="e148e-357">Retourneert het verschil tussen de min en max-waarden in de doubleVecList.</span><span class="sxs-lookup"><span data-stu-id="e148e-357">Returns the difference between the min and max values in the doubleVecList.</span></span> |
| <span data-ttu-id="e148e-358">Std(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="e148e-358">std(doubleVecList)</span></span> |<span data-ttu-id="e148e-359">dubbele</span><span class="sxs-lookup"><span data-stu-id="e148e-359">double</span></span> |<span data-ttu-id="e148e-360">Retourneert de standaardafwijking van voorbeeld van de waarden in de doubleVecList.</span><span class="sxs-lookup"><span data-stu-id="e148e-360">Returns the sample standard deviation of the values in the doubleVecList.</span></span> |
| <span data-ttu-id="e148e-361">Stop()</span><span class="sxs-lookup"><span data-stu-id="e148e-361">stop()</span></span> | |<span data-ttu-id="e148e-362">Evaluatie van de expressie voor automatisch schalen stopt.</span><span class="sxs-lookup"><span data-stu-id="e148e-362">Stops evaluation of the autoscaling expression.</span></span> |
| <span data-ttu-id="e148e-363">SUM(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="e148e-363">sum(doubleVecList)</span></span> |<span data-ttu-id="e148e-364">dubbele</span><span class="sxs-lookup"><span data-stu-id="e148e-364">double</span></span> |<span data-ttu-id="e148e-365">Retourneert de som van alle onderdelen van de doubleVecList.</span><span class="sxs-lookup"><span data-stu-id="e148e-365">Returns the sum of all the components of the doubleVecList.</span></span> |
| <span data-ttu-id="e148e-366">tijd (string, dateTime = "")</span><span class="sxs-lookup"><span data-stu-id="e148e-366">time(string dateTime="")</span></span> |<span data-ttu-id="e148e-367">tijdstempel</span><span class="sxs-lookup"><span data-stu-id="e148e-367">timestamp</span></span> |<span data-ttu-id="e148e-368">Retourneert de tijdstempel van de huidige tijd als er geen parameters worden doorgegeven of het tijdstempel van de datum/tijd-tekenreeks als deze wordt doorgegeven.</span><span class="sxs-lookup"><span data-stu-id="e148e-368">Returns the time stamp of the current time if no parameters are passed, or the time stamp of the dateTime string if it is passed.</span></span> <span data-ttu-id="e148e-369">Ondersteunde datum-/ tijdindelingen zijn W3C-DTF- en RFC 1123.</span><span class="sxs-lookup"><span data-stu-id="e148e-369">Supported dateTime formats are W3C-DTF and RFC 1123.</span></span> |
| <span data-ttu-id="e148e-370">waarde opnemen (v doubleVec, dubbele i)</span><span class="sxs-lookup"><span data-stu-id="e148e-370">val(doubleVec v, double i)</span></span> |<span data-ttu-id="e148e-371">dubbele</span><span class="sxs-lookup"><span data-stu-id="e148e-371">double</span></span> |<span data-ttu-id="e148e-372">Retourneert de waarde van het element dat is op locatie i in vector v, met een startIndex gelijk is aan nul.</span><span class="sxs-lookup"><span data-stu-id="e148e-372">Returns the value of the element that is at location i in vector v, with a starting index of zero.</span></span> |

<span data-ttu-id="e148e-373">Enkele van de functies die worden beschreven in de vorige tabel kan een lijst accepteren als een argument.</span><span class="sxs-lookup"><span data-stu-id="e148e-373">Some of the functions that are described in the previous table can accept a list as an argument.</span></span> <span data-ttu-id="e148e-374">De lijst met door komma's gescheiden is een combinatie van *dubbele* en *doubleVec*.</span><span class="sxs-lookup"><span data-stu-id="e148e-374">The comma-separated list is any combination of *double* and *doubleVec*.</span></span> <span data-ttu-id="e148e-375">Bijvoorbeeld:</span><span class="sxs-lookup"><span data-stu-id="e148e-375">For example:</span></span>

`doubleVecList := ( (double | doubleVec)+(, (double | doubleVec) )* )?`

<span data-ttu-id="e148e-376">De *doubleVecList* wordt omgezet in een enkel *doubleVec* voordat de evaluatie.</span><span class="sxs-lookup"><span data-stu-id="e148e-376">The *doubleVecList* value is converted to a single *doubleVec* before evaluation.</span></span> <span data-ttu-id="e148e-377">Bijvoorbeeld, als `v = [1,2,3]`, klikt u vervolgens het aanroepen van `avg(v)` is gelijk aan het aanroepen van `avg(1,2,3)`.</span><span class="sxs-lookup"><span data-stu-id="e148e-377">For example, if `v = [1,2,3]`, then calling `avg(v)` is equivalent to calling `avg(1,2,3)`.</span></span> <span data-ttu-id="e148e-378">Het aanroepen van `avg(v, 7)` is gelijk aan het aanroepen van `avg(1,2,3,7)`.</span><span class="sxs-lookup"><span data-stu-id="e148e-378">Calling `avg(v, 7)` is equivalent to calling `avg(1,2,3,7)`.</span></span>

## <span data-ttu-id="e148e-379"><a name="getsampledata"></a>Voorbeeldgegevens downloaden</span><span class="sxs-lookup"><span data-stu-id="e148e-379"><a name="getsampledata"></a>Obtain sample data</span></span>
<span data-ttu-id="e148e-380">Automatisch schalen formules fungeren op metrische gegevens (voorbeelden) die wordt geleverd door de Batch-service.</span><span class="sxs-lookup"><span data-stu-id="e148e-380">Autoscale formulas act on metrics data (samples) that is provided by the Batch service.</span></span> <span data-ttu-id="e148e-381">Een formule groeit of krimpt poolgrootte op basis van de waarden die wordt verkregen van de service.</span><span class="sxs-lookup"><span data-stu-id="e148e-381">A formula grows or shrinks pool size based on the values that it obtains from the service.</span></span> <span data-ttu-id="e148e-382">De service gedefinieerde variabelen die zijn beschreven zijn eerder objecten waarmee u verschillende methoden voor toegang tot gegevens die is gekoppeld aan dit object.</span><span class="sxs-lookup"><span data-stu-id="e148e-382">The service-defined variables that were described previously are objects that provide various methods to access data that is associated with that object.</span></span> <span data-ttu-id="e148e-383">De volgende expressie ziet u bijvoorbeeld een aanvraag voor het ophalen van de laatste vijf minuten van CPU-gebruik:</span><span class="sxs-lookup"><span data-stu-id="e148e-383">For example, the following expression shows a request to get the last five minutes of CPU usage:</span></span>

```
$CPUPercent.GetSample(TimeInterval_Minute * 5)
```

| <span data-ttu-id="e148e-384">Methode</span><span class="sxs-lookup"><span data-stu-id="e148e-384">Method</span></span> | <span data-ttu-id="e148e-385">Beschrijving</span><span class="sxs-lookup"><span data-stu-id="e148e-385">Description</span></span> |
| --- | --- |
| <span data-ttu-id="e148e-386">GetSample()</span><span class="sxs-lookup"><span data-stu-id="e148e-386">GetSample()</span></span> |<span data-ttu-id="e148e-387">De `GetSample()` methode retourneert een vector van voorbeelden van gegevens.</span><span class="sxs-lookup"><span data-stu-id="e148e-387">The `GetSample()` method returns a vector of data samples.</span></span><br/><br/><span data-ttu-id="e148e-388">Een voorbeeld is 30 seconden metrische gegevens.</span><span class="sxs-lookup"><span data-stu-id="e148e-388">A sample is 30 seconds worth of metrics data.</span></span> <span data-ttu-id="e148e-389">Voorbeelden zijn met andere woorden, elke 30 seconden opgehaald.</span><span class="sxs-lookup"><span data-stu-id="e148e-389">In other words, samples are obtained every 30 seconds.</span></span> <span data-ttu-id="e148e-390">Maar zoals hieronder aangegeven, er is een vertraging tussen wanneer een voorbeeld van een worden verzameld en wanneer deze beschikbaar is om een formule.</span><span class="sxs-lookup"><span data-stu-id="e148e-390">But as noted below, there is a delay between when a sample is collected and when it is available to a formula.</span></span> <span data-ttu-id="e148e-391">Als zodanig kunnen niet alle voorbeelden voor een bepaalde periode niet beschikbaar voor evaluatie van een formule.</span><span class="sxs-lookup"><span data-stu-id="e148e-391">As such, not all samples for a given time period may be available for evaluation by a formula.</span></span><ul><li>`doubleVec GetSample(double count)`<br/><span data-ttu-id="e148e-392">Hiermee geeft u het aantal steekproeven te halen van de meest recente voorbeelden die zijn verzameld.</span><span class="sxs-lookup"><span data-stu-id="e148e-392">Specifies the number of samples to obtain from the most recent samples that were collected.</span></span><br/><br/><span data-ttu-id="e148e-393">`GetSample(1)`retourneert het laatste voorbeeld beschikbaar.</span><span class="sxs-lookup"><span data-stu-id="e148e-393">`GetSample(1)` returns the last available sample.</span></span> <span data-ttu-id="e148e-394">Metrische gegevens zoals `$CPUPercent`, maar dit mag niet worden gebruikt omdat het niet mogelijk om te weten *wanneer* het voorbeeld is verzameld.</span><span class="sxs-lookup"><span data-stu-id="e148e-394">For metrics like `$CPUPercent`, however, this should not be used because it is impossible to know *when* the sample was collected.</span></span> <span data-ttu-id="e148e-395">Kan het zijn recente of vanwege problemen met het systeem, kan het veel ouder zijn.</span><span class="sxs-lookup"><span data-stu-id="e148e-395">It might be recent, or, because of system issues, it might be much older.</span></span> <span data-ttu-id="e148e-396">Het is beter in dergelijke gevallen te gebruiken een tijdsinterval zoals hieronder wordt weergegeven.</span><span class="sxs-lookup"><span data-stu-id="e148e-396">It is better in such cases to use a time interval as shown below.</span></span><li>`doubleVec GetSample((timestamp or timeinterval) startTime [, double samplePercent])`<br/><span data-ttu-id="e148e-397">Hiermee geeft u een tijdsbestek voor het verzamelen van voorbeeldgegevens.</span><span class="sxs-lookup"><span data-stu-id="e148e-397">Specifies a time frame for gathering sample data.</span></span> <span data-ttu-id="e148e-398">Eventueel specificeert het ook het percentage van de voorbeelden die beschikbaar zijn in het aangevraagde tijdsbestek.</span><span class="sxs-lookup"><span data-stu-id="e148e-398">Optionally, it also specifies the percentage of samples that must be available in the requested time frame.</span></span><br/><br/><span data-ttu-id="e148e-399">`$CPUPercent.GetSample(TimeInterval_Minute * 10)`Voorbeelden van 20 zou worden geretourneerd als alle voorbeelden voor de afgelopen 10 minuten in de geschiedenis CPUPercent aanwezig zijn.</span><span class="sxs-lookup"><span data-stu-id="e148e-399">`$CPUPercent.GetSample(TimeInterval_Minute * 10)` would return 20 samples if all samples for the last 10 minutes are present in the CPUPercent history.</span></span> <span data-ttu-id="e148e-400">Als de laatste minuut van de geschiedenis niet beschikbaar was, echter zou alleen 18 voorbeelden worden geretourneerd.</span><span class="sxs-lookup"><span data-stu-id="e148e-400">If the last minute of history was not available, however, only 18 samples would be returned.</span></span> <span data-ttu-id="e148e-401">In dit geval:</span><span class="sxs-lookup"><span data-stu-id="e148e-401">In this case:</span></span><br/><br/><span data-ttu-id="e148e-402">`$CPUPercent.GetSample(TimeInterval_Minute * 10, 95)`mislukken omdat slechts 90 procent van de voorbeelden beschikbaar zijn.</span><span class="sxs-lookup"><span data-stu-id="e148e-402">`$CPUPercent.GetSample(TimeInterval_Minute * 10, 95)` would fail because only 90 percent of the samples are available.</span></span><br/><br/><span data-ttu-id="e148e-403">`$CPUPercent.GetSample(TimeInterval_Minute * 10, 80)`zou slagen.</span><span class="sxs-lookup"><span data-stu-id="e148e-403">`$CPUPercent.GetSample(TimeInterval_Minute * 10, 80)` would succeed.</span></span><li>`doubleVec GetSample((timestamp or timeinterval) startTime, (timestamp or timeinterval) endTime [, double samplePercent])`<br/><span data-ttu-id="e148e-404">Hiermee geeft u een tijdsbestek voor het verzamelen van gegevens met een begintijd en eindtijd.</span><span class="sxs-lookup"><span data-stu-id="e148e-404">Specifies a time frame for gathering data, with both a start time and an end time.</span></span><br/><br/><span data-ttu-id="e148e-405">Zoals eerder vermeld, is er een vertraging tussen wanneer een voorbeeld van een worden verzameld en wanneer deze beschikbaar is om een formule.</span><span class="sxs-lookup"><span data-stu-id="e148e-405">As mentioned above, there is a delay between when a sample is collected and when it is available to a formula.</span></span> <span data-ttu-id="e148e-406">Houd rekening met deze vertraging wanneer u de `GetSample` methode.</span><span class="sxs-lookup"><span data-stu-id="e148e-406">Consider this delay when you use the `GetSample` method.</span></span> <span data-ttu-id="e148e-407">Zie `GetSamplePercent` hieronder.</span><span class="sxs-lookup"><span data-stu-id="e148e-407">See `GetSamplePercent` below.</span></span> |
| <span data-ttu-id="e148e-408">GetSamplePeriod()</span><span class="sxs-lookup"><span data-stu-id="e148e-408">GetSamplePeriod()</span></span> |<span data-ttu-id="e148e-409">Retourneert de periode van voorbeelden die zijn uitgevoerd in een historische voorbeeldgegevensset.</span><span class="sxs-lookup"><span data-stu-id="e148e-409">Returns the period of samples that were taken in a historical sample data set.</span></span> |
| <span data-ttu-id="e148e-410">Count()</span><span class="sxs-lookup"><span data-stu-id="e148e-410">Count()</span></span> |<span data-ttu-id="e148e-411">Retourneert het totale aantal steekproeven in de geschiedenis van de metrische gegevens.</span><span class="sxs-lookup"><span data-stu-id="e148e-411">Returns the total number of samples in the metric history.</span></span> |
| <span data-ttu-id="e148e-412">HistoryBeginTime()</span><span class="sxs-lookup"><span data-stu-id="e148e-412">HistoryBeginTime()</span></span> |<span data-ttu-id="e148e-413">Retourneert de tijdstempel van de oudste voorbeeld van de beschikbare gegevens voor de metriek.</span><span class="sxs-lookup"><span data-stu-id="e148e-413">Returns the time stamp of the oldest available data sample for the metric.</span></span> |
| <span data-ttu-id="e148e-414">GetSamplePercent()</span><span class="sxs-lookup"><span data-stu-id="e148e-414">GetSamplePercent()</span></span> |<span data-ttu-id="e148e-415">Retourneert het percentage van de voorbeelden die beschikbaar voor een bepaald tijdsinterval zijn.</span><span class="sxs-lookup"><span data-stu-id="e148e-415">Returns the percentage of samples that are available for a given time interval.</span></span> <span data-ttu-id="e148e-416">Bijvoorbeeld:</span><span class="sxs-lookup"><span data-stu-id="e148e-416">For example:</span></span><br/><br/>`doubleVec GetSamplePercent( (timestamp or timeinterval) startTime [, (timestamp or timeinterval) endTime] )`<br/><br/><span data-ttu-id="e148e-417">Omdat de `GetSample` methode mislukt als het percentage van de voorbeelden geretourneerd is kleiner dan de `samplePercent` opgegeven, kunt u de `GetSamplePercent` methode om eerst te controleren.</span><span class="sxs-lookup"><span data-stu-id="e148e-417">Because the `GetSample` method fails if the percentage of samples returned is less than the `samplePercent` specified, you can use the `GetSamplePercent` method to check first.</span></span> <span data-ttu-id="e148e-418">Vervolgens kunt u een alternatieve actie uitvoeren onvoldoende voorbeelden aanwezig zijn, zonder het stoppen van de automatische schaling evaluatie.</span><span class="sxs-lookup"><span data-stu-id="e148e-418">Then you can perform an alternate action if insufficient samples are present, without halting the automatic scaling evaluation.</span></span> |

### <a name="samples-sample-percentage-and-the-getsample-method"></a><span data-ttu-id="e148e-419">Voorbeelden, voorbeeld percentage, en de *GetSample()* methode</span><span class="sxs-lookup"><span data-stu-id="e148e-419">Samples, sample percentage, and the *GetSample()* method</span></span>
<span data-ttu-id="e148e-420">De hoofdbewerking van een formule voor automatisch schalen is het verkrijgen van metrische gegevens voor taken en resources en past u de poolgrootte op basis van die gegevens.</span><span class="sxs-lookup"><span data-stu-id="e148e-420">The core operation of an autoscale formula is to obtain task and resource metric data and then adjust pool size based on that data.</span></span> <span data-ttu-id="e148e-421">Hierdoor is het belangrijk dat u een duidelijk beeld hebben van de wisselwerking tussen de formules automatisch schalen met metrische gegevens (voorbeelden).</span><span class="sxs-lookup"><span data-stu-id="e148e-421">As such, it is important to have a clear understanding of how autoscale formulas interact with metrics data (samples).</span></span>

<span data-ttu-id="e148e-422">**Voorbeelden**</span><span class="sxs-lookup"><span data-stu-id="e148e-422">**Samples**</span></span>

<span data-ttu-id="e148e-423">De Batch-service wordt regelmatig duurt voorbeelden van taken en resources metrische gegevens en beschikbaar maken voor automatisch schalen formules.</span><span class="sxs-lookup"><span data-stu-id="e148e-423">The Batch service periodically takes samples of task and resource metrics and makes them available to your autoscale formulas.</span></span> <span data-ttu-id="e148e-424">Deze voorbeelden worden elke 30 seconden geregistreerd door de Batch-service.</span><span class="sxs-lookup"><span data-stu-id="e148e-424">These samples are recorded every 30 seconds by the Batch service.</span></span> <span data-ttu-id="e148e-425">Er is echter meestal een vertraging tussen wanneer deze voorbeelden zijn vastgelegd, en wanneer ze beschikbaar worden gesteld op (en kunnen worden gelezen door) automatisch schalen formules.</span><span class="sxs-lookup"><span data-stu-id="e148e-425">However, there is typically a delay between when those samples were recorded and when they are made available to (and can be read by) your autoscale formulas.</span></span> <span data-ttu-id="e148e-426">Bovendien, als gevolg van verschillende factoren zoals netwerk- of andere problemen infrastructuur steekproeven mogelijk niet geregistreerd voor een bepaalde interval.</span><span class="sxs-lookup"><span data-stu-id="e148e-426">Additionally, due to various factors such as network or other infrastructure issues, samples may not be recorded for a particular interval.</span></span>

<span data-ttu-id="e148e-427">**Percentage van de steekproef**</span><span class="sxs-lookup"><span data-stu-id="e148e-427">**Sample percentage**</span></span>

<span data-ttu-id="e148e-428">Wanneer `samplePercent` wordt doorgegeven aan de `GetSample()` methode of de `GetSamplePercent()` methode wordt aangeroepen, _procent_ verwijst naar een vergelijking tussen het totale aantal voorbeelden die zijn vastgelegd door de Batch-service en het aantal steekproeven die beschikbaar voor de formule voor automatisch schalen zijn.</span><span class="sxs-lookup"><span data-stu-id="e148e-428">When `samplePercent` is passed to the `GetSample()` method or the `GetSamplePercent()` method is called, _percent_ refers to a comparison between the total possible number of samples that are recorded by the Batch service and the number of samples that are available to your autoscale formula.</span></span>

<span data-ttu-id="e148e-429">We bekijken een timespan 10 minuten als voorbeeld.</span><span class="sxs-lookup"><span data-stu-id="e148e-429">Let's look at a 10-minute timespan as an example.</span></span> <span data-ttu-id="e148e-430">Omdat voorbeelden worden elke 30 seconden binnen een timespan 10 minuten vastgelegd, zou het maximum aantal voorbeelden die zijn vastgelegd door de Batch 20 steekproeven (2 per minuut) zijn.</span><span class="sxs-lookup"><span data-stu-id="e148e-430">Because samples are recorded every 30 seconds within a 10-minute timespan, the maximum total number of samples that are recorded by Batch would be 20 samples (2 per minute).</span></span> <span data-ttu-id="e148e-431">Echter, vanwege de intrinsieke latentie van het mechanisme voor rapportage en andere problemen in Azure, kunnen er alleen 15 voorbeelden die beschikbaar voor de formule voor automatisch schalen om te lezen zijn.</span><span class="sxs-lookup"><span data-stu-id="e148e-431">However, due to the inherent latency of the reporting mechanism and other issues within Azure, there may be only 15 samples that are available to your autoscale formula for reading.</span></span> <span data-ttu-id="e148e-432">Dus bijvoorbeeld voor deze periode 10 minuten kunnen alleen 75% van het totale aantal steekproeven vastgelegd mogelijk beschikbaar aan uw formule.</span><span class="sxs-lookup"><span data-stu-id="e148e-432">So, for example, for that 10-minute period, only 75% of the total number of samples recorded may be available to your formula.</span></span>

<span data-ttu-id="e148e-433">**GetSample() en voorbeeld-bereiken**</span><span class="sxs-lookup"><span data-stu-id="e148e-433">**GetSample() and sample ranges**</span></span>

<span data-ttu-id="e148e-434">Automatisch schalen formules gaat groeit en uw pools verkleinen &mdash; knooppunten toe te voegen of te verwijderen van knooppunten.</span><span class="sxs-lookup"><span data-stu-id="e148e-434">Your autoscale formulas are going to be growing and shrinking your pools &mdash; adding nodes or removing nodes.</span></span> <span data-ttu-id="e148e-435">Omdat knooppunten geld kosten, die u wilt zorgen dat uw formules een intelligente methode van de analyse op basis van voldoende gegevens gebruikt.</span><span class="sxs-lookup"><span data-stu-id="e148e-435">Because nodes cost you money, you want to ensure that your formulas use an intelligent method of analysis that is based on sufficient data.</span></span> <span data-ttu-id="e148e-436">Daarom raden we u een trending-type-analyse gebruiken in uw formules.</span><span class="sxs-lookup"><span data-stu-id="e148e-436">Therefore, we recommend that you use a trending-type analysis in your formulas.</span></span> <span data-ttu-id="e148e-437">Dit type groeit en uw pools op basis van een bereik van verzamelde steekproeven verkleind.</span><span class="sxs-lookup"><span data-stu-id="e148e-437">This type grows and shrinks your pools based on a range of collected samples.</span></span>

<span data-ttu-id="e148e-438">Gebruiken om dit te doen `GetSample(interval look-back start, interval look-back end)` te retourneren van een vector van voorbeelden:</span><span class="sxs-lookup"><span data-stu-id="e148e-438">To do so, use `GetSample(interval look-back start, interval look-back end)` to return a vector of samples:</span></span>

```
$runningTasksSample = $RunningTasks.GetSample(1 * TimeInterval_Minute, 6 * TimeInterval_Minute);
```

<span data-ttu-id="e148e-439">Wanneer de bovenstaande regel wordt geëvalueerd door de Batch, wordt een reeks voorbeelden als vector van waarden.</span><span class="sxs-lookup"><span data-stu-id="e148e-439">When the above line is evaluated by Batch, it returns a range of samples as a vector of values.</span></span> <span data-ttu-id="e148e-440">Bijvoorbeeld:</span><span class="sxs-lookup"><span data-stu-id="e148e-440">For example:</span></span>

```
$runningTasksSample=[1,1,1,1,1,1,1,1,1,1];
```

<span data-ttu-id="e148e-441">Zodra u de vector van voorbeelden hebt verzameld, vervolgens kunt u functies zoals `min()`, `max()`, en `avg()` worden afgeleid van zinvolle waarden van het verzamelde bereik.</span><span class="sxs-lookup"><span data-stu-id="e148e-441">Once you've collected the vector of samples, you can then use functions like `min()`, `max()`, and `avg()` to derive meaningful values from the collected range.</span></span>

<span data-ttu-id="e148e-442">Voor extra beveiliging kunt u een formule-evaluatie mislukken als er minder dan een bepaald percentage van het voorbeeld is beschikbaar voor een bepaalde periode afdwingen.</span><span class="sxs-lookup"><span data-stu-id="e148e-442">For additional security, you can force a formula evaluation to fail if less than a certain sample percentage is available for a particular time period.</span></span> <span data-ttu-id="e148e-443">Wanneer u een formule-evaluatie mislukken afdwingt, vertelt u Batch niet meer verdere evaluatie van de formule als het opgegeven percentage van de voorbeelden niet beschikbaar is.</span><span class="sxs-lookup"><span data-stu-id="e148e-443">When you force a formula evaluation to fail, you instruct Batch to cease further evaluation of the formula if the specified percentage of samples is not available.</span></span> <span data-ttu-id="e148e-444">In dit geval is niet gewijzigd in de poolgrootte.</span><span class="sxs-lookup"><span data-stu-id="e148e-444">In this case, no change is made to the pool size.</span></span> <span data-ttu-id="e148e-445">Geef een vereiste percentage van steekproeven voor de evaluatie te kunnen uitvoeren door dit opgeven als de derde parameter `GetSample()`.</span><span class="sxs-lookup"><span data-stu-id="e148e-445">To specify a required percentage of samples for the evaluation to succeed, specify it as the third parameter to `GetSample()`.</span></span> <span data-ttu-id="e148e-446">Hier wordt een vereiste van 75 procent van de voorbeelden is opgegeven:</span><span class="sxs-lookup"><span data-stu-id="e148e-446">Here, a requirement of 75 percent of samples is specified:</span></span>

```
$runningTasksSample = $RunningTasks.GetSample(60 * TimeInterval_Second, 120 * TimeInterval_Second, 75);
```

<span data-ttu-id="e148e-447">Omdat er een vertraging optreden in de steekproef beschikbaarheid, is het belangrijk dat u altijd een tijdsperiode opgeven met een uiterlijk-back-begintijd die ouder is dan een minuut.</span><span class="sxs-lookup"><span data-stu-id="e148e-447">Because there may be a delay in sample availability, it is important to always specify a time range with a look-back start time that is older than one minute.</span></span> <span data-ttu-id="e148e-448">Het duurt ongeveer een minuut voor voorbeelden worden doorgegeven via het systeem, dus-voorbeelden in het bereik `(0 * TimeInterval_Second, 60 * TimeInterval_Second)` mogelijk niet beschikbaar.</span><span class="sxs-lookup"><span data-stu-id="e148e-448">It takes approximately one minute for samples to propagate through the system, so samples in the range `(0 * TimeInterval_Second, 60 * TimeInterval_Second)` may not be available.</span></span> <span data-ttu-id="e148e-449">Nogmaals, kunt u de parameter percentage van `GetSample()` om af te dwingen een bepaalde voorbeeld percentage vereiste.</span><span class="sxs-lookup"><span data-stu-id="e148e-449">Again, you can use the percentage parameter of `GetSample()` to force a particular sample percentage requirement.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="e148e-450">We **aangeraden** die u hebt **voorkomen relying *alleen* op `GetSample(1)` in formules automatisch schalen**.</span><span class="sxs-lookup"><span data-stu-id="e148e-450">We **strongly recommend** that you **avoid relying *only* on `GetSample(1)` in your autoscale formulas**.</span></span> <span data-ttu-id="e148e-451">Dit komt doordat `GetSample(1)` in wezen aangegeven dat u moet de Batch-service "Geef me de laatste steekproef u hebt, ongeacht hoe lang geleden u opgehaald."</span><span class="sxs-lookup"><span data-stu-id="e148e-451">This is because `GetSample(1)` essentially says to the Batch service, "Give me the last sample you have, no matter how long ago you retrieved it."</span></span> <span data-ttu-id="e148e-452">Omdat dit slechts een enkele voorbeeld is en kan een oudere voorbeeld, mogelijk vertegenwoordiger van de grotere afbeelding van recente taak of resource staat niet meer.</span><span class="sxs-lookup"><span data-stu-id="e148e-452">Since it is only a single sample, and it may be an older sample, it may not be representative of the larger picture of recent task or resource state.</span></span> <span data-ttu-id="e148e-453">Als u gebruik maakt van `GetSample(1)`, zorg ervoor dat het deel uitmaakt van een grotere instructie en niet de enige gegevenspunt dat afhankelijk is van de formule.</span><span class="sxs-lookup"><span data-stu-id="e148e-453">If you do use `GetSample(1)`, make sure that it's part of a larger statement and not the only data point that your formula relies on.</span></span>
>
>

## <a name="metrics"></a><span data-ttu-id="e148e-454">Metrische gegevens</span><span class="sxs-lookup"><span data-stu-id="e148e-454">Metrics</span></span>
<span data-ttu-id="e148e-455">U kunt zowel de bron- als de taak metrische gegevens gebruiken wanneer u bij het definiëren van een formule.</span><span class="sxs-lookup"><span data-stu-id="e148e-455">You can use both resource and task metrics when you're defining a formula.</span></span> <span data-ttu-id="e148e-456">U aanpassen het doelaantal toegewezen knooppunten in de groep op basis van de metrische gegevens die u ophalen en evalueren.</span><span class="sxs-lookup"><span data-stu-id="e148e-456">You adjust the target number of dedicated nodes in the pool based on the metrics data that you obtain and evaluate.</span></span> <span data-ttu-id="e148e-457">Zie de [variabelen](#variables) sectie hierboven voor meer informatie over elke metriek.</span><span class="sxs-lookup"><span data-stu-id="e148e-457">See the [Variables](#variables) section above for more information on each metric.</span></span>

<table>
  <tr>
    <th><span data-ttu-id="e148e-458">Gegevens</span><span class="sxs-lookup"><span data-stu-id="e148e-458">Metric</span></span></th>
    <th><span data-ttu-id="e148e-459">Beschrijving</span><span class="sxs-lookup"><span data-stu-id="e148e-459">Description</span></span></th>
  </tr>
  <tr>
    <td><span data-ttu-id="e148e-460"><b>Resource</b></span><span class="sxs-lookup"><span data-stu-id="e148e-460"><b>Resource</b></span></span></td>
    <td><p><span data-ttu-id="e148e-461">Metrische gegevens voor resources zijn gebaseerd op de CPU, de bandbreedte, het geheugengebruik van rekenknooppunten en het aantal knooppunten.</span><span class="sxs-lookup"><span data-stu-id="e148e-461">Resource metrics are based on the CPU, the bandwidth, the memory usage of compute nodes, and the number of nodes.</span></span></p>
        <p> <span data-ttu-id="e148e-462">Deze service gedefinieerde variabelen zijn handig voor het uitvoeren van aanpassingen op basis van het aantal knooppunten:</span><span class="sxs-lookup"><span data-stu-id="e148e-462">These service-defined variables are useful for making adjustments based on node count:</span></span></p>
    <p><ul>
            <li><span data-ttu-id="e148e-463">$TargetDedicatedNodes</span><span class="sxs-lookup"><span data-stu-id="e148e-463">$TargetDedicatedNodes</span></span></li>
            <li><span data-ttu-id="e148e-464">$TargetLowPriorityNodes</span><span class="sxs-lookup"><span data-stu-id="e148e-464">$TargetLowPriorityNodes</span></span></li>
            <li><span data-ttu-id="e148e-465">$CurrentDedicatedNodes</span><span class="sxs-lookup"><span data-stu-id="e148e-465">$CurrentDedicatedNodes</span></span></li>
            <li><span data-ttu-id="e148e-466">$CurrentLowPriorityNodes</span><span class="sxs-lookup"><span data-stu-id="e148e-466">$CurrentLowPriorityNodes</span></span></li>
            <li><span data-ttu-id="e148e-467">$preemptedNodeCount</span><span class="sxs-lookup"><span data-stu-id="e148e-467">$preemptedNodeCount</span></span></li>
            <li><span data-ttu-id="e148e-468">$SampleNodeCount</span><span class="sxs-lookup"><span data-stu-id="e148e-468">$SampleNodeCount</span></span></li>
    </ul></p>
    <p><span data-ttu-id="e148e-469">Deze service gedefinieerde variabelen zijn nuttig voor het uitvoeren van aanpassingen op basis van knooppunt Resourcegebruik:</span><span class="sxs-lookup"><span data-stu-id="e148e-469">These service-defined variables are useful for making adjustments based on node resource usage:</span></span></p>
    <p><ul>
      <li><span data-ttu-id="e148e-470">$CPUPercent</span><span class="sxs-lookup"><span data-stu-id="e148e-470">$CPUPercent</span></span></li>
      <li><span data-ttu-id="e148e-471">$WallClockSeconds</span><span class="sxs-lookup"><span data-stu-id="e148e-471">$WallClockSeconds</span></span></li>
      <li><span data-ttu-id="e148e-472">$MemoryBytes</span><span class="sxs-lookup"><span data-stu-id="e148e-472">$MemoryBytes</span></span></li>
      <li><span data-ttu-id="e148e-473">$DiskBytes</span><span class="sxs-lookup"><span data-stu-id="e148e-473">$DiskBytes</span></span></li>
      <li><span data-ttu-id="e148e-474">$DiskReadBytes</span><span class="sxs-lookup"><span data-stu-id="e148e-474">$DiskReadBytes</span></span></li>
      <li><span data-ttu-id="e148e-475">$DiskWriteBytes</span><span class="sxs-lookup"><span data-stu-id="e148e-475">$DiskWriteBytes</span></span></li>
      <li><span data-ttu-id="e148e-476">$DiskReadOps</span><span class="sxs-lookup"><span data-stu-id="e148e-476">$DiskReadOps</span></span></li>
      <li><span data-ttu-id="e148e-477">$DiskWriteOps</span><span class="sxs-lookup"><span data-stu-id="e148e-477">$DiskWriteOps</span></span></li>
      <li><span data-ttu-id="e148e-478">$NetworkInBytes</span><span class="sxs-lookup"><span data-stu-id="e148e-478">$NetworkInBytes</span></span></li>
      <li><span data-ttu-id="e148e-479">$NetworkOutBytes</span><span class="sxs-lookup"><span data-stu-id="e148e-479">$NetworkOutBytes</span></span></li></ul></p>
  </tr>
  <tr>
    <td><span data-ttu-id="e148e-480"><b>Taak</b></span><span class="sxs-lookup"><span data-stu-id="e148e-480"><b>Task</b></span></span></td>
    <td><p><span data-ttu-id="e148e-481">Taak metrische gegevens op basis van de status van taken, zoals actief, in behandeling, en voltooid.</span><span class="sxs-lookup"><span data-stu-id="e148e-481">Task metrics are based on the status of tasks, such as Active, Pending, and Completed.</span></span> <span data-ttu-id="e148e-482">De volgende service gedefinieerde variabelen zijn handig voor groepsgrootte aanpassingen op basis van de taak metrische gegevens:</span><span class="sxs-lookup"><span data-stu-id="e148e-482">The following service-defined variables are useful for making pool-size adjustments based on task metrics:</span></span></p>
    <p><ul>
      <li><span data-ttu-id="e148e-483">$ActiveTasks</span><span class="sxs-lookup"><span data-stu-id="e148e-483">$ActiveTasks</span></span></li>
      <li><span data-ttu-id="e148e-484">$RunningTasks</span><span class="sxs-lookup"><span data-stu-id="e148e-484">$RunningTasks</span></span></li>
      <li><span data-ttu-id="e148e-485">$PendingTasks</span><span class="sxs-lookup"><span data-stu-id="e148e-485">$PendingTasks</span></span></li>
      <li><span data-ttu-id="e148e-486">$SucceededTasks</span><span class="sxs-lookup"><span data-stu-id="e148e-486">$SucceededTasks</span></span></li>
            <li><span data-ttu-id="e148e-487">$FailedTasks</span><span class="sxs-lookup"><span data-stu-id="e148e-487">$FailedTasks</span></span></li></ul></p>
        </td>
  </tr>
</table>

## <a name="write-an-autoscale-formula"></a><span data-ttu-id="e148e-488">Schrijven van een formule voor automatisch schalen</span><span class="sxs-lookup"><span data-stu-id="e148e-488">Write an autoscale formula</span></span>
<span data-ttu-id="e148e-489">U een formule voor automatisch schalen verder door de instructies die gebruikmaken van de bovenstaande onderdelen vormen en vervolgens deze instructies naar een volledige formule combineren.</span><span class="sxs-lookup"><span data-stu-id="e148e-489">You build an autoscale formula by forming statements that use the above components, then combine those statements into a complete formula.</span></span> <span data-ttu-id="e148e-490">In deze sectie maken we een formule voor het automatisch schalen van voorbeeld die een echte vergroten/verkleinen beslissingen kunt uitvoeren.</span><span class="sxs-lookup"><span data-stu-id="e148e-490">In this section, we create an example autoscale formula that can perform some real-world scaling decisions.</span></span>

<span data-ttu-id="e148e-491">Eerst gaan we de vereisten voor onze nieuwe formule voor automatisch schalen worden gedefinieerd.</span><span class="sxs-lookup"><span data-stu-id="e148e-491">First, let's define the requirements for our new autoscale formula.</span></span> <span data-ttu-id="e148e-492">De formule moet het volgende doen:</span><span class="sxs-lookup"><span data-stu-id="e148e-492">The formula should:</span></span>

1. <span data-ttu-id="e148e-493">Vergroot het doelaantal knooppunten in een pool speciale berekenings als het CPU-gebruik is hoog.</span><span class="sxs-lookup"><span data-stu-id="e148e-493">Increase the target number of dedicated compute nodes in a pool if CPU usage is high.</span></span>
2. <span data-ttu-id="e148e-494">Het doelaantal knooppunten in een pool speciale berekenings afnemen als CPU-gebruik laag is.</span><span class="sxs-lookup"><span data-stu-id="e148e-494">Decrease the target number of dedicated compute nodes in a pool when CPU usage is low.</span></span>
3. <span data-ttu-id="e148e-495">Altijd het maximum aantal toegewezen knooppunten tot 400 beperken.</span><span class="sxs-lookup"><span data-stu-id="e148e-495">Always restrict the maximum number of dedicated nodes to 400.</span></span>

<span data-ttu-id="e148e-496">Voor een verhoging van het aantal knooppunten tijdens hoog CPU-gebruik, definieert u de instructie die de gebruiker gedefinieerde variabele vult (`$totalDedicatedNodes`) met een waarde die is 110 procent van het huidige doelaantal knooppunten toegewezen, maar alleen als het minimale gemiddelde CPU-gebruik tijdens de afgelopen tien minuten is hoger dan 70 procent.</span><span class="sxs-lookup"><span data-stu-id="e148e-496">To increase the number of nodes during high CPU usage, define the statement that populates a user-defined variable (`$totalDedicatedNodes`) with a value that is 110 percent of the current target number of dedicated nodes, but only if the minimum average CPU usage during the last 10 minutes was above 70 percent.</span></span> <span data-ttu-id="e148e-497">Gebruik anders de waarde voor het huidige aantal toegewezen knooppunten.</span><span class="sxs-lookup"><span data-stu-id="e148e-497">Otherwise, use the value for the current number of dedicated nodes.</span></span>

```
$totalDedicatedNodes =
    (min($CPUPercent.GetSample(TimeInterval_Minute * 10)) > 0.7) ?
    ($CurrentDedicatedNodes * 1.1) : $CurrentDedicatedNodes;
```

<span data-ttu-id="e148e-498">Naar *verkleinen* het aantal toegewezen knooppunten tijdens het lage CPU-gebruik de volgende instructie in onze formule ingesteld dezelfde `$totalDedicatedNodes` variabele à 90 procent van het huidige doelaantal toegewezen knooppunten als het gemiddelde CPU-gebruik in de afgelopen 60 minuten onder 20 procent is.</span><span class="sxs-lookup"><span data-stu-id="e148e-498">To *decrease* the number of dedicated nodes during low CPU usage, the next statement in our formula sets the same `$totalDedicatedNodes` variable to 90 percent of the current target number of dedicated nodes if the average CPU usage in the past 60 minutes was under 20 percent.</span></span> <span data-ttu-id="e148e-499">Anders gebruikt u de huidige waarde van `$totalDedicatedNodes` die we in de bovenstaande instructie ingevuld.</span><span class="sxs-lookup"><span data-stu-id="e148e-499">Otherwise, use the current value of `$totalDedicatedNodes` that we populated in the statement above.</span></span>

```
$totalDedicatedNodes =
    (avg($CPUPercent.GetSample(TimeInterval_Minute * 60)) < 0.2) ?
    ($CurrentDedicatedNodes * 0.9) : $totalDedicatedNodes;
```

<span data-ttu-id="e148e-500">Nu het doelaantal knooppunten tot een maximum van 400 speciale berekenings beperken:</span><span class="sxs-lookup"><span data-stu-id="e148e-500">Now limit the target number of dedicated compute nodes to a maximum of 400:</span></span>

```
$TargetDedicatedNodes = min(400, $totalDedicatedNodes)
```

<span data-ttu-id="e148e-501">Dit is de volledige formule:</span><span class="sxs-lookup"><span data-stu-id="e148e-501">Here's the complete formula:</span></span>

```
$totalDedicatedNodes =
    (min($CPUPercent.GetSample(TimeInterval_Minute * 10)) > 0.7) ?
    ($CurrentDedicatedNodes * 1.1) : $CurrentDedicatedNodes;
$totalDedicatedNodes =
    (avg($CPUPercent.GetSample(TimeInterval_Minute * 60)) < 0.2) ?
    ($CurrentDedicatedNodes * 0.9) : $totalDedicatedNodes;
$TargetDedicatedNodes = min(400, $totalDedicatedNodes)
```

## <a name="create-an-autoscale-enabled-pool-with-net"></a><span data-ttu-id="e148e-502">Een pool automatisch schalen ingeschakeld maken met .NET</span><span class="sxs-lookup"><span data-stu-id="e148e-502">Create an autoscale-enabled pool with .NET</span></span>

<span data-ttu-id="e148e-503">Maakt een groep met automatisch schalen die zijn ingeschakeld in .NET, de volgende stappen uit:</span><span class="sxs-lookup"><span data-stu-id="e148e-503">To create a pool with autoscaling enabled in .NET, follow these steps:</span></span>

1. <span data-ttu-id="e148e-504">Maken van de groep met [BatchClient.PoolOperations.CreatePool](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.pooloperations.createpool).</span><span class="sxs-lookup"><span data-stu-id="e148e-504">Create the pool with [BatchClient.PoolOperations.CreatePool](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.pooloperations.createpool).</span></span>
2. <span data-ttu-id="e148e-505">Stel de [CloudPool.AutoScaleEnabled](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscaleenabled) eigenschap `true`.</span><span class="sxs-lookup"><span data-stu-id="e148e-505">Set the [CloudPool.AutoScaleEnabled](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscaleenabled) property to `true`.</span></span>
3. <span data-ttu-id="e148e-506">Stel de [CloudPool.AutoScaleFormula](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscaleformula) eigenschap met de formule voor automatisch schalen.</span><span class="sxs-lookup"><span data-stu-id="e148e-506">Set the [CloudPool.AutoScaleFormula](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscaleformula) property with your autoscale formula.</span></span>
4. <span data-ttu-id="e148e-507">(Optioneel) Stel de [CloudPool.AutoScaleEvaluationInterval](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscaleevaluationinterval) eigenschap (de standaardwaarde is 15 minuten).</span><span class="sxs-lookup"><span data-stu-id="e148e-507">(Optional) Set the [CloudPool.AutoScaleEvaluationInterval](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscaleevaluationinterval) property (default is 15 minutes).</span></span>
5. <span data-ttu-id="e148e-508">De groep met doorvoeren [CloudPool.Commit](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.commit) of [CommitAsync](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.commitasync).</span><span class="sxs-lookup"><span data-stu-id="e148e-508">Commit the pool with [CloudPool.Commit](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.commit) or [CommitAsync](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.commitasync).</span></span>

<span data-ttu-id="e148e-509">Het volgende codefragment maakt een groep voor automatisch schalen die zijn ingeschakeld in .NET.</span><span class="sxs-lookup"><span data-stu-id="e148e-509">The following code snippet creates an autoscale-enabled pool in .NET.</span></span> <span data-ttu-id="e148e-510">De formule voor automatisch schalen van de pool wordt het doelaantal toegewezen knooppunten tot en met 5 op maandag 1 op om de dag van de week.</span><span class="sxs-lookup"><span data-stu-id="e148e-510">The pool's autoscale formula sets the target number of dedicated nodes to 5 on Mondays, and 1 on every other day of the week.</span></span> <span data-ttu-id="e148e-511">De [automatisch vergroten/verkleinen interval](#automatic-scaling-interval) is ingesteld op 30 minuten.</span><span class="sxs-lookup"><span data-stu-id="e148e-511">The [automatic scaling interval](#automatic-scaling-interval) is set to 30 minutes.</span></span> <span data-ttu-id="e148e-512">In dit document en de andere C# codefragmenten in dit artikel `myBatchClient` is een goed geïnitialiseerd exemplaar van de [BatchClient] [ net_batchclient] klasse.</span><span class="sxs-lookup"><span data-stu-id="e148e-512">In this and the other C# snippets in this article, `myBatchClient` is a properly initialized instance of the [BatchClient][net_batchclient] class.</span></span>

```csharp
CloudPool pool = myBatchClient.PoolOperations.CreatePool(
                    poolId: "mypool",
                    virtualMachineSize: "small", // single-core, 1.75 GB memory, 225 GB disk
                    cloudServiceConfiguration: new CloudServiceConfiguration(osFamily: "5"));    
pool.AutoScaleEnabled = true;
pool.AutoScaleFormula = "$TargetDedicatedNodes = (time().weekday == 1 ? 5:1);";
pool.AutoScaleEvaluationInterval = TimeSpan.FromMinutes(30);
await pool.CommitAsync();
```

> [!IMPORTANT]
> <span data-ttu-id="e148e-513">Wanneer u een groep automatisch schalen ingeschakeld maakt, geef de _targetDedicatedComputeNodes_ parameter of de _targetLowPriorityComputeNodes_ parameter bij het aanroepen van **CreatePool**.</span><span class="sxs-lookup"><span data-stu-id="e148e-513">When you create an autoscale-enabled pool, do not specify the _targetDedicatedComputeNodes_ parameter or the _targetLowPriorityComputeNodes_ parameter on the call to **CreatePool**.</span></span> <span data-ttu-id="e148e-514">Geef in plaats daarvan de **AutoScaleEnabled** en **AutoScaleFormula** eigenschappen in de groep.</span><span class="sxs-lookup"><span data-stu-id="e148e-514">Instead, specify the **AutoScaleEnabled** and **AutoScaleFormula** properties on the pool.</span></span> <span data-ttu-id="e148e-515">De waarden voor deze eigenschappen bepalen het doelaantal van elk type knooppunt.</span><span class="sxs-lookup"><span data-stu-id="e148e-515">The values for these properties determine the target number of each type of node.</span></span> <span data-ttu-id="e148e-516">Ook aan handmatig een automatisch schalen ingeschakeld formaat toepassingen (bijvoorbeeld met [BatchClient.PoolOperations.ResizePoolAsync][net_poolops_resizepoolasync]), eerste **uitschakelen** automatisch schalen aan de groep, klikt u vervolgens het formaat.</span><span class="sxs-lookup"><span data-stu-id="e148e-516">Also, to manually resize an autoscale-enabled pool (for example, with [BatchClient.PoolOperations.ResizePoolAsync][net_poolops_resizepoolasync]), first **disable** automatic scaling on the pool, then resize it.</span></span>
>
>

<span data-ttu-id="e148e-517">Naast Batch .NET, kunt u een van de andere [Batch-SDK's](batch-apis-tools.md#azure-accounts-for-batch-development), [Batch REST](https://docs.microsoft.com/rest/api/batchservice/), [Batch PowerShell-cmdlets](batch-powershell-cmdlets-get-started.md), en de [Batch CLI](batch-cli-get-started.md) automatisch schalen configureren.</span><span class="sxs-lookup"><span data-stu-id="e148e-517">In addition to Batch .NET, you can use any of the other [Batch SDKs](batch-apis-tools.md#azure-accounts-for-batch-development), [Batch REST](https://docs.microsoft.com/rest/api/batchservice/), [Batch PowerShell cmdlets](batch-powershell-cmdlets-get-started.md), and the [Batch CLI](batch-cli-get-started.md) to configure autoscaling.</span></span>


### <a name="automatic-scaling-interval"></a><span data-ttu-id="e148e-518">Interval voor automatisch schalen</span><span class="sxs-lookup"><span data-stu-id="e148e-518">Automatic scaling interval</span></span>
<span data-ttu-id="e148e-519">Standaard aangepast de Batch-service een groepsgrootte volgens de formule voor automatisch schalen om de 15 minuten.</span><span class="sxs-lookup"><span data-stu-id="e148e-519">By default, the Batch service adjusts a pool's size according to its autoscale formula every 15 minutes.</span></span> <span data-ttu-id="e148e-520">Dit interval kan worden geconfigureerd met behulp van de eigenschappen van de volgende toepassingen:</span><span class="sxs-lookup"><span data-stu-id="e148e-520">This interval is configurable by using the following pool properties:</span></span>

* <span data-ttu-id="e148e-521">[CloudPool.AutoScaleEvaluationInterval] [ net_cloudpool_autoscaleevalinterval] (Batch .NET)</span><span class="sxs-lookup"><span data-stu-id="e148e-521">[CloudPool.AutoScaleEvaluationInterval][net_cloudpool_autoscaleevalinterval] (Batch .NET)</span></span>
* <span data-ttu-id="e148e-522">[autoScaleEvaluationInterval] [ rest_autoscaleinterval] (REST-API)</span><span class="sxs-lookup"><span data-stu-id="e148e-522">[autoScaleEvaluationInterval][rest_autoscaleinterval] (REST API)</span></span>

<span data-ttu-id="e148e-523">Het minimale interval is vijf minuten en de maximumwaarde is 168 uur.</span><span class="sxs-lookup"><span data-stu-id="e148e-523">The minimum interval is five minutes, and the maximum is 168 hours.</span></span> <span data-ttu-id="e148e-524">Als een interval buiten dit bereik is opgegeven, geeft de Batch-service een fout Ongeldige aanvraag (400).</span><span class="sxs-lookup"><span data-stu-id="e148e-524">If an interval outside this range is specified, the Batch service returns a Bad Request (400) error.</span></span>

> [!NOTE]
> <span data-ttu-id="e148e-525">Automatisch schalen is momenteel niet bedoeld om te reageren op wijzigingen in minder dan een minuut, maar in plaats daarvan is bedoeld voor het aanpassen van de grootte van uw groep geleidelijk als u een werkbelasting uitvoeren.</span><span class="sxs-lookup"><span data-stu-id="e148e-525">Autoscaling is not currently intended to respond to changes in less than a minute, but rather is intended to adjust the size of your pool gradually as you run a workload.</span></span>
>
>

## <a name="enable-autoscaling-on-an-existing-pool"></a><span data-ttu-id="e148e-526">Automatisch schalen op een bestaande toepassingen inschakelen</span><span class="sxs-lookup"><span data-stu-id="e148e-526">Enable autoscaling on an existing pool</span></span>

<span data-ttu-id="e148e-527">Elke Batch-SDK biedt een manier om in te schakelen automatisch schalen.</span><span class="sxs-lookup"><span data-stu-id="e148e-527">Each Batch SDK provides a way to enable autoscaling.</span></span> <span data-ttu-id="e148e-528">Bijvoorbeeld:</span><span class="sxs-lookup"><span data-stu-id="e148e-528">For example:</span></span>

* <span data-ttu-id="e148e-529">[BatchClient.PoolOperations.EnableAutoScaleAsync] [ net_enableautoscaleasync] (Batch .NET)</span><span class="sxs-lookup"><span data-stu-id="e148e-529">[BatchClient.PoolOperations.EnableAutoScaleAsync][net_enableautoscaleasync] (Batch .NET)</span></span>
* <span data-ttu-id="e148e-530">[Inschakelen van automatisch schalen op een pool] [ rest_enableautoscale] (REST-API)</span><span class="sxs-lookup"><span data-stu-id="e148e-530">[Enable automatic scaling on a pool][rest_enableautoscale] (REST API)</span></span>

<span data-ttu-id="e148e-531">Wanneer u automatisch schalen op een bestaande pool inschakelt, houd er rekening mee houden de volgende punten:</span><span class="sxs-lookup"><span data-stu-id="e148e-531">When you enable autoscaling on an existing pool, keep in mind the following points:</span></span>

* <span data-ttu-id="e148e-532">Als automatische schaling is momenteel uitgeschakeld op de groep wanneer u de aanvraag voor het inschakelen van automatisch schalen verzendt, moet u een formule voor automatisch schalen die geldige opgeven wanneer u de aanvraag verzendt.</span><span class="sxs-lookup"><span data-stu-id="e148e-532">If automatic scaling is currently disabled on the pool when you issue the request to enable autoscaling, you must specify a valid autoscale formula when you issue the request.</span></span> <span data-ttu-id="e148e-533">U kunt optioneel een evaluatie-interval voor automatisch schalen opgeven.</span><span class="sxs-lookup"><span data-stu-id="e148e-533">You can optionally specify an autoscale evaluation interval.</span></span> <span data-ttu-id="e148e-534">Als u een interval niet opgeeft, wordt de standaardwaarde van 15 minuten gebruikt.</span><span class="sxs-lookup"><span data-stu-id="e148e-534">If you do not specify an interval, the default value of 15 minutes is used.</span></span>
* <span data-ttu-id="e148e-535">Als voor automatisch schalen die momenteel is ingeschakeld op de groep, kunt u een formule voor automatisch schalen, een evaluatie-interval of beide opgeven.</span><span class="sxs-lookup"><span data-stu-id="e148e-535">If autoscale is currently enabled on the pool, you can specify an autoscale formula, an evaluation interval, or both.</span></span> <span data-ttu-id="e148e-536">U moet ten minste één van deze eigenschappen opgeven.</span><span class="sxs-lookup"><span data-stu-id="e148e-536">You must specify at least one of these properties.</span></span>

  * <span data-ttu-id="e148e-537">Als u een nieuwe evaluatie interval voor automatisch schalen opgeeft, wordt de bestaande evaluatieplanning gestopt en een nieuw schema wordt gestart.</span><span class="sxs-lookup"><span data-stu-id="e148e-537">If you specify a new autoscale evaluation interval, then the existing evaluation schedule is stopped and a new schedule is started.</span></span> <span data-ttu-id="e148e-538">Begintijd van de nieuwe planning is de tijd waarop de aanvraag voor het inschakelen van automatisch schalen is uitgegeven.</span><span class="sxs-lookup"><span data-stu-id="e148e-538">The new schedule's start time is the time at which the request to enable autoscaling was issued.</span></span>
  * <span data-ttu-id="e148e-539">Als u de formule voor automatisch schalen of evaluatie-interval, de Batch-service weglaat blijft de huidige waarde van de instelling te gebruiken.</span><span class="sxs-lookup"><span data-stu-id="e148e-539">If you omit either the autoscale formula or evaluation interval, the Batch service continues to use the current value of that setting.</span></span>

> [!NOTE]
> <span data-ttu-id="e148e-540">Als u opgegeven waarden voor de *targetDedicatedComputeNodes* of *targetLowPriorityComputeNodes* parameters van de **CreatePool** methode wanneer u de groep hebt gemaakt in .NET of voor de vergelijkbare parameters in een andere taal, worden deze waarden genegeerd als de formule voor automatisch vergroten/verkleinen wordt geëvalueerd.</span><span class="sxs-lookup"><span data-stu-id="e148e-540">If you specified values for the *targetDedicatedComputeNodes* or *targetLowPriorityComputeNodes* parameters of the **CreatePool** method when you created the pool in .NET, or for the comparable parameters in another language, then those values are ignored when the automatic scaling formula is evaluated.</span></span>
>
>

<span data-ttu-id="e148e-541">Dit C#-codefragment maakt gebruik van de [Batch .NET] [ net_api] bibliotheek automatisch schalen op een bestaande pool inschakelen:</span><span class="sxs-lookup"><span data-stu-id="e148e-541">This C# code snippet uses the [Batch .NET][net_api] library to enable autoscaling on an existing pool:</span></span>

```csharp
// Define the autoscaling formula. This formula sets the target number of nodes
// to 5 on Mondays, and 1 on every other day of the week
string myAutoScaleFormula = "$TargetDedicatedNodes = (time().weekday == 1 ? 5:1);";

// Set the autoscale formula on the existing pool
await myBatchClient.PoolOperations.EnableAutoScaleAsync(
    "myexistingpool",
    autoscaleFormula: myAutoScaleFormula);
```

### <a name="update-an-autoscale-formula"></a><span data-ttu-id="e148e-542">Bijwerken van een formule voor automatisch schalen</span><span class="sxs-lookup"><span data-stu-id="e148e-542">Update an autoscale formula</span></span>

<span data-ttu-id="e148e-543">Voor het bijwerken van de formule op een bestaande pool voor automatisch schalen is ingeschakeld, moet u de bewerking zodat automatisch schalen opnieuw met de nieuwe formule aanroepen.</span><span class="sxs-lookup"><span data-stu-id="e148e-543">To update the formula on an existing autoscale-enabled pool, call the operation to enable autoscaling again with the new formula.</span></span> <span data-ttu-id="e148e-544">Bijvoorbeeld, als u automatisch schalen is al ingeschakeld op `myexistingpool` wanneer de volgende .NET-code wordt uitgevoerd, de formule voor automatisch schalen is vervangen door de inhoud van `myNewFormula`.</span><span class="sxs-lookup"><span data-stu-id="e148e-544">For example, if autoscaling is already enabled on `myexistingpool` when the following .NET code is executed, its autoscale formula is replaced with the contents of `myNewFormula`.</span></span>

```csharp
await myBatchClient.PoolOperations.EnableAutoScaleAsync(
    "myexistingpool",
    autoscaleFormula: myNewFormula);
```

### <a name="update-the-autoscale-interval"></a><span data-ttu-id="e148e-545">Het interval voor automatisch schalen</span><span class="sxs-lookup"><span data-stu-id="e148e-545">Update the autoscale interval</span></span>

<span data-ttu-id="e148e-546">Voor het bijwerken van het interval voor automatisch schalen evaluatie van een bestaande pool voor automatisch schalen is ingeschakeld, moet u de bewerking zodat automatisch schalen opnieuw met het nieuwe interval aanroepen.</span><span class="sxs-lookup"><span data-stu-id="e148e-546">To update the autoscale evaluation interval of an existing autoscale-enabled pool, call the operation to enable autoscaling again with the new interval.</span></span> <span data-ttu-id="e148e-547">Als u bijvoorbeeld het interval van de evaluatie voor automatisch schalen instellen en 60 minuten voor een pool die al automatisch schalen in .NET is ingeschakeld:</span><span class="sxs-lookup"><span data-stu-id="e148e-547">For example, to set the autoscale evaluation interval to 60 minutes for a pool that's already autoscale-enabled in .NET:</span></span>

```csharp
await myBatchClient.PoolOperations.EnableAutoScaleAsync(
    "myexistingpool",
    autoscaleEvaluationInterval: TimeSpan.FromMinutes(60));
```

## <a name="evaluate-an-autoscale-formula"></a><span data-ttu-id="e148e-548">Evalueren van een formule voor automatisch schalen</span><span class="sxs-lookup"><span data-stu-id="e148e-548">Evaluate an autoscale formula</span></span>

<span data-ttu-id="e148e-549">U kunt een formule evalueren voordat u deze toepast op een groep.</span><span class="sxs-lookup"><span data-stu-id="e148e-549">You can evaluate a formula before applying it to a pool.</span></span> <span data-ttu-id="e148e-550">Op deze manier kunt u de formule om te zien hoe de instructies evalueren voordat u de formule plaatsen in productie testen.</span><span class="sxs-lookup"><span data-stu-id="e148e-550">In this way, you can test the formula to see how its statements evaluate before you put the formula into production.</span></span>

<span data-ttu-id="e148e-551">Om een formule voor automatisch schalen, moet u eerst automatisch schalen op de groep met een geldige formule inschakelen.</span><span class="sxs-lookup"><span data-stu-id="e148e-551">To evaluate an autoscale formula, you must first enable autoscaling on the pool with a valid formula.</span></span> <span data-ttu-id="e148e-552">Als u wilt testen een formule in een groep die nog geen automatisch schalen die zijn ingeschakeld, gebruikt u de formule van één regel `$TargetDedicatedNodes = 0` wanneer u automatisch schalen voor het eerst inschakelt.</span><span class="sxs-lookup"><span data-stu-id="e148e-552">To test a formula on a pool that doesn't yet have autoscaling enabled, use the one-line formula `$TargetDedicatedNodes = 0` when you first enable autoscaling.</span></span> <span data-ttu-id="e148e-553">Gebruik vervolgens een van de volgende evalueren van de formule die u wilt testen:</span><span class="sxs-lookup"><span data-stu-id="e148e-553">Then, use one of the following to evaluate the formula you want to test:</span></span>

* <span data-ttu-id="e148e-554">[BatchClient.PoolOperations.EvaluateAutoScale](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.pooloperations.evaluateautoscale) of [EvaluateAutoScaleAsync](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.pooloperations.evaluateautoscaleasync)</span><span class="sxs-lookup"><span data-stu-id="e148e-554">[BatchClient.PoolOperations.EvaluateAutoScale](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.pooloperations.evaluateautoscale) or [EvaluateAutoScaleAsync](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.pooloperations.evaluateautoscaleasync)</span></span>

    <span data-ttu-id="e148e-555">Deze methoden Batch .NET vereist de ID van een bestaande pool en een tekenreeks met de formule voor automatisch schalen om te evalueren.</span><span class="sxs-lookup"><span data-stu-id="e148e-555">These Batch .NET methods require the ID of an existing pool and a string containing the autoscale formula to evaluate.</span></span>

* [<span data-ttu-id="e148e-556">Evalueren van een formule voor automatisch schalen</span><span class="sxs-lookup"><span data-stu-id="e148e-556">Evaluate an automatic scaling formula</span></span>](https://docs.microsoft.com/rest/api/batchservice/evaluate-an-automatic-scaling-formula)

    <span data-ttu-id="e148e-557">In deze REST-API-aanvraag opgeven dat de pool-ID in de URI en de formule voor automatisch schalen in de *autoScaleFormula* element van de aanvraagtekst.</span><span class="sxs-lookup"><span data-stu-id="e148e-557">In this REST API request, specify the pool ID in the URI, and the autoscale formula in the *autoScaleFormula* element of the request body.</span></span> <span data-ttu-id="e148e-558">Het antwoord van de bewerking bevat informatie over de fout die mogelijk zijn gerelateerd aan de formule.</span><span class="sxs-lookup"><span data-stu-id="e148e-558">The response of the operation contains any error information that might be related to the formula.</span></span>

<span data-ttu-id="e148e-559">In deze [Batch .NET] [ net_api] codefragment, we een formule voor automatisch schalen evalueren.</span><span class="sxs-lookup"><span data-stu-id="e148e-559">In this [Batch .NET][net_api] code snippet, we evaluate an autoscale formula.</span></span> <span data-ttu-id="e148e-560">Als de groep geen automatisch schalen die zijn ingeschakeld, wordt dit inschakelen eerst.</span><span class="sxs-lookup"><span data-stu-id="e148e-560">If the pool does not have autoscaling enabled, we enable it first.</span></span>

```csharp
// First obtain a reference to an existing pool
CloudPool pool = await batchClient.PoolOperations.GetPoolAsync("myExistingPool");

// If autoscaling isn't already enabled on the pool, enable it.
// You can't evaluate an autoscale formula on non-autoscale-enabled pool.
if (pool.AutoScaleEnabled == false)
{
    // We need a valid autoscale formula to enable autoscaling on the
    // pool. This formula is valid, but won't resize the pool:
    await pool.EnableAutoScaleAsync(
        autoscaleFormula: "$TargetDedicatedNodes = {pool.CurrentDedicatedNodes};",
        autoscaleEvaluationInterval: TimeSpan.FromMinutes(5));

    // Batch limits EnableAutoScaleAsync calls to once every 30 seconds.
    // Because we want to apply our new autoscale formula below if it
    // evaluates successfully, and we *just* enabled autoscaling on
    // this pool, we pause here to ensure we pass that threshold.
    Thread.Sleep(TimeSpan.FromSeconds(31));

    // Refresh the properties of the pool so that we've got the
    // latest value for AutoScaleEnabled
    await pool.RefreshAsync();
}

// We must ensure that autoscaling is enabled on the pool prior to
// evaluating a formula
if (pool.AutoScaleEnabled == true)
{
    // The formula to evaluate - adjusts target number of nodes based on
    // day of week and time of day
    string myFormula = @"
        $curTime = time();
        $workHours = $curTime.hour >= 8 && $curTime.hour < 18;
        $isWeekday = $curTime.weekday >= 1 && $curTime.weekday <= 5;
        $isWorkingWeekdayHour = $workHours && $isWeekday;
        $TargetDedicatedNodes = $isWorkingWeekdayHour ? 20:10;
    ";

    // Perform the autoscale formula evaluation. Note that this code does not
    // actually apply the formula to the pool.
    AutoScaleRun eval =
        await batchClient.PoolOperations.EvaluateAutoScaleAsync(pool.Id, myFormula);

    if (eval.Error == null)
    {
        // Evaluation success - print the results of the AutoScaleRun.
        // This will display the values of each variable as evaluated by the
        // autoscale formula.
        Console.WriteLine("AutoScaleRun.Results: " +
            eval.Results.Replace("$", "\n    $"));

        // Apply the formula to the pool since it evaluated successfully
        await batchClient.PoolOperations.EnableAutoScaleAsync(pool.Id, myFormula);
    }
    else
    {
        // Evaluation failed, output the message associated with the error
        Console.WriteLine("AutoScaleRun.Error.Message: " +
            eval.Error.Message);
    }
}
```

<span data-ttu-id="e148e-561">Geslaagde evaluatie van de formule weergegeven in dit codefragment levert resultaten vergelijkbaar met:</span><span class="sxs-lookup"><span data-stu-id="e148e-561">Successful evaluation of the formula shown in this code snippet produces results similar to:</span></span>

```
AutoScaleRun.Results:
    $TargetDedicatedNodes=10;
    $NodeDeallocationOption=requeue;
    $curTime=2016-10-13T19:18:47.805Z;
    $isWeekday=1;
    $isWorkingWeekdayHour=0;
    $workHours=0
```

## <a name="get-information-about-autoscale-runs"></a><span data-ttu-id="e148e-562">Informatie ophalen over automatisch schalen die wordt uitgevoerd</span><span class="sxs-lookup"><span data-stu-id="e148e-562">Get information about autoscale runs</span></span>

<span data-ttu-id="e148e-563">Om ervoor te zorgen dat de formule wordt uitgevoerd zoals verwacht, is het raadzaam dat u de resultaten van het automatisch schalen wordt uitgevoerd waarmee Batch wordt uitgevoerd op uw pool periodiek controleren.</span><span class="sxs-lookup"><span data-stu-id="e148e-563">To ensure that your formula is performing as expected, we recommend that you periodically check the results of the autoscaling runs that Batch performs on your pool.</span></span> <span data-ttu-id="e148e-564">Dus ophalen (of vernieuwen) een verwijzing naar de groep, en bekijk de eigenschappen van de laatste automatisch schalen die wordt uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="e148e-564">To do so, get (or refresh) a reference to the pool, and examine the properties of its last autoscale run.</span></span>

<span data-ttu-id="e148e-565">In de Batch .NET, de [CloudPool.AutoScaleRun](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscalerun) eigenschap heeft verschillende eigenschappen die informatie geven over de meest recente automatische schaling uitgevoerd worden uitgevoerd op de groep:</span><span class="sxs-lookup"><span data-stu-id="e148e-565">In Batch .NET, the [CloudPool.AutoScaleRun](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscalerun) property has several properties that provide information about the latest automatic scaling run performed on the pool:</span></span>

* [<span data-ttu-id="e148e-566">AutoScaleRun.Timestamp</span><span class="sxs-lookup"><span data-stu-id="e148e-566">AutoScaleRun.Timestamp</span></span>](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.autoscalerun.timestamp)
* [<span data-ttu-id="e148e-567">AutoScaleRun.Results</span><span class="sxs-lookup"><span data-stu-id="e148e-567">AutoScaleRun.Results</span></span>](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.autoscalerun.results)
* [<span data-ttu-id="e148e-568">AutoScaleRun.Error</span><span class="sxs-lookup"><span data-stu-id="e148e-568">AutoScaleRun.Error</span></span>](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.autoscalerun.error)

<span data-ttu-id="e148e-569">In de REST API, de [informatie ophalen over een pool](https://docs.microsoft.com/rest/api/batchservice/get-information-about-a-pool) aanvraag retourneert informatie over de groep, waaronder de meest recente automatische schaling uitgevoerd van de informatie de [autoScaleRun](https://docs.microsoft.com/rest/api/batchservice/get-information-about-a-pool#bk_autrun) eigenschap.</span><span class="sxs-lookup"><span data-stu-id="e148e-569">In the REST API, the [Get information about a pool](https://docs.microsoft.com/rest/api/batchservice/get-information-about-a-pool) request returns information about the pool, which includes the latest automatic scaling run information in the [autoScaleRun](https://docs.microsoft.com/rest/api/batchservice/get-information-about-a-pool#bk_autrun) property.</span></span>

<span data-ttu-id="e148e-570">De volgende C#-codefragment maakt gebruik van de Batch .NET-bibliotheek om informatie over de laatste automatisch schalen die worden uitgevoerd op de groep van toepassingen te drukken _myPool_:</span><span class="sxs-lookup"><span data-stu-id="e148e-570">The following C# code snippet uses the Batch .NET library to print information about the last autoscaling run on pool _myPool_:</span></span>

```csharp
await Cloud pool = myBatchClient.PoolOperations.GetPoolAsync("myPool");
Console.WriteLine("Last execution: " + pool.AutoScaleRun.Timestamp);
Console.WriteLine("Result:" + pool.AutoScaleRun.Results.Replace("$", "\n  $"));
Console.WriteLine("Error: " + pool.AutoScaleRun.Error);
```

<span data-ttu-id="e148e-571">Voorbeeld van uitvoer van het vorige codefragment:</span><span class="sxs-lookup"><span data-stu-id="e148e-571">Sample output of the preceding snippet:</span></span>

```
Last execution: 10/14/2016 18:36:43
Result:
  $TargetDedicatedNodes=10;
  $NodeDeallocationOption=requeue;
  $curTime=2016-10-14T18:36:43.282Z;
  $isWeekday=1;
  $isWorkingWeekdayHour=0;
  $workHours=0
Error:
```

## <a name="example-autoscale-formulas"></a><span data-ttu-id="e148e-572">Voorbeeld voor automatisch schalen formules</span><span class="sxs-lookup"><span data-stu-id="e148e-572">Example autoscale formulas</span></span>
<span data-ttu-id="e148e-573">Bekijken we enkele formules die verschillende manieren om aan te passen, de hoeveelheid rekenresources in een groep weergeven.</span><span class="sxs-lookup"><span data-stu-id="e148e-573">Let's look at a few formulas that show different ways to adjust the amount of compute resources in a pool.</span></span>

### <a name="example-1-time-based-adjustment"></a><span data-ttu-id="e148e-574">Voorbeeld 1: Op basis van tijd aanpassing</span><span class="sxs-lookup"><span data-stu-id="e148e-574">Example 1: Time-based adjustment</span></span>
<span data-ttu-id="e148e-575">Stel dat u wilt aanpassen van de grootte van de groep op basis van de dag van de week en het tijdstip van de dag.</span><span class="sxs-lookup"><span data-stu-id="e148e-575">Suppose you want to adjust the pool size based on the day of the week and time of day.</span></span> <span data-ttu-id="e148e-576">In dit voorbeeld laat zien hoe vergroten of verkleinen het aantal knooppunten in de pool dienovereenkomstig.</span><span class="sxs-lookup"><span data-stu-id="e148e-576">This example shows how to increase or decrease the number of nodes in the pool accordingly.</span></span>

<span data-ttu-id="e148e-577">De formule verkrijgt eerst de huidige tijd.</span><span class="sxs-lookup"><span data-stu-id="e148e-577">The formula first obtains the current time.</span></span> <span data-ttu-id="e148e-578">Als dit een weekdag (1-5 is) en binnen werkuren (8 AM tot 6 uur), wordt de grootte van de doel-groep is ingesteld op 20 knooppunten.</span><span class="sxs-lookup"><span data-stu-id="e148e-578">If it's a weekday (1-5) and within working hours (8 AM to 6 PM), the target pool size is set to 20 nodes.</span></span> <span data-ttu-id="e148e-579">Anders wordt ingesteld op 10 knooppunten.</span><span class="sxs-lookup"><span data-stu-id="e148e-579">Otherwise, it's set to 10 nodes.</span></span>

```
$curTime = time();
$workHours = $curTime.hour >= 8 && $curTime.hour < 18;
$isWeekday = $curTime.weekday >= 1 && $curTime.weekday <= 5;
$isWorkingWeekdayHour = $workHours && $isWeekday;
$TargetDedicatedNodes = $isWorkingWeekdayHour ? 20:10;
```

### <a name="example-2-task-based-adjustment"></a><span data-ttu-id="e148e-580">Voorbeeld 2: Taakgebaseerde aanpassing</span><span class="sxs-lookup"><span data-stu-id="e148e-580">Example 2: Task-based adjustment</span></span>
<span data-ttu-id="e148e-581">In dit voorbeeld is de poolgrootte aangepast op basis van het aantal taken in de wachtrij.</span><span class="sxs-lookup"><span data-stu-id="e148e-581">In this example, the pool size is adjusted based on the number of tasks in the queue.</span></span> <span data-ttu-id="e148e-582">Alle opmerkingen en regeleinden zijn acceptabel in formule tekenreeksen.</span><span class="sxs-lookup"><span data-stu-id="e148e-582">Both comments and line breaks are acceptable in formula strings.</span></span>

```csharp
// Get pending tasks for the past 15 minutes.
$samples = $ActiveTasks.GetSamplePercent(TimeInterval_Minute * 15);
// If we have fewer than 70 percent data points, we use the last sample point,
// otherwise we use the maximum of last sample point and the history average.
$tasks = $samples < 70 ? max(0,$ActiveTasks.GetSample(1)) : max( $ActiveTasks.GetSample(1), avg($ActiveTasks.GetSample(TimeInterval_Minute * 15)));
// If number of pending tasks is not 0, set targetVM to pending tasks, otherwise
// half of current dedicated.
$targetVMs = $tasks > 0? $tasks:max(0, $TargetDedicatedNodes/2);
// The pool size is capped at 20, if target VM value is more than that, set it
// to 20. This value should be adjusted according to your use case.
$TargetDedicatedNodes = max(0, min($targetVMs, 20));
// Set node deallocation mode - keep nodes active only until tasks finish
$NodeDeallocationOption = taskcompletion;
```

### <a name="example-3-accounting-for-parallel-tasks"></a><span data-ttu-id="e148e-583">Voorbeeld 3: Accounting voor parallelle taken</span><span class="sxs-lookup"><span data-stu-id="e148e-583">Example 3: Accounting for parallel tasks</span></span>
<span data-ttu-id="e148e-584">Dit voorbeeld wordt de grootte van de groep op basis van het aantal taken.</span><span class="sxs-lookup"><span data-stu-id="e148e-584">This example adjusts the pool size based on the number of tasks.</span></span> <span data-ttu-id="e148e-585">Deze formule ook rekening met de [MaxTasksPerComputeNode] [ net_maxtasks] waarde die is ingesteld voor de pool.</span><span class="sxs-lookup"><span data-stu-id="e148e-585">This formula also takes into account the [MaxTasksPerComputeNode][net_maxtasks] value that has been set for the pool.</span></span> <span data-ttu-id="e148e-586">Deze methode is handig in situaties waar [parallelle uitvoering van de taak](batch-parallel-node-tasks.md) is ingeschakeld op uw pool.</span><span class="sxs-lookup"><span data-stu-id="e148e-586">This approach is useful in situations where [parallel task execution](batch-parallel-node-tasks.md) has been enabled on your pool.</span></span>

```csharp
// Determine whether 70 percent of the samples have been recorded in the past
// 15 minutes; if not, use last sample
$samples = $ActiveTasks.GetSamplePercent(TimeInterval_Minute * 15);
$tasks = $samples < 70 ? max(0,$ActiveTasks.GetSample(1)) : max( $ActiveTasks.GetSample(1),avg($ActiveTasks.GetSample(TimeInterval_Minute * 15)));
// Set the number of nodes to add to one-fourth the number of active tasks (the
// MaxTasksPerComputeNode property on this pool is set to 4, adjust this number
// for your use case)
$cores = $TargetDedicatedNodes * 4;
$extraVMs = (($tasks - $cores) + 3) / 4;
$targetVMs = ($TargetDedicatedNodes + $extraVMs);
// Attempt to grow the number of compute nodes to match the number of active
// tasks, with a maximum of 3
$TargetDedicatedNodes = max(0,min($targetVMs,3));
// Keep the nodes active until the tasks finish
$NodeDeallocationOption = taskcompletion;
```

### <a name="example-4-setting-an-initial-pool-size"></a><span data-ttu-id="e148e-587">Voorbeeld 4: De grootte van een eerste groep van toepassingen instellen</span><span class="sxs-lookup"><span data-stu-id="e148e-587">Example 4: Setting an initial pool size</span></span>
<span data-ttu-id="e148e-588">Dit voorbeeld toont een C#-codefragment met een formule voor automatisch schalen die de poolgrootte op een opgegeven aantal knooppunten voor een eerste periode instelt.</span><span class="sxs-lookup"><span data-stu-id="e148e-588">This example shows a C# code snippet with an autoscale formula that sets the pool size to a specified number of nodes for an initial time period.</span></span> <span data-ttu-id="e148e-589">Vervolgens wordt de grootte van de groep op basis van het nummer van het uitvoeren en actieve deze aangepast taken nadat de eerste periode is verstreken.</span><span class="sxs-lookup"><span data-stu-id="e148e-589">Then it adjusts the pool size based on the number of running and active tasks after the initial time period has elapsed.</span></span>

<span data-ttu-id="e148e-590">De formule in het volgende codefragment:</span><span class="sxs-lookup"><span data-stu-id="e148e-590">The formula in the following code snippet:</span></span>

* <span data-ttu-id="e148e-591">Hiermee stelt u de initiële poolgrootte met vier knooppunten.</span><span class="sxs-lookup"><span data-stu-id="e148e-591">Sets the initial pool size to four nodes.</span></span>
* <span data-ttu-id="e148e-592">Grootte van de groep niet aangepast tijdens de eerste 10 minuten van de levenscyclus van de groep.</span><span class="sxs-lookup"><span data-stu-id="e148e-592">Does not adjust the pool size within the first 10 minutes of the pool's lifecycle.</span></span>
* <span data-ttu-id="e148e-593">Na 10 minuten verkrijgt de max-waarde van het aantal actieve en actieve taken in de afgelopen 60 minuten.</span><span class="sxs-lookup"><span data-stu-id="e148e-593">After 10 minutes, obtains the max value of the number of running and active tasks within the past 60 minutes.</span></span>
  * <span data-ttu-id="e148e-594">Als beide waarden zijn 0 (waarmee wordt aangegeven dat er geen taken uitgevoerd of actief is in de afgelopen 60 minuten zijn), wordt de poolgrootte ingesteld op 0.</span><span class="sxs-lookup"><span data-stu-id="e148e-594">If both values are 0 (indicating that no tasks were running or active in the last 60 minutes), the pool size is set to 0.</span></span>
  * <span data-ttu-id="e148e-595">Als een waarde groter dan nul is, worden niet gewijzigd.</span><span class="sxs-lookup"><span data-stu-id="e148e-595">If either value is greater than zero, no change is made.</span></span>

```csharp
string now = DateTime.UtcNow.ToString("r");
string formula = string.Format(@"
    $TargetDedicatedNodes = {1};
    lifespan         = time() - time(""{0}"");
    span             = TimeInterval_Minute * 60;
    startup          = TimeInterval_Minute * 10;
    ratio            = 50;

    $TargetDedicatedNodes = (lifespan > startup ? (max($RunningTasks.GetSample(span, ratio), $ActiveTasks.GetSample(span, ratio)) == 0 ? 0 : $TargetDedicatedNodes) : {1});
    ", now, 4);
```

## <a name="next-steps"></a><span data-ttu-id="e148e-596">Volgende stappen</span><span class="sxs-lookup"><span data-stu-id="e148e-596">Next steps</span></span>
* <span data-ttu-id="e148e-597">[Azure Batch compute Resourcegebruik met gelijktijdige knooppunt taken maximaliseren](batch-parallel-node-tasks.md) bevat details over hoe u meerdere taken tegelijkertijd op de rekenknooppunten in uw groep uitvoeren kunt.</span><span class="sxs-lookup"><span data-stu-id="e148e-597">[Maximize Azure Batch compute resource usage with concurrent node tasks](batch-parallel-node-tasks.md) contains details about how you can execute multiple tasks simultaneously on the compute nodes in your pool.</span></span> <span data-ttu-id="e148e-598">Naast het automatisch schalen helpen deze functie mogelijk te verlagen duur van de taak voor sommige werkbelastingen, u geld besparen.</span><span class="sxs-lookup"><span data-stu-id="e148e-598">In addition to autoscaling, this feature may help to lower job duration for some workloads, saving you money.</span></span>
* <span data-ttu-id="e148e-599">Voor een andere efficiëntie booster, moet u ervoor zorgen dat uw Batch-toepassing query's in de Batch-service op optimale wijze.</span><span class="sxs-lookup"><span data-stu-id="e148e-599">For another efficiency booster, ensure that your Batch application queries the Batch service in the most optimal way.</span></span> <span data-ttu-id="e148e-600">Zie [efficiënt query uitvoeren op de Azure Batch-service](batch-efficient-list-queries.md) voor informatie over het beperken van de hoeveelheid gegevens die over de kabel wanneer u de status van mogelijk duizenden rekenknooppunten of taken opvragen.</span><span class="sxs-lookup"><span data-stu-id="e148e-600">See [Query the Azure Batch service efficiently](batch-efficient-list-queries.md) to learn how to limit the amount of data that crosses the wire when you query the status of potentially thousands of compute nodes or tasks.</span></span>

[net_api]: https://docs.microsoft.com/dotnet/api/microsoft.azure.batch
[net_batchclient]: https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.batchclient
[net_cloudpool_autoscaleformula]: https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscaleformula
[net_cloudpool_autoscaleevalinterval]: https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscaleevaluationinterval
[net_enableautoscaleasync]: https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.pooloperations.enableautoscaleasync
[net_maxtasks]: https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.maxtaskspercomputenode
[net_poolops_resizepoolasync]: https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.pooloperations.resizepoolasync

[rest_api]: https://docs.microsoft.com/rest/api/batchservice/
[rest_autoscaleformula]: https://docs.microsoft.com/rest/api/batchservice/enable-automatic-scaling-on-a-pool
[rest_autoscaleinterval]: https://docs.microsoft.com/rest/api/batchservice/enable-automatic-scaling-on-a-pool
[rest_enableautoscale]: https://docs.microsoft.com/rest/api/batchservice/enable-automatic-scaling-on-a-pool
