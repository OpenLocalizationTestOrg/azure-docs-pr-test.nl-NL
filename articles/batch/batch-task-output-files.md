---
title: taak aaaPersist en uitvoer tooAzure opslag Hello Azure Batch service API | Microsoft Docs
description: Meer informatie over hoe toopersist Batch-taak toouse API van Batch-service en de taak uitvoer tooAzure opslag.
services: batch
author: tamram
manager: timlt
editor: 
ms.service: batch
ms.devlang: multiple
ms.topic: article
ms.tgt_pltfrm: vm-windows
ms.workload: big-compute
ms.date: 06/16/2017
ms.author: tamram
ms.openlocfilehash: 71b3f7c0dda2d2a9d8eb3eef83229873c70ca22c
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 10/06/2017
---
# <a name="persist-task-data-tooazure-storage-with-hello-batch-service-api"></a><span data-ttu-id="11a9e-103">Taak gegevens tooAzure opslag Hello API van Batch-service behouden</span><span class="sxs-lookup"><span data-stu-id="11a9e-103">Persist task data tooAzure Storage with hello Batch service API</span></span>

[!INCLUDE [batch-task-output-include](../../includes/batch-task-output-include.md)]

<span data-ttu-id="11a9e-104">Hallo API van Batch-service ondersteunt persistent maken uitvoer gegevens tooAzure opslag voor taken en jobbeheertaken die worden uitgevoerd op de groepen met virtuele-machineconfiguratie Hallo vanaf 2017-05-01-versie.</span><span class="sxs-lookup"><span data-stu-id="11a9e-104">Starting with version 2017-05-01, hello Batch service API supports persisting output data tooAzure Storage for tasks and job manager tasks that run on pools with hello virtual machine configuration.</span></span> <span data-ttu-id="11a9e-105">Wanneer u een taak toevoegt, kunt u een container in Azure Storage als Hallo bestemming voor Hallo taakuitvoer.</span><span class="sxs-lookup"><span data-stu-id="11a9e-105">When you add a task, you can specify a container in Azure Storage as hello destination for hello task's output.</span></span> <span data-ttu-id="11a9e-106">Hallo Batch-service schrijft vervolgens een uitvoer-gegevenscontainer toothat wanneer Hallo-taak voltooid is.</span><span class="sxs-lookup"><span data-stu-id="11a9e-106">hello Batch service then writes any output data toothat container when hello task is complete.</span></span>

<span data-ttu-id="11a9e-107">Een voordeel toousing Hallo Batch service API toopersist de taakuitvoer is dat u hoeft niet toomodify Hallo toepassing die Hallo taak wordt uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="11a9e-107">An advantage toousing hello Batch service API toopersist task output is that you do not need toomodify hello application that hello task is running.</span></span> <span data-ttu-id="11a9e-108">In plaats daarvan met enkele eenvoudige wijzigingen tooyour-clienttoepassing, u kunt deze persistent maken van de taak van het Hallo-uitvoer van Hallo-code die Hallo taak maakt.</span><span class="sxs-lookup"><span data-stu-id="11a9e-108">Instead, with a few simple modifications tooyour client application, you can persist hello task's output from within hello code that creates hello task.</span></span>   

## <a name="when-do-i-use-hello-batch-service-api-toopersist-task-output"></a><span data-ttu-id="11a9e-109">Wanneer kan ik de uitvoer van de taak toopersist Hallo API van Batch-service gebruiken?</span><span class="sxs-lookup"><span data-stu-id="11a9e-109">When do I use hello Batch service API toopersist task output?</span></span>

<span data-ttu-id="11a9e-110">Azure Batch voorziet in meer dan een manier toopersist taakuitvoer.</span><span class="sxs-lookup"><span data-stu-id="11a9e-110">Azure Batch provides more than one way toopersist task output.</span></span> <span data-ttu-id="11a9e-111">Met behulp van Hallo API van Batch-service is een handige benadering die wordt aanbevolen geschikt toothese-scenario's:</span><span class="sxs-lookup"><span data-stu-id="11a9e-111">Using hello Batch service API is a convenient approach that's best suited toothese scenarios:</span></span>

- <span data-ttu-id="11a9e-112">Wilt u toowrite code toopersist taakuitvoer uit vanuit de clienttoepassing zonder te wijzigen Hallo-toepassing die de taak wordt uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="11a9e-112">You want toowrite code toopersist task output from within your client application, without modifying hello application that your task is running.</span></span>
- <span data-ttu-id="11a9e-113">Wilt u toopersist uitvoer van de Batch-taken en jobbeheertaken in groepen die zijn gemaakt met de Hallo Virtuele-machineconfiguratie.</span><span class="sxs-lookup"><span data-stu-id="11a9e-113">You want toopersist output from Batch tasks and job manager tasks in pools created with hello virtual machine configuration.</span></span>
- <span data-ttu-id="11a9e-114">Wilt u toopersist uitvoer tooan Azure Storage-container met een willekeurige naam.</span><span class="sxs-lookup"><span data-stu-id="11a9e-114">You want toopersist output tooan Azure Storage container with an arbitrary name.</span></span>
- <span data-ttu-id="11a9e-115">Gewenste toopersist uitvoer tooan Azure Storage-container met de naam volgens toohello [Batch bestand conventies standaard](https://github.com/Azure/azure-sdk-for-net/tree/vs17Dev/src/SDKs/Batch/Support/FileConventions#conventions).</span><span class="sxs-lookup"><span data-stu-id="11a9e-115">You want toopersist output tooan Azure Storage container named according toohello [Batch File Conventions standard](https://github.com/Azure/azure-sdk-for-net/tree/vs17Dev/src/SDKs/Batch/Support/FileConventions#conventions).</span></span> 

<span data-ttu-id="11a9e-116">Als uw scenario van die verschilt hierboven zijn vermeld, moet u mogelijk een andere benadering tooconsider.</span><span class="sxs-lookup"><span data-stu-id="11a9e-116">If your scenario differs from those listed above, you may need tooconsider a different approach.</span></span> <span data-ttu-id="11a9e-117">Bijvoorbeeld, Hallo Batch-service API ondersteunt momenteel geen streaming uitvoer tooAzure opslag terwijl Hallo-taak wordt uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="11a9e-117">For example, hello Batch service API does not currently support streaming output tooAzure Storage while hello task is running.</span></span> <span data-ttu-id="11a9e-118">toostream uitvoert, kunt u overwegen Hallo Batch bestand conventies bibliotheek, beschikbaar voor .NET.</span><span class="sxs-lookup"><span data-stu-id="11a9e-118">toostream output, consider using hello Batch File Conventions library, available for .NET.</span></span> <span data-ttu-id="11a9e-119">Voor andere talen moet u tooimplement uw eigen oplossing.</span><span class="sxs-lookup"><span data-stu-id="11a9e-119">For other languages, you'll need tooimplement your own solution.</span></span> <span data-ttu-id="11a9e-120">Zie voor meer informatie over andere opties voor het persistent maken van de taakuitvoer [Persist taak en uitvoer tooAzure opslag](batch-task-output.md).</span><span class="sxs-lookup"><span data-stu-id="11a9e-120">For more information on other options for persisting task output, see [Persist job and task output tooAzure Storage](batch-task-output.md).</span></span> 

## <a name="create-a-container-in-azure-storage"></a><span data-ttu-id="11a9e-121">Een container maken in Azure Storage</span><span class="sxs-lookup"><span data-stu-id="11a9e-121">Create a container in Azure Storage</span></span>

<span data-ttu-id="11a9e-122">toopersist taak uitvoer tooAzure opslag, moet u een container die als bestemming voor de uitvoerbestanden Hallo fungeert toocreate.</span><span class="sxs-lookup"><span data-stu-id="11a9e-122">toopersist task output tooAzure Storage, you'll need toocreate a container that serves as hello destination for your output files.</span></span> <span data-ttu-id="11a9e-123">Hallo-container maken voordat u uw taak, bij voorkeur uitvoeren voordat het verzenden van de taak.</span><span class="sxs-lookup"><span data-stu-id="11a9e-123">Create hello container before you run your task, preferably before you submit your job.</span></span> <span data-ttu-id="11a9e-124">toocreate hello container, gebruik Hallo juiste Azure Storage-clientbibliotheek of SDK.</span><span class="sxs-lookup"><span data-stu-id="11a9e-124">toocreate hello container, use hello appropriate Azure Storage client library or SDK.</span></span> <span data-ttu-id="11a9e-125">Zie voor meer informatie over Azure Storage-API's, Hallo [documentatie bij Azure Storage](https://docs.microsoft.com/azure/storage/).</span><span class="sxs-lookup"><span data-stu-id="11a9e-125">For more information about Azure Storage APIs, see hello [Azure Storage documentation](https://docs.microsoft.com/azure/storage/).</span></span>

<span data-ttu-id="11a9e-126">Bijvoorbeeld: als u uw toepassing in C# schrijft, hello gebruiken [Azure Storage-clientbibliotheek voor .NET](https://www.nuget.org/packages/WindowsAzure.Storage/).</span><span class="sxs-lookup"><span data-stu-id="11a9e-126">For example, if you are writing your application in C#, use hello [Azure Storage client library for .NET](https://www.nuget.org/packages/WindowsAzure.Storage/).</span></span> <span data-ttu-id="11a9e-127">Hallo volgende voorbeeld wordt getoond hoe toocreate een container:</span><span class="sxs-lookup"><span data-stu-id="11a9e-127">hello following example shows how toocreate a container:</span></span>

```csharp
CloudBlobContainer container = storageAccount.CreateCloudBlobClient().GetContainerReference(containerName);
await conainer.CreateIfNotExists();
```

## <a name="get-a-shared-access-signature-for-hello-container"></a><span data-ttu-id="11a9e-128">Een shared access signature voor Hallo container ophalen</span><span class="sxs-lookup"><span data-stu-id="11a9e-128">Get a shared access signature for hello container</span></span>

<span data-ttu-id="11a9e-129">Nadat u Hallo-container gemaakt, krijgen een shared access signature (SAS) met schrijftoegang toohello container.</span><span class="sxs-lookup"><span data-stu-id="11a9e-129">After you create hello container, get a shared access signature (SAS) with write access toohello container.</span></span> <span data-ttu-id="11a9e-130">Een SAS biedt gedelegeerde toegang toohello container.</span><span class="sxs-lookup"><span data-stu-id="11a9e-130">A SAS provides delegated access toohello container.</span></span> <span data-ttu-id="11a9e-131">Hallo SAS verleent toegang met een opgegeven set machtigingen en via een opgegeven tijdsinterval.</span><span class="sxs-lookup"><span data-stu-id="11a9e-131">hello SAS grants access with a specified set of permissions and over a specified time interval.</span></span> <span data-ttu-id="11a9e-132">Hallo Batch-service moet een SAS met schrijven machtigingen toowrite taak uitvoer toohello container.</span><span class="sxs-lookup"><span data-stu-id="11a9e-132">hello Batch service needs a SAS with write permissions toowrite task output toohello container.</span></span> <span data-ttu-id="11a9e-133">Zie voor meer informatie over SAS [gedeelde handtekeningen voor toegang \(SAS\) in Azure Storage](../storage/common/storage-dotnet-shared-access-signature-part-1.md).</span><span class="sxs-lookup"><span data-stu-id="11a9e-133">For more information about SAS, see [Using shared access signatures \(SAS\) in Azure Storage](../storage/common/storage-dotnet-shared-access-signature-part-1.md).</span></span>

<span data-ttu-id="11a9e-134">Als u een SAS met hello Azure Storage-API's krijgt, retourneert Hallo API een tekenreeks van SAS-token.</span><span class="sxs-lookup"><span data-stu-id="11a9e-134">When you get a SAS using hello Azure Storage APIs, hello API returns a SAS token string.</span></span> <span data-ttu-id="11a9e-135">Deze tekenreeks token bevat alle parameters Hallo SAS, met inbegrip van Hallo machtigingen en hello-interval via welke Hallo SAS geldig is.</span><span class="sxs-lookup"><span data-stu-id="11a9e-135">This token string includes all parameters of hello SAS, including hello permissions and hello interval over which hello SAS is valid.</span></span> <span data-ttu-id="11a9e-136">toouse hello SAS tooaccess een container in Azure Storage, moet u tooappend Hallo SAS-token tekenreeks toohello resource-URI.</span><span class="sxs-lookup"><span data-stu-id="11a9e-136">toouse hello SAS tooaccess a container in Azure Storage, you need tooappend hello SAS token string toohello resource URI.</span></span> <span data-ttu-id="11a9e-137">Hallo resource-URI, samen met de Hallo toegevoegd SAS-token, biedt geverifieerde toegang tooAzure opslag.</span><span class="sxs-lookup"><span data-stu-id="11a9e-137">hello resource URI, together with hello appended SAS token, provides authenticated access tooAzure Storage.</span></span>

<span data-ttu-id="11a9e-138">Hallo volgende voorbeeld ziet u hoe tooget een alleen-schrijven SAS-tekenreeks voor de container Hallo token en vervolgens voegt Hallo SAS toohello container URI:</span><span class="sxs-lookup"><span data-stu-id="11a9e-138">hello following example shows how tooget a write-only SAS token string for hello container, then appends hello SAS toohello container URI:</span></span>

```csharp
string containerSasToken = container.GetSharedAccessSignature(new SharedAccessBlobPolicy()
{
    SharedAccessExpiryTime = DateTimeOffset.UtcNow.AddDays(1),
    Permissions = SharedAccessBlobPermissions.Write
});

string containerSasUrl = container.Uri.AbsoluteUri + containerSasToken; 
```

## <a name="specify-output-files-for-task-output"></a><span data-ttu-id="11a9e-139">Uitvoerbestanden voor de uitvoer van de taak opgeven</span><span class="sxs-lookup"><span data-stu-id="11a9e-139">Specify output files for task output</span></span>

<span data-ttu-id="11a9e-140">een verzameling van de uitvoerbestanden toospecify voor een taak maken [uitvoerbestand](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.outputfile) objecten en toe te wijzen toohello [CloudTask.OutputFiles](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudtask.outputfiles#Microsoft_Azure_Batch_CloudTask_OutputFiles) eigenschap als Hallo-taak gemaakt.</span><span class="sxs-lookup"><span data-stu-id="11a9e-140">toospecify output files for a task, create a collection of [OutputFile](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.outputfile) objects and assign it toohello [CloudTask.OutputFiles](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudtask.outputfiles#Microsoft_Azure_Batch_CloudTask_OutputFiles) property when you create hello task.</span></span> 

<span data-ttu-id="11a9e-141">Hallo volgende .NET codevoorbeeld maakt een taak die u willekeurige getallen tooa bestand met de naam schrijft `output.txt`.</span><span class="sxs-lookup"><span data-stu-id="11a9e-141">hello following .NET code example creates a task that writes random numbers tooa file named `output.txt`.</span></span> <span data-ttu-id="11a9e-142">Hallo voorbeeld maakt u een bestand voor uitvoer voor `output.txt` toobe toohello container geschreven.</span><span class="sxs-lookup"><span data-stu-id="11a9e-142">hello example creates an output file for `output.txt` toobe written toohello container.</span></span> <span data-ttu-id="11a9e-143">Hallo voorbeeld maakt ook uitvoerbestanden voor alle logboekbestanden die overeenkomen met het bestandspatroon Hallo `std*.txt` (_bijvoorbeeld_, `stdout.txt` en `stderr.txt`).</span><span class="sxs-lookup"><span data-stu-id="11a9e-143">hello example also creates output files for any log files that match hello file pattern `std*.txt` (_e.g._, `stdout.txt` and `stderr.txt`).</span></span> <span data-ttu-id="11a9e-144">Hallo container URL vereist eerder Hallo SA's dat is gemaakt voor Hallo-container.</span><span class="sxs-lookup"><span data-stu-id="11a9e-144">hello container URL requires hello SAS that was created previously for hello container.</span></span> <span data-ttu-id="11a9e-145">Hallo Batch-service Hallo SAS tooauthenticate toegang toohello container gebruikt:</span><span class="sxs-lookup"><span data-stu-id="11a9e-145">hello Batch service uses hello SAS tooauthenticate access toohello container:</span></span> 

```csharp
new CloudTask(taskId, "cmd /v:ON /c \"echo off && set && (FOR /L %i IN (1,1,100000) DO (ECHO !RANDOM!)) > output.txt\"")
{
    OutputFiles = new List<OutputFile>
    {
        new OutputFile(
            filePattern: @"..\std*.txt",
            destination: new OutputFileDestination(
         new OutputFileBlobContainerDestination(
                    containerUrl: containerSasUrl,
                    path: taskId)),
            uploadOptions: new OutputFileUploadOptions(
            uploadCondition: OutputFileUploadCondition.TaskCompletion)),
        new OutputFile(
            filePattern: @"output.txt",
            destination: 
         new OutputFileDestination(new OutputFileBlobContainerDestination(
                    containerUrl: containerSasUrl,
                    path: taskId + @"\output.txt")),
            uploadOptions: new OutputFileUploadOptions(
            uploadCondition: OutputFileUploadCondition.TaskCompletion)),
}
```

### <a name="specify-a-file-pattern-for-matching"></a><span data-ttu-id="11a9e-146">Geef een patroon voor overeenkomende</span><span class="sxs-lookup"><span data-stu-id="11a9e-146">Specify a file pattern for matching</span></span>

<span data-ttu-id="11a9e-147">Wanneer u een uitvoerbestand opgeeft, kunt u Hallo [OutputFile.FilePattern](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.outputfile.filepattern#Microsoft_Azure_Batch_OutputFile_FilePattern) eigenschap toospecify een patroon voor overeenkomende.</span><span class="sxs-lookup"><span data-stu-id="11a9e-147">When you specify an output file, you can use hello [OutputFile.FilePattern](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.outputfile.filepattern#Microsoft_Azure_Batch_OutputFile_FilePattern) property toospecify a file pattern for matching.</span></span> <span data-ttu-id="11a9e-148">Hallo bestandspatroon mogelijk overeen met nul bestanden, één bestand of een set bestanden die zijn gemaakt door Hallo-taak.</span><span class="sxs-lookup"><span data-stu-id="11a9e-148">hello file pattern may match zero files, a single file, or a set of files that are created by hello task.</span></span>

<span data-ttu-id="11a9e-149">Hallo **FilePattern** eigenschap ondersteunt standaard bestandssysteem jokertekens zoals `*` (voor niet-recursieve komt overeen met) en `**` (voor recursieve komt overeen met).</span><span class="sxs-lookup"><span data-stu-id="11a9e-149">hello **FilePattern** property supports standard filesystem wildcards such as `*` (for non-recursive matches) and `**` (for recursive matches).</span></span> <span data-ttu-id="11a9e-150">Hallo-codevoorbeeld bovenstaande geeft bijvoorbeeld Hallo bestand patroon toomatch `std*.txt` niet-recursief:</span><span class="sxs-lookup"><span data-stu-id="11a9e-150">For example, hello code sample above specifies hello file pattern toomatch `std*.txt` non-recursively:</span></span> 

`filePattern: @"..\std*.txt"`

<span data-ttu-id="11a9e-151">een bestandspatroon tooupload één bestand opgeven met geen jokertekens.</span><span class="sxs-lookup"><span data-stu-id="11a9e-151">tooupload a single file, specify a file pattern with no wildcards.</span></span> <span data-ttu-id="11a9e-152">Hallo-codevoorbeeld bovenstaande geeft bijvoorbeeld Hallo bestand patroon toomatch `output.txt`:</span><span class="sxs-lookup"><span data-stu-id="11a9e-152">For example, hello code sample above specifies hello file pattern toomatch `output.txt`:</span></span>

`filePattern: @"output.txt"`

### <a name="specify-an-upload-condition"></a><span data-ttu-id="11a9e-153">Geef een voorwaarde uploaden</span><span class="sxs-lookup"><span data-stu-id="11a9e-153">Specify an upload condition</span></span>

<span data-ttu-id="11a9e-154">Hallo [OutputFileUploadOptions.UploadCondition](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.outputfileuploadoptions.uploadcondition#Microsoft_Azure_Batch_OutputFileUploadOptions_UploadCondition) eigenschap toestaat uitvoerbestanden voorwaardelijke worden geüpload.</span><span class="sxs-lookup"><span data-stu-id="11a9e-154">hello [OutputFileUploadOptions.UploadCondition](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.outputfileuploadoptions.uploadcondition#Microsoft_Azure_Batch_OutputFileUploadOptions_UploadCondition) property permits conditional uploading of output files.</span></span> <span data-ttu-id="11a9e-155">Een gebruikelijk scenario is een reeks bestanden als Hallo taak lukt tooupload en een andere set van bestanden als deze uitvalt.</span><span class="sxs-lookup"><span data-stu-id="11a9e-155">A common scenario is tooupload one set of files if hello task succeeds, and a different set of files if it fails.</span></span> <span data-ttu-id="11a9e-156">U kunt de uitgebreide logboekbestanden tooupload bijvoorbeeld wanneer Hallo taak mislukt en wordt afgesloten met de afsluitcode van een andere waarde dan nul.</span><span class="sxs-lookup"><span data-stu-id="11a9e-156">For example, you may want tooupload verbose log files only when hello task fails and exits with a nonzero exit code.</span></span> <span data-ttu-id="11a9e-157">Op deze manier kunt u bestanden met tooupload resultaten alleen als Hallo-taak is voltooid, omdat deze bestanden mogelijk ontbreken of zijn onvolledig als Hallo taak mislukt.</span><span class="sxs-lookup"><span data-stu-id="11a9e-157">Similarly, you may want tooupload result files only if hello task succeeds, as those files may be missing or incomplete if hello task fails.</span></span>

<span data-ttu-id="11a9e-158">Hallo bovenstaande codevoorbeeld ingesteld Hallo **UploadCondition** eigenschap te**TaskCompletion**.</span><span class="sxs-lookup"><span data-stu-id="11a9e-158">hello code sample above sets hello **UploadCondition** property too**TaskCompletion**.</span></span> <span data-ttu-id="11a9e-159">Deze instelling geeft aan dat bestand Hallo toobe nadat Hallo taken is voltooid, ongeacht het Hallo-waarde van de afsluitcode Hallo geüpload.</span><span class="sxs-lookup"><span data-stu-id="11a9e-159">This setting specifies that hello file is toobe uploaded after hello tasks completes, regardless of hello value of hello exit code.</span></span> 

`uploadCondition: OutputFileUploadCondition.TaskCompletion`

<span data-ttu-id="11a9e-160">Zie voor andere instellingen Hallo [OutputFileUploadCondition](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.common.outputfileuploadcondition) enum.</span><span class="sxs-lookup"><span data-stu-id="11a9e-160">For other settings, see hello [OutputFileUploadCondition](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.common.outputfileuploadcondition) enum.</span></span>

### <a name="disambiguate-files-with-hello-same-name"></a><span data-ttu-id="11a9e-161">Bestanden met Hallo heffen dezelfde naam</span><span class="sxs-lookup"><span data-stu-id="11a9e-161">Disambiguate files with hello same name</span></span>

<span data-ttu-id="11a9e-162">Hallo-taken in een taak kunnen leiden tot bestanden die Hallo hebben dezelfde naam.</span><span class="sxs-lookup"><span data-stu-id="11a9e-162">hello tasks in a job may produce files that have hello same name.</span></span> <span data-ttu-id="11a9e-163">Bijvoorbeeld: `stdout.txt` en `stderr.txt` worden gemaakt voor elke taak die in een taak wordt uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="11a9e-163">For example, `stdout.txt` and `stderr.txt` are created for every task that runs in a job.</span></span> <span data-ttu-id="11a9e-164">Omdat elke taak wordt uitgevoerd in een eigen context, zijn deze bestanden niet in conflict op Hallo van het knooppunt bestandssysteem.</span><span class="sxs-lookup"><span data-stu-id="11a9e-164">Because each task runs in its own context, these files don't conflict on hello node's file system.</span></span> <span data-ttu-id="11a9e-165">Tijdens het uploaden van bestanden van meerdere taken tooa gedeelde container hebt u echter toodisambiguate bestanden met Hallo nodig dezelfde naam.</span><span class="sxs-lookup"><span data-stu-id="11a9e-165">However, when you upload files from multiple tasks tooa shared container, you'll need toodisambiguate files with hello same name.</span></span>

<span data-ttu-id="11a9e-166">Hallo [OutputFileBlobContainerDestination.Path](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.outputfileblobcontainerdestination.path#Microsoft_Azure_Batch_OutputFileBlobContainerDestination_Path) -eigenschap geeft op Hallo bestemmings-blob of virtuele map voor uitvoerbestanden.</span><span class="sxs-lookup"><span data-stu-id="11a9e-166">hello [OutputFileBlobContainerDestination.Path](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.outputfileblobcontainerdestination.path#Microsoft_Azure_Batch_OutputFileBlobContainerDestination_Path) property specifies hello destination blob or virtual directory for output files.</span></span> <span data-ttu-id="11a9e-167">U kunt Hallo **pad** eigenschap tooname Hallo blob of virtuele map zodanig dat de uitvoerbestanden Hello dezelfde naam een unieke naam op basis van Azure Storage.</span><span class="sxs-lookup"><span data-stu-id="11a9e-167">You can use hello **Path** property tooname hello blob or virtual directory in such a way that output files with hello same name are uniquely named in Azure Storage.</span></span> <span data-ttu-id="11a9e-168">Hallo taak-ID in het Hallo-pad is een uitstekende manier tooensure unieke namen en eenvoudig bestanden te identificeren.</span><span class="sxs-lookup"><span data-stu-id="11a9e-168">Using hello task ID in hello path is a good way tooensure unique names and easily identify files.</span></span>

<span data-ttu-id="11a9e-169">Als hello **FilePattern** eigenschap tooa de jokertekenexpressie is ingesteld, wordt alle bestanden die overeenkomen met Hallo patroon zijn geüploade toohello virtuele map die is opgegeven door Hallo **pad** eigenschap.</span><span class="sxs-lookup"><span data-stu-id="11a9e-169">If hello **FilePattern** property is set tooa wildcard expression, then all files that match hello pattern are uploaded toohello virtual directory specified by hello **Path** property.</span></span> <span data-ttu-id="11a9e-170">Bijvoorbeeld, als hello container is `mycontainer`, Hallo-taak-ID is `mytask`, en het bestandspatroon Hallo `..\std*.txt`, vervolgens Hallo absolute URI's toohello uitvoerbestanden in Azure Storage vergelijkbaar met is:</span><span class="sxs-lookup"><span data-stu-id="11a9e-170">For example, if hello container is `mycontainer`, hello task ID is `mytask`, and hello file pattern is `..\std*.txt`, then hello absolute URIs toohello output files in Azure Storage will be similar to:</span></span>

```
https://myaccount.blob.core.windows.net/mycontainer/mytask/stderr.txt
https://myaccount.blob.core.windows.net/mycontainer/mytask/stdout.txt
```

<span data-ttu-id="11a9e-171">Als hello **FilePattern** eigenschap set toomatch één bestandsnaam, wat betekent dat deze geen jokertekens bevat geen waarde van Hallo vervolgens Hallo **pad** -eigenschap geeft op Hallo volledig gekwalificeerde blob-naam .</span><span class="sxs-lookup"><span data-stu-id="11a9e-171">If hello **FilePattern** property is set toomatch a single file name, meaning it does not contain any wildcard characters, then hello value of hello **Path** property specifies hello fully qualified blob name.</span></span> <span data-ttu-id="11a9e-172">Als u naamconflicten met één bestand uit meerdere taken verwacht, neem Hallo-naam van de virtuele map Hallo als onderdeel van Hallo bestand naam toodisambiguate die bestanden.</span><span class="sxs-lookup"><span data-stu-id="11a9e-172">If you anticipate naming conflicts with a single file from multiple tasks, then include hello name of hello virtual directory as part of hello file name toodisambiguate those files.</span></span> <span data-ttu-id="11a9e-173">Bijvoorbeeld: set Hallo **pad** eigenschap tooinclude Hallo taak-ID, Hallo scheidingsteken (meestal een slash) en Hallo-bestandsnaam:</span><span class="sxs-lookup"><span data-stu-id="11a9e-173">For example, set hello **Path** property tooinclude hello task ID, hello delimiter character (typically a forward slash), and hello file name:</span></span>

`path: taskId + @"/output.txt"`

<span data-ttu-id="11a9e-174">Hallo absolute URI's toohello uitvoerbestanden voor een aantal taken zijn vergelijkbaar met:</span><span class="sxs-lookup"><span data-stu-id="11a9e-174">hello absolute URIs toohello output files for a set of tasks will be similar to:</span></span>

```
https://myaccount.blob.core.windows.net/mycontainer/task1/output.txt
https://myaccount.blob.core.windows.net/mycontainer/task2/output.txt
```

<span data-ttu-id="11a9e-175">Zie voor meer informatie over virtuele mappen in Azure Storage [lijst Hallo blobs in een container](../storage/blobs/storage-dotnet-how-to-use-blobs.md#list-the-blobs-in-a-container).</span><span class="sxs-lookup"><span data-stu-id="11a9e-175">For more information about virtual directories in Azure Storage, see [List hello blobs in a container](../storage/blobs/storage-dotnet-how-to-use-blobs.md#list-the-blobs-in-a-container).</span></span>


## <a name="diagnose-file-upload-errors"></a><span data-ttu-id="11a9e-176">Bestand uploadfouten opsporen</span><span class="sxs-lookup"><span data-stu-id="11a9e-176">Diagnose file upload errors</span></span>

<span data-ttu-id="11a9e-177">Als uitvoer uploaden van bestanden tooAzure opslag mislukt Hallo taak en gaat vervolgens toohello **voltooid** status en Hallo [TaskExecutionInformation.FailureInformation](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.taskexecutioninformation.failureinformation#Microsoft_Azure_Batch_TaskExecutionInformation_FailureInformation) eigenschap is ingesteld.</span><span class="sxs-lookup"><span data-stu-id="11a9e-177">If uploading output files tooAzure Storage fails, then hello task moves toohello **Completed** state and hello [TaskExecutionInformation.FailureInformation](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.taskexecutioninformation.failureinformation#Microsoft_Azure_Batch_TaskExecutionInformation_FailureInformation) property is set.</span></span> <span data-ttu-id="11a9e-178">Hallo onderzoeken **FailureInformation** eigenschap toodetermine welke fout is opgetreden.</span><span class="sxs-lookup"><span data-stu-id="11a9e-178">Examine hello **FailureInformation** property toodetermine what error occurred.</span></span> <span data-ttu-id="11a9e-179">Dit is bijvoorbeeld een fout die tijdens het bestand uploaden optreedt als Hallo container kan niet worden gevonden:</span><span class="sxs-lookup"><span data-stu-id="11a9e-179">For example, here is an error that occurs on file upload if hello container cannot be found:</span></span> 

```
Category: UserError
Code: FileUploadContainerNotFound
Message: One of hello specified Azure container(s) was not found while attempting tooupload an output file
```

<span data-ttu-id="11a9e-180">Op elke uploaden bestand Batch schrijft twee bestanden toohello rekenknooppunt, meld `fileuploadout.txt` en `fileuploaderr.txt`.</span><span class="sxs-lookup"><span data-stu-id="11a9e-180">On every file upload, Batch writes two log files toohello compute node, `fileuploadout.txt` and `fileuploaderr.txt`.</span></span> <span data-ttu-id="11a9e-181">U kunt deze informatie over een specifieke fout logboek bestanden toolearn onderzoeken.</span><span class="sxs-lookup"><span data-stu-id="11a9e-181">You can examine these log files toolearn more about a specific failure.</span></span> <span data-ttu-id="11a9e-182">In gevallen waarbij Hallo-bestand uploaden is nooit uitgevoerd, bijvoorbeeld omdat het Hallo-taak zelf kan niet worden uitgevoerd, klikt u vervolgens bestaat deze logboekbestanden niet.</span><span class="sxs-lookup"><span data-stu-id="11a9e-182">In cases where hello file upload was never attempted, for example because hello task itself couldn’t run, then these log files will not exist.</span></span>

## <a name="diagnose-file-upload-performance"></a><span data-ttu-id="11a9e-183">Bestand uploaden van prestaties vaststellen</span><span class="sxs-lookup"><span data-stu-id="11a9e-183">Diagnose file upload performance</span></span>

<span data-ttu-id="11a9e-184">Hallo `fileuploadout.txt` bestand uploadvoortgang registreert.</span><span class="sxs-lookup"><span data-stu-id="11a9e-184">hello `fileuploadout.txt` file logs upload progress.</span></span> <span data-ttu-id="11a9e-185">U kunt dit bestand toolearn meer informatie over hoe lang het bestand uploadt duurt onderzoeken.</span><span class="sxs-lookup"><span data-stu-id="11a9e-185">You can examine this file toolearn more about how long your file uploads are taking.</span></span> <span data-ttu-id="11a9e-186">Houd er rekening mee dat er veel factoren tooupload prestaties zijn, waaronder Hallo grootte van andere activiteiten op Hallo knooppunt Hallo gelijktijdig met het uploaden van het Hallo-Hallo knooppunt of Hallo doelcontainer in Hallo dezelfde regio bevinden als de Batch-pool hello, hoeveel knooppunten zijn uploaden van de opslagaccount toohello op Hallo dezelfde tijd, enzovoort.</span><span class="sxs-lookup"><span data-stu-id="11a9e-186">Keep in mind that there are many contributing factors tooupload performance, including hello size of hello node, other activity on hello node at hello time of hello upload, whether hello target container is in hello same region as hello Batch pool, how many nodes are uploading toohello storage account at hello same time, and so on.</span></span>

## <a name="use-hello-batch-service-api-with-hello-batch-file-conventions-standard"></a><span data-ttu-id="11a9e-187">Hallo Batch-service API Hello Batch bestand conventies standaard gebruiken</span><span class="sxs-lookup"><span data-stu-id="11a9e-187">Use hello Batch service API with hello Batch File Conventions standard</span></span>

<span data-ttu-id="11a9e-188">Wanneer u de uitvoer van de taak met Batch-service API Hallo zich blijven voordoen, kunt u uw doelcontainer kunt naam en gewenste echter blobs.</span><span class="sxs-lookup"><span data-stu-id="11a9e-188">When you persist task output with hello Batch service API, you can name your destination container and blobs however you like.</span></span> <span data-ttu-id="11a9e-189">U kunt ook tooname ze volgens toohello [Batch bestand conventies standaard](https://github.com/Azure/azure-sdk-for-net/tree/vs17Dev/src/SDKs/Batch/Support/FileConventions#conventions).</span><span class="sxs-lookup"><span data-stu-id="11a9e-189">You can also choose tooname them according toohello [Batch File Conventions standard](https://github.com/Azure/azure-sdk-for-net/tree/vs17Dev/src/SDKs/Batch/Support/FileConventions#conventions).</span></span> <span data-ttu-id="11a9e-190">Hallo bestand conventies standaard bepaalt Hallo namen van de doelcontainer Hallo en voor een bepaalde uitvoerbestand op basis van Hallo namen van de taak hello en in Azure Storage-blob.</span><span class="sxs-lookup"><span data-stu-id="11a9e-190">hello File Conventions standard determines hello names of hello destination container and blob in Azure Storage for a given output file based on hello names of hello job and task.</span></span> <span data-ttu-id="11a9e-191">Als u Hallo bestand conventies standaard gebruikt voor het benoemen van uitvoerbestanden, wordt de uitvoerbestanden beschikbaar voor weergave in Hallo zijn [Azure-portal](https://portal.azure.com).</span><span class="sxs-lookup"><span data-stu-id="11a9e-191">If you do use hello File Conventions standard for naming output files, then your output files are available for viewing in hello [Azure portal](https://portal.azure.com).</span></span>

<span data-ttu-id="11a9e-192">Als u in C# ontwikkelt, kunt u Hallo-methoden die zijn ingebouwd in Hallo [bestand conventies van Batch-bibliotheek voor .NET](https://www.nuget.org/packages/Microsoft.Azure.Batch.Conventions.Files).</span><span class="sxs-lookup"><span data-stu-id="11a9e-192">If you are developing in C#, you can use hello methods built into hello [Batch File Conventions library for .NET](https://www.nuget.org/packages/Microsoft.Azure.Batch.Conventions.Files).</span></span> <span data-ttu-id="11a9e-193">Deze bibliotheek maakt Hallo goed containers en blobs paden voor u met de naam.</span><span class="sxs-lookup"><span data-stu-id="11a9e-193">This library creates hello properly named containers and blob paths for you.</span></span> <span data-ttu-id="11a9e-194">U kunt bijvoorbeeld Hallo API tooget Hallo juiste naam voor het Hallo-container, op basis van de taaknaam Hallo aanroepen:</span><span class="sxs-lookup"><span data-stu-id="11a9e-194">For example, you can call hello API tooget hello correct name for hello container, based on hello job name:</span></span>

```csharp
string containerName = job.OutputStorageContainerName();
```

<span data-ttu-id="11a9e-195">U kunt Hallo [CloudJobExtensions.GetOutputStorageContainerUrl](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.conventions.files.cloudjobextensions.getoutputstoragecontainerurl) tooreturn methode een shared access signature (SAS)-URL die gebruikte toowrite toohello container is.</span><span class="sxs-lookup"><span data-stu-id="11a9e-195">You can use hello [CloudJobExtensions.GetOutputStorageContainerUrl](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.conventions.files.cloudjobextensions.getoutputstoragecontainerurl) method tooreturn a shared access signature (SAS) URL that is used toowrite toohello container.</span></span> <span data-ttu-id="11a9e-196">Vervolgens kunt u deze SAS-toohello doorgeven [OutputFileBlobContainerDestination](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.outputfileblobcontainerdestination) constructor.</span><span class="sxs-lookup"><span data-stu-id="11a9e-196">You can then pass this SAS toohello [OutputFileBlobContainerDestination](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.outputfileblobcontainerdestination) constructor.</span></span>

<span data-ttu-id="11a9e-197">Als u in een andere taal dan C# ontwikkelt, moet u tooimplement Hallo bestand conventies standaard zelf.</span><span class="sxs-lookup"><span data-stu-id="11a9e-197">If you are developing in a language other than C#, you will need tooimplement hello File Conventions standard yourself.</span></span>

## <a name="code-sample"></a><span data-ttu-id="11a9e-198">Codevoorbeeld</span><span class="sxs-lookup"><span data-stu-id="11a9e-198">Code sample</span></span>

<span data-ttu-id="11a9e-199">Hallo [PersistOutputs] [ github_persistoutputs] voorbeeldproject is een van de Hallo [Azure Batch-codevoorbeelden] [ github_samples] op GitHub.</span><span class="sxs-lookup"><span data-stu-id="11a9e-199">hello [PersistOutputs][github_persistoutputs] sample project is one of hello [Azure Batch code samples][github_samples] on GitHub.</span></span> <span data-ttu-id="11a9e-200">Deze Visual Studio-oplossing laat zien hoe toouse Hallo Batch-clientbibliotheek voor .NET toopersist taak toodurable opslag uitvoer.</span><span class="sxs-lookup"><span data-stu-id="11a9e-200">This Visual Studio solution demonstrates how toouse hello Batch client library for .NET toopersist task output toodurable storage.</span></span> <span data-ttu-id="11a9e-201">toorun hello steekproef, als volgt te werk:</span><span class="sxs-lookup"><span data-stu-id="11a9e-201">toorun hello sample, follow these steps:</span></span>

1. <span data-ttu-id="11a9e-202">Open Hallo-project in **Visual Studio 2015 of hoger**.</span><span class="sxs-lookup"><span data-stu-id="11a9e-202">Open hello project in **Visual Studio 2015 or newer**.</span></span>
2. <span data-ttu-id="11a9e-203">Toevoegen van uw Batch- en Storage **accountreferenties** te**AccountSettings.settings** hello Microsoft.Azure.Batch.Samples.Common project.</span><span class="sxs-lookup"><span data-stu-id="11a9e-203">Add your Batch and Storage **account credentials** too**AccountSettings.settings** in hello Microsoft.Azure.Batch.Samples.Common project.</span></span>
3. <span data-ttu-id="11a9e-204">**Bouwen** (maar niet worden uitgevoerd) Hallo oplossing.</span><span class="sxs-lookup"><span data-stu-id="11a9e-204">**Build** (but do not run) hello solution.</span></span> <span data-ttu-id="11a9e-205">Herstel alle NuGet-pakketten als daarom wordt gevraagd.</span><span class="sxs-lookup"><span data-stu-id="11a9e-205">Restore any NuGet packages if prompted.</span></span>
4. <span data-ttu-id="11a9e-206">Gebruik hello Azure portal tooupload een [toepassingspakket](batch-application-packages.md) voor **PersistOutputsTask**.</span><span class="sxs-lookup"><span data-stu-id="11a9e-206">Use hello Azure portal tooupload an [application package](batch-application-packages.md) for **PersistOutputsTask**.</span></span> <span data-ttu-id="11a9e-207">Hallo omvatten `PersistOutputsTask.exe` en afhankelijke assembly's in Hallo ZIP-pakket, set Hallo toepassings-ID te 'PersistOutputsTask' en de toepassing hello Pakketversie te "1.0".</span><span class="sxs-lookup"><span data-stu-id="11a9e-207">Include hello `PersistOutputsTask.exe` and its dependent assemblies in hello .zip package, set hello application ID too"PersistOutputsTask", and hello application package version too"1.0".</span></span>
5. <span data-ttu-id="11a9e-208">**Start** (uitvoeren) Hallo **PersistOutputs** project.</span><span class="sxs-lookup"><span data-stu-id="11a9e-208">**Start** (run) hello **PersistOutputs** project.</span></span>
6. <span data-ttu-id="11a9e-209">Wanneer de vraag toochoose Hallo persistentie technologie toouse voor actieve Hallo voorbeeld invoert **2** toorun Hallo voorbeeld met behulp van de uitvoer van de taak toopersist Hallo API van Batch-service.</span><span class="sxs-lookup"><span data-stu-id="11a9e-209">When prompted toochoose hello persistence technology toouse for running hello sample, enter **2** toorun hello sample using hello Batch service API toopersist task output.</span></span>
7. <span data-ttu-id="11a9e-210">Indien gewenst, Hallo voorbeeld opnieuw uitvoeren, voeren **3** toopersist uitvoer met Hallo Batch-service API en tooname Hallo-container en blob doelpad volgens toohello bestand conventies standaard.</span><span class="sxs-lookup"><span data-stu-id="11a9e-210">If desired, run hello sample again, entering **3** toopersist output with hello Batch service API, and also tooname hello destination container and blob path according toohello File Conventions standard.</span></span>

## <a name="next-steps"></a><span data-ttu-id="11a9e-211">Volgende stappen</span><span class="sxs-lookup"><span data-stu-id="11a9e-211">Next steps</span></span>

- <span data-ttu-id="11a9e-212">Zie voor meer informatie over persistent maken van de taakuitvoer met Hallo bestand Conventions-bibliotheek voor .NET [behouden van de taak en gegevens tooAzure opslag met Hallo Batch bestand Conventions-bibliotheek voor .NET toopersist ](batch-task-output-file-conventions.md).</span><span class="sxs-lookup"><span data-stu-id="11a9e-212">For more information on persisting task output with hello File Conventions library for .NET, see [Persist job and task data tooAzure Storage with hello Batch File Conventions library for .NET toopersist ](batch-task-output-file-conventions.md).</span></span>
- <span data-ttu-id="11a9e-213">Zie voor informatie over andere benaderingen voor persistent maken uitvoergegevens in Azure Batch, [Persist taak en uitvoer tooAzure opslag](batch-task-output.md).</span><span class="sxs-lookup"><span data-stu-id="11a9e-213">For information on other approaches for persisting output data in Azure Batch, see [Persist job and task output tooAzure Storage](batch-task-output.md).</span></span>

[github_persistoutputs]: https://github.com/Azure/azure-batch-samples/tree/master/CSharp/ArticleProjects/PersistOutputs
[github_samples]: https://github.com/Azure/azure-batch-samples
