---
title: aaaTroubleshoot automatisch geschaald met virtuele-Machineschaalsets | Microsoft Docs
description: Problemen oplossen met virtuele-Machineschaalsets voor automatisch schalen. Typische problemen aangetroffen begrijpen en hoe tooresolve ze.
services: virtual-machine-scale-sets
documentationcenter: 
author: gbowerman
manager: timlt
editor: 
tags: azure-resource-manager
ms.assetid: c7d87b72-ee24-4e52-9377-a42f337f76fa
ms.service: virtual-machine-scale-sets
ms.workload: na
ms.tgt_pltfrm: windows
ms.devlang: na
ms.topic: article
ms.date: 10/28/2016
ms.author: guybo
ms.openlocfilehash: 4c9a70992348d87fb43646421a90a027bf400a17
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 10/06/2017
---
# <a name="troubleshooting-autoscale-with-virtual-machine-scale-sets"></a><span data-ttu-id="37ea4-104">Het oplossen van problemen met virtuele-Machineschaalsets voor automatisch schalen</span><span class="sxs-lookup"><span data-stu-id="37ea4-104">Troubleshooting autoscale with Virtual Machine Scale Sets</span></span>
<span data-ttu-id="37ea4-105">**Probleem** : u hebt gemaakt een infrastructuur voor automatisch schalen in Azure Resource Manager met behulp van de VM-Schaalsets – bijvoorbeeld door het implementeren van een sjabloon als volgt: https://github.com/Azure/azure-quickstart-templates/tree/master/201- vmss-bottle-automatisch schalen: u hebt uw scale-regels gedefinieerd en werkt geweldig, behalve dat ongeacht hoeveel belasting u van Hallo virtuele machines, het automatisch schalen won't.</span><span class="sxs-lookup"><span data-stu-id="37ea4-105">**Problem** – you’ve created an autoscaling infrastructure in Azure Resource Manager using VM Scale Sets –  for example by deploying a template like this: https://github.com/Azure/azure-quickstart-templates/tree/master/201-vmss-bottle-autoscale  – you have your scale rules defined and it works great, except that no matter how much load you put on hello VMs, it won’t autoscale.</span></span>

## <a name="troubleshooting-steps"></a><span data-ttu-id="37ea4-106">Stappen voor probleemoplossing</span><span class="sxs-lookup"><span data-stu-id="37ea4-106">Troubleshooting steps</span></span>
<span data-ttu-id="37ea4-107">Sommige tooconsider dingen omvatten:</span><span class="sxs-lookup"><span data-stu-id="37ea4-107">Some things tooconsider include:</span></span>

* <span data-ttu-id="37ea4-108">Het aantal kernen heeft elke virtuele machine en laadt u elke core? Hello Azure Quickstart voorbeeldsjabloon bovenstaande heeft een script do_work.php, die één kern wordt geladen.</span><span class="sxs-lookup"><span data-stu-id="37ea4-108">How many cores does each VM have, and are you loading each core? hello example Azure Quickstart template above has a do_work.php script, which loads a single core.</span></span> <span data-ttu-id="37ea4-109">Als u een virtuele machine die groter is dan één kern VM-grootte zoals Standard_A1 of D1 en u toorun deze laadbewerking meerdere keren moet.</span><span class="sxs-lookup"><span data-stu-id="37ea4-109">If you’re using a VM bigger than a single core VM size like Standard_A1 or D1 then you’d need toorun this load multiple times.</span></span> <span data-ttu-id="37ea4-110">Controleren hoeveel cores uw virtuele machines aan de hand van [grootten voor Windows virtuele machines in Azure](../virtual-machines/windows/sizes.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json)</span><span class="sxs-lookup"><span data-stu-id="37ea4-110">Check how many cores your VMs by reviewing [Sizes for Windows virtual machines in Azure](../virtual-machines/windows/sizes.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json)</span></span>
* <span data-ttu-id="37ea4-111">Hoeveel virtuele machines in VM-Schaalset, Hallo gaat het werk voor elk criterium?</span><span class="sxs-lookup"><span data-stu-id="37ea4-111">How many VMs in hello VM Scale Set, are you doing work on each one?</span></span>
  
    <span data-ttu-id="37ea4-112">Een scale-out-gebeurtenis wordt alleen plaatsvinden als Hallo gemiddelde CPU-via **alle** Hallo virtuele machines in een set scale Hallo drempelwaarde, gedurende een periode van Hallo interne gedefinieerd in de regels voor automatisch schalen Hallo overschrijdt.</span><span class="sxs-lookup"><span data-stu-id="37ea4-112">A scale out event will only take place when hello average CPU across **all** hello VMs in a scale set exceeds hello threshold value, over hello time internal defined in hello autoscale rules.</span></span>
* <span data-ttu-id="37ea4-113">Hebt u geen gebeurtenissen scale hoofd gezien?</span><span class="sxs-lookup"><span data-stu-id="37ea4-113">Did you miss any scale events?</span></span>
  
    <span data-ttu-id="37ea4-114">Controleer de auditlogboeken Hallo in hello Azure-portal voor scale-gebeurtenissen.</span><span class="sxs-lookup"><span data-stu-id="37ea4-114">Check hello audit logs in hello Azure portal for scale events.</span></span> <span data-ttu-id="37ea4-115">Misschien er is een schaal en een schaal omlaag dat is overgeslagen.</span><span class="sxs-lookup"><span data-stu-id="37ea4-115">Maybe there was a scale up and a scale down which was missed.</span></span> <span data-ttu-id="37ea4-116">U kunt filteren op 'Schaal'...</span><span class="sxs-lookup"><span data-stu-id="37ea4-116">You can filter by “Scale”..</span></span>
  
    ![Controlelogboeken][audit]
* <span data-ttu-id="37ea4-118">De schaal in en scale-out drempelwaarden voldoende verschillend zijn?</span><span class="sxs-lookup"><span data-stu-id="37ea4-118">Are your scale-in and scale-out thresholds sufficiently different?</span></span>
  
    <span data-ttu-id="37ea4-119">Stel dat u een regel tooscale uit wanneer gemiddelde CPU is groter dan 50% meer dan 5 minuten en tooscale instellen in wanneer gemiddelde CPU minder dan 50 is %.</span><span class="sxs-lookup"><span data-stu-id="37ea4-119">Suppose you set a rule tooscale out when average CPU is greater than 50% over 5 minutes, and tooscale in when average CPU is less than 50%.</span></span> <span data-ttu-id="37ea4-120">Hierdoor zou een probleem 'flapping' wanneer het CPU-gebruik is sluiten toothis drempelwaarde, met de schaalacties voortdurend vergroten of verkleinen Hallo grootte van Hallo is ingesteld.</span><span class="sxs-lookup"><span data-stu-id="37ea4-120">This would cause a “flapping” problem when CPU usage is close toothis threshold, with scale actions constantly increasing and decreasing hello size of hello set.</span></span> <span data-ttu-id="37ea4-121">Als gevolg hiervan probeert Hallo automatisch schalen service tooprevent 'op en neer', die licht kunnen als niet schalen.</span><span class="sxs-lookup"><span data-stu-id="37ea4-121">Because of this, hello autoscale service tries tooprevent “flapping”, which can manifest as not scaling.</span></span> <span data-ttu-id="37ea4-122">Controleer daarom dat de drempelwaarden voor scale-out en de schaal zijn voldoende verschillende tooallow vrij Between schalen ruimte.</span><span class="sxs-lookup"><span data-stu-id="37ea4-122">Therefore make sure your scale-out and scale-in thresholds are sufficiently different tooallow some space in between scaling.</span></span>
* <span data-ttu-id="37ea4-123">U uw eigen JSON-sjabloon schrijft?</span><span class="sxs-lookup"><span data-stu-id="37ea4-123">Did you write your own JSON template?</span></span>
  
    <span data-ttu-id="37ea4-124">Is eenvoudig toomake fouten, dus beginnen met een sjabloon zoals Hallo is een waarboven toowork bewezen en klein incrementele wijzigingen aanbrengen.</span><span class="sxs-lookup"><span data-stu-id="37ea4-124">It is easy toomake mistakes, so start with a template like hello one above which is proven toowork, and make small incremental changes.</span></span> 
* <span data-ttu-id="37ea4-125">Kunt u handmatig schalen in- of?</span><span class="sxs-lookup"><span data-stu-id="37ea4-125">Can you manually scale in or out?</span></span>
  
    <span data-ttu-id="37ea4-126">Probeer het opnieuw distribueren Hallo VM-Schaalset resource met een andere 'capaciteit' instelling toochange Hallo aantal virtuele machines handmatig.</span><span class="sxs-lookup"><span data-stu-id="37ea4-126">Try redeploying hello VM Scale Set resource with a different “capacity” setting toochange hello number of VMs manually.</span></span> <span data-ttu-id="37ea4-127">Een voorbeeld van de sjabloon toodo dit hier is: https://github.com/Azure/azure-quickstart-templates/tree/master/201-vmss-scale-existing – mogelijk moet u tooedit Hallo sjabloon toomake ervoor deze Hallo heeft dezelfde machine grootte als uw Schaalset wordt gebruikt.</span><span class="sxs-lookup"><span data-stu-id="37ea4-127">An example template toodo this is here: https://github.com/Azure/azure-quickstart-templates/tree/master/201-vmss-scale-existing – you may need tooedit hello template toomake sure it has hello same machine size as your Scale Set is using.</span></span> <span data-ttu-id="37ea4-128">Als u het aantal virtuele machines Hallo is handmatig wijzigen kunt, weet u Hallo probleem is geïsoleerd tooautoscale.</span><span class="sxs-lookup"><span data-stu-id="37ea4-128">If you can successfully change hello number of VMs manually, then you know hello problem is isolated tooautoscale.</span></span>
* <span data-ttu-id="37ea4-129">Controleer uw Microsoft.Compute/virtualMachineScaleSet en Microsoft.Insights resources Hallo [Azure Resource Explorer](https://resources.azure.com/)</span><span class="sxs-lookup"><span data-stu-id="37ea4-129">Check your Microsoft.Compute/virtualMachineScaleSet, and Microsoft.Insights resources in hello [Azure Resource Explorer](https://resources.azure.com/)</span></span>
  
    <span data-ttu-id="37ea4-130">Dit is een beslist hulpprogramma waarin u kunt zien voor probleemoplossing Hallo van uw Azure Resource Manager-resources.</span><span class="sxs-lookup"><span data-stu-id="37ea4-130">This is an indispensable troubleshooting tool which shows you hello state of your Azure Resource Manager resources.</span></span> <span data-ttu-id="37ea4-131">Klik op uw abonnement en bekijkt hello resourcegroep die u wilt oplossen.</span><span class="sxs-lookup"><span data-stu-id="37ea4-131">Click on your subscription and look at hello Resource Group you are troubleshooting.</span></span> <span data-ttu-id="37ea4-132">Bij de Hallo Compute resourceprovider bekijkt hello VM-Schaalset u hebt gemaakt en controleer Hallo Instantieweergave waarin de status van een implementatie Hallo.</span><span class="sxs-lookup"><span data-stu-id="37ea4-132">Under hello Compute resource provider look at hello VM Scale Set you created and check hello Instance View, which shows you hello state of a deployment.</span></span> <span data-ttu-id="37ea4-133">Instantieweergave van virtuele machines in VM-Schaalset Hallo Hallo ook controleren.</span><span class="sxs-lookup"><span data-stu-id="37ea4-133">Also check hello instance view of VMs in hello VM Scale Set.</span></span> <span data-ttu-id="37ea4-134">Vervolgens gaat u naar Hallo Microsoft.Insights resourceprovider en controleer Hallo automatisch schalen regels goed.</span><span class="sxs-lookup"><span data-stu-id="37ea4-134">Then go into hello Microsoft.Insights resource provider and check hello autoscale rules look good.</span></span>
* <span data-ttu-id="37ea4-135">Is Hallo diagnostische extensie werkt en prestatiegegevens verzenden?</span><span class="sxs-lookup"><span data-stu-id="37ea4-135">Is hello Diagnostic extension working and emitting performance data?</span></span>
  
    <span data-ttu-id="37ea4-136">**Update:** Azure automatisch schalen is verbeterde toouse pijplijn van metrische gegevens die niet langer een diagnostics extensie toobe geïnstalleerd vereist op basis van een host.</span><span class="sxs-lookup"><span data-stu-id="37ea4-136">**Update:** Azure autoscale has been enhanced toouse a host based metrics pipeline which no longer requires a diagnostics extension toobe installed.</span></span> <span data-ttu-id="37ea4-137">Dit betekent dat Hallo komende leden niet langer van toepassing als u een toepassing automatisch schalen op basis van de nieuwe pijplijn Hallo maakt.</span><span class="sxs-lookup"><span data-stu-id="37ea4-137">This means hello next few paragraphs no longer apply if you create an autoscaling application using hello new pipeline.</span></span> <span data-ttu-id="37ea4-138">Een voorbeeld van Azure-sjablonen die geconverteerd toouse Hallo host pijplijn zijn is: https://github.com/Azure/azure-quickstart-templates/tree/master/201-vmss-bottle-autoscale.</span><span class="sxs-lookup"><span data-stu-id="37ea4-138">An example of Azure templates which have been converted toouse hello host pipeline is: https://github.com/Azure/azure-quickstart-templates/tree/master/201-vmss-bottle-autoscale.</span></span> 
  
    <span data-ttu-id="37ea4-139">Met behulp van de host op basis van metrische gegevens voor automatisch schalen is beter geschikt voor Hallo volgende redenen:</span><span class="sxs-lookup"><span data-stu-id="37ea4-139">Using host based metrics for autoscale is better for hello following reasons:</span></span>
  
  * <span data-ttu-id="37ea4-140">Minder bewegende onderdelen als er worden geen extensies diagnostics moeten toobe geïnstalleerd.</span><span class="sxs-lookup"><span data-stu-id="37ea4-140">Fewer moving parts as no diagnostics extensions need toobe installed.</span></span>
  * <span data-ttu-id="37ea4-141">Eenvoudiger sjablonen.</span><span class="sxs-lookup"><span data-stu-id="37ea4-141">Simpler templates.</span></span> <span data-ttu-id="37ea4-142">Alleen toe te voegen insights automatisch schalen regels tooan bestaande schaalset sjabloon.</span><span class="sxs-lookup"><span data-stu-id="37ea4-142">Just add insights autoscale rules tooan existing scale set template.</span></span>
  * <span data-ttu-id="37ea4-143">Betrouwbaarder rapportage en snellere starten van de nieuwe virtuele machines.</span><span class="sxs-lookup"><span data-stu-id="37ea4-143">More reliable reporting and faster launching of new VMs.</span></span>
    
    <span data-ttu-id="37ea4-144">Hallo zou alleen redenen dat kunt u met behulp van een extensie voor diagnostische tookeep zijn als u geheugen diagnostics reporting/schalen moet.</span><span class="sxs-lookup"><span data-stu-id="37ea4-144">hello only reasons you might want tookeep using a diagnostic extension would be if you need memory diagnostics reporting/scaling.</span></span> <span data-ttu-id="37ea4-145">Host op basis van metrische gegevens rapporteren niet geheugen.</span><span class="sxs-lookup"><span data-stu-id="37ea4-145">Host based metrics doesn't report memory.</span></span>
    
    <span data-ttu-id="37ea4-146">Met daarom alleen volgen Hallo rest van dit artikel als u nog steeds diagnostische uitbreidingen voor uw automatisch schalen.</span><span class="sxs-lookup"><span data-stu-id="37ea4-146">With that in mind, only follow hello rest of this article if you are still using diagnostic extensions for your autoscaling.</span></span>
    
    <span data-ttu-id="37ea4-147">Automatisch schalen in Azure Resource Manager kunt werken (maar niet meer heeft tot) met behulp van een VM-extensie aangeroepen Hallo extensie voor diagnostische gegevens.</span><span class="sxs-lookup"><span data-stu-id="37ea4-147">Autoscale in Azure Resource Manager can work (but no longer has to) by means of a VM extension called hello Diagnostics Extension.</span></span> <span data-ttu-id="37ea4-148">Hiermee plaatst u de prestaties gegevens tooa opslagaccount die u in de sjabloon Hallo definiëren.</span><span class="sxs-lookup"><span data-stu-id="37ea4-148">It emits performance data tooa storage account you define in hello template.</span></span> <span data-ttu-id="37ea4-149">Deze gegevens wordt vervolgens door hello Azure Monitor-service geaggregeerd.</span><span class="sxs-lookup"><span data-stu-id="37ea4-149">This data is then aggregated by hello Azure Monitor service.</span></span>
    
    <span data-ttu-id="37ea4-150">Als Hallo Insights-service kan geen gegevens uit Hallo virtuele machines lezen, het toosend moet u een e-mailbericht: bijvoorbeeld als Hallo VM's zijn, Controleer dus uw e-mailadres (hello een hebt opgegeven toen u hello Azure-account).</span><span class="sxs-lookup"><span data-stu-id="37ea4-150">If hello Insights service can’t read data from hello VMs, it is supposed toosend you an email – for example if hello VMs were down, so check your email (hello one you specified when creating hello Azure account).</span></span>
    
    <span data-ttu-id="37ea4-151">U kunt ook gaan en bekijkt hello gegevens zelf.</span><span class="sxs-lookup"><span data-stu-id="37ea4-151">You can also go and look at hello data yourself.</span></span> <span data-ttu-id="37ea4-152">Bekijkt hello Azure storage-account met behulp van een cloud explorer.</span><span class="sxs-lookup"><span data-stu-id="37ea4-152">Look at hello Azure storage account using a cloud explorer.</span></span> <span data-ttu-id="37ea4-153">Bijvoorbeeld met behulp van Hallo [Visual Studio Cloud Explorer](https://visualstudiogallery.msdn.microsoft.com/aaef6e67-4d99-40bc-aacf-662237db85a2), aanmelden en hello Azure-abonnement u kiest en Hallo naam waarnaar wordt verwezen in Hallo uitbreidingsdefinitie diagnostische gegevens in uw implementatie opslagaccount voor diagnostische gegevens sjabloon...</span><span class="sxs-lookup"><span data-stu-id="37ea4-153">For example using hello [Visual Studio Cloud Explorer](https://visualstudiogallery.msdn.microsoft.com/aaef6e67-4d99-40bc-aacf-662237db85a2), log in and pick hello Azure subscription you’re using, and hello Diagnostics storage account name referenced in hello Diagnostics extension definition in your deployment template..</span></span>
    
    ![Cloud Explorer][explorer]
    
    <span data-ttu-id="37ea4-155">Hier ziet u een aantal tabellen waarbij Hallo gegevens van elke virtuele machine worden opgeslagen.</span><span class="sxs-lookup"><span data-stu-id="37ea4-155">Here you will see a bunch of tables where hello data from each VM is being stored.</span></span> <span data-ttu-id="37ea4-156">Linux- en Hallo CPU metriek als voorbeeld duurt, de meest recente rijen Hallo bekijken.</span><span class="sxs-lookup"><span data-stu-id="37ea4-156">Taking Linux and hello CPU metric as an example, look at hello most recent rows.</span></span> <span data-ttu-id="37ea4-157">Hallo Visual Studio cloud explorer biedt ondersteuning voor een querytaal zodat u kunt een query zoals uitvoeren ' tijdstempel gt datetime'2016-02-02T21:20:00Z' ' toomake zeker dat u de meest recente gebeurtenissen hello (uitgaan van tijd in UTC).</span><span class="sxs-lookup"><span data-stu-id="37ea4-157">hello Visual Studio cloud explorer supports a query language so you can run a query like “Timestamp gt datetime’2016-02-02T21:20:00Z’” toomake sure you get hello most recent events (assume time is in UTC).</span></span> <span data-ttu-id="37ea4-158">Schaalt Hallo-gegevens die u ziet in er overeenkomen toohello regels die u instelt?</span><span class="sxs-lookup"><span data-stu-id="37ea4-158">Does hello data you see in there correspond toohello scale rules you set up?</span></span> <span data-ttu-id="37ea4-159">Hallo onderstaand voorbeeld Hallo CPU voor machine 20 gestart too100% verhogen via Hallo laatste vijf minuten...</span><span class="sxs-lookup"><span data-stu-id="37ea4-159">In hello example below, hello CPU for machine 20 started increasing too100% over hello last 5 minutes..</span></span>
    
    ![Storage-tabellen][tables]
    
    <span data-ttu-id="37ea4-161">Als er geen Hallo gegevens aanwezig is, vervolgens wordt verwezen naar Hallo probleem is met diagnostische Hallo-extensie uitgevoerd in de Hallo virtuele machines.</span><span class="sxs-lookup"><span data-stu-id="37ea4-161">If hello data is not there, then it implies hello problem is with hello diagnostic extension running in hello VMs.</span></span> <span data-ttu-id="37ea4-162">Als Hallo gegevens aanwezig is, betekent dit dat er is een probleem met uw scale-regels of met Hallo Insights-service.</span><span class="sxs-lookup"><span data-stu-id="37ea4-162">If hello data is there, it implies there is either a problem with your scale rules, or with hello Insights service.</span></span> <span data-ttu-id="37ea4-163">Controleer [Azure Status](https://azure.microsoft.com/status/).</span><span class="sxs-lookup"><span data-stu-id="37ea4-163">Check [Azure Status](https://azure.microsoft.com/status/).</span></span>
    
    <span data-ttu-id="37ea4-164">Zodra u via deze stappen zijn hebt als u steeds problemen automatisch schalen die nog u kan probeert Hallo forums [MSDN](https://social.msdn.microsoft.com/forums/azure/home?category=windowsazureplatform%2Cazuremarketplace%2Cwindowsazureplatformctp), of [Stack-overloop](http://stackoverflow.com/questions/tagged/azure), of in te loggen van een aanroep van ondersteuning.</span><span class="sxs-lookup"><span data-stu-id="37ea4-164">Once you’ve been through these steps, if you are still having autoscale problems you could try hello forums on [MSDN](https://social.msdn.microsoft.com/forums/azure/home?category=windowsazureplatform%2Cazuremarketplace%2Cwindowsazureplatformctp), or [Stack overflow](http://stackoverflow.com/questions/tagged/azure), or log a support call.</span></span> <span data-ttu-id="37ea4-165">Worden voorbereid tooshare Hallo sjabloon en een weergave van Hallo prestatiegegevens.</span><span class="sxs-lookup"><span data-stu-id="37ea4-165">Be prepared tooshare hello template and a view of hello performance data.</span></span>

[audit]: ./media/virtual-machine-scale-sets-troubleshoot/image3.png
[explorer]: ./media/virtual-machine-scale-sets-troubleshoot/image1.png
[tables]: ./media/virtual-machine-scale-sets-troubleshoot/image4.png
