---
title: Werken met grote Azure Virtual Machine Scale Sets | Microsoft Docs
description: Wat u moet weten wanneer u grote Azure-virtuele-machineschaalsets wilt gaan gebruiken
services: virtual-machine-scale-sets
documentationcenter: 
author: gbowerman
manager: timlt
editor: 
tags: azure-resource-manager
ms.assetid: 76ac7fd7-2e05-4762-88ca-3b499e87906e
ms.service: virtual-machine-scale-sets
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: get-started-article
ms.date: 2/7/2017
ms.author: guybo
ms.openlocfilehash: 9e9eae1623e55c1c05e97aa0b836819ce5dc16f9
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 08/03/2017
---
# <a name="working-with-large-virtual-machine-scale-sets"></a><span data-ttu-id="00e9b-103">Werken met grote virtuele-machineschaalsets</span><span class="sxs-lookup"><span data-stu-id="00e9b-103">Working with large virtual machine scale sets</span></span>
<span data-ttu-id="00e9b-104">U kunt nu Azure-[virtuele-machineschaalsets](/azure/virtual-machine-scale-sets/) maken met een capaciteit van maximaal 1000 virtuele machines.</span><span class="sxs-lookup"><span data-stu-id="00e9b-104">You can now create Azure [virtual machine scale sets](/azure/virtual-machine-scale-sets/) with a capacity of up to 1,000 VMs.</span></span> <span data-ttu-id="00e9b-105">In dit document wordt een _grote virtuele-machineschaalset_ gedefinieerd als een schaalset waarmee u kunt schalen tot meer dan 100 virtuele machines.</span><span class="sxs-lookup"><span data-stu-id="00e9b-105">In this document, a _large virtual machine scale set_ is defined as a scale set capable of scaling to greater than 100 VMs.</span></span> <span data-ttu-id="00e9b-106">Deze mogelijkheid wordt ingesteld met een schaalseteigenschap (_singlePlacementGroup=False_).</span><span class="sxs-lookup"><span data-stu-id="00e9b-106">This capability is set by a scale set property (_singlePlacementGroup=False_).</span></span> 

<span data-ttu-id="00e9b-107">Bepaalde aspecten van grote schaalsets, zoals taakverdeling en foutdomeinen, werken anders dan in een standaardschaalset.</span><span class="sxs-lookup"><span data-stu-id="00e9b-107">Certain aspects of large scale sets, such as load balancing and fault domains behave differently to a standard scale set.</span></span> <span data-ttu-id="00e9b-108">In dit document worden de kenmerken van grote schaalsets uitgelegd en wordt beschreven wat u moet weten om ze in uw toepassingen te gebruiken.</span><span class="sxs-lookup"><span data-stu-id="00e9b-108">This document explains the characteristics of large scale sets, and describes what you need to know to successfully use them in your applications.</span></span> 

<span data-ttu-id="00e9b-109">Een algemene aanpak voor de implementatie van een grootschalige cloudinfrastructuur is het maken van een reeks _schaaleenheden_, bijvoorbeeld door meerdere virtuele-machineschaalsets op meerdere VNETs en opslagaccounts te maken.</span><span class="sxs-lookup"><span data-stu-id="00e9b-109">A common approach for deploying cloud infrastructure at large scale is to create a set of _scale units_, for example by creating multiple VMs scale sets across multiple VNETs and storage accounts.</span></span> <span data-ttu-id="00e9b-110">Deze aanpak is eenvoudiger te beheren dan enkelvoudige virtuele machines, en meerdere schaaleenheden zijn nuttig voor veel toepassingen, met name voor toepassingen die ook andere stapelbare onderdelen nodig hebben, zoals meerdere virtuele netwerken en eindpunten.</span><span class="sxs-lookup"><span data-stu-id="00e9b-110">This approach provides easier management compared to single VMs, and multiple scale units are useful for many applications, particularly those that require other stackable components like multiple virtual networks and endpoints.</span></span> <span data-ttu-id="00e9b-111">Als uw toepassing echter een groot cluster nodig heeft, is het misschien eenvoudiger om één schaalset van maximaal 1000 virtuele machines te implementeren.</span><span class="sxs-lookup"><span data-stu-id="00e9b-111">If your application requires a single large cluster however, it can be more straightforward to deploy a single scale set of up to 1,000 VMs.</span></span> <span data-ttu-id="00e9b-112">Voorbeeldscenario's zijn gecentraliseerde big data-implementaties, of rekenrasters die een eenvoudig beheer van een grote groep werkrolknooppunten vereisen.</span><span class="sxs-lookup"><span data-stu-id="00e9b-112">Example scenarios include centralized big data deployments, or compute grids requiring simple management of a large pool of worker nodes.</span></span> <span data-ttu-id="00e9b-113">In combinatie met aan een VM-schaalset [gekoppelde gegevensschijven](virtual-machine-scale-sets-attached-disks.md) kunt u met grootschalige sets in één bewerking een schaalbare infrastructuur van duizenden kernen en petabytes aan opslag implementeren.</span><span class="sxs-lookup"><span data-stu-id="00e9b-113">Combined with VM scale set [attached data disks](virtual-machine-scale-sets-attached-disks.md), large scale sets enable you to deploy a scalable infrastructure consisting of thousands of cores and petabytes of storage, as a single operation.</span></span>

## <a name="placement-groups"></a><span data-ttu-id="00e9b-114">Plaatsingsgroepen</span><span class="sxs-lookup"><span data-stu-id="00e9b-114">Placement groups</span></span> 
<span data-ttu-id="00e9b-115">Wat een _grote_ schaalset zo bijzonder maakt, is niet het aantal virtuele machines, maar het aantal _plaatsingsgroepen_ dat deze bevat.</span><span class="sxs-lookup"><span data-stu-id="00e9b-115">What makes a _large_ scale set special is not the number of VMs, but the number of _placement groups_ it contains.</span></span> <span data-ttu-id="00e9b-116">Een plaatsingsgroep is een constructie die vergelijkbaar is met een Azure-beschikbaarheidsset, met eigen foutdomeinen en upgradedomeinen.</span><span class="sxs-lookup"><span data-stu-id="00e9b-116">A placement group is a construct similar to an Azure availability set, with its own fault domains and upgrade domains.</span></span> <span data-ttu-id="00e9b-117">Standaard bestaat een schaalset uit één plaatsingsgroep met een omvang van maximaal 100 virtuele machines.</span><span class="sxs-lookup"><span data-stu-id="00e9b-117">By default, a scale set consists of a single placement group with a maximum size of 100 VMs.</span></span> <span data-ttu-id="00e9b-118">Als een schaaleigenschap met de naam _singlePlacementGroup_ is ingesteld op _onwaar_, kan de schaal bestaan uit meerdere plaatsingsgroepen en heeft deze een capaciteit van 0-1000 virtuele machines.</span><span class="sxs-lookup"><span data-stu-id="00e9b-118">If a scale set property called _singlePlacementGroup_ is set to _false_, the scale set can be composed of multiple placement groups and has a range of 0-1,000 VMs.</span></span> <span data-ttu-id="00e9b-119">Als de eigenschap de standaardwaarde _waar_ heeft, bestaat een schaalset uit één plaatsingsgroep en heeft deze een capaciteit van 0-100 virtuele machines.</span><span class="sxs-lookup"><span data-stu-id="00e9b-119">When set to the default value of _true_, a scale set is composed of a single placement group, and has a range of 0-100 VMs.</span></span>

## <a name="checklist-for-using-large-scale-sets"></a><span data-ttu-id="00e9b-120">Controlelijst voor het gebruik van grote schaalsets</span><span class="sxs-lookup"><span data-stu-id="00e9b-120">Checklist for using large scale sets</span></span>
<span data-ttu-id="00e9b-121">Overweeg de volgende vereisten voordat u beslist of uw toepassing doeltreffend gebruik kan maken van grootschalige sets:</span><span class="sxs-lookup"><span data-stu-id="00e9b-121">To decide whether your application can make effective use of large scale sets, consider the following requirements:</span></span>

- <span data-ttu-id="00e9b-122">Grote schaalsets vereisen Azure Managed Disks.</span><span class="sxs-lookup"><span data-stu-id="00e9b-122">Large scale sets require Azure Managed Disks.</span></span> <span data-ttu-id="00e9b-123">Voor schaalsets die niet worden gemaakt met Managed Disks zijn meerdere opslagaccounts vereist (één voor elke 20 virtuele machines).</span><span class="sxs-lookup"><span data-stu-id="00e9b-123">Scale sets that are not created with Managed Disks require multiple storage accounts (one for every 20 VMs).</span></span> <span data-ttu-id="00e9b-124">Grote schaalsets zijn ontworpen om exclusief met Managed Disks te werken om de overhead voor opslagbeheer te beperken en om het risico te vermijden dat u met abonnementslimieten van opslagaccounts wordt geconfronteerd.</span><span class="sxs-lookup"><span data-stu-id="00e9b-124">Large scale sets are designed to work exclusively with Managed Disks to reduce your storage management overhead, and to avoid the risk of running into subscription limits for storage accounts.</span></span> <span data-ttu-id="00e9b-125">Als u niet met Managed Disks werkt, is uw schaalset beperkt tot 100 virtuele machines.</span><span class="sxs-lookup"><span data-stu-id="00e9b-125">If you do not use Managed Disks, your scale set is limited to 100 VMs.</span></span>
- <span data-ttu-id="00e9b-126">Schaalsets die vanuit Azure Marketplace zijn gemaakt, kunnen worden geschaald tot maximaal 1000 virtuele machines.</span><span class="sxs-lookup"><span data-stu-id="00e9b-126">Scale sets created from Azure Marketplace images can scale up to 1,000 VMs.</span></span>
- <span data-ttu-id="00e9b-127">Schaalsets die vanuit aangepaste installatiekopieën (VM-installatiekopieën die u zelf maakt en uploadt) zijn gemaakt, kunnen op dit moment worden geschaald tot maximaal 100 virtuele machines.</span><span class="sxs-lookup"><span data-stu-id="00e9b-127">Scale sets created from custom images (VM images you create and upload yourself) can currently scale up to 100 VMs.</span></span>
- <span data-ttu-id="00e9b-128">Laag-4 taakverdeling met de Azure Load Balancer wordt nog niet ondersteund voor schaalsets die uit meerdere plaatsingsgroepen bestaan.</span><span class="sxs-lookup"><span data-stu-id="00e9b-128">Layer-4 load balancing with the Azure Load Balancer is not yet supported for scale sets composed of multiple placement groups.</span></span> <span data-ttu-id="00e9b-129">Als u de Azure Load Balancer moet gebruiken, zorg dan dat de schaalset is geconfigureerd voor het gebruik van één plaatsingsgroep. Dit is de standaardinstelling.</span><span class="sxs-lookup"><span data-stu-id="00e9b-129">If you need to use the Azure Load Balancer make sure the scale set is configured to use a single placement group, which is the default setting.</span></span>
- <span data-ttu-id="00e9b-130">Laag-7 taakverdeling met de Azure Application Gateway wordt voor alle schaalsets ondersteund.</span><span class="sxs-lookup"><span data-stu-id="00e9b-130">Layer-7 load balancing with the Azure Application Gateway is supported for all scale sets.</span></span>
- <span data-ttu-id="00e9b-131">Een schaalset wordt gedefinieerd met één subnet. Zorg dat het subnet een adresruimte heeft die groot genoeg is voor alle virtuele machines die u nodig hebt.</span><span class="sxs-lookup"><span data-stu-id="00e9b-131">A scale set is defined with a single subnet - make sure your subnet has an address space large enough for all the VMs you need.</span></span> <span data-ttu-id="00e9b-132">Standaard wordt een schaalset te groot ingericht (dat wil zeggen dat er tijdens de implementatie of bij het uitschalen extra virtuele machines worden gemaakt, waarvoor u niet hoeft te betalen), om de betrouwbaarheid en prestaties van de implementatie te verbeteren.</span><span class="sxs-lookup"><span data-stu-id="00e9b-132">By default a scale set overprovisions (creates extra VMs at deployment time or when scaling out, which you are not charged for) to improve deployment reliability and performance.</span></span> <span data-ttu-id="00e9b-133">Zorg daarom voor een adresruimte die 20% groter is dan het aantal virtuele machines waarnaar u wilt gaan schalen.</span><span class="sxs-lookup"><span data-stu-id="00e9b-133">Allow for an address space 20% greater than the number of VMs you plan to scale to.</span></span>
- <span data-ttu-id="00e9b-134">Als u veel virtuele machines wilt gaan implementeren, moeten de quotumlimieten voor uw rekenkernen mogelijk worden verhoogd.</span><span class="sxs-lookup"><span data-stu-id="00e9b-134">If you are planning to deploy many VMs, your Compute core quota limits may need to be increased.</span></span>
- <span data-ttu-id="00e9b-135">Fout- en upgradedomeinen zijn alleen consistent binnen een plaatsingsgroep.</span><span class="sxs-lookup"><span data-stu-id="00e9b-135">Fault domains and upgrade domains are only consistent within a placement group.</span></span> <span data-ttu-id="00e9b-136">Deze architectuur verandert niet de algemene beschikbaarheid van een schaalset, omdat virtuele machines evenredig worden verdeeld over verschillende fysieke hardware. Als u moet garanderen dat twee virtuele machines zich op verschillende hardware bevinden, betekent dit echter wel dat u ervoor moet zorgen dat ze zich in verschillende foutdomeinen in dezelfde plaatsingsgroep bevinden.</span><span class="sxs-lookup"><span data-stu-id="00e9b-136">This architecture does not change the overall availability of a scale set, as VMs are evenly distributed across distinct physical hardware, but it does means that if you need to guarantee two VMs are on different hardware, make sure they are in different fault domains in the same placement group.</span></span> <span data-ttu-id="00e9b-137">Het foutdomein en de id van de plaatsingsgroep worden weergegeven in de _exemplaarweergave_  van een schaalset-VM.</span><span class="sxs-lookup"><span data-stu-id="00e9b-137">Fault domain and placement group ID are shown in the _instance view_ of a scale set VM.</span></span> <span data-ttu-id="00e9b-138">U kunt de exemplaarweergave van een schaalset-VM bekijken in de [Azure Resource Explorer](https://resources.azure.com/).</span><span class="sxs-lookup"><span data-stu-id="00e9b-138">You can view the instance view of a scale set VM in the [Azure Resource Explorer](https://resources.azure.com/).</span></span>


## <a name="creating-a-large-scale-set"></a><span data-ttu-id="00e9b-139">Een grote schaalset maken</span><span class="sxs-lookup"><span data-stu-id="00e9b-139">Creating a large scale set</span></span>
<span data-ttu-id="00e9b-140">Wanneer u in Azure Portal een schaalset maakt, kunt u schaling naar meerdere plaatsingsgroepen toestaan door de optie _Limit to a single placement group_ (Beperken tot één plaatsingsgroep) op de blade _Basics_ (Basisinformatie) in te stellen op _False_.</span><span class="sxs-lookup"><span data-stu-id="00e9b-140">When you create a scale set in the Azure portal, you can allow it to scale to multiple placement groups by setting the _Limit to a single placement group_ option to _False_ in the _Basics_ blade.</span></span> <span data-ttu-id="00e9b-141">Als u deze optie instelt op _False_, kunt u de waarde van _Instance count_ (Aantal exemplaren) instellen op maximaal 1000.</span><span class="sxs-lookup"><span data-stu-id="00e9b-141">With this option set to _False_, you can specify an _Instance count_ value of up to 1,000.</span></span>

![](./media/virtual-machine-scale-sets-placement-groups/portal-large-scale.png)

<span data-ttu-id="00e9b-142">U kunt u een grote virtuele-machineschaalset maken met de [Azure CLI](https://github.com/Azure/azure-cli)-opdracht _az vmss create_.</span><span class="sxs-lookup"><span data-stu-id="00e9b-142">You can create a large VM scale set using the [Azure CLI](https://github.com/Azure/azure-cli) _az vmss create_ command.</span></span> <span data-ttu-id="00e9b-143">Met deze opdracht stelt u intelligente standaardinstellingen in, zoals een subnetgrootte op basis van het argument _instance-count_:</span><span class="sxs-lookup"><span data-stu-id="00e9b-143">This command sets intelligent defaults such as subnet size based on the _instance-count_ argument:</span></span>

```bash
az group create -l southcentralus -n biginfra
az vmss create -g biginfra -n bigvmss --image ubuntults --instance-count 1000
```
<span data-ttu-id="00e9b-144">De opdracht _vmss create_ gebruikt standaard bepaalde configuratiewaarden als u ze niet opgeeft.</span><span class="sxs-lookup"><span data-stu-id="00e9b-144">Note that the _vmss create_ command defaults certain configuration values if you do not specify them.</span></span> <span data-ttu-id="00e9b-145">Probeer het volgende om de beschikbare opties te bekijken die u kunt overschrijven:</span><span class="sxs-lookup"><span data-stu-id="00e9b-145">To see the available options that you can override, try:</span></span>
```bash
az vmss create --help
```

<span data-ttu-id="00e9b-146">Als u een grote schaalset maakt door een Azure Resource Manager-sjabloon te maken, zorg dan dat de sjabloon een schaalset maakt op basis van Azure Managed Disks.</span><span class="sxs-lookup"><span data-stu-id="00e9b-146">If you are creating a large scale set by composing an Azure Resource Manager template, make sure the template creates a scale set based on Azure Managed Disks.</span></span> <span data-ttu-id="00e9b-147">U kunt de eigenschap _singlePlacementGroup_ in de sectie _Properties_ van de resource _Microsoft.Compute/virtualMAchineScaleSets_ instellen op _false_.</span><span class="sxs-lookup"><span data-stu-id="00e9b-147">You can set the _singlePlacementGroup_ property to _false_ in the _properties_ section of the _Microsoft.Compute/virtualMAchineScaleSets_ resource.</span></span> <span data-ttu-id="00e9b-148">In het volgende JSON-fragment ziet u het begin van een schaalsetsjabloon, met een capaciteit voor 1000 virtuele machines en de instelling _"singlePlacementGroup": false_:</span><span class="sxs-lookup"><span data-stu-id="00e9b-148">The following JSON fragment shows the beginning of a scale set template, including the 1,000 VM capacity and the _"singlePlacementGroup" : false_ setting:</span></span>
```json
{
  "type": "Microsoft.Compute/virtualMachineScaleSets",
  "location": "australiaeast",
  "name": "bigvmss",
  "sku": {
    "name": "Standard_DS1_v2",
    "tier": "Standard",
    "capacity": 1000
  },
  "properties": {
    "singlePlacementGroup": false,
    "upgradePolicy": {
      "mode": "Automatic"
    }
```
<span data-ttu-id="00e9b-149">Voor een volledig voorbeeld van een schaalsetsjabloon raadpleegt u [https://github.com/gbowerman/azure-myriad/blob/master/bigtest/bigbottle.json](https://github.com/gbowerman/azure-myriad/blob/master/bigtest/bigbottle.json).</span><span class="sxs-lookup"><span data-stu-id="00e9b-149">For a complete example of a large scale set template, refer to [https://github.com/gbowerman/azure-myriad/blob/master/bigtest/bigbottle.json](https://github.com/gbowerman/azure-myriad/blob/master/bigtest/bigbottle.json).</span></span>

## <a name="converting-an-existing-scale-set-to-span-multiple-placement-groups"></a><span data-ttu-id="00e9b-150">Een bestaande schaalset converteren zodat deze meerdere plaatsingsgroepen omvat</span><span class="sxs-lookup"><span data-stu-id="00e9b-150">Converting an existing scale set to span multiple placement groups</span></span>
<span data-ttu-id="00e9b-151">Als u een bestaande VM-schaalset geschikt wilt maken voor schaling naar meer dan 100 virtuele machines, moet u de eigenschap _singlePlacementGroup_ in het schaalsetmodel wijzigen in _false_.</span><span class="sxs-lookup"><span data-stu-id="00e9b-151">To make an existing VM scale set capable of scaling to more than 100 VMs, you need to change the _singplePlacementGroup_ property to _false_ in the scale set model.</span></span> <span data-ttu-id="00e9b-152">Met de [Azure Resource Explorer](https://resources.azure.com/) kunt u controleren of deze eigenschap is gewijzigd.</span><span class="sxs-lookup"><span data-stu-id="00e9b-152">You can test changing this property with the [Azure Resource Explorer](https://resources.azure.com/).</span></span> <span data-ttu-id="00e9b-153">Zoek een bestaande schaalset, selecteer _Edit_ (Bewerken) en wijzig de eigenschap _singlePlacementGroup_.</span><span class="sxs-lookup"><span data-stu-id="00e9b-153">Find an existing scale set, select _Edit_ and change the _singlePlacementGroup_ property.</span></span> <span data-ttu-id="00e9b-154">Als u deze eigenschap niet ziet, bekijkt u de schaalset misschien met een oudere versie van de Microsoft.Compute-API.</span><span class="sxs-lookup"><span data-stu-id="00e9b-154">If you do not see this property, you may be viewing the scale set with an older version of the Microsoft.Compute API.</span></span>

>[!NOTE] 
<span data-ttu-id="00e9b-155">U kunt een schaalset zo wijzigen dat deze in plaats van slechts één plaatsingsgroep (de standaardinstelling) ondersteuning biedt voor meerdere plaatsingsgroepen. Andersom is echter niet mogelijk.</span><span class="sxs-lookup"><span data-stu-id="00e9b-155">You can change a scale set from supporting a single placement group only (the default behavior) to a supporting multiple placement groups, but you cannot convert the other way around.</span></span> <span data-ttu-id="00e9b-156">Zorg daarom dat u begrijpt waarvoor de eigenschappen van grote schaalsets dienen, voordat u deze converteert.</span><span class="sxs-lookup"><span data-stu-id="00e9b-156">Therefore make sure you understand the properties of large scale sets before converting.</span></span> <span data-ttu-id="00e9b-157">Zorg er met name voor dat u laag-4 taakverdeling niet nodig hebt met de Azure Load Balancer.</span><span class="sxs-lookup"><span data-stu-id="00e9b-157">In particular, make sure you do not need layer-4 load balancing with the Azure Load Balancer.</span></span>


