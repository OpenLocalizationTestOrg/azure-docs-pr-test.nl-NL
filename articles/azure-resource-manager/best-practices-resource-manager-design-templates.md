---
title: Azure-sjablonen voor complexe oplossingen ontwerpen | Microsoft Docs
description: Bevat aanbevolen procedures voor het ontwerpen van Azure Resource Manager-sjablonen voor complexe scenario 's
services: azure-resource-manager
documentationcenter: 
author: tfitzmac
manager: timlt
editor: tysonn
ms.assetid: ce1141d6-ece7-4976-acea-1db1f775409e
ms.service: azure-resource-manager
ms.workload: multiple
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 12/19/2016
ms.author: tomfitz
ms.openlocfilehash: dcc31f7a8c85a8f7fbd554371a66fb1e348bca17
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 08/03/2017
---
# <a name="design-patterns-for-azure-resource-manager-templates-when-deploying-complex-solutions"></a><span data-ttu-id="62667-103">Ontwerppatronen voor Azure Resource Manager-sjablonen bij het implementeren van complexe oplossingen</span><span class="sxs-lookup"><span data-stu-id="62667-103">Design patterns for Azure Resource Manager templates when deploying complex solutions</span></span>
<span data-ttu-id="62667-104">Flexibele wijze op basis van Azure Resource Manager-sjablonen gebruikt, kunt u complexe topologieën implementeren snel en consistent.</span><span class="sxs-lookup"><span data-stu-id="62667-104">Using a flexible approach based on Azure Resource Manager templates, you can deploy complex topologies quickly and consistently.</span></span> <span data-ttu-id="62667-105">U kunt deze implementaties eenvoudig aanpassen als de offerings core evolueren of om varianten voor uitschieter scenario's of klanten mogelijk te maken.</span><span class="sxs-lookup"><span data-stu-id="62667-105">You can adapt these deployments easily as core offerings evolve or to accommodate variants for outlier scenarios or customers.</span></span>

<span data-ttu-id="62667-106">In dit onderwerp maakt deel uit van een grotere technisch document.</span><span class="sxs-lookup"><span data-stu-id="62667-106">This topic is part of a larger whitepaper.</span></span> <span data-ttu-id="62667-107">Om te lezen van het volledige papier, downloaden [World klasse Azure Resource Manager-sjablonen overwegingen en procedures bewezen](http://download.microsoft.com/download/8/E/1/8E1DBEFA-CECE-4DC9-A813-93520A5D7CFE/World Class ARM Templates - Considerations and Proven Practices.pdf).</span><span class="sxs-lookup"><span data-stu-id="62667-107">To read the full paper, download [World Class Azure Resource Manager Templates Considerations and Proven Practices](http://download.microsoft.com/download/8/E/1/8E1DBEFA-CECE-4DC9-A813-93520A5D7CFE/World Class ARM Templates - Considerations and Proven Practices.pdf).</span></span>

<span data-ttu-id="62667-108">De voordelen van de onderliggende Azure Resource Manager combineren sjablonen met het aanpassingsvermogen en de leesbaarheid van Notation JSON (JavaScript Object).</span><span class="sxs-lookup"><span data-stu-id="62667-108">Templates combine the benefits of the underlying Azure Resource Manager with the adaptability and readability of JavaScript Object Notation (JSON).</span></span> <span data-ttu-id="62667-109">Met sjablonen, kunt u het volgende doen:</span><span class="sxs-lookup"><span data-stu-id="62667-109">Using templates, you can:</span></span>

* <span data-ttu-id="62667-110">Topologieën en hun werkbelasting consistent te implementeren.</span><span class="sxs-lookup"><span data-stu-id="62667-110">Deploy topologies and their workloads consistently.</span></span>
* <span data-ttu-id="62667-111">Alle resources in een toepassing die samen met resourcegroepen beheren.</span><span class="sxs-lookup"><span data-stu-id="62667-111">Manage all your resources in an application together using resource groups.</span></span>
* <span data-ttu-id="62667-112">Op rollen gebaseerde toegangsbeheer (RBAC) juiste om toegang te verlenen aan gebruikers, groepen en services van toepassing.</span><span class="sxs-lookup"><span data-stu-id="62667-112">Apply role-based access control (RBAC) to grant appropriate access to users, groups, and services.</span></span>
* <span data-ttu-id="62667-113">Gebruik deze koppelingen voor het stroomlijnen van taken zoals facturering samentellingen labels.</span><span class="sxs-lookup"><span data-stu-id="62667-113">Use tagging associations to streamline tasks such as billing rollups.</span></span>

<span data-ttu-id="62667-114">In dit artikel biedt details over het verbruik scenario's, architectuur en implementatie-patronen die zijn geïdentificeerd tijdens onze ontwerp sessies en de werkelijke sjabloon implementaties van klanten Azure Customer Advisory Team (AzureCAT).</span><span class="sxs-lookup"><span data-stu-id="62667-114">This article provides details on consumption scenarios, architecture, and implementation patterns identified during our design sessions and real-world template implementations with Azure Customer Advisory Team (AzureCAT) customers.</span></span> <span data-ttu-id="62667-115">Verre academic, deze benaderingen procedures op de hoogte gebracht door de ontwikkeling van sjablonen voor 12 van de bovenkant op basis van Linux OSS-technologieën, waaronder zijn beproefde: Apache Kafka, Apache Spark, Cloudera, Couchbase, Hortonworks HDP, DataStax Enterprise aangedreven door Apache Cassandra, Elasticsearch Jenkins, MongoDB, PostgreSQL, Redis en Nagios.</span><span class="sxs-lookup"><span data-stu-id="62667-115">Far from academic, these approaches are proven practices informed by the development of templates for 12 of the top Linux-based OSS technologies, including: Apache Kafka, Apache Spark, Cloudera, Couchbase, Hortonworks HDP, DataStax Enterprise powered by Apache Cassandra, Elasticsearch, Jenkins, MongoDB, PostgreSQL, Redis, and Nagios.</span></span> 

<span data-ttu-id="62667-116">In dit artikel deelt deze bewezen procedures waarmee u kunt bouwen world klasse Azure Resource Manager-sjablonen.</span><span class="sxs-lookup"><span data-stu-id="62667-116">This article shares these proven practices to help you architect world class Azure Resource Manager templates.</span></span>  

<span data-ttu-id="62667-117">In onze werk met klanten hebben we verschillende Resource Manager-sjabloon verbruik ervaringen geïdentificeerd voor ondernemingen, systeem SI's (SI) s en CSV's.</span><span class="sxs-lookup"><span data-stu-id="62667-117">In our work with customers, we have identified several Resource Manager template consumption experiences across enterprises, System Integrators (SI)s, and CSVs.</span></span> <span data-ttu-id="62667-118">De volgende secties bevatten een overzicht van veelvoorkomende scenario's en patronen voor verschillende soorten klanten.</span><span class="sxs-lookup"><span data-stu-id="62667-118">The following sections provide a high-level overview of common scenarios and patterns for different customer types.</span></span>

## <a name="enterprises-and-system-integrators"></a><span data-ttu-id="62667-119">Ondernemingen en systeemintegrators</span><span class="sxs-lookup"><span data-stu-id="62667-119">Enterprises and system integrators</span></span>
<span data-ttu-id="62667-120">In grote organisaties vaak ziet u twee consumenten van Resource Manager-sjablonen: ontwikkelteams interne software en zakelijke IT.</span><span class="sxs-lookup"><span data-stu-id="62667-120">Within large organizations, we commonly see two consumers of Resource Manager templates: internal software development teams and corporate IT.</span></span> <span data-ttu-id="62667-121">We hebt gevonden die de scenario's voor de kaart SIs voor de scenario's voor ondernemingen, zodat dezelfde overwegingen van toepassing.</span><span class="sxs-lookup"><span data-stu-id="62667-121">We've found that the scenarios for the SIs map to the scenarios for Enterprises, so the same considerations apply.</span></span>

### <a name="internal-software-development-teams"></a><span data-ttu-id="62667-122">Interne software ontwikkelteams</span><span class="sxs-lookup"><span data-stu-id="62667-122">Internal software development teams</span></span>
<span data-ttu-id="62667-123">Als uw team software ontwikkelt ter ondersteuning van uw bedrijf, bieden sjablonen een eenvoudige manier om snel implementeren technologieën voor gebruik in bedrijfsspecifieke-oplossingen.</span><span class="sxs-lookup"><span data-stu-id="62667-123">If your team develops software to support your business, templates provide an easy way to quickly deploy technologies for use in business-specific solutions.</span></span> <span data-ttu-id="62667-124">U kunt ook sjablonen snel training om omgevingen te maken waarmee teamleden krijgen vaardigheden die nodig zijn.</span><span class="sxs-lookup"><span data-stu-id="62667-124">You can also use templates to rapidly create training environments that enable team members to gain necessary skills.</span></span>

<span data-ttu-id="62667-125">U kunt sjablonen als-is of uitbreiden of opstellen ze aan uw behoeften.</span><span class="sxs-lookup"><span data-stu-id="62667-125">You can use templates as-is or extend or compose them to accommodate your needs.</span></span> <span data-ttu-id="62667-126">Met labels binnen sjablonen, kunt u een facturering samenvatting met verschillende weergaven zoals team, project, afzonderlijke en education bieden.</span><span class="sxs-lookup"><span data-stu-id="62667-126">Using tagging within templates, you can provide a billing summary with various views such as team, project, individual, and education.</span></span>

<span data-ttu-id="62667-127">Bedrijven willen vaak ontwikkelteams software om een sjabloon voor consistente implementatie van een oplossing te maken.</span><span class="sxs-lookup"><span data-stu-id="62667-127">Businesses often want software development teams to create a template for consistent deployment of a solution.</span></span> <span data-ttu-id="62667-128">De sjabloon vergemakkelijkt beperkingen zodat bepaalde items in deze omgeving vast blijven en kunnen niet worden overschreven.</span><span class="sxs-lookup"><span data-stu-id="62667-128">The template facilitates constraints so certain items within that environment remain fixed and can't be overridden.</span></span> <span data-ttu-id="62667-129">Een bank moet mogelijk een sjabloon wilt opnemen RBAC zodat programmeurs niet een oplossing voor bankieren om gegevens te verzenden naar een persoonlijke opslagaccount herzien.</span><span class="sxs-lookup"><span data-stu-id="62667-129">For example, a bank might require a template to include RBAC so a programmer can’t revise a banking solution to send data to a personal storage account.</span></span>

### <a name="corporate-it"></a><span data-ttu-id="62667-130">Zakelijke IT</span><span class="sxs-lookup"><span data-stu-id="62667-130">Corporate IT</span></span>
<span data-ttu-id="62667-131">Zakelijke IT-organisaties doorgaans sjablonen gebruiken voor het leveren van cloud-capaciteit en cloud-gebaseerde mogelijkheden.</span><span class="sxs-lookup"><span data-stu-id="62667-131">Corporate IT organizations typically use templates for delivering cloud capacity and cloud-hosted capabilities.</span></span>

#### <a name="cloud-capacity"></a><span data-ttu-id="62667-132">Cloudcapaciteit</span><span class="sxs-lookup"><span data-stu-id="62667-132">Cloud capacity</span></span>
<span data-ttu-id="62667-133">Er is een veelgebruikte manier voor zakelijke IT-groepen voor cloudcapaciteit voor teams met 't-shirt grootten', die standaard aanbieding grootten zoals kleine, middelgrote en grote zijn.</span><span class="sxs-lookup"><span data-stu-id="62667-133">A common way for corporate IT groups to provide cloud capacity for teams is with "t-shirt sizes", which are standard offering sizes such as small, medium, and large.</span></span> <span data-ttu-id="62667-134">De offerings t-shirt grootte kunnen verschillende brontypen meng en hoeveelheden en tegelijkertijd een niveau van standaardisering die het mogelijk maakt gebruik van sjablonen.</span><span class="sxs-lookup"><span data-stu-id="62667-134">The t-shirt sized offerings can mix different resource types and quantities while providing a level of standardization that makes it possible to use templates.</span></span> <span data-ttu-id="62667-135">De sjablonen bieden capaciteit in een consistente manier die wordt afgedwongen bedrijfsbeleid en labels wordt gebruikt voor terugstorting aan organisaties verbruikt.</span><span class="sxs-lookup"><span data-stu-id="62667-135">The templates deliver capacity in a consistent way that enforces corporate policies and uses tagging to provide chargeback to consuming organizations.</span></span>

<span data-ttu-id="62667-136">U moet mogelijk bieden ontwikkeling, testen of productie-omgevingen waarbinnen de software-ontwikkelteams hun oplossingen kunnen implementeren.</span><span class="sxs-lookup"><span data-stu-id="62667-136">For example, you may need to provide development, test, or production environments within which the software development teams can deploy their solutions.</span></span> <span data-ttu-id="62667-137">De omgeving heeft een vooraf gedefinieerde netwerktopologie en elementen die de software-ontwikkelteams niet wijzigen, zoals regels voor toegang tot het openbare internet en pakket-inspectie.</span><span class="sxs-lookup"><span data-stu-id="62667-137">The environment has a predefined network topology and elements that the software development teams cannot change, such as rules governing access to the public internet and packet inspection.</span></span> <span data-ttu-id="62667-138">Mogelijk hebt u ook de organisatie-specifieke rollen voor deze omgevingen met verschillende toegangsrechten voor de omgeving.</span><span class="sxs-lookup"><span data-stu-id="62667-138">You may also have organization-specific roles for these environments with distinct access rights for the environment.</span></span>

#### <a name="cloud-hosted-capabilities"></a><span data-ttu-id="62667-139">Cloud-gebaseerde mogelijkheden</span><span class="sxs-lookup"><span data-stu-id="62667-139">Cloud-hosted capabilities</span></span>
<span data-ttu-id="62667-140">U kunt sjablonen gebruiken ter ondersteuning van cloud-gebaseerde mogelijkheden, zoals afzonderlijke softwarepakketten of samengestelde aanbiedingen die worden aangeboden aan interne zakelijke regels.</span><span class="sxs-lookup"><span data-stu-id="62667-140">You can use templates to support cloud-hosted capabilities, including individual software packages or composite offerings that are offered to internal lines of business.</span></span> <span data-ttu-id="62667-141">Een voorbeeld van een samengestelde aanbieding is analytics as a service-analyse, visualisatie en andere technologieën, geleverd in de configuratie van een geoptimaliseerde, met elkaar verbonden op een vooraf gedefinieerde netwerktopologie.</span><span class="sxs-lookup"><span data-stu-id="62667-141">An example of a composite offering would be analytics-as-a-service—analytics, visualization, and other technologies—delivered in an optimized, connected configuration on a predefined network topology.</span></span>

<span data-ttu-id="62667-142">Cloud-gebaseerde mogelijkheden worden beïnvloed door de overwegingen voor beveiliging en rol tot stand gebracht door de cloudcapaciteit aanbiedt op waarop ze worden gebouwd.</span><span class="sxs-lookup"><span data-stu-id="62667-142">Cloud-hosted capabilities are affected by the security and role considerations established by the cloud capacity offering on which they’re built.</span></span> <span data-ttu-id="62667-143">Deze mogelijkheden worden aangeboden ongewijzigd of als een beheerde service.</span><span class="sxs-lookup"><span data-stu-id="62667-143">These capabilities are offered as is or as a managed service.</span></span> <span data-ttu-id="62667-144">Voor de laatste, toegang tot beperkte rollen zijn vereist om toegang te krijgen in de omgeving voor beheerdoeleinden.</span><span class="sxs-lookup"><span data-stu-id="62667-144">For the latter, access-constrained roles are required to enable access into the environment for management purposes.</span></span>

## <a name="cloud-service-vendors"></a><span data-ttu-id="62667-145">Leveranciers van cloud-service</span><span class="sxs-lookup"><span data-stu-id="62667-145">Cloud service vendors</span></span>
<span data-ttu-id="62667-146">Na het praten met veel CSV's, geïdentificeerd we meerdere manieren om services voor uw klanten en de bijbehorende vereiste te implementeren.</span><span class="sxs-lookup"><span data-stu-id="62667-146">After talking to many CSVs, we identified multiple approaches you can take to deploy services for your customers and associated requirements.</span></span>

### <a name="csv-hosted-offering"></a><span data-ttu-id="62667-147">Aanbieding CSV gehost</span><span class="sxs-lookup"><span data-stu-id="62667-147">CSV-hosted offering</span></span>
<span data-ttu-id="62667-148">Als u uw aanbod in uw eigen Azure-abonnement host, twee hosting benaderingen gelden: een unieke implementatie implementeren voor elke klant of implementeren van schaaleenheden die onderbouwing van een gedeelde infrastructuur, die wordt gebruikt voor alle klanten.</span><span class="sxs-lookup"><span data-stu-id="62667-148">If you host your offering in your own Azure subscription, two hosting approaches are common: deploying a distinct deployment for every customer or deploying scale units that underpin a shared infrastructure used for all customers.</span></span>

* <span data-ttu-id="62667-149">**Verschillende implementaties voor elke klant.**</span><span class="sxs-lookup"><span data-stu-id="62667-149">**Distinct deployments for each customer.**</span></span> <span data-ttu-id="62667-150">Verschillende implementaties per klant vereisen vaste topologieën van verschillende bekende configuraties.</span><span class="sxs-lookup"><span data-stu-id="62667-150">Distinct deployments per customer require fixed topologies of different known configurations.</span></span> <span data-ttu-id="62667-151">Deze implementaties mogelijk andere virtuele machine (VM) grootten, verschillend aantal knooppunten en andere hoeveelheden bijbehorende opslag.</span><span class="sxs-lookup"><span data-stu-id="62667-151">These deployments may have different virtual machine (VM) sizes, varying numbers of nodes, and different amounts of associated storage.</span></span> <span data-ttu-id="62667-152">Labels van implementaties wordt gebruikt voor totaliseren facturering van elke klant.</span><span class="sxs-lookup"><span data-stu-id="62667-152">Tagging of deployments is used for roll-up billing of each customer.</span></span> <span data-ttu-id="62667-153">RBAC kan worden ingeschakeld zodat klanten toegang hebben tot aspecten van hun cloudomgeving.</span><span class="sxs-lookup"><span data-stu-id="62667-153">RBAC may be enabled to allow customers access to aspects of their cloud environment.</span></span>
* <span data-ttu-id="62667-154">**Schaaleenheden in een gedeelde omgeving met meerdere tenants.**</span><span class="sxs-lookup"><span data-stu-id="62667-154">**Scale units in shared multi-tenant environments.**</span></span> <span data-ttu-id="62667-155">Een schaaleenheid voor omgevingen met meerdere tenants kan bestaan uit een sjabloon.</span><span class="sxs-lookup"><span data-stu-id="62667-155">A template can represent a scale unit for multi-tenant environments.</span></span> <span data-ttu-id="62667-156">In dit geval wordt dezelfde infrastructuur gebruikt ter ondersteuning van alle klanten.</span><span class="sxs-lookup"><span data-stu-id="62667-156">In this case, the same infrastructure is used to support all customers.</span></span> <span data-ttu-id="62667-157">De implementaties vertegenwoordigen een groep resources die een niveau van de capaciteit voor de gehoste oplossing, zoals het aantal gebruikers en het aantal transacties leveren.</span><span class="sxs-lookup"><span data-stu-id="62667-157">The deployments represent a group of resources that deliver a level of capacity for the hosted offering, such as number of users and number of transactions.</span></span> <span data-ttu-id="62667-158">Deze schaaleenheden worden verhoogd of verlaagd omdat vraag vereist.</span><span class="sxs-lookup"><span data-stu-id="62667-158">These scale units are increased or decreased as demand requires.</span></span>

### <a name="csv-offering-injected-into-customer-subscription"></a><span data-ttu-id="62667-159">CSV-aanbieding is opgenomen in het klantabonnement</span><span class="sxs-lookup"><span data-stu-id="62667-159">CSV offering injected into customer subscription</span></span>
<span data-ttu-id="62667-160">U kunt uw om software te implementeren in abonnementen die eigendom zijn van end-klanten.</span><span class="sxs-lookup"><span data-stu-id="62667-160">You may want to deploy your software into subscriptions owned by end customers.</span></span> <span data-ttu-id="62667-161">U kunt sjablonen gebruiken voor het implementeren van verschillende implementaties in Azure-account van de klant.</span><span class="sxs-lookup"><span data-stu-id="62667-161">You can use templates to deploy distinct deployments into a customer’s Azure account.</span></span>

<span data-ttu-id="62667-162">Deze implementaties gebruikmaken van RBAC zodat u kunt bijwerken en beheren van de implementatie binnen het account van de klant.</span><span class="sxs-lookup"><span data-stu-id="62667-162">These deployments use RBAC so you can update and manage the deployment within the customer’s account.</span></span>

### <a name="azure-marketplace"></a><span data-ttu-id="62667-163">Azure Marketplace</span><span class="sxs-lookup"><span data-stu-id="62667-163">Azure Marketplace</span></span>
<span data-ttu-id="62667-164">Als u wilt adverteren en de offerings via een marketplace, zoals Azure Marketplace verkopen kunt u sjablonen voor het leveren van verschillende soorten implementaties die worden uitgevoerd in Azure-account van een klant ontwikkelen.</span><span class="sxs-lookup"><span data-stu-id="62667-164">To advertise and sell your offerings through a marketplace, such as Azure Marketplace, you can develop templates to deliver distinct types of deployments that run in a customer’s Azure account.</span></span> <span data-ttu-id="62667-165">Deze unieke implementaties kunnen doorgaans worden beschreven als een t-shirt grootte (klein, normaal, groot), product/doelgroep type (community, developer, enterprise) of onderdeeltype (basic, hoge beschikbaarheid).</span><span class="sxs-lookup"><span data-stu-id="62667-165">These distinct deployments can be typically described as a t-shirt size (small, medium, large), product/audience type (community, developer, enterprise), or feature type (basic, high availability).</span></span>  <span data-ttu-id="62667-166">In sommige gevallen kunnen deze typen u bepaalde kenmerken van de implementatie, zoals VM-type of aantal schijven opgeven.</span><span class="sxs-lookup"><span data-stu-id="62667-166">In some cases, these types allow you to specify certain attributes of the deployment, such as VM type or number of disks.</span></span>

## <a name="oss-projects"></a><span data-ttu-id="62667-167">OSS-projecten</span><span class="sxs-lookup"><span data-stu-id="62667-167">OSS projects</span></span>
<span data-ttu-id="62667-168">Resource Manager-sjablonen inschakelen in open-source projecten, een community voor het implementeren van een oplossing snel met bewezen.</span><span class="sxs-lookup"><span data-stu-id="62667-168">Within open source projects, Resource Manager templates enable a community to deploy a solution quickly using proven practices.</span></span> <span data-ttu-id="62667-169">U kunt sjablonen opslaan in een GitHub-opslagplaats, zodat de community gedurende een bepaalde periode herzien kunt.</span><span class="sxs-lookup"><span data-stu-id="62667-169">You can store templates in a GitHub repository so the community can revise them over time.</span></span> <span data-ttu-id="62667-170">Gebruikers kunnen deze sjablonen in hun eigen Azure-abonnementen implementeren.</span><span class="sxs-lookup"><span data-stu-id="62667-170">Users deploy these templates in their own Azure subscriptions.</span></span>

<span data-ttu-id="62667-171">De volgende secties beschrijven de zaken die u moet overwegen voordat het ontwerpen van uw oplossing.</span><span class="sxs-lookup"><span data-stu-id="62667-171">The following sections identify the things you need to consider before designing your solution.</span></span>

## <a name="identifying-what-is-outside-and-inside-a-vm"></a><span data-ttu-id="62667-172">Wat is buiten en in een virtuele machine identificeren</span><span class="sxs-lookup"><span data-stu-id="62667-172">Identifying what is outside and inside a VM</span></span>
<span data-ttu-id="62667-173">Bij het ontwerpen van uw sjabloon is het handig om te kijken naar de vereisten in termen van wat buiten en in de virtuele machines (VM's is):</span><span class="sxs-lookup"><span data-stu-id="62667-173">As you design your template, it’s helpful to look at the requirements in terms of what's outside and inside the virtual machines (VMs):</span></span>

* <span data-ttu-id="62667-174">Buiten betekent dat de virtuele machines en andere bronnen van uw implementatie, zoals de netwerktopologie tagging, verwijzingen naar de certificaten/geheimen en toegangsbeheer op basis van rollen.</span><span class="sxs-lookup"><span data-stu-id="62667-174">Outside means the VMs and other resources of your deployment, such as the network topology, tagging, references to the certs/secrets, and role-based access control.</span></span> <span data-ttu-id="62667-175">Al deze resources maken deel uit van uw sjabloon.</span><span class="sxs-lookup"><span data-stu-id="62667-175">All these resources are part of your template.</span></span>
* <span data-ttu-id="62667-176">Binnen betekent dat de geïnstalleerde software en de algehele status van de gewenste configuratie.</span><span class="sxs-lookup"><span data-stu-id="62667-176">Inside means the installed software and overall desired state configuration.</span></span> <span data-ttu-id="62667-177">Andere methoden, zoals VM-extensies of scripts worden gebruikt in een geheel of gedeeltelijk.</span><span class="sxs-lookup"><span data-stu-id="62667-177">Other mechanisms, such as VM extensions or scripts, are used in whole or in part.</span></span> <span data-ttu-id="62667-178">Deze mechanismen kunnen worden geïdentificeerd en uitgevoerd door de sjabloon, maar niet in deze.</span><span class="sxs-lookup"><span data-stu-id="62667-178">These mechanisms may be identified and executed by the template but aren’t in it.</span></span>

<span data-ttu-id="62667-179">Algemene voorbeelden van activiteiten die u 'in het vak doen zou' zijn-</span><span class="sxs-lookup"><span data-stu-id="62667-179">Common examples of activities you would do “inside the box” include -</span></span>  

* <span data-ttu-id="62667-180">Installeren of verwijderen van serverfuncties en onderdelen</span><span class="sxs-lookup"><span data-stu-id="62667-180">Install or remove server roles and features</span></span>
* <span data-ttu-id="62667-181">Software installeren en configureren op het niveau van knooppunt of het cluster</span><span class="sxs-lookup"><span data-stu-id="62667-181">Install and configure software at the node or cluster level</span></span>
* <span data-ttu-id="62667-182">Websites op een webserver implementeren</span><span class="sxs-lookup"><span data-stu-id="62667-182">Deploy websites on a web server</span></span>
* <span data-ttu-id="62667-183">Database-schema's implementeren</span><span class="sxs-lookup"><span data-stu-id="62667-183">Deploy database schemas</span></span>
* <span data-ttu-id="62667-184">Register of andere typen van configuratie-instellingen beheren</span><span class="sxs-lookup"><span data-stu-id="62667-184">Manage registry or other types of configuration settings</span></span>
* <span data-ttu-id="62667-185">Bestanden en mappen beheren</span><span class="sxs-lookup"><span data-stu-id="62667-185">Manage files and directories</span></span>
* <span data-ttu-id="62667-186">Starten, stoppen en beheren van processen en services</span><span class="sxs-lookup"><span data-stu-id="62667-186">Start, stop, and manage processes and services</span></span>
* <span data-ttu-id="62667-187">Lokale groepen en gebruikersaccounts beheren</span><span class="sxs-lookup"><span data-stu-id="62667-187">Manage local groups and user accounts</span></span>
* <span data-ttu-id="62667-188">Installeren en beheren van pakketten (.msi, .exe, yum, enz.)</span><span class="sxs-lookup"><span data-stu-id="62667-188">Install and manage packages (.msi, .exe, yum, etc.)</span></span>
* <span data-ttu-id="62667-189">Omgevingsvariabelen beheren</span><span class="sxs-lookup"><span data-stu-id="62667-189">Manage environment variables</span></span>
* <span data-ttu-id="62667-190">Uitvoeren van systeemeigen scripts (Windows PowerShell, bash, enz.)</span><span class="sxs-lookup"><span data-stu-id="62667-190">Run native scripts (Windows PowerShell, bash, etc.)</span></span>

### <a name="desired-state-configuration-dsc"></a><span data-ttu-id="62667-191">Configuratie van de gewenste status (DSC)</span><span class="sxs-lookup"><span data-stu-id="62667-191">Desired state configuration (DSC)</span></span>
<span data-ttu-id="62667-192">Gegevensclassificatie over de interne status van uw VM's na de implementatie, die u wilt controleren of deze implementatie niet 'nemen' uit de configuratie die u hebt gedefinieerd en ingeschakeld in broncodebeheer.</span><span class="sxs-lookup"><span data-stu-id="62667-192">Thinking about the internal state of your VMs beyond deployment, you want to make sure this deployment doesn’t "drift" from the configuration that you have defined and checked into source control.</span></span> <span data-ttu-id="62667-193">Deze aanpak zorgt ervoor dat uw ontwikkelaars of beheerders geen ad-hoc wijzigingen aanbrengen in een omgeving die niet goedgekeurd, getest, of vastgelegd in broncodebeheer.</span><span class="sxs-lookup"><span data-stu-id="62667-193">This approach ensures your developers or operations staff don’t make ad-hoc changes to an environment that are not vetted, tested, or recorded in source control.</span></span> <span data-ttu-id="62667-194">Dit besturingselement is belangrijk, omdat de handmatige wijzigingen niet in verbinding met broncodebeheer zijn.</span><span class="sxs-lookup"><span data-stu-id="62667-194">This control is important, because the manual changes are not in source control.</span></span> <span data-ttu-id="62667-195">Ze zijn ook niet deel uit van de standaardimplementatie en is van invloed op toekomstige geautomatiseerde implementaties van de software.</span><span class="sxs-lookup"><span data-stu-id="62667-195">They are also not part of the standard deployment and will impact future automated deployments of the software.</span></span>

<span data-ttu-id="62667-196">Configuratie van de gewenste status is ook belangrijk vanuit het beveiligingsoogpunt van buiten uw interne werknemers.</span><span class="sxs-lookup"><span data-stu-id="62667-196">Beyond your internal employees, desired state configuration is also important from a security perspective.</span></span> <span data-ttu-id="62667-197">Hackers probeert regelmatig te plegen op en misbruik van softwaresystemen.</span><span class="sxs-lookup"><span data-stu-id="62667-197">Hackers are regularly trying to compromise and exploit software systems.</span></span> <span data-ttu-id="62667-198">Als dat lukt, is het gebruikelijk zijn voor het installeren van bestanden en de status van een geïnfecteerd systeem anders te wijzigen.</span><span class="sxs-lookup"><span data-stu-id="62667-198">When successful, it's common to install files and otherwise change the state of a compromised system.</span></span> <span data-ttu-id="62667-199">Configuratie van de gewenste status wordt gebruikt, kunt u zien delta's tussen de status van de gewenste en de daadwerkelijke en herstellen van een bekende configuratie.</span><span class="sxs-lookup"><span data-stu-id="62667-199">Using desired state configuration, you can identify deltas between the desired and actual state and restore a known configuration.</span></span>

<span data-ttu-id="62667-200">Er zijn resource-uitbreidingen voor de meest populaire mechanismen voor DSC - PowerShell DSC, Chef en Puppet.</span><span class="sxs-lookup"><span data-stu-id="62667-200">There are resource extensions for the most popular mechanisms for DSC - PowerShell DSC, Chef, and Puppet.</span></span> <span data-ttu-id="62667-201">Elk van deze extensies de beginstatus van de virtuele machine kunt implementeren en ook worden gebruikt om ervoor te zorgen dat de gewenste status wordt bijgehouden.</span><span class="sxs-lookup"><span data-stu-id="62667-201">Each of these extensions can deploy the initial state of your VM and also be used to make sure the desired state is maintained.</span></span>

## <a name="common-template-scopes"></a><span data-ttu-id="62667-202">Algemene sjabloon scopes</span><span class="sxs-lookup"><span data-stu-id="62667-202">Common template scopes</span></span>
<span data-ttu-id="62667-203">In onze ervaring hebt we drie key-oplossing sjablonen scopes ontstaan gezien.</span><span class="sxs-lookup"><span data-stu-id="62667-203">In our experience, we’ve seen three key solution templates scopes emerge.</span></span> <span data-ttu-id="62667-204">Deze drie scopes, capaciteit, functionaliteit en end-to-end-oplossing, worden in de volgende secties beschreven.</span><span class="sxs-lookup"><span data-stu-id="62667-204">These three scopes – capacity, capability, and end-to-end solution – are described in the following sections.</span></span>

### <a name="capacity-scope"></a><span data-ttu-id="62667-205">Capaciteit bereik</span><span class="sxs-lookup"><span data-stu-id="62667-205">Capacity scope</span></span>
<span data-ttu-id="62667-206">Een scope capaciteit biedt een aantal resources in een standaard topologie die is vooraf geconfigureerd moet voldoen aan de voorschriften en het beleid.</span><span class="sxs-lookup"><span data-stu-id="62667-206">A capacity scope delivers a set of resources in a standard topology that is pre-configured to be in compliance with regulations and policies.</span></span> <span data-ttu-id="62667-207">De meest voorkomende voorbeeld is een standaard ontwikkelingsomgeving in een Enterprise-IT of SI-scenario implementeren.</span><span class="sxs-lookup"><span data-stu-id="62667-207">The most common example is deploying a standard development environment in an Enterprise IT or SI scenario.</span></span>

### <a name="capability-scope"></a><span data-ttu-id="62667-208">Mogelijkheid bereik</span><span class="sxs-lookup"><span data-stu-id="62667-208">Capability scope</span></span>
<span data-ttu-id="62667-209">Een scope mogelijkheid is gericht op het implementeren en configureren van een topologie voor een bepaalde technologie.</span><span class="sxs-lookup"><span data-stu-id="62667-209">A capability scope is focused on deploying and configuring a topology for a given technology.</span></span> <span data-ttu-id="62667-210">Algemene scenario's met inbegrip van technologieën zoals SQL Server, Cassandra, Hadoop.</span><span class="sxs-lookup"><span data-stu-id="62667-210">Common scenarios including technologies such as SQL Server, Cassandra, Hadoop.</span></span>

### <a name="end-to-end-solution-scope"></a><span data-ttu-id="62667-211">End-to-end oplossing bereik</span><span class="sxs-lookup"><span data-stu-id="62667-211">End-to-end solution scope</span></span>
<span data-ttu-id="62667-212">Een End-to-End oplossing bereik is gericht dan een enkele functie en in plaats daarvan zijn gericht op een end-to-end-oplossing die bestaat uit meerdere mogelijkheden.</span><span class="sxs-lookup"><span data-stu-id="62667-212">An End-to-End Solution Scope is targeted beyond a single capability, and instead focused on delivering an end to end solution comprised of multiple capabilities.</span></span>  

<span data-ttu-id="62667-213">Een sjabloon gericht op de oplossing scope doet zich voor als een set van een of meer sjablonen voor gericht op de mogelijkheid met oplossings-specifieke bronnen, de logica en de gewenste status.</span><span class="sxs-lookup"><span data-stu-id="62667-213">A solution-scoped template scope manifests itself as a set of one or more capability-scoped templates with solution-specific resources, logic, and desired state.</span></span> <span data-ttu-id="62667-214">Een voorbeeld van een sjabloon gericht op de oplossing is een complete pijplijn oplossing gegevenssjabloon.</span><span class="sxs-lookup"><span data-stu-id="62667-214">An example of a solution-scoped template is an end to end data pipeline solution template.</span></span> <span data-ttu-id="62667-215">De sjabloon kan oplossings-specifieke topologie en status meng met meerdere gericht op de mogelijkheid oplossingssjablonen zoals Kafka, Storm en Hadoop.</span><span class="sxs-lookup"><span data-stu-id="62667-215">The template might mix solution-specific topology and state with multiple capability-scoped solution templates such as Kafka, Storm, and Hadoop.</span></span>

## <a name="choosing-free-form-vs-known-configurations"></a><span data-ttu-id="62667-216">Gratis formulier versus bekende configuraties te kiezen</span><span class="sxs-lookup"><span data-stu-id="62667-216">Choosing free-form vs. known configurations</span></span>
<span data-ttu-id="62667-217">U kunt in eerste instantie een sjabloon moet verschaffen consument de grootste flexibiliteit, maar de keuze van of u wilt gebruiken, vrije vorm configuraties versus bekende configuraties van invloed op een aantal zaken overwegen.</span><span class="sxs-lookup"><span data-stu-id="62667-217">You might initially think a template should give consumers the utmost flexibility, but many considerations affect the choice of whether to use free-form configurations vs. known configurations.</span></span> <span data-ttu-id="62667-218">Deze sectie worden de belangrijkste klantvereisten en technische overwegingen die in de vorm van de aanpak gedeeld in dit document.</span><span class="sxs-lookup"><span data-stu-id="62667-218">This section identifies the key customer requirements and technical considerations that shaped the approach shared in this document.</span></span>

### <a name="free-form-configurations"></a><span data-ttu-id="62667-219">Vrije-configuraties</span><span class="sxs-lookup"><span data-stu-id="62667-219">Free-form configurations</span></span>
<span data-ttu-id="62667-220">Op het aardoppervlak geluid vrije vorm configuraties ideaal.</span><span class="sxs-lookup"><span data-stu-id="62667-220">On the surface, free-form configurations sound ideal.</span></span> <span data-ttu-id="62667-221">Ze kunt u een VM-type selecteren en een willekeurig aantal knooppunten en de gekoppelde schijven voor knooppunten, en als parameters om een sjabloon te doen.</span><span class="sxs-lookup"><span data-stu-id="62667-221">They allow you to select a VM type and provide an arbitrary number of nodes and attached disks for those nodes — and do so as parameters to a template.</span></span> <span data-ttu-id="62667-222">Deze aanpak is echter niet ideaal voor een aantal scenario's.</span><span class="sxs-lookup"><span data-stu-id="62667-222">However, this approach is not ideal for some scenarios.</span></span>

<span data-ttu-id="62667-223">In [grootten voor virtuele machines](../virtual-machines/windows/sizes.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json), worden geïdentificeerd door de verschillende typen van de virtuele machine en de beschikbare grootten en elk van het aantal duurzame schijven (2, 4, 8, 16 of 32) die kan worden gekoppeld.</span><span class="sxs-lookup"><span data-stu-id="62667-223">In [Sizes for virtual machines](../virtual-machines/windows/sizes.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json), the different VM types and available sizes are identified, and each of the number of durable disks (2, 4, 8, 16, or 32) that can be attached.</span></span> <span data-ttu-id="62667-224">Elke gekoppelde schijf biedt 500 IOPS en veelvouden van deze schijven kunnen worden gegroepeerd voor vermenigvuldigingsfactor dat aantal IOPS.</span><span class="sxs-lookup"><span data-stu-id="62667-224">Each attached disk provides 500 IOPS and multiples of these disks can be pooled for a multiplier of that number of IOPS.</span></span> <span data-ttu-id="62667-225">16 schijven kunnen bijvoorbeeld worden gegroepeerd om 8000 IOP's bieden.</span><span class="sxs-lookup"><span data-stu-id="62667-225">For example, 16 disks can be pooled to provide 8,000 IOPS.</span></span> <span data-ttu-id="62667-226">Groeperen wordt met configuratie in het besturingssysteem, met behulp van Microsoft Windows Storage Spaces of redundante matrix van goedkope schijven (RAID) in Linux uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="62667-226">Pooling is done with configuration in the operating system, using Microsoft Windows Storage Spaces or redundant array of inexpensive disks (RAID) in Linux.</span></span>

<span data-ttu-id="62667-227">De selectie van de configuratie van een vrije vorm kan enkele VM-instanties verschillende VM typen en groottes voor ALE exemplaren, verschillende schijven voor het VM-type en een of meer scripts voor het configureren van de VM-inhoud.</span><span class="sxs-lookup"><span data-stu-id="62667-227">A free-form configuration enables the selection several VM instances, various VM types and sizes for those instances, various disks for the VM type, and one or more scripts to configure the VM contents.</span></span>

<span data-ttu-id="62667-228">Het is gebruikelijk dat een implementatie mogelijk meerdere typen knooppunten, zoals de master- en gegevensknooppunten, zodat deze flexibiliteit vaak voor elk knooppunttype is opgegeven.</span><span class="sxs-lookup"><span data-stu-id="62667-228">It is common that a deployment may have multiple types of nodes, such as master and data nodes, so this flexibility is often provided for every node type.</span></span>

<span data-ttu-id="62667-229">Als u begint met het implementeren van clusters een significante, wordt u begint te werken met deze complexe scenario's.</span><span class="sxs-lookup"><span data-stu-id="62667-229">As you start to deploy clusters of any significance, you begin to work with these complex scenarios.</span></span> <span data-ttu-id="62667-230">Als u een Hadoop-cluster zijn implementeert, bijvoorbeeld zou met 8 hoofdknooppunten 200 gegevensknooppunten en gegroepeerde 4 gekoppelde schijven op elk knooppunt master en gegroepeerde 16 gekoppelde schijven per gegevensknooppunt, er 208 VM's en 3,232 schijven te beheren.</span><span class="sxs-lookup"><span data-stu-id="62667-230">If you were deploying a Hadoop cluster, for example, with 8 master nodes and 200 data nodes, and pooled 4 attached disks on each master node and pooled 16 attached disks per data node, you would have 208 VMs and 3,232 disks to manage.</span></span>

<span data-ttu-id="62667-231">Een opslagaccount, wordt de geïdentificeerde 20.000 transacties per seconde beperken, zodat u moet partitioneren van de storage-account kijken en berekeningen gebruiken om te bepalen van het juiste aantal opslagaccounts voor deze topologie bovenstaande aanvragen vertraging.</span><span class="sxs-lookup"><span data-stu-id="62667-231">A storage account will throttle requests above its identified 20,000 transactions/second limit, so you should look at storage account partitioning and use calculations to determine the appropriate number of storage accounts to accommodate this topology.</span></span> <span data-ttu-id="62667-232">Gezien het grote aantal combinaties die worden ondersteund door de vrije vorm benadering, zijn dynamische berekeningen nodig om te bepalen van de juiste partitionering.</span><span class="sxs-lookup"><span data-stu-id="62667-232">Given the multitude of combinations supported by the free-form approach, dynamic calculations are required to determine the appropriate partitioning.</span></span> <span data-ttu-id="62667-233">De taal van de Azure Resource Manager-sjabloon biedt momenteel geen wiskundige functies, dus u moet deze berekeningen uitvoeren in code genereren van een unieke, vastgelegde sjabloon met de juiste informatie.</span><span class="sxs-lookup"><span data-stu-id="62667-233">The Azure Resource Manager Template Language does not presently provide mathematical functions, so you must perform these calculations in code, generating a unique, hard-coded template with the appropriate details.</span></span>

<span data-ttu-id="62667-234">In de enterprise IT en SI-scenario's, moet iemand onderhouden van de sjablonen en ondersteuning voor de geïmplementeerde topologieën voor een of meer organisaties.</span><span class="sxs-lookup"><span data-stu-id="62667-234">In enterprise IT and SI scenarios, someone must maintain the templates and support the deployed topologies for one or more organizations.</span></span> <span data-ttu-id="62667-235">Deze extra overhead: verschillende configuraties en sjablonen voor elke klant: sterk wenselijk.</span><span class="sxs-lookup"><span data-stu-id="62667-235">This additional overhead — different configurations and templates for each customer — is far from desirable.</span></span>

<span data-ttu-id="62667-236">U kunt deze sjablonen gebruiken voor het implementeren van omgevingen in Azure-abonnement van uw klant, maar zakelijke IT-teams en CSV's doorgaans deze implementeren in hun eigen abonnementen, met behulp van een functie terugstorting aan hun klanten factureren.</span><span class="sxs-lookup"><span data-stu-id="62667-236">You can use these templates to deploy environments in your customer’s Azure subscription, but both corporate IT teams and CSVs typically deploy them into their own subscriptions, using a chargeback function to bill their customers.</span></span> <span data-ttu-id="62667-237">In deze scenario's, het doel is om te capaciteit voor meerdere klanten in een pool van abonnementen implementeren en implementaties veel ingevuld in de abonnementen op abonnement kabels minimaliseren, dat wil zeggen, meer abonnementen beheren.</span><span class="sxs-lookup"><span data-stu-id="62667-237">In these scenarios, the goal is to deploy capacity for multiple customers across a pool of subscriptions and keep deployments densely populated into the subscriptions to minimize subscription sprawl—that is, more subscriptions to manage.</span></span> <span data-ttu-id="62667-238">Met echt dynamische implementatiegrootte vereist bereiken van dit type dichtheid zorgvuldige planning en extra ontwikkeling voor steigers werk voor de hele organisatie.</span><span class="sxs-lookup"><span data-stu-id="62667-238">With truly dynamic deployment sizes, achieving this type of density requires careful planning and additional development for scaffolding work on behalf of the organization.</span></span>

<span data-ttu-id="62667-239">Bovendien geen abonnementen via een API-aanroep kunt maken maar handmatig moet doen via de portal.</span><span class="sxs-lookup"><span data-stu-id="62667-239">In addition, you can’t create subscriptions via an API call but must do so manually through the portal.</span></span> <span data-ttu-id="62667-240">Als het aantal abonnementen toeneemt, alle resulterende abonnement kabels menselijke tussenkomst vereist, kan niet worden geautomatiseerd.</span><span class="sxs-lookup"><span data-stu-id="62667-240">As the number of subscriptions increases, any resulting subscription sprawl requires human intervention—it can’t be automated.</span></span> <span data-ttu-id="62667-241">U moet een aantal abonnementen handmatig om ervoor te zorgen abonnementen beschikbaar zijn in te richten met zoveel variabiliteit in de grootte van de implementaties.</span><span class="sxs-lookup"><span data-stu-id="62667-241">With so much variability in the sizes of deployments, you would have to pre-provision a number of subscriptions manually to ensure subscriptions are available.</span></span>

<span data-ttu-id="62667-242">Deze factoren in overweging moet aan een werkelijk vrije vorm-configuratie is minder dan ten eerste blush interessante.</span><span class="sxs-lookup"><span data-stu-id="62667-242">Considering all these factors, a truly free-form configuration is less appealing than at first blush.</span></span>

### <a name="known-configurations--the-t-shirt-sizing-approach"></a><span data-ttu-id="62667-243">Bekende configuraties, de aanpak van t-shirt schaling</span><span class="sxs-lookup"><span data-stu-id="62667-243">Known configurations — the t-shirt sizing approach</span></span>
<span data-ttu-id="62667-244">In plaats daarvan dan een sjabloon die voorziet in totaal flexibiliteit en talloze variaties bieden, in onze ervaring een algemene patroon is om aan te bieden de mogelijkheid om te selecteren van bekende configuraties — in feite standaard t-shirt groottes zoals sandbox, kleine, middelgrote en grote.</span><span class="sxs-lookup"><span data-stu-id="62667-244">Rather than offer a template that provides total flexibility and countless variations, in our experience a common pattern is to provide the ability to select known configurations — in effect, standard t-shirt sizes such as sandbox, small, medium, and large.</span></span> <span data-ttu-id="62667-245">Andere voorbeelden van t-shirt grootten zijn de producten, zoals community edition of enterprise edition.</span><span class="sxs-lookup"><span data-stu-id="62667-245">Other examples of t-shirt sizes are product offerings, such as community edition or enterprise edition.</span></span>  <span data-ttu-id="62667-246">In andere gevallen mogelijk werklastspecifiek configuraties van een technologie – zoals kaart verminderen of er zijn geen sql.</span><span class="sxs-lookup"><span data-stu-id="62667-246">In other cases, it may be workload-specific configurations of a technology – such as map reduce or no sql.</span></span>

<span data-ttu-id="62667-247">Veel bedrijven organisaties, OSS-leveranciers en SIs Maak de offerings beschikbaar zijn op deze manier in on-premises gevirtualiseerde omgevingen (ondernemingen) of als software as a service (SaaS)-aanbiedingen (CSV's en OSVs).</span><span class="sxs-lookup"><span data-stu-id="62667-247">Many enterprise IT organizations, OSS vendors, and SIs make their offerings available today in this way in on-premises, virtualized environments (enterprises) or as software-as-a-service (SaaS) offerings (CSVs and OSVs).</span></span>

<span data-ttu-id="62667-248">Deze aanpak geeft goede, bekende configuraties van verschillende grootten die vooraf zijn geconfigureerd voor klanten.</span><span class="sxs-lookup"><span data-stu-id="62667-248">This approach provides good, known configurations of varying sizes that are preconfigured for customers.</span></span> <span data-ttu-id="62667-249">Zonder bekende configuraties moeten end klanten cluster formaat op hun eigen bepalen, rekening te houden in resourcebeperkingen platform en rekenen om te identificeren van de resulterende partitionering van storage-accounts en andere bronnen (vanwege beperkingen van cluster grootte en resource).</span><span class="sxs-lookup"><span data-stu-id="62667-249">Without known configurations, end customers must determine cluster sizing on their own, factor in platform resource constraints, and do math to identify the resulting partitioning of storage accounts and other resources (due to cluster size and resource constraints).</span></span> <span data-ttu-id="62667-250">Bekende configuraties kunnen klanten eenvoudig selecteert u de juiste t-shirt grootte — dat wil zeggen, een bepaalde implementatie.</span><span class="sxs-lookup"><span data-stu-id="62667-250">Known configurations enable customers to easily select the right t-shirt size—that is, a given deployment.</span></span> <span data-ttu-id="62667-251">Naast het maken van een betere ervaring voor de klant, een klein aantal bekende configuraties is gemakkelijker te ondersteunen en kunt u een hoger niveau van de dichtheid leveren.</span><span class="sxs-lookup"><span data-stu-id="62667-251">In addition to making a better experience for the customer, a small number of known configurations is easier to support and can help you deliver a higher level of density.</span></span>

<span data-ttu-id="62667-252">Een benadering bekende configuratie is gericht op t-shirt grootten kan ook verschillend aantal knooppunten binnen een grootte hebben.</span><span class="sxs-lookup"><span data-stu-id="62667-252">A known configuration approach focused on t-shirt sizes may also have varying number of nodes within a size.</span></span> <span data-ttu-id="62667-253">Bijvoorbeeld, een klein t-shirt mogelijk tussen 3 en 10 knooppunten.</span><span class="sxs-lookup"><span data-stu-id="62667-253">For example, a small t-shirt size may be between 3 and 10 nodes.</span></span>  <span data-ttu-id="62667-254">De grootte van de t-shirt zou worden ontworpen om geschikt voor maximaal 10 knooppunten en de consument bieden de mogelijkheid om selecties tot de maximale grootte geïdentificeerd vrije vorm te maken.</span><span class="sxs-lookup"><span data-stu-id="62667-254">The t-shirt size would be designed to accommodate up to 10 nodes and provide the consumer the ability to make free form selections up to the maximum size identified.</span></span>  

<span data-ttu-id="62667-255">De grootte van een t-shirt op basis van het type werkbelasting, mogelijk meer vrije vorm van aard in termen van het aantal knooppunten dat kan worden geïmplementeerd, maar heeft verschillende knooppunt werkbelastingsgrootte en configuratie van de software op het knooppunt.</span><span class="sxs-lookup"><span data-stu-id="62667-255">A t-shirt size based on workload type, may be more free form in nature in terms of the number of nodes that can be deployed but will have workload distinct node size and configuration of the software on the node.</span></span>

<span data-ttu-id="62667-256">T-shirt grootten op basis van producten, zoals community of Enterprise, mogelijk verschillende resourcetypen en maximum aantal knooppunten dat kan worden geïmplementeerd, worden doorgaans gekoppeld aan de licenties of beschikbaarheid van functies tussen de verschillende aanbiedingen.</span><span class="sxs-lookup"><span data-stu-id="62667-256">T-shirt sizes based on product offerings, such as community or Enterprise, may have distinct resource types and maximum number of nodes that can be deployed, typically tied to licensing considerations or feature availability across the different offerings.</span></span>

<span data-ttu-id="62667-257">U kunt ook geschikt voor klanten met unieke varianten met behulp van de sjablonen JSON-indeling.</span><span class="sxs-lookup"><span data-stu-id="62667-257">You can also accommodate customers with unique variants using the JSON-based templates.</span></span> <span data-ttu-id="62667-258">Uitschieters betreft, kunt u de juiste planning en overwegingen voor ontwikkeling, ondersteuning en de kosten kunt opnemen.</span><span class="sxs-lookup"><span data-stu-id="62667-258">When dealing with outliers, you can incorporate the appropriate planning and considerations for development, support, and costing.</span></span>

<span data-ttu-id="62667-259">Op basis van de klant sjabloon verbruik scenario's en vereisten geïdentificeerd aan het begin van dit document, wordt een patroon voor de sjabloon ontleding geïdentificeerd.</span><span class="sxs-lookup"><span data-stu-id="62667-259">Based on the customer template consumption scenarios, and requirements identified at the start of this document, we identified a pattern for template decomposition.</span></span>

## <a name="capacity-and-capability-scoped-solution-templates"></a><span data-ttu-id="62667-260">Capaciteit en de mogelijkheid bereik oplossingssjablonen</span><span class="sxs-lookup"><span data-stu-id="62667-260">Capacity and capability-scoped solution templates</span></span>
<span data-ttu-id="62667-261">Afbreken biedt een modulaire benadering voor de ontwikkeling van de sjabloon die ondersteunt opnieuw gebruiken, uitbreidbaarheid, testen en tooling.</span><span class="sxs-lookup"><span data-stu-id="62667-261">Decomposition provides a modular approach to template development that supports reuse, extensibility, testing, and tooling.</span></span> <span data-ttu-id="62667-262">Deze sectie bevat details over hoe een benadering afbreken met sjablonen met een capaciteit of mogelijkheden bereik kan worden toegepast.</span><span class="sxs-lookup"><span data-stu-id="62667-262">This section provides detail on how a decomposition approach can be applied to templates with a Capacity or Capability scope.</span></span>

<span data-ttu-id="62667-263">Deze aanpak een belangrijkste sjabloon parameterwaarden ontvangt van een consumer sjabloon vervolgens koppelingen naar diverse typen sjablonen en scripts downstream zoals hieronder wordt weergegeven.</span><span class="sxs-lookup"><span data-stu-id="62667-263">In this approach, a main template receives parameter values from a template consumer, then links to several types of templates and scripts downstream as shown below.</span></span> <span data-ttu-id="62667-264">Parameters en variabelen met statische gegenereerde variabelen worden gebruikt om waarden in en uit de gekoppelde sjablonen te leveren.</span><span class="sxs-lookup"><span data-stu-id="62667-264">Parameters, static variables, and generated variables are used to provide values in and out of the linked templates.</span></span>

![Sjabloonparameters](./media/best-practices-resource-manager-design-templates/template-parameters.png)

<span data-ttu-id="62667-266">**Parameters worden doorgegeven aan een belangrijkste sjabloon vervolgens naar de gekoppelde sjablonen**</span><span class="sxs-lookup"><span data-stu-id="62667-266">**Parameters are passed to a main template then to linked templates**</span></span>

<span data-ttu-id="62667-267">De volgende secties zich richten op de typen sjablonen en scripts die één sjabloon is onderverdeeld.</span><span class="sxs-lookup"><span data-stu-id="62667-267">The following sections focus on the types of templates and scripts that a single template is decomposed into.</span></span> <span data-ttu-id="62667-268">De secties vindt u methoden voor het doorgeven van informatie over de status van de sjablonen.</span><span class="sxs-lookup"><span data-stu-id="62667-268">The sections present approaches for passing state information among the templates.</span></span> <span data-ttu-id="62667-269">Elke sjabloon en de scripttypen in de installatiekopie worden samen met voorbeelden beschreven.</span><span class="sxs-lookup"><span data-stu-id="62667-269">Each template and the script types in the image are described along with examples.</span></span> <span data-ttu-id="62667-270">Zie voor een voorbeeld contextuele ' samen te stellen: een voorbeeldimplementatie ' verderop in dit document.</span><span class="sxs-lookup"><span data-stu-id="62667-270">For a contextual example, see "Putting it together: a sample implementation" later in this document.</span></span>

### <a name="template-metadata"></a><span data-ttu-id="62667-271">Metagegevens van de sjabloon</span><span class="sxs-lookup"><span data-stu-id="62667-271">Template metadata</span></span>
<span data-ttu-id="62667-272">Metagegevens van de sjabloon (het metadata.json-bestand) bevat een sleutel-waardeparen die een sjabloon in de JSON die kan worden gelezen door mensen en softwaresystemen te beschrijven.</span><span class="sxs-lookup"><span data-stu-id="62667-272">Template metadata (the metadata.json file) contains key/value pairs that describe a template in JSON, which can be read by humans and software systems.</span></span>

![Metagegevens van de sjabloon](./media/best-practices-resource-manager-design-templates/template-metadata.png)

<span data-ttu-id="62667-274">**Metagegevens van de sjabloon wordt beschreven in het bestand metadata.json**</span><span class="sxs-lookup"><span data-stu-id="62667-274">**Template metadata is described in the metadata.json file**</span></span>

<span data-ttu-id="62667-275">Softwareagents kunnen ophalen van het bestand metadata.json en publiceren van de informatie en een koppeling naar de sjabloon in een webpagina of directory.</span><span class="sxs-lookup"><span data-stu-id="62667-275">Software agents can retrieve the metadata.json file and publish the information and a link to the template in a web page or directory.</span></span> <span data-ttu-id="62667-276">Elementen zijn *itemDisplayName*, *beschrijving*, *samenvatting*, *githubUsername*, en *dateUpdated*.</span><span class="sxs-lookup"><span data-stu-id="62667-276">Elements include *itemDisplayName*, *description*, *summary*, *githubUsername*, and *dateUpdated*.</span></span>

<span data-ttu-id="62667-277">Een voorbeeld van een bestand wordt hieronder weergegeven in zijn geheel.</span><span class="sxs-lookup"><span data-stu-id="62667-277">An example file is shown below in its entirety.</span></span>

    {
        "itemDisplayName": "PostgreSQL 9.3 on Ubuntu VMs",
        "description": "This template creates a PostgreSQL streaming-replication between a master and one or more slave servers each with 2 striped data disks. The database servers are deployed into a private-only subnet with one publicly accessible jumpbox VM in a DMZ subnet with public IP.",
        "summary": "PostgreSQL stream-replication with multiple slave servers and a publicly accessible jumpbox VM",
        "githubUsername": "arsenvlad",
        "dateUpdated": "2015-04-24"
    }

### <a name="main-template"></a><span data-ttu-id="62667-278">Belangrijkste sjabloon</span><span class="sxs-lookup"><span data-stu-id="62667-278">Main template</span></span>
<span data-ttu-id="62667-279">De belangrijkste sjabloon parameters van een gebruiker ontvangt, die gegevens worden gebruikt voor het vullen van complexe objectvariabelen en de gekoppelde sjablonen wordt uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="62667-279">The main template receives parameters from a user, uses that information to populate complex object variables, and executes the linked templates.</span></span>

![Belangrijkste sjabloon](./media/best-practices-resource-manager-design-templates/main-template.png)

<span data-ttu-id="62667-281">**De belangrijkste sjabloon ontvangt parameters van een gebruiker**</span><span class="sxs-lookup"><span data-stu-id="62667-281">**The main template receives parameters from a user**</span></span>

<span data-ttu-id="62667-282">Een parameter die is opgegeven is een bekende configuratietype ook wel bekend als de parameter voor de t-shirt vanwege de gestandaardiseerde waarden zoals klein, normaal of groot.</span><span class="sxs-lookup"><span data-stu-id="62667-282">One parameter that is provided is a known configuration type also known as the t-shirt size parameter because of its standardized values such as small, medium, or large.</span></span> <span data-ttu-id="62667-283">In de praktijk, kunt u deze parameter op verschillende manieren.</span><span class="sxs-lookup"><span data-stu-id="62667-283">In practice, you can use this parameter in multiple ways.</span></span> <span data-ttu-id="62667-284">Zie 'Bekende configuratie resources sjabloon' verderop in dit document voor meer informatie.</span><span class="sxs-lookup"><span data-stu-id="62667-284">For details, see "Known configuration resources template" later in this document.</span></span>

<span data-ttu-id="62667-285">Sommige resources worden ongeacht de bekende configuratie wordt opgegeven door de parameter van een gebruiker geïmplementeerd.</span><span class="sxs-lookup"><span data-stu-id="62667-285">Some resources are deployed regardless of the known configuration specified by a user parameter.</span></span> <span data-ttu-id="62667-286">Deze resources zijn ingericht met een sjabloon met één gedeelde resource en worden gedeeld door andere sjablonen, dus de sjabloon voor de gedeelde bron eerste wordt uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="62667-286">These resources are provisioned using a single shared resource template and are shared by other templates, so the shared resource template is run first.</span></span>

<span data-ttu-id="62667-287">Sommige resources zijn optioneel ongeacht de opgegeven configuratie voor bekende geïmplementeerd.</span><span class="sxs-lookup"><span data-stu-id="62667-287">Some resources are deployed optionally regardless of the specified known configuration.</span></span>

### <a name="shared-resources-template"></a><span data-ttu-id="62667-288">Gedeelde bronnen sjabloon</span><span class="sxs-lookup"><span data-stu-id="62667-288">Shared resources template</span></span>
<span data-ttu-id="62667-289">Deze sjabloon biedt resources die door alle bekende configuraties gedeeld worden.</span><span class="sxs-lookup"><span data-stu-id="62667-289">This template delivers resources that are common across all known configurations.</span></span> <span data-ttu-id="62667-290">Het bevat het virtuele netwerk, beschikbaarheidssets en andere bronnen die zijn vereist, ongeacht de bekende configuratie-sjabloon die wordt geïmplementeerd.</span><span class="sxs-lookup"><span data-stu-id="62667-290">It contains the virtual network, availability sets, and other resources that are required regardless of the known configuration template that is deployed.</span></span>

![Sjabloonresources](./media/best-practices-resource-manager-design-templates/template-resources.png)

<span data-ttu-id="62667-292">**Gedeelde bronnen sjabloon**</span><span class="sxs-lookup"><span data-stu-id="62667-292">**Shared resources template**</span></span>

<span data-ttu-id="62667-293">Resourcenamen, zoals de naam van het virtuele netwerk zijn gebaseerd op de belangrijkste sjabloon.</span><span class="sxs-lookup"><span data-stu-id="62667-293">Resource names, such as the virtual network name, are based on the main template.</span></span> <span data-ttu-id="62667-294">U kunt ze als een variabele in die sjabloon opgeven of ze ontvangen als een parameter van de gebruiker, zoals vereist door uw organisatie.</span><span class="sxs-lookup"><span data-stu-id="62667-294">You can specify them as a variable within that template or receive them as a parameter from the user, as required by your organization.</span></span>

### <a name="optional-resources-template"></a><span data-ttu-id="62667-295">Optionele resources sjabloon</span><span class="sxs-lookup"><span data-stu-id="62667-295">Optional resources template</span></span>
<span data-ttu-id="62667-296">De sjabloon optionele resources bevat resources die programmatisch zijn geïmplementeerd op basis van de waarde van een parameter of variabele.</span><span class="sxs-lookup"><span data-stu-id="62667-296">The optional resources template contains resources that are programmatically deployed based on the value of a parameter or variable.</span></span>

![Optionele resources](./media/best-practices-resource-manager-design-templates/optional-resources.png)

<span data-ttu-id="62667-298">**Optionele resources sjabloon**</span><span class="sxs-lookup"><span data-stu-id="62667-298">**Optional resources template**</span></span>

<span data-ttu-id="62667-299">U kunt bijvoorbeeld een sjabloon optionele resources voor het configureren van een jumpbox waarmee indirecte toegang aan een gedistribueerde omgeving van het openbare Internet.</span><span class="sxs-lookup"><span data-stu-id="62667-299">For example, you can use an optional resources template to configure a jumpbox that enables indirect access to a deployed environment from the public Internet.</span></span> <span data-ttu-id="62667-300">U zou een parameter of variabele gebruiken om te bepalen of de jumpbox moet worden ingeschakeld en de *concat* functie voor het bouwen van de naam van het doel voor de sjabloon, zoals *jumpbox_enabled.json*.</span><span class="sxs-lookup"><span data-stu-id="62667-300">You would use a parameter or variable to identify whether the jumpbox should be enabled and the *concat* function to build the target name for the template, such as *jumpbox_enabled.json*.</span></span> <span data-ttu-id="62667-301">Sjabloon koppelen, zou de resulterende variabele voor het installeren van de jumpbox gebruiken.</span><span class="sxs-lookup"><span data-stu-id="62667-301">Template linking would use the resulting variable to install the jumpbox.</span></span>

<span data-ttu-id="62667-302">U kunt een koppeling van de sjabloon optionele resources vanaf meerdere locaties:</span><span class="sxs-lookup"><span data-stu-id="62667-302">You can link the optional resources template from multiple places:</span></span>

* <span data-ttu-id="62667-303">Wanneer voor elke implementatie, maakt u een koppeling basis van parameters van de sjabloon gedeelde bronnen.</span><span class="sxs-lookup"><span data-stu-id="62667-303">When applicable to every deployment, create a parameter-driven link from the shared resources template.</span></span>
* <span data-ttu-id="62667-304">Indien van toepassing om te selecteren van bekende configuraties — bijvoorbeeld alleen installeren op grote implementaties: Maak een koppeling aangestuurde parameter of variabele op basis van beschikbare resources van de sjabloon bekende configuratie.</span><span class="sxs-lookup"><span data-stu-id="62667-304">When applicable to select known configurations—for example, only install on large deployments—create a parameter-driven or variable-driven link from the known configuration template.</span></span>

<span data-ttu-id="62667-305">Hiermee wordt aangegeven of een bepaalde bron is optioneel mag niet worden aangedreven door de consument sjabloon maar door de sjabloonprovider.</span><span class="sxs-lookup"><span data-stu-id="62667-305">Whether a given resource is optional may not be driven by the template consumer but instead by the template provider.</span></span> <span data-ttu-id="62667-306">Bijvoorbeeld, moet u mogelijk om te voldoen aan een bepaald Productvereiste of product-invoegtoepassing (algemeen voor CSV's) of beleidsregels afdwingen (common voor SIs- en enterprise IT groepen).</span><span class="sxs-lookup"><span data-stu-id="62667-306">For example, you may need to satisfy a particular product requirement or product add-on (common for CSVs) or to enforce policies (common for SIs and enterprise IT groups).</span></span> <span data-ttu-id="62667-307">In dergelijke gevallen kunt u een variabele gebruiken om te bepalen of de resource moet worden geïmplementeerd.</span><span class="sxs-lookup"><span data-stu-id="62667-307">In these cases, you can use a variable to identify whether the resource should be deployed.</span></span>

### <a name="known-configuration-resources-template"></a><span data-ttu-id="62667-308">Configuratie voor bekende bronnen sjabloon</span><span class="sxs-lookup"><span data-stu-id="62667-308">Known configuration resources template</span></span>
<span data-ttu-id="62667-309">In de belangrijkste sjabloon kan een parameter worden blootgesteld zodat de consument sjabloon een gewenste bekende configuratie te implementeren op te geven.</span><span class="sxs-lookup"><span data-stu-id="62667-309">In the main template, a parameter can be exposed to allow the template consumer to specify a desired known configuration to deploy.</span></span> <span data-ttu-id="62667-310">Deze bekende configuratie wordt vaak een benadering van de grootte t-shirt gebruikt met een set van configuratie van vaste grootte zoals sandbox, klein, normaal en groot.</span><span class="sxs-lookup"><span data-stu-id="62667-310">Often, this known configuration uses a t-shirt size approach with a set of fixed configuration sizes such as sandbox, small, medium, and large.</span></span>

![Configuratie voor bekende bronnen](./media/best-practices-resource-manager-design-templates/known-config.png)

<span data-ttu-id="62667-312">**Configuratie voor bekende bronnen sjabloon**</span><span class="sxs-lookup"><span data-stu-id="62667-312">**Known configuration resources template**</span></span>

<span data-ttu-id="62667-313">De grootte t-shirt benadering wordt meestal gebruikt, maar de parameters kunnen bestaan uit een reeks bekende configuraties.</span><span class="sxs-lookup"><span data-stu-id="62667-313">The t-shirt size approach is commonly used, but the parameters can represent any set of known configurations.</span></span> <span data-ttu-id="62667-314">U kunt bijvoorbeeld een reeks omgevingen voor een zakelijke toepassing zoals ontwikkelen, testen en Product opgeven.</span><span class="sxs-lookup"><span data-stu-id="62667-314">For example, you can specify a set of environments for an enterprise application such as Development, Test, and Product.</span></span> <span data-ttu-id="62667-315">Of u deze voor een cloudservice kunt gebruiken om aan te duiden schaaleenheden voor verschillende versies van het product of configuraties van het product zoals Community-, Developer- of Enterprise.</span><span class="sxs-lookup"><span data-stu-id="62667-315">Or you could use it for a cloud service to represent different scale units, product versions, or product configurations such as Community, Developer, or Enterprise.</span></span>

<span data-ttu-id="62667-316">Net als bij de gedeelde bron-sjabloon, worden variabelen doorgegeven aan de sjabloon bekende configuraties uit:</span><span class="sxs-lookup"><span data-stu-id="62667-316">As with the shared resource template, variables are passed to the known configurations template from either:</span></span>

* <span data-ttu-id="62667-317">Een eindgebruiker — dat wil zeggen, de parameters die worden verzonden naar de belangrijkste sjabloon.</span><span class="sxs-lookup"><span data-stu-id="62667-317">An end user—that is, the parameters sent to the main template.</span></span>
* <span data-ttu-id="62667-318">Een organisatie, dat wil zeggen, de variabelen in de belangrijkste sjabloon die staan voor interne vereisten of beleidsregels.</span><span class="sxs-lookup"><span data-stu-id="62667-318">An organization—that is, the variables in the main template that represent internal requirements or policies.</span></span>

### <a name="member-resources-template"></a><span data-ttu-id="62667-319">Lid resources sjabloon</span><span class="sxs-lookup"><span data-stu-id="62667-319">Member resources template</span></span>
<span data-ttu-id="62667-320">Een of meer knooppunt lidtypen zijn vaak opgenomen binnen een bekende configuratie.</span><span class="sxs-lookup"><span data-stu-id="62667-320">Within a known configuration, one or more member node types are often included.</span></span> <span data-ttu-id="62667-321">Bijvoorbeeld, met Hadoop hebt u hoofdknooppunten- en gegevensknooppunten.</span><span class="sxs-lookup"><span data-stu-id="62667-321">For example, with Hadoop you have master nodes and data nodes.</span></span> <span data-ttu-id="62667-322">Als u MongoDB installeert, hebt u gegevensknooppunten en een instellingen.</span><span class="sxs-lookup"><span data-stu-id="62667-322">If you are installing MongoDB, you have data nodes and an arbiter.</span></span> <span data-ttu-id="62667-323">Als u DataStax implementeert, hebt u gegevensknooppunten en een virtuele machine met OpsCenter geïnstalleerd.</span><span class="sxs-lookup"><span data-stu-id="62667-323">If you are deploying DataStax, you have data nodes and a VM with OpsCenter installed.</span></span>

![Leden resources](./media/best-practices-resource-manager-design-templates/member-resources.png)

<span data-ttu-id="62667-325">**Lid resources sjabloon**</span><span class="sxs-lookup"><span data-stu-id="62667-325">**Member resources template**</span></span>

<span data-ttu-id="62667-326">Elk type knooppunten kan verschillende grootten van virtuele machines, het aantal gekoppelde schijven, scripts voor het installeren en instellen van de knooppunten, de poortconfiguraties voor de virtuele machines, het aantal exemplaren en andere gegevens hebben.</span><span class="sxs-lookup"><span data-stu-id="62667-326">Each type of nodes can have different sizes of VMs, numbers of attached disks, scripts to install and set up the nodes, port configurations for the VMs, number of instances, and other details.</span></span> <span data-ttu-id="62667-327">Zodat elk knooppunttype opgehaald eigen lid resource sjabloon de details bevat voor het implementeren en configureren van een infrastructuur evenals scripts te implementeren en configureren van software binnen de virtuele machine wordt uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="62667-327">So each node type gets its own member resource template, which contains the details for deploying and configuring an infrastructure as well as executing scripts to deploy and configure software within the VM.</span></span>

<span data-ttu-id="62667-328">Voor virtuele machines zijn twee soorten scripts meestal gebruikt, algemeen herbruikbare en aangepaste scripts.</span><span class="sxs-lookup"><span data-stu-id="62667-328">For VMs, typically two types of scripts are used, widely reusable and custom scripts.</span></span>

### <a name="widely-reusable-scripts"></a><span data-ttu-id="62667-329">Algemeen herbruikbare scripts</span><span class="sxs-lookup"><span data-stu-id="62667-329">Widely reusable scripts</span></span>
<span data-ttu-id="62667-330">Algemeen herbruikbare scripts kunnen worden gebruikt over meerdere typen sjablonen.</span><span class="sxs-lookup"><span data-stu-id="62667-330">Widely reusable scripts can be used across multiple types of templates.</span></span> <span data-ttu-id="62667-331">Een van de betere voorbeelden van deze algemeen herbruikbare scripts RAID op Linux groep schijven en een groter aantal IOPS zo ingesteld.</span><span class="sxs-lookup"><span data-stu-id="62667-331">One of the better examples of these widely reusable scripts sets up RAID on Linux to pool disks and gain a greater number of IOPS.</span></span> <span data-ttu-id="62667-332">Ongeacht de software wordt geïnstalleerd in de virtuele machine, biedt dit script hergebruik van bewezen voor algemene scenario's.</span><span class="sxs-lookup"><span data-stu-id="62667-332">Regardless of the software being installed in the VM, this script provides reuse of proven practices for common scenarios.</span></span>

![Herbruikbare scripts](./media/best-practices-resource-manager-design-templates/reusable-scripts.png)

<span data-ttu-id="62667-334">**Lid resources sjablonen kunnen algemeen herbruikbare scripts aanroepen**</span><span class="sxs-lookup"><span data-stu-id="62667-334">**Member resources templates can call widely reusable scripts**</span></span>

### <a name="custom-scripts"></a><span data-ttu-id="62667-335">Aangepaste scripts</span><span class="sxs-lookup"><span data-stu-id="62667-335">Custom scripts</span></span>
<span data-ttu-id="62667-336">Sjablonen roept vaak een of meer scripts die installeren en configureren van software binnen de virtuele machines.</span><span class="sxs-lookup"><span data-stu-id="62667-336">Templates commonly call one or more scripts that install and configure software within VMs.</span></span> <span data-ttu-id="62667-337">Een algemene patroon wordt weergegeven met grote topologieën waarin meerdere exemplaren van een of meer lidtypen zijn geïmplementeerd.</span><span class="sxs-lookup"><span data-stu-id="62667-337">A common pattern is seen with large topologies where multiple instances of one or more member types are deployed.</span></span> <span data-ttu-id="62667-338">Een script voor installatie wordt gestart voor elke virtuele machine die kan worden uitgevoerd parallel, gevolgd door een setup-script dat wordt aangeroepen nadat alle virtuele machines (of alle virtuele machines van het type van een opgegeven lid) zijn geïmplementeerd.</span><span class="sxs-lookup"><span data-stu-id="62667-338">An installation script is initiated for every VM that can be run in parallel, followed by a setup script that is called after all VMs (or all VMs of a given member type) are deployed.</span></span>

![Aangepaste scripts](./media/best-practices-resource-manager-design-templates/custom-scripts.png)

<span data-ttu-id="62667-340">**Lid resources sjablonen kunnen scripts aanroepen voor een specifiek doel zoals VM-configuratie**</span><span class="sxs-lookup"><span data-stu-id="62667-340">**Member resources templates can call scripts for a specific purpose such as VM configuration**</span></span>

## <a name="capability-scoped-solution-template-example---redis"></a><span data-ttu-id="62667-341">Gericht op de mogelijkheid oplossing sjabloon voorbeeld - Redis</span><span class="sxs-lookup"><span data-stu-id="62667-341">Capability-scoped solution template example - Redis</span></span>
<span data-ttu-id="62667-342">Om weer te geven hoe een implementatie mogelijk werken, kunt u een voorbeeld van het bouwen van een sjabloon voor de implementatie en configuratie van Redis in standaard t-shirt grootten gaan we kijken.</span><span class="sxs-lookup"><span data-stu-id="62667-342">To show how an implementation might work, let's look at a practical example of building a template that facilitates the deployment and configuration of Redis in standard t-shirt sizes.</span></span>  

<span data-ttu-id="62667-343">Er zijn een set gedeelde bronnen (virtueel netwerk, storage-account, beschikbaarheidssets) en een optionele bron (jumpbox) voor de implementatie.</span><span class="sxs-lookup"><span data-stu-id="62667-343">For the deployment, there are a set of shared resources (virtual network, storage account, availability sets) and an optional resource (jumpbox).</span></span> <span data-ttu-id="62667-344">Er zijn meerdere bekende configuraties die worden weergegeven als t-shirt grootten (klein, normaal, groot), maar met één knooppunt elk type.</span><span class="sxs-lookup"><span data-stu-id="62667-344">There are multiple known configurations represented as t-shirt sizes (small, medium, large) but each with a single node type.</span></span> <span data-ttu-id="62667-345">Er zijn ook twee specifiek doel-scripts (installatie, configuratie).</span><span class="sxs-lookup"><span data-stu-id="62667-345">There are also two purpose-specific scripts (installation, configuration).</span></span>

### <a name="creating-the-template-files"></a><span data-ttu-id="62667-346">De sjabloonbestanden maken</span><span class="sxs-lookup"><span data-stu-id="62667-346">Creating the template files</span></span>
<span data-ttu-id="62667-347">Maakt u een Main-sjabloon met de naam azuredeploy.json.</span><span class="sxs-lookup"><span data-stu-id="62667-347">You would create a Main Template named azuredeploy.json.</span></span>

<span data-ttu-id="62667-348">Maken van gedeelde Resources sjabloon met de naam gedeeld resources.json</span><span class="sxs-lookup"><span data-stu-id="62667-348">You create Shared Resources Template named shared-resources.json</span></span>

<span data-ttu-id="62667-349">Maken van een optionele Resource-sjabloon voor de implementatie van een jumpbox, met de naam jumpbox_enabled.json inschakelen</span><span class="sxs-lookup"><span data-stu-id="62667-349">You create an Optional Resource Template to enable the deployment of a jumpbox, named jumpbox_enabled.json</span></span>

<span data-ttu-id="62667-350">Redis maakt gebruik van slechts één knooppunt-type, zodat u één lid Resource sjabloon met de naam knooppunt resources.json maken.</span><span class="sxs-lookup"><span data-stu-id="62667-350">Redis uses just a single node type, so you create a single Member Resource Template named node-resources.json.</span></span>

<span data-ttu-id="62667-351">Met Redis, die u wilt installeren van elke afzonderlijke knooppunten en het cluster vervolgens ingesteld.</span><span class="sxs-lookup"><span data-stu-id="62667-351">With Redis, you want to install each individual node, and then set up the cluster.</span></span>  <span data-ttu-id="62667-352">U hebt mogelijk de installatie en het instellen van scripts, redis-cluster-install.sh en redis-cluster-setup.sh.</span><span class="sxs-lookup"><span data-stu-id="62667-352">You have scripts to accommodate the installation and set up, redis-cluster-install.sh and redis-cluster-setup.sh.</span></span>

### <a name="linking-the-templates"></a><span data-ttu-id="62667-353">De sjablonen koppelen</span><span class="sxs-lookup"><span data-stu-id="62667-353">Linking the templates</span></span>
<span data-ttu-id="62667-354">Met behulp van sjabloon koppelt, de belangrijkste sjabloon koppelingen uit aan de sjabloon gedeelde bronnen, waaruit blijkt dat het virtuele netwerk.</span><span class="sxs-lookup"><span data-stu-id="62667-354">Using template linking, the main template links out to the shared resources template, which establishes the virtual network.</span></span>

<span data-ttu-id="62667-355">Logica wordt toegevoegd in de belangrijkste sjabloon waarmee consumenten van de sjabloon op te geven of een jumpbox moet worden geïmplementeerd.</span><span class="sxs-lookup"><span data-stu-id="62667-355">Logic is added within the main template to enable consumers of the template to specify whether a jumpbox should be deployed.</span></span> <span data-ttu-id="62667-356">Een *ingeschakeld* waarde voor de *EnableJumpbox* parameter geeft aan dat de klant wil een jumpbox implementeren.</span><span class="sxs-lookup"><span data-stu-id="62667-356">An *enabled* value for the *EnableJumpbox* parameter indicates that the customer wants to deploy a jumpbox.</span></span> <span data-ttu-id="62667-357">Wanneer deze waarde is opgegeven, de sjabloon worden aaneengeschakeld *_enabled* als achtervoegsel aan de naam van een basissjabloon voor de mogelijkheid jumpbox.</span><span class="sxs-lookup"><span data-stu-id="62667-357">When this value is provided, the template concatenates *_enabled* as a suffix to a base template name for the jumpbox capability.</span></span>

<span data-ttu-id="62667-358">De belangrijkste sjabloon geldt de *grote* parameter waarde als achtervoegsel aan de naam van een basissjabloon voor t-shirt grootten en gebruikt vervolgens die waarde in een sjabloonkoppeling uit naar *technology_on_os_large.json*.</span><span class="sxs-lookup"><span data-stu-id="62667-358">The main template applies the *large* parameter value as a suffix to a base template name for t-shirt sizes, and then uses that value in a template link out to *technology_on_os_large.json*.</span></span>

<span data-ttu-id="62667-359">Deze afbeelding zou zijn vergelijkbaar met de topologie.</span><span class="sxs-lookup"><span data-stu-id="62667-359">The topology would resemble this illustration.</span></span>

![Sjabloon redis](./media/best-practices-resource-manager-design-templates/redis-template.png)

<span data-ttu-id="62667-361">**Structuur van de sjabloon voor een Redis-sjabloon**</span><span class="sxs-lookup"><span data-stu-id="62667-361">**Template structure for a Redis template**</span></span>

### <a name="configuring-state"></a><span data-ttu-id="62667-362">Status configureren</span><span class="sxs-lookup"><span data-stu-id="62667-362">Configuring state</span></span>
<span data-ttu-id="62667-363">Er zijn twee stappen voor de configuratie van de status voor de knooppunten in het cluster, allebei vertegenwoordigd door specifieke doel-Scripts.</span><span class="sxs-lookup"><span data-stu-id="62667-363">For the nodes in the cluster, there are two steps to configuring the state, both represented by Purpose Specific Scripts.</span></span>  <span data-ttu-id="62667-364">'redis-cluster-install.sh' Redis installeert en 'redis-cluster-setup.sh' ingesteld in het cluster.</span><span class="sxs-lookup"><span data-stu-id="62667-364">"redis-cluster-install.sh" installs Redis and "redis-cluster-setup.sh" sets up the cluster.</span></span>

### <a name="supporting-different-size-deployments"></a><span data-ttu-id="62667-365">Ondersteuning van verschillende grootte implementaties</span><span class="sxs-lookup"><span data-stu-id="62667-365">Supporting Different Size Deployments</span></span>
<span data-ttu-id="62667-366">Binnen variabelen, de sjabloon van de grootte t-shirt geeft het aantal knooppunten van elk type te implementeren voor de opgegeven grootte (*grote*).</span><span class="sxs-lookup"><span data-stu-id="62667-366">Inside variables, the t-shirt size template specifies the number of nodes of each type to deploy for the specified size (*large*).</span></span> <span data-ttu-id="62667-367">Het aantal VM-exemplaren die gebruikmaken van de resource lussen, unieke namen voor de resources die door de naam van een knooppunt met een numerieke reeksnummer van toe te voegen implementeert *copyIndex()*.</span><span class="sxs-lookup"><span data-stu-id="62667-367">It then deploys that number of VM instances using resource loops, providing unique names to resources by appending a node name with a numeric sequence number from *copyIndex()*.</span></span> <span data-ttu-id="62667-368">Wordt deze stappen voor hot en warme zone VM's, zoals gedefinieerd in de sjabloon t-shirt-naam</span><span class="sxs-lookup"><span data-stu-id="62667-368">It does these steps for both hot and warm zone VMs, as defined in the t-shirt name template</span></span>

## <a name="decomposition-and-end-to-end-solution-scoped-templates"></a><span data-ttu-id="62667-369">End-to-end-oplossing en afbreken binnen het bereik van sjablonen</span><span class="sxs-lookup"><span data-stu-id="62667-369">Decomposition and end-to-end solution scoped templates</span></span>
<span data-ttu-id="62667-370">Een oplossingssjabloon met een bereik van de end-to-end-oplossing is gericht op een end-to-end-oplossing levert.</span><span class="sxs-lookup"><span data-stu-id="62667-370">A solution template with an end-to-end solution scope is focused on delivering an end-to-end solution.</span></span>  <span data-ttu-id="62667-371">Deze aanpak is meestal een samenstelling van meerdere gericht op de mogelijkheid sjablonen met aanvullende bronnen, logische en status.</span><span class="sxs-lookup"><span data-stu-id="62667-371">This approach is typically a composition of multiple capability-scoped templates with additional resources, logic, and state.</span></span>

<span data-ttu-id="62667-372">Als gemarkeerd in de onderstaande afbeelding, wordt gebruikt voor sjablonen van de mogelijkheid binnen het bereik van hetzelfde model uitgebreid voor sjablonen met een bereik van de oplossing voor End-to-End.</span><span class="sxs-lookup"><span data-stu-id="62667-372">As highlighted in the image below, the same model used for capability scoped templates is extended for templates with an End-to-End Solution Scope.</span></span>

<span data-ttu-id="62667-373">Een gedeelde Resources sjabloon en een optionele Resources sjablonen dienen dezelfde functie uit als in de capaciteit en mogelijkheden binnen het bereik van sjabloon benaderingen, maar zijn binnen het bereik van de end-to-end-oplossing.</span><span class="sxs-lookup"><span data-stu-id="62667-373">A Shared Resources Template and Optional Resources Templates serve the same function as in the capacity and capability scoped template approaches, but are scoped for the end to end solution.</span></span>

<span data-ttu-id="62667-374">Zoals binnen het bereik van end-to-end oplossing sjablonen kunnen doorgaans hebben t-shirt grootten, de sjabloon bekend configuratie Resources weerspiegelt wat is vereist voor een bepaalde bekende configuratie van de oplossing.</span><span class="sxs-lookup"><span data-stu-id="62667-374">As end to end solution scoped templates also can typically have t-shirt sizes, the Known Configuration Resources template reflects what is required for a given known configuration of the solution.</span></span>

<span data-ttu-id="62667-375">De configuratie Resources sjabloon bekend koppelingen naar een of meer functionaliteit binnen het bereik oplossingssjablonen die relevant zijn voor de end-to-end-oplossing, evenals de lid Resource-sjablonen die vereist voor de end-to-end-oplossing zijn.</span><span class="sxs-lookup"><span data-stu-id="62667-375">The Known Configuration Resources Template links to one or more capability scoped solution templates that are relevant to the end to end solution as well as the Member Resource Templates that are required for the end to end solution.</span></span>

<span data-ttu-id="62667-376">Als de t-shirt grootte van de oplossing is mogelijk anders dan de afzonderlijke gericht op de mogelijkheid sjabloon, worden variabelen in de sjabloon bekend configuratie bronnen gebruikt voor de juiste waarden voor downstream mogelijkheid binnen het bereik van oplossingssjablonen voor het implementeren van de juiste t-shirt grootte.</span><span class="sxs-lookup"><span data-stu-id="62667-376">As the t-shirt size of the solution may be different than the individual capability-scoped template, variables within the Known Configuration Resources Template are used to provide the appropriate values for downstream capability scoped solution templates to deploy the appropriate t-shirt size.</span></span>

![End-to-end](./media/best-practices-resource-manager-design-templates/end-to-end.png)

<span data-ttu-id="62667-378">**Het model dat wordt gebruikt voor de capaciteit of mogelijkheden bereik oplossingssjablonen gemakkelijk kunnen worden uitgebreid voor end-to-end-oplossing sjabloon scopes**</span><span class="sxs-lookup"><span data-stu-id="62667-378">**The model used for capacity or capability scoped solution templates can be readily extended for end to end solution template scopes**</span></span>

## <a name="preparing-templates-for-the-marketplace"></a><span data-ttu-id="62667-379">Sjablonen voorbereiden voor de Marketplace</span><span class="sxs-lookup"><span data-stu-id="62667-379">Preparing templates for the Marketplace</span></span>
<span data-ttu-id="62667-380">De voorgaande aanpak gemakkelijk is geschikt voor scenario's waarbij ondernemingen SIs en CSV's aan de sjablonen zelf implementeren of hun klanten te implementeren op hun eigen inschakelen.</span><span class="sxs-lookup"><span data-stu-id="62667-380">The preceding approach readily accommodates scenarios where Enterprises, SIs, and CSVs want to either deploy the templates themselves or enable their customers to deploy on their own.</span></span>

<span data-ttu-id="62667-381">Een andere gewenste scenario implementeert een sjabloon via de marketplace.</span><span class="sxs-lookup"><span data-stu-id="62667-381">Another desired scenario is deploying a template via the marketplace.</span></span>  <span data-ttu-id="62667-382">Deze aanpak afbreken werkt voor de marketplace, evenals met enkele kleine wijzigingen.</span><span class="sxs-lookup"><span data-stu-id="62667-382">This decomposition approach works for the marketplace as well, with some minor changes.</span></span>

<span data-ttu-id="62667-383">Zoals eerder vermeld, kunnen sjablonen worden gebruikt op het aanbod van verschillende typen voor verkoop in de marketplace.</span><span class="sxs-lookup"><span data-stu-id="62667-383">As mentioned previously, templates can be used to offer distinct deployment types for sale in the marketplace.</span></span> <span data-ttu-id="62667-384">Afzonderlijke implementatietypen mogelijk t-shirt grootten (klein, normaal, groot), het product/doelgroep type (community, developer, enterprise) of onderdeeltype (basic, hoge beschikbaarheid).</span><span class="sxs-lookup"><span data-stu-id="62667-384">Distinct deployment types may be t-shirt sizes (small, medium, large), product/audience type (community, developer, enterprise), or feature type (basic, high availability).</span></span>

<span data-ttu-id="62667-385">Zoals hieronder wordt weergegeven, kunnen de mogelijkheid binnen het bereik van sjablonen of bestaande oplossing voor end-to-end worden direct gebruikt voor de verschillende bekende configuraties in de marketplace lijst.</span><span class="sxs-lookup"><span data-stu-id="62667-385">As shown below, the existing end to end solution or capability scoped templates can be readily utilized to list the different known configurations in the marketplace.</span></span>

<span data-ttu-id="62667-386">De parameters voor de belangrijkste sjabloon worden eerst gewijzigd als het binnenkomende parameter met de naam tshirtSize wilt verwijderen.</span><span class="sxs-lookup"><span data-stu-id="62667-386">The parameters to the main template are first modified to remove the inbound parameter named tshirtSize.</span></span>

<span data-ttu-id="62667-387">Terwijl de afzonderlijke implementatietypen aan de sjabloon bekend configuratie Resources toewijzen, moeten deze ook de algemene bronnen en configuratie gevonden in de sjabloon met gedeelde bronnen en mogelijk die in optionele Resource sjablonen.</span><span class="sxs-lookup"><span data-stu-id="62667-387">While the distinct deployment types map to the Known Configuration Resources Template, they also need the common resources and configuration found in the Shared Resources Template and potentially those in Optional Resource Templates.</span></span>

<span data-ttu-id="62667-388">Als u wilt uw sjabloon publiceren naar de marketplace, u een afzonderlijk exemplaar van de Main-sjabloon die wordt vervangen door de eerder beschikbaar inkomende parameter van tshirtSize aan een variabele die is ingesloten in de sjabloon tot stand brengen.</span><span class="sxs-lookup"><span data-stu-id="62667-388">If you want to publish your template to the marketplace, you establish distinct copies of your Main template that replaces the previously available inbound parameter of tshirtSize to a variable embedded within the template.</span></span>

![Marketplace](./media/best-practices-resource-manager-design-templates/marketplace.png)

<span data-ttu-id="62667-390">**Aanpassing van een oplossing binnen het bereik van de sjabloon voor de marketplace**</span><span class="sxs-lookup"><span data-stu-id="62667-390">**Adapting a solution scoped template for the marketplace**</span></span>

## <a name="next-steps"></a><span data-ttu-id="62667-391">Volgende stappen</span><span class="sxs-lookup"><span data-stu-id="62667-391">Next steps</span></span>
* <span data-ttu-id="62667-392">Zie voor meer informatie over het delen van de status van en naar sjablonen, [delen status in Azure Resource Manager-sjablonen](best-practices-resource-manager-state.md).</span><span class="sxs-lookup"><span data-stu-id="62667-392">To learn about sharing state into and out of templates, see [Sharing state in Azure Resource Manager templates](best-practices-resource-manager-state.md).</span></span>
* <span data-ttu-id="62667-393">Voor begeleiding bij de manier waarop ondernemingen Resource Manager effectief kunnen gebruiken voor het beheer van abonnementen, gaat u naar [Azure enterprise-platform - Prescriptieve abonnementsgovernance](resource-manager-subscription-governance.md).</span><span class="sxs-lookup"><span data-stu-id="62667-393">For guidance on how enterprises can use Resource Manager to effectively manage subscriptions, see [Azure enterprise scaffold - prescriptive subscription governance](resource-manager-subscription-governance.md).</span></span>

