---
title: Back-up en herstel na noodgevallen voor Azure IaaS-schijven | Microsoft Docs
description: In dit artikel wordt uitgelegd hoe u kunt plannen voor back-up en Disaster Recovery (DR) van IaaS virtuele machines (VM's) en de schijven in Azure. Dit document bevat informatie over zowel beheerde als onbeheerde schijven
services: storage
cloud: Azure
documentationcenter: na
author: luywang
manager: kavithag
ms.assetid: 
ms.service: storage
ms.workload: storage
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/19/2017
ms.author: luywang
ms.openlocfilehash: 03d38bc3383b5fd39eca5ca67c315b34b98f0c39
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 08/29/2017
---
# <a name="backup-and-disaster-recovery-for-azure-iaas-disks"></a><span data-ttu-id="7a3d2-104">Back-up en herstel na noodgevallen voor Azure IaaS-schijven</span><span class="sxs-lookup"><span data-stu-id="7a3d2-104">Backup and disaster recovery for Azure IaaS disks</span></span>

<span data-ttu-id="7a3d2-105">In dit artikel wordt uitgelegd hoe u kunt plannen voor back-up en Disaster Recovery (DR) van IaaS virtuele machines (VM's) en de schijven in Azure.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-105">In this article, we will explain how to plan for Backup and Disaster Recovery (DR) of IaaS virtual machines (VMs) and Disks in Azure.</span></span> <span data-ttu-id="7a3d2-106">Dit document bevat informatie over zowel beheerde als onbeheerde schijven.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-106">This document covers both Managed and Unmanaged Disks.</span></span>

<span data-ttu-id="7a3d2-107">Eerst bespreken we de ingebouwde mogelijkheden voor fouttolerantie in de Azure-platform waarmee bescherming tegen lokale fouten.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-107">We’ll first talk about the built-in fault tolerance capabilities in the Azure platform which help guard against local failures.</span></span> <span data-ttu-id="7a3d2-108">We vervolgens bespreken de noodherstel scenario's die niet volledig wordt gedekt door de ingebouwde mogelijkheden die het hoofdonderwerp behandeld in dit document is.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-108">We’ll then discuss the disaster scenarios not fully covered by the built-in capabilities, which is the main topic addressed by this document.</span></span> <span data-ttu-id="7a3d2-109">We laten enkele voorbeelden van werkbelasting scenario's waarbij andere overwegingen voor back-up en Noodherstel gelden ook zien.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-109">We’ll also show several examples of workload scenarios where different Backup and DR considerations may apply.</span></span> <span data-ttu-id="7a3d2-110">Vervolgens getoetst mogelijke oplossingen voor Noodherstel van IaaS-schijven.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-110">We’ll then review possible solutions for DR of IaaS Disks.</span></span> 

## <a name="introduction"></a><span data-ttu-id="7a3d2-111">Inleiding</span><span class="sxs-lookup"><span data-stu-id="7a3d2-111">Introduction</span></span>

<span data-ttu-id="7a3d2-112">De Azure-platform gebruikt verschillende methoden voor redundantie en fouttolerantie voor klanten beschermen tegen gelokaliseerde hardwarefouten die zich kunnen voordoen.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-112">The Azure platform uses various methods for redundancy and fault tolerance to help protect customers from localized hardware failures that can occur.</span></span> <span data-ttu-id="7a3d2-113">Lokale fouten, omvat mogelijk problemen met een Azure storage server-machine die deel uitmaken van de gegevens voor een virtuele schijf of fouten van een SSD of harde schijf op die server worden opgeslagen.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-113">Local failures may include problems with an Azure storage server machine that stores part of the data for a virtual disk or failures of an SSD or HDD on that server.</span></span> <span data-ttu-id="7a3d2-114">Dergelijke geïsoleerde hardwarefouten onderdeel kunnen zich voordoen tijdens normale bewerkingen en het platform is ontworpen om deze fouten netwerkfouten.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-114">Such isolated hardware component failures can happen during normal operations and the platform is designed to be resilient to these failures.</span></span> <span data-ttu-id="7a3d2-115">Grote rampen kunnen resulteren in fouten of inaccessibility van een groot aantal opslagservers of een hele datacenter.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-115">Major disasters can result in failures or inaccessibility of a large numbers of storage servers or a whole datacenter.</span></span> <span data-ttu-id="7a3d2-116">Terwijl de virtuele machines en de schijven zijn doorgaans beveiligd tegen gelokaliseerde fouten, zijn extra stappen nodig zijn om u te beschermen tegen de werkbelasting van uw regio hele onherstelbare storing van (zoals een noodgeval) die invloed hebben op de virtuele machine en de schijven.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-116">While your VMs and disks are normally protected from localized failures, additional steps are necessary to protect your workload from region-wide catastrophic failures (such as a major disaster) that can affect your VM and disks.</span></span>

<span data-ttu-id="7a3d2-117">Problemen met de Klanttoepassing of de gegevens kunnen naast de mogelijkheid van platform fouten optreden.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-117">In addition to the possibility of platform failures, problems with the customer application or data can occur.</span></span> <span data-ttu-id="7a3d2-118">Een nieuwe versie van uw toepassing kan bijvoorbeeld per ongeluk een recente wijzigen in de gegevens maakt.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-118">For example, a new version of your application may inadvertently make a breaking change to the data.</span></span> <span data-ttu-id="7a3d2-119">In dat geval wilt u de toepassing en de gegevens naar een eerdere versie met de laatst bekende goede status te herstellen.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-119">In that case, you may want to revert the application and the data to a prior version containing the last known good state.</span></span> <span data-ttu-id="7a3d2-120">Hiervoor moet het onderhouden van regelmatige back-ups.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-120">This requires maintaining regular backups.</span></span>

<span data-ttu-id="7a3d2-121">Voor de regionale noodherstel, moet u de back-up uw IaaS VM-schijven in een andere regio.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-121">For regional disaster recovery, you must backup your IaaS VM disks to a different region.</span></span> 

<span data-ttu-id="7a3d2-122">Voordat we opties voor back-up en Noodherstel bekijkt, samenvatting gaan we een aantal methoden beschikbaar voor het verwerken van gelokaliseerde fouten.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-122">Before we look at Backup and DR options, let’s recap a few methods available for handling localized failures.</span></span>

### <a name="azure-iaas-resiliency"></a><span data-ttu-id="7a3d2-123">Tolerantie van Azure IaaS</span><span class="sxs-lookup"><span data-stu-id="7a3d2-123">Azure IaaS Resiliency</span></span>

<span data-ttu-id="7a3d2-124">*Tolerantie* verwijst naar de tolerantie voor normale fouten die in de hardware-onderdelen optreden.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-124">*Resiliency* refers to the tolerance for normal failures that occur in hardware components.</span></span> <span data-ttu-id="7a3d2-125">Tolerantie is de mogelijkheid om te herstellen van fouten en blijven werken.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-125">Resiliency is the ability to recover from failures and continue to function.</span></span> <span data-ttu-id="7a3d2-126">Het is niet over de fouten te voorkomen, maar reageert op storingen op een manier die uitvaltijd of verlies van gegevens voorkomt.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-126">It's not about avoiding failures, but responding to failures in a way that avoids downtime or data loss.</span></span> <span data-ttu-id="7a3d2-127">Het doel van de tolerantie is om de toepassing naar een volledig werkend status na een mislukte te retourneren.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-127">The goal of resiliency is to return the application to a fully functioning state following a failure.</span></span> <span data-ttu-id="7a3d2-128">Azure virtuele Machines en de schijven zijn ontworpen om netwerkfouten algemene hardwarefouten.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-128">Azure Virtual Machines and Disks are designed to be resilient to common hardware faults.</span></span> <span data-ttu-id="7a3d2-129">Laat het ons kijken hoe de Azure IaaS-platform biedt voor deze tolerantie genoemd.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-129">Let us look at how the Azure IaaS platform provides this resiliency.</span></span>

<span data-ttu-id="7a3d2-130">Een virtuele machine bestaat voornamelijk uit twee delen: (1) A compute-server en (2) de permanente schijven.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-130">A virtual machine consists mainly of two parts: (1) A compute server, and (2) the persistent disks.</span></span> <span data-ttu-id="7a3d2-131">Beide invloed op de fouttolerantie van een virtuele machine.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-131">Both affect the fault tolerance of a virtual machine.</span></span>

<span data-ttu-id="7a3d2-132">Als de Azure compute-hostserver uw virtuele machine met een hardwarefout (dit is zeldzame) optreedt, wordt Azure is ontworpen voor het automatisch herstelt de virtuele machine op een andere server.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-132">If the Azure compute host server that houses your VM experiences a hardware failure (which is rare), Azure is designed to automatically restore the VM on another server.</span></span> <span data-ttu-id="7a3d2-133">Als dit gebeurt, wordt er opnieuw worden opgestart en de virtuele machine worden back-up na enige tijd.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-133">If this happens, you will experience a reboot, and the VM will be back up after some time.</span></span> <span data-ttu-id="7a3d2-134">Azure dergelijke hardwarefouten detecteert automatisch en wordt uitgevoerd herstelbewerkingen om ervoor te zorgen dat de klant VM zo spoedig mogelijk beschikbaar zijn.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-134">Azure automatically detects such hardware failures and executes recoveries to help ensure the customer VM will be available as soon as possible.</span></span>

<span data-ttu-id="7a3d2-135">Met betrekking tot IaaS-schijven zijn duurzaamheid van gegevens is essentieel voor het platform van de permanente opslag.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-135">Regarding IaaS disks, durability of data is critical for the persistent storage platform.</span></span> <span data-ttu-id="7a3d2-136">Azure-klanten belangrijke zakelijke toepassingen die worden uitgevoerd op IaaS hebben en ze afhankelijk van de persistentie van de gegevens.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-136">Azure customers have important business applications running on IaaS and they depend on the persistence of the data.</span></span> <span data-ttu-id="7a3d2-137">Azure-ontwerpen de beveiliging voor deze IaaS-schijven met drie kopieën van gegevens lokaal opgeslagen, bieden hoge duurzaamheid tegen fouten in de lokale.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-137">Azure designs protection for these IaaS disks with three redundant copies of data stored locally, providing high durability against local failures.</span></span> <span data-ttu-id="7a3d2-138">Als een van de hardwareonderdelen van de schijf uitvalt, wordt uw virtuele machine niet beïnvloed omdat er twee extra kopieën ter ondersteuning van schijfaanvragen.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-138">If one of the hardware components that holds your disk fails, your VM is not impacted because there are two additional copies to support disk requests.</span></span> <span data-ttu-id="7a3d2-139">Dit werkt prima zelfs als twee verschillende hardwareonderdelen ondersteuning van een schijf niet op hetzelfde moment (die zijn zeldzame).</span><span class="sxs-lookup"><span data-stu-id="7a3d2-139">It works fine even if two different hardware components supporting a disk fail at the same time (which would be very rare).</span></span> <span data-ttu-id="7a3d2-140">Om ervoor te zorgen dat we drie replica's altijd onderhouden, hiermee de Azure Storage-service automatisch wordt een nieuwe kopie van gegevens op de achtergrond als een van de drie kopieën niet beschikbaar is.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-140">To help ensure we always maintain three replicas, the Azure Storage service automatically spawns a new copy of data in the background if one of the three copies becomes unavailable.</span></span> <span data-ttu-id="7a3d2-141">Daarom mag niet nodig zijn voor het gebruik van RAID met Azure-schijven voor fouttolerantie.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-141">Therefore, it should not be necessary to use RAID with Azure disks for fault tolerance.</span></span> <span data-ttu-id="7a3d2-142">Een eenvoudige RAID-0-configuratie moet voldoende zijn voor de schijven te verwijderen, indien nodig om grotere volumes te maken.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-142">A simple RAID 0 configuration should be sufficient for striping the disks if necessary to create larger volumes.</span></span>

<span data-ttu-id="7a3d2-143">Vanwege deze architectuur **Azure heeft consistent bedrijfsniveau uitgebracht duurzaamheid voor IaaS-schijven, met een toonaangevende nul % [op basis van Faalpercentage](https://en.wikipedia.org/wiki/Annualized_failure_rate).**</span><span class="sxs-lookup"><span data-stu-id="7a3d2-143">Because of this architecture, **Azure has consistently delivered enterprise-grade durability for IaaS disks, with an industry-leading ZERO % [Annualized Failure Rate](https://en.wikipedia.org/wiki/Annualized_failure_rate).**</span></span>

<span data-ttu-id="7a3d2-144">Gelokaliseerde hardwarefouten in de berekening hosten of in de opslag-platform kunnen soms leiden tot een tijdelijk niet beschikbaar voor de virtuele machine waarvoor de [Azure SLA](https://azure.microsoft.com/support/legal/sla/virtual-machines/) voor beschikbaarheid van de virtuele machine.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-144">Localized hardware faults on the compute host or in the storage platform can sometimes result in temporary unavailability for the VM which is covered by the [Azure SLA](https://azure.microsoft.com/support/legal/sla/virtual-machines/) for VM Availability.</span></span> <span data-ttu-id="7a3d2-145">Azure biedt ook een toonaangevende SLA voor één VM-exemplaren die gebruikmaken van Premium-opslag-schijven.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-145">Azure also provides an industry-leading SLA for single VM instances that use Premium Storage disks.</span></span>

<span data-ttu-id="7a3d2-146">Ter bescherming van de toepassing werkbelastingen van downtime als gevolg van het tijdelijke ontbreken van een schijf of virtuele machine klanten gebruik kunnen maken [Beschikbaarheidssets](../../virtual-machines/windows/manage-availability.md).</span><span class="sxs-lookup"><span data-stu-id="7a3d2-146">To safeguard application workloads from downtime due to the temporary unavailability of a disk or VM, customers can leverage [Availability Sets](../../virtual-machines/windows/manage-availability.md).</span></span> <span data-ttu-id="7a3d2-147">Twee of meer virtuele machines in een beschikbaarheidsset biedt redundantie voor de toepassing.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-147">Two or more virtual machines in an availability set provides redundancy for the application.</span></span> <span data-ttu-id="7a3d2-148">Azure maakt vervolgens deze virtuele machines en de schijven in afzonderlijke foutdomeinen met verschillende voeding, netwerk- en server-onderdelen.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-148">Azure then creates these VMs and disks in separate fault domains with different power, network, and server components.</span></span> <span data-ttu-id="7a3d2-149">Dus gelokaliseerde hardwarefouten doorgaans hebben geen invloed op meerdere virtuele machines in de set op hetzelfde moment maximale beschikbaarheid biedt voor uw toepassing.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-149">Thus, localized hardware failures typically do not affect multiple VMs in the set at the same time, providing high availability for your application.</span></span> <span data-ttu-id="7a3d2-150">Dit wordt beschouwd als een goede gewoonte beschikbaarheidssets gebruiken als hoge beschikbaarheid vereist is.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-150">It is considered a good practice to use availability sets when high availability is required.</span></span> <span data-ttu-id="7a3d2-151">Zie voor meer informatie het herstel na noodgevallen aspecten zoals hieronder beschreven.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-151">For more information, see the Disaster Recovery aspects detailed below.</span></span>

### <a name="backup-and-disaster-recovery"></a><span data-ttu-id="7a3d2-152">Back-up en herstel na noodgevallen</span><span class="sxs-lookup"><span data-stu-id="7a3d2-152">Backup and Disaster Recovery</span></span>

<span data-ttu-id="7a3d2-153">Herstel na noodgeval (DR) is de mogelijkheid om te herstellen van zeldzame maar belangrijke incidenten: tijdelijke, schaal fouten, zoals onderbreking van de service die gevolgen heeft voor een hele regio.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-153">Disaster recovery (DR) is the ability to recover from rare but major incidents: non-transient, wide-scale failures, such as service disruption that affects an entire region.</span></span> <span data-ttu-id="7a3d2-154">Herstel na noodgevallen omvat gegevensback-up en te archiveren, en bevatten mogelijk handmatige interventie, zoals het terugzetten van een database vanuit back-up.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-154">Disaster recovery includes data backup and archiving, and may include manual intervention, such as restoring a database from backup.</span></span>

<span data-ttu-id="7a3d2-155">De virtuele machines/schijven in het geval van grote rampen waardoor grootschalige storingen mogelijk niet volledig te ingebouwde bescherming tegen gelokaliseerde fouten van de Azure-platform beveiligen.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-155">The Azure platform’s built-in protection against localized failures may not fully protect the VMs/disks in the case of major disasters which can cause large-scale outages.</span></span> <span data-ttu-id="7a3d2-156">Dit omvat onherstelbare gebeurtenissen, zoals een datacenter wordt bereikt door een orkaan, aardbeving, fire of grote schaal eenheid hardwarefouten.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-156">This includes catastrophic events such as a data center being hit by a hurricane, earthquake, fire, or large scale hardware unit failures.</span></span> <span data-ttu-id="7a3d2-157">Bovendien kunnen storingen als gevolg van de toepassing of problemen optreden.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-157">In addition, you may encounter failures due to application or data issues.</span></span>

<span data-ttu-id="7a3d2-158">Als u wilt beschermen de werkbelasting van uw IaaS tegen storingen, moet u plannen voor redundantie en back-ups herstellen.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-158">To help protect your IaaS workloads from outages, you should plan for redundancy and backups to enable recovery.</span></span> <span data-ttu-id="7a3d2-159">Voor herstel na noodgevallen, moet u van plan bent redundantie en back-up in een andere geografische locatie van de primaire site.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-159">For disaster recovery, you should plan redundancy and backup in a different geographic location away from the primary site.</span></span> <span data-ttu-id="7a3d2-160">Dit zorgt ervoor dat uw back-up wordt niet beïnvloed door de dezelfde gebeurtenis die oorspronkelijk van invloed op de virtuele machine of de schijven.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-160">This helps ensure your backup is not affected by the same event that originally impacted the VM or disks.</span></span> <span data-ttu-id="7a3d2-161">Zie voor meer informatie [herstel na noodgevallen voor toepassingen die zijn gebouwd op Azure](https://docs.microsoft.com/azure/architecture/resiliency/disaster-recovery-azure-applications).</span><span class="sxs-lookup"><span data-stu-id="7a3d2-161">For more information, see [Disaster Recovery for Applications built on Azure](https://docs.microsoft.com/azure/architecture/resiliency/disaster-recovery-azure-applications).</span></span>

<span data-ttu-id="7a3d2-162">Uw DR-overwegingen omvatten de volgende aspecten:</span><span class="sxs-lookup"><span data-stu-id="7a3d2-162">Your DR considerations may include the following aspects:</span></span>

1. <span data-ttu-id="7a3d2-163">Hoge beschikbaarheid (HA) is de mogelijkheid van de toepassing om te blijven uitvoeren in een foutloze toestand bevindt, zonder aanzienlijke uitvaltijd.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-163">High Availability (HA) is the ability of the application to continue running in a healthy state, without significant downtime.</span></span> <span data-ttu-id="7a3d2-164">Door 'status in orde,' dat we de toepassing reageert en kunnen gebruikers verbinding maken met de toepassing en ermee.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-164">By "healthy state," we mean the application is responsive, and users can connect to the application and interact with it.</span></span> <span data-ttu-id="7a3d2-165">Het is mogelijk dat bepaalde bedrijfskritieke toepassingen en -databases moet altijd beschikbaar, zelfs als er fouten van het platform zijn.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-165">Certain mission-critical applications and databases may be required to be available always, even when there are failures in the platform.</span></span> <span data-ttu-id="7a3d2-166">Voor deze werkbelastingen, moet u wellicht redundantie voor de toepassing, evenals de gegevens van plan bent.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-166">For these workloads, you may need to plan redundancy for the application as well as the data.</span></span>

2. <span data-ttu-id="7a3d2-167">Duurzaamheid van gegevens: In sommige gevallen kan de belangrijkste overweging is ervoor zorgen dat de gegevens blijven behouden in het geval van een noodgeval.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-167">Data Durability: In some cases, the main consideration is ensuring the data is preserved in the case of a disaster.</span></span> <span data-ttu-id="7a3d2-168">Daarom moet u een back-up van uw gegevens in een andere site.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-168">Therefore, you may need a backup of your data in a different site.</span></span> <span data-ttu-id="7a3d2-169">Voor deze werkbelastingen moet u mogelijk niet volledig redundantie voor de toepassing, maar een regelmatige back-up van de schijven.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-169">For such workloads, you may not need full redundancy for the application, but a regular backup of the disks.</span></span>

## <a name="backup-and-dr-scenarios"></a><span data-ttu-id="7a3d2-170">Back-up en Noodherstel scenario 's</span><span class="sxs-lookup"><span data-stu-id="7a3d2-170">Backup and DR Scenarios</span></span>

<span data-ttu-id="7a3d2-171">Bekijken we enkele typische voorbeelden van de toepassing werklast scenario's en de overwegingen voor het plannen van herstel na noodgevallen.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-171">Let’s look at a few typical examples of application workload scenarios and the considerations for planning Disaster Recovery.</span></span>

### <a name="scenario-1-major-database-solutions"></a><span data-ttu-id="7a3d2-172">Scenario 1: Primaire Database oplossingen</span><span class="sxs-lookup"><span data-stu-id="7a3d2-172">Scenario 1: Major Database Solutions</span></span>

<span data-ttu-id="7a3d2-173">U kunt een productie-databaseserver zoals SQL Server- of Oracle die ondersteuning voor hoge beschikbaarheid bieden.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-173">Consider a production database server like SQL Server or Oracle that can support High Availability.</span></span> <span data-ttu-id="7a3d2-174">Kritieke productietoepassingen en gebruikers, is afhankelijk van deze database.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-174">Critical production applications and users depend on this database.</span></span> <span data-ttu-id="7a3d2-175">Het plan voor herstel na noodgevallen voor dit systeem moet mogelijk de volgende vereisten ondersteunen:</span><span class="sxs-lookup"><span data-stu-id="7a3d2-175">The Disaster Recovery plan for this system may need to support the following requirements:</span></span>

1. <span data-ttu-id="7a3d2-176">Gegevens moet zijn beveiligd en hersteld.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-176">Data must be protected and recoverable.</span></span>
2.  <span data-ttu-id="7a3d2-177">Server moet beschikbaar zijn voor gebruik.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-177">Server must be available for use.</span></span>

<span data-ttu-id="7a3d2-178">Mogelijk moet het onderhouden van een replica van de database in een andere regio als een back-up.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-178">This may require maintaining a replica of the database in a different region as a backup.</span></span> <span data-ttu-id="7a3d2-179">De oplossing kan afhankelijk van de vereisten voor beschikbaarheid van de server en herstel van gegevens op periodieke offline back-ups van de gegevens variëren van een actief-actief of actief / passief replica-site.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-179">Depending on the requirements for server availability and data recovery, the solution could range from an Active-Active or Active-Passive replica site to periodic offline backups of the data.</span></span> <span data-ttu-id="7a3d2-180">Relationele databases zoals SQL Server en Oracle bieden verschillende opties voor replicatie.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-180">Relational databases such as SQL Server and Oracle provide various options for replication.</span></span> <span data-ttu-id="7a3d2-181">Voor SQL Server, [SQL Server altijd op beschikbaarheidsgroepen](https://msdn.microsoft.com/library/hh510230.aspx) kan worden gebruikt voor hoge beschikbaarheid.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-181">For SQL Server, [SQL Server Always On Availability Groups](https://msdn.microsoft.com/library/hh510230.aspx) can be used for high availability.</span></span>

<span data-ttu-id="7a3d2-182">NoSQL-databases zoals MongoDB bieden ook ondersteuning voor [replica's](https://docs.mongodb.com/manual/replication/) voor redundantie.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-182">NoSQL databases like MongoDB also support [replicas](https://docs.mongodb.com/manual/replication/) for redundancy.</span></span> <span data-ttu-id="7a3d2-183">De replica's voor hoge beschikbaarheid kunnen worden gebruikt.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-183">The replicas for high availability can be used.</span></span>

### <a name="scenario-2-a-cluster-of-redundant-vms"></a><span data-ttu-id="7a3d2-184">Scenario 2: Een cluster van redundante virtuele machines</span><span class="sxs-lookup"><span data-stu-id="7a3d2-184">Scenario 2: A cluster of redundant VMs</span></span>

<span data-ttu-id="7a3d2-185">U kunt een werkbelasting die wordt verwerkt door een cluster van virtuele machines die redundantie en taakverdeling.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-185">Consider a workload handled by a cluster of VMs that provide redundancy and load balancing.</span></span> <span data-ttu-id="7a3d2-186">Een voorbeeld hiervan is een Cassandra-cluster dat is geïmplementeerd in een regio.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-186">One example would be a Cassandra cluster deployed in a region.</span></span> <span data-ttu-id="7a3d2-187">Dit type architectuur biedt al een hoog niveau van redundantie in deze regio.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-187">This type of architecture already provides a high level of redundancy within that region.</span></span> <span data-ttu-id="7a3d2-188">Echter, om te voorkomen dat de werkbelasting een regionaal niveau fout, moet u het cluster verspreid over twee regio's of periodiek back-ups maken naar een andere regio.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-188">However, to protect the workload from a regional level failure, you should consider spreading the cluster across two regions or making periodic backups to another region.</span></span>

### <a name="scenario-3-iaas-application-workload"></a><span data-ttu-id="7a3d2-189">Scenario 3: IaaS toepassing werklast</span><span class="sxs-lookup"><span data-stu-id="7a3d2-189">Scenario 3: IaaS Application Workload</span></span>

<span data-ttu-id="7a3d2-190">Dit kan een standaard productie-werkbelasting die wordt uitgevoerd op een Azure VM zijn.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-190">This could be a typical production workload running on an Azure VM.</span></span> <span data-ttu-id="7a3d2-191">Bijvoorbeeld, wordt een webserver of bestandsserver die de inhoud en andere bronnen van een site.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-191">For example, it could be a web server or file server holding the content and other resources of a site.</span></span> <span data-ttu-id="7a3d2-192">Dit kan ook worden een op maat gemaakte business-toepassing uitgevoerd op een virtuele machine die de gegevens, bronnen en de status van toepassing zijn opgeslagen op de VM-schijven.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-192">It could also be a custom-built business application running on a VM that stored its data, resources, and application state on the VM disks.</span></span> <span data-ttu-id="7a3d2-193">In dit geval is het belangrijk om ervoor te zorgen dat u rekening houden met back-ups regelmatig.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-193">In this case, it is important to make sure you take backups on a regular basis.</span></span> <span data-ttu-id="7a3d2-194">Back-upfrequentie moet worden gebaseerd op de aard van de virtuele machine-werkbelasting.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-194">Backup frequency should be based on the nature of the VM workload.</span></span> <span data-ttu-id="7a3d2-195">Bijvoorbeeld, als de toepassing wordt dagelijks uitgevoerd en gegevens worden gewijzigd, moet klikt u vervolgens de back-up worden gehouden om het uur.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-195">For example, if the application runs every day and modifies data, then the backup should be taken every hour.</span></span>

<span data-ttu-id="7a3d2-196">Een ander voorbeeld is een rapportserver die pull-gegevens uit andere bronnen en genereert cumulatieve rapporten.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-196">Another example is a reporting server that pull data from other sources and generates aggregated reports.</span></span> <span data-ttu-id="7a3d2-197">Verlies van deze virtuele machine of de schijven zal leiden tot verlies van de rapporten.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-197">Loss of this VM or disks will lead to the loss of the reports.</span></span> <span data-ttu-id="7a3d2-198">Echter mogelijk opnieuw uitvoeren van het proces voor rapportage en opnieuw genereren van de uitvoer.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-198">However, it may be possible to rerun the reporting process and regenerate the output.</span></span> <span data-ttu-id="7a3d2-199">In dat geval echt er geen gegevensverlies zelfs als de rapportserver is bereikt, wordt met een ramp, zodat u een hoger niveau van tolerantie voor verliezen deel van de gegevens op de rapportserver kan hebben.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-199">In that case, you don’t really have a loss of data even if the reporting server is hit with a disaster, so you could have a higher level of tolerance for losing part of the data on the reporting server.</span></span> <span data-ttu-id="7a3d2-200">In dat geval minder frequente back-ups is een optie om de kosten te beperken.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-200">In that case, less frequent backups is an option to reduce the cost.</span></span>

### <a name="scenario-4-iaas-application-data-issues"></a><span data-ttu-id="7a3d2-201">Scenario 4: IaaS toepassingsproblemen gegevens</span><span class="sxs-lookup"><span data-stu-id="7a3d2-201">Scenario 4: IaaS Application data issues</span></span>

<span data-ttu-id="7a3d2-202">U hebt een toepassing die wordt berekend, onderhouden en kritieke commerciële gegevens zoals prijsgegevens fungeert.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-202">You have an application that computes, maintains, and serves critical commercial data such as pricing information.</span></span> <span data-ttu-id="7a3d2-203">Een nieuwe versie van uw toepassing heeft een software-oplossingen die onjuist berekende prijzen en de bestaande commerce gegevens geleverd door het platform is beschadigd.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-203">A new version of your application had a software bug which incorrectly computed the pricing and corrupted the existing commerce data served by the platform.</span></span> <span data-ttu-id="7a3d2-204">De beste loop van de actie kan hier worden eerst de eerdere versie van de toepassing en de gegevens te herstellen.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-204">Here, the best course of action would be to revert to the earlier version of the application and the data first.</span></span> <span data-ttu-id="7a3d2-205">U kunt deze inschakelen worden periodiek back-ups van uw systeem.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-205">To enable this, take periodic backups of your system.</span></span>

## <a name="disaster-recovery-solution-azure-backup-service"></a><span data-ttu-id="7a3d2-206">Noodherstel: Azure Backup-Service</span><span class="sxs-lookup"><span data-stu-id="7a3d2-206">Disaster Recovery Solution: Azure Backup Service</span></span>

<span data-ttu-id="7a3d2-207">[Azure Backup-Service](https://azure.microsoft.com/services/backup/) kan worden gebruikt voor back-up en Noodherstel is, en dit proces werkt met [schijven beheerd](../../virtual-machines/windows/managed-disks-overview.md) , evenals [niet-beheerde schijven](../../virtual-machines/windows/about-disks-and-vhds.md#unmanaged-disks).</span><span class="sxs-lookup"><span data-stu-id="7a3d2-207">[Azure Backup Service](https://azure.microsoft.com/services/backup/) is can be used for Backup and DR, and it works with [Managed Disks](../../virtual-machines/windows/managed-disks-overview.md) as well as [Unmanaged Disks](../../virtual-machines/windows/about-disks-and-vhds.md#unmanaged-disks).</span></span> <span data-ttu-id="7a3d2-208">U kunt een back-uptaak maken met back-ups op basis van tijd, eenvoudig herstel van de virtuele machine en back-up bewaarbeleid.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-208">You can create a backup job with time-based backups, easy VM restoration and backup retention policies.</span></span> 

<span data-ttu-id="7a3d2-209">Als u [Premium-opslag schijven](storage-premium-storage.md), [schijven beheerd](../../virtual-machines/windows/managed-disks-overview.md), of andere schijftypen met de [lokaal redundante opslag (LRS)](storage-redundancy.md#locally-redundant-storage) optie, het is vooral belangrijk voor het benutten periodieke DR back-ups.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-209">If you use [Premium Storage disks](storage-premium-storage.md), [Managed Disks](../../virtual-machines/windows/managed-disks-overview.md), or other disk types with the [locally redundant storage (LRS)](storage-redundancy.md#locally-redundant-storage) option, it is especially important to leverage periodic DR backups.</span></span> <span data-ttu-id="7a3d2-210">Azure Backup slaat de gegevens in de Recovery Services-kluis voor het bewaren van de lange termijn.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-210">Azure Backup stores the data in your Recovery Services vault for long term retention.</span></span> <span data-ttu-id="7a3d2-211">Kies de [geografisch redundante opslag (GRS)](storage-redundancy.md#geo-redundant-storage) optie voor de back-up Recovery Services-kluis.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-211">Choose the [Geo-redundant storage (GRS)](storage-redundancy.md#geo-redundant-storage) option for the Backup Recovery Services vault.</span></span> <span data-ttu-id="7a3d2-212">Die zorgt ervoor dat back-ups worden gerepliceerd naar een andere Azure-regio voor de beveiliging van regionale noodsituaties.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-212">That will ensure backups are replicated to a different Azure region for safeguarding from regional disasters.</span></span>

<span data-ttu-id="7a3d2-213">Voor [niet-beheerde schijven](../../virtual-machines/windows/about-disks-and-vhds.md#unmanaged-disks), u kunt het opslagtype LRS voor IaaS-schijven gebruiken, maar zorg ervoor dat de Azure Backup is ingeschakeld met de optie GRS voor de Recovery Services-kluis.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-213">For [Unmanaged Disks](../../virtual-machines/windows/about-disks-and-vhds.md#unmanaged-disks), you can use the LRS storage type for IaaS disks, but ensure that Azure Backup is enabled with the GRS option for the Recovery Services Vault.</span></span>

<span data-ttu-id="7a3d2-214">**Als u de [GRS](storage-redundancy.md#geo-redundant-storage)/[RA-GRS](storage-redundancy.md#read-access-geo-redundant-storage) optie voor uw niet-beheerde schijven u nog steeds nodig toepassingsconsistente momentopnamen voor back-up en Noodherstel.**</span><span class="sxs-lookup"><span data-stu-id="7a3d2-214">**If you use the [GRS](storage-redundancy.md#geo-redundant-storage)/[RA-GRS](storage-redundancy.md#read-access-geo-redundant-storage) option for your Unmanaged Disks, you still need consistent snapshots for Backup and DR.**</span></span> <span data-ttu-id="7a3d2-215">U moet een gebruiken [Azure Backup-Service](https://azure.microsoft.com/services/backup/) of [toepassingsconsistente momentopnamen](#alternative-solution-consistent-snapshots).</span><span class="sxs-lookup"><span data-stu-id="7a3d2-215">You must use either [Azure Backup Service](https://azure.microsoft.com/services/backup/) or [consistent snapshots](#alternative-solution-consistent-snapshots).</span></span>

<span data-ttu-id="7a3d2-216">Hier volgt een samenvatting van oplossingen voor herstel na Noodgevallen.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-216">The following is a summary of solutions for DR.</span></span>

| <span data-ttu-id="7a3d2-217">Scenario</span><span class="sxs-lookup"><span data-stu-id="7a3d2-217">Scenario</span></span> | <span data-ttu-id="7a3d2-218">Automatische replicatie</span><span class="sxs-lookup"><span data-stu-id="7a3d2-218">Automatic Replication</span></span> | <span data-ttu-id="7a3d2-219">Oplossing voor Noodherstel</span><span class="sxs-lookup"><span data-stu-id="7a3d2-219">DR Solution</span></span> |
| --- | --- | --- |
| <span data-ttu-id="7a3d2-220">*Premium-opslag-schijven*</span><span class="sxs-lookup"><span data-stu-id="7a3d2-220">*Premium Storage Disks*</span></span> | <span data-ttu-id="7a3d2-221">Lokale ([LRS](storage-redundancy.md#locally-redundant-storage))</span><span class="sxs-lookup"><span data-stu-id="7a3d2-221">Local ([LRS](storage-redundancy.md#locally-redundant-storage))</span></span> | [<span data-ttu-id="7a3d2-222">Azure Backup</span><span class="sxs-lookup"><span data-stu-id="7a3d2-222">Azure Backup</span></span>](https://azure.microsoft.com/services/backup/) |
| <span data-ttu-id="7a3d2-223">*Managed Disks*</span><span class="sxs-lookup"><span data-stu-id="7a3d2-223">*Managed Disks*</span></span> | <span data-ttu-id="7a3d2-224">Lokale ([LRS](storage-redundancy.md#locally-redundant-storage))</span><span class="sxs-lookup"><span data-stu-id="7a3d2-224">Local ([LRS](storage-redundancy.md#locally-redundant-storage))</span></span> | [<span data-ttu-id="7a3d2-225">Azure Backup</span><span class="sxs-lookup"><span data-stu-id="7a3d2-225">Azure Backup</span></span>](https://azure.microsoft.com/services/backup/) |
| <span data-ttu-id="7a3d2-226">*Niet-beheerde LRS-schijven*</span><span class="sxs-lookup"><span data-stu-id="7a3d2-226">*Unmanaged LRS Disks*</span></span> | <span data-ttu-id="7a3d2-227">Lokale ([LRS](storage-redundancy.md#locally-redundant-storage))</span><span class="sxs-lookup"><span data-stu-id="7a3d2-227">Local ([LRS](storage-redundancy.md#locally-redundant-storage))</span></span> | [<span data-ttu-id="7a3d2-228">Azure Backup</span><span class="sxs-lookup"><span data-stu-id="7a3d2-228">Azure Backup</span></span>](https://azure.microsoft.com/services/backup/) |
| <span data-ttu-id="7a3d2-229">*Niet-beheerde GRS schijven*</span><span class="sxs-lookup"><span data-stu-id="7a3d2-229">*Unmanaged GRS Disks*</span></span> | <span data-ttu-id="7a3d2-230">Cross-regio ([GRS](storage-redundancy.md#geo-redundant-storage))</span><span class="sxs-lookup"><span data-stu-id="7a3d2-230">Cross region ([GRS](storage-redundancy.md#geo-redundant-storage))</span></span> | [<span data-ttu-id="7a3d2-231">Azure Backup</span><span class="sxs-lookup"><span data-stu-id="7a3d2-231">Azure Backup</span></span>](https://azure.microsoft.com/services/backup/)<br/>[<span data-ttu-id="7a3d2-232">Toepassingsconsistente momentopnamen</span><span class="sxs-lookup"><span data-stu-id="7a3d2-232">Consistent snapshots</span></span>](#alternative-solution-consistent-snapshots) |
| <span data-ttu-id="7a3d2-233">*Niet-beheerde RA-GRS-schijven*</span><span class="sxs-lookup"><span data-stu-id="7a3d2-233">*Unmanaged RA-GRS Disks*</span></span> | <span data-ttu-id="7a3d2-234">Cross-regio ([RA-GRS](storage-redundancy.md#read-access-geo-redundant-storage))</span><span class="sxs-lookup"><span data-stu-id="7a3d2-234">Cross region ([RA-GRS](storage-redundancy.md#read-access-geo-redundant-storage))</span></span> | [<span data-ttu-id="7a3d2-235">Azure Backup</span><span class="sxs-lookup"><span data-stu-id="7a3d2-235">Azure Backup</span></span>](https://azure.microsoft.com/services/backup/)<br/>[<span data-ttu-id="7a3d2-236">Toepassingsconsistente momentopnamen</span><span class="sxs-lookup"><span data-stu-id="7a3d2-236">Consistent snapshots</span></span>](#alternative-solution-consistent-snapshots) |

<span data-ttu-id="7a3d2-237">Hoge beschikbaarheid kan beste door voldaan door het gebruik van beheerde schijven in een Beschikbaarheidsset samen met Azure Backup.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-237">High availability can best by met through the use of Managed Disks in an Availability Set along with Azure Backup.</span></span> <span data-ttu-id="7a3d2-238">Als u niet-beheerde schijven gebruikt, kunt u Azure back-up voor herstel na Noodgevallen.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-238">If you are using Unmanaged Disks, you can still  use Azure Backup for DR.</span></span> <span data-ttu-id="7a3d2-239">Als u nog geen Azure back-up gebruiken, duurt [toepassingsconsistente momentopnamen](#alternative-solution-consistent-snapshots) zoals beschreven in een volgende sectie is een alternatieve oplossing voor back-up en Noodherstel.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-239">If you are unable to use Azure Backup, then taking [consistent snapshots](#alternative-solution-consistent-snapshots) as described in a later section is an alternative solution for Backup and DR.</span></span>

<span data-ttu-id="7a3d2-240">Uw keuzes voor hoge beschikbaarheid, back-up en Noodherstel op niveau van de toepassing of infrastructuur aan de onderstaande kan worden weergegeven:</span><span class="sxs-lookup"><span data-stu-id="7a3d2-240">Your choices for high availability, backup and DR at Application or Infrastructure levels can be represented as below:</span></span>

| <span data-ttu-id="7a3d2-241">*Niveau*</span><span class="sxs-lookup"><span data-stu-id="7a3d2-241">*Level*</span></span> | <span data-ttu-id="7a3d2-242">Hoge beschikbaarheid</span><span class="sxs-lookup"><span data-stu-id="7a3d2-242">High Availability</span></span>   | <span data-ttu-id="7a3d2-243">Back-up-/ DR</span><span class="sxs-lookup"><span data-stu-id="7a3d2-243">Backup / DR</span></span> |
| --- | --- | --- |
| <span data-ttu-id="7a3d2-244">*Toepassing*</span><span class="sxs-lookup"><span data-stu-id="7a3d2-244">*Application*</span></span> | <span data-ttu-id="7a3d2-245">SQL AlwaysOn</span><span class="sxs-lookup"><span data-stu-id="7a3d2-245">SQL Always On</span></span> | <span data-ttu-id="7a3d2-246">Azure Backup</span><span class="sxs-lookup"><span data-stu-id="7a3d2-246">Azure Backup</span></span> |
| <span data-ttu-id="7a3d2-247">*Infrastructuur*</span><span class="sxs-lookup"><span data-stu-id="7a3d2-247">*Infrastructure*</span></span>  | <span data-ttu-id="7a3d2-248">Beschikbaarheidsset</span><span class="sxs-lookup"><span data-stu-id="7a3d2-248">Availability Set</span></span>  | <span data-ttu-id="7a3d2-249">GRS met toepassingsconsistente momentopnamen</span><span class="sxs-lookup"><span data-stu-id="7a3d2-249">GRS with consistent snapshots</span></span> |

### <a name="using-the-azure-backup-service"></a><span data-ttu-id="7a3d2-250">Met behulp van de Azure Backup-Service</span><span class="sxs-lookup"><span data-stu-id="7a3d2-250">Using the Azure Backup Service</span></span>

<span data-ttu-id="7a3d2-251">[Azure Backup](../../backup/backup-azure-vms-introduction.md) kunnen back-up van uw virtuele machines met Windows of Linux naar de Azure Recovery Services-kluis.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-251">[Azure Backup](../../backup/backup-azure-vms-introduction.md) can backup your VMs running Windows or Linux to the Azure Recovery Services Vault.</span></span> <span data-ttu-id="7a3d2-252">Back-up en herstellen van essentiële gegevens wordt bemoeilijkt door het feit dat essentiële bedrijfsgegevens moet een back-up terwijl de toepassingen die de gegevens produceren die worden uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-252">Backing up and restoring business-critical data is complicated by the fact that business-critical data must be backed up while the applications that produce the data are running.</span></span> <span data-ttu-id="7a3d2-253">Om dit op te lossen, biedt Azure Backup toepassingsconsistente back-ups voor Microsoft-werkbelastingen met behulp van de Volume Shadow Service (VSS) om ervoor te zorgen dat gegevens correct worden geschreven naar de opslag.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-253">To address this, Azure Backup provides application-consistent backups for Microsoft workloads by using the Volume Shadow Service (VSS) to ensure that data is written correctly to storage.</span></span> <span data-ttu-id="7a3d2-254">Voor virtuele Linux-machines zijn alleen bestandsconsistente back-ups mogelijk, aangezien Linux geen functionaliteit in VSS.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-254">For Linux VMs, only file-consistent backups are possible, since Linux does not have functionality equivalent to VSS.</span></span>

![](./media/storage-backup-and-disaster-recovery-for-azure-iaas-disks/backup-and-disaster-recovery-for-azure-iaas-disks-1.png)   

<span data-ttu-id="7a3d2-255">Wanneer Azure Backup een back-uptaak op het geplande tijdstip initieert, wordt de Backup-extensie die is geïnstalleerd in de virtuele machine om een punt in tijd momentopname geactiveerd.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-255">When Azure Backup initiates a backup job at the scheduled time, it triggers the backup extension installed in the VM to take a point-in-time snapshot.</span></span> <span data-ttu-id="7a3d2-256">Een momentopname wordt gemaakt in coördinatie met VSS ophalen van een consistente momentopname van de schijven in de virtuele machine zonder af te sluiten.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-256">A snapshot is taken in coordination with VSS to get a consistent snapshot of the disks in the virtual machine without having to shut it down.</span></span> <span data-ttu-id="7a3d2-257">De Backup-extensie in de virtuele machine leegmaakacties alle schrijfbewerkingen alvorens de consistente momentopname van de schijven.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-257">The backup extension in the VM flushes all writes before taking the consistent snapshot of all the disks.</span></span> <span data-ttu-id="7a3d2-258">Nadat de momentopname wordt gemaakt, worden de gegevens door Azure Backup overgebracht naar de back-upkluis.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-258">After the snapshot is taken, the data is transferred by Azure Backup to the backup vault.</span></span> <span data-ttu-id="7a3d2-259">Als u het back-upproces efficiënter, wordt de service identificeert en alleen de blokken met gegevens die zijn gewijzigd sinds de laatste back-up overdraagt.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-259">To make the backup process more efficient, the service identifies and transfers only the blocks of data that have changed since the last backup.</span></span>


<span data-ttu-id="7a3d2-260">Als u wilt herstellen, kunt u bekijken van de beschikbare back-ups via Azure Backup en start vervolgens een herstelpunt.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-260">To restore, you can view the available backups through Azure Backup and then initiate a restore.</span></span> <span data-ttu-id="7a3d2-261">U kunt maken en herstellen van Azure back-ups via de [Azure-portal](https://portal.azure.com/), [met behulp van PowerShell](../../backup/backup-azure-vms-automation.md ), of met behulp van de [Azure CLI](https://docs.microsoft.com/azure/xplat-cli-install).</span><span class="sxs-lookup"><span data-stu-id="7a3d2-261">You can create and restore Azure backups through the [Azure portal](https://portal.azure.com/), [using PowerShell](../../backup/backup-azure-vms-automation.md ), or using the [Azure CLI](https://docs.microsoft.com/azure/xplat-cli-install).</span></span> <span data-ttu-id="7a3d2-262">Zie de Azure Backup voor meer informatie.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-262">For more information, see Azure Backup.</span></span>

### <a name="steps-to-enable-backup"></a><span data-ttu-id="7a3d2-263">Stappen voor het inschakelen van de back-up</span><span class="sxs-lookup"><span data-stu-id="7a3d2-263">Steps to Enable Backup</span></span>

<span data-ttu-id="7a3d2-264">De volgende stappen worden doorgaans gebruikt voor het inschakelen van de back-ups van uw virtuele machines met behulp van de [Azure Portal](https://portal.azure.com/).</span><span class="sxs-lookup"><span data-stu-id="7a3d2-264">The following steps are typically used to enable backups of your VMs using the [Azure Portal](https://portal.azure.com/).</span></span> <span data-ttu-id="7a3d2-265">Er zijn enkele variaties afhankelijk van uw exacte scenario.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-265">There will be some variations depending on your exact scenario.</span></span> <span data-ttu-id="7a3d2-266">Raadpleeg de [Azure Backup](../../backup/backup-azure-vms-introduction.md) documentatie voor volledige informatie.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-266">Refer to the [Azure Backup](../../backup/backup-azure-vms-introduction.md) documentation for full details.</span></span> <span data-ttu-id="7a3d2-267">Azure back-up ook [biedt ondersteuning voor virtuele machines met schijven beheerd](https://azure.microsoft.com/blog/azure-managed-disk-backup/).</span><span class="sxs-lookup"><span data-stu-id="7a3d2-267">Azure Backup also [supports VMs with Managed Disks](https://azure.microsoft.com/blog/azure-managed-disk-backup/).</span></span>

1.  <span data-ttu-id="7a3d2-268">Maak een recovery services-kluis voor een virtuele machine met behulp van de volgende stappen uit:</span><span class="sxs-lookup"><span data-stu-id="7a3d2-268">Create a recovery services vault for a VM using the following steps:</span></span>

    <span data-ttu-id="7a3d2-269">a.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-269">a.</span></span>  <span data-ttu-id="7a3d2-270">Met behulp van de [Azure-portal](https://portal.azure.com/), alle resources te bladeren naar 'Recovery Services-kluizen'.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-270">Using the [Azure portal](https://portal.azure.com/), browse all resources and find “Recovery Services vaults”.</span></span>

    <span data-ttu-id="7a3d2-271">b.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-271">b.</span></span>  <span data-ttu-id="7a3d2-272">Klik op toevoegen in het menu Recovery Services-kluizen en volg de stappen voor het maken van een nieuwe kluis in dezelfde regio bevinden als de virtuele machine.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-272">On the Recovery Services vaults menu, click Add and follow the steps to create a new vault in the same region as the VM.</span></span> <span data-ttu-id="7a3d2-273">Bijvoorbeeld, als uw virtuele machine zich in de regio VS-West, VS-West voor verzamelen de kluis.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-273">For example, if your VM is in West US region, pick West US for the vault.</span></span>

2.  <span data-ttu-id="7a3d2-274">Controleer of de Storage-replicatie voor de nieuwe kluis.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-274">Verify the Storage replication for the newly created vault.</span></span> <span data-ttu-id="7a3d2-275">Hiertoe toegang hebben tot de kluis van de blade Recovery Services-kluizen en Ga naar de instellingen/back-configuratie.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-275">To do this, access the vault from the Recovery Services vaults blade and go to the settings/Backup Configuration.</span></span> <span data-ttu-id="7a3d2-276">Zorg ervoor dat de GRS-optie is standaard geselecteerd.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-276">Ensure the GRS option is selected by default.</span></span> <span data-ttu-id="7a3d2-277">Dit zorgt ervoor dat uw kluis automatisch worden gerepliceerd naar een secundaire Datacenter.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-277">This will ensure that your vault is automatically replicated to a secondary data center.</span></span> <span data-ttu-id="7a3d2-278">Uw kluis in VS-West wordt bijvoorbeeld automatisch gerepliceerd naar VS-Oost.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-278">For example, your vault in West US will be automatically replicated to East US.</span></span>

3.  <span data-ttu-id="7a3d2-279">Het back-beleid configureren en selecteer de virtuele machine in dezelfde gebruikersinterface.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-279">Configure the backup policy and select the VM from the same UI.</span></span>

4.  <span data-ttu-id="7a3d2-280">Zorg ervoor dat de Backup-Agent is geïnstalleerd op de virtuele machine.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-280">Make sure the Backup Agent is installed on the VM.</span></span> <span data-ttu-id="7a3d2-281">Als uw virtuele machine wordt gemaakt met behulp van een installatiekopie van een Azure-galerie, is klikt u vervolgens de backup-agent al geïnstalleerd.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-281">If your VM is created using an Azure gallery image, then the Backup agent is already installed.</span></span> <span data-ttu-id="7a3d2-282">Anders (dat wil zeggen, als u een aangepaste installatiekopie), gebruikt u instructies voor het [de VM-Agent installeren op de virtuele machine](../../backup/backup-azure-arm-vms-prepare.md#install-the-vm-agent-on-the-virtual-machine).</span><span class="sxs-lookup"><span data-stu-id="7a3d2-282">Otherwise (that is, if you are using a custom image), use instructions to [Install the VM Agent on the virtual machine](../../backup/backup-azure-arm-vms-prepare.md#install-the-vm-agent-on-the-virtual-machine).</span></span>

5.  <span data-ttu-id="7a3d2-283">Zorg ervoor dat de virtuele machine netwerkverbinding voor de Backup-service naar de functie toestaat.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-283">Make sure that the VM allows network connectivity for the backup service to function.</span></span> <span data-ttu-id="7a3d2-284">Volg deze instructies voor [netwerkverbinding](../../backup/backup-azure-arm-vms-prepare.md#network-connectivity).</span><span class="sxs-lookup"><span data-stu-id="7a3d2-284">Follow these instructions for [Network connectivity](../../backup/backup-azure-arm-vms-prepare.md#network-connectivity).</span></span>

6.  <span data-ttu-id="7a3d2-285">Zodra de bovenstaande stappen zijn voltooid, wordt de back-up wordt uitgevoerd met regelmatige tussenpozen zoals opgegeven in de back-upbeleid.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-285">Once the above steps are completed, the backup will run at regular intervals as specified in the backup policy.</span></span> <span data-ttu-id="7a3d2-286">Indien nodig, kunt u de eerste back-up handmatig van het kluisdashboard op de Azure-portal activeren.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-286">If necessary, you can trigger the first backup manually from the vault dashboard on the Azure portal.</span></span>

<span data-ttu-id="7a3d2-287">Voor het automatiseren van Azure Backup met behulp van scripts, Raadpleeg [PowerShell-cmdlets voor VM-back-](../../backup/backup-azure-vms-automation.md).</span><span class="sxs-lookup"><span data-stu-id="7a3d2-287">For automating Azure Backup using scripts, please refer to [PowerShell cmdlets for VM backup](../../backup/backup-azure-vms-automation.md).</span></span>

### <a name="steps-for-recovery"></a><span data-ttu-id="7a3d2-288">Stappen voor herstel</span><span class="sxs-lookup"><span data-stu-id="7a3d2-288">Steps for Recovery</span></span>

<span data-ttu-id="7a3d2-289">Als u wilt herstellen of opnieuw opbouwen van een virtuele machine, kunt u de virtuele machine herstellen uit een van de back-up herstelpunten in de kluis.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-289">If you need to repair or rebuild a VM, you can restore the VM from any of the backup recovery points in the vault.</span></span> <span data-ttu-id="7a3d2-290">Er zijn een aantal verschillende opties voor het uitvoeren van het herstel:</span><span class="sxs-lookup"><span data-stu-id="7a3d2-290">There are a couple of different options for performing the recovery:</span></span>

1.  <span data-ttu-id="7a3d2-291">U kunt een nieuwe virtuele machine maken als een punt in tijd representatie van een back-up van de VM.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-291">You can create a new VM as a point-in-time representation of your backed-up VM.</span></span>

2.  <span data-ttu-id="7a3d2-292">U kunt de schijven herstellen en vervolgens de sjabloon voor de virtuele machine aan te passen en de herstelde virtuele machine opnieuw gebruiken.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-292">You can restore the disks and then use the template for the VM to customize and rebuild the restored VM.</span></span> 

<span data-ttu-id="7a3d2-293">Zie de instructies voor het [gebruik Azure portal voor virtuele machines herstellen](../../backup/backup-azure-arm-restore-vms.md#restoring-a-vm-during-azure-datacenter-disaster).</span><span class="sxs-lookup"><span data-stu-id="7a3d2-293">See instructions to [Use Azure portal to restore virtual machines](../../backup/backup-azure-arm-restore-vms.md#restoring-a-vm-during-azure-datacenter-disaster).</span></span> <span data-ttu-id="7a3d2-294">Het document wordt ook uitgelegd voor de specifieke stappen voor het terugzetten van back-up VMs tot gebruik van uw geografisch redundante back-upkluis in het geval van een noodgeval op het primaire Datacenter gekoppeld Datacenter.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-294">The document also explains the specific steps for restoring backed-up VMs to the paired data center using your geo-redundant backup vault in the case of a disaster at the primary data center.</span></span> <span data-ttu-id="7a3d2-295">Azure Backup gebruikt in dat geval de Compute-service van de secundaire regio voor de herstelde virtuele machine maken.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-295">In that case, Azure Backup uses the Compute service from the secondary region to create the restored virtual machine.</span></span>

<span data-ttu-id="7a3d2-296">U kunt ook PowerShell voor [herstellen van een virtuele machine](../../backup/backup-azure-vms-automation.md#restore-an-azure-vm) of voor [schijven maken van een nieuwe virtuele machine uit hersteld](../../backup/backup-azure-vms-automation.md#create-a-vm-from-restored-disks).</span><span class="sxs-lookup"><span data-stu-id="7a3d2-296">You can also use PowerShell for [restoring a VM](../../backup/backup-azure-vms-automation.md#restore-an-azure-vm) or for [creating a new VM from restored disks](../../backup/backup-azure-vms-automation.md#create-a-vm-from-restored-disks).</span></span>

## <a name="alternative-solution-consistent-snapshots"></a><span data-ttu-id="7a3d2-297">Alternatieve oplossing: Toepassingsconsistente momentopnamen</span><span class="sxs-lookup"><span data-stu-id="7a3d2-297">Alternative Solution: Consistent Snapshots</span></span>

<span data-ttu-id="7a3d2-298">Als u geen gebruik van de Azure Backup-Service, kunt u uw eigen back-mechanisme met momentopnamen kunt implementeren.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-298">If you are unable to use the Azure Backup Service, you can implement your own backup mechanism using snapshots.</span></span> <span data-ttu-id="7a3d2-299">Het is ingewikkeld toepassingsconsistente momentopnamen voor alle schijven die worden gebruikt door een virtuele machine maken en deze momentopnamen worden vervolgens gerepliceerd naar een andere regio.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-299">It is complicated to create consistent snapshots for all disks used by a VM and then replicate those snapshots to another region.</span></span> <span data-ttu-id="7a3d2-300">Om deze reden beschouwt Azure gebruik te maken van de Backup-Service een betere optie dan een aangepaste oplossing bouwen.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-300">For this reason, Azure considers leveraging the Backup Service a better option than building a custom solution.</span></span> <span data-ttu-id="7a3d2-301">Als u met RA-GRS/GRS opslag voor schijven, momentopnamen automatisch gerepliceerd naar een secundaire Datacenter.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-301">If you use RA-GRS/GRS storage for disks, snapshots are automatically replicated to a secondary data center.</span></span> <span data-ttu-id="7a3d2-302">Als u LRS opslag voor schijven gebruikt, moet u voor replicatie van de gegevens.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-302">If you use LRS storage for disks, you will need to replicate the data yourself.</span></span> <span data-ttu-id="7a3d2-303">Zie voor meer informatie [Back-up van Azure niet-beheerde VM-schijven met incrementele momentopnamen](../../virtual-machines/windows/incremental-snapshots.md).</span><span class="sxs-lookup"><span data-stu-id="7a3d2-303">For more information, see [Back up Azure unmanaged VM disks with incremental snapshots](../../virtual-machines/windows/incremental-snapshots.md).</span></span>

<span data-ttu-id="7a3d2-304">Een momentopname is een weergave van een object op een bepaald punt in tijd.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-304">A snapshot is a representation of an object at a specific point in time.</span></span> <span data-ttu-id="7a3d2-305">Een momentopname wordt in rekening gebracht facturering voor de incrementele hoeveelheid gegevens die deze bevat.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-305">A snapshot will incur billing for the incremental size of the data it holds.</span></span> <span data-ttu-id="7a3d2-306">Zie voor meer informatie [momentopname maken van een blob](../blobs/storage-blob-snapshots.md).</span><span class="sxs-lookup"><span data-stu-id="7a3d2-306">For more information, see [Create a blob snapshot](../blobs/storage-blob-snapshots.md).</span></span>

### <a name="creating-snapshots-while-the-vm-is-running"></a><span data-ttu-id="7a3d2-307">Maken van momentopnamen terwijl de virtuele machine wordt uitgevoerd</span><span class="sxs-lookup"><span data-stu-id="7a3d2-307">Creating snapshots while the VM is running</span></span>

<span data-ttu-id="7a3d2-308">Terwijl u een momentopname op elk gewenst moment uitvoeren kunt als de virtuele machine wordt uitgevoerd, er zijn nog steeds gegevens worden gestreamd naar de schijven en de momentopnamen gedeeltelijke bewerkingen die tijdens de vlucht zijn kunnen bevatten.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-308">While you can take a snapshot at any time, if the VM is running, there is still data being streamed to the disks, and the snapshots may contain partial operations that were in flight.</span></span> <span data-ttu-id="7a3d2-309">Ook als er meerdere schijven die zijn betrokken, de momentopnamen van verschillende schijven mogelijk opgetreden op verschillende tijdstippen, wat betekent dat deze momentopnamen kunnen niet worden gecoördineerd.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-309">Also, if there are several disks involved, the snapshots of different disks may have occurred at different times, which means these snapshots may not be coordinated.</span></span> <span data-ttu-id="7a3d2-310">Dit is vooral problematisch voor striped volumes waarvan de bestanden beschadigd kunnen raken als wijzigingen tijdens de back-up wordt gemaakt.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-310">This is especially problematic for striped volumes whose files can be corrupted if changes were being made during backup.</span></span>

<span data-ttu-id="7a3d2-311">Om deze situatie te voorkomen, moet het back-upproces implementeren de volgende stappen uit:</span><span class="sxs-lookup"><span data-stu-id="7a3d2-311">To avoid this situation, the backup process must implement the following steps:</span></span>

1.  <span data-ttu-id="7a3d2-312">Alle schijven blokkeren</span><span class="sxs-lookup"><span data-stu-id="7a3d2-312">Freeze all the disks</span></span>

2.  <span data-ttu-id="7a3d2-313">De in behandeling geschreven leegmaken</span><span class="sxs-lookup"><span data-stu-id="7a3d2-313">Flush all the pending writes</span></span>

3.  <span data-ttu-id="7a3d2-314">Vervolgens [momentopname maken van een blob](../blobs/storage-blob-snapshots.md) voor alle schijven</span><span class="sxs-lookup"><span data-stu-id="7a3d2-314">Then, [create a blob snapshot](../blobs/storage-blob-snapshots.md) for all the disks</span></span>

<span data-ttu-id="7a3d2-315">Sommige Windows-toepassingen zoals SQL Server bieden een gecoördineerde back-mechanisme via VSS toepassingsconsistente back-ups maken.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-315">Some Windows applications like SQL Server provide a coordinated backup mechanism via VSS to create application-consistent backups.</span></span> <span data-ttu-id="7a3d2-316">Op Linux, kunt u een hulpprogramma zoals fsfreeze voor de coördinatie van de schijven, zodat er bestandsconsistente back-ups, maar niet toepassingsconsistente momentopnamen.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-316">On Linux, you can use a tool like fsfreeze for coordinating the disks, which will provide file-consistent backups, but not application-consistent snapshots.</span></span> <span data-ttu-id="7a3d2-317">Dit proces is ingewikkeld, dus en moet u overwegen [Azure Backup](../../backup/backup-azure-vms-introduction.md) of een back-upoplossing van derden die dit al te implementeren.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-317">This process is complicated, so and you should consider using [Azure Backup](../../backup/backup-azure-vms-introduction.md) or a third-party backup solution which already implement this.</span></span>

<span data-ttu-id="7a3d2-318">De bovenstaande procedure resulteert in een verzameling van gecoördineerde momentopnamen voor alle VM schijven, voor een bepaald punt in tijd weergave van de virtuele machine.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-318">The above process will result in a collection of coordinated snapshots for all the VM disks, representing a specific point-in-time view of the VM.</span></span> <span data-ttu-id="7a3d2-319">Dit is een herstelpunt voor back-up voor de virtuele machine.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-319">This is a backup restore point for the VM.</span></span> <span data-ttu-id="7a3d2-320">U kunt het proces herhalen met regelmatige tussenpozen periodiek back-ups maken.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-320">You can repeat the process at scheduled intervals to create periodic backups.</span></span> <span data-ttu-id="7a3d2-321">Hieronder vindt u de stappen voor het [kopiëren van de back-ups naar een andere regio](#copy-the-snapshots-to-another-region) voor herstel na Noodgevallen.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-321">See below for the steps to [copy the backups to another region](#copy-the-snapshots-to-another-region) for DR.</span></span>

### <a name="creating-snapshots-while-the-vm-is-offline"></a><span data-ttu-id="7a3d2-322">Maken van momentopnamen terwijl de virtuele machine offline is.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-322">Creating snapshots while the VM is offline</span></span>

<span data-ttu-id="7a3d2-323">Een andere optie voor het maken van consistente back-ups is afgesloten met de virtuele machine en maken van momentopnamen van de blob van elke schijf.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-323">Another option to create consistent backups is shutting down the VM and taking blob snapshots of each disk.</span></span> <span data-ttu-id="7a3d2-324">Dit is eenvoudiger dan coördinerende momentopnamen van een actieve virtuele machine, maar een paar minuten uitvaltijd is vereist.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-324">This is easier than coordinating snapshots of a running VM, but it requires a few minutes of downtime.</span></span> <span data-ttu-id="7a3d2-325">Bij dit proces wordt als volgt:</span><span class="sxs-lookup"><span data-stu-id="7a3d2-325">For this process, follow these steps:</span></span>

1. <span data-ttu-id="7a3d2-326">De virtuele machine afgesloten.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-326">Shut down the VM.</span></span>

2. <span data-ttu-id="7a3d2-327">Maak een momentopname van elke VHD-blob, die slechts enkele seconden duurt.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-327">Create a snapshot of each VHD blob, which only takes a few seconds.</span></span>

    <span data-ttu-id="7a3d2-328">U kunt gebruiken voor het maken van een momentopname [PowerShell](storage-powershell-guide-full.md#how-to-manage-azure-blob-snapshots), wordt de [Rest-API van Azure Storage](https://msdn.microsoft.com/library/azure/ee691971.aspx), [Azure CLI](https://docs.microsoft.com/azure/xplat-cli-install), of een van de clientbibliotheken van Azure Storage, zoals [de Storage-clientbibliotheek voor .NET](https://msdn.microsoft.com/library/azure/hh488361.aspx).</span><span class="sxs-lookup"><span data-stu-id="7a3d2-328">To create a snapshot, you can use [PowerShell](storage-powershell-guide-full.md#how-to-manage-azure-blob-snapshots), the [Azure Storage Rest API](https://msdn.microsoft.com/library/azure/ee691971.aspx), [Azure CLI](https://docs.microsoft.com/azure/xplat-cli-install), or one of the Azure Storage Client Libraries such as [the Storage client library for .NET](https://msdn.microsoft.com/library/azure/hh488361.aspx).</span></span>

3. <span data-ttu-id="7a3d2-329">Start de virtuele machine, waardoor de uitvaltijd eindigt.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-329">Start the VM, which ends the downtime.</span></span> <span data-ttu-id="7a3d2-330">Doorgaans het hele proces is voltooid binnen een paar minuten.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-330">Typically the entire process completes within a few minutes.</span></span>

<span data-ttu-id="7a3d2-331">Dit proces resulteert in een verzameling van toepassingsconsistente momentopnamen voor alle schijven bieden een back-up herstelpunt voor de virtuele machine.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-331">This process yields a collection of consistent snapshots for all the disks, providing a backup restore point for the VM.</span></span> <span data-ttu-id="7a3d2-332">Hieronder vindt u de stappen voor het kopiëren van de momentopnamen voor een andere regio voor herstel na Noodgevallen.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-332">See below for the steps to copy the snapshots to another region for DR.</span></span>

### <a name="copy-the-snapshots-to-another-region"></a><span data-ttu-id="7a3d2-333">De momentopnamen kopiëren naar een andere regio</span><span class="sxs-lookup"><span data-stu-id="7a3d2-333">Copy the snapshots to another region</span></span>

<span data-ttu-id="7a3d2-334">Het maken van de momentopnamen die alleen zijn mogelijk niet voldoende is voor herstel na Noodgevallen.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-334">Creation of the snapshots alone may not be sufficient for DR.</span></span> <span data-ttu-id="7a3d2-335">U moet ook de momentopnameback-ups worden gerepliceerd naar een andere regio.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-335">You must also replicate the snapshot backups to another region.</span></span>

<span data-ttu-id="7a3d2-336">Als u GRS of RA-GRS van de schijven en vervolgens de momentopnamen automatisch naar de secundaire regio worden gerepliceerd.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-336">If you are using GRS or RA-GRS for your disks, then the snapshots are replicated to the secondary region automatically.</span></span> <span data-ttu-id="7a3d2-337">Er kan een paar minuten vertraging vóór de replicatie, en als het primaire Datacenter wordt uitgeschakeld voordat de momentopnamen voltooien repliceren, kunt u zich niet toegang hebben tot de momentopnamen van het secundaire Datacenter.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-337">There can be a few minutes of lag before the replication, and if the primary data center goes down before the snapshots finish replicating, you will not be able to access the snapshots from the secondary data center.</span></span> <span data-ttu-id="7a3d2-338">De kans is klein.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-338">The likelihood of this is small.</span></span>

> [!Note] 
> <span data-ttu-id="7a3d2-339">Alleen met de schijven in een GRS of RA-GRS-account, worden de virtuele machine niet beveiligd tegen rampen.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-339">Only having the disks in a GRS or RA-GRS account does not protect the VM from disasters.</span></span> <span data-ttu-id="7a3d2-340">U moet ook gecoördineerde momentopnamen maken of gebruiken van Azure Backup.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-340">You must also create coordinated snapshots or use Azure Backup.</span></span> <span data-ttu-id="7a3d2-341">Dit is vereist voor het herstellen van een virtuele machine naar een consistente status.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-341">This is required to recover a VM to a consistent state.</span></span>

<span data-ttu-id="7a3d2-342">Als u LRS gebruikt, moet u de momentopnamen kopiëren naar een ander opslagaccount onmiddellijk na het maken van een momentopname.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-342">If you are using LRS, you must copy the snapshots to a different storage account immediately after creating the snapshot.</span></span> <span data-ttu-id="7a3d2-343">Het doel voor het kopiëren wordt mogelijk een LRS storage-account in een andere regio, wat resulteert in het exemplaar wordt in een externe regio.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-343">The copy target could be an LRS storage account in a different region, resulting in the copy being in a remote region.</span></span> <span data-ttu-id="7a3d2-344">U kunt ook de momentopname kopiëren naar een RA-GRS-opslagaccount in dezelfde regio.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-344">You can also copy the snapshot to an RA-GRS storage account in the same region.</span></span> <span data-ttu-id="7a3d2-345">In dit geval wordt worden de momentopname vertraagd gerepliceerd naar de externe secundaire regio.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-345">In this case, the snapshot will be lazily replicated to the remote secondary region.</span></span> <span data-ttu-id="7a3d2-346">Uw back-up is beveiligd tegen rampen op de primaire site eenmaal het kopiëren en replicatie is voltooid.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-346">Your backup is protected from disasters at the primary site once the copying and replication is complete.</span></span>

<span data-ttu-id="7a3d2-347">Als u wilt kopiëren efficiënt uw incrementele momentopnamen voor herstel na Noodgevallen, lees de instructies in [Back-up van Azure niet-beheerde VM-schijven met incrementele momentopnamen](../../virtual-machines/windows/incremental-snapshots.md).</span><span class="sxs-lookup"><span data-stu-id="7a3d2-347">To copy your incremental snapshots for DR efficiently, review the instructions in [Back up Azure unmanaged VM disks with incremental snapshots](../../virtual-machines/windows/incremental-snapshots.md).</span></span>

![](./media/storage-backup-and-disaster-recovery-for-azure-iaas-disks/backup-and-disaster-recovery-for-azure-iaas-disks-2.png)   

### <a name="recovery-from-snapshots"></a><span data-ttu-id="7a3d2-348">Herstel van momentopnamen</span><span class="sxs-lookup"><span data-stu-id="7a3d2-348">Recovery from Snapshots</span></span>

<span data-ttu-id="7a3d2-349">Voor het ophalen van een momentopname, zodat een nieuwe blob te kopiëren.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-349">To retrieve a snapshot, copy it to make a new blob.</span></span> <span data-ttu-id="7a3d2-350">Als u de momentopname van de primaire account kopieert, kunt u de momentopname naar de base blob van de momentopname dus herstellen van de schijf voor de momentopname; Dit staat bekend als het promoveren van de momentopname.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-350">If you are copying the snapshot from the primary account, you can copy the snapshot over to the base blob of the snapshot, thus reverting the disk to the snapshot; this is known as promoting the snapshot.</span></span> <span data-ttu-id="7a3d2-351">Als u kopieert de momentopname back-up van een secundaire account (bij RA-GRS), moet deze worden gekopieerd naar een primaire-account.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-351">If you are copying the snapshot backup from a secondary account (in the case of RA-GRS), it must be copied to a primary account.</span></span> <span data-ttu-id="7a3d2-352">U kunt een momentopname kopiëren [met behulp van PowerShell](storage-powershell-guide-full.md#how-to-copy-a-snapshot-of-a-blob) of met het AzCopy-hulpprogramma.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-352">You can copy a snapshot [using PowerShell](storage-powershell-guide-full.md#how-to-copy-a-snapshot-of-a-blob) or using the AzCopy utility.</span></span> <span data-ttu-id="7a3d2-353">Zie voor meer informatie [gegevensoverdracht met het AzCopy-opdrachtregelprogramma](storage-use-azcopy.md).</span><span class="sxs-lookup"><span data-stu-id="7a3d2-353">For more information, see [Transfer data with the AzCopy Command-Line Utility](storage-use-azcopy.md).</span></span>

<span data-ttu-id="7a3d2-354">In het geval van virtuele machines met meerdere schijven, moet u de momentopnamen die deel van hetzelfde gecoördineerde herstelpunt uitmaken kopiëren.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-354">In the case of VMs with multiple disks, you must copy all the snapshots that are part of the same coordinated restore point.</span></span> <span data-ttu-id="7a3d2-355">Zodra u de momentopnamen naar beschrijfbare VHD-blobs kopiëren, kunt u de blobs kunt gebruiken om uw virtuele machine met de sjabloon voor de virtuele machine opnieuw te maken.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-355">Once you copy the snapshots to writable VHD blobs, you can use the blobs to recreate your VM using the template for the VM.</span></span>

## <a name="other-options"></a><span data-ttu-id="7a3d2-356">Andere opties</span><span class="sxs-lookup"><span data-stu-id="7a3d2-356">Other options</span></span>

### <a name="sql-server"></a><span data-ttu-id="7a3d2-357">SQL Server</span><span class="sxs-lookup"><span data-stu-id="7a3d2-357">SQL Server</span></span>

<span data-ttu-id="7a3d2-358">SQL Server wordt uitgevoerd op een virtuele machine heeft een eigen ingebouwde mogelijkheden voor het back-up van uw SQL Server-database naar Azure Blob-opslag of een bestandsshare.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-358">SQL Server running in a VM has its own built-in capabilities to backup your SQL Server database to Azure Blob storage or a file share.</span></span> <span data-ttu-id="7a3d2-359">Als het opslagaccount GRS of RA-GRS is, kunt u deze back-ups in het opslagaccount secundaire datacenter in het geval van een ramp, met dezelfde beperkingen openen, zoals eerder besproken.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-359">If the storage account is GRS or RA-GRS, you can access those backups in the storage account’s secondary data center in the event of a disaster, with the same restrictions as discussed previously.</span></span> <span data-ttu-id="7a3d2-360">Zie voor meer informatie [back-up en herstel voor SQL Server in Azure Virtual Machines](../../virtual-machines/windows/sql/virtual-machines-windows-sql-backup-recovery.md).</span><span class="sxs-lookup"><span data-stu-id="7a3d2-360">For more information, see [Backup and Restore for SQL Server in Azure Virtual Machines](../../virtual-machines/windows/sql/virtual-machines-windows-sql-backup-recovery.md).</span></span> <span data-ttu-id="7a3d2-361">Naast back-up and restore [SQL Server altijd op beschikbaarheidsgroepen](../../virtual-machines/windows/sql/virtual-machines-windows-sql-high-availability-dr.md) secundaire replica's van databases in aanzienlijk minder hersteltijd na noodgevallen kunt onderhouden.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-361">In addition to backup and restore, [SQL Server Always On Availability Groups](../../virtual-machines/windows/sql/virtual-machines-windows-sql-high-availability-dr.md) can maintain secondary replicas of databases to greatly reduce the disaster recovery time.</span></span>

## <a name="other-considerations"></a><span data-ttu-id="7a3d2-362">Andere overwegingen</span><span class="sxs-lookup"><span data-stu-id="7a3d2-362">Other considerations</span></span>

<span data-ttu-id="7a3d2-363">In dit artikel is beschreven hoe u back-up of momentopnamen van uw virtuele machines en hun schijven voor de ondersteuning van herstel na noodgevallen en hoe deze gebruiken om te herstellen.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-363">This article has discussed how to backup or take snapshots of your VMs and their disks to support disaster recovery, and how to use those to recover.</span></span> <span data-ttu-id="7a3d2-364">Met het Azure Resource Manager-model veel mensen sjablonen gebruiken hun virtuele machines en andere infrastructuur maken in Azure.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-364">With the Azure Resource Manager model, many people use templates to create their VMs and other infrastructure in Azure.</span></span> <span data-ttu-id="7a3d2-365">Een sjabloon kunt u een virtuele machine met dezelfde configuratie elke keer maken.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-365">You can use a template to create a VM that has the same configuration every time.</span></span> <span data-ttu-id="7a3d2-366">Als u aangepaste installatiekopieën gebruikt voor het maken van uw virtuele machines, moet u ervoor dat uw installatiekopieën zijn beveiligd met een RA-GRS-account wilt opslaan.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-366">If you use custom images for creating your VMs, you must also make sure your images are protected by using an RA-GRS account to store them.</span></span>

<span data-ttu-id="7a3d2-367">Uw back-upproces mogelijk als gevolg daarvan kan een combinatie van twee dingen:</span><span class="sxs-lookup"><span data-stu-id="7a3d2-367">Consequently, your backup process may be a combination of two things:</span></span>

1. <span data-ttu-id="7a3d2-368">Back-up van de gegevens (schijven)</span><span class="sxs-lookup"><span data-stu-id="7a3d2-368">Backup the data (disks)</span></span>
2. <span data-ttu-id="7a3d2-369">Back-up van de configuratie (sjablonen, aangepaste installatiekopieën)</span><span class="sxs-lookup"><span data-stu-id="7a3d2-369">Backup the configuration (templates, custom images)</span></span>

<span data-ttu-id="7a3d2-370">Wellicht hebt u voor het afhandelen van de back-up van zowel de gegevens en de configuratie, afhankelijk van de back-optie die u kiest, of de Backup-service al die voor u kan verwerken.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-370">Depending on the backup option you choose, you may have to handle the backup of both the data and the configuration, or the backup service may handle all of that for you.</span></span>

## <a name="appendix---understanding-the-impact-of-lrs-grs-and-ra-grs"></a><span data-ttu-id="7a3d2-371">Bijlage - het effect van LRS GRS en RA-GRS</span><span class="sxs-lookup"><span data-stu-id="7a3d2-371">Appendix - Understanding the impact of LRS, GRS, and RA-GRS</span></span>

<span data-ttu-id="7a3d2-372">Voor de storage-accounts in Azure, er zijn drie typen van de redundantie van de gegevens die u met betrekking tot noodherstel – lokaal redundante (LRS) geografisch redundante (GRS overwegen moet) of geografisch redundante met lezen toegang (RA-GRS).</span><span class="sxs-lookup"><span data-stu-id="7a3d2-372">For storage accounts in Azure, there are three types of data redundancy that you should consider regarding disaster recovery – locally redundant (LRS), geo-redundant (GRS), or geo-redundant with read access (RA-GRS).</span></span> 

<span data-ttu-id="7a3d2-373">Lokaal behoudt redundante opslag (LRS) drie kopieën van de gegevens in hetzelfde Datacenter.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-373">Locally Redundant Storage (LRS) retains three copies of the data in the same data center.</span></span> <span data-ttu-id="7a3d2-374">Bij het schrijven van de gegevens, worden alle drie kopieën worden bijgewerkt voordat succes aan de aanroeper wordt geretourneerd, zodat u weet dat ze identiek zijn.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-374">When writing the data, all three copies are updated before success is returned to the caller, so you know they are identical.</span></span> <span data-ttu-id="7a3d2-375">De schijf is beveiligd tegen lokale stroomstoringen, omdat het is zeer onwaarschijnlijk dat alle drie kopieën op hetzelfde moment zou worden beïnvloed.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-375">Your disk is protected from local failures, since it is extremely unlikely that all three copies would be impacted at the same time.</span></span> <span data-ttu-id="7a3d2-376">In het geval van LRS is er geen geografische redundantie, zodat de schijf is niet beveiligd tegen onherstelbare fouten die invloed op een volledige data center of de opslag-eenheid hebben kunnen.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-376">In the case of LRS, there is no geo-redundancy, so the disk is not protected from catastrophic failures that can impact an entire data center or storage unit.</span></span>

<span data-ttu-id="7a3d2-377">Met GRS en RA-GRS drie kopieën van uw gegevens worden bewaard in de primaire regio (u hebt geselecteerd) en drie extra kopieën van uw gegevens blijven behouden in een bijbehorende secundaire regio (ingesteld door Azure).</span><span class="sxs-lookup"><span data-stu-id="7a3d2-377">With GRS and RA-GRS, three copies of your data are retained in the primary region (selected by you), and three more copies of your data are retained in a corresponding secondary region (set by Azure).</span></span> <span data-ttu-id="7a3d2-378">Als u gegevens in VS-West opslaat, wordt er bijvoorbeeld de gegevens worden gerepliceerd naar VS-Oost.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-378">For example, if you store data in West US, the data will be replicated to East US.</span></span> <span data-ttu-id="7a3d2-379">Dit asynchroon wordt gedaan en er is een kleine vertraging tussen de updates naar de primaire en secundaire.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-379">This is done asynchronously, and there is a small delay between updates to the primary and secondary.</span></span> <span data-ttu-id="7a3d2-380">Replica's van de schijven op de secundaire site zijn consistent op basis van per schijf (met de vertraging), maar de replica's van meerdere actieve schijven mogelijk niet synchroon **met elkaar**.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-380">Replicas of the disks on the secondary site are consistent on a per-disk basis (with the delay), but replicas of multiple active disks may not be in sync **with each other**.</span></span> <span data-ttu-id="7a3d2-381">Toepassingsconsistente momentopnamen zijn om een consistente replica's maken over meerdere schijven, nodig.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-381">To have consistent replicas across multiple disks, consistent snapshots are needed.</span></span>

<span data-ttu-id="7a3d2-382">Het belangrijkste verschil tussen GRS en RA-GRS is met RA-GRS, kunt u de secundaire kopie lezen op elk gewenst moment.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-382">The main difference between GRS and RA-GRS is that with RA-GRS, you can read the secondary copy at any time.</span></span> <span data-ttu-id="7a3d2-383">Als er een probleem dat de gegevens in de primaire regio niet toegankelijk samenstelt, is het team van Azure brengt alles in het werk toegang herstellen.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-383">If there is a problem that renders the data in the primary region inaccessible, the Azure team will make every effort to restore access.</span></span> <span data-ttu-id="7a3d2-384">Terwijl de primaire niet beschikbaar is, hebt u RA-GRS is ingeschakeld, kunt u toegang tot de gegevens in het secundaire Datacenter.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-384">While the primary is down, if you have RA-GRS enabled, you can access the data in the secondary data center.</span></span> <span data-ttu-id="7a3d2-385">Dus als u van plan bent om te lezen van de replica als de primaire niet toegankelijk is, moet klikt u vervolgens RA-GRS worden overwogen.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-385">Therefore, if you plan to read from the replica while the primary is inaccessible, then RA-GRS should be considered.</span></span>

<span data-ttu-id="7a3d2-386">Als blijkt te zijn van een aanzienlijke onderbreking, mag het team van Azure activeert u een geo-failover en wijzigen van de primaire DNS-vermeldingen om te verwijzen naar de secundaire opslag.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-386">If it turns out to be a significant outage, the Azure team may trigger a geo-failover and change the primary DNS entries to point to secondary storage.</span></span> <span data-ttu-id="7a3d2-387">Als u beide GRS of RA-GRS ingeschakeld, kunt u nu de gegevens in de regio die wordt gebruikt om te worden van de secundaire openen.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-387">At this point, if you have either GRS or RA-GRS enabled, you can access the data in the region that used to be the secondary.</span></span> <span data-ttu-id="7a3d2-388">Met andere woorden, als uw storage-account GRS is en er een probleem is, u kunt toegang tot de secundaire opslag alleen als er een geo-failover.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-388">In other words, if your storage account is GRS and there is a problem, you can access the secondary storage only if there is a geo-failover.</span></span>

<span data-ttu-id="7a3d2-389">Zie voor meer informatie [wat te doen als een Azure Storage-storing optreedt,](storage-disaster-recovery-guidance.md).</span><span class="sxs-lookup"><span data-stu-id="7a3d2-389">For more information, see [What to do if an Azure Storage outage occurs](storage-disaster-recovery-guidance.md).</span></span> 

<span data-ttu-id="7a3d2-390">Houd er rekening mee dat Microsoft kan bepalen of er een failover plaatsvindt.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-390">Note that Microsoft controls whether a failover occurs.</span></span> <span data-ttu-id="7a3d2-391">Failover niet per storage-account wordt beheerd, wordt daarom niet besloten door individuele klanten.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-391">Failover is not controlled per storage account, therefore it is not decided by individual customers.</span></span> <span data-ttu-id="7a3d2-392">Als u wilt implementeren herstel na noodgevallen voor specifieke storage-accounts of schijven op virtuele machine, moet u de technieken die eerder in dit artikel wordt beschreven.</span><span class="sxs-lookup"><span data-stu-id="7a3d2-392">To implement Disaster Recovery for specific storage accounts or virtual machine disks, you must use the techniques described previously in this article.</span></span>
