---
title: aaaDesigning maximaal beschikbare toepassingen met behulp van Azure leestoegang geografisch redundante opslag (RA-GRS) | Microsoft Docs
description: Hoe toouse Azure RA-GRS opslag tooarchitect een maximaal beschikbare toepassing flexibel genoeg toohandle storingen.
services: storage
documentationcenter: .net
author: robinsh
manager: timlt
editor: tysonn
ms.assetid: 8f040b0f-8926-4831-ac07-79f646f31926
ms.service: storage
ms.workload: storage
ms.tgt_pltfrm: na
ms.devlang: dotnet
ms.topic: article
ms.date: 1/19/2017
ms.author: robinsh
ms.openlocfilehash: e4a9fe7ef33eecd894408b3c1ef59920a248d1bd
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 10/06/2017
---
# <a name="designing-highly-available-applications-using-ra-grs"></a><span data-ttu-id="0bf00-103">Maximaal beschikbare toepassingen met behulp van RA-GRS ontwerpen</span><span class="sxs-lookup"><span data-stu-id="0bf00-103">Designing Highly Available Applications using RA-GRS</span></span>

<span data-ttu-id="0bf00-104">Een algemene functie van de cloud-gebaseerde infrastructuur is dat ze een maximaal beschikbare platform voor het hosten van toepassingen.</span><span class="sxs-lookup"><span data-stu-id="0bf00-104">A common feature of cloud-based infrastructures is that they provide a highly available platform for hosting applications.</span></span> <span data-ttu-id="0bf00-105">Ontwikkelaars van toepassingen op basis van een cloud moeten rekening houden met zorgvuldig hoe tooleverage dit platform toodeliver maximaal beschikbare toepassingen tootheir gebruikers.</span><span class="sxs-lookup"><span data-stu-id="0bf00-105">Developers of cloud-based applications must consider carefully how tooleverage this platform toodeliver highly available applications tootheir users.</span></span> <span data-ttu-id="0bf00-106">In dit artikel is gericht specifiek op hoe ontwikkelaars van hello Azure Storage geografisch redundante opslag met leestoegang (RA-GRS) toomake gebruikmaken kunnen hun toepassingen meer beschikbaar.</span><span class="sxs-lookup"><span data-stu-id="0bf00-106">This article focuses specifically on how developers can use hello Azure Storage Read Access Geo Redundant Storage (RA-GRS) toomake their applications more available.</span></span>

<span data-ttu-id="0bf00-107">Er zijn vier opties voor de redundantie – LRS (lokaal redundante opslag), ZRS (Zone-redundante opslag), (Geo-Redundant Storage) GRS en RA-GRS (leestoegang Geo-Redundant Storage).</span><span class="sxs-lookup"><span data-stu-id="0bf00-107">There are four choices for redundancy – LRS (Locally Redundant Storage), ZRS (Zone Redundant Storage), GRS (Geo-Redundant Storage), and RA-GRS (Read Access Geo-Redundant Storage).</span></span> <span data-ttu-id="0bf00-108">We gaan toodiscuss GRS en RA-GRS in dit artikel.</span><span class="sxs-lookup"><span data-stu-id="0bf00-108">We are going toodiscuss GRS and RA-GRS in this article.</span></span> <span data-ttu-id="0bf00-109">Met GRS worden in Hallo primaire regio die u hebt geselecteerd bij het instellen van het opslagaccount Hallo drie kopieën van uw gegevens bewaard.</span><span class="sxs-lookup"><span data-stu-id="0bf00-109">With GRS, three copies of your data are kept in hello primary region you selected when setting up hello storage account.</span></span> <span data-ttu-id="0bf00-110">Drie extra kopieën worden asynchroon worden bijgehouden in een secundaire regio die is opgegeven door Azure.</span><span class="sxs-lookup"><span data-stu-id="0bf00-110">Three additional copies are maintained asynchronously in a secondary region specified by Azure.</span></span> <span data-ttu-id="0bf00-111">RA-GRS is hetzelfde als GRS hello, behalve dat u leestoegang toohello secundaire exemplaar hebt.</span><span class="sxs-lookup"><span data-stu-id="0bf00-111">RA-GRS is hello same thing as GRS except that you have read access toohello secondary copy.</span></span> <span data-ttu-id="0bf00-112">Zie voor meer informatie over verschillende opties voor Azure Storage redundantie Hallo [Azure Storage-replicatie](https://docs.microsoft.com/en-us/azure/storage/storage-redundancy).</span><span class="sxs-lookup"><span data-stu-id="0bf00-112">For more information about hello different Azure Storage redundancy options, see [Azure Storage replication](https://docs.microsoft.com/en-us/azure/storage/storage-redundancy).</span></span> <span data-ttu-id="0bf00-113">Hallo replicatie ook wordt uitgelegd Hallo koppelingen van Hallo primaire en secundaire regio's.</span><span class="sxs-lookup"><span data-stu-id="0bf00-113">hello replication article also shows hello pairings of hello primary and secondary regions.</span></span>

<span data-ttu-id="0bf00-114">Er zijn codefragmenten die zijn opgenomen in dit artikel en een koppeling tooa compleet codevoorbeeld aan Hallo einde die u kunt downloaden en uitvoeren.</span><span class="sxs-lookup"><span data-stu-id="0bf00-114">There are code snippets included in this article, and a link tooa complete sample at hello end that you can download and run.</span></span>

## <a name="key-features-of-ra-grs"></a><span data-ttu-id="0bf00-115">Belangrijke functies van RA-GRS</span><span class="sxs-lookup"><span data-stu-id="0bf00-115">Key features of RA-GRS</span></span>

<span data-ttu-id="0bf00-116">Voordat we hoe uitleggen toouse RA-GRS-opslag, iets over de eigenschappen en het gedrag.</span><span class="sxs-lookup"><span data-stu-id="0bf00-116">Before we talk about how toouse RA-GRS storage, let's talk about its properties and behavior.</span></span>

* <span data-ttu-id="0bf00-117">Azure-opslag onderhoudt een alleen-lezen kopie van Hallo-gegevens die u in de primaire regio in een secundaire regio opslaat; zoals eerder vermeld, bepaalt de opslagservice Hallo Hallo-locatie van de secundaire regio Hallo.</span><span class="sxs-lookup"><span data-stu-id="0bf00-117">Azure Storage maintains a read-only copy of hello data you store in your primary region in a secondary region; as noted above, hello storage service determines hello location of hello secondary region.</span></span>

* <span data-ttu-id="0bf00-118">Hallo alleen-lezen kopie is [uiteindelijk consistent](https://en.wikipedia.org/wiki/Eventual_consistency) met gegevens in de primaire regio Hallo Hallo.</span><span class="sxs-lookup"><span data-stu-id="0bf00-118">hello read-only copy is [eventually consistent](https://en.wikipedia.org/wiki/Eventual_consistency) with hello data in hello primary region.</span></span>

* <span data-ttu-id="0bf00-119">Voor blobs, tabellen en wachtrijen, kunt u een query Hallo secundaire regio voor een *tijd van laatste synchronisatie* waarde die aangeeft wanneer de laatste replicatie Hallo van Hallo primaire toohello secundaire regio is opgetreden.</span><span class="sxs-lookup"><span data-stu-id="0bf00-119">For blobs, tables, and queues, you can query hello secondary region for a *Last Sync Time* value that tells you when hello last replication from hello primary toohello secondary region occurred.</span></span> <span data-ttu-id="0bf00-120">(Dit wordt niet ondersteund voor Azure File storage die geen RA-GRS redundantie op dit moment.)</span><span class="sxs-lookup"><span data-stu-id="0bf00-120">(This is not supported for Azure File storage, which doesn't have RA-GRS redundancy at this time.)</span></span>

* <span data-ttu-id="0bf00-121">U kunt Hallo Storage-clientbibliotheek toointeract gebruiken met Hallo-gegevens in beide Hallo primaire of secundaire regio.</span><span class="sxs-lookup"><span data-stu-id="0bf00-121">You can use hello Storage Client Library toointeract with hello data in either hello primary or secondary region.</span></span> <span data-ttu-id="0bf00-122">U kunt ook omleiden lezen aanvragen automatisch toohello secundaire regio als een leesaanvraag toohello primaire regio een optreedt time-out.</span><span class="sxs-lookup"><span data-stu-id="0bf00-122">You can also redirect read requests automatically toohello secondary region if a read request toohello primary region times out.</span></span>

* <span data-ttu-id="0bf00-123">Als er een grote probleem met betrekking tot toegankelijkheid Hallo Hallo-gegevens in de primaire regio hello, activeren hello Azure team mogelijk een geo-failover, waarna de clientzijdebewaking Hallo DNS-vermeldingen die wijst toohello primaire regio gewijzigde toopoint toohello secundaire regio worden.</span><span class="sxs-lookup"><span data-stu-id="0bf00-123">If there is a major issue affecting hello accessibility of hello data in hello primary region, hello Azure team may trigger a geo-failover, at which point hello DNS entries pointing toohello primary region will be changed toopoint toohello secondary region.</span></span>

* <span data-ttu-id="0bf00-124">Als een geo-failover optreedt, wordt Azure selecteert u een nieuwe secundaire locatie en repliceren Hallo toothat gegevenslocatie vervolgens Hallo secundaire DNS-vermeldingen tooit verwijzen.</span><span class="sxs-lookup"><span data-stu-id="0bf00-124">If a geo-failover occurs, Azure will select a new secondary location and replicate hello data toothat location, then point hello secondary DNS entries tooit.</span></span> <span data-ttu-id="0bf00-125">secundair eindpunt Hallo is pas beschikbaar als Hallo storage-account is klaar met repliceren.</span><span class="sxs-lookup"><span data-stu-id="0bf00-125">hello secondary endpoint will be unavailable until hello storage account has finished replicating.</span></span> <span data-ttu-id="0bf00-126">Zie voor meer informatie [welke toodo als een Azure Storage-storing optreedt,](https://docs.microsoft.com/en-us/azure/storage/storage-disaster-recovery-guidance).</span><span class="sxs-lookup"><span data-stu-id="0bf00-126">For more information, please see [What toodo if an Azure Storage outage occurs](https://docs.microsoft.com/en-us/azure/storage/storage-disaster-recovery-guidance).</span></span>

## <a name="application-design-considerations-when-using-ra-grs"></a><span data-ttu-id="0bf00-127">Toepassing Ontwerpoverwegingen bij het gebruik van RA-GRS</span><span class="sxs-lookup"><span data-stu-id="0bf00-127">Application design considerations when using RA-GRS</span></span>

<span data-ttu-id="0bf00-128">Hallo belangrijkste doel van dit artikel is tooshow u hoe een toepassing die toofunction (maar in een beperkte capaciteit) wordt voortgezet zelfs in geval van een noodgeval op de primaire gegevensbron Hallo Hallo toodesign center.</span><span class="sxs-lookup"><span data-stu-id="0bf00-128">hello main purpose of this article is tooshow you how toodesign an application that will continue toofunction (albeit in a limited capacity) even in hello event of a major disaster at hello primary data center.</span></span> <span data-ttu-id="0bf00-129">U doen dit door uw toepassing toohandle tijdelijke of langdurige problemen door tooread overschakelen van de secundaire regio Hallo terwijl er een probleem is en weer schakelen wanneer de primaire regio Hallo weer beschikbaar is.</span><span class="sxs-lookup"><span data-stu-id="0bf00-129">You do this by having your application toohandle transient or long-running issues by switching tooread from hello secondary region while there is a problem, and switching back when hello primary region is available again.</span></span>

### <a name="using-eventually-consistent-data"></a><span data-ttu-id="0bf00-130">Met behulp van uiteindelijk consistent gegevens</span><span class="sxs-lookup"><span data-stu-id="0bf00-130">Using eventually consistent data</span></span>

<span data-ttu-id="0bf00-131">Deze voorgestelde oplossing wordt ervan uitgegaan dat het is niet erg tooreturn wat verouderde gegevens toohello aanroepende toepassing kan worden.</span><span class="sxs-lookup"><span data-stu-id="0bf00-131">This proposed solution assumes that it is okay tooreturn what could be stale data toohello calling application.</span></span> <span data-ttu-id="0bf00-132">Omdat secundaire gegevens Hallo uiteindelijk consistent is, is het mogelijk dat Hallo-gegevens zijn geschreven toohello primaire maar Hallo update toohello secundaire niet was voltooid repliceren wanneer de primaire regio Hallo werd niet toegankelijk.</span><span class="sxs-lookup"><span data-stu-id="0bf00-132">Because hello secondary data is eventually consistent, it is possible that hello data was written toohello primary but hello update toohello secondary had not finished replicating when hello primary region became inaccessible.</span></span>

<span data-ttu-id="0bf00-133">Bijvoorbeeld een update die is geslaagd door uw klant kan verzenden en vervolgens Hallo primaire kan uitvallen voordat hello update doorgegeven toohello secundaire is.</span><span class="sxs-lookup"><span data-stu-id="0bf00-133">For example, your customer could submit an update that is successful, and then hello primary could go down before hello update is propagated toohello secondary.</span></span> <span data-ttu-id="0bf00-134">In dit geval als Hallo klant wordt vervolgens gevraagd tooread Hallo gegevens terug, ontvangt hij Hallo verouderde gegevens in plaats van de gegevens van Hallo bijgewerkt.</span><span class="sxs-lookup"><span data-stu-id="0bf00-134">In this case, if hello customer then asks tooread hello data back, he receives hello stale data instead of hello updated data.</span></span> <span data-ttu-id="0bf00-135">U moet beslissen als dit is acceptabel en zo ja, hoe u Hallo klant wordt weergegeven.</span><span class="sxs-lookup"><span data-stu-id="0bf00-135">You must decide if this is acceptable, and if so, how you will message hello customer.</span></span> <span data-ttu-id="0bf00-136">U ziet hoe toocheck Hallo tijd van laatste synchronisatie op de secundaire gegevensbron Hallo verderop in dit artikel toosee als secundaire Hallo is bijgewerkt.</span><span class="sxs-lookup"><span data-stu-id="0bf00-136">You'll see how toocheck hello Last Sync Time on hello secondary data later in this article toosee if hello secondary is up-to-date.</span></span>

### <a name="handling-services-separately-or-all-together"></a><span data-ttu-id="0bf00-137">Afhandeling van de services afzonderlijk of Alles samenvoegen</span><span class="sxs-lookup"><span data-stu-id="0bf00-137">Handling services separately or all together</span></span>

<span data-ttu-id="0bf00-138">Tijdens het niet waarschijnlijk is het mogelijk voor één service toobecome niet beschikbaar terwijl hello andere services nog steeds volledig functioneel zijn.</span><span class="sxs-lookup"><span data-stu-id="0bf00-138">While not likely, it is possible for one service toobecome unavailable while hello other services are still fully functional.</span></span> <span data-ttu-id="0bf00-139">U kunnen ingang Hallo pogingen en alleen-lezenmodus voor elke service afzonderlijk (blobs, wachtrijen, tabellen), of kunt u nieuwe pogingen algemeen voor alle Hallo storage-services tegelijk verwerken.</span><span class="sxs-lookup"><span data-stu-id="0bf00-139">You can handle hello retries and read-only mode for each service separately (blobs, queues, tables), or you can handle retries generically for all hello storage services together.</span></span>

<span data-ttu-id="0bf00-140">Bijvoorbeeld, als u wachtrijen en blobs in uw toepassing gebruikt, besluiten u tooput in afzonderlijke toohandle herstelbare codefouten voor elk van deze.</span><span class="sxs-lookup"><span data-stu-id="0bf00-140">For example, if you use queues and blobs in your application, you may decide tooput in separate code toohandle retryable errors for each of these.</span></span> <span data-ttu-id="0bf00-141">Klik als u een nieuwe poging van Hallo blob-service krijgt, maar Hallo queue-service is nog steeds werken, worden slechts een deel van uw toepassing die verantwoordelijk is voor blobs Hallo beïnvloed.</span><span class="sxs-lookup"><span data-stu-id="0bf00-141">Then if you get a retry from hello blob service, but hello queue service is still working, only hello part of your application that handles blobs will be impacted.</span></span> <span data-ttu-id="0bf00-142">Als u besluit toohandle alle opslagservice algemeen pogingen en een aanroep toohello blob-service retourneert een herstelbare fout vervolgens aanvragen tooboth Hallo blob-service en Hallo queue-service worden beïnvloed.</span><span class="sxs-lookup"><span data-stu-id="0bf00-142">If you decide toohandle all storage service retries generically and a call toohello blob service returns a retryable error, then requests tooboth hello blob service and hello queue service will be impacted.</span></span>

<span data-ttu-id="0bf00-143">Uiteindelijk hangt dit Hallo complexiteit van uw toepassing.</span><span class="sxs-lookup"><span data-stu-id="0bf00-143">Ultimately, this depends on hello complexity of your application.</span></span> <span data-ttu-id="0bf00-144">Desgewenst kunt u geen toohandle Hallo fouten door service, maar in plaats daarvan tooredirect schijfleesaanvragen voor alle storage services toohello secundaire regio en Hallo-toepassing uitvoeren in de modus alleen-lezen wanneer u een probleem met een storage-service in de primaire regio Hallo detecteren.</span><span class="sxs-lookup"><span data-stu-id="0bf00-144">You may decide not toohandle hello failures by service, but instead tooredirect read requests for all storage services toohello secondary region and run hello application in read-only mode when you detect a problem with any storage service in hello primary region.</span></span>

### <a name="other-considerations"></a><span data-ttu-id="0bf00-145">Andere overwegingen</span><span class="sxs-lookup"><span data-stu-id="0bf00-145">Other considerations</span></span>

<span data-ttu-id="0bf00-146">Dit zijn andere overwegingen worden besproken in de rest van dit artikel Hallo Hallo.</span><span class="sxs-lookup"><span data-stu-id="0bf00-146">These are hello other considerations we will discuss in hello rest of this article.</span></span>

*   <span data-ttu-id="0bf00-147">Verwerking van nieuwe pogingen van leesaanvragen Hallo Circuitonderbreker patroon</span><span class="sxs-lookup"><span data-stu-id="0bf00-147">Handling retries of read requests using hello Circuit Breaker pattern</span></span>

*   <span data-ttu-id="0bf00-148">Uiteindelijk consistent gegevens en Hallo tijd van laatste synchronisatie</span><span class="sxs-lookup"><span data-stu-id="0bf00-148">Eventually-consistent data and hello Last Sync Time</span></span>

*   <span data-ttu-id="0bf00-149">Testen</span><span class="sxs-lookup"><span data-stu-id="0bf00-149">Testing</span></span>

## <a name="running-your-application-in-read-only-mode"></a><span data-ttu-id="0bf00-150">Uitvoeren van uw toepassing in de modus alleen-lezen</span><span class="sxs-lookup"><span data-stu-id="0bf00-150">Running your application in read-only mode</span></span>

<span data-ttu-id="0bf00-151">toouse RA-GRS-opslag, moet de leesaanvragen kunnen toohandle beide is mislukt en mislukte updateaanvragen (met de update in dit geval betekenis invoeg-, updates en verwijderingen).</span><span class="sxs-lookup"><span data-stu-id="0bf00-151">toouse RA-GRS storage, you must be able toohandle both failed read requests and failed update requests (with update in this case meaning inserts, updates, and deletions).</span></span> <span data-ttu-id="0bf00-152">Als hello primaire data center mislukt, lezen aanvragen kunnen worden omgeleid toohello secundaire Datacenter, maar verzoeken om te werken niet omdat Hallo secundaire alleen-lezen is.</span><span class="sxs-lookup"><span data-stu-id="0bf00-152">If hello primary data center fails, read requests can be redirected toohello secondary data center, but update requests cannot because hello secondary is read only.</span></span> <span data-ttu-id="0bf00-153">Daarom moet u enkele toorun manier uw toepassing in de modus alleen-lezen.</span><span class="sxs-lookup"><span data-stu-id="0bf00-153">For this reason, you need some way toorun your application in read-only mode.</span></span>

<span data-ttu-id="0bf00-154">U kunt bijvoorbeeld een vlag die wordt gecontroleerd vóór het verzenden van een update aanvragen toohello storage-service instellen.</span><span class="sxs-lookup"><span data-stu-id="0bf00-154">For example, you can set a flag that will be checked before submitting any update requests toohello storage service.</span></span> <span data-ttu-id="0bf00-155">Wanneer een van de aanvragen van Hallo bijwerken via komt, kunt u dit overslaan en retourneren een juiste reactie toohello klant.</span><span class="sxs-lookup"><span data-stu-id="0bf00-155">When one of hello update requests comes through, you can skip it and return an appropriate response toohello customer.</span></span> <span data-ttu-id="0bf00-156">U kunt zelfs toodisable wilt bepaalde functies helemaal tot Hallo probleem opgelost is en laat gebruikers weten dat deze functies tijdelijk niet beschikbaar zijn.</span><span class="sxs-lookup"><span data-stu-id="0bf00-156">You may even want toodisable certain features altogether until hello problem is resolved and notify users that those features are temporarily unavailable.</span></span>

<span data-ttu-id="0bf00-157">Als u fouten toohandle voor elke service afzonderlijk, moet u ook toohandle Hallo mogelijkheid toorun uw toepassing in de modus alleen-lezen door de service.</span><span class="sxs-lookup"><span data-stu-id="0bf00-157">If you decide toohandle errors for each service separately, you will also need toohandle hello ability toorun your application in read-only mode by service.</span></span> <span data-ttu-id="0bf00-158">Er kan alleen-lezen vlaggen voor elke service die kunnen worden ingeschakeld en uitgeschakeld en ingang Hallo geschikte vlag op de juiste plaatsen Hallo in uw code.</span><span class="sxs-lookup"><span data-stu-id="0bf00-158">You could have read-only flags for each service that can be enabled and disabled and handle hello appropriate flag in hello appropriate places in your code.</span></span>

<span data-ttu-id="0bf00-159">Kan toorun wordt uw toepassing in de modus alleen-lezen heeft een ander voordeel van de zijde: dit biedt u Hallo mogelijkheid tooensure beperkte functionaliteit tijdens een upgrade van de primaire toepassing.</span><span class="sxs-lookup"><span data-stu-id="0bf00-159">Being able toorun your application in read-only mode has another side benefit – it gives you hello ability tooensure limited functionality during a major application upgrade.</span></span> <span data-ttu-id="0bf00-160">U kunt uw toepassing toorun in alleen-lezen-modus en punt toohello secundaire Datacenter, activeren zodat niemand toegang heeft tot gegevens in de primaire regio Hallo Hallo terwijl u upgrades wilt aanbrengen.</span><span class="sxs-lookup"><span data-stu-id="0bf00-160">You can trigger your application toorun in read-only mode and point toohello secondary data center, ensuring nobody is accessing hello data in hello primary region while you're making upgrades.</span></span>

## <a name="handling-updates-when-running-in-read-only-mode"></a><span data-ttu-id="0bf00-161">Verwerken van wijzigingen in de modus alleen-lezen</span><span class="sxs-lookup"><span data-stu-id="0bf00-161">Handling updates when running in read-only mode</span></span>

<span data-ttu-id="0bf00-162">Er zijn veel manieren toohandle update aanvragen in de modus alleen-lezen.</span><span class="sxs-lookup"><span data-stu-id="0bf00-162">There are many ways toohandle update requests when running in read-only mode.</span></span> <span data-ttu-id="0bf00-163">We dit uitvoerig won't verrekend, maar er zijn in het algemeen een aantal patronen waarmee u rekening houden.</span><span class="sxs-lookup"><span data-stu-id="0bf00-163">We won't cover this comprehensively, but generally, there are a couple of patterns that you consider.</span></span>

1.  <span data-ttu-id="0bf00-164">U kunt reageren tooyour gebruiker en laat dat u bent momenteel accepteert geen updates.</span><span class="sxs-lookup"><span data-stu-id="0bf00-164">You can respond tooyour user and tell them you are not currently accepting updates.</span></span> <span data-ttu-id="0bf00-165">Een contactpersoon beheersysteem klanten tooaccess contactgegevens inschakelen maar updates niet maken.</span><span class="sxs-lookup"><span data-stu-id="0bf00-165">For example, a contact management system could enable customers tooaccess contact information but not make updates.</span></span>

2.  <span data-ttu-id="0bf00-166">U kunt de updates in een andere regio in de wachtrij plaatsen.</span><span class="sxs-lookup"><span data-stu-id="0bf00-166">You can enqueue your updates in another region.</span></span> <span data-ttu-id="0bf00-167">In dit geval zou u de update in behandeling zijnde aanvragen tooa wachtrij schrijven in een andere regio en vervolgens hebben een tooprocess manier deze aanvragen nadat de primaire Datacenter Hallo online wordt gezet opnieuw.</span><span class="sxs-lookup"><span data-stu-id="0bf00-167">In this case, you would write your pending update requests tooa queue in a different region, and then have a way tooprocess those requests after hello primary data center comes online again.</span></span> <span data-ttu-id="0bf00-168">In dit scenario laat Hallo klant weten later worden verwerkt in de wachtrij staat Hallo update aangevraagd.</span><span class="sxs-lookup"><span data-stu-id="0bf00-168">In this scenario, you should let hello customer know that hello update requested is queued for later processing.</span></span>

3.  <span data-ttu-id="0bf00-169">U kunt updates van uw opslagaccount tooa schrijven in een andere regio.</span><span class="sxs-lookup"><span data-stu-id="0bf00-169">You can write your updates tooa storage account in another region.</span></span> <span data-ttu-id="0bf00-170">Wanneer de primaire Datacenter Hallo weer online komt, kunt hebt u een manier toomerge die updates in de primaire gegevens hello, afhankelijk van het Hallo-structuur van Hallo-gegevens.</span><span class="sxs-lookup"><span data-stu-id="0bf00-170">Then when hello primary data center comes back online, you can have a way toomerge those updates into hello primary data, depending on hello structure of hello data.</span></span> <span data-ttu-id="0bf00-171">Bijvoorbeeld, als u afzonderlijke bestanden met een datum/tijd-stempel in de naam van de Hallo maakt, kunt u deze bestanden back toohello primaire regio.</span><span class="sxs-lookup"><span data-stu-id="0bf00-171">For example, if you are creating separate files with a date/time stamp in hello name, you can copy those files back toohello primary region.</span></span> <span data-ttu-id="0bf00-172">Dit werkt voor sommige werkbelastingen zoals logboekregistratie en iOT-gegevens.</span><span class="sxs-lookup"><span data-stu-id="0bf00-172">This works for some workloads such as logging and iOT data.</span></span>

## <a name="handling-retries"></a><span data-ttu-id="0bf00-173">Verwerking van nieuwe pogingen</span><span class="sxs-lookup"><span data-stu-id="0bf00-173">Handling retries</span></span>

<span data-ttu-id="0bf00-174">Hoe wilt u weten welke fouten herstelbare?</span><span class="sxs-lookup"><span data-stu-id="0bf00-174">How do you know which errors are retryable?</span></span> <span data-ttu-id="0bf00-175">Dit wordt bepaald door de storage-clientbibliotheek Hallo.</span><span class="sxs-lookup"><span data-stu-id="0bf00-175">This is determined by hello storage client library.</span></span> <span data-ttu-id="0bf00-176">Een 404-fout (resource niet gevonden) is bijvoorbeeld niet-herstelbare omdat deze opnieuw proberen niet waarschijnlijk tooresult in geslaagd is.</span><span class="sxs-lookup"><span data-stu-id="0bf00-176">For example, a 404 error (resource not found) is not retryable because retrying it is not likely tooresult in success.</span></span> <span data-ttu-id="0bf00-177">Op Hallo daarentegen een 500 fout is herstelbare omdat het een serverfout is opgetreden, en dit eenvoudig een tijdelijk probleem komen kan.</span><span class="sxs-lookup"><span data-stu-id="0bf00-177">On hello other hand, a 500 error is retryable because it is a server error, and it may simply be a transient issue.</span></span> <span data-ttu-id="0bf00-178">Bekijk voor meer informatie Hallo [openen van de broncode voor Hallo ExponentialRetry klasse](https://github.com/Azure/azure-storage-net/blob/87b84b3d5ee884c7adc10e494e2c7060956515d0/Lib/Common/RetryPolicies/ExponentialRetry.cs) in Hallo .NET storage-clientbibliotheek.</span><span class="sxs-lookup"><span data-stu-id="0bf00-178">For more details, check out hello [open source code for hello ExponentialRetry class](https://github.com/Azure/azure-storage-net/blob/87b84b3d5ee884c7adc10e494e2c7060956515d0/Lib/Common/RetryPolicies/ExponentialRetry.cs) in hello .NET storage client library.</span></span> <span data-ttu-id="0bf00-179">(Zoek naar Hallo ShouldRetry methode).</span><span class="sxs-lookup"><span data-stu-id="0bf00-179">(Look for hello ShouldRetry method.)</span></span>

### <a name="read-requests"></a><span data-ttu-id="0bf00-180">Alleen aanvragen</span><span class="sxs-lookup"><span data-stu-id="0bf00-180">Read requests</span></span>

<span data-ttu-id="0bf00-181">Als er een probleem met de primaire opslag, kunnen alleen aanvragen omgeleide toosecondary opslag worden.</span><span class="sxs-lookup"><span data-stu-id="0bf00-181">Read requests can be redirected toosecondary storage if there is a problem with primary storage.</span></span> <span data-ttu-id="0bf00-182">Als opgemerkt in [uiteindelijk consistente gegevens met behulp van](#using-eventually-consistent-data), deze moet acceptabele voor uw toepassing toopotentially verouderde gegevens lezen.</span><span class="sxs-lookup"><span data-stu-id="0bf00-182">As noted above in [Using Eventually Consistent Data](#using-eventually-consistent-data), it must be acceptable for your application toopotentially read stale data.</span></span> <span data-ttu-id="0bf00-183">Als u Hallo opslag client bibliotheek tooaccess RA-GRS gegevens gebruikt, kunt u Hallo opnieuw gedrag van een leesaanvraag opgeven door een waarde voor Hallo **LocationMode** tooone van Hallo volgende eigenschap:</span><span class="sxs-lookup"><span data-stu-id="0bf00-183">If you are using hello storage client library tooaccess RA-GRS data, you can specify hello retry behavior of a read request by setting a value for hello **LocationMode** property tooone of hello following:</span></span>

*   <span data-ttu-id="0bf00-184">**PrimaryOnly** (Hallo standaard)</span><span class="sxs-lookup"><span data-stu-id="0bf00-184">**PrimaryOnly** (hello default)</span></span>

*   <span data-ttu-id="0bf00-185">**PrimaryThenSecondary**</span><span class="sxs-lookup"><span data-stu-id="0bf00-185">**PrimaryThenSecondary**</span></span>

*   <span data-ttu-id="0bf00-186">**SecondaryOnly**</span><span class="sxs-lookup"><span data-stu-id="0bf00-186">**SecondaryOnly**</span></span>

*   <span data-ttu-id="0bf00-187">**SecondaryThenPrimary**</span><span class="sxs-lookup"><span data-stu-id="0bf00-187">**SecondaryThenPrimary**</span></span>

<span data-ttu-id="0bf00-188">Als u instelt dat Hallo **LocationMode** te**PrimaryThenSecondary**als eerste Hallo lezen aanvraag toohello primaire eindpunt is mislukt met een herstelbare fout, Hallo client maakt automatisch een andere lezen secundair eindpunt toohello aanvragen.</span><span class="sxs-lookup"><span data-stu-id="0bf00-188">When you set hello **LocationMode** too**PrimaryThenSecondary**, if hello initial read request toohello primary endpoint fails with a retryable error, hello client automatically makes another read request toohello secondary endpoint.</span></span> <span data-ttu-id="0bf00-189">Als Hallo-fout een time-out van de server is, klikt u vervolgens hebben Hallo client toowait voor Hallo time-out tooexpire voordat het een herstelbare fout van Hallo-service ontvangt.</span><span class="sxs-lookup"><span data-stu-id="0bf00-189">If hello error is a server timeout, then hello client will have toowait for hello timeout tooexpire before it receives a retryable error from hello service.</span></span>

<span data-ttu-id="0bf00-190">Er zijn in feite twee scenario's tooconsider wanneer u bepaalt hoe toorespond tooa herstelbare fout:</span><span class="sxs-lookup"><span data-stu-id="0bf00-190">There are basically two scenarios tooconsider when you are deciding how toorespond tooa retryable error:</span></span>

*   <span data-ttu-id="0bf00-191">Dit is een probleem met geïsoleerde en volgende aanvragen toohello primaire eindpunt niet een herstelbare fout retourneert.</span><span class="sxs-lookup"><span data-stu-id="0bf00-191">This is an isolated problem and subsequent requests toohello primary endpoint will not return a retryable error.</span></span> <span data-ttu-id="0bf00-192">Een voorbeeld van wanneer dit gebeurt mogelijk is wanneer er een tijdelijke fout.</span><span class="sxs-lookup"><span data-stu-id="0bf00-192">An example of where this might happen is when there is a transient network error.</span></span>

    <span data-ttu-id="0bf00-193">In dit scenario wordt er is geen aanzienlijke prestaties voor het hebben van **LocationMode** instellen te**PrimaryThenSecondary** als dit alleen zelden gebeurt.</span><span class="sxs-lookup"><span data-stu-id="0bf00-193">In this scenario, there is no significant performance penalty in having **LocationMode** set too**PrimaryThenSecondary** as this only happens infrequently.</span></span>

*   <span data-ttu-id="0bf00-194">Dit is een probleem met ten minste één van de opslagservices Hallo in de primaire regio Hallo en alle volgende aanvragen toothat-service in de primaire regio Hallo zijn waarschijnlijk tooreturn herstelbare fouten voor een bepaalde periode.</span><span class="sxs-lookup"><span data-stu-id="0bf00-194">This is a problem with at least one of hello storage services in hello primary region and all subsequent requests toothat service in hello primary region are likely tooreturn retryable errors for a period of time.</span></span> <span data-ttu-id="0bf00-195">Een voorbeeld hiervan is als de primaire regio Hallo volledig niet toegankelijk.</span><span class="sxs-lookup"><span data-stu-id="0bf00-195">An example of this is if hello primary region is completely inaccessible.</span></span>

    <span data-ttu-id="0bf00-196">In dit scenario is het een op de prestaties omdat uw leesaanvragen wordt Probeer eerst de primaire eindpunt hello, op Hallo time-out tooexpire wachten en schakel toohello secundair eindpunt.</span><span class="sxs-lookup"><span data-stu-id="0bf00-196">In this scenario, there is a performance penalty because all your read requests will try hello primary endpoint first, wait for hello timeout tooexpire, then switch toohello secondary endpoint.</span></span>

<span data-ttu-id="0bf00-197">Voor deze scenario's, moet u bepalen dat er een lopende probleem met de primaire eindpunt Hallo en verzendt alle schijfleesaanvragen direct toohello secundair eindpunt door in te stellen Hallo **LocationMode** eigenschap te **SecondaryOnly**.</span><span class="sxs-lookup"><span data-stu-id="0bf00-197">For these scenarios, you should identify that there is an ongoing issue with hello primary endpoint and send all read requests directly toohello secondary endpoint by setting hello **LocationMode** property too**SecondaryOnly**.</span></span> <span data-ttu-id="0bf00-198">Op dit moment moet u ook Hallo toepassing toorun in de modus alleen-lezen te wijzigen.</span><span class="sxs-lookup"><span data-stu-id="0bf00-198">At this time, you should also change hello application toorun in read-only mode.</span></span> <span data-ttu-id="0bf00-199">Deze aanpak wordt ook wel Hallo [Circuitonderbreker patroon](https://msdn.microsoft.com/library/dn589784.aspx).</span><span class="sxs-lookup"><span data-stu-id="0bf00-199">This approach is known as hello [Circuit Breaker Pattern](https://msdn.microsoft.com/library/dn589784.aspx).</span></span>

### <a name="update-requests"></a><span data-ttu-id="0bf00-200">Verzoeken om te werken</span><span class="sxs-lookup"><span data-stu-id="0bf00-200">Update requests</span></span>

<span data-ttu-id="0bf00-201">Hallo Circuitonderbreker patroon kan ook worden toegepast tooupdate aanvragen.</span><span class="sxs-lookup"><span data-stu-id="0bf00-201">hello Circuit Breaker pattern can also be applied tooupdate requests.</span></span> <span data-ttu-id="0bf00-202">Updateaanvragen kunnen echter niet dat omgeleide toosecondary-opslag alleen-lezen is.</span><span class="sxs-lookup"><span data-stu-id="0bf00-202">However, update requests cannot be redirected toosecondary storage, which is read-only.</span></span> <span data-ttu-id="0bf00-203">Voor deze aanvragen, laat u Hallo **LocationMode** eigenschappenset te**PrimaryOnly** (Hallo standaard).</span><span class="sxs-lookup"><span data-stu-id="0bf00-203">For these requests, you should leave hello **LocationMode** property set too**PrimaryOnly** (hello default).</span></span> <span data-ttu-id="0bf00-204">toohandle deze fouten kunt u een aanvragen metrische toothese – zoals 10 fouten in een rij – toepassen en als de drempelwaarde wordt voldaan, schakelt u Hallo-toepassing in de modus alleen-lezen.</span><span class="sxs-lookup"><span data-stu-id="0bf00-204">toohandle these errors, you can apply a metric toothese requests – such as 10 failures in a row – and when your threshold is met, switch hello application into read-only mode.</span></span> <span data-ttu-id="0bf00-205">U kunt dezelfde methoden voor het retourneren van tooupdate-modus als die hieronder wordt beschreven in de volgende sectie Hallo over Hallo Circuitonderbreker patroon Hallo.</span><span class="sxs-lookup"><span data-stu-id="0bf00-205">You can use hello same methods for returning tooupdate mode as those described below in hello next section about hello Circuit Breaker pattern.</span></span>

## <a name="circuit-breaker-pattern"></a><span data-ttu-id="0bf00-206">Patroon voor Circuitonderbreker</span><span class="sxs-lookup"><span data-stu-id="0bf00-206">Circuit Breaker pattern</span></span>

<span data-ttu-id="0bf00-207">Hallo Circuitonderbreker patroon gebruiken in uw toepassing kunt voorkomen dat deze opnieuw wordt geprobeerd een bewerking die waarschijnlijk toofail herhaaldelijk is.</span><span class="sxs-lookup"><span data-stu-id="0bf00-207">Using hello Circuit Breaker pattern in your application can prevent it from retrying an operation that is likely toofail repeatedly.</span></span> <span data-ttu-id="0bf00-208">Kunt u Hallo toepassing toocontinue toorun in plaats van tijd in beslag bij bewerking Hallo exponentieel wordt herhaald.</span><span class="sxs-lookup"><span data-stu-id="0bf00-208">It allows hello application toocontinue toorun rather than taking up time while hello operation is retried exponentially.</span></span> <span data-ttu-id="0bf00-209">Daarnaast wordt gedetecteerd wanneer Hallo-fout is opgelost, waarmee de toepassing hello Hallo opnieuw kunt proberen.</span><span class="sxs-lookup"><span data-stu-id="0bf00-209">It also detects when hello fault has been fixed, at which time hello application can try hello operation again.</span></span>

### <a name="how-tooimplement-hello-circuit-breaker-pattern"></a><span data-ttu-id="0bf00-210">Hoe tooimplement Circuitonderbreker patroon Hallo</span><span class="sxs-lookup"><span data-stu-id="0bf00-210">How tooimplement hello circuit breaker pattern</span></span>

<span data-ttu-id="0bf00-211">tooidentify dat er een actieve probleem met een primaire eindpunt is, kunt u controleren hoe vaak Hallo client er een herstelbare fout optreedt.</span><span class="sxs-lookup"><span data-stu-id="0bf00-211">tooidentify that there is an ongoing problem with a primary endpoint, you can monitor how frequently hello client encounters retryable errors.</span></span> <span data-ttu-id="0bf00-212">Omdat elk geval niet hetzelfde is, hebt u toodecide Hallo drempel toouse voor Hallo besluit tooswitch toohello secundair eindpunt en Hallo toepassing uitvoeren in de modus alleen-lezen.</span><span class="sxs-lookup"><span data-stu-id="0bf00-212">Because each case is different, you have toodecide on hello threshold you want toouse for hello decision tooswitch toohello secondary endpoint and run hello application in read-only mode.</span></span> <span data-ttu-id="0bf00-213">U kan bijvoorbeeld tooperform Hallo switch besluit als er 10 fouten in een rij met geen uitkomsten.</span><span class="sxs-lookup"><span data-stu-id="0bf00-213">For example, you could decide tooperform hello switch if there are 10 failures in a row with no successes.</span></span> <span data-ttu-id="0bf00-214">Een ander voorbeeld is tooswitch als 90% van het Hallo-aanvragen in een periode van 2 minuten mislukken.</span><span class="sxs-lookup"><span data-stu-id="0bf00-214">Another example is tooswitch if 90% of hello requests in a 2-minute period fail.</span></span>

<span data-ttu-id="0bf00-215">Voor het eerste scenario hello, kunt u gewoon een telling van fouten van Hallo houden en als er een geslaagde alvorens maximale, stel Hallo aantal back-toozero Hallo.</span><span class="sxs-lookup"><span data-stu-id="0bf00-215">For hello first scenario, you can simply keep a count of hello failures, and if there is a success before reaching hello maximum, set hello count back toozero.</span></span> <span data-ttu-id="0bf00-216">Voor het tweede scenario Hallo Hallo eenrichtingssessie tooimplement is toouse MemoryCache-object (in .NET).</span><span class="sxs-lookup"><span data-stu-id="0bf00-216">For hello second scenario, one way tooimplement it is toouse hello MemoryCache object (in .NET).</span></span> <span data-ttu-id="0bf00-217">Voor elke aanvraag een CacheItem toohello cache toevoegen, Hallo waarde toosuccess (1) ingesteld of mislukt (0) en Hallo verlopen tijd too2 minuten ingesteld van nu (of wat uw tijdsbeperking is).</span><span class="sxs-lookup"><span data-stu-id="0bf00-217">For each request, add a CacheItem toohello cache, set hello value toosuccess (1) or fail (0), and set hello expiration time too2 minutes from now (or whatever your time constraint is).</span></span> <span data-ttu-id="0bf00-218">Wanneer een vermelding verlooptijd is bereikt, wordt Hallo-vermelding automatisch verwijderd.</span><span class="sxs-lookup"><span data-stu-id="0bf00-218">When an entry's expiration time is reached, hello entry is automatically removed.</span></span> <span data-ttu-id="0bf00-219">Hierdoor krijgt u een venster met rolling 2 minuten.</span><span class="sxs-lookup"><span data-stu-id="0bf00-219">This will give you a rolling 2-minute window.</span></span> <span data-ttu-id="0bf00-220">Telkens wanneer u een aanvraag toohello storage-service u eerst gebruiken een Linq-query in Hallo MemoryCache object toocalculate Hallo percentage geslaagd door het Hallo-waarden op te tellen en te delen door Hallo aantal.</span><span class="sxs-lookup"><span data-stu-id="0bf00-220">Each time you make a request toohello storage service, you first use a Linq query across hello MemoryCache object toocalculate hello percent success by summing hello values and dividing by hello count.</span></span> <span data-ttu-id="0bf00-221">Als percentage geslaagd Hallo zakt onder sommige drempelwaarde (zoals 10%), stelt u Hallo **LocationMode** eigenschap voor schijfleesaanvragen te**SecondaryOnly** en schakel over naar de toepassing hello in alleen-lezenmodus voordat u kunt doorgaan.</span><span class="sxs-lookup"><span data-stu-id="0bf00-221">When hello percent success drops below some threshold (such as 10%), set hello **LocationMode** property for read requests too**SecondaryOnly** and switch hello application into read-only mode before continuing.</span></span>

<span data-ttu-id="0bf00-222">Hallo-drempelwaarde voor fouten gebruikt toodetermine wanneer toomake Hallo switch van service tooservice in uw toepassing, afwijken kan zodat u kunt overwegen om deze parameters kunnen worden geconfigureerd.</span><span class="sxs-lookup"><span data-stu-id="0bf00-222">hello threshold of errors used toodetermine when toomake hello switch may vary from service tooservice in your application, so you should consider making them configurable parameters.</span></span> <span data-ttu-id="0bf00-223">Dit is ook u besluiten het toohandle herstelbare fouten van elke service afzonderlijk of als een, zoals eerder besproken.</span><span class="sxs-lookup"><span data-stu-id="0bf00-223">This is also where you decide toohandle retryable errors from each service separately or as one, as discussed previously.</span></span>

<span data-ttu-id="0bf00-224">Een andere overweging is hoe toohandle meerdere exemplaren van een toepassing, en welke toodo wanneer u herstelbare fouten in elke instantie detecteren.</span><span class="sxs-lookup"><span data-stu-id="0bf00-224">Another consideration is how toohandle multiple instances of an application, and what toodo when you detect retryable errors in each instance.</span></span> <span data-ttu-id="0bf00-225">Bijvoorbeeld wellicht 20 VM's die worden uitgevoerd met Hallo dezelfde toepassing geladen.</span><span class="sxs-lookup"><span data-stu-id="0bf00-225">For example, you may have 20 VMs running with hello same application loaded.</span></span> <span data-ttu-id="0bf00-226">Verwerkt u elke instantie afzonderlijk?</span><span class="sxs-lookup"><span data-stu-id="0bf00-226">Do you handle each instance separately?</span></span> <span data-ttu-id="0bf00-227">Als één exemplaar begint problemen, wilt u toch toolimit Hallo antwoord toojust dat één exemplaar of wilt u toch tootry toohave alle exemplaren reageren in Hallo dezelfde manier als één exemplaar een probleem is?</span><span class="sxs-lookup"><span data-stu-id="0bf00-227">If one instance starts having problems, do you want toolimit hello response toojust that one instance, or do you want tootry toohave all instances respond in hello same way when one instance has a problem?</span></span> <span data-ttu-id="0bf00-228">Hallo exemplaren afzonderlijk verwerking is veel eenvoudiger dan het antwoord van toocoordinate Hallo onder te brengen, maar hoe u dit doen is afhankelijk van de architectuur van uw toepassing.</span><span class="sxs-lookup"><span data-stu-id="0bf00-228">Handling hello instances separately is much simpler than trying toocoordinate hello response across them, but how you do this depends on your application's architecture.</span></span>

### <a name="options-for-monitoring-hello-error-frequency"></a><span data-ttu-id="0bf00-229">Opties voor het bewaken van Hallo fout frequentie</span><span class="sxs-lookup"><span data-stu-id="0bf00-229">Options for monitoring hello error frequency</span></span>

<span data-ttu-id="0bf00-230">Hebt u drie belangrijkste mogelijkheden voor het bewaken van Hallo frequentie van nieuwe pogingen in de primaire regio Hallo in volgorde toodetermine wanneer tooswitch via toohello secundaire regio en wijzig Hallo toorun toepassing in de modus alleen-lezen.</span><span class="sxs-lookup"><span data-stu-id="0bf00-230">You have three main options for monitoring hello frequency of retries in hello primary region in order toodetermine when tooswitch over toohello secondary region and change hello application toorun in read-only mode.</span></span>

*   <span data-ttu-id="0bf00-231">Toevoegen van een handler voor Hallo [ **opnieuw proberen** ](http://msdn.microsoft.com/en-us/library/microsoft.windowsazure.storage.operationcontext.retrying.aspx) gebeurtenis op Hallo [ **OperationContext** ](http://msdn.microsoft.com/en-us/library/microsoft.windowsazure.storage.operationcontext.aspx) object u tooyour opslag aanvragen doorgeeft – dit Hallo is methode weergegeven in dit artikel en gebruikt in Hallo begeleidende voorbeeld.</span><span class="sxs-lookup"><span data-stu-id="0bf00-231">Add a handler for hello [**Retrying**](http://msdn.microsoft.com/en-us/library/microsoft.windowsazure.storage.operationcontext.retrying.aspx) event on hello [**OperationContext**](http://msdn.microsoft.com/en-us/library/microsoft.windowsazure.storage.operationcontext.aspx) object you pass tooyour storage requests – this is hello method displayed in this article and used in hello accompanying sample.</span></span> <span data-ttu-id="0bf00-232">Deze gebeurtenissen worden geactiveerd wanneer het Hallo-client een aanvraag opnieuw, zodat u hoe vaak tootrack Hallo client herstelbare fouten op een primaire eindpunt optreedt.</span><span class="sxs-lookup"><span data-stu-id="0bf00-232">These events fire whenever hello client retries a request, enabling you tootrack how often hello client encounters retryable errors on a primary endpoint.</span></span>

    ```csharp 
    operationContext.Retrying += (sender, arguments) =>
    {
        // Retrying in hello primary region
        if (arguments.Request.Host == primaryhostname)
            ...
    };
    ```

*   <span data-ttu-id="0bf00-233">In Hallo [ **Evaluate** ](http://msdn.microsoft.com/en-us/library/microsoft.windowsazure.storage.retrypolicies.iextendedretrypolicy.evaluate.aspx) methode in een beleid voor aangepaste opnieuw proberen, kunt u aangepaste code uitvoeren telkens wanneer een nieuwe poging plaatsvindt.</span><span class="sxs-lookup"><span data-stu-id="0bf00-233">In hello [**Evaluate**](http://msdn.microsoft.com/en-us/library/microsoft.windowsazure.storage.retrypolicies.iextendedretrypolicy.evaluate.aspx) method in a custom retry policy, you can run custom code whenever a retry takes place.</span></span> <span data-ttu-id="0bf00-234">In aanvulling toorecording wanneer een nieuwe poging gebeurt, wordt dit ook hebt u kans toomodify Hallo uw gedrag voor het opnieuw.</span><span class="sxs-lookup"><span data-stu-id="0bf00-234">In addition toorecording when a retry happens, this also gives you hello opportunity toomodify your retry behavior.</span></span>

    ```csharp 
    public RetryInfo Evaluate(RetryContext retryContext,
    OperationContext operationContext)
    {
        var statusCode = retryContext.LastRequestResult.HttpStatusCode;
        if (retryContext.CurrentRetryCount >= this.maximumAttempts
        || ((statusCode &gt;= 300 && statusCode &lt; 500 && statusCode != 408)
        || statusCode == 501 // Not Implemented
        || statusCode == 505 // Version Not Supported
            ))
        {
        // Do not retry
            return null;
        }

        // Monitor retries in hello primary location
        ...

        // Determine RetryInterval and TargetLocation
        RetryInfo info =
            CreateRetryInfo(retryContext.CurrentRetryCount);

        return info;
    }
    ```

*   <span data-ttu-id="0bf00-235">Hallo derde aanpak is een aangepaste bewakingsonderdeel in uw toepassing die voortdurend uw eindpunt primaire opslag met dummy pingt tooimplement toodetermine aanvragen (zoals het lezen van een kleine blob) de status lezen.</span><span class="sxs-lookup"><span data-stu-id="0bf00-235">hello third approach is tooimplement a custom monitoring component in your application that continually pings your primary storage endpoint with dummy read requests (such as reading a small blob) toodetermine its health.</span></span> <span data-ttu-id="0bf00-236">Deze zou resources, maar een aanzienlijke duren.</span><span class="sxs-lookup"><span data-stu-id="0bf00-236">This would take up some resources, but not a significant amount.</span></span> <span data-ttu-id="0bf00-237">Wanneer een probleem is gedetecteerd dat de drempel bereikt, u wilt uitvoeren, Hallo switch te**SecondaryOnly** en alleen-lezen-modus.</span><span class="sxs-lookup"><span data-stu-id="0bf00-237">When a problem is discovered that reaches your threshold, you would then perform hello switch too**SecondaryOnly** and read-only mode.</span></span>

<span data-ttu-id="0bf00-238">Op een bepaald moment zult u tooswitch back toousing Hallo primaire eindpunt en updates toestaan.</span><span class="sxs-lookup"><span data-stu-id="0bf00-238">At some point, you will want tooswitch back toousing hello primary endpoint and allowing updates.</span></span> <span data-ttu-id="0bf00-239">Als een van de eerste twee methoden Hallo die hierboven worden genoemd, kan u gewoon overschakelen back toohello primaire eindpunt en updatemodus inschakelen nadat een willekeurig geselecteerde hoeveelheid tijd of het aantal bewerkingen zijn uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="0bf00-239">If using one of hello first two methods listed above, you could simply switch back toohello primary endpoint and enable update mode after an arbitrarily selected amount of time or number of operations has been performed.</span></span> <span data-ttu-id="0bf00-240">Vervolgens kunt u deze opnieuw Hallo Pogingslogica doorlopen.</span><span class="sxs-lookup"><span data-stu-id="0bf00-240">You can then let it go through hello retry logic again.</span></span> <span data-ttu-id="0bf00-241">Als Hallo probleem is opgelost, wordt de toouse Hallo primaire eindpunt gaan en updates toestaan.</span><span class="sxs-lookup"><span data-stu-id="0bf00-241">If hello problem has been fixed, it will continue toouse hello primary endpoint and allow updates.</span></span> <span data-ttu-id="0bf00-242">Als u nog steeds een probleem is, zal deze zodra er meer back toohello secundaire eindpunt en alleen-lezenmodus overschakelen lukt Hallo criteria die u hebt ingesteld.</span><span class="sxs-lookup"><span data-stu-id="0bf00-242">If there is still a problem, it will once more switch back toohello secondary endpoint and read-only mode after failing hello criteria you've set.</span></span>

<span data-ttu-id="0bf00-243">Hallo derde scenario wanneer pingen Hallo primaire opslag eindpunt weer mislukt, kunt u activeren Hallo switch terug te**PrimaryOnly** en doorgaan updates toestaan.</span><span class="sxs-lookup"><span data-stu-id="0bf00-243">For hello third scenario, when pinging hello primary storage endpoint becomes successful again, you can trigger hello switch back too**PrimaryOnly** and continue allowing updates.</span></span>

## <a name="handling-eventually-consistent-data"></a><span data-ttu-id="0bf00-244">Uiteindelijk consistente gegevens verwerken</span><span class="sxs-lookup"><span data-stu-id="0bf00-244">Handling eventually consistent data</span></span>

<span data-ttu-id="0bf00-245">RA-GRS werkt door transacties van Hallo primaire toohello secundaire regio te repliceren.</span><span class="sxs-lookup"><span data-stu-id="0bf00-245">RA-GRS works by replicating transactions from hello primary toohello secondary region.</span></span> <span data-ttu-id="0bf00-246">Dit replicatieproces zorgt ervoor dat gegevens in de secundaire regio Hallo Hallo is *uiteindelijk consistent*.</span><span class="sxs-lookup"><span data-stu-id="0bf00-246">This replication process guarantees that hello data in hello secondary region is *eventually consistent*.</span></span> <span data-ttu-id="0bf00-247">Dit betekent dat alle Hallo transacties in de primaire regio Hallo uiteindelijk wordt weergegeven in de secundaire regio hello, maar dat er mogelijk een vertraging voordat ze worden weergegeven en of er is geen garantie Hallo transacties binnenkomen in de secundaire regio Hallo in dezelfde als volgorde Hallo die waarin ze oorspronkelijk zijn toegepast in de primaire regio Hallo.</span><span class="sxs-lookup"><span data-stu-id="0bf00-247">This means that all hello transactions in hello primary region will eventually appear in hello secondary region, but that there may be a lag before they appear, and that there is no guarantee hello transactions arrive in hello secondary region in hello same order as that in which they were originally applied in hello primary region.</span></span> <span data-ttu-id="0bf00-248">Als uw transacties in de secundaire regio Hallo volgorde plaatsvinden, u *mogelijk* Houd rekening met uw gegevens in Hallo secundaire regio toobe in een inconsistente status totdat het Hallo-service de resultaten.</span><span class="sxs-lookup"><span data-stu-id="0bf00-248">If your transactions arrive in hello secondary region out of order, you *may* consider your data in hello secondary region toobe in an inconsistent state until hello service catches up.</span></span>

<span data-ttu-id="0bf00-249">Hallo volgende tabel toont een voorbeeld van wat er gebeuren kan wanneer u de details van een werknemer toomake Hallo bijwerken haar lid zijn van Hallo *beheerders* rol.</span><span class="sxs-lookup"><span data-stu-id="0bf00-249">hello following table shows an example of what might happen when you update hello details of an employee toomake her a member of hello *administrators* role.</span></span> <span data-ttu-id="0bf00-250">Voor Hallo mogelijk te houden in dit voorbeeld, hiervoor moet u bijwerken Hallo **werknemer** entiteit en update een **beheerdersrol** entiteit met een telling van totaal aantal beheerders Hallo.</span><span class="sxs-lookup"><span data-stu-id="0bf00-250">For hello sake of this example, this requires you update hello **employee** entity and update an **administrator role** entity with a count of hello total number of administrators.</span></span> <span data-ttu-id="0bf00-251">U ziet hoe Hallo updates volgorde in Hallo secundaire regio worden toegepast.</span><span class="sxs-lookup"><span data-stu-id="0bf00-251">Notice how hello updates are applied out of order in hello secondary region.</span></span>

| <span data-ttu-id="0bf00-252">**Tijd**</span><span class="sxs-lookup"><span data-stu-id="0bf00-252">**Time**</span></span> | <span data-ttu-id="0bf00-253">**Transactie**</span><span class="sxs-lookup"><span data-stu-id="0bf00-253">**Transaction**</span></span>                                            | <span data-ttu-id="0bf00-254">**Replicatie**</span><span class="sxs-lookup"><span data-stu-id="0bf00-254">**Replication**</span></span>                       | <span data-ttu-id="0bf00-255">**Tijd van laatste synchronisatie**</span><span class="sxs-lookup"><span data-stu-id="0bf00-255">**Last Sync Time**</span></span> | <span data-ttu-id="0bf00-256">**Resultaat**</span><span class="sxs-lookup"><span data-stu-id="0bf00-256">**Result**</span></span> |
|----------|------------------------------------------------------------|---------------------------------------|--------------------|------------| 
| <span data-ttu-id="0bf00-257">T0</span><span class="sxs-lookup"><span data-stu-id="0bf00-257">T0</span></span>       | <span data-ttu-id="0bf00-258">Transactie A:</span><span class="sxs-lookup"><span data-stu-id="0bf00-258">Transaction A:</span></span> <br> <span data-ttu-id="0bf00-259">Werknemer invoegen</span><span class="sxs-lookup"><span data-stu-id="0bf00-259">Insert employee</span></span> <br> <span data-ttu-id="0bf00-260">entiteit in primaire</span><span class="sxs-lookup"><span data-stu-id="0bf00-260">entity in primary</span></span> |                                   |                    | <span data-ttu-id="0bf00-261">Een transactie ingevoegd tooprimary,</span><span class="sxs-lookup"><span data-stu-id="0bf00-261">Transaction A inserted tooprimary,</span></span><br> <span data-ttu-id="0bf00-262">nog niet gerepliceerd.</span><span class="sxs-lookup"><span data-stu-id="0bf00-262">not replicated yet.</span></span> |
| <span data-ttu-id="0bf00-263">T1</span><span class="sxs-lookup"><span data-stu-id="0bf00-263">T1</span></span>       |                                                            | <span data-ttu-id="0bf00-264">Een transactie</span><span class="sxs-lookup"><span data-stu-id="0bf00-264">Transaction A</span></span> <br> <span data-ttu-id="0bf00-265">gerepliceerd naar</span><span class="sxs-lookup"><span data-stu-id="0bf00-265">replicated to</span></span><br> <span data-ttu-id="0bf00-266">secundaire</span><span class="sxs-lookup"><span data-stu-id="0bf00-266">secondary</span></span> | <span data-ttu-id="0bf00-267">T1</span><span class="sxs-lookup"><span data-stu-id="0bf00-267">T1</span></span> | <span data-ttu-id="0bf00-268">Een transactie toosecondary gerepliceerd.</span><span class="sxs-lookup"><span data-stu-id="0bf00-268">Transaction A replicated toosecondary.</span></span> <br><span data-ttu-id="0bf00-269">Tijd van laatste synchronisatie is bijgewerkt.</span><span class="sxs-lookup"><span data-stu-id="0bf00-269">Last Sync Time updated.</span></span>    |
| <span data-ttu-id="0bf00-270">T2</span><span class="sxs-lookup"><span data-stu-id="0bf00-270">T2</span></span>       | <span data-ttu-id="0bf00-271">Transactie B:</span><span class="sxs-lookup"><span data-stu-id="0bf00-271">Transaction B:</span></span><br><span data-ttu-id="0bf00-272">Update</span><span class="sxs-lookup"><span data-stu-id="0bf00-272">Update</span></span><br> <span data-ttu-id="0bf00-273">werknemer-entiteit</span><span class="sxs-lookup"><span data-stu-id="0bf00-273">employee entity</span></span><br> <span data-ttu-id="0bf00-274">in primaire</span><span class="sxs-lookup"><span data-stu-id="0bf00-274">in primary</span></span>  |                                | <span data-ttu-id="0bf00-275">T1</span><span class="sxs-lookup"><span data-stu-id="0bf00-275">T1</span></span>                 | <span data-ttu-id="0bf00-276">Transactie B tooprimary, geschreven</span><span class="sxs-lookup"><span data-stu-id="0bf00-276">Transaction B written tooprimary,</span></span><br> <span data-ttu-id="0bf00-277">nog niet gerepliceerd.</span><span class="sxs-lookup"><span data-stu-id="0bf00-277">not replicated yet.</span></span>  |
| <span data-ttu-id="0bf00-278">T3</span><span class="sxs-lookup"><span data-stu-id="0bf00-278">T3</span></span>       | <span data-ttu-id="0bf00-279">Transactie C:</span><span class="sxs-lookup"><span data-stu-id="0bf00-279">Transaction C:</span></span><br> <span data-ttu-id="0bf00-280">Update</span><span class="sxs-lookup"><span data-stu-id="0bf00-280">Update</span></span> <br><span data-ttu-id="0bf00-281">Beheerder</span><span class="sxs-lookup"><span data-stu-id="0bf00-281">administrator</span></span><br><span data-ttu-id="0bf00-282">de entiteit rol in</span><span class="sxs-lookup"><span data-stu-id="0bf00-282">role entity in</span></span><br><span data-ttu-id="0bf00-283">primaire</span><span class="sxs-lookup"><span data-stu-id="0bf00-283">primary</span></span> |                    | <span data-ttu-id="0bf00-284">T1</span><span class="sxs-lookup"><span data-stu-id="0bf00-284">T1</span></span>                 | <span data-ttu-id="0bf00-285">Transactie C tooprimary, geschreven</span><span class="sxs-lookup"><span data-stu-id="0bf00-285">Transaction C written tooprimary,</span></span><br> <span data-ttu-id="0bf00-286">nog niet gerepliceerd.</span><span class="sxs-lookup"><span data-stu-id="0bf00-286">not replicated yet.</span></span>  |
| <span data-ttu-id="0bf00-287">*T4*</span><span class="sxs-lookup"><span data-stu-id="0bf00-287">*T4*</span></span>     |                                                       | <span data-ttu-id="0bf00-288">Transactie C</span><span class="sxs-lookup"><span data-stu-id="0bf00-288">Transaction C</span></span> <br><span data-ttu-id="0bf00-289">gerepliceerd naar</span><span class="sxs-lookup"><span data-stu-id="0bf00-289">replicated to</span></span><br> <span data-ttu-id="0bf00-290">secundaire</span><span class="sxs-lookup"><span data-stu-id="0bf00-290">secondary</span></span> | <span data-ttu-id="0bf00-291">T1</span><span class="sxs-lookup"><span data-stu-id="0bf00-291">T1</span></span>         | <span data-ttu-id="0bf00-292">Transactie C toosecondary gerepliceerd.</span><span class="sxs-lookup"><span data-stu-id="0bf00-292">Transaction C replicated toosecondary.</span></span><br><span data-ttu-id="0bf00-293">LastSyncTime niet bijgewerkt, omdat</span><span class="sxs-lookup"><span data-stu-id="0bf00-293">LastSyncTime not updated because</span></span> <br><span data-ttu-id="0bf00-294">transactie B is nog niet gerepliceerd.</span><span class="sxs-lookup"><span data-stu-id="0bf00-294">transaction B has not been replicated yet.</span></span>|
| <span data-ttu-id="0bf00-295">*T 5*</span><span class="sxs-lookup"><span data-stu-id="0bf00-295">*T5*</span></span>     | <span data-ttu-id="0bf00-296">Entiteiten lezen</span><span class="sxs-lookup"><span data-stu-id="0bf00-296">Read entities</span></span> <br><span data-ttu-id="0bf00-297">secundaire</span><span class="sxs-lookup"><span data-stu-id="0bf00-297">from secondary</span></span>                           |                                  | <span data-ttu-id="0bf00-298">T1</span><span class="sxs-lookup"><span data-stu-id="0bf00-298">T1</span></span>                 | <span data-ttu-id="0bf00-299">U opvragen Hallo verouderde waarde voor werknemer</span><span class="sxs-lookup"><span data-stu-id="0bf00-299">You get hello stale value for employee</span></span> <br> <span data-ttu-id="0bf00-300">entiteit omdat de transactie B nog niet</span><span class="sxs-lookup"><span data-stu-id="0bf00-300">entity because transaction B hasn't</span></span> <br> <span data-ttu-id="0bf00-301">nog gerepliceerd.</span><span class="sxs-lookup"><span data-stu-id="0bf00-301">replicated yet.</span></span> <span data-ttu-id="0bf00-302">Ophalen van de nieuwe waarde Hallo voor</span><span class="sxs-lookup"><span data-stu-id="0bf00-302">You get hello new value for</span></span><br> <span data-ttu-id="0bf00-303">Administrator-rol entiteit omdat C</span><span class="sxs-lookup"><span data-stu-id="0bf00-303">administrator role entity because C has</span></span><br> <span data-ttu-id="0bf00-304">gerepliceerd.</span><span class="sxs-lookup"><span data-stu-id="0bf00-304">replicated.</span></span> <span data-ttu-id="0bf00-305">Tijd van laatste synchronisatie is nog steeds niet</span><span class="sxs-lookup"><span data-stu-id="0bf00-305">Last Sync Time still hasn't</span></span><br> <span data-ttu-id="0bf00-306">is bijgewerkt, omdat de transactie B</span><span class="sxs-lookup"><span data-stu-id="0bf00-306">been updated because transaction B</span></span><br> <span data-ttu-id="0bf00-307">nog niet gerepliceerd.</span><span class="sxs-lookup"><span data-stu-id="0bf00-307">hasn't replicated.</span></span> <span data-ttu-id="0bf00-308">U kunt zien de</span><span class="sxs-lookup"><span data-stu-id="0bf00-308">You can tell the</span></span><br><span data-ttu-id="0bf00-309">Administrator-rol entiteit komt niet overeen</span><span class="sxs-lookup"><span data-stu-id="0bf00-309">administrator role entity is inconsistent</span></span> <br><span data-ttu-id="0bf00-310">omdat Hallo entiteit datum/tijd na</span><span class="sxs-lookup"><span data-stu-id="0bf00-310">because hello entity date/time is after</span></span> <br><span data-ttu-id="0bf00-311">Hallo tijd van laatste synchronisatie.</span><span class="sxs-lookup"><span data-stu-id="0bf00-311">hello Last Sync Time.</span></span> |
| <span data-ttu-id="0bf00-312">*T6*</span><span class="sxs-lookup"><span data-stu-id="0bf00-312">*T6*</span></span>     |                                                      | <span data-ttu-id="0bf00-313">Transactie B</span><span class="sxs-lookup"><span data-stu-id="0bf00-313">Transaction B</span></span><br> <span data-ttu-id="0bf00-314">gerepliceerd naar</span><span class="sxs-lookup"><span data-stu-id="0bf00-314">replicated to</span></span><br> <span data-ttu-id="0bf00-315">secundaire</span><span class="sxs-lookup"><span data-stu-id="0bf00-315">secondary</span></span> | <span data-ttu-id="0bf00-316">T6</span><span class="sxs-lookup"><span data-stu-id="0bf00-316">T6</span></span>                 | <span data-ttu-id="0bf00-317">*T6* – alle transacties via C hebben</span><span class="sxs-lookup"><span data-stu-id="0bf00-317">*T6* – All transactions through C have</span></span> <br><span data-ttu-id="0bf00-318">zijn gerepliceerd, tijd van laatste synchronisatie</span><span class="sxs-lookup"><span data-stu-id="0bf00-318">been replicated, Last Sync Time</span></span><br> <span data-ttu-id="0bf00-319">is bijgewerkt.</span><span class="sxs-lookup"><span data-stu-id="0bf00-319">is updated.</span></span> |

<span data-ttu-id="0bf00-320">In dit voorbeeld wordt ervan uitgegaan Hallo client switches tooreading van de secundaire regio Hallo op t 5.</span><span class="sxs-lookup"><span data-stu-id="0bf00-320">In this example, assume hello client switches tooreading from hello secondary region at T5.</span></span> <span data-ttu-id="0bf00-321">Het Hallo kan lezen **beheerdersrol** entiteit op dit moment maar Hallo entiteit bevat een waarde voor Hallo aantal beheerders die is niet consistent met de Hallo aantal **werknemer** entiteiten die zijn gemarkeerd als beheerders in de secundaire regio Hallo op dit moment.</span><span class="sxs-lookup"><span data-stu-id="0bf00-321">It can successfully read hello **administrator role** entity at this time, but hello entity contains a value for hello count of administrators that is not consistent with hello number of **employee** entities that are marked as administrators in hello secondary region at this time.</span></span> <span data-ttu-id="0bf00-322">De client kan deze waarde, met Hallo risico dat het inconsistente informatie is gewoon weergeven.</span><span class="sxs-lookup"><span data-stu-id="0bf00-322">Your client could simply display this value, with hello risk that it is inconsistent information.</span></span> <span data-ttu-id="0bf00-323">U kunt ook Hallo-client kan proberen toodetermine die Hallo **beheerdersrol** heeft een mogelijk inconsistente status omdat het Hallo-updates is een ongeldige volgorde en vervolgens informeert Hallo gebruiker van dit feit.</span><span class="sxs-lookup"><span data-stu-id="0bf00-323">Alternatively, hello client could attempt toodetermine that hello **administrator role** is in a potentially inconsistent state because hello updates have happened out of order, and then inform hello user of this fact.</span></span>

<span data-ttu-id="0bf00-324">toorecognize dat er mogelijk inconsistente gegevens, Hallo-client kunt Hallo waarde gebruiken Hallo *tijd van laatste synchronisatie* dat u op elk gewenst moment ophalen kunt door het opvragen van een storage-service.</span><span class="sxs-lookup"><span data-stu-id="0bf00-324">toorecognize that it has potentially inconsistent data, hello client can use hello value of hello *Last Sync Time* that you can get at any time by querying a storage service.</span></span> <span data-ttu-id="0bf00-325">Weet u Hallo tijd waarop het Hallo-gegevens in de secundaire regio Hallo laatst consistent en wanneer Hallo service waren toegepast alle transacties voorafgaande toothat punt in tijd Hallo.</span><span class="sxs-lookup"><span data-stu-id="0bf00-325">This tells you hello time when hello data in hello secondary region was last consistent and when hello service had applied all hello transactions prior toothat point in time.</span></span> <span data-ttu-id="0bf00-326">In het bovenstaande nadat het Hallo-service wordt ingevoegd Hallo voorbeeld Hallo **werknemer** entiteit in de secundaire regio Hallo Hallo tijd van laatste synchronisatie is ingesteld te*T1*.</span><span class="sxs-lookup"><span data-stu-id="0bf00-326">In hello example shown above, after hello service inserts hello **employee** entity in hello secondary region, hello last sync time is set too*T1*.</span></span> <span data-ttu-id="0bf00-327">Blijft *T1* totdat het Hallo-service-updates voor Hallo **werknemer** entiteit in de secundaire regio hello te is ingesteld*T6*.</span><span class="sxs-lookup"><span data-stu-id="0bf00-327">It remains at *T1* until hello service updates hello **employee** entity in hello secondary region when it is set too*T6*.</span></span> <span data-ttu-id="0bf00-328">Als client Hallo Hallo tijd van laatste synchronisatie Hallo-entiteit bij het lezen opgehaald *t 5*, deze kan worden vergeleken met Hallo tijdstempel op Hallo entiteit.</span><span class="sxs-lookup"><span data-stu-id="0bf00-328">If hello client retrieves hello last sync time when it reads hello entity at *T5*, it can compare it with hello timestamp on hello entity.</span></span> <span data-ttu-id="0bf00-329">Als Hallo tijdstempel op Hallo entiteit later dan Hallo is gesynchroniseerd op tijd, en vervolgens hello entiteit is een mogelijk inconsistente status heeft en u kunt nemen wat de juiste actie Hallo voor uw toepassing is.</span><span class="sxs-lookup"><span data-stu-id="0bf00-329">If hello timestamp on hello entity is later than hello last sync time, then hello entity is in a potentially inconsistent state, and you can take whatever is hello appropriate action for your application.</span></span> <span data-ttu-id="0bf00-330">In dit veld is vereist dat u weet wanneer Hallo laatste update toohello primaire is voltooid.</span><span class="sxs-lookup"><span data-stu-id="0bf00-330">Using this field requires that you know when hello last update toohello primary was completed.</span></span>

## <a name="testing"></a><span data-ttu-id="0bf00-331">Testen</span><span class="sxs-lookup"><span data-stu-id="0bf00-331">Testing</span></span>

<span data-ttu-id="0bf00-332">Het is belangrijk tootest die uw toepassing werkt zoals verwacht wanneer herstelbare fouten worden aangetroffen.</span><span class="sxs-lookup"><span data-stu-id="0bf00-332">It's important tootest that your application behaves as expected when it encounters retryable errors.</span></span> <span data-ttu-id="0bf00-333">Bijvoorbeeld, moet u tootest die toepassing switches toohello secundaire hello en in de modus alleen-lezen wanneer er een probleem gedetecteerd en activeren wanneer de primaire regio Hallo weer beschikbaar is.</span><span class="sxs-lookup"><span data-stu-id="0bf00-333">For example, you need tootest that hello application switches toohello secondary and into read-only mode when it detects a problem, and switches back when hello primary region becomes available again.</span></span> <span data-ttu-id="0bf00-334">toodo, u moet een manier toosimulate herstelbare fouten en bepalen hoe vaak ze voorkomen.</span><span class="sxs-lookup"><span data-stu-id="0bf00-334">toodo this, you need a way toosimulate retryable errors and control how often they occur.</span></span>

<span data-ttu-id="0bf00-335">U kunt [Fiddler](http://www.telerik.com/fiddler) toointercept en HTTP-antwoorden in een script te wijzigen.</span><span class="sxs-lookup"><span data-stu-id="0bf00-335">You can use [Fiddler](http://www.telerik.com/fiddler) toointercept and modify HTTP responses in a script.</span></span> <span data-ttu-id="0bf00-336">Dit script kunt identificeren van reacties die afkomstig van uw primaire eindpunt zijn en wijzig Hallo HTTP-status code tooone die Hallo die Storage-clientbibliotheek wordt herkend als een herstelbare fout.</span><span class="sxs-lookup"><span data-stu-id="0bf00-336">This script can identify responses that come from your primary endpoint and change hello HTTP status code tooone that hello Storage Client Library recognizes as a retryable error.</span></span> <span data-ttu-id="0bf00-337">Dit codefragment toont een eenvoudig voorbeeld van een script Fiddler die antwoorden tooread aanvragen op basis van Hallo onderschept **employeedata** tabel tooreturn status 502:</span><span class="sxs-lookup"><span data-stu-id="0bf00-337">This code snippet shows a simple example of a Fiddler script that intercepts responses tooread requests against hello **employeedata** table tooreturn a 502 status:</span></span>

```java
static function OnBeforeResponse(oSession: Session) {
    ...
    if ((oSession.hostname == "\[yourstorageaccount\].table.core.windows.net")
      && (oSession.PathAndQuery.StartsWith("/employeedata?$filter"))) {
        oSession.responseCode = 502;
    }
}
```

<span data-ttu-id="0bf00-338">U kan een groter aantal aanvragen voor dit voorbeeld toointercept uitbreiden en alleen wijzigen Hallo **responseCode** op sommige van deze toobetter een Praktijkscenario simuleren.</span><span class="sxs-lookup"><span data-stu-id="0bf00-338">You could extend this example toointercept a wider range of requests and only change hello **responseCode** on some of them toobetter simulate a real-world scenario.</span></span> <span data-ttu-id="0bf00-339">Zie voor meer informatie over het aanpassen van Fiddler scripts [wijzigen van een aanvraag of antwoord](http://docs.telerik.com/fiddler/KnowledgeBase/FiddlerScript/ModifyRequestOrResponse) in Hallo Fiddler documentatie.</span><span class="sxs-lookup"><span data-stu-id="0bf00-339">For more information about customizing Fiddler scripts, see [Modifying a Request or Response](http://docs.telerik.com/fiddler/KnowledgeBase/FiddlerScript/ModifyRequestOrResponse) in hello Fiddler documentation.</span></span>

<span data-ttu-id="0bf00-340">Als u hebt aangebracht Hallo drempelwaarden voor het overschakelen van uw toepassing tooread alleen-lezen-modus worden geconfigureerd, worden deze eenvoudiger tootest Hallo gedrag met niet-productieve transactie volumes.</span><span class="sxs-lookup"><span data-stu-id="0bf00-340">If you have made hello thresholds for switching your application tooread-only mode configurable, it will be easier tootest hello behavior with non-production transaction volumes.</span></span>

## <a name="next-steps"></a><span data-ttu-id="0bf00-341">Volgende stappen</span><span class="sxs-lookup"><span data-stu-id="0bf00-341">Next Steps</span></span>

* <span data-ttu-id="0bf00-342">Zie voor meer informatie over leestoegang geografische redundantie, met inbegrip van een ander voorbeeld van hoe Hallo LastSyncTime is ingesteld, neem [Windows Azure-opslagopties redundantie en geografisch redundante opslag met leestoegang](https://blogs.msdn.microsoft.com/windowsazurestorage/2013/12/11/windows-azure-storage-redundancy-options-and-read-access-geo-redundant-storage/).</span><span class="sxs-lookup"><span data-stu-id="0bf00-342">For more information about Read Access Geo-Redundancy, including another example of how hello LastSyncTime is set, please see [Windows Azure Storage Redundancy Options and Read Access Geo Redundant Storage](https://blogs.msdn.microsoft.com/windowsazurestorage/2013/12/11/windows-azure-storage-redundancy-options-and-read-access-geo-redundant-storage/).</span></span>

* <span data-ttu-id="0bf00-343">Zie voor een compleet codevoorbeeld die laat zien hoe toomake heen en weer schakelen tussen de primaire en secundaire eindpunten Hallo Hallo, [Azure Samples – met Hallo Circuitonderbreker patroon met RA-GRS storage](https://github.com/Azure-Samples/storage-dotnet-circuit-breaker-pattern-ha-apps-using-ra-grs).</span><span class="sxs-lookup"><span data-stu-id="0bf00-343">For a complete sample showing how toomake hello switch back and forth between hello Primary and Secondary endpoints, please see [Azure Samples – Using hello Circuit Breaker Pattern with RA-GRS storage](https://github.com/Azure-Samples/storage-dotnet-circuit-breaker-pattern-ha-apps-using-ra-grs).</span></span>
