---
title: aaaUse incrementele momentopnamen voor back-up en herstel van niet-beheerde schijven van de virtuele machine in Azure | Microsoft Docs
description: Maak een aangepaste oplossing voor back-up en herstel van uw virtuele machine van Azure-schijven met incrementele momentopnamen.
services: storage
documentationcenter: na
author: aungoo-msft
manager: tadb
editor: tysonn
ms.assetid: 3524b987-bd65-4e35-83e7-fbc2136643e5
ms.service: storage
ms.workload: storage
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 01/23/2017
ms.author: aungoo
ms.openlocfilehash: 6d3e6d78e953f77a1028ac35dcde1ef046dbc3bb
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 10/06/2017
---
# <a name="back-up-azure-unmanaged-vm-disks-with-incremental-snapshots"></a><span data-ttu-id="ba5ea-103">Back-up van Azure niet-beheerde VM-schijven met incrementele momentopnamen</span><span class="sxs-lookup"><span data-stu-id="ba5ea-103">Back up Azure unmanaged VM disks with incremental snapshots</span></span>
## <a name="overview"></a><span data-ttu-id="ba5ea-104">Overzicht</span><span class="sxs-lookup"><span data-stu-id="ba5ea-104">Overview</span></span>
<span data-ttu-id="ba5ea-105">Azure-opslag biedt de mogelijkheid van Hallo tootake momentopnamen van blobs.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-105">Azure Storage provides hello capability tootake snapshots of blobs.</span></span> <span data-ttu-id="ba5ea-106">Hallo blob status vastleggen momentopnamen op dat moment.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-106">Snapshots capture hello blob state at that point in time.</span></span> <span data-ttu-id="ba5ea-107">In dit artikel wordt een scenario van hoe u back-ups van de schijven van de virtuele machine met momentopnamen kunt onderhouden worden beschreven.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-107">In this article, we will describe a scenario of how you can maintain backups of virtual machine disks using snapshots.</span></span> <span data-ttu-id="ba5ea-108">U kunt deze methode wanneer u ervoor geen toouse kiest Azure Backup en Recovery-Service en desgewenst toocreate een aangepaste back-upstrategie voor uw virtuele machine-schijven.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-108">You can use this methodology when you choose not toouse Azure Backup and Recovery Service, and wish toocreate a custom backup strategy for your virtual machine disks.</span></span>

<span data-ttu-id="ba5ea-109">Virtuele machine van Azure-schijven zijn opgeslagen als pagina-blobs in Azure Storage.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-109">Azure virtual machine disks are stored as page blobs in Azure Storage.</span></span> <span data-ttu-id="ba5ea-110">Aangezien we back-upstrategie voor virtuele-machineschijven in dit artikel bedoelen, verwijzen we wordt toosnapshots in de context Hallo van pagina-blobs.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-110">Since we are talking about backup strategy for virtual machine disks in this article, we will be referring toosnapshots in hello context of page blobs.</span></span> <span data-ttu-id="ba5ea-111">toolearn meer informatie over de momentopnamen te verwijzen[maken van een momentopname van een Blob](https://msdn.microsoft.com/library/azure/hh488361.aspx).</span><span class="sxs-lookup"><span data-stu-id="ba5ea-111">toolearn more about snapshots, refer too[Creating a Snapshot of a Blob](https://msdn.microsoft.com/library/azure/hh488361.aspx).</span></span>

## <a name="what-is-a-snapshot"></a><span data-ttu-id="ba5ea-112">Wat is er een momentopname?</span><span class="sxs-lookup"><span data-stu-id="ba5ea-112">What is a snapshot?</span></span>
<span data-ttu-id="ba5ea-113">Een blob-momentopname is een alleen-lezen-versie van een blob die is opgenomen op een punt in tijd.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-113">A blob snapshot is a read-only version of a blob that is captured at a point in time.</span></span> <span data-ttu-id="ba5ea-114">Wanneer een momentopname is gemaakt, kan deze worden gelezen, gekopieerd, of verwijderd, maar niet gewijzigd.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-114">Once a snapshot has been created, it can be read, copied, or deleted, but not modified.</span></span> <span data-ttu-id="ba5ea-115">Momentopnamen bieden een manier tooback van een blob, zoals deze wordt weergegeven op een moment.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-115">Snapshots provide a way tooback up a blob as it appears at a moment in time.</span></span> <span data-ttu-id="ba5ea-116">Pas REST versie 2015-04-05 moest u Hallo mogelijkheid toocopy volledige momentopnamen.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-116">Until REST version 2015-04-05 you had hello ability toocopy full snapshots.</span></span> <span data-ttu-id="ba5ea-117">Met de Hallo REST versie 2015-07-08 en hoger, u kunt u ook incrementele momentopnamen kopiëren.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-117">With hello REST version 2015-07-08 and above, you can also copy incremental snapshots.</span></span>

## <a name="full-snapshot-copy"></a><span data-ttu-id="ba5ea-118">Volledige momentopname kopiëren</span><span class="sxs-lookup"><span data-stu-id="ba5ea-118">Full snapshot copy</span></span>
<span data-ttu-id="ba5ea-119">Momentopnamen kunnen worden gekopieerd tooanother storage-account als een back-ups tookeep blob van Hallo base blob.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-119">Snapshots can be copied tooanother storage account as a blob tookeep backups of hello base blob.</span></span> <span data-ttu-id="ba5ea-120">U kunt ook een momentopname kopiëren via de base blob, is vergelijkbaar met het herstellen van Hallo blob tooan eerdere versie.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-120">You can also copy a snapshot over its base blob, which is like restoring hello blob tooan earlier version.</span></span> <span data-ttu-id="ba5ea-121">Wanneer een momentopname van een storage account tooanother wordt gekopieerd, wordt het Hallo dezelfde als Hallo basispagina blob-ruimte innemen.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-121">When a snapshot is copied from one storage account tooanother, it will occupy hello same space as hello base page blob.</span></span> <span data-ttu-id="ba5ea-122">Daarom hele momentopnamen kopiëren van een storage account tooanother traag zullen zijn en wordt ook veel ruimte in Hallo doel storage-account gebruiken.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-122">Therefore, copying whole snapshots from one storage account tooanother will be slow and will also consume lot of space in hello target storage account.</span></span>

> [!NOTE]
> <span data-ttu-id="ba5ea-123">Als u Hallo base blob tooanother doel kopieert, worden Hallo momentopnamen van Hallo blob niet samen met het gekopieerd.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-123">If you copy hello base blob tooanother destination, hello snapshots of hello blob are not copied along with it.</span></span> <span data-ttu-id="ba5ea-124">Op dezelfde manier als u een basis blob met een kopie overschrijven, momentopnamen die zijn gekoppeld met Hallo base blob worden niet beïnvloed en onder de blobnaam van de basis intact blijven.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-124">Similarly, if you overwrite a base blob with a copy, snapshots associated with hello base blob are not affected and stay intact under base blob name.</span></span>
> 
> 

### <a name="back-up-disks-using-snapshots"></a><span data-ttu-id="ba5ea-125">Back-up van schijven met momentopnamen</span><span class="sxs-lookup"><span data-stu-id="ba5ea-125">Back up disks using snapshots</span></span>
<span data-ttu-id="ba5ea-126">Als een back-upstrategie voor uw virtuele machine-schijven kunt u periodieke momentopnamen van Hallo schijf of pagina-blob en kopieer deze tooanother storage-account met de hulpprogramma's zoals [Blob kopiëren](https://msdn.microsoft.com/library/azure/dd894037.aspx) bewerking of [AzCopy](storage-use-azcopy.md).</span><span class="sxs-lookup"><span data-stu-id="ba5ea-126">As a backup strategy for your virtual machine disks, you can take periodic snapshots of hello disk or page blob, and copy them tooanother storage account using tools like [Copy Blob](https://msdn.microsoft.com/library/azure/dd894037.aspx) operation or [AzCopy](storage-use-azcopy.md).</span></span> <span data-ttu-id="ba5ea-127">U kunt een momentopname tooa bestemming pagina-blob met een andere naam kopiëren.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-127">You can copy a snapshot tooa destination page blob with a different name.</span></span> <span data-ttu-id="ba5ea-128">Hallo resulterende de bestemmings-pagina-blob is een beschrijfbare pagina-blob en niet een momentopname.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-128">hello resulting destination page blob is a writeable page blob and not a snapshot.</span></span> <span data-ttu-id="ba5ea-129">Verderop in dit artikel wordt beschreven stappen tootake back-ups van de schijven van de virtuele machine met momentopnamen.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-129">Later in this article we will describe steps tootake backups of virtual machine disks using snapshots.</span></span>

### <a name="restore-disks-using-snapshots"></a><span data-ttu-id="ba5ea-130">Schijven met momentopnamen terugzetten</span><span class="sxs-lookup"><span data-stu-id="ba5ea-130">Restore disks using snapshots</span></span>
<span data-ttu-id="ba5ea-131">Wanneer het tijd toorestore uw schijf tooa vorige stabiele versie vastgelegd in een Hallo back-upmomentopnamen is, kunt u een momentopname via Hallo basispagina blob kopiëren.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-131">When it is time toorestore your disk tooa previous stable version captured in one of hello backup snapshots, you can copy a snapshot over hello base page blob.</span></span> <span data-ttu-id="ba5ea-132">Nadat de momentopname Hallo is gepromoveerde toohello basispagina blob, Hallo momentopname blijft, maar de bron wordt overschreven met een kopie die kan worden gelezen en geschreven.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-132">After hello snapshot is promoted toohello base page blob, hello snapshot remains, but its source is overwritten with a copy that can be both read and written.</span></span> <span data-ttu-id="ba5ea-133">Verderop in dit artikel wordt beschreven stappen toorestore een eerdere versie van de schijf van de momentopname is gemaakt.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-133">Later in this article we will describe steps toorestore a previous version of your disk from its snapshot.</span></span>

### <a name="implementing-full-snapshot-copy"></a><span data-ttu-id="ba5ea-134">Volledige snapshotkopieën implementeren</span><span class="sxs-lookup"><span data-stu-id="ba5ea-134">Implementing full snapshot copy</span></span>
<span data-ttu-id="ba5ea-135">U kunt een kopie van de volledige momentopname implementeren door Hallo-volgende te doen</span><span class="sxs-lookup"><span data-stu-id="ba5ea-135">You can implement a full snapshot copy by doing hello following,</span></span>

* <span data-ttu-id="ba5ea-136">Eerst een momentopname van Hallo base blob met Hallo [momentopname Blob](https://msdn.microsoft.com/library/azure/ee691971.aspx) bewerking.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-136">First, take a snapshot of hello base blob using hello [Snapshot Blob](https://msdn.microsoft.com/library/azure/ee691971.aspx) operation.</span></span>
* <span data-ttu-id="ba5ea-137">Vervolgens kopiëren Hallo momentopname tooa doel storage account met behulp van [Blob kopiëren](https://msdn.microsoft.com/library/azure/dd894037.aspx).</span><span class="sxs-lookup"><span data-stu-id="ba5ea-137">Then, copy hello snapshot tooa target storage account using [Copy Blob](https://msdn.microsoft.com/library/azure/dd894037.aspx).</span></span>
* <span data-ttu-id="ba5ea-138">Herhaal dit proces toomaintain back-ups van uw base blob.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-138">Repeat this process toomaintain backup copies of your base blob.</span></span>

## <a name="incremental-snapshot-copy"></a><span data-ttu-id="ba5ea-139">Incrementele snapshotkopieën</span><span class="sxs-lookup"><span data-stu-id="ba5ea-139">Incremental snapshot copy</span></span>
<span data-ttu-id="ba5ea-140">Hallo nieuwe functie in [GetPageRanges](https://msdn.microsoft.com/library/azure/ee691973.aspx) API biedt een veel betere manier tooback up Hallo momentopnamen van uw pagina-blobs of de schijven.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-140">hello new feature in [GetPageRanges](https://msdn.microsoft.com/library/azure/ee691973.aspx) API provides a much better way tooback up hello snapshots of your page blobs or disks.</span></span> <span data-ttu-id="ba5ea-141">Hallo API retourneert Hallo lijst met wijzigingen tussen Hallo base blob en het Hallo-momentopnamen.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-141">hello API returns hello list of changes between hello base blob and hello snapshots.</span></span> <span data-ttu-id="ba5ea-142">Dit vermindert Hallo en de hoeveelheid opslagruimte die wordt gebruikt voor back-up Hallo-account.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-142">This reduces hello amount of storage space used on hello backup account.</span></span> <span data-ttu-id="ba5ea-143">Hallo API biedt ondersteuning voor pagina-blobs in Premium-opslag, evenals de Standard-opslag.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-143">hello API supports page blobs on Premium Storage as well as Standard Storage.</span></span> <span data-ttu-id="ba5ea-144">Deze API gebruikt, kunt u sneller en efficiënt back-oplossingen bouwen voor Azure Virtual machines.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-144">Using this API, you can now build faster and efficient backup solutions for Azure VMs.</span></span> <span data-ttu-id="ba5ea-145">Dit is beschikbaar met Hallo REST-versie 2015-07-08 en hoger.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-145">This will be available with hello REST version 2015-07-08 and higher.</span></span>

<span data-ttu-id="ba5ea-146">Incrementele kopie van de momentopname, kunt u toocopy uit één storage account tooanother Hallo verschil tussen,</span><span class="sxs-lookup"><span data-stu-id="ba5ea-146">Incremental Snapshot Copy allows you toocopy from one storage account tooanother hello difference between,</span></span>

* <span data-ttu-id="ba5ea-147">Base blob en de momentopname of</span><span class="sxs-lookup"><span data-stu-id="ba5ea-147">Base blob and its Snapshot OR</span></span>
* <span data-ttu-id="ba5ea-148">De twee momentopnamen van Hallo base blob</span><span class="sxs-lookup"><span data-stu-id="ba5ea-148">Any two snapshots of hello base blob</span></span>

<span data-ttu-id="ba5ea-149">Opgegeven Hallo volgende voorwaarden wordt voldaan,</span><span class="sxs-lookup"><span data-stu-id="ba5ea-149">Provided hello following conditions are met,</span></span>

* <span data-ttu-id="ba5ea-150">Hallo-blob is gemaakt op Jan-1-2016 of hoger.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-150">hello blob was created on Jan-1-2016 or later.</span></span>
* <span data-ttu-id="ba5ea-151">Hallo-blob is niet overschreven met [PutPage](https://msdn.microsoft.com/library/azure/ee691975.aspx) of [Blob kopiëren](https://msdn.microsoft.com/library/azure/dd894037.aspx) tussen twee momentopnamen.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-151">hello blob was not overwritten with [PutPage](https://msdn.microsoft.com/library/azure/ee691975.aspx) or [Copy Blob](https://msdn.microsoft.com/library/azure/dd894037.aspx) between two snapshots.</span></span>

<span data-ttu-id="ba5ea-152">**Opmerking**: deze functie is beschikbaar voor Premium en Standard Azure-pagina-Blobs.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-152">**Note**: This feature is available for Premium and Standard Azure Page Blobs.</span></span>

<span data-ttu-id="ba5ea-153">Wanneer u hebt een aangepaste back-upstrategie die gebruikmaakt van momentopnamen, Hallo momentopnamen kopiëren van een storage account tooanother erg langzaam zijn en veel van de opslagruimte verbruikt.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-153">When you have a custom backup strategy that uses snapshots, copying hello snapshots from one storage account tooanother can be very slow and consumes a lot of storage space.</span></span> <span data-ttu-id="ba5ea-154">In plaats van het kopiëren van Hallo volledige momentopname tooa back-storage-account, kunt u Hallo verschil tussen opeenvolgende momentopnamen tooa back-pagina-blob schrijven.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-154">Instead of copying hello entire snapshot tooa backup storage account, you can write hello difference between consecutive snapshots tooa backup page blob.</span></span> <span data-ttu-id="ba5ea-155">Op deze manier Hallo tijd toocopy en ruimte toostore back-ups is aanzienlijk verminderd.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-155">This way, hello time toocopy and space toostore backups is substantially reduced.</span></span>

### <a name="implementing-incremental-snapshot-copy"></a><span data-ttu-id="ba5ea-156">Incrementele snapshotkopieën implementeren</span><span class="sxs-lookup"><span data-stu-id="ba5ea-156">Implementing Incremental Snapshot Copy</span></span>
<span data-ttu-id="ba5ea-157">U kunt incrementele snapshotkopieën implementeren door Hallo-volgende te doen</span><span class="sxs-lookup"><span data-stu-id="ba5ea-157">You can implement incremental snapshot copy by doing hello following,</span></span>

* <span data-ttu-id="ba5ea-158">Een momentopname van het gebruik van Hallo base blob [momentopname Blob](https://msdn.microsoft.com/library/azure/ee691971.aspx).</span><span class="sxs-lookup"><span data-stu-id="ba5ea-158">Take a snapshot of hello base blob using [Snapshot Blob](https://msdn.microsoft.com/library/azure/ee691971.aspx).</span></span>
* <span data-ttu-id="ba5ea-159">Kopiëren Hallo momentopname toohello doel back-upopslag account met behulp van [Blob kopiëren](https://msdn.microsoft.com/library/azure/dd894037.aspx).</span><span class="sxs-lookup"><span data-stu-id="ba5ea-159">Copy hello snapshot toohello target backup storage account using [Copy Blob](https://msdn.microsoft.com/library/azure/dd894037.aspx).</span></span> <span data-ttu-id="ba5ea-160">Dit is Hallo back-pagina-blob.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-160">This will be hello backup page blob.</span></span> <span data-ttu-id="ba5ea-161">Een momentopname van deze back-pagina-blobs en opslaan in de back-account.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-161">Take a snapshot of this backup page blob and store in backup account.</span></span>
* <span data-ttu-id="ba5ea-162">Maak nog een momentopname van Hallo base blob met momentopname Blob.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-162">Take another snapshot of hello base blob using Snapshot Blob.</span></span>
* <span data-ttu-id="ba5ea-163">Hallo verschil tussen het eerste en tweede momentopnamen van het gebruik van base blob ophalen [GetPageRanges](https://msdn.microsoft.com/library/azure/ee691973.aspx).</span><span class="sxs-lookup"><span data-stu-id="ba5ea-163">Get hello difference between first and second snapshots of base blob using  [GetPageRanges](https://msdn.microsoft.com/library/azure/ee691973.aspx).</span></span> <span data-ttu-id="ba5ea-164">Gebruik de nieuwe parameter Hallo **prevsnapshot** toospecify Hallo DateTime-waarde van Hallo momentopname die u wilt dat tooget Hallo verschil met.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-164">Use hello new parameter **prevsnapshot** toospecify hello DateTime value of hello snapshot you want tooget hello difference with.</span></span> <span data-ttu-id="ba5ea-165">Wanneer deze parameter aanwezig is, neemt Hallo REST antwoord alleen Hallo pagina's die zijn gewijzigd tussen doel momentopname en eerdere momentopname, met inbegrip van lege pagina's.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-165">When this parameter is present, hello REST response will include only hello pages that were changed between target snapshot and previous snapshot including clear pages.</span></span>
* <span data-ttu-id="ba5ea-166">Gebruik [PutPage](https://msdn.microsoft.com/library/azure/ee691975.aspx) tooapply deze wijzigingen toohello back-pagina-blob.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-166">Use [PutPage](https://msdn.microsoft.com/library/azure/ee691975.aspx) tooapply these changes toohello backup page blob.</span></span>
* <span data-ttu-id="ba5ea-167">Ten slotte een momentopname van de back-pagina-blob Hallo en sla deze op Hallo back-storage-account.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-167">Finally, take a snapshot of hello backup page blob and store it in hello backup storage account.</span></span>

<span data-ttu-id="ba5ea-168">In de volgende sectie hello, maar wij beschrijven in meer detail hoe u back-ups van schijven met incrementele kopie van de momentopname kunt onderhouden</span><span class="sxs-lookup"><span data-stu-id="ba5ea-168">In hello next section, we will describe in more detail how you can maintain backups of disks using Incremental Snapshot Copy</span></span>

## <a name="scenario"></a><span data-ttu-id="ba5ea-169">Scenario</span><span class="sxs-lookup"><span data-stu-id="ba5ea-169">Scenario</span></span>
<span data-ttu-id="ba5ea-170">In deze sectie wordt een scenario waarbij een aangepaste back-upstrategie voor schijven van de virtuele machine met momentopnamen worden beschreven.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-170">In this section we will describe a scenario that involves a custom backup strategy for virtual machine disks using snapshots.</span></span>

<span data-ttu-id="ba5ea-171">U kunt een DS-serie Azure virtuele machine met een premium-opslag P30 schijf die is gekoppeld.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-171">Consider a DS-series Azure VM with a premium storage P30 disk attached.</span></span> <span data-ttu-id="ba5ea-172">Hallo P30 schijf met de naam *mypremiumdisk* wordt opgeslagen in een premium storage-account genoemd *mypremiumaccount*.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-172">hello P30 disk called *mypremiumdisk* is stored in a premium storage account called *mypremiumaccount*.</span></span> <span data-ttu-id="ba5ea-173">Standard-opslagaccount aangeroepen *mybackupstdaccount* wordt gebruikt voor het opslaan van Hallo back-up van *mypremiumdisk*.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-173">A standard storage account called *mybackupstdaccount* will be used for storing hello backup of *mypremiumdisk*.</span></span> <span data-ttu-id="ba5ea-174">Willen we graag tookeep een momentopname van *mypremiumdisk* elke 12 uur.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-174">We would like tookeep a snapshot of *mypremiumdisk* every 12 hours.</span></span>

<span data-ttu-id="ba5ea-175">toolearn over het maken van de storage-account en schijven te verwijzen[over Azure storage-accounts](storage-create-storage-account.md).</span><span class="sxs-lookup"><span data-stu-id="ba5ea-175">toolearn about creating storage account and disks, refer too[About Azure storage accounts](storage-create-storage-account.md).</span></span>

<span data-ttu-id="ba5ea-176">toolearn back-ups van virtuele machines van Azure, te verwijzen[back-ups van virtuele machine van Azure plannen](../backup/backup-azure-vms-introduction.md).</span><span class="sxs-lookup"><span data-stu-id="ba5ea-176">toolearn about backing up Azure VMs, refer too[Plan Azure VM backups](../backup/backup-azure-vms-introduction.md).</span></span>

## <a name="steps-toomaintain-backups-of-a-disk-using-incremental-snapshots"></a><span data-ttu-id="ba5ea-177">Stappen toomaintain back-ups van een schijf met een incrementele momentopnamen</span><span class="sxs-lookup"><span data-stu-id="ba5ea-177">Steps toomaintain backups of a disk using incremental snapshots</span></span>
<span data-ttu-id="ba5ea-178">Hallo stappen hieronder gaat momentopnamen van *mypremiumdisk* en onderhouden van Hallo back-ups in *mybackupstdaccount*.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-178">hello steps described below will take snapshots of *mypremiumdisk* and maintain hello backups in *mybackupstdaccount*.</span></span> <span data-ttu-id="ba5ea-179">Hallo back-up is een standaard pagina-blob aangeroepen *mybackupstdpageblob*.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-179">hello backup will be a standard page blob called *mybackupstdpageblob*.</span></span> <span data-ttu-id="ba5ea-180">Hallo back-pagina-blob wordt altijd overeen met dezelfde status die als laatste momentopname van Hallo Hallo *mypremiumdisk*.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-180">hello backup page blob will always reflect hello same state as hello last snapshot of *mypremiumdisk*.</span></span>

1. <span data-ttu-id="ba5ea-181">Maak eerst Hallo back-pagina-blob voor de schijf van uw premium-opslag.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-181">First, create hello backup page blob for your premium storage disk.</span></span> <span data-ttu-id="ba5ea-182">toodo deze, nemen een momentopname van *mypremiumdisk* aangeroepen *mypremiumdisk_ss1*.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-182">toodo this, take a snapshot of *mypremiumdisk* called *mypremiumdisk_ss1*.</span></span>
2. <span data-ttu-id="ba5ea-183">Deze momentopname toomybackupstdaccount kopiëren als een pagina-blob aangeroepen *mybackupstdpageblob*.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-183">Copy this snapshot toomybackupstdaccount as a page blob called *mybackupstdpageblob*.</span></span>
3. <span data-ttu-id="ba5ea-184">Een momentopname van *mybackupstdpageblob* aangeroepen *mybackupstdpageblob_ss1*met [momentopname Blob](https://msdn.microsoft.com/library/azure/ee691971.aspx) en op te slaan in *mybackupstdaccount*.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-184">Take a snapshot of *mybackupstdpageblob* called *mybackupstdpageblob_ss1*, using [Snapshot Blob](https://msdn.microsoft.com/library/azure/ee691971.aspx) and store it in *mybackupstdaccount*.</span></span>
4. <span data-ttu-id="ba5ea-185">Tijdens de back-upvenster hello, maak nog een momentopname van *mypremiumdisk*, spreek *mypremiumdisk_ss2*, en op te slaan in *mypremiumaccount*.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-185">During hello backup window, create another snapshot of *mypremiumdisk*, say *mypremiumdisk_ss2*, and store it in *mypremiumaccount*.</span></span>
5. <span data-ttu-id="ba5ea-186">Hallo incrementele wijzigingen tussen twee Hallo momentopnamen ophalen *mypremiumdisk_ss2* en *mypremiumdisk_ss1*met [GetPageRanges](https://msdn.microsoft.com/library/azure/ee691973.aspx) op  *mypremiumdisk_ss2* met **prevsnapshot** parameterset toohello tijdstempel van *mypremiumdisk_ss1*.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-186">Get hello incremental changes between hello two snapshots, *mypremiumdisk_ss2* and *mypremiumdisk_ss1*, using [GetPageRanges](https://msdn.microsoft.com/library/azure/ee691973.aspx) on *mypremiumdisk_ss2* with **prevsnapshot** parameter set toohello timestamp of *mypremiumdisk_ss1*.</span></span> <span data-ttu-id="ba5ea-187">Schrijven van deze back-pagina-blob van incrementele wijzigingen toohello *mybackupstdpageblob* in *mybackupstdaccount*.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-187">Write these incremental changes toohello backup page blob *mybackupstdpageblob* in *mybackupstdaccount*.</span></span> <span data-ttu-id="ba5ea-188">Als er in Hallo incrementele wijzigingen verwijderde bereiken, moet het worden gewist van Hallo back-pagina-blob.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-188">If there are deleted ranges in hello incremental changes, they must be cleared from hello backup page blob.</span></span> <span data-ttu-id="ba5ea-189">Gebruik [PutPage](https://msdn.microsoft.com/library/azure/ee691975.aspx) toowrite incrementele wijzigingen toohello back-pagina-blob.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-189">Use [PutPage](https://msdn.microsoft.com/library/azure/ee691975.aspx) toowrite incremental changes toohello backup page blob.</span></span>
6. <span data-ttu-id="ba5ea-190">Een momentopname van de back-pagina-blob Hallo *mybackupstdpageblob*die *mybackupstdpageblob_ss2*.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-190">Take a snapshot of hello backup page blob *mybackupstdpageblob*, called *mybackupstdpageblob_ss2*.</span></span> <span data-ttu-id="ba5ea-191">Verwijderen van de vorige momentopname Hallo *mypremiumdisk_ss1* van premium storage-account.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-191">Delete hello previous snapshot *mypremiumdisk_ss1* from premium storage account.</span></span>
7. <span data-ttu-id="ba5ea-192">Herhaal stap 4-6 elke back-upvenster.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-192">Repeat steps 4-6 every backup window.</span></span> <span data-ttu-id="ba5ea-193">Op deze manier kunt u back-ups van blijven *mypremiumdisk* in een standard-opslagaccount.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-193">In this way, you can maintain backups of *mypremiumdisk* in a standard storage account.</span></span>

![Maak een back-up van schijf met behulp van incrementele momentopnamen](./media/storage-incremental-snapshots/storage-incremental-snapshots-1.png)

## <a name="steps-toorestore-a-disk-from-snapshots"></a><span data-ttu-id="ba5ea-195">Stappen toorestore een schijf van momentopnamen</span><span class="sxs-lookup"><span data-stu-id="ba5ea-195">Steps toorestore a disk from snapshots</span></span>
<span data-ttu-id="ba5ea-196">Hello stappen die hieronder worden beschreven, wordt hersteld premium schijf, *mypremiumdisk* tooan eerder een momentopname van de back-opslagaccount hello *mybackupstdaccount*.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-196">hello steps described below will restore premium disk, *mypremiumdisk* tooan earlier snapshot from hello backup storage account *mybackupstdaccount*.</span></span>

1. <span data-ttu-id="ba5ea-197">Hallo punt in de tijd die u wenst dat toorestore Hallo premium schijf om te identificeren.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-197">Identify hello point in time you wish toorestore hello premium disk to.</span></span> <span data-ttu-id="ba5ea-198">Stel dat een momentopname *mybackupstdpageblob_ss2*, die is opgeslagen in de back-opslagaccount hello *mybackupstdaccount*.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-198">Let's say that is snapshot *mybackupstdpageblob_ss2*, which is stored in hello backup storage account *mybackupstdaccount*.</span></span>
2. <span data-ttu-id="ba5ea-199">Promoveren in mybackupstdaccount, Hallo momentopname *mybackupstdpageblob_ss2* als het nieuwe back-up basispagina blob Hallo *mybackupstdpageblobrestored*.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-199">In mybackupstdaccount, promote hello snapshot *mybackupstdpageblob_ss2* as hello new backup base page blob *mybackupstdpageblobrestored*.</span></span>
3. <span data-ttu-id="ba5ea-200">Een momentopname van deze herstelde back-pagina-blob, aangeroepen *mybackupstdpageblobrestored_ss1*.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-200">Take a snapshot of this restored backup page blob, called *mybackupstdpageblobrestored_ss1*.</span></span>
4. <span data-ttu-id="ba5ea-201">Hallo hersteld pagina-blob kopiëren *mybackupstdpageblobrestored* van *mybackupstdaccount* te*mypremiumaccount* als Hallo nieuwe premium schijf  *mypremiumdiskrestored*.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-201">Copy hello restored page blob *mybackupstdpageblobrestored* from *mybackupstdaccount* too*mypremiumaccount* as hello new premium disk *mypremiumdiskrestored*.</span></span>
5. <span data-ttu-id="ba5ea-202">Een momentopname van *mypremiumdiskrestored*die *mypremiumdiskrestored_ss1* voor toekomstige incrementele back-ups maken.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-202">Take a snapshot of *mypremiumdiskrestored*, called *mypremiumdiskrestored_ss1* for making future incremental backups.</span></span>
6. <span data-ttu-id="ba5ea-203">Wijs Hallo DS reeks VM toohello hersteld schijf *mypremiumdiskrestored* ont Hallo oude *mypremiumdisk* van Hallo VM.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-203">Point hello DS series VM toohello restored disk *mypremiumdiskrestored* and detach hello old *mypremiumdisk* from hello VM.</span></span>
7. <span data-ttu-id="ba5ea-204">Beginnen met Hallo back-up wordt beschreven in de vorige sectie voor Hallo hersteld schijf *mypremiumdiskrestored*, met behulp van Hallo *mybackupstdpageblobrestored* als Hallo back-pagina-blob.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-204">Begin hello Backup process described in previous section for hello restored disk *mypremiumdiskrestored*, using hello *mybackupstdpageblobrestored* as hello backup page blob.</span></span>

![Schijf terugzetten van momentopnamen](./media/storage-incremental-snapshots/storage-incremental-snapshots-2.png)

## <a name="next-steps"></a><span data-ttu-id="ba5ea-206">Volgende stappen</span><span class="sxs-lookup"><span data-stu-id="ba5ea-206">Next Steps</span></span>
<span data-ttu-id="ba5ea-207">Meer informatie over het maken van momentopnamen van een blob en het plannen van uw back-infrastructuur met behulp van de onderstaande koppelingen voor Hallo van VM.</span><span class="sxs-lookup"><span data-stu-id="ba5ea-207">Learn more about creating snapshots of a blob and planning your VM backup infrastructure using hello links below.</span></span>

* [<span data-ttu-id="ba5ea-208">Maken van een momentopname van een Blob</span><span class="sxs-lookup"><span data-stu-id="ba5ea-208">Creating a Snapshot of a Blob</span></span>](https://msdn.microsoft.com/library/azure/hh488361.aspx)
* [<span data-ttu-id="ba5ea-209">Uw VM-back-infrastructuur plannen</span><span class="sxs-lookup"><span data-stu-id="ba5ea-209">Plan your VM Backup Infrastructure</span></span>](../backup/backup-azure-vms-introduction.md)

