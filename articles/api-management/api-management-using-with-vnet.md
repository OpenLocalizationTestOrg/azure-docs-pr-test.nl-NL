---
title: aaaHow toouse Azure API Management met virtuele netwerken
description: Meer informatie over hoe toosetup verbinding tooa virtueel netwerk in Azure API Management en toegang tot web-services via het.
services: api-management
documentationcenter: 
author: antonba
manager: erikre
editor: 
ms.assetid: 64b58f7b-ca22-47dc-89c0-f6bb0af27a48
ms.service: api-management
ms.workload: mobile
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 12/15/2016
ms.author: apimpm
ms.openlocfilehash: 426b3974e4fed7daffdb0c3f02381edbc326dc28
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 10/06/2017
---
# <a name="how-toouse-azure-api-management-with-virtual-networks"></a><span data-ttu-id="7560b-103">Hoe toouse Azure API Management met virtuele netwerken</span><span class="sxs-lookup"><span data-stu-id="7560b-103">How toouse Azure API Management with virtual networks</span></span>
<span data-ttu-id="7560b-104">Virtuele netwerken van Azure (vnet's) kunt u een van uw Azure-resources in een internet-routeable netwerk dat u beheert de toegang tot tooplace.</span><span class="sxs-lookup"><span data-stu-id="7560b-104">Azure Virtual Networks (VNETs) allow you tooplace any of your Azure resources in a non-internet routeable network that you control access to.</span></span> <span data-ttu-id="7560b-105">Deze netwerken kunnen vervolgens worden verbonden tooyour on-premises netwerken met behulp van verschillende VPN-technologieën.</span><span class="sxs-lookup"><span data-stu-id="7560b-105">These networks can then be connected tooyour on-premises networks using various VPN technologies.</span></span> <span data-ttu-id="7560b-106">meer informatie over Azure Virtual Networks met Hallo informatie hier beginnen toolearn: [Azure Virtual Network-overzicht](../virtual-network/virtual-networks-overview.md).</span><span class="sxs-lookup"><span data-stu-id="7560b-106">toolearn more about Azure Virtual Networks start with hello information here: [Azure Virtual Network Overview](../virtual-network/virtual-networks-overview.md).</span></span>

<span data-ttu-id="7560b-107">Azure API Management kunnen worden geïmplementeerd in Hallo virtuele netwerk (VNET), zodat deze toegang heeft tot back-end-services binnen Hallo-netwerk.</span><span class="sxs-lookup"><span data-stu-id="7560b-107">Azure API Management can be deployed inside hello virtual network (VNET), so it can access backend services within hello network.</span></span> <span data-ttu-id="7560b-108">Hallo developer-portal en API-gateway, geconfigureerde toobe toegankelijk is vanaf Internet Hallo of alleen binnen het virtuele netwerk Hallo kan zijn.</span><span class="sxs-lookup"><span data-stu-id="7560b-108">hello developer portal and API gateway, can be configured toobe accessible either from hello Internet or only within hello virtual network.</span></span>

> [!NOTE]
> <span data-ttu-id="7560b-109">Azure API Management biedt ondersteuning voor classic en Azure Resource Manager-vnet's.</span><span class="sxs-lookup"><span data-stu-id="7560b-109">Azure API Management supports both classic and Azure Resource Manager VNets.</span></span>
>
>

## <span data-ttu-id="7560b-110"><a name="enable-vpn"></a>Inschakelen VNET-verbinding</span><span class="sxs-lookup"><span data-stu-id="7560b-110"><a name="enable-vpn"> </a>Enable VNET connection</span></span>
> [!NOTE]
> <span data-ttu-id="7560b-111">VNET-connectiviteit is beschikbaar in Hallo **Premium** en **Developer** lagen.</span><span class="sxs-lookup"><span data-stu-id="7560b-111">VNET connectivity is available in hello **Premium** and **Developer** tiers.</span></span> <span data-ttu-id="7560b-112">tooswitch tussen lagen hello, opent u uw API Management-service in hello Azure-portal en open vervolgens Hallo **schaal en prijzen** tabblad. Onder Hallo **prijscategorie** sectie, selecteer de laag Premium of ontwikkelaar Hallo en klik op opslaan.</span><span class="sxs-lookup"><span data-stu-id="7560b-112">tooswitch between hello tiers, open your API Management service in hello Azure portal and then open hello **Scale and pricing** tab. Under hello **Pricing tier** section, select hello Premium or Developer tier and click Save.</span></span>
>

<span data-ttu-id="7560b-113">tooenable VNET-connectiviteit, open uw API Management-service in hello Azure-portal en Hallo **virtueel netwerk** pagina.</span><span class="sxs-lookup"><span data-stu-id="7560b-113">tooenable VNET connectivity, open your API Management service in hello Azure portal and open hello **Virtual network** page.</span></span>

![Virtueel netwerk menu van API Management][api-management-using-vnet-menu]

<span data-ttu-id="7560b-115">Hallo gewenste toegangstype selecteren:</span><span class="sxs-lookup"><span data-stu-id="7560b-115">Select hello desired access type:</span></span>

* <span data-ttu-id="7560b-116">**Externe**: Hallo API Management-gateway en developer portal toegankelijk zijn vanaf Hallo openbare internet via een externe load balancer.</span><span class="sxs-lookup"><span data-stu-id="7560b-116">**External**: hello API Management gateway and developer portal are accessible from hello public internet via an external load balancer.</span></span> <span data-ttu-id="7560b-117">Hallo-gateway toegang tot bronnen in het virtuele netwerk Hallo.</span><span class="sxs-lookup"><span data-stu-id="7560b-117">hello gateway can access resources within hello virtual network.</span></span>

![Openbare peering][api-management-vnet-public]

* <span data-ttu-id="7560b-119">**Interne**: Hallo API Management-gateway en developer-portal zijn alleen toegankelijk vanuit Hallo virtueel netwerk via een interne load balancer.</span><span class="sxs-lookup"><span data-stu-id="7560b-119">**Internal**: hello API Management gateway and developer portal are accessible only from within hello virtual network via an internal load balancer.</span></span> <span data-ttu-id="7560b-120">Hallo-gateway toegang tot bronnen in het virtuele netwerk Hallo.</span><span class="sxs-lookup"><span data-stu-id="7560b-120">hello gateway can access resources within hello virtual network.</span></span>

![Persoonlijke peering][api-management-vnet-private]

<span data-ttu-id="7560b-122">U ziet nu een lijst met alle regio's waar uw API Management-service is ingericht.</span><span class="sxs-lookup"><span data-stu-id="7560b-122">You will now see a list of all regions where your API Management service is provisioned.</span></span> <span data-ttu-id="7560b-123">Selecteer een VNET en een subnet voor elke regio.</span><span class="sxs-lookup"><span data-stu-id="7560b-123">Select a VNET and subnet for every region.</span></span> <span data-ttu-id="7560b-124">Hallo-lijst is gevuld met zowel klassieke als Resource Manager virtuele netwerken die beschikbaar zijn in uw Azure-abonnementen die zijn ingesteld in Hallo regio die u configureert.</span><span class="sxs-lookup"><span data-stu-id="7560b-124">hello list is populated with both classic and Resource Manager virtual networks available in your Azure subscriptions that are setup in hello region you are configuring.</span></span>

> [!NOTE]
> <span data-ttu-id="7560b-125">**Service-eindpunt** in Hallo hierboven diagram bevat Gateway of Proxy, Publicatieportal, Developer-Portal, GIT en Hallo Direct eindpunt.</span><span class="sxs-lookup"><span data-stu-id="7560b-125">**Service Endpoint** in hello above diagram includes Gateway/Proxy, Publisher Portal, Developer Portal, GIT, and hello Direct Management Endpoint.</span></span>
> <span data-ttu-id="7560b-126">**Eindpunt** in Hallo bovenstaande diagram wordt gehost op Hallo serviceconfiguratie toomanage via Azure portal en Powershell Hallo-eindpunt.</span><span class="sxs-lookup"><span data-stu-id="7560b-126">**Management Endpoint** in hello above diagram is hello endpoint hosted on hello service toomanage configuration via Azure portal and Powershell.</span></span>
> <span data-ttu-id="7560b-127">Ook, houd er rekening mee dat, hoewel Hallo diagram ziet u IP-adressen voor de verschillende API Management-service-eindpunten **alleen** reageert op de geconfigureerde hostnamen.</span><span class="sxs-lookup"><span data-stu-id="7560b-127">Also, note, that, even though, hello diagram shows IP Addresses for its various endpoints, API Management service **only** responds on its configured Hostnames.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="7560b-128">Bij het implementeren van een Azure API Management-exemplaar tooa Resource Manager VNET moet Hallo-service een toegewezen subnet dat geen andere resources, met uitzondering van exemplaren van Azure API Management bevat.</span><span class="sxs-lookup"><span data-stu-id="7560b-128">When deploying an Azure API Management instance tooa Resource Manager VNET, hello service must be in a dedicated subnet that contains no other resources except for Azure API Management instances.</span></span> <span data-ttu-id="7560b-129">Als wordt geprobeerd toodeploy mislukt een Azure API Management-exemplaar tooa Resource Manager VNET subnet met andere resources, het Hallo-implementatie.</span><span class="sxs-lookup"><span data-stu-id="7560b-129">If an attempt is made toodeploy an Azure API Management instance tooa Resource Manager VNET subnet that contains other resources, hello deployment will fail.</span></span>
>
>

![Selecteer VPN][api-management-setup-vpn-select]

<span data-ttu-id="7560b-131">Klik op **opslaan** Hallo boven aan het welkomstscherm.</span><span class="sxs-lookup"><span data-stu-id="7560b-131">Click **Save** at hello top of hello screen.</span></span>

> [!NOTE]
> <span data-ttu-id="7560b-132">Hallo VIP-adres van het exemplaar van API Management Hallo wordt gewijzigd wanneer VNET is ingeschakeld of uitgeschakeld.</span><span class="sxs-lookup"><span data-stu-id="7560b-132">hello VIP address of hello API Management instance will change each time VNET is enabled or disabled.</span></span>  
> <span data-ttu-id="7560b-133">Hallo VIP-adres, wijzigt u ook wanneer API Management wordt verplaatst van **externe** te**intern** of omgekeerd</span><span class="sxs-lookup"><span data-stu-id="7560b-133">hello VIP address will also change when API Management is moved from **External** too**Internal** or vice-versa</span></span>
>


> [!IMPORTANT]
> <span data-ttu-id="7560b-134">Als u API Management uit een VNET verwijderen of Hallo een die machine is geïmplementeerd in wijzigt, vergrendeld Hallo eerder gebruikte VNET kan blijven voor too4 uur.</span><span class="sxs-lookup"><span data-stu-id="7560b-134">If you remove API Management from a VNET or change hello one it is deployed in, hello previously used VNET can remain locked for up too4 hours.</span></span> <span data-ttu-id="7560b-135">Tijdens deze periode wordt het niet mogelijk toodelete hello VNET of een nieuwe resource tooit implementeren.</span><span class="sxs-lookup"><span data-stu-id="7560b-135">During this period it will not be possible toodelete hello VNET or deploy a new resource tooit.</span></span>

## <span data-ttu-id="7560b-136"><a name="enable-vnet-powershell"></a>Inschakelen VNET-verbinding met PowerShell-cmdlets</span><span class="sxs-lookup"><span data-stu-id="7560b-136"><a name="enable-vnet-powershell"> </a>Enable VNET connection using PowerShell cmdlets</span></span>
<span data-ttu-id="7560b-137">U kunt ook de VNET-connectiviteit met de PowerShell-cmdlets Hallo inschakelen</span><span class="sxs-lookup"><span data-stu-id="7560b-137">You can also enable VNET connectivity using hello PowerShell cmdlets</span></span>

* <span data-ttu-id="7560b-138">**Maak een API Management-service binnen een VNET**: Gebruik de cmdlet Hallo [nieuw AzureRmApiManagement](/powershell/module/azurerm.apimanagement/new-azurermapimanagement) toocreate binnen een VNET een Azure API Management-service.</span><span class="sxs-lookup"><span data-stu-id="7560b-138">**Create an API Management service inside a VNET**: Use hello cmdlet [New-AzureRmApiManagement](/powershell/module/azurerm.apimanagement/new-azurermapimanagement) toocreate an Azure API Management service inside a VNET.</span></span>

* <span data-ttu-id="7560b-139">**Implementeren van een bestaande API Management-service binnen een VNET**: Gebruik de cmdlet Hallo [Update AzureRmApiManagementDeployment](/powershell/module/azurerm.apimanagement/update-azurermapimanagementdeployment) toomove een bestaande Azure API Management-service in een virtueel netwerk.</span><span class="sxs-lookup"><span data-stu-id="7560b-139">**Deploy an existing API Management service inside a VNET**: Use hello cmdlet [Update-AzureRmApiManagementDeployment](/powershell/module/azurerm.apimanagement/update-azurermapimanagementdeployment) toomove an existing Azure API Management service inside a Virtual Network.</span></span>

## <span data-ttu-id="7560b-140"><a name="connect-vnet"></a>Tooa webservice die wordt gehost binnen een virtueel netwerk verbinding maken</span><span class="sxs-lookup"><span data-stu-id="7560b-140"><a name="connect-vnet"> </a>Connect tooa web service hosted within a virtual Network</span></span>
<span data-ttu-id="7560b-141">Nadat uw API Management-service verbonden toohello VNET is, gaat toegang tot services in het back-end niet anders zijn dan de toegang tot openbare services zijn.</span><span class="sxs-lookup"><span data-stu-id="7560b-141">After your API Management service is connected toohello VNET, accessing backend services within it is no different than accessing public services.</span></span> <span data-ttu-id="7560b-142">Typ in het Hallo lokale IP-adres of Hallo van hostnaam (als een DNS-server is geconfigureerd voor Hallo VNET) van uw web-service in Hallo **webservice-URL** veld bij het maken van een nieuwe API of een bestaande bewerkt.</span><span class="sxs-lookup"><span data-stu-id="7560b-142">Just type in hello local IP address or hello host name (if a DNS server is configured for hello VNET) of your web service into hello **Web service URL** field when creating a new API or editing an existing one.</span></span>

![API via VPN-netwerk toevoegen][api-management-setup-vpn-add-api]

## <span data-ttu-id="7560b-144"><a name="network-configuration-issues"></a>Algemene configuratie netwerkproblemen</span><span class="sxs-lookup"><span data-stu-id="7560b-144"><a name="network-configuration-issues"> </a>Common Network Configuration Issues</span></span>
<span data-ttu-id="7560b-145">Hier volgt een lijst met veelvoorkomende configuratiefouten die optreden kunnen tijdens het implementeren van API Management-service in een virtueel netwerk.</span><span class="sxs-lookup"><span data-stu-id="7560b-145">Following is a list of common misconfiguration issues that can occur while deploying API Management service into a Virtual Network.</span></span>

* <span data-ttu-id="7560b-146">**Aangepaste DNS-server setup**: Hallo API Management-service is afhankelijk van verschillende Azure-services.</span><span class="sxs-lookup"><span data-stu-id="7560b-146">**Custom DNS server setup**: hello API Management service depends on several Azure services.</span></span> <span data-ttu-id="7560b-147">Wanneer u API Management wordt gehost in een VNET met een aangepaste DNS-server, moet deze tooresolve Hallo hostnamen van deze Azure-services.</span><span class="sxs-lookup"><span data-stu-id="7560b-147">When API Management is hosted in a VNET with a custom DNS server, it needs tooresolve hello hostnames of those Azure services.</span></span> <span data-ttu-id="7560b-148">Volg [dit](../virtual-network/virtual-networks-name-resolution-for-vms-and-role-instances.md#name-resolution-using-your-own-dns-server) hulp bij het aangepaste DNS-instellingen.</span><span class="sxs-lookup"><span data-stu-id="7560b-148">Please follow [this](../virtual-network/virtual-networks-name-resolution-for-vms-and-role-instances.md#name-resolution-using-your-own-dns-server) guidance on custom DNS setup.</span></span> <span data-ttu-id="7560b-149">Zie Hallo poorten in de volgende tabel en andere netwerkvereisten ter referentie.</span><span class="sxs-lookup"><span data-stu-id="7560b-149">See hello ports table below and other network requirements for reference.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="7560b-150">Het verdient aanbeveling dat, als u van een aangepaste DNS-server (s) voor Hallo VNET gebruikmaakt, u dat instellen **voordat** een API Management-service implementeren in de App.</span><span class="sxs-lookup"><span data-stu-id="7560b-150">It is recommended that, if you are using a Custom DNS Server(s) for hello VNET, you set that up **before** deploying an API Management service into it.</span></span> <span data-ttu-id="7560b-151">Anders u nodig hebt te bijwerken Hallo API Management-service telkens wanneer u Hallo DNS-Servers (s wijzigt) door het uitvoeren van Hallo [netwerkbewerking configuratie toepassen](https://docs.microsoft.com/en-us/rest/api/apimanagement/apimanagementservice#ApiManagementService_ApplyNetworkConfigurationUpdates)</span><span class="sxs-lookup"><span data-stu-id="7560b-151">Otherwise you need too update hello API Management service each time you change hello DNS Servers(s) by running hello [Apply Network Configuration Operation](https://docs.microsoft.com/en-us/rest/api/apimanagement/apimanagementservice#ApiManagementService_ApplyNetworkConfigurationUpdates)</span></span>

* <span data-ttu-id="7560b-152">**Vereiste poorten voor API Management**: binnenkomend en uitgaand verkeer naar Hallo Subnet waarin API Management wordt geïmplementeerd, kan worden beheerd met behulp van [Netwerkbeveiligingsgroep][Network Security Group].</span><span class="sxs-lookup"><span data-stu-id="7560b-152">**Ports required for API Management**: Inbound and Outbound traffic into hello Subnet in which API Management is deployed can be controlled using [Network Security Group][Network Security Group].</span></span> <span data-ttu-id="7560b-153">Als een van deze poorten niet beschikbaar zijn, wordt API Management werkt mogelijk niet correct en kan ontoegankelijk worden.</span><span class="sxs-lookup"><span data-stu-id="7560b-153">If any of these ports are unavailable, API Management may not operate properly and may become inaccessible.</span></span> <span data-ttu-id="7560b-154">Met een of meer van deze poorten geblokkeerd is een andere veelvoorkomende onjuiste configuratie probleem wanneer u API Management met een VNET.</span><span class="sxs-lookup"><span data-stu-id="7560b-154">Having one or more of these ports blocked is another common misconfiguration issue when using API Management with a VNET.</span></span>

<span data-ttu-id="7560b-155">Wanneer een exemplaar van API Management-service wordt gehost in een VNET, worden Hallo-poorten in de volgende tabel hello gebruikt.</span><span class="sxs-lookup"><span data-stu-id="7560b-155">When an API Management service instance is hosted in a VNET, hello ports in hello following table are used.</span></span>

| <span data-ttu-id="7560b-156">Bron / bestemming poort(en)</span><span class="sxs-lookup"><span data-stu-id="7560b-156">Source / Destination Port(s)</span></span> | <span data-ttu-id="7560b-157">Richting</span><span class="sxs-lookup"><span data-stu-id="7560b-157">Direction</span></span> | <span data-ttu-id="7560b-158">Protocol-transport</span><span class="sxs-lookup"><span data-stu-id="7560b-158">Transport protocol</span></span> | <span data-ttu-id="7560b-159">Doel</span><span class="sxs-lookup"><span data-stu-id="7560b-159">Purpose</span></span> | <span data-ttu-id="7560b-160">Bron / doel</span><span class="sxs-lookup"><span data-stu-id="7560b-160">Source / Destination</span></span> | <span data-ttu-id="7560b-161">Toegangstype</span><span class="sxs-lookup"><span data-stu-id="7560b-161">Access type</span></span> |
| --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="7560b-162">* / 80, 443</span><span class="sxs-lookup"><span data-stu-id="7560b-162">* / 80, 443</span></span> |<span data-ttu-id="7560b-163">Inkomend</span><span class="sxs-lookup"><span data-stu-id="7560b-163">Inbound</span></span> |<span data-ttu-id="7560b-164">TCP</span><span class="sxs-lookup"><span data-stu-id="7560b-164">TCP</span></span> |<span data-ttu-id="7560b-165">Client communicatie tooAPI Management</span><span class="sxs-lookup"><span data-stu-id="7560b-165">Client communication tooAPI Management</span></span> |<span data-ttu-id="7560b-166">INTERNET / VIRTUAL_NETWORK</span><span class="sxs-lookup"><span data-stu-id="7560b-166">INTERNET / VIRTUAL_NETWORK</span></span> |<span data-ttu-id="7560b-167">Extern</span><span class="sxs-lookup"><span data-stu-id="7560b-167">External</span></span> |
| <span data-ttu-id="7560b-168">* / 3443</span><span class="sxs-lookup"><span data-stu-id="7560b-168">* / 3443</span></span> |<span data-ttu-id="7560b-169">Inkomend</span><span class="sxs-lookup"><span data-stu-id="7560b-169">Inbound</span></span> |<span data-ttu-id="7560b-170">TCP</span><span class="sxs-lookup"><span data-stu-id="7560b-170">TCP</span></span> |<span data-ttu-id="7560b-171">Eindpunt voor Azure-portal en Powershell</span><span class="sxs-lookup"><span data-stu-id="7560b-171">Management endpoint for Azure portal and Powershell</span></span> |<span data-ttu-id="7560b-172">INTERNET / VIRTUAL_NETWORK</span><span class="sxs-lookup"><span data-stu-id="7560b-172">INTERNET / VIRTUAL_NETWORK</span></span> |<span data-ttu-id="7560b-173">Externe & interne</span><span class="sxs-lookup"><span data-stu-id="7560b-173">External & Internal</span></span> |
| <span data-ttu-id="7560b-174">* / 80, 443</span><span class="sxs-lookup"><span data-stu-id="7560b-174">* / 80, 443</span></span> |<span data-ttu-id="7560b-175">Uitgaand</span><span class="sxs-lookup"><span data-stu-id="7560b-175">Outbound</span></span> |<span data-ttu-id="7560b-176">TCP</span><span class="sxs-lookup"><span data-stu-id="7560b-176">TCP</span></span> |<span data-ttu-id="7560b-177">Afhankelijkheid van Azure Storage en Azure Servicebus</span><span class="sxs-lookup"><span data-stu-id="7560b-177">Dependency on Azure Storage and Azure Service Bus</span></span> |<span data-ttu-id="7560b-178">VIRTUAL_NETWORK / INTERNET</span><span class="sxs-lookup"><span data-stu-id="7560b-178">VIRTUAL_NETWORK / INTERNET</span></span> |<span data-ttu-id="7560b-179">Externe & interne</span><span class="sxs-lookup"><span data-stu-id="7560b-179">External & Internal</span></span> |
| <span data-ttu-id="7560b-180">* / 1433</span><span class="sxs-lookup"><span data-stu-id="7560b-180">* / 1433</span></span> |<span data-ttu-id="7560b-181">Uitgaand</span><span class="sxs-lookup"><span data-stu-id="7560b-181">Outbound</span></span> |<span data-ttu-id="7560b-182">TCP</span><span class="sxs-lookup"><span data-stu-id="7560b-182">TCP</span></span> |<span data-ttu-id="7560b-183">Afhankelijkheid van Azure SQL</span><span class="sxs-lookup"><span data-stu-id="7560b-183">Dependency on Azure SQL</span></span> |<span data-ttu-id="7560b-184">VIRTUAL_NETWORK / INTERNET</span><span class="sxs-lookup"><span data-stu-id="7560b-184">VIRTUAL_NETWORK / INTERNET</span></span> |<span data-ttu-id="7560b-185">Externe & interne</span><span class="sxs-lookup"><span data-stu-id="7560b-185">External & Internal</span></span> |
| <span data-ttu-id="7560b-186">* / 11000 - 11999</span><span class="sxs-lookup"><span data-stu-id="7560b-186">* / 11000 - 11999</span></span> |<span data-ttu-id="7560b-187">Uitgaand</span><span class="sxs-lookup"><span data-stu-id="7560b-187">Outbound</span></span> |<span data-ttu-id="7560b-188">TCP</span><span class="sxs-lookup"><span data-stu-id="7560b-188">TCP</span></span> |<span data-ttu-id="7560b-189">Afhankelijkheid van V12 Azure SQL</span><span class="sxs-lookup"><span data-stu-id="7560b-189">Dependency on Azure SQL V12</span></span> |<span data-ttu-id="7560b-190">VIRTUAL_NETWORK / INTERNET</span><span class="sxs-lookup"><span data-stu-id="7560b-190">VIRTUAL_NETWORK / INTERNET</span></span> |<span data-ttu-id="7560b-191">Externe & interne</span><span class="sxs-lookup"><span data-stu-id="7560b-191">External & Internal</span></span> |
| <span data-ttu-id="7560b-192">* / 14000 - 14999</span><span class="sxs-lookup"><span data-stu-id="7560b-192">* / 14000 - 14999</span></span> |<span data-ttu-id="7560b-193">Uitgaand</span><span class="sxs-lookup"><span data-stu-id="7560b-193">Outbound</span></span> |<span data-ttu-id="7560b-194">TCP</span><span class="sxs-lookup"><span data-stu-id="7560b-194">TCP</span></span> |<span data-ttu-id="7560b-195">Afhankelijkheid van V12 Azure SQL</span><span class="sxs-lookup"><span data-stu-id="7560b-195">Dependency on Azure SQL V12</span></span> |<span data-ttu-id="7560b-196">VIRTUAL_NETWORK / INTERNET</span><span class="sxs-lookup"><span data-stu-id="7560b-196">VIRTUAL_NETWORK / INTERNET</span></span> |<span data-ttu-id="7560b-197">Externe & interne</span><span class="sxs-lookup"><span data-stu-id="7560b-197">External & Internal</span></span> |
| <span data-ttu-id="7560b-198">* / 5671</span><span class="sxs-lookup"><span data-stu-id="7560b-198">* / 5671</span></span> |<span data-ttu-id="7560b-199">Uitgaand</span><span class="sxs-lookup"><span data-stu-id="7560b-199">Outbound</span></span> |<span data-ttu-id="7560b-200">AMQP</span><span class="sxs-lookup"><span data-stu-id="7560b-200">AMQP</span></span> |<span data-ttu-id="7560b-201">Afhankelijkheid van logboek tooEvent Hub beleid en bewakingsagent</span><span class="sxs-lookup"><span data-stu-id="7560b-201">Dependency for Log tooEvent Hub policy and monitoring agent</span></span> |<span data-ttu-id="7560b-202">VIRTUAL_NETWORK / INTERNET</span><span class="sxs-lookup"><span data-stu-id="7560b-202">VIRTUAL_NETWORK / INTERNET</span></span> |<span data-ttu-id="7560b-203">Externe & interne</span><span class="sxs-lookup"><span data-stu-id="7560b-203">External & Internal</span></span> |
| <span data-ttu-id="7560b-204">6381 - 6383 / 6381 - 6383</span><span class="sxs-lookup"><span data-stu-id="7560b-204">6381 - 6383 / 6381 - 6383</span></span> |<span data-ttu-id="7560b-205">Binnenkomend en uitgaand</span><span class="sxs-lookup"><span data-stu-id="7560b-205">Inbound & Outbound</span></span> |<span data-ttu-id="7560b-206">UDP</span><span class="sxs-lookup"><span data-stu-id="7560b-206">UDP</span></span> |<span data-ttu-id="7560b-207">Afhankelijkheid van Redis-Cache</span><span class="sxs-lookup"><span data-stu-id="7560b-207">Dependency on Redis Cache</span></span> |<span data-ttu-id="7560b-208">VIRTUAL_NETWORK / VIRTUAL_NETWORK</span><span class="sxs-lookup"><span data-stu-id="7560b-208">VIRTUAL_NETWORK / VIRTUAL_NETWORK</span></span> |<span data-ttu-id="7560b-209">Externe & interne</span><span class="sxs-lookup"><span data-stu-id="7560b-209">External & Internal</span></span> |-
| <span data-ttu-id="7560b-210">* / 445</span><span class="sxs-lookup"><span data-stu-id="7560b-210">* / 445</span></span> |<span data-ttu-id="7560b-211">Uitgaand</span><span class="sxs-lookup"><span data-stu-id="7560b-211">Outbound</span></span> |<span data-ttu-id="7560b-212">TCP</span><span class="sxs-lookup"><span data-stu-id="7560b-212">TCP</span></span> |<span data-ttu-id="7560b-213">Afhankelijkheid van Azure-bestandsshare voor GIT</span><span class="sxs-lookup"><span data-stu-id="7560b-213">Dependency on Azure File Share for GIT</span></span> |<span data-ttu-id="7560b-214">VIRTUAL_NETWORK / INTERNET</span><span class="sxs-lookup"><span data-stu-id="7560b-214">VIRTUAL_NETWORK / INTERNET</span></span> |<span data-ttu-id="7560b-215">Externe & interne</span><span class="sxs-lookup"><span data-stu-id="7560b-215">External & Internal</span></span> |
| <span data-ttu-id="7560b-216">* / *</span><span class="sxs-lookup"><span data-stu-id="7560b-216">* / *</span></span> | <span data-ttu-id="7560b-217">Inkomend</span><span class="sxs-lookup"><span data-stu-id="7560b-217">Inbound</span></span> |<span data-ttu-id="7560b-218">TCP</span><span class="sxs-lookup"><span data-stu-id="7560b-218">TCP</span></span> |<span data-ttu-id="7560b-219">Azure-infrastructuur Load Balancer</span><span class="sxs-lookup"><span data-stu-id="7560b-219">Azure Infrastructure Load Balancer</span></span> | <span data-ttu-id="7560b-220">AZURE_LOAD_BALANCER / VIRTUAL_NETWORK</span><span class="sxs-lookup"><span data-stu-id="7560b-220">AZURE_LOAD_BALANCER / VIRTUAL_NETWORK</span></span> |<span data-ttu-id="7560b-221">Externe & interne</span><span class="sxs-lookup"><span data-stu-id="7560b-221">External & Internal</span></span> |

* <span data-ttu-id="7560b-222">**SSL-functionaliteit**: tooenable keten gebouw en validatie Hallo API Management-service moet uitgaande network connectivity tooocsp.msocsp.com, mscrl.microsoft.com en crl.microsoft.com SSL-certificaat. Deze afhankelijkheid is niet vereist, als een certificaat dat u uploadt tooAPI Management Hallo volledige keten toohello CA hoofdmap bevatten.</span><span class="sxs-lookup"><span data-stu-id="7560b-222">**SSL functionality**: tooenable SSL certificate chain building and validation hello API Management service needs Outbound network connectivity tooocsp.msocsp.com, mscrl.microsoft.com and crl.microsoft.com. This dependency is not required, if any certificate you upload tooAPI Management contain hello full chain toohello CA root.</span></span>

* <span data-ttu-id="7560b-223">**DNS-toegang**: uitgaand verkeer op poort 53 is vereist voor communicatie met de DNS-servers.</span><span class="sxs-lookup"><span data-stu-id="7560b-223">**DNS Access**: Outbound access on port 53 is required for communication with DNS servers.</span></span> <span data-ttu-id="7560b-224">Als u een aangepaste DNS-server bestaat op Hallo van andere einde van een VPN-gateway, Hallo DNS-server moet bereikbaar zijn vanaf Hallo subnet die als host fungeert voor API Management.</span><span class="sxs-lookup"><span data-stu-id="7560b-224">If a custom DNS server exists on hello other end of a VPN gateway, hello DNS server must be reachable from hello subnet hosting API Management.</span></span>

* <span data-ttu-id="7560b-225">**Metrische gegevens en statuscontrole**: uitgaande netwerk connectiviteit tooAzure controle-eindpunten die onder de volgende domeinen Hallo oplossen: global.metrics.nsatc.net, shoebox2.metrics.nsatc.net, prod3.metrics.nsatc.net.</span><span class="sxs-lookup"><span data-stu-id="7560b-225">**Metrics and Health Monitoring**: Outbound network connectivity tooAzure Monitoring endpoints, which resolve under hello following domains: global.metrics.nsatc.net, shoebox2.metrics.nsatc.net, prod3.metrics.nsatc.net.</span></span>

* <span data-ttu-id="7560b-226">**Express Route-instelling**: een algemene configuratie van de klant toodefine hun eigen standaardroute (0.0.0.0/0), waardoor uitgaande Internet verkeer tooinstead stroom lokaal is.</span><span class="sxs-lookup"><span data-stu-id="7560b-226">**Express Route Setup**: A common customer configuration is toodefine their own default route (0.0.0.0/0) which forces outbound Internet traffic tooinstead flow on-premises.</span></span> <span data-ttu-id="7560b-227">Dit netwerkverkeer altijd verbinding met Azure API Management wordt verbroken omdat er Hallo uitgaand verkeer wordt geblokkeerd on-premises of NAT'd tooan onherkenbare set adressen die niet langer met verschillende Azure-eindpunten werken.</span><span class="sxs-lookup"><span data-stu-id="7560b-227">This traffic flow invariably breaks connectivity with Azure API Management because hello outbound traffic is either blocked on-premises, or NAT'd tooan unrecognizable set of addresses that no longer work with various Azure endpoints.</span></span> <span data-ttu-id="7560b-228">Hallo-oplossing is de gebruiker gedefinieerde routes toodefine er (of meer) ([udr's][UDRs]) op Hallo subnet met hello Azure API Management.</span><span class="sxs-lookup"><span data-stu-id="7560b-228">hello solution is toodefine one (or more) user-defined routes ([UDRs][UDRs]) on hello subnet that contains hello Azure API Management.</span></span> <span data-ttu-id="7560b-229">Een UDR definieert subnet-specifieke routes die in plaats van de standaardroute Hallo gehonoreerd.</span><span class="sxs-lookup"><span data-stu-id="7560b-229">A UDR defines subnet-specific routes that will be honored instead of hello default route.</span></span>
  <span data-ttu-id="7560b-230">Indien mogelijk, wordt aangeraden toouse Hallo volgende configuratie:</span><span class="sxs-lookup"><span data-stu-id="7560b-230">If possible, it is recommended toouse hello following configuration:</span></span>
 * <span data-ttu-id="7560b-231">Hallo ExpressRoute configuratie kondigt 0.0.0.0/0 en standaard force alle uitgaande verkeer lokale tunnels.</span><span class="sxs-lookup"><span data-stu-id="7560b-231">hello ExpressRoute configuration advertises 0.0.0.0/0 and by default force tunnels all outbound traffic on-premises.</span></span>
 * <span data-ttu-id="7560b-232">Hallo UDR toegepast toohello subnet met hello Azure API Management definieert 0.0.0.0/0 met een volgend hoptype van Internet.</span><span class="sxs-lookup"><span data-stu-id="7560b-232">hello UDR applied toohello subnet containing hello Azure API Management defines 0.0.0.0/0 with a next hop type of Internet.</span></span>
 <span data-ttu-id="7560b-233">Hallo is gecombineerde effect van deze stappen dat Hallo subnetniveau UDR voorrang hebben op Hallo ExpressRoute geforceerde tunneling, zodat uitgaande toegang tot Internet vanaf hello Azure API Management.</span><span class="sxs-lookup"><span data-stu-id="7560b-233">hello combined effect of these steps is that hello subnet level UDR takes precedence over hello ExpressRoute forced tunneling, thus ensuring outbound Internet access from hello Azure API Management.</span></span>

>[!WARNING]  
><span data-ttu-id="7560b-234">Azure API Management wordt niet ondersteund met ExpressRoute-configuraties die **onjuist cross-adverteert routes van Hallo pad toohello persoonlijke peering pad voor openbare peering**.</span><span class="sxs-lookup"><span data-stu-id="7560b-234">Azure API Management is not supported with ExpressRoute configurations that **incorrectly cross-advertise routes from hello public peering path toohello private peering path**.</span></span> <span data-ttu-id="7560b-235">ExpressRoute-configuraties waarvoor openbare peering is geconfigureerd, ontvangen route-advertisements van Microsoft voor een groot aantal Microsoft Azure-IP-adresbereiken.</span><span class="sxs-lookup"><span data-stu-id="7560b-235">ExpressRoute configurations that have public peering configured, will receive route advertisements from Microsoft for a large set of Microsoft Azure IP address ranges.</span></span> <span data-ttu-id="7560b-236">Als deze adresbereiken onjuist cross aangekondigd op Hallo-pad voor persoonlijke peering, is Hallo eindresultaat dat alle uitgaande pakketten van subnet hello Azure API Management exemplaar van de klant ten onrechte force via een tunnel tooa on-premises netwerk infrastructuur.</span><span class="sxs-lookup"><span data-stu-id="7560b-236">If these address ranges are incorrectly cross-advertised on hello private peering path, hello end result is that all outbound network packets from hello Azure API Management instance's subnet are incorrectly force-tunneled tooa customer's on-premises network infrastructure.</span></span> <span data-ttu-id="7560b-237">Deze stroom van het netwerk verbreekt Azure API Management.</span><span class="sxs-lookup"><span data-stu-id="7560b-237">This network flow breaks Azure API Management.</span></span> <span data-ttu-id="7560b-238">Hallo oplossing toothis probleem is toostop cross-adverteert routes van Hallo pad toohello persoonlijke peering pad voor openbare peering.</span><span class="sxs-lookup"><span data-stu-id="7560b-238">hello solution toothis problem is toostop cross-advertising routes from hello public peering path toohello private peering path.</span></span>


## <span data-ttu-id="7560b-239"><a name="troubleshooting"></a>Probleemoplossing</span><span class="sxs-lookup"><span data-stu-id="7560b-239"><a name="troubleshooting"> </a>Troubleshooting</span></span>
<span data-ttu-id="7560b-240">Bij het doorvoeren van wijzigingen tooyour netwerk te verwijzen[NetworkStatus API](https://docs.microsoft.com/en-us/rest/api/apimanagement/networkstatus), toovalidate als Hallo API Management-service niet verloren gegaan toegang tooany Hallo kritieke bronnen die dit is afhankelijk van.</span><span class="sxs-lookup"><span data-stu-id="7560b-240">When making changes tooyour network, refer too[NetworkStatus API](https://docs.microsoft.com/en-us/rest/api/apimanagement/networkstatus), toovalidate if hello API Management service has not lost access tooany of hello critical resources which it depends upon.</span></span> <span data-ttu-id="7560b-241">de verbindingsstatus Hallo moet worden bijgewerkt om de 15 minuten.</span><span class="sxs-lookup"><span data-stu-id="7560b-241">hello connectivity status should be updated every 15 minutes.</span></span>

## <span data-ttu-id="7560b-242"><a name="limitations"></a>Beperkingen</span><span class="sxs-lookup"><span data-stu-id="7560b-242"><a name="limitations"> </a>Limitations</span></span>
* <span data-ttu-id="7560b-243">Een subnet met exemplaren van API Management kan geen andere Azure-brontypen bevatten.</span><span class="sxs-lookup"><span data-stu-id="7560b-243">A subnet containing API Management instances cannot contain any other Azure resource types.</span></span>
* <span data-ttu-id="7560b-244">Hallo-subnet en Hallo API Management-service moet zijn in Hallo hetzelfde abonnement.</span><span class="sxs-lookup"><span data-stu-id="7560b-244">hello subnet and hello API Management service must be in hello same subscription.</span></span>
* <span data-ttu-id="7560b-245">Een subnet met exemplaren van API Management kan niet worden verplaatst tussen abonnementen.</span><span class="sxs-lookup"><span data-stu-id="7560b-245">A subnet containing API Management instances cannot be moved across subscriptions.</span></span>
* <span data-ttu-id="7560b-246">Wanneer u een intern virtueel netwerk alleen een interne IP-adres beschikbaar is via Hallo bereik vermeld in de [RFC 1918](https://tools.ietf.org/html/rfc1918), een openbare IP-adres kan niet worden opgegeven.</span><span class="sxs-lookup"><span data-stu-id="7560b-246">When using an internal virtual network, only an internal IP address will be available from hello range stated in [RFC 1918](https://tools.ietf.org/html/rfc1918), a public IP address cannot be provided.</span></span>
* <span data-ttu-id="7560b-247">Voor meerdere landen/regio API Management-implementaties zijn met interne virtuele netwerken die zijn geconfigureerd, gebruikers verantwoordelijk voor het beheren van hun eigen taakverdeling als eigenaar van Hallo DNS.</span><span class="sxs-lookup"><span data-stu-id="7560b-247">For multi-region API Management deployments, with Internal virtual networks configured, users are responsible for managing their own load balancing as they own hello DNS.</span></span>


## <span data-ttu-id="7560b-248"><a name="related-content"></a>Verwante inhoud</span><span class="sxs-lookup"><span data-stu-id="7560b-248"><a name="related-content"> </a>Related content</span></span>
* [<span data-ttu-id="7560b-249">Verbinding maken met een virtueel netwerk toobackend met behulp van VPN-Gateway</span><span class="sxs-lookup"><span data-stu-id="7560b-249">Connecting a Virtual Network toobackend using Vpn Gateway</span></span>](../vpn-gateway/vpn-gateway-about-vpngateways.md#s2smulti)
* [<span data-ttu-id="7560b-250">Verbinding maken met een virtueel netwerk vanuit verschillende implementatiemodellen</span><span class="sxs-lookup"><span data-stu-id="7560b-250">Connecting a Virtual Network from different deployment models</span></span>](../vpn-gateway/vpn-gateway-connect-different-deployment-models-powershell.md)
* [<span data-ttu-id="7560b-251">Hoe toouse Hallo API Inspector tootrace aanroept in Azure API Management</span><span class="sxs-lookup"><span data-stu-id="7560b-251">How toouse hello API Inspector tootrace calls in Azure API Management</span></span>](api-management-howto-api-inspector.md)

[api-management-using-vnet-menu]: ./media/api-management-using-with-vnet/api-management-menu-vnet.png
[api-management-setup-vpn-select]: ./media/api-management-using-with-vnet/api-management-using-vnet-type.png
[api-management-setup-vpn-select]: ./media/api-management-using-with-vnet/api-management-using-vnet-select.png
[api-management-setup-vpn-add-api]: ./media/api-management-using-with-vnet/api-management-using-vnet-add-api.png
[api-management-vnet-private]: ./media/api-management-using-with-vnet/api-management-vnet-private.png
[api-management-vnet-public]: ./media/api-management-using-with-vnet/api-management-vnet-public.png

[Enable VPN connections]: #enable-vpn
[Connect tooa web service behind VPN]: #connect-vpn
[Related content]: #related-content

[UDRs]: ../virtual-network/virtual-networks-udr-overview.md
[Network Security Group]: ../virtual-network/virtual-networks-nsg.md
