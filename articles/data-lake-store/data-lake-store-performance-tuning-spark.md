---
title: Azure Data Lake Store Spark prestaties afstemmen richtlijnen | Microsoft Docs
description: Azure Data Lake Store Spark prestaties afstemmen richtlijnen
services: data-lake-store
documentationcenter: 
author: stewu
manager: amitkul
editor: stewu
ms.assetid: ebde7b9f-2e51-4d43-b7ab-566417221335
ms.service: data-lake-store
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: big-data
ms.date: 12/19/2016
ms.author: stewu
ms.openlocfilehash: 2109744fb7ffdfafb7a86bbea355e119718af099
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 07/11/2017
---
# <a name="performance-tuning-guidance-for-spark-on-hdinsight-and-azure-data-lake-store"></a><span data-ttu-id="fab85-103">Prestaties afstemmen richtlijnen voor Spark in HDInsight en Azure Data Lake Store</span><span class="sxs-lookup"><span data-stu-id="fab85-103">Performance tuning guidance for Spark on HDInsight and Azure Data Lake Store</span></span>

<span data-ttu-id="fab85-104">Wanneer op de prestaties van Spark afstemmen, moet u rekening houden met het nummer van apps die wordt uitgevoerd op uw cluster.</span><span class="sxs-lookup"><span data-stu-id="fab85-104">When tuning performance on Spark, you need to consider the number of apps that will be running on your cluster.</span></span>  <span data-ttu-id="fab85-105">Standaard kunt u 4 uitvoeren apps gelijktijdig op uw HDI-cluster (Opmerking: de standaardinstelling kan worden gewijzigd).</span><span class="sxs-lookup"><span data-stu-id="fab85-105">By default, you can run 4 apps concurrently on your HDI cluster (Note: the default setting is subject to change).</span></span>  <span data-ttu-id="fab85-106">U kunt besluiten te minder apps gebruiken, zodat u kunt de standaardinstellingen negeren en meer van het cluster te voor deze apps gebruiken.</span><span class="sxs-lookup"><span data-stu-id="fab85-106">You may decide to use fewer apps so you can override the default settings and use more of the cluster for those apps.</span></span>  

## <a name="prerequisites"></a><span data-ttu-id="fab85-107">Vereisten</span><span class="sxs-lookup"><span data-stu-id="fab85-107">Prerequisites</span></span>

* <span data-ttu-id="fab85-108">**Een Azure-abonnement**.</span><span class="sxs-lookup"><span data-stu-id="fab85-108">**An Azure subscription**.</span></span> <span data-ttu-id="fab85-109">Zie [Gratis proefversie van Azure ophalen](https://azure.microsoft.com/pricing/free-trial/).</span><span class="sxs-lookup"><span data-stu-id="fab85-109">See [Get Azure free trial](https://azure.microsoft.com/pricing/free-trial/).</span></span>
* <span data-ttu-id="fab85-110">**Een Azure Data Lake Store-account**.</span><span class="sxs-lookup"><span data-stu-id="fab85-110">**An Azure Data Lake Store account**.</span></span> <span data-ttu-id="fab85-111">Zie voor instructies over het maken van een [aan de slag met Azure Data Lake Store](data-lake-store-get-started-portal.md)</span><span class="sxs-lookup"><span data-stu-id="fab85-111">For instructions on how to create one, see [Get started with Azure Data Lake Store](data-lake-store-get-started-portal.md)</span></span>
* <span data-ttu-id="fab85-112">**Azure HDInsight-cluster** met toegang tot een Data Lake Store-account.</span><span class="sxs-lookup"><span data-stu-id="fab85-112">**Azure HDInsight cluster** with access to a Data Lake Store account.</span></span> <span data-ttu-id="fab85-113">Zie [een HDInsight-cluster maken met Data Lake Store](data-lake-store-hdinsight-hadoop-use-portal.md).</span><span class="sxs-lookup"><span data-stu-id="fab85-113">See [Create an HDInsight cluster with Data Lake Store](data-lake-store-hdinsight-hadoop-use-portal.md).</span></span> <span data-ttu-id="fab85-114">Zorg ervoor dat u extern bureaublad inschakelen voor het cluster.</span><span class="sxs-lookup"><span data-stu-id="fab85-114">Make sure you enable Remote Desktop for the cluster.</span></span>
* <span data-ttu-id="fab85-115">**Spark-cluster uitgevoerd op Azure Data Lake Store**.</span><span class="sxs-lookup"><span data-stu-id="fab85-115">**Running Spark cluster on Azure Data Lake Store**.</span></span>  <span data-ttu-id="fab85-116">Zie voor meer informatie [gebruik HDInsight Spark-cluster voor het analyseren van gegevens in Data Lake Store](https://docs.microsoft.com/en-us/azure/hdinsight/hdinsight-apache-spark-use-with-data-lake-store)</span><span class="sxs-lookup"><span data-stu-id="fab85-116">For more information, see [Use HDInsight Spark cluster to analyze data in Data Lake Store](https://docs.microsoft.com/en-us/azure/hdinsight/hdinsight-apache-spark-use-with-data-lake-store)</span></span>
* <span data-ttu-id="fab85-117">**Prestaties afstemmen richtlijnen op ADLS**.</span><span class="sxs-lookup"><span data-stu-id="fab85-117">**Performance tuning guidelines on ADLS**.</span></span>  <span data-ttu-id="fab85-118">Raadpleeg voor algemene prestaties concepten, [Data Lake Store prestaties afstemmen richtlijnen](https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-performance-tuning-guidance)</span><span class="sxs-lookup"><span data-stu-id="fab85-118">For general performance concepts, see [Data Lake Store Performance Tuning Guidance](https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-performance-tuning-guidance)</span></span> 

## <a name="parameters"></a><span data-ttu-id="fab85-119">Parameters</span><span class="sxs-lookup"><span data-stu-id="fab85-119">Parameters</span></span>

<span data-ttu-id="fab85-120">Wanneer Spark van taken wordt uitgevoerd, moet u hier de belangrijkste instellingen die kunnen worden afgestemd om sneller worden ADLS zijn:</span><span class="sxs-lookup"><span data-stu-id="fab85-120">When running Spark jobs, here are the most important settings that can be tuned to increase performance on ADLS:</span></span>

* <span data-ttu-id="fab85-121">**NUM Executor** -het aantal gelijktijdige taken die kunnen worden uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="fab85-121">**Num-executors** - The number of concurrent tasks that can be executed.</span></span>

* <span data-ttu-id="fab85-122">**Executor geheugen** -de hoeveelheid geheugen die aan elke executor toegewezen.</span><span class="sxs-lookup"><span data-stu-id="fab85-122">**Executor-memory** - The amount of memory allocated to each executor.</span></span>

* <span data-ttu-id="fab85-123">**Executor kernen** -het aantal kernen dat is toegewezen aan elke executor.</span><span class="sxs-lookup"><span data-stu-id="fab85-123">**Executor-cores** - The number of cores allocated to each executor.</span></span>                     

<span data-ttu-id="fab85-124">**NUM Executor** Num Executor stelt u het maximum aantal taken dat parallel kan worden uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="fab85-124">**Num-executors** Num-executors will set the maximum number of tasks that can run in parallel.</span></span>  <span data-ttu-id="fab85-125">Het werkelijke aantal taken dat parallel kan worden uitgevoerd, wordt begrensd door het geheugen en CPU-resources in uw cluster.</span><span class="sxs-lookup"><span data-stu-id="fab85-125">The actual number of tasks that can run in parallel is bounded by the memory and CPU resources available in your cluster.</span></span>

<span data-ttu-id="fab85-126">**Executor geheugen** dit is de hoeveelheid geheugen die aan elke executor wordt wordt toegewezen.</span><span class="sxs-lookup"><span data-stu-id="fab85-126">**Executor-memory** This is the amount of memory that is being allocated to each executor.</span></span>  <span data-ttu-id="fab85-127">De hoeveelheid geheugen die nodig zijn voor elke executor is afhankelijk van de taak.</span><span class="sxs-lookup"><span data-stu-id="fab85-127">The memory needed for each executor is dependent on the job.</span></span>  <span data-ttu-id="fab85-128">Voor complexe bewerkingen moet het geheugen hoger zijn.</span><span class="sxs-lookup"><span data-stu-id="fab85-128">For complex operations, the memory needs to be higher.</span></span>  <span data-ttu-id="fab85-129">Voor eenvoudige bewerkingen zoals lezen en schrijven geheugenvereisten niet lager zijn.</span><span class="sxs-lookup"><span data-stu-id="fab85-129">For simple operations like read and write, memory requirements will be lower.</span></span>  <span data-ttu-id="fab85-130">De hoeveelheid geheugen voor elke executor kan worden weergegeven in de Ambari.</span><span class="sxs-lookup"><span data-stu-id="fab85-130">The amount of memory for each executor can be viewed in Ambari.</span></span>  <span data-ttu-id="fab85-131">In de Ambari, gaat u naar Spark en Raadpleeg het tabblad Configs.</span><span class="sxs-lookup"><span data-stu-id="fab85-131">In Ambari, navigate to Spark and view the Configs tab.</span></span>  

<span data-ttu-id="fab85-132">**Executor kernen** Hiermee stelt u het aantal kernen per executor die bepaalt het aantal parallelle threads dat kan worden uitgevoerd per executor gebruikt.</span><span class="sxs-lookup"><span data-stu-id="fab85-132">**Executor-cores** This sets the amount of cores used per executor, which determines the number of parallel threads that can be run per executor.</span></span>  <span data-ttu-id="fab85-133">Bijvoorbeeld, als executor kernen = 2, en vervolgens elk executor 2 parallelle taken in de executor kan worden uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="fab85-133">For example, if executor-cores = 2, then each executor can run 2 parallel tasks in the executor.</span></span>  <span data-ttu-id="fab85-134">Het executor-kernen nodig zijn afhankelijk van de taak.</span><span class="sxs-lookup"><span data-stu-id="fab85-134">The executor-cores needed will be dependent on the job.</span></span>  <span data-ttu-id="fab85-135">I/o-intensief taken hoeven niet een grote hoeveelheid geheugen per taak, zodat elke executor meer parallelle taken kan verwerken.</span><span class="sxs-lookup"><span data-stu-id="fab85-135">I/O heavy jobs do not require a large amount of memory per task so each executor can handle more parallel tasks.</span></span>

<span data-ttu-id="fab85-136">Standaard worden twee virtuele YARN cores gedefinieerd voor elke fysieke kernen bij het uitvoeren van Spark in HDInsight.</span><span class="sxs-lookup"><span data-stu-id="fab85-136">By default, two virtual YARN cores are defined for each physical core when running Spark on HDInsight.</span></span>  <span data-ttu-id="fab85-137">Dit nummer biedt een goede balans van concurrecy en hoeveelheid context overschakelen vanuit meerdere threads.</span><span class="sxs-lookup"><span data-stu-id="fab85-137">This number provides a good balance of concurrecy and amount of context switching from multiple threads.</span></span>  

## <a name="guidance"></a><span data-ttu-id="fab85-138">Richtlijnen</span><span class="sxs-lookup"><span data-stu-id="fab85-138">Guidance</span></span>

<span data-ttu-id="fab85-139">Tijdens het uitvoeren van Spark analytische workloads werken met gegevens in Data Lake Store, is het raadzaam dat u de meest recente versie van de HDInsight gebruiken om op te halen van de beste prestaties met Data Lake Store.</span><span class="sxs-lookup"><span data-stu-id="fab85-139">While running Spark analytic workloads to work with data in Data Lake Store, we recommend that you use the most recent HDInsight version to get the best performance with Data Lake Store.</span></span> <span data-ttu-id="fab85-140">Wanneer de taak meer i/o-intensieve is, kunnen bepaalde parameters worden geconfigureerd om prestaties te verbeteren.</span><span class="sxs-lookup"><span data-stu-id="fab85-140">When your job is more I/O intensive, then certain parameters can be configured to improve performance.</span></span>  <span data-ttu-id="fab85-141">Azure Data Lake Store is een uiterst schaalbare opslag platform dat maximale doorvoer kan verwerken.</span><span class="sxs-lookup"><span data-stu-id="fab85-141">Azure Data Lake Store is a highly scalable storage platform that can handle high throughput.</span></span>  <span data-ttu-id="fab85-142">Als de taak hoofdzakelijk uit lees- of schrijfbewerkingen bestaat, kan vervolgens gelijktijdigheid van taken voor i/o en naar Azure Data Lake Store vergroot, prestaties.</span><span class="sxs-lookup"><span data-stu-id="fab85-142">If the job mainly consists of read or writes, then increasing concurrency for I/O to and from Azure Data Lake Store could increase performance.</span></span>

<span data-ttu-id="fab85-143">Er zijn enkele algemene manieren om te verhogen gelijktijdigheid van taken voor i/o-intensieve taken.</span><span class="sxs-lookup"><span data-stu-id="fab85-143">There are a few general ways to increase concurrency for I/O intensive jobs.</span></span>

<span data-ttu-id="fab85-144">**Stap 1: Bepalen hoeveel apps worden uitgevoerd op uw cluster** – u moet weten hoe veel apps worden uitgevoerd op het cluster met inbegrip van het huidige proces.</span><span class="sxs-lookup"><span data-stu-id="fab85-144">**Step 1: Determine how many apps are running on your cluster** – You should know how many apps are running on the cluster including the current one.</span></span>  <span data-ttu-id="fab85-145">De standaardwaarden voor elke Spark instelling wordt ervan uitgegaan dat er 4 apps tegelijkertijd worden uitgevoerd.</span><span class="sxs-lookup"><span data-stu-id="fab85-145">The default values for each Spark setting assumes that there are 4 apps running concurrently.</span></span>  <span data-ttu-id="fab85-146">Daarom hebt u alleen 25% van het cluster die beschikbaar zijn voor elke app.</span><span class="sxs-lookup"><span data-stu-id="fab85-146">Therefore, you will only have 25% of the cluster available for each app.</span></span>  <span data-ttu-id="fab85-147">Als u betere prestaties, kunt u de standaardwaarden overschrijven door het aantal Executor te wijzigen.</span><span class="sxs-lookup"><span data-stu-id="fab85-147">To get better performance, you can override the defaults by changing the number of executors.</span></span>  

<span data-ttu-id="fab85-148">**Stap 2: Stel executor geheugen** – het eerste wat in te stellen, is het executor-geheugen.</span><span class="sxs-lookup"><span data-stu-id="fab85-148">**Step 2: Set executor-memory** – the first thing to set is the executor-memory.</span></span>  <span data-ttu-id="fab85-149">Het geheugen zijn afhankelijk van de taak die u wilt uitvoeren.</span><span class="sxs-lookup"><span data-stu-id="fab85-149">The memory will be dependent on the job that you are going to run.</span></span>  <span data-ttu-id="fab85-150">U kunt gelijktijdigheid vergroten door minder geheugen per executor toewijzen.</span><span class="sxs-lookup"><span data-stu-id="fab85-150">You can increase concurrency by allocating less memory per executor.</span></span>  <span data-ttu-id="fab85-151">Als u buiten geheugen uitzonderingen ziet wanneer u uw taak uitvoert, moet u de waarde voor deze parameter verhogen.</span><span class="sxs-lookup"><span data-stu-id="fab85-151">If you see out of memory exceptions when you run your job, then you should increase the value for this parameter.</span></span>  <span data-ttu-id="fab85-152">Een alternatief is om op te halen van meer geheugen met behulp van een cluster met hogere hoeveelheden geheugen of het vergroten van het cluster.</span><span class="sxs-lookup"><span data-stu-id="fab85-152">One alternative is to get more memory by using a cluster that has higher amounts of memory or increasing the size of your cluster.</span></span>  <span data-ttu-id="fab85-153">Meer geheugen toe te voegen meer Executor moet worden gebruikt, wat betekent dat meer gelijktijdigheid van taken.</span><span class="sxs-lookup"><span data-stu-id="fab85-153">More memory will enable more executors to be used, which means more concurrency.</span></span>

<span data-ttu-id="fab85-154">**Stap 3: Stel executor kernen** – voor i/o-intensieve werkbelastingen die geen complexe bewerkingen, is het raadzaam om te beginnen met een groot aantal executor-kernen om het aantal parallelle taken per executor te vergroten.</span><span class="sxs-lookup"><span data-stu-id="fab85-154">**Step 3: Set executor-cores** – For I/O intensive workloads that do not have complex operations, it’s good to start with a high number of executor-cores to increase the number of parallel tasks per executor.</span></span>  <span data-ttu-id="fab85-155">Executor kernen instelt op 4, is een goede start.</span><span class="sxs-lookup"><span data-stu-id="fab85-155">Setting executor-cores to 4 is a good start.</span></span>   

    executor-cores = 4
<span data-ttu-id="fab85-156">Het aantal executor kernen krijgt u meer parallelle uitvoering zodat u met verschillende executor-kernen experimenteren kunt.</span><span class="sxs-lookup"><span data-stu-id="fab85-156">Increasing the number of executor-cores will give you more parallelism so you can experiment with different executor-cores.</span></span>  <span data-ttu-id="fab85-157">Voor taken die u meer complexe bewerkingen hebt, moet u het aantal kernen per executor verminderen.</span><span class="sxs-lookup"><span data-stu-id="fab85-157">For jobs that have more complex operations, you should reduce the number of cores per executor.</span></span>  <span data-ttu-id="fab85-158">Als executor kernen kan hoger zijn dan 4, vervolgens garbagecollection inefficiënt en de prestaties nadelig beïnvloeden.</span><span class="sxs-lookup"><span data-stu-id="fab85-158">If executor-cores is set higher than 4, then garbage collection may become inefficient and degrade performance.</span></span>

<span data-ttu-id="fab85-159">**Stap 4: YARN-geheugen van de cluster bepalen** – deze informatie is beschikbaar in Ambari.</span><span class="sxs-lookup"><span data-stu-id="fab85-159">**Step 4: Determine amount of YARN memory in cluster** – This information is available in Ambari.</span></span>  <span data-ttu-id="fab85-160">Navigeer naar YARN en Raadpleeg het tabblad Configs.</span><span class="sxs-lookup"><span data-stu-id="fab85-160">Navigate to YARN and view the Configs tab.</span></span>  <span data-ttu-id="fab85-161">Het geheugen YARN wordt in dit venster weergegeven.</span><span class="sxs-lookup"><span data-stu-id="fab85-161">The YARN memory is displayed in this window.</span></span>  
<span data-ttu-id="fab85-162">Opmerking: wanneer u zich in het venster, u ziet ook de standaardgrootte voor de YARN-container.</span><span class="sxs-lookup"><span data-stu-id="fab85-162">Note: while you are in the window, you can also see the default YARN container size.</span></span>  <span data-ttu-id="fab85-163">De grootte van de container YARN is hetzelfde als geheugen per executor-parameter.</span><span class="sxs-lookup"><span data-stu-id="fab85-163">The YARN container size is the same as memory per executor paramter.</span></span>

    Total YARN memory = nodes * YARN memory per node
<span data-ttu-id="fab85-164">**Stap 5: Num Executor berekenen**</span><span class="sxs-lookup"><span data-stu-id="fab85-164">**Step 5: Calculate num-executors**</span></span>

<span data-ttu-id="fab85-165">**Geheugen-beperking berekenen** -de parameter num Executor wordt begrensd door geheugen of CPU.</span><span class="sxs-lookup"><span data-stu-id="fab85-165">**Calculate memory constraint** - The num-executors parameter is constrained either by memory or by CPU.</span></span>  <span data-ttu-id="fab85-166">De beperking van het geheugen wordt bepaald door de hoeveelheid beschikbaar geheugen voor YARN voor uw toepassing.</span><span class="sxs-lookup"><span data-stu-id="fab85-166">The memory constraint is determined by the amount of available YARN memory for your application.</span></span>  <span data-ttu-id="fab85-167">U moet nemen totale YARN-geheugen en die wordt gedeeld door executor-geheugen.</span><span class="sxs-lookup"><span data-stu-id="fab85-167">You should take total YARN memory and divide that by executor-memory.</span></span>  <span data-ttu-id="fab85-168">De beperking moet worden opgeheven uitgebreid voor het aantal apps zodat we door het aantal apps delen.</span><span class="sxs-lookup"><span data-stu-id="fab85-168">The constraint needs to be de-scaled for the number of apps so we divide by the number of apps.</span></span>

    Memory constraint = (total YARN memory / executor memory) / # of apps   
<span data-ttu-id="fab85-169">**CPU-beperking berekenen** -de CPU-beperking wordt berekend als de totale virtuele kernen gedeeld door het aantal kernen per executor.</span><span class="sxs-lookup"><span data-stu-id="fab85-169">**Calculate CPU constraint** - The CPU constraint is calculated as the total virtual cores divided by the number of cores per executor.</span></span>  <span data-ttu-id="fab85-170">Er zijn 2 virtuele kernen voor elke fysieke kernen.</span><span class="sxs-lookup"><span data-stu-id="fab85-170">There are 2 virtual cores for each physical core.</span></span>  <span data-ttu-id="fab85-171">Vergelijkbaar met de beperking van het geheugen, hebben we delen door het aantal apps.</span><span class="sxs-lookup"><span data-stu-id="fab85-171">Similar to the memory constraint, we have divide by the number of apps.</span></span>

    virtual cores = (nodes in cluster * # of physical cores in node * 2)
    CPU constraint = (total virtual cores / # of cores per executor) / # of apps
<span data-ttu-id="fab85-172">**Num Executor ingesteld** : de parameter num Executor wordt bepaald door het minimum van de beperkingen van het geheugen en de CPU.</span><span class="sxs-lookup"><span data-stu-id="fab85-172">**Set num-executors** – The num-executors parameter is determined by taking the minimum of the memory constraint and the CPU constraint.</span></span> 

    num-executors = Min (total virtual Cores / # of cores per executor, available YARN memory / executor-memory)   
<span data-ttu-id="fab85-173">Hoe hoger de waarde van getal Executor stijgt niet per se prestaties.</span><span class="sxs-lookup"><span data-stu-id="fab85-173">Setting a higher number of num-executors does not necessarily increase performance.</span></span>  <span data-ttu-id="fab85-174">U moet rekening houden met het toevoegen van meer Executor wordt toegevoegd extra overhead voor elke extra executor die u kunt mogelijk de prestaties verslechteren.</span><span class="sxs-lookup"><span data-stu-id="fab85-174">You should consider that adding more executors will add extra overhead for each additional executor, which can potentially degrade performance.</span></span>  <span data-ttu-id="fab85-175">NUM Executor wordt begrensd door de clusterresources.</span><span class="sxs-lookup"><span data-stu-id="fab85-175">Num-executors is bounded by the cluster resources.</span></span>    

## <a name="example-calculation"></a><span data-ttu-id="fab85-176">Voorbeeld van de berekening</span><span class="sxs-lookup"><span data-stu-id="fab85-176">Example Calculation</span></span>

<span data-ttu-id="fab85-177">Stel dat u hebt momenteel een cluster bestaan uit 8 D4v2 knooppunten met 2 apps, inclusief de waarschuwing die u wilt uitvoeren.</span><span class="sxs-lookup"><span data-stu-id="fab85-177">Let’s say you currently have a cluster composed of 8 D4v2 nodes that is running 2 apps including the one you are going to run.</span></span>  

<span data-ttu-id="fab85-178">**Stap 1: Bepalen hoeveel apps worden uitgevoerd op uw cluster** – u weet dat u 2 hebt apps op uw cluster, inclusief de waarschuwing die u wilt uitvoeren.</span><span class="sxs-lookup"><span data-stu-id="fab85-178">**Step 1: Determine how many apps are running on your cluster** – you know that you have 2 apps on your cluster, including the one you are going to run.</span></span>  

<span data-ttu-id="fab85-179">**Stap 2: Stel executor geheugen** – voor dit voorbeeld we bepalen 6 GB executor-geheugen is geschikt voor i/o-intensieve taak.</span><span class="sxs-lookup"><span data-stu-id="fab85-179">**Step 2: Set executor-memory** – for this example, we determine that 6GB of executor-memory will be sufficient for I/O intensive job.</span></span>  

    executor-memory = 6GB
<span data-ttu-id="fab85-180">**Stap 3: Stel executor kernen** – omdat dit een i/o-intensieve taak is, kunnen we het aantal kernen ingesteld voor elke executor tot en met 4.</span><span class="sxs-lookup"><span data-stu-id="fab85-180">**Step 3: Set executor-cores** – Since this is an I/O intensive job, we can set the number of cores for each executor to 4.</span></span>  <span data-ttu-id="fab85-181">Kernen per executor wordt ingesteld op groter is dan 4 garbagecollection verzameling problemen kan veroorzaken.</span><span class="sxs-lookup"><span data-stu-id="fab85-181">Setting cores per executor to larger than 4 may cause garbage collection problems.</span></span>  

    executor-cores = 4
<span data-ttu-id="fab85-182">**Stap 4: YARN-geheugen van de cluster bepalen** – We gaat u naar Ambari om erachter te komen dat elke D4v2 25 GB YARN geheugen heeft.</span><span class="sxs-lookup"><span data-stu-id="fab85-182">**Step 4: Determine amount of YARN memory in cluster** – We navigate to Ambari to find out that each D4v2 has 25GB of YARN memory.</span></span>  <span data-ttu-id="fab85-183">Aangezien er 8 knooppunten, kan het beschikbare geheugen van YARN 8 wordt vermenigvuldigd.</span><span class="sxs-lookup"><span data-stu-id="fab85-183">Since there are 8 nodes, the available YARN memory is multiplied by 8.</span></span>

    Total YARN memory = nodes * YARN memory* per node
    Total YARN memory = 8 nodes * 25GB = 200GB
<span data-ttu-id="fab85-184">**Stap 5: Berekenen num Executor** : de parameter num Executor wordt bepaald door het minimum van de beperking van het geheugen en de CPU-beperking wordt gedeeld door het aantal apps die worden uitgevoerd op Spark.</span><span class="sxs-lookup"><span data-stu-id="fab85-184">**Step 5: Calculate num-executors** – The num-executors parameter is determined by taking the minimum of the memory constraint and the CPU constraint divided by the # of apps running on Spark.</span></span>    

<span data-ttu-id="fab85-185">**Geheugen-beperking berekenen** : de beperking van het geheugen wordt berekend als het totale YARN-geheugen van de hoeveelheid geheugen per executor verdeeld.</span><span class="sxs-lookup"><span data-stu-id="fab85-185">**Calculate memory constraint** – The memory constraint is calculated as the total YARN memory divided by the memory per executor.</span></span>

    Memory constraint = (total YARN memory / executor memory) / # of apps   
    Memory constraint = (200GB / 6GB) / 2   
    Memory constraint = 16 (rounded)
<span data-ttu-id="fab85-186">**CPU-beperking berekenen** -de CPU-beperking wordt berekend als de totale yarn kernen gedeeld door het aantal kernen per executor.</span><span class="sxs-lookup"><span data-stu-id="fab85-186">**Calculate CPU constraint** - The CPU constraint is calculated as the total yarn cores divided by the number of cores per executor.</span></span>
    
    YARN cores = nodes in cluster * # of cores per node * 2   
    YARN cores = 8 nodes * 8 cores per D14 * 2 = 128
    CPU constraint = (total YARN cores / # of cores per executor) / # of apps
    CPU constraint = (128 / 4) / 2
    CPU constraint = 16
<span data-ttu-id="fab85-187">**Set num-Executor**</span><span class="sxs-lookup"><span data-stu-id="fab85-187">**Set num-executors**</span></span>

    num-executors = Min (memory constraint, CPU constraint)
    num-executors = Min (16, 16)
    num-executors = 16    

