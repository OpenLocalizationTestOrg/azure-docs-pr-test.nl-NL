---
title: Azure Data Lake Store Hive prestaties afstemmen richtlijnen | Microsoft Docs
description: Azure Data Lake Store Hive prestaties afstemmen richtlijnen
services: data-lake-store
documentationcenter: 
author: stewu
manager: amitkul
editor: stewu
ms.assetid: ebde7b9f-2e51-4d43-b7ab-566417221335
ms.service: data-lake-store
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: big-data
ms.date: 12/19/2016
ms.author: stewu
ms.openlocfilehash: e10bf8f7cbae2b81d22823ff74fe652c6bcb2da3
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 07/11/2017
---
# <a name="performance-tuning-guidance-for-hive-on-hdinsight-and-azure-data-lake-store"></a><span data-ttu-id="22b5b-103">Prestaties afstemmen richtlijnen voor Hive in HDInsight en Azure Data Lake Store</span><span class="sxs-lookup"><span data-stu-id="22b5b-103">Performance tuning guidance for Hive on HDInsight and Azure Data Lake Store</span></span>

<span data-ttu-id="22b5b-104">De standaardinstellingen zijn ingesteld om te voorzien in veel verschillende gebruiksscenario goede prestaties.</span><span class="sxs-lookup"><span data-stu-id="22b5b-104">The default settings have been set to provide good performance across many different use cases.</span></span>  <span data-ttu-id="22b5b-105">Voor i/o-intensieve query's kan Hive voor betere prestaties met ADLS worden afgestemd.</span><span class="sxs-lookup"><span data-stu-id="22b5b-105">For I/O intensive queries, Hive can be tuned to get better performance with ADLS.</span></span>  

## <a name="prerequisites"></a><span data-ttu-id="22b5b-106">Vereisten</span><span class="sxs-lookup"><span data-stu-id="22b5b-106">Prerequisites</span></span>

* <span data-ttu-id="22b5b-107">**Een Azure-abonnement**.</span><span class="sxs-lookup"><span data-stu-id="22b5b-107">**An Azure subscription**.</span></span> <span data-ttu-id="22b5b-108">Zie [Gratis proefversie van Azure ophalen](https://azure.microsoft.com/pricing/free-trial/).</span><span class="sxs-lookup"><span data-stu-id="22b5b-108">See [Get Azure free trial](https://azure.microsoft.com/pricing/free-trial/).</span></span>
* <span data-ttu-id="22b5b-109">**Een Azure Data Lake Store-account**.</span><span class="sxs-lookup"><span data-stu-id="22b5b-109">**An Azure Data Lake Store account**.</span></span> <span data-ttu-id="22b5b-110">Zie voor instructies over het maken van een [aan de slag met Azure Data Lake Store](data-lake-store-get-started-portal.md)</span><span class="sxs-lookup"><span data-stu-id="22b5b-110">For instructions on how to create one, see [Get started with Azure Data Lake Store](data-lake-store-get-started-portal.md)</span></span>
* <span data-ttu-id="22b5b-111">**Azure HDInsight-cluster** met toegang tot een Data Lake Store-account.</span><span class="sxs-lookup"><span data-stu-id="22b5b-111">**Azure HDInsight cluster** with access to a Data Lake Store account.</span></span> <span data-ttu-id="22b5b-112">Zie [een HDInsight-cluster maken met Data Lake Store](data-lake-store-hdinsight-hadoop-use-portal.md).</span><span class="sxs-lookup"><span data-stu-id="22b5b-112">See [Create an HDInsight cluster with Data Lake Store](data-lake-store-hdinsight-hadoop-use-portal.md).</span></span> <span data-ttu-id="22b5b-113">Zorg ervoor dat u extern bureaublad inschakelen voor het cluster.</span><span class="sxs-lookup"><span data-stu-id="22b5b-113">Make sure you enable Remote Desktop for the cluster.</span></span>
* <span data-ttu-id="22b5b-114">**Uitvoeren van Hive in HDInsight**.</span><span class="sxs-lookup"><span data-stu-id="22b5b-114">**Running Hive on HDInsight**.</span></span>  <span data-ttu-id="22b5b-115">Zie voor meer informatie over het uitvoeren van Hive-taken in HDInsight, [op HDInsight Hive gebruiken] (https://docs.microsoft.com/en-us/azure/hdinsight/hdinsight-use-hive)</span><span class="sxs-lookup"><span data-stu-id="22b5b-115">To learn about running Hive jobs on HDInsight, see [Use Hive on HDInsight] (https://docs.microsoft.com/en-us/azure/hdinsight/hdinsight-use-hive)</span></span>
* <span data-ttu-id="22b5b-116">**Prestaties afstemmen richtlijnen op ADLS**.</span><span class="sxs-lookup"><span data-stu-id="22b5b-116">**Performance tuning guidelines on ADLS**.</span></span>  <span data-ttu-id="22b5b-117">Raadpleeg voor algemene prestaties concepten, [Data Lake Store prestaties afstemmen richtlijnen](https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-performance-tuning-guidance)</span><span class="sxs-lookup"><span data-stu-id="22b5b-117">For general performance concepts, see [Data Lake Store Performance Tuning Guidance](https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-performance-tuning-guidance)</span></span>

## <a name="parameters"></a><span data-ttu-id="22b5b-118">Parameters</span><span class="sxs-lookup"><span data-stu-id="22b5b-118">Parameters</span></span>

<span data-ttu-id="22b5b-119">Hier volgen de belangrijkste instellingen af te stemmen voor verbeterde ADLS-prestaties:</span><span class="sxs-lookup"><span data-stu-id="22b5b-119">Here are the most important settings to tune for improved ADLS performance:</span></span>

* <span data-ttu-id="22b5b-120">**hive.tez.container.Size** – de hoeveelheid geheugen die wordt gebruikt door elke taken</span><span class="sxs-lookup"><span data-stu-id="22b5b-120">**hive.tez.container.size** – the amount of memory used by each tasks</span></span>

* <span data-ttu-id="22b5b-121">**grootte van tez.Grouping.min** : minimale grootte van elke toewijzen</span><span class="sxs-lookup"><span data-stu-id="22b5b-121">**tez.grouping.min-size** – minimum size of each mapper</span></span>

* <span data-ttu-id="22b5b-122">**grootte van tez.Grouping.Max** : maximale grootte van elke toewijzen</span><span class="sxs-lookup"><span data-stu-id="22b5b-122">**tez.grouping.max-size** – maximum size of each mapper</span></span>

* <span data-ttu-id="22b5b-123">**hive.Exec.reducer.bytes.per.reducer** : grootte van elke reducer</span><span class="sxs-lookup"><span data-stu-id="22b5b-123">**hive.exec.reducer.bytes.per.reducer** – size of each reducer</span></span>

<span data-ttu-id="22b5b-124">**hive.tez.container.Size** -de grootte van de container bepaalt hoeveel geheugen beschikbaar is voor elke taak.</span><span class="sxs-lookup"><span data-stu-id="22b5b-124">**hive.tez.container.size** - The container size determines how much memory is available for each task.</span></span>  <span data-ttu-id="22b5b-125">Dit is de belangrijkste invoer voor het beheren van de concurrency in Hive.</span><span class="sxs-lookup"><span data-stu-id="22b5b-125">This is the main input for controlling the concurrency in Hive.</span></span>  

<span data-ttu-id="22b5b-126">**grootte van tez.Grouping.min** – deze parameter kunt u de minimale grootte van elke mapper instellen.</span><span class="sxs-lookup"><span data-stu-id="22b5b-126">**tez.grouping.min-size** – This parameter allows you to set the minimum size of each mapper.</span></span>  <span data-ttu-id="22b5b-127">Als het aantal mappers die Tez kiest kleiner dan de waarde van deze parameter is, wordt de hier ingestelde waarde gebruikt op Tez.</span><span class="sxs-lookup"><span data-stu-id="22b5b-127">If the number of mappers that Tez chooses is smaller than the value of this parameter, then Tez will use the value set here.</span></span>  

<span data-ttu-id="22b5b-128">**grootte van tez.Grouping.Max** : de parameter kunt u de maximale grootte van elke mapper instellen.</span><span class="sxs-lookup"><span data-stu-id="22b5b-128">**tez.grouping.max-size** – The parameter allows you to set the maximum size of each mapper.</span></span>  <span data-ttu-id="22b5b-129">Als het aantal mappers die Tez kiest groter dan de waarde van deze parameter is, wordt de hier ingestelde waarde gebruikt op Tez.</span><span class="sxs-lookup"><span data-stu-id="22b5b-129">If the number of mappers that Tez chooses is larger than the value of this parameter, then Tez will use the value set here.</span></span>  

<span data-ttu-id="22b5b-130">**hive.Exec.reducer.bytes.per.reducer** – deze parameter wordt de grootte van elke reducer ingesteld.</span><span class="sxs-lookup"><span data-stu-id="22b5b-130">**hive.exec.reducer.bytes.per.reducer** – This parameter sets the size of each reducer.</span></span>  <span data-ttu-id="22b5b-131">Standaard is elke reducer 256MB.</span><span class="sxs-lookup"><span data-stu-id="22b5b-131">By default, each reducer is 256MB.</span></span>  

## <a name="guidance"></a><span data-ttu-id="22b5b-132">Richtlijnen</span><span class="sxs-lookup"><span data-stu-id="22b5b-132">Guidance</span></span>

<span data-ttu-id="22b5b-133">**Stel hive.exec.reducer.bytes.per.reducer** : de standaardwaarde goed werkt wanneer de gegevens is gedecomprimeerd.</span><span class="sxs-lookup"><span data-stu-id="22b5b-133">**Set hive.exec.reducer.bytes.per.reducer** – The default value works well when the data is uncompressed.</span></span>  <span data-ttu-id="22b5b-134">Voor gegevens die zijn gecomprimeerd, moet u de grootte van de reducer beperken.</span><span class="sxs-lookup"><span data-stu-id="22b5b-134">For data that is compressed, you should reduce the size of the reducer.</span></span>  

<span data-ttu-id="22b5b-135">**Stel hive.tez.container.size** – In elk knooppunt geheugen wordt opgegeven door yarn.nodemanager.resource.memory mb en moet worden correct is ingesteld op HDI-cluster standaard.</span><span class="sxs-lookup"><span data-stu-id="22b5b-135">**Set hive.tez.container.size** – In each node, memory is specified by yarn.nodemanager.resource.memory-mb and should be correctly set on HDI cluster by default.</span></span>  <span data-ttu-id="22b5b-136">Zie voor meer informatie over het instellen van het juiste geheugen in YARN [boeken](https://docs.microsoft.com/en-us/azure/hdinsight/hdinsight-hadoop-hive-out-of-memory-error-oom).</span><span class="sxs-lookup"><span data-stu-id="22b5b-136">For additional information on setting the appropriate memory in YARN, see this [post](https://docs.microsoft.com/en-us/azure/hdinsight/hdinsight-hadoop-hive-out-of-memory-error-oom).</span></span>

<span data-ttu-id="22b5b-137">I/o-intensieve werkbelastingen kunnen profiteren van meer parallelle uitvoering door de grootte van de container Tez verlagen.</span><span class="sxs-lookup"><span data-stu-id="22b5b-137">I/O intensive workloads can benefit from more parallelism by decreasing the Tez container size.</span></span> <span data-ttu-id="22b5b-138">Hiermee geeft u de gebruiker meer containers waardoor gelijktijdigheid van taken.</span><span class="sxs-lookup"><span data-stu-id="22b5b-138">This gives the user more containers which increases concurrency.</span></span>  <span data-ttu-id="22b5b-139">Sommige Hive-query's vereisen echter een aanzienlijke hoeveelheid geheugen (bijvoorbeeld MapJoin).</span><span class="sxs-lookup"><span data-stu-id="22b5b-139">However, some Hive queries require a significant amount of memory (e.g. MapJoin).</span></span>  <span data-ttu-id="22b5b-140">Als de taak beschikt niet over voldoende geheugen, krijgt u een out-of geheugen-uitzondering tijdens runtime.</span><span class="sxs-lookup"><span data-stu-id="22b5b-140">If the task does not have enough memory, you will get an out of memory exception during runtime.</span></span>  <span data-ttu-id="22b5b-141">Als u buiten geheugen uitzonderingen ontvangt, moet u het geheugen verhogen.</span><span class="sxs-lookup"><span data-stu-id="22b5b-141">If you receive out of memory exceptions, then you should increase the memory.</span></span>   

<span data-ttu-id="22b5b-142">Het aantal gelijktijdige taken die worden uitgevoerd of parallelle uitvoering wordt begrensd worden door het totale YARN-geheugen.</span><span class="sxs-lookup"><span data-stu-id="22b5b-142">The concurrent number of tasks running or parallelism will be bounded by the total YARN memory.</span></span>  <span data-ttu-id="22b5b-143">Het aantal YARN-containers worden uitgevoerd, bepalen hoeveel gelijktijdige taken kunnen uitvoeren.</span><span class="sxs-lookup"><span data-stu-id="22b5b-143">The number of YARN containers will dictate how many concurrent tasks can run.</span></span>  <span data-ttu-id="22b5b-144">Als u de YARN-geheugen per knooppunt zoekt, kunt u naar Ambari gaan.</span><span class="sxs-lookup"><span data-stu-id="22b5b-144">To find the YARN memory per node, you can go to Ambari.</span></span>  <span data-ttu-id="22b5b-145">Navigeer naar YARN en Raadpleeg het tabblad Configs.</span><span class="sxs-lookup"><span data-stu-id="22b5b-145">Navigate to YARN and view the Configs tab.</span></span>  <span data-ttu-id="22b5b-146">Het geheugen YARN wordt in dit venster weergegeven.</span><span class="sxs-lookup"><span data-stu-id="22b5b-146">The YARN memory is displayed in this window.</span></span>  

        Total YARN memory = nodes * YARN memory per node
        # of YARN containers = Total YARN memory / Tez container size
<span data-ttu-id="22b5b-147">De sleutel voor het verbeteren van de prestaties met ADLS is de concurrency zo veel mogelijk verhogen.</span><span class="sxs-lookup"><span data-stu-id="22b5b-147">The key to improving performance using ADLS is to increase the concurrency as much as possible.</span></span>  <span data-ttu-id="22b5b-148">Tez berekent automatisch het aantal taken die moet worden gemaakt, dus u niet hoeft in te stellen.</span><span class="sxs-lookup"><span data-stu-id="22b5b-148">Tez automatically calculates the number of tasks that should be created so you do not need to set it.</span></span>   

## <a name="example-calculation"></a><span data-ttu-id="22b5b-149">Voorbeeld van de berekening</span><span class="sxs-lookup"><span data-stu-id="22b5b-149">Example Calculation</span></span>

<span data-ttu-id="22b5b-150">Stel dat u hebt een cluster met 8 knooppunten D14.</span><span class="sxs-lookup"><span data-stu-id="22b5b-150">Let’s say you have an 8 node D14 cluster.</span></span>  

    Total YARN memory = nodes * YARN memory per node
    Total YARN memory = 8 nodes * 96GB = 768GB
    # of YARN containers = 768GB / 3072MB = 256

## <a name="limitations"></a><span data-ttu-id="22b5b-151">Beperkingen</span><span class="sxs-lookup"><span data-stu-id="22b5b-151">Limitations</span></span>
<span data-ttu-id="22b5b-152">**ADLS-beperking**</span><span class="sxs-lookup"><span data-stu-id="22b5b-152">**ADLS throttling**</span></span> 

<span data-ttu-id="22b5b-153">Wanneer u de grenzen van de bandbreedte die worden geleverd door ADLS UIf raakt, u zou gaan om te zien van de mislukte taken.</span><span class="sxs-lookup"><span data-stu-id="22b5b-153">UIf you hit the limits of bandwidth provided by ADLS, you would start to see task failures.</span></span> <span data-ttu-id="22b5b-154">Dit kan worden geïdentificeerd door observeren bandbreedteregeling fouten in de logboeken van de taak.</span><span class="sxs-lookup"><span data-stu-id="22b5b-154">This could be identified by observing throttling errors in task logs.</span></span>  <span data-ttu-id="22b5b-155">U kunt de parallelle uitvoering verlagen door de Tez-container vergroten.</span><span class="sxs-lookup"><span data-stu-id="22b5b-155">You can decrease the parallelism by increasing Tez container size.</span></span>  <span data-ttu-id="22b5b-156">Als u meer gelijktijdigheid van taken bij uw werk nodig, neem dan contact met ons.</span><span class="sxs-lookup"><span data-stu-id="22b5b-156">If you need more concurrency for your job, please contact us.</span></span>   

<span data-ttu-id="22b5b-157">Om te zien als u zijn ophalen beperkt, moet u de opdracht debug logboekregistratie aan de clientzijde inschakelen.</span><span class="sxs-lookup"><span data-stu-id="22b5b-157">To check if you are getting throttled, you need to enable the debug logging on the client side.</span></span> <span data-ttu-id="22b5b-158">Hier ziet u hoe u dat kunt doen:</span><span class="sxs-lookup"><span data-stu-id="22b5b-158">Here’s how you can do that:</span></span>

1. <span data-ttu-id="22b5b-159">De volgende eigenschap plaatsen in de eigenschappen log4j in de Hive-configuratie.</span><span class="sxs-lookup"><span data-stu-id="22b5b-159">Put the following property in the log4j properties in Hive config.</span></span> <span data-ttu-id="22b5b-160">Dit kan worden gedaan vanuit de weergave Ambari: log4j.logger.com.microsoft.azure.datalake.store=DEBUG alle knooppunten/start de service opnieuw voor de configuratie door te voeren.</span><span class="sxs-lookup"><span data-stu-id="22b5b-160">This can be done from Ambari view: log4j.logger.com.microsoft.azure.datalake.store=DEBUG Restart all the nodes/service for the config to take effect.</span></span>

2. <span data-ttu-id="22b5b-161">Als u beperkt ophalen, ziet u de 429 HTTP-foutcode in de hive-logboekbestand.</span><span class="sxs-lookup"><span data-stu-id="22b5b-161">If you are getting throttled, you’ll see the HTTP 429 error code in the hive log file.</span></span> <span data-ttu-id="22b5b-162">Het hive-logboekbestand bevindt zich in /tmp/&lt;gebruiker&gt;/hive.log</span><span class="sxs-lookup"><span data-stu-id="22b5b-162">The hive log file is in /tmp/&lt;user&gt;/hive.log</span></span>

## <a name="further-information-on-hive-tuning"></a><span data-ttu-id="22b5b-163">Meer informatie over het afstemmen van Hive</span><span class="sxs-lookup"><span data-stu-id="22b5b-163">Further information on Hive tuning</span></span>

<span data-ttu-id="22b5b-164">Hier volgen enkele blogs waarmee uw Hive-query's optimaliseren:</span><span class="sxs-lookup"><span data-stu-id="22b5b-164">Here are a few blogs that will help tune your Hive queries:</span></span>
* [<span data-ttu-id="22b5b-165">Hive-query's optimaliseren voor Hadoop in HDInsight</span><span class="sxs-lookup"><span data-stu-id="22b5b-165">Optimize Hive queries for Hadoop in HDInsight</span></span>](https://azure.microsoft.com/en-us/documentation/articles/hdinsight-hadoop-optimize-hive-query/)
* [<span data-ttu-id="22b5b-166">Het oplossen van de prestaties van de Hive-query 's</span><span class="sxs-lookup"><span data-stu-id="22b5b-166">Troubleshooting Hive query performance</span></span>](https://blogs.msdn.microsoft.com/bigdatasupport/2015/08/13/troubleshooting-hive-query-performance-in-hdinsight-hadoop-cluster/)
* [<span data-ttu-id="22b5b-167">Ignite Neem contact op optimaliseren Hive in HDInsight</span><span class="sxs-lookup"><span data-stu-id="22b5b-167">Ignite talk on optimize Hive on HDInsight</span></span>](https://channel9.msdn.com/events/Machine-Learning-and-Data-Sciences-Conference/Data-Science-Summit-2016/MSDSS25)
