Het beheren van identiteit is net zo belangrijk in Hallo openbare cloud als on-premises. toohelp met deze Azure ondersteunt verschillende andere cloud identity-technologieën. Ze omvatten deze:

* U kunt Windows Server Active Directory (alleen AD opstartbestande wordt genoemd) in Hallo cloud met behulp van virtuele machines die zijn gemaakt met Azure virtuele machines uitvoeren. Deze aanpak is wel zinvol wanneer u Azure tooextend uw on-premises datacentrum in Hallo cloud.
* U kunt Azure Active Directory-toogive uw gebruikers eenmalige aanmelding te[Software als een Service (SaaS)](https://azure.microsoft.com/overview/what-is-saas/) toepassingen. Van Microsoft Office 365 maakt gebruik van deze technologie bijvoorbeeld en toepassingen die worden uitgevoerd op Azure of andere cloudplatforms kunnen ook worden gebruikt.
* Toepassingen die worden uitgevoerd in Hallo cloud of on-premises Azure Active Directory-toegangsbeheer toolet gebruikers zich aanmelden met behulp van identiteiten van Facebook, Google, Microsoft en andere id-providers kunnen gebruiken.

In dit artikel beschrijft alle drie deze opties.

## <a name="table-of-contents"></a>Inhoudsopgave
* [Windows Server Active Directory uitgevoerd op virtuele machines](#adinvm)
* [Met behulp van Azure Active Directory](#ad)
* [Met behulp van Azure Active Directory-toegangsbeheer](#ac)

## <a name="adinvm"></a>Windows Server Active Directory uitgevoerd op virtuele machines
Windows Server AD uitvoeren in virtuele machines in Azure, is vergelijkbaar met het lokale uitvoert. [Afbeelding 1](#fig1) toont een typisch voorbeeld van hoe dit eruitziet.

![Azure Active Directory in de virtuele Machine](./media/identity/identity_01_ADinVM.png)

<a name="Fig1"></a>Afbeelding 1: Windows Server Active Directory kunt uitvoeren in Azure virtuele machines verbonden tooan organisatie on-premises datacentrum met behulp van Azure Virtual Network.

In Hallo voorbeeld, wordt Windows Server AD uitgevoerd in virtuele machines die zijn gemaakt met behulp van Azure Virtual Machines, Hallo-platform IaaS-technologie. Deze virtuele machines en enkele andere zijn gegroepeerd in een virtueel netwerk verbonden tooan on-premises datacentrum met behulp van Azure Virtual Network. het virtuele netwerk Hallo carves uit een groep van cloud virtuele machines die met de Hallo on-premises netwerk via een virtueel particulier netwerk (VPN)-verbinding communiceren. Dit kunt doen deze Azure virtuele machines zien eruit als een ander subnet toohello on-premises datacentrum. Zoals Hallo afbeelding kunt zien, worden twee van deze VMs domeincontrollers Windows Server AD uitgevoerd. Hallo andere virtuele machines in het virtuele netwerk hello wordt mogelijk uitgevoerd toepassingen, zoals SharePoint of worden gebruikt in een andere manier zoals voor het ontwikkelen en testen. Hallo on-premises datacentrum twee Windows Server AD-domeincontrollers ook wordt uitgevoerd.

Er zijn verschillende opties voor het maken van verbinding Hallo-domeincontrollers in Hallo cloud met die met een on-premises:

* Controleer alle ze deel uitmaken van één Active Directory-domein.
* Maken van afzonderlijke AD-domeinen on-premises en in Hallo cloud die deel uitmaken van Hallo hetzelfde forest bevinden.
* Maken van afzonderlijke AD-forests in Hallo cloud en on-premises en verbind Hallo-forests met behulp van vertrouwensrelaties tussen forests of Windows Server Active Directory Federation Services (AD FS), die u ook in virtuele machines in Azure uitvoeren kunt.

Ongeacht de keuze is gemaakt, een beheerder moet ervoor zorgen dat het verificatieaanvragen van on-premises gebruikers gaan toocloud domeincontrollers alleen indien nodig, aangezien Hallo koppeling toohello cloud waarschijnlijk toobe langzamer dan on-premises netwerken. Een andere factor tooconsider in verbindende cloud en lokale domeincontrollers is Hallo verkeer dat wordt gegenereerd door middel van replicatie. Domeincontrollers in de cloud Hallo zijn meestal in hun eigen AD-site, waardoor een beheerder tooschedule hoe vaak replicatie wordt uitgevoerd. Azure kosten voor verkeer dat buiten een Azure-datacenter wordt verzonden, maar niet voor bytes verzonden in die van invloed kunnen zijn op de Hallo-beheerder replicatie keuzes. Het is ook waard wijzen dat terwijl Azure een eigen Domain Name System (DNS)-ondersteuning biedt, deze service die vereist zijn voor Active Directory (zoals ondersteuning voor dynamische DNS- en SRV-records ontbreekt). Als gevolg hiervan, Windows Server AD uitgevoerd op Azure instellen van uw eigen DNS-servers in de cloud Hallo vereist.

Windows Server AD uitgevoerd in Azure VM's kunt zinvol in diverse verschillende situaties. Hier volgen enkele voorbeelden:

* Als u Azure Virtual Machines gebruikt als een uitbreiding van uw eigen datacenter, kunt u toepassingen in Hallo cloud die lokale domain controllers toohandle dingen zoals geïntegreerde Windows-verificatie aanvragen of LDAP-query's moet uitvoeren. SharePoint, bijvoorbeeld communiceert regelmatig met Active Directory en dus het is mogelijk toorun een SharePoint-farm op Azure met behulp van een on-premises adreslijst, instellen van domeincontrollers in de cloud hello wordt prestaties aanzienlijk verbeteren. (Het is belangrijk toorealize dat dit niet per se vereist echter; volop toepassingen met succes kunt uitvoeren in Hallo cloud met behulp van alleen lokale domeincontrollers.)
* Stel dat een veel filiaal beschikt niet over Hallo resources toorun eigen domeincontrollers. Vandaag de dag haar gebruikers moeten worden geverifieerd toodomain controllers op Hallo andere kant van Hallo wereld - aanmeldingen langzaam worden uitgevoerd. Active Directory worden uitgevoerd op Azure in een Microsoft-datacentrum dichter kunt versnellen dit zonder meer servers in het filiaal Hallo.
* Een organisatie die gebruikmaakt van Azure voor noodherstel mogelijk een klein aantal actieve virtuele machines in de cloud hello, met inbegrip van een domeincontroller onderhouden. Deze kan vervolgens worden voorbereid tooexpand deze site als de benodigde tootake via voor fouten elders.

Er zijn ook andere mogelijkheden. Bijvoorbeeld: u bent niet vereist Windows Server AD in Hallo cloud tooan tooconnect lokale datacenter. Als u een SharePoint-farm die een bepaalde reeks gebruikers behandeld toorun wilde, voor het exemplaar van wie uitsluitend met cloud-gebaseerde identiteiten wilt aanmelden, u kunt een zelfstandige forest maken in Azure. Hoe u deze technologie gebruiken, is afhankelijk van wat de doelstellingen van uw zijn. (Voor meer richtlijnen gedetailleerde over het gebruik van Windows Server AD met Azure, [Hier ziet](http://msdn.microsoft.com/library/windowsazure/jj156090.aspx).)

## <a name="ad"></a>Met behulp van Azure Active Directory
SaaS-toepassingen komen meer algemene, ze een voor de hand liggende vraag verhogen: wat voor soort adreslijstservice moeten deze cloud-gebaseerde toepassingen gebruiken? Microsoft antwoord toothat vraag is Azure Active Directory.

Er zijn twee manieren voor het gebruik van deze directoryservice in de cloud Hallo:

* Personen en organisaties die gebruikmaken van SaaS-toepassingen kunnen gebruikgemaakt van Azure Active Directory als de enige directoryservice.
* Organisaties met Windows Server Active Directory kunnen verbinding maken met hun lokale directory tooAzure Active Directory en vervolgens deze toogive gebruiken hun gebruikers eenmalige aanmelding tooSaaS toepassingen.

[Afbeelding 2](#fig2) illustreert Hallo eerste van deze twee opties, waarbij Azure Active Directory alle die vereist zijn.

![Azure Active Directory in de virtuele Machine](./media/identity/identity_02_AD.png)

<a name="fig2"></a>Afbeelding 2: Azure Active Directory geeft een organisatie gebruikers eenmalige aanmelding tooSaaS-toepassingen, waaronder Office 365.

Zoals u Hallo afbeelding ziet, is Azure AD een multitenant-service. Dit betekent dat veel verschillende organisaties opslaan van informatie over gebruikers op elk van deze directory gelijktijdig kan worden ondersteund. In dit voorbeeld wordt een gebruiker op de organisatie A geprobeerd tooaccess een SaaS-toepassing. Deze toepassing kan onderdeel zijn van Office 365, zoals SharePoint Online of mogelijk iets anders - niet-Microsoft-toepassingen kunnen ook gebruikmaken van deze technologie. Omdat Azure AD Hallo SAML 2.0-protocol ondersteunt, heeft dat alle vereist van een toepassing hello mogelijkheid toointeract gebruikt deze industrie-initiatief. (In feite toepassingen die gebruikmaken van Azure AD kunnen worden uitgevoerd in een datacenter, niet alleen een Azure-datacenter.)

Hallo-proces begint met het Hallo-gebruiker toegang krijgt tot een SaaS-toepassing (stap 1). toouse deze toepassing hello gebruiker moet een token dat is uitgegeven door Azure AD aanwezig.

Dit token bevat informatie waarmee Hallo gebruiker en het digitaal is ondertekend door Azure AD. tooget hello token, Hallo gebruiker wordt geverifieerd zelf tooAzure AD door te geven van een gebruikersnaam en wachtwoord (stap 2). Azure AD vervolgens retourneert Hallo-token die hij nodig heeft (stap 3).

Dit token vervolgens toohello SaaS-toepassing (stap 4) en die valideert de handtekening van het Hallo-token en die gebruikmaakt van de inhoud (stap 5) verzonden. Gewoonlijk Hallo toepassing hello identiteitsgegevens Hallo token bevat toodecide wat informatie Hallo-gebruiker is toegestaan tooaccess gebruiken en mogelijk op andere manieren.

Als de toepassing hello meer informatie over Hallo gebruikers moet dan wat opgenomen in het Hallo-token, kan deze dit aanvragen rechtstreeks vanuit Azure AD dat gebruikmaakt van hello Azure AD Graph API (stap 6). Hallo initiële versie van Azure AD, Hallo directory-schema is heel eenvoudig: het bevat alleen gebruikers en groepen en relaties tussen deze. Toepassingen kunnen gebruikmaken van deze toolearn informatie over verbindingen tussen gebruikers. Stel bijvoorbeeld dat een toepassing moet tooknow die de manager van deze gebruiker toodecide is of hij toegestane toegang toosome gegevenssegment. Het kan informatie over dit door het uitvoeren van query's Azure AD via Hallo Graph API.

Hallo Graph API maakt gebruik van een normale RESTful-protocol, waardoor het eenvoudig toouse van de meeste clients, met inbegrip van mobiele apparaten. Hallo API ondersteunt ook het Hallo-extensies die zijn gedefinieerd door OData, bijvoorbeeld een query language toolet clients toegang tot gegevens toe te voegen in nuttiger manieren. (Zie voor meer informatie over OData [Introducing OData](http://download.microsoft.com/download/E/5/A/E5A59052-EE48-4D64-897B-5F7C608165B8/IntroducingOData.pdf).) Omdat Hallo Graph API gebruikte toolearn over de relaties tussen gebruikers zijn kan, kan deze toepassingen begrijpen Hallo sociale grafiek die ingesloten in hello Azure AD-schema voor een bepaalde organisatie (die is Hallo Graph API genoemd). En tooauthenticate zelf tooAzure AD voor Graph API aanvraagt, een toepassing maakt gebruik van OAuth 2.0.

Als een organisatie geen gebruik maakt van Windows Server Active Directory - het heeft geen lokale servers of domeinen - en uitsluitend gebruikmaakt van cloudtoepassingen die gebruikmaken van Azure AD, krijgt met slechts de clouddirectory van deze van het bedrijf Hallo gebruikers eenmalige aanmelding tooall hiervan. Nog terwijl dit scenario vaker elke dag wordt, nog steeds gebruik van de meeste organisaties on-premises domeinen gemaakt met Windows Server Active Directory. Azure AD heeft een handige functie tooplay hier ook als [afbeelding 3](#fig3) bevat.

![Azure Active Directory in de virtuele Machine](./media/identity/identity_03_AD.png)
<a id="fig3"></a>afbeelding 3: een organisatie kan federeren Windows Server Active Directory met Azure Active Directory toogive haar gebruikers eenmalige aanmelding tooSaaS toepassingen.

In dit scenario wordt wenst een gebruiker op de organisatie B tooaccess een SaaS-toepassing. Voordat ze dit doet, moeten van de organisatie Hallo directory-beheerders een federatieve relatie maken met Azure AD dat gebruikmaakt van AD FS, zoals Hallo afbeelding wordt weergegeven. Deze beheerders moet ook configureren voor gegevenssynchronisatie tussen van Hallo organisatie lokale Windows Server AD en Azure AD. Hiermee kopieert automatisch gebruikers- en groepsgegevens van Hallo lokale directory tooAzure AD. U ziet wat dit is toegestaan: van kracht Hallo organisatie is uit te breiden de on-premises adreslijst naar Hallo cloud. Combineren van Windows Server AD en Azure AD op deze manier biedt Hallo organisatie een directoryservice die kan worden beheerd als één entiteit en toch een footprint hebben zowel on-premises en in de cloud Hallo.

toouse Azure AD, Hallo gebruiker meldt zich eerst in de lokale Active Directory-domein tooher gewoon (stap 1). Wanneer ze probeert tooaccess Hallo SaaS-toepassing (stap 2), resulteert het federatieproces Hallo in Azure AD uitgeven haar een token voor deze toepassing (stap 3). (Zie voor meer informatie over de werking van federatieve [op Claims gebaseerde identiteit voor Windows: scenario's en technologieën](http://www.davidchappell.com/writing/white_papers/Claims-Based_Identity_for_Windows_v3.0--Chappell.docx).) Voordat u, bevat dit token informatie die Hallo gebruiker identificeert en het digitaal is ondertekend door Azure AD. Dit token vervolgens toohello SaaS-toepassing (stap 4) en die valideert de handtekening van het Hallo-token en die gebruikmaakt van de inhoud (stap 5) verzonden. En in Hallo vorige scenario Hallo SaaS-toepassingen gebruikmaken van kunnen Hallo Graph API toolearn meer over deze gebruiker als nodig (stap 6).

Vandaag de dag is een complete wijziging voor lokale Windows Server AD niet door Azure AD. Zoals al is vermeld, Hallo clouddirectory heeft een veel eenvoudiger schema en ontbreekt ook dingen zoals Groepsbeleid, Hallo mogelijkheid toostore informatie over de machines en ondersteuning voor LDAP. (In feite een Windows-machine mag geen geconfigureerde toolet gebruikers zich aanmelden tooit niets anders maar Azure AD - dit wordt niet ondersteund scenario.) In plaats daarvan de oorspronkelijke doelstellingen Hallo van Azure AD zijn zodat gebruikers toegang tot bedrijfstoepassingen op Hallo cloud zonder het onderhouden van een afzonderlijke aanmelding en vrijmaken on-premises directory-beheerders hun on-premises directory met het handmatig synchroniseren elke SaaS-toepassing die maakt gebruik van hun organisatie. Na verloop van tijd echter verwacht dat deze cloud directory service tooaddress een breed scala aan scenario's.

## <a name="ac"></a>Met behulp van Azure Active Directory-toegangsbeheer
Cloud-gebaseerde identiteit technologieën mag gebruikte toosolve tal van problemen. Azure Active Directory kunnen geven van een organisatie gebruikers eenmalige aanmelding toomultiple SaaS-toepassingen, bijvoorbeeld. Maar identiteit technologieën in Hallo cloud kunnen ook op andere manieren worden gebruikt.

Stel bijvoorbeeld dat een toepassing de gebruikers zich aanmelden met behulp van tokens die zijn uitgegeven door meerdere toolet wenst *id-providers (IdPs)*. Veel andere identiteitsproviders bestaan vandaag, met inbegrip van anderen, Facebook, Google en Microsoft en toepassingen kunt vaak gebruikers zich kunnen aanmelden met een van deze identiteiten. Waarom moet een toepassing lastig hoeft te vallen toomaintain eigen lijst met gebruikers en wachtwoorden wanneer deze identiteiten die al bestaan in plaats daarvan kunt vertrouwen? Bestaande identiteiten accepteren maakt leven eenvoudiger voor gebruikers met een minder tooremember gebruikersnaam en wachtwoord, en om Hallo mensen die hun eigen lijst met gebruikersnamen en wachtwoorden voor Hallo-toepassing die niet meer nodig toomaintain maken.

Maar terwijl elke id-provider een soort token uitgeeft, wordt deze tokens worden standaard niet - elke IdP een eigen indeling heeft. Bovendien Hallo-informatie in deze tokens ook is niet standaard. Een toepassing die u tooaccept tokens die zijn uitgegeven wenst door, spreken, Facebook, Google en Microsoft wordt geconfronteerd met Hallo uitdaging van het schrijven van toohandle unieke code van elk van deze indelingen.

Maar waarom dit doen? Waarom niet maken in plaats daarvan intermediaire die één token indeling met een algemene representatie van gegevens van identiteit kan genereren? Deze aanpak zouden leven eenvoudiger voor Hallo-ontwikkelaars die toepassingen, omdat ze nu slechts één type token toohandle moeten maken. Azure Active Directory-toegangsbeheer wordt precies dit intermediaire in Hallo cloud bieden voor het werken met diverse tokens. [Afbeelding 4](#fig4) ziet u hoe het werkt

![Azure Active Directory in de virtuele Machine](./media/identity/identity_04_IdentityProviders.png)
<a id="fig4"></a>afbeelding 4: Azure Active Directory-toegangsbeheer maakt het gemakkelijker voor toepassingen tooaccept identiteitstokens die door andere identiteitsproviders zijn uitgegeven.

Hallo wordt gestart wanneer een gebruiker tooaccess Hallo toepassing vanuit een browser probeert. toepassing Hello enterpriseenrollment.contoso.com haar tooan IdP van haar keuze (en die toepassing hello ook vertrouwensrelaties). Ze worden zichzelf toothis IdP, zoals door in te voeren van een gebruikersnaam en wachtwoord (stap 1) en Hallo IdP retourneert een token dat informatie bevat over haar (stap 2).

Zoals Hallo afbeelding ziet, ondersteunt toegangsbeheer tal van verschillende cloud-gebaseerde IdPs, met inbegrip van accounts die zijn gemaakt door Google, Yahoo, Facebook, Microsoft (voorheen Windows Live ID) en elke OpenID-provider. Het ondersteunt ook identiteiten die zijn gemaakt met behulp van Azure Active Directory en via federatie met AD FS, Windows Server Active Directory. Hallo-doel is vandaag de dag toocover Hallo meest gebruikte identiteiten of ze zijn uitgegeven door IdPs in Hallo cloud of on-premises.

Als een browser Hallo van de gebruiker heeft een IdP-token van haar gekozen IdP, verzendt dit tooAccess besturingselement (stap 3) token. Toegangsbeheer valideert token hello, om ervoor te zorgen dat het echt is uitgegeven door deze IdP, en vervolgens maakt u een nieuw token volgens toohello regels die zijn gedefinieerd voor deze toepassing. Zoals Azure Active Directory, Access Control is een multitenant-service, maar Hallo tenants zijn toepassingen in plaats van de klant organisaties. Elke toepassing krijgt een eigen naamruimte, zoals Hallo afbeelding wordt weergegeven en verschillende regels over autorisatie en nog veel meer kunt definiëren.

Deze regels kunt definiëren hoe tokens van verschillende IdPs moeten worden omgezet in een Access Control-token van de toepassing-beheerder. Bijvoorbeeld, als verschillende IdPs verschillende typen gebruikt voor de vertegenwoordiging van gebruikersnamen, kunnen Access Control-regels transformeren al deze waarden in een algemeen type van de gebruikersnaam. Toegangsbeheer stuurt vervolgens deze nieuwe token back toohello browser (stap 4), die ingediend door toohello toepassing (stap 5). Zodra het Hallo Access Control-token heeft, controleert Hallo toepassing of dat dit token echt is uitgegeven door de Access Control en Hallo informatie bevat (stap 6) wordt gebruikt.

Tijdens dit proces een beetje ingewikkeld lijkt, daadwerkelijk maakt levensduur aanzienlijk eenvoudiger voor Hallo maker van de toepassing hello. In plaats van uiteenlopende tokens met andere gegevens verwerken, kan toepassing hello identiteiten die worden uitgegeven door meerdere id-providers tijdens het ontvangen van nog steeds alleen een één-token met bekende informatie accepteren. In plaats van elke toepassing toobe geconfigureerd tootrust verschillende IdPs is vereist, ook deze vertrouwensrelaties in plaats daarvan worden beheerd door Access Control - een toepassing moet alleen vertrouwen.

Wordt het bewerken van af te wijzen dat er is niets over toegangsbeheer gebonden tooWindows is-kan net zo goed worden gebruikt door een Linux-toepassing die alleen Google en Facebook identiteiten geaccepteerd. En hoewel toegangsbeheer deel van hello Azure Active Directory-familie uitmaakt, kunt u denkt ervan als een geheel afzonderlijk van wat is beschreven in de vorige sectie Hallo-service. Hoewel beide technologieën met de identiteit werken, aanpakken ze heel anders problemen (Hoewel Microsoft heeft aangegeven dat deze op een bepaald moment toointegrate Hallo twee verwacht).

Werken met de identiteit is belangrijk in vrijwel elke toepassing. Hallo-doel van toegangsbeheer toomake is het eenvoudiger voor ontwikkelaars toocreate toepassingen die de identiteiten van diverse id-providers te accepteren. De toevoeging van deze service in de cloud hello, is Microsoft het geworden beschikbaar tooany toepassing die wordt uitgevoerd op elk platform.

## <a name="about-hello-author"></a>Over Hallo auteur
David Chappell wordt Principal van Chappell & gekoppeld [www.davidchappell.com](http://www.davidchappell.com) in San Francisco, Californië.

