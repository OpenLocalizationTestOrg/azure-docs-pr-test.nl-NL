> [!div class="op_single_selector"]
> * [<span data-ttu-id="407c3-101">Linux</span><span class="sxs-lookup"><span data-stu-id="407c3-101">Linux</span></span>](../articles/iot-hub/iot-hub-linux-iot-edge-simulated-device.md)
> * [<span data-ttu-id="407c3-102">Windows</span><span class="sxs-lookup"><span data-stu-id="407c3-102">Windows</span></span>](../articles/iot-hub/iot-hub-windows-iot-edge-simulated-device.md)

<span data-ttu-id="407c3-103">In dit scenario Hallo [gesimuleerde apparaat Cloud uploaden voorbeeld] laat u zien hoe toouse [Azure IoT rand] [ lnk-sdk] toosend tooIoT Hub van gesimuleerde telemetrie voor apparaat-naar-cloud apparaten.</span><span class="sxs-lookup"><span data-stu-id="407c3-103">This walkthrough of hello [Simulated Device Cloud Upload sample] shows you how toouse [Azure IoT Edge][lnk-sdk] toosend device-to-cloud telemetry tooIoT Hub from simulated devices.</span></span>

<span data-ttu-id="407c3-104">Dit overzicht omvat:</span><span class="sxs-lookup"><span data-stu-id="407c3-104">This walkthrough covers:</span></span>

* <span data-ttu-id="407c3-105">**Architectuur**: architecturale informatie over Hallo [gesimuleerde apparaat Cloud uploaden voorbeeld].</span><span class="sxs-lookup"><span data-stu-id="407c3-105">**Architecture**: architectural information about hello [Simulated Device Cloud Upload sample].</span></span>
* <span data-ttu-id="407c3-106">**Bouwen en uitvoeren van**: Hallo stappen vereist toobuild en Voer Hallo-voorbeeld.</span><span class="sxs-lookup"><span data-stu-id="407c3-106">**Build and run**: hello steps required toobuild and run hello sample.</span></span>

## <a name="architecture"></a><span data-ttu-id="407c3-107">Architectuur</span><span class="sxs-lookup"><span data-stu-id="407c3-107">Architecture</span></span>

<span data-ttu-id="407c3-108">Hallo [gesimuleerde apparaat Cloud uploaden voorbeeld] ziet u hoe een gateway die u telemetrie van verzendt toocreate gesimuleerde apparaten tooan IoT-hub.</span><span class="sxs-lookup"><span data-stu-id="407c3-108">hello [Simulated Device Cloud Upload sample] shows how toocreate a gateway that sends telemetry from simulated devices tooan IoT hub.</span></span> <span data-ttu-id="407c3-109">Een apparaat mogelijk niet kunnen tooconnect rechtstreeks tooIoT Hub omdat Hallo apparaat:</span><span class="sxs-lookup"><span data-stu-id="407c3-109">A device may not be able tooconnect directly tooIoT Hub because hello device:</span></span>

* <span data-ttu-id="407c3-110">Gebruikt geen een communicatieprotocol begrepen door de IoT Hub.</span><span class="sxs-lookup"><span data-stu-id="407c3-110">Does not use a communications protocol understood by IoT Hub.</span></span>
* <span data-ttu-id="407c3-111">Is niet genoeg smart tooremember Hallo identiteit toegewezen tooit door de IoT Hub.</span><span class="sxs-lookup"><span data-stu-id="407c3-111">Is not smart enough tooremember hello identity assigned tooit by IoT Hub.</span></span>

<span data-ttu-id="407c3-112">Een IoT-Edge-gateway kan deze problemen in Hallo volgende manieren oplossen:</span><span class="sxs-lookup"><span data-stu-id="407c3-112">An IoT Edge gateway can solve these problems in hello following ways:</span></span>

* <span data-ttu-id="407c3-113">Hallo gateway Hallo protocol dat wordt gebruikt door Hallo apparaat begrijpt, ontvangt telemetrie voor apparaat-naar-cloud van Hallo-apparaat en stuurt deze berichten tooIoT Hub met behulp van een protocol begrepen door de Hallo iothub.</span><span class="sxs-lookup"><span data-stu-id="407c3-113">hello gateway understands hello protocol used by hello device, receives device-to-cloud telemetry from hello device, and forwards those messages tooIoT Hub using a protocol understood by hello IoT hub.</span></span>

* <span data-ttu-id="407c3-114">Hallo gateway IoT Hub identiteiten toodevices toegewezen en fungeert als een proxy wanneer een apparaat berichten tooIoT Hub verzendt.</span><span class="sxs-lookup"><span data-stu-id="407c3-114">hello gateway maps IoT Hub identities toodevices and acts as a proxy when a device sends messages tooIoT Hub.</span></span>

<span data-ttu-id="407c3-115">Hallo volgende diagram ziet u Hallo hoofdonderdelen van Hallo voorbeeld, met inbegrip van IoT rand modules Hallo:</span><span class="sxs-lookup"><span data-stu-id="407c3-115">hello following diagram shows hello main components of hello sample, including hello IoT Edge modules:</span></span>

![][1]

<span data-ttu-id="407c3-116">Hallo-modules niet doorgegeven berichten rechtstreeks tooeach andere.</span><span class="sxs-lookup"><span data-stu-id="407c3-116">hello modules do not pass messages directly tooeach other.</span></span> <span data-ttu-id="407c3-117">Hallo-modules publiceren berichten interne broker tooan die Hallo berichten toohello biedt andere modules met behulp van een mechanisme voor het abonnement.</span><span class="sxs-lookup"><span data-stu-id="407c3-117">hello modules publish messages tooan internal broker that delivers hello messages toohello other modules using a subscription mechanism.</span></span> <span data-ttu-id="407c3-118">Zie voor meer informatie [aan de slag met Azure IoT rand][lnk-gw-getstarted].</span><span class="sxs-lookup"><span data-stu-id="407c3-118">For more information, see [Get started with Azure IoT Edge][lnk-gw-getstarted].</span></span>

### <a name="protocol-ingestion-module"></a><span data-ttu-id="407c3-119">Module voor het protocolopname</span><span class="sxs-lookup"><span data-stu-id="407c3-119">Protocol ingestion module</span></span>

<span data-ttu-id="407c3-120">Deze module is een startpunt voor de ontvangst van gegevens van apparaten, via de gateway hello en in de cloud Hallo Hallo.</span><span class="sxs-lookup"><span data-stu-id="407c3-120">This module is hello starting point for receiving data from devices, through hello gateway, and into hello cloud.</span></span> <span data-ttu-id="407c3-121">In de module Hallo Hallo voorbeeld:</span><span class="sxs-lookup"><span data-stu-id="407c3-121">In hello sample, hello module:</span></span>

1. <span data-ttu-id="407c3-122">Gesimuleerde temperatuur gegevens maakt.</span><span class="sxs-lookup"><span data-stu-id="407c3-122">Creates simulated temperature data.</span></span> <span data-ttu-id="407c3-123">Als u fysieke apparaten gebruikt, leest Hallo module de gegevens van deze fysieke apparaten.</span><span class="sxs-lookup"><span data-stu-id="407c3-123">If you use physical devices, hello module reads data from those physical devices.</span></span>
1. <span data-ttu-id="407c3-124">Hiermee maakt u een bericht.</span><span class="sxs-lookup"><span data-stu-id="407c3-124">Creates a message.</span></span>
1. <span data-ttu-id="407c3-125">Hallo gesimuleerde temperatuur gegevens in inhoud van het bericht Hallo geplaatst.</span><span class="sxs-lookup"><span data-stu-id="407c3-125">Places hello simulated temperature data into hello message content.</span></span>
1. <span data-ttu-id="407c3-126">Voegt een eigenschap met een valse toohello bericht dat MAC-adres toe.</span><span class="sxs-lookup"><span data-stu-id="407c3-126">Adds a property with a fake MAC address toohello message.</span></span>
1. <span data-ttu-id="407c3-127">Hallo-bericht beschikbaar toohello volgende module maakt in de keten Hallo.</span><span class="sxs-lookup"><span data-stu-id="407c3-127">Makes hello message available toohello next module in hello chain.</span></span>

<span data-ttu-id="407c3-128">Hallo module met de naam **Protocol X opname** in Hallo vorige diagram heet **gesimuleerd apparaat** in Hallo broncode.</span><span class="sxs-lookup"><span data-stu-id="407c3-128">hello module called **Protocol X ingestion** in hello previous diagram is called **Simulated device** in hello source code.</span></span>

### <a name="mac-lt-gt-iot-hub-id-module"></a><span data-ttu-id="407c3-129">Module MAC &lt;-&gt; IoT Hub-id</span><span class="sxs-lookup"><span data-stu-id="407c3-129">MAC &lt;-&gt; IoT Hub ID module</span></span>

<span data-ttu-id="407c3-130">Deze module wordt gescand voor berichten met een Mac-adres-eigenschap.</span><span class="sxs-lookup"><span data-stu-id="407c3-130">This module scans for messages that have a Mac address property.</span></span> <span data-ttu-id="407c3-131">In voorbeeld Hallo toegevoegd Hallo protocol opname module Hallo MAC-adres-eigenschap.</span><span class="sxs-lookup"><span data-stu-id="407c3-131">In hello sample, hello protocol ingestion module adds hello MAC address property.</span></span> <span data-ttu-id="407c3-132">Als Hallo module vindt een dergelijke eigenschap, wordt een andere eigenschap met een IoT Hub apparaat sleutel toohello bericht toegevoegd.</span><span class="sxs-lookup"><span data-stu-id="407c3-132">If hello module finds such a property, it adds another property with an IoT Hub device key toohello message.</span></span> <span data-ttu-id="407c3-133">Hallo module maakt vervolgens Hallo-bericht beschikbaar toohello volgende module in de keten Hallo.</span><span class="sxs-lookup"><span data-stu-id="407c3-133">hello module then makes hello message available toohello next module in hello chain.</span></span>

<span data-ttu-id="407c3-134">Hallo developer stelt u een toewijzing tussen MAC-adressen en IoT Hub identiteiten tooassociate Hallo gesimuleerde apparaten met IoT Hub apparaat-id's.</span><span class="sxs-lookup"><span data-stu-id="407c3-134">hello developer sets up a mapping between MAC addresses and IoT Hub identities tooassociate hello simulated devices with IoT Hub device identities.</span></span> <span data-ttu-id="407c3-135">Hallo-ontwikkelaar wordt Hallo toewijzing handmatig toegevoegd als onderdeel van de moduleconfiguratie Hallo.</span><span class="sxs-lookup"><span data-stu-id="407c3-135">hello developer adds hello mapping manually as part of hello module configuration.</span></span>

> [!NOTE]
> <span data-ttu-id="407c3-136">In dit voorbeeld wordt een MAC-adres gebruikt als een unieke apparaat-id en wordt deze gekoppeld aan de id van een IoT Hub-apparaat.</span><span class="sxs-lookup"><span data-stu-id="407c3-136">This sample uses a MAC address as a unique device identifier and correlates it with an IoT Hub device identity.</span></span> <span data-ttu-id="407c3-137">U kunt echter uw eigen module schrijven die een andere unieke id gebruikt.</span><span class="sxs-lookup"><span data-stu-id="407c3-137">However, you can write your own module that uses a different unique identifier.</span></span> <span data-ttu-id="407c3-138">Bijvoorbeeld, uw apparaten mogelijk zijn unieke serienummers of Hallo telemetrische gegevens kan bevatten de naam van een unieke embedded-apparaat.</span><span class="sxs-lookup"><span data-stu-id="407c3-138">For example, your devices may have unique serial numbers or hello telemetry data may include a unique embedded device name.</span></span>

### <a name="iot-hub-communication-module"></a><span data-ttu-id="407c3-139">Module voor IoT Hub-communicatie</span><span class="sxs-lookup"><span data-stu-id="407c3-139">IoT Hub communication module</span></span>

<span data-ttu-id="407c3-140">Deze module wordt berichten met een IoT Hub apparaat-sleuteleigenschap die is toegewezen door de vorige module Hallo.</span><span class="sxs-lookup"><span data-stu-id="407c3-140">This module takes messages with an IoT Hub device key property that was assigned by hello previous module.</span></span> <span data-ttu-id="407c3-141">Hallo module verzendt de inhoud tooIoT Hub met behulp van HTTP-protocol Hallo het Hallo-bericht.</span><span class="sxs-lookup"><span data-stu-id="407c3-141">hello module sends hello message content tooIoT Hub using hello HTTP protocol.</span></span> <span data-ttu-id="407c3-142">HTTP is een Hallo drie protocollen begrepen door de IoT Hub.</span><span class="sxs-lookup"><span data-stu-id="407c3-142">HTTP is one of hello three protocols understood by IoT Hub.</span></span>

<span data-ttu-id="407c3-143">Deze module wordt in plaats van een verbinding voor elk gesimuleerd apparaat te openen, één HTTP-verbinding geopend uit Hallo gateway toohello iothub.</span><span class="sxs-lookup"><span data-stu-id="407c3-143">Instead of opening a connection for each simulated device, this module opens a single HTTP connection from hello gateway toohello IoT hub.</span></span> <span data-ttu-id="407c3-144">Hallo module multiplexes vervolgens verbindingen van alle Hallo gesimuleerde apparaten via deze verbinding.</span><span class="sxs-lookup"><span data-stu-id="407c3-144">hello module then multiplexes connections from all hello simulated devices over that connection.</span></span> <span data-ttu-id="407c3-145">Deze aanpak kunt een enkele gateway tooconnect veel meer apparaten.</span><span class="sxs-lookup"><span data-stu-id="407c3-145">This approach enables a single gateway tooconnect many more devices.</span></span>

## <a name="before-you-get-started"></a><span data-ttu-id="407c3-146">Voordat u aan de slag gaat</span><span class="sxs-lookup"><span data-stu-id="407c3-146">Before you get started</span></span>

<span data-ttu-id="407c3-147">Voordat u begint, moet u het volgende doen:</span><span class="sxs-lookup"><span data-stu-id="407c3-147">Before you get started, you must:</span></span>

* <span data-ttu-id="407c3-148">[Een iothub maken] [ lnk-create-hub] in uw Azure-abonnement, moet u het Hallo-naam van uw hub toocomplete in dit scenario.</span><span class="sxs-lookup"><span data-stu-id="407c3-148">[Create an IoT hub][lnk-create-hub] in your Azure subscription, you need hello name of your hub toocomplete this walkthrough.</span></span> <span data-ttu-id="407c3-149">Als u geen account hebt, kunt u binnen een paar minuten een [gratis account][lnk-free-trial] maken.</span><span class="sxs-lookup"><span data-stu-id="407c3-149">If you don't have an account, you can create a [free account][lnk-free-trial] in just a couple of minutes.</span></span>
* <span data-ttu-id="407c3-150">Voeg twee apparaten tooyour IoT-hub en noteer de id's en apparaten sleutels.</span><span class="sxs-lookup"><span data-stu-id="407c3-150">Add two devices tooyour IoT hub and make a note of their ids and device keys.</span></span> <span data-ttu-id="407c3-151">Kunt u Hallo [apparaat explorer] [ lnk-device-explorer] of [iothub explorer] [ lnk-iothub-explorer] tooadd uw apparaten toohello IoT-hub u hebt gemaakt in Hallo hulpprogramma vorige stap en de sleutels op te halen.</span><span class="sxs-lookup"><span data-stu-id="407c3-151">You can use hello [device explorer][lnk-device-explorer] or [iothub-explorer][lnk-iothub-explorer] tool tooadd your devices toohello IoT hub you created in hello previous step and retrieve their keys.</span></span>

![][2]

<!-- Images -->
[1]: media/iot-hub-iot-edge-simulated-selector/image1.png
[2]: media/iot-hub-iot-edge-simulated-selector/image2.png

<!-- Links -->
[gesimuleerde apparaat Cloud uploaden voorbeeld]: https://github.com/Azure/iot-edge/blob/master/samples/simulated_device_cloud_upload/README.md
[lnk-sdk]: https://github.com/Azure/iot-edge
[lnk-gw-getstarted]: ../articles/iot-hub/iot-hub-linux-iot-edge-get-started.md
[lnk-free-trial]: https://azure.microsoft.com/pricing/free-trial/
[lnk-device-explorer]: https://github.com/Azure/azure-iot-sdk-csharp/tree/master/tools/DeviceExplorer
[lnk-iothub-explorer]: https://github.com/Azure/iothub-explorer/blob/master/readme.md
[lnk-create-hub]: ../articles/iot-hub/iot-hub-create-through-portal.md