## <a name="prepare-for-akv-integration"></a><span data-ttu-id="60950-101">Voorbereiden voor Azure Sleutelkluis-integratie</span><span class="sxs-lookup"><span data-stu-id="60950-101">Prepare for AKV Integration</span></span>
<span data-ttu-id="60950-102">Integratie van Azure Sleutelkluis-tooconfigure toouse uw virtuele machine van SQL Server zijn er verschillende vereisten:</span><span class="sxs-lookup"><span data-stu-id="60950-102">toouse Azure Key Vault Integration tooconfigure your SQL Server VM, there are several prerequisites:</span></span> 

1. [<span data-ttu-id="60950-103">Azure Powershell installeren</span><span class="sxs-lookup"><span data-stu-id="60950-103">Install Azure Powershell</span></span>](#install-azure-powershell)
2. [<span data-ttu-id="60950-104">Maak een Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="60950-104">Create an Azure Active Directory</span></span>](#create-an-azure-active-directory)
3. [<span data-ttu-id="60950-105">Een sleutelkluis maken</span><span class="sxs-lookup"><span data-stu-id="60950-105">Create a key vault</span></span>](#create-a-key-vault)

<span data-ttu-id="60950-106">Hallo volgende secties worden deze vereisten en het Hallo-informatie die u nodig hebt toocollect toolater uitvoeren Hallo PowerShell-cmdlets.</span><span class="sxs-lookup"><span data-stu-id="60950-106">hello following sections describe these prerequisites and hello information you need toocollect toolater run hello PowerShell cmdlets.</span></span>

### <a name="install-azure-powershell"></a><span data-ttu-id="60950-107">Azure PowerShell installeren</span><span class="sxs-lookup"><span data-stu-id="60950-107">Install Azure PowerShell</span></span>
<span data-ttu-id="60950-108">Zorg ervoor dat u hebt geïnstalleerd Hallo nieuwste Azure PowerShell SDK.</span><span class="sxs-lookup"><span data-stu-id="60950-108">Make sure you have installed hello latest Azure PowerShell SDK.</span></span> <span data-ttu-id="60950-109">Zie voor meer informatie [hoe tooinstall en configureren van Azure PowerShell](/powershell/azureps-cmdlets-docs).</span><span class="sxs-lookup"><span data-stu-id="60950-109">For more information, see [How tooinstall and configure Azure PowerShell](/powershell/azureps-cmdlets-docs).</span></span>

### <a name="create-an-azure-active-directory"></a><span data-ttu-id="60950-110">Maak een Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="60950-110">Create an Azure Active Directory</span></span>
<span data-ttu-id="60950-111">U moet eerst toohave een [Azure Active Directory](https://azure.microsoft.com/trial/get-started-active-directory/) (AAD) in uw abonnement.</span><span class="sxs-lookup"><span data-stu-id="60950-111">First, you need toohave an [Azure Active Directory](https://azure.microsoft.com/trial/get-started-active-directory/) (AAD) in your subscription.</span></span> <span data-ttu-id="60950-112">Tussen veel voordelen kunt hiermee u toogrant machtiging tooyour sleutelkluis voor bepaalde gebruikers en toepassingen.</span><span class="sxs-lookup"><span data-stu-id="60950-112">Among many benefits, this allows you toogrant permission tooyour key vault for certain users and applications.</span></span>

<span data-ttu-id="60950-113">Vervolgens moet u een toepassing registreren met AAD.</span><span class="sxs-lookup"><span data-stu-id="60950-113">Next, register an application with AAD.</span></span> <span data-ttu-id="60950-114">Hierdoor krijgt u een Service-Principal-account dat toegang tooyour sleutelkluis die uw virtuele machine nodig heeft.</span><span class="sxs-lookup"><span data-stu-id="60950-114">This will give you a Service Principal account that has access tooyour key vault which your VM will need.</span></span> <span data-ttu-id="60950-115">In hello Azure Key Vault artikel vindt u deze stappen in Hallo [een toepassing registreren met Azure Active Directory](../articles/key-vault/key-vault-get-started.md#register) sectie, of u kunt zien Hallo stappen met schermopnamen in Hallo **een identiteit voor de toepassing hello ophalen sectie** van [dit blogbericht](http://blogs.technet.com/b/kv/archive/2015/01/09/azure-key-vault-step-by-step.aspx).</span><span class="sxs-lookup"><span data-stu-id="60950-115">In hello Azure Key Vault article, you can find these steps in hello [Register an application with Azure Active Directory](../articles/key-vault/key-vault-get-started.md#register) section, or you can see hello steps with screen shots in hello **Get an identity for hello application section** of [this blog post](http://blogs.technet.com/b/kv/archive/2015/01/09/azure-key-vault-step-by-step.aspx).</span></span> <span data-ttu-id="60950-116">Voordat u deze stappen uitvoert, houd er rekening mee dat u nodig hebt toocollect Hallo informatie tijdens deze registratie die later nodig wanneer u Azure Sleutelkluis-integratie op uw SQL-VM inschakelt te volgen.</span><span class="sxs-lookup"><span data-stu-id="60950-116">Before completing these steps, note that you need toocollect hello following information during this registration that is needed later when you enable Azure Key Vault Integration on your SQL VM.</span></span>

* <span data-ttu-id="60950-117">Nadat de toepassing hello is toegevoegd, Hallo zoeken **CLIENT-ID** op Hallo **configureren** tabblad.   ![Azure Active Directory-Client-ID](./media/virtual-machines-sql-server-akv-prepare/aad-client-id.png)</span><span class="sxs-lookup"><span data-stu-id="60950-117">After hello application is added, find hello **CLIENT ID**  on hello **CONFIGURE** tab.   ![Azure Active Directory Client ID](./media/virtual-machines-sql-server-akv-prepare/aad-client-id.png)</span></span>
  
    <span data-ttu-id="60950-118">Hallo client-ID wordt toegewezen hoger toohello **$spName** parameter in Hallo PowerShell script tooenable Azure Sleutelkluis-integratie (Service Principal name).</span><span class="sxs-lookup"><span data-stu-id="60950-118">hello client ID is assigned later toohello **$spName** (Service Principal name) parameter in hello PowerShell script tooenable Azure Key Vault Integration.</span></span> 
* <span data-ttu-id="60950-119">Ook tijdens deze stappen bij het maken van uw sleutel Hallo-geheim niet kopiëren voor uw sleutel wordt weergegeven in de volgende schermafbeelding Hallo.</span><span class="sxs-lookup"><span data-stu-id="60950-119">Also, during these steps when you create your key, copy hello secret for your key as is shown in hello following screenshot.</span></span> <span data-ttu-id="60950-120">Deze sleutel geheim hoger toohello is toegewezen **$spSecret** (Service Principal-geheim)-parameter in Hallo PowerShell-script.</span><span class="sxs-lookup"><span data-stu-id="60950-120">This key secret is assigned later toohello **$spSecret** (Service Principal secret) parameter in hello PowerShell script.</span></span>  
    <span data-ttu-id="60950-121">![Azure Active Directory-geheim](./media/virtual-machines-sql-server-akv-prepare/aad-sp-secret.png)</span><span class="sxs-lookup"><span data-stu-id="60950-121">![Azure Active Directory Secret](./media/virtual-machines-sql-server-akv-prepare/aad-sp-secret.png)</span></span>
* <span data-ttu-id="60950-122">U moet deze nieuwe toohave Hallo van client-ID volgende toegangsmachtigingen toestaan: **versleutelen**, **ontsleutelen**, **wrapKey**, **unwrapKey**, **aanmelding**, en **controleren**.</span><span class="sxs-lookup"><span data-stu-id="60950-122">You must authorize this new client ID toohave hello following access permissions: **encrypt**, **decrypt**, **wrapKey**, **unwrapKey**, **sign**, and **verify**.</span></span> <span data-ttu-id="60950-123">Dit wordt gedaan met Hallo [Set-AzureRmKeyVaultAccessPolicy](https://msdn.microsoft.com/library/azure/mt603625.aspx) cmdlet.</span><span class="sxs-lookup"><span data-stu-id="60950-123">This is done with hello [Set-AzureRmKeyVaultAccessPolicy](https://msdn.microsoft.com/library/azure/mt603625.aspx) cmdlet.</span></span> <span data-ttu-id="60950-124">Zie voor meer informatie [autoriseren hello toepassing toouse Hallo sleutel of geheim](../articles/key-vault/key-vault-get-started.md#authorize).</span><span class="sxs-lookup"><span data-stu-id="60950-124">For more information see [Authorize hello application toouse hello key or secret](../articles/key-vault/key-vault-get-started.md#authorize).</span></span>

### <a name="create-a-key-vault"></a><span data-ttu-id="60950-125">Een sleutelkluis maken</span><span class="sxs-lookup"><span data-stu-id="60950-125">Create a key vault</span></span>
<span data-ttu-id="60950-126">In de volgorde toouse Azure Key Vault toostore Hallo sleutels die u voor versleuteling in uw virtuele machine gebruikt, moet u toegang tooa sleutelkluis.</span><span class="sxs-lookup"><span data-stu-id="60950-126">In order toouse Azure Key Vault toostore hello keys you will use for encryption in your VM, you need access tooa key vault.</span></span> <span data-ttu-id="60950-127">Als u de sleutelkluis al geen hebt ingesteld, maken door de stappen te volgen Hallo in Hallo [aan de slag met Azure Key Vault](../articles/key-vault/key-vault-get-started.md) onderwerp.</span><span class="sxs-lookup"><span data-stu-id="60950-127">If you have not already set up your key vault, create one by following hello steps in hello [Getting Started with Azure Key Vault](../articles/key-vault/key-vault-get-started.md) topic.</span></span> <span data-ttu-id="60950-128">Voordat u deze stappen uitvoert, houd er rekening mee dat er enige informatie die u toocollect nodig tijdens deze instellen hoger is vereist is wanneer u Azure Sleutelkluis-integratie op de SQL-VM inschakelen.</span><span class="sxs-lookup"><span data-stu-id="60950-128">Before completing these steps, note that there is some information you need toocollect during this set up that is needed later when you enable Azure Key Vault Integration on your SQL VM.</span></span>

<span data-ttu-id="60950-129">Als u krijgt maken toohello een stap sleutelkluis Opmerking Hallo geretourneerd **vaultUri** eigenschap, die Hallo sleutelkluis-URL.</span><span class="sxs-lookup"><span data-stu-id="60950-129">When you get toohello Create a key vault step, note hello returned **vaultUri** property, which is hello key vault URL.</span></span> <span data-ttu-id="60950-130">Sleutelkluisnaam Hallo is ContosoKeyVault, daarom Hallo sleutelkluis-URL https://contosokeyvault.vault.azure.net/ zou worden in Hallo voorbeeld in deze stap, die hieronder worden weergegeven.</span><span class="sxs-lookup"><span data-stu-id="60950-130">In hello example provided in that step, shown below, hello key vault name is ContosoKeyVault, therefore hello key vault URL would be https://contosokeyvault.vault.azure.net/.</span></span>

    New-AzureRmKeyVault -VaultName 'ContosoKeyVault' -ResourceGroupName 'ContosoResourceGroup' -Location 'East Asia'

<span data-ttu-id="60950-131">Hallo sleutelkluis-URL is toegewezen hoger toohello **$akvURL** parameter in Hallo PowerShell script tooenable Azure Sleutelkluis-integratie.</span><span class="sxs-lookup"><span data-stu-id="60950-131">hello key vault URL is assigned later toohello **$akvURL** parameter in hello PowerShell script tooenable Azure Key Vault Integration.</span></span>

